<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: clres.c File Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>clres.c File Reference</h1><code>#include "<a class="el" href="../../d8/d2/w32_2ntuser_2client_2precomp_8h-source.html">precomp.h</a>"</code><br>

<p>
<a href="../../d5/d8/clres_8c-source.html">Go to the source code of this file.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Classes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d6/structRESOURCE__ACCEL.html">RESOURCE_ACCEL</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d7/struct__OLDCURSOR.html">_OLDCURSOR</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/structtagMAPRES.html">tagMAPRES</a></td></tr>

<tr><td colspan=2><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a0">BPP01_MAXCOLORS</a>&nbsp;&nbsp;&nbsp;2</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a1">BPP04_MAXCOLORS</a>&nbsp;&nbsp;&nbsp;16</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a2">BPP08_MAXCOLORS</a>&nbsp;&nbsp;&nbsp;256</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a3">RESCLR_BLACK</a>&nbsp;&nbsp;&nbsp;0x00000000</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a4">RESCLR_WHITE</a>&nbsp;&nbsp;&nbsp;0x00FFFFFF</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a5">BMR_ICON</a>&nbsp;&nbsp;&nbsp;1</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a6">BMR_BITMAP</a>&nbsp;&nbsp;&nbsp;2</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a7">BMR_CURSOR</a>&nbsp;&nbsp;&nbsp;3</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a8">GETINITDC</a>()&nbsp;&nbsp;&nbsp;(<a class="el" href="../../d8/d6/ntuser_2client_2globals_8h.html#a19">gfSystemInitialized</a> ? NtUserGetDC(NULL) : CreateDCW(L"DISPLAY", L"", NULL, NULL))</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a9">RELEASEINITDC</a>(hdc)&nbsp;&nbsp;&nbsp;(<a class="el" href="../../d8/d6/ntuser_2client_2globals_8h.html#a19">gfSystemInitialized</a> ? ReleaseDC(NULL, hdc) : DeleteDC(hdc))</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a10">ISRIFFFORMAT</a>(p)&nbsp;&nbsp;&nbsp;(((UNALIGNED RTAG *)(p))-&gt;ckID == FOURCC_RIFF)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a11">MR_FAILFOR40</a>&nbsp;&nbsp;&nbsp;0x01</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a12">MR_MONOCHROME</a>&nbsp;&nbsp;&nbsp;0x02</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a13">FACCEL_VALID</a>&nbsp;&nbsp;&nbsp;(FALT | FCONTROL | FNOINVERT | FSHIFT | FVIRTKEY | FLASTKEY)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a14">MAX_BMPMAP</a>&nbsp;&nbsp;&nbsp;32</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a15">lpbch</a>&nbsp;&nbsp;&nbsp;((LPBITMAPCOREHEADER)lpbi)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a16">upbch</a>&nbsp;&nbsp;&nbsp;((<a class="el" href="../../d6/d0/usercli_8h.html#a379">UPBITMAPCOREHEADER</a>)upbih)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a17">lpRGB</a>&nbsp;&nbsp;&nbsp;((UNALIGNED LONG *)lpColorTable)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a18">lpRGBw</a>&nbsp;&nbsp;&nbsp;((UNALIGNED WORD *)lpColorTable)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a19">upbch</a>&nbsp;&nbsp;&nbsp;((<a class="el" href="../../d6/d0/usercli_8h.html#a379">UPBITMAPCOREHEADER</a>)upbih)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a20">upOldIcoCur</a>&nbsp;&nbsp;&nbsp;((<a class="el" href="../../d4/d9/clres_8c.html#a24">UPOLDCURSOR</a>)upbih)</td></tr>

<tr><td colspan=2><br><h2>Typedefs</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>typedef *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a21">PRESOURCE_ACCEL</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d1/d7/struct__OLDCURSOR.html">_OLDCURSOR</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a22">OLDCURSOR</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d1/d7/struct__OLDCURSOR.html">_OLDCURSOR</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a23">POLDCURSOR</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d1/d7/struct__OLDCURSOR.html">OLDCURSOR</a> UNALIGNED *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a24">UPOLDCURSOR</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d6/d0/structtagMAPRES.html">tagMAPRES</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a25">MAPRES</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d6/d0/structtagMAPRES.html">tagMAPRES</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a26">LPMAPRES</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d6/d0/structtagMAPRES.html">tagMAPRES</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a27">PMAPRES</a></td></tr>

<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>HBITMAP&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a28">CopyBmp</a> (HBITMAP hbmpOrg, int cxNew, int cyNew, UINT LR_flags)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HANDLE&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a29">SplFindResource</a> (HINSTANCE hmod, LPCWSTR lpName, LPCWSTR lpType)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a30">SplFreeResource</a> (HANDLE hRes, HINSTANCE hmod, UINT lrFlags)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a31">WowGetModuleFileName</a> (HMODULE hModule, LPWSTR pwsz, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> cchMax)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HMODULE&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a32">WowGetModuleHandle</a> (LPCWSTR pwsz)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HACCEL WINAPI&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a33">CreateAcceleratorTableA</a> (LPACCEL paccel, int cAccel)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>int&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a34">CopyAcceleratorTableA</a> (HACCEL hacc, LPACCEL paccel, int length)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d9/d7/structtagACCELCACHE.html">PACCELCACHE</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a35">FindAccResource</a> (HACCEL hAccel, PVOID pRes)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a36">AddAccResource</a> (HACCEL hAccel, PVOID pRes)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a37">DestroyAcceleratorTable</a> (HACCEL hAccel)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HANDLE&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a38">LoadAcc</a> (HINSTANCE hmod, HANDLE hrl)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HACCEL WINAPI&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a39">LoadAcceleratorsA</a> (HINSTANCE hmod, LPCSTR lpAccName)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HACCEL WINAPI&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a40">LoadAcceleratorsW</a> (HINSTANCE hmod, LPCWSTR lpAccName)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>int WINAPI&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a41">LoadStringA</a> (HINSTANCE hmod, UINT wID, LPSTR lpAnsiBuffer, int cchBufferMax)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>int WINAPI&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a42">LoadStringW</a> (HINSTANCE hmod, UINT wID, LPWSTR lpBuffer, int cchBufferMax)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a43">SkipIDorString</a> (LPBYTE pb)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a44">GetSizeDialogTemplate</a> (HINSTANCE hmod, LPCDLGTEMPLATE pdt)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>INT_PTR WINAPI&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a45">DialogBoxIndirectParamA</a> (HINSTANCE hmod, LPCDLGTEMPLATEA lpDlgTemplate, HWND hwndOwner, DLGPROC lpDialogFunc, LPARAM dwInitParam)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>INT_PTR WINAPI&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a46">DialogBoxIndirectParamW</a> (HINSTANCE hmod, LPCDLGTEMPLATEW lpDlgTemplate, HWND hwndOwner, DLGPROC lpDialogFunc, LPARAM dwInitParam)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>INT_PTR WINAPI&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a47">DialogBoxIndirectParamAorW</a> (HINSTANCE hmod, LPCDLGTEMPLATEW lpDlgTemplate, HWND hwndOwner, DLGPROC lpDialogFunc, LPARAM dwInitParam, UINT fAnsiFlags)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HWND WINAPI&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a48">CreateDialogIndirectParamA</a> (HINSTANCE hmod, LPCDLGTEMPLATEA lpDlgTemplate, HWND hwndOwner, DLGPROC lpDialogFunc, LPARAM dwInitParam)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HWND WINAPI&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a49">CreateDialogIndirectParamW</a> (HINSTANCE hmod, LPCDLGTEMPLATEW lpDlgTemplate, HWND hwndOwner, DLGPROC lpDialogFunc, LPARAM dwInitParam)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HWND WINAPI&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a50">CreateDialogIndirectParamAorW</a> (HANDLE hmod, LPCDLGTEMPLATE lpDlgTemplate, HWND hwndOwner, DLGPROC lpDialogFunc, LPARAM dwInitParam, UINT fAnsi)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>INT_PTR WINAPI&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a51">DialogBoxParamA</a> (HINSTANCE hmod, LPCSTR lpName, HWND hwndOwner, DLGPROC lpDialogFunc, LPARAM dwInitParam)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>INT_PTR WINAPI&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a52">DialogBoxParamW</a> (HINSTANCE hmod, LPCWSTR lpName, HWND hwndOwner, DLGPROC lpDialogFunc, LPARAM dwInitParam)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HWND WINAPI&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a53">CreateDialogParamA</a> (HINSTANCE hmod, LPCSTR lpName, HWND hwndOwner, DLGPROC lpDialogFunc, LPARAM dwInitParam)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HWND WINAPI&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a54">CreateDialogParamW</a> (HINSTANCE hmod, LPCWSTR lpName, HWND hwndOwner, DLGPROC lpDialogFunc, LPARAM dwInitParam)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL WINAPI&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a55">DestroyCursor</a> (HCURSOR hcur)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HICON&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a56">CreateIcoCur</a> (<a class="el" href="../../d8/d1/structtagCURSORDATA.html">PCURSORDATA</a> lpi)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HCURSOR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a57">CreateIcoCurIndirect</a> (<a class="el" href="../../d8/d1/structtagCURSORDATA.html">PCURSORDATA</a> pcurCreate, UINT cPlanes, UINT cBitsPixel, CONST <a class="el" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a> *lpANDbits, CONST <a class="el" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a> *lpXORbits)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HCURSOR WINAPI&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a58">CreateCursor</a> (HINSTANCE hModule, int iXhotspot, int iYhotspot, int iWidth, int iHeight, LPBYTE lpANDplane, LPBYTE lpXORplane)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HICON WINAPI&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a59">CreateIcon</a> (HINSTANCE hModule, int iWidth, int iHeight, <a class="el" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a> planes, <a class="el" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a> bpp, CONST <a class="el" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a> *lpANDplane, CONST <a class="el" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a> *lpXORplane)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HICON WINAPI&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a60">CreateIconIndirect</a> (PICONINFO piconinfo)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL WINAPI&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a61">GetIconInfo</a> (HICON hicon, PICONINFO piconinfo)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HCURSOR WINAPI&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a62">GetCursorFrameInfo</a> (HCURSOR hcur, LPWSTR lpName, int iFrame, LPDWORD pjifRate, LPINT pccur)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL WINAPI&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a63">_FreeResource</a> (HANDLE hResData, HINSTANCE hModule)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>LPSTR WINAPI&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a64">_LockResource</a> (HANDLE hResData, HINSTANCE hModule)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL WINAPI&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a65">_UnlockResource</a> (HANDLE hResData, HINSTANCE hModule)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>int WINAPI&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a66">LookupIconIdFromDirectory</a> (<a class="el" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a> presbits, BOOL fIcon)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>int WINAPI&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a67">LookupIconIdFromDirectoryEx</a> (<a class="el" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a> presbits, BOOL fIcon, int cxDesired, int cyDesired, UINT LR_flags)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HANDLE&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a68">LoadCursorIconFromResource</a> (<a class="el" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a> presbits, LPCWSTR lpName, int cxDesired, int cyDesired, UINT LR_flags)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HICON WINAPI&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a69">CreateIconFromResource</a> (<a class="el" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a> presbits, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> dwResSize, BOOL fIcon, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> dwVer)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HICON WINAPI&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a70">CreateIconFromResourceEx</a> (<a class="el" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a> presbits, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> dwResSize, BOOL fIcon, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> dwVer, int cxDesired, int cyDesired, UINT LR_flags)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HBITMAP&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a71">Convert1BppToMonoBitmap</a> (HDC hdcSrc, HBITMAP hbm1Bpp)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HBITMAP&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a72">CreateScreenBitmap</a> (int cx, int <a class="el" href="../../d1/d1/inctlpan_8c.html#a3">cy</a>, UINT planes, UINT bpp, LPSTR lpBits, LPBOOL pf1Bpp)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HBITMAP&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a73">LoadBmp</a> (HINSTANCE hmod, LPCWSTR lpName, int cxDesired, int cyDesired, UINT flags)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HBITMAP WINAPI&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a74">LoadBitmapA</a> (HINSTANCE hmod, LPCSTR lpName)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HBITMAP WINAPI&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a75">LoadBitmapW</a> (HINSTANCE hmod, LPCWSTR lpName)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HCURSOR WINAPI&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a76">LoadCursorA</a> (HINSTANCE hmod, LPCSTR lpName)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HCURSOR WINAPI&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a77">LoadCursorW</a> (HINSTANCE hmod, LPCWSTR lpName)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HICON WINAPI&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a78">LoadIconA</a> (HINSTANCE hmod, LPCSTR lpName)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HICON WINAPI&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a79">LoadIconW</a> (HINSTANCE hmod, LPCWSTR lpName)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HANDLE WINAPI&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a80">LoadImageA</a> (HINSTANCE hmod, LPCSTR lpName, UINT <a class="el" href="../../d4/d4/iafptrap_8c.html#a9">type</a>, int cxDesired, int cyDesired, UINT flags)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HANDLE WINAPI&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a81">LoadImageW</a> (HINSTANCE hmod, LPCWSTR lpName, UINT IMAGE_code, int cxDesired, int cyDesired, UINT flags)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>UINT&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a82">GetIconIdEx</a> (HINSTANCE hmod, HANDLE hrsd, LPCWSTR lpszType, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> cxDesired, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> cyDesired, UINT LR_flags)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HANDLE&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a83">LoadDIB</a> (HINSTANCE hmod, LPCWSTR lpName, LPWSTR <a class="el" href="../../d4/d4/iafptrap_8c.html#a9">type</a>, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> cxDesired, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> cyDesired, UINT LR_flags)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HICON&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a84">LoadIcoCur</a> (HINSTANCE hmod, LPCWSTR pszResName, LPWSTR <a class="el" href="../../d4/d4/iafptrap_8c.html#a9">type</a>, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> cxDesired, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> cyDesired, UINT LR_flags)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HANDLE&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a85">ObjectFromDIBResource</a> (HINSTANCE hmod, LPCWSTR lpName, LPWSTR <a class="el" href="../../d4/d4/iafptrap_8c.html#a9">type</a>, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> cxDesired, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> cyDesired, UINT LR_flags)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HBITMAP&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a86">BitmapFromDIB</a> (int cxNew, int cyNew, WORD bPlanesNew, WORD bBitsPixelNew, UINT LR_flags, int cxOld, int cyOld, LPSTR lpBits, LPBITMAPINFO lpbi, HPALETTE hpal)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a87">HowManyColors</a> (IN <a class="el" href="../../d6/d0/usercli_8h.html#a378">UPBITMAPINFOHEADER</a> upbih, IN BOOL fOldFormat, OUT OPTIONAL LPBYTE *ppColorTable)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a88">ChangeDibColors</a> (IN LPBITMAPINFOHEADER lpbih, IN UINT LR_flags)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HICON&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a89">ConvertDIBIcon</a> (LPBITMAPINFOHEADER lpbih, HINSTANCE hmod, LPCWSTR lpName, BOOL fIcon, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> cxNew, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> cyNew, UINT LR_flags)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a90">TrulyMonochrome</a> (<a class="el" href="../../d0/d5/perfuser_8c.html#a5">LPVOID</a> lpColorTable, BOOL fOldFormat)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>LPBITMAPINFOHEADER&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a91">CopyDibHdr</a> (IN <a class="el" href="../../d6/d0/usercli_8h.html#a378">UPBITMAPINFOHEADER</a> upbih, OUT LPSTR *lplpBits, OUT LPBOOL lpfMono)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HBITMAP&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a92">ConvertDIBBitmap</a> (IN <a class="el" href="../../d6/d0/usercli_8h.html#a378">UPBITMAPINFOHEADER</a> upbih, IN <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> cxDesired, IN <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> cyDesired, IN UINT LR_flags, OUT OPTIONAL LPBITMAPINFOHEADER *lplpbih, IN OUT OPTIONAL LPSTR *lplpBits)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>UINT&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a93">MyAbs</a> (int valueHave, int valueWant)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>UINT&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a94">Magnitude</a> (int nValue)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>UINT&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a95">MatchImage</a> (LPRESDIR lprd, LPINT lpcxWant, LPINT lpcyWant, UINT uColorsWant, BOOL fIcon)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>UINT&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a96">GetBestImage</a> (LPRESDIR lprd, UINT uCount, int cxDesired, int cyDesired, UINT bpp, BOOL fIcon)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>_inline <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a97">GetIcoCurWidth</a> (<a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> cxOrg, BOOL fIcon, UINT lrFlags, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> cxDes)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>_inline <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a98">GetIcoCurHeight</a> (<a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> cyOrg, BOOL fIcon, UINT lrFlags, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> cyDes)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>_inline <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a99">GetIcoCurBpp</a> (UINT lrFlags)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HANDLE&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a100">WOWFindResourceExWCover</a> (HANDLE hmod, LPCWSTR rt, LPCWSTR lpUniName, WORD LangId)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HBITMAP&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a101">WOWLoadBitmapA</a> (HINSTANCE hmod, LPCSTR lpName, LPBYTE pResData, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> cbResData)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HICON&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a102">WowServerLoadCreateCursorIcon</a> (HANDLE hmod, LPWSTR pszModName, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> dwExpWinVer, LPCWSTR lpName, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> cb, PVOID pResData, LPWSTR <a class="el" href="../../d4/d4/iafptrap_8c.html#a9">type</a>, BOOL fClient)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HMENU&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a103">WowServerLoadCreateMenu</a> (HANDLE hMod, LPCSTR lpName, CONST LPMENUTEMPLATE pmt, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> cb, BOOL fCallClient)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>PVOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a104">DIBFromBitmap</a> (HBITMAP hbmp, HDC hdc)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HICON&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a105">CopyImageFromRes</a> (LPWSTR pszModName, LPWSTR pszResName, <a class="el" href="../../d9/d1/structtagCURSORFIND.html">PCURSORFIND</a> pcfSearch, UINT LR_flags)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HICON&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a106">CopyIcoCur</a> (HICON hicoSrc, BOOL fIcon, int cxNew, int cyNew, UINT LR_flags)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HANDLE WINAPI&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a107">CopyImage</a> (HANDLE hImage, UINT IMAGE_flag, int cxNew, int cyNew, UINT LR_flags)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HANDLE&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a108">InternalCopyImage</a> (HANDLE hImage, UINT IMAGE_flag, int cxNew, int cyNew, UINT LR_flags)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>int&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d9/clres_8c.html#a109">RtlGetIdFromDirectory</a> (<a class="el" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a> presbits, BOOL fIcon, int cxDesired, int cyDesired, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> LR_flags, PDWORD pdwResSize)</td></tr>

</table>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="a6" doxytag="clres.c::BMR_BITMAP" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define BMR_BITMAP&nbsp;&nbsp;&nbsp;2          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l00035">35</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a7" doxytag="clres.c::BMR_CURSOR" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define BMR_CURSOR&nbsp;&nbsp;&nbsp;3          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l00036">36</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
Referenced by <a class="el" href="../../d5/d8/clres_8c-source.html#l03546">CopyDibHdr()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a5" doxytag="clres.c::BMR_ICON" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define BMR_ICON&nbsp;&nbsp;&nbsp;1          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l00034">34</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
Referenced by <a class="el" href="../../d5/d8/clres_8c-source.html#l03546">CopyDibHdr()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a0" doxytag="clres.c::BPP01_MAXCOLORS" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define BPP01_MAXCOLORS&nbsp;&nbsp;&nbsp;2          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l00019">19</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
Referenced by <a class="el" href="../../d5/d8/clres_8c-source.html#l03203">ChangeDibColors()</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l03546">CopyDibHdr()</a>, and <a class="el" href="../../d5/d8/clres_8c-source.html#l03903">MatchImage()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="clres.c::BPP04_MAXCOLORS" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define BPP04_MAXCOLORS&nbsp;&nbsp;&nbsp;16          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l00020">20</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
Referenced by <a class="el" href="../../d5/d8/clres_8c-source.html#l03203">ChangeDibColors()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a2" doxytag="clres.c::BPP08_MAXCOLORS" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define BPP08_MAXCOLORS&nbsp;&nbsp;&nbsp;256          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l00021">21</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
Referenced by <a class="el" href="../../d5/d8/clres_8c-source.html#l03203">ChangeDibColors()</a>, and <a class="el" href="../../d5/d8/clres_8c-source.html#l03903">MatchImage()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a13" doxytag="clres.c::FACCEL_VALID" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define FACCEL_VALID&nbsp;&nbsp;&nbsp;(FALT | FCONTROL | FNOINVERT | FSHIFT | FVIRTKEY | FLASTKEY)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l00401">401</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
Referenced by <a class="el" href="../../d5/d8/clres_8c-source.html#l00403">LoadAcc()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a8" doxytag="clres.c::GETINITDC" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define GETINITDC          </td>
          <td class="md" valign="top">(&nbsp;</td>
&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;(<a class="el" href="../../d8/d6/ntuser_2client_2globals_8h.html#a19">gfSystemInitialized</a> ? NtUserGetDC(NULL) : CreateDCW(L"DISPLAY", L"", NULL, NULL))</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l00054">54</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
Referenced by <a class="el" href="../../d5/d8/clres_8c-source.html#l01732">CreateScreenBitmap()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a10" doxytag="clres.c::ISRIFFFORMAT" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ISRIFFFORMAT          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">p&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;(((UNALIGNED RTAG *)(p))-&gt;ckID == FOURCC_RIFF)</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l00060">60</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
Referenced by <a class="el" href="../../d5/d8/clres_8c-source.html#l01627">CreateIconFromResourceEx()</a>, and <a class="el" href="../../d5/d8/clres_8c-source.html#l02847">ObjectFromDIBResource()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a15" doxytag="clres.c::lpbch" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define lpbch&nbsp;&nbsp;&nbsp;((LPBITMAPCOREHEADER)lpbi)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d5/d8/clres_8c-source.html#l02950">BitmapFromDIB()</a>, and <a class="el" href="../../d9/d7/ntuser_2kernel_2clipbrd_8c-source.html#l01189">DIBtoBMP()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a17" doxytag="clres.c::lpRGB" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define lpRGB&nbsp;&nbsp;&nbsp;((UNALIGNED LONG *)lpColorTable)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d5/d8/clres_8c-source.html#l03490">TrulyMonochrome()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a18" doxytag="clres.c::lpRGBw" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define lpRGBw&nbsp;&nbsp;&nbsp;((UNALIGNED WORD *)lpColorTable)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d5/d8/clres_8c-source.html#l03490">TrulyMonochrome()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a14" doxytag="clres.c::MAX_BMPMAP" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define MAX_BMPMAP&nbsp;&nbsp;&nbsp;32          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d5/d8/clres_8c-source.html#l01899">LoadBmp()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a11" doxytag="clres.c::MR_FAILFOR40" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define MR_FAILFOR40&nbsp;&nbsp;&nbsp;0x01          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l00063">63</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
Referenced by <a class="el" href="../../d5/d8/clres_8c-source.html#l01899">LoadBmp()</a>, and <a class="el" href="../../d5/d8/clres_8c-source.html#l02657">LoadIcoCur()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a12" doxytag="clres.c::MR_MONOCHROME" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define MR_MONOCHROME&nbsp;&nbsp;&nbsp;0x02          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l00064">64</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
Referenced by <a class="el" href="../../d5/d8/clres_8c-source.html#l01899">LoadBmp()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a9" doxytag="clres.c::RELEASEINITDC" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define RELEASEINITDC          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">hdc&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;(<a class="el" href="../../d8/d6/ntuser_2client_2globals_8h.html#a19">gfSystemInitialized</a> ? ReleaseDC(NULL, hdc) : DeleteDC(hdc))</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l00057">57</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
Referenced by <a class="el" href="../../d5/d8/clres_8c-source.html#l01732">CreateScreenBitmap()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="clres.c::RESCLR_BLACK" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define RESCLR_BLACK&nbsp;&nbsp;&nbsp;0x00000000          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l00023">23</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
Referenced by <a class="el" href="../../d5/d8/clres_8c-source.html#l02950">BitmapFromDIB()</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l03203">ChangeDibColors()</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l03546">CopyDibHdr()</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l01899">LoadBmp()</a>, and <a class="el" href="../../d5/d8/clres_8c-source.html#l03490">TrulyMonochrome()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a4" doxytag="clres.c::RESCLR_WHITE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define RESCLR_WHITE&nbsp;&nbsp;&nbsp;0x00FFFFFF          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l00024">24</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
Referenced by <a class="el" href="../../d5/d8/clres_8c-source.html#l02950">BitmapFromDIB()</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l03203">ChangeDibColors()</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l03546">CopyDibHdr()</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l01899">LoadBmp()</a>, and <a class="el" href="../../d5/d8/clres_8c-source.html#l03490">TrulyMonochrome()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a19" doxytag="clres.c::upbch" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define upbch&nbsp;&nbsp;&nbsp;((<a class="el" href="../../d6/d0/usercli_8h.html#a379">UPBITMAPCOREHEADER</a>)upbih)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a16" doxytag="clres.c::upbch" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define upbch&nbsp;&nbsp;&nbsp;((<a class="el" href="../../d6/d0/usercli_8h.html#a379">UPBITMAPCOREHEADER</a>)upbih)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d5/d8/clres_8c-source.html#l03546">CopyDibHdr()</a>, and <a class="el" href="../../d5/d8/clres_8c-source.html#l03165">HowManyColors()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a20" doxytag="clres.c::upOldIcoCur" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define upOldIcoCur&nbsp;&nbsp;&nbsp;((<a class="el" href="../../d4/d9/clres_8c.html#a24">UPOLDCURSOR</a>)upbih)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d5/d8/clres_8c-source.html#l03546">CopyDibHdr()</a>.    </td>
  </tr>
</table>
<hr><h2>Typedef Documentation</h2>
<a class="anchor" name="a26" doxytag="clres.c::LPMAPRES" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d6/d0/structtagMAPRES.html">tagMAPRES</a> * <a class="el" href="../../d6/d0/structtagMAPRES.html">LPMAPRES</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d5/d8/clres_8c-source.html#l02657">LoadIcoCur()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a25" doxytag="clres.c::MAPRES" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d6/d0/structtagMAPRES.html">tagMAPRES</a>  <a class="el" href="../../d6/d0/structtagMAPRES.html">MAPRES</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a22" doxytag="clres.c::OLDCURSOR" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d1/d7/struct__OLDCURSOR.html">_OLDCURSOR</a>  <a class="el" href="../../d1/d7/struct__OLDCURSOR.html">OLDCURSOR</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a27" doxytag="clres.c::PMAPRES" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d6/d0/structtagMAPRES.html">tagMAPRES</a> * <a class="el" href="../../d6/d0/structtagMAPRES.html">PMAPRES</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a23" doxytag="clres.c::POLDCURSOR" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d1/d7/struct__OLDCURSOR.html">_OLDCURSOR</a> * <a class="el" href="../../d1/d7/struct__OLDCURSOR.html">POLDCURSOR</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a21" doxytag="clres.c::PRESOURCE_ACCEL" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef   * <a class="el" href="../../d4/d9/clres_8c.html#a21">PRESOURCE_ACCEL</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d5/d8/clres_8c-source.html#l00403">LoadAcc()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a24" doxytag="clres.c::UPOLDCURSOR" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef <a class="el" href="../../d1/d7/struct__OLDCURSOR.html">OLDCURSOR</a> UNALIGNED* <a class="el" href="../../d4/d9/clres_8c.html#a24">UPOLDCURSOR</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l00049">49</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a63" doxytag="clres.c::_FreeResource" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL WINAPI _FreeResource           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HANDLE&nbsp;</td>
          <td class="mdname" nowrap> <em>hResData</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HINSTANCE&nbsp;</td>
          <td class="mdname" nowrap> <em>hModule</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l01499">1499</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>.
<p>
<pre class="fragment"><div>01502 {
01503     UNREFERENCED_PARAMETER(hResData);
01504     UNREFERENCED_PARAMETER(hModule);
01505 
01506     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01507 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a64" doxytag="clres.c::_LockResource" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> LPSTR WINAPI _LockResource           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HANDLE&nbsp;</td>
          <td class="mdname" nowrap> <em>hResData</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HINSTANCE&nbsp;</td>
          <td class="mdname" nowrap> <em>hModule</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l01509">1509</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
<pre class="fragment"><div>01512 {
01513     UNREFERENCED_PARAMETER(hModule);
01514 
01515     <span class="keywordflow">return</span> (LPSTR)(hResData);
01516 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a65" doxytag="clres.c::_UnlockResource" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL WINAPI _UnlockResource           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HANDLE&nbsp;</td>
          <td class="mdname" nowrap> <em>hResData</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HINSTANCE&nbsp;</td>
          <td class="mdname" nowrap> <em>hModule</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l01518">1518</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
<pre class="fragment"><div>01521 {
01522     UNREFERENCED_PARAMETER(hResData);
01523     UNREFERENCED_PARAMETER(hModule);
01524 
01525     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01526 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a36" doxytag="clres.c::AddAccResource" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void AddAccResource           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HACCEL&nbsp;</td>
          <td class="mdname" nowrap> <em>hAccel</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>pRes</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l00327">327</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
References <a class="el" href="../../d6/d0/usercli_8h.html#a394">ACCELCACHE</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l02134">tagACCELCACHE::dwLockCount</a>, <a class="el" href="../../d2/d7/clglobal_8c-source.html#l00092">gcsAccelCache</a>, <a class="el" href="../../d2/d7/clglobal_8c-source.html#l00170">gpac</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l02135">tagACCELCACHE::hAccel</a>, <a class="el" href="../../d1/d0/inc_2user_8h.html#a1179">HMValidateHandleNoDesktop()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l02133">tagACCELCACHE::pacNext</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l02136">tagACCELCACHE::pRes</a>, and <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00913">TYPE_ACCELTABLE</a>.
<p>
Referenced by <a class="el" href="../../d5/d8/clres_8c-source.html#l00403">LoadAcc()</a>.
<p>
<pre class="fragment"><div>00328 {
00329     <a class="code" href="../../d9/d7/structtagACCELCACHE.html">PACCELCACHE</a> pac;
00330 
00331     UserAssert(<a class="code" href="../../d1/d0/inc_2user_8h.html#a1179">HMValidateHandleNoDesktop</a>(hAccel, TYPE_ACCELTABLE));
00332     UserAssert(pRes != NULL);
00333 
00334     <span class="comment">/*</span>
00335 <span class="comment">     * Allocate and initialize a new entry.</span>
00336 <span class="comment">     */</span>
00337     pac = (<a class="code" href="../../d9/d7/structtagACCELCACHE.html">PACCELCACHE</a>)LocalAlloc(LPTR, <span class="keyword">sizeof</span>(<a class="code" href="../../d9/d7/structtagACCELCACHE.html">ACCELCACHE</a>));
00338     <span class="keywordflow">if</span> (pac != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00339         pac-&gt;<a class="code" href="../../d9/d7/structtagACCELCACHE.html#o1">dwLockCount</a> = 1;
00340         pac-&gt;<a class="code" href="../../d9/d7/structtagACCELCACHE.html#o2">hAccel</a> = hAccel;
00341         pac-&gt;<a class="code" href="../../d9/d7/structtagACCELCACHE.html#o3">pRes</a> = pRes;
00342 
00343         <span class="comment">/*</span>
00344 <span class="comment">         * Make it the new head of the list</span>
00345 <span class="comment">         */</span>
00346         RtlEnterCriticalSection(&amp;gcsAccelCache);
00347             pac-&gt;<a class="code" href="../../d9/d7/structtagACCELCACHE.html#o0">pacNext</a> = <a class="code" href="../../d1/d8/clglobal_8c.html#a66">gpac</a>;
00348             <a class="code" href="../../d1/d8/clglobal_8c.html#a66">gpac</a> = pac;
00349         RtlLeaveCriticalSection(&amp;gcsAccelCache);
00350 
00351     }
00352 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a86" doxytag="clres.c::BitmapFromDIB" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HBITMAP BitmapFromDIB           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>cxNew</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>cyNew</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>WORD&nbsp;</td>
          <td class="mdname" nowrap> <em>bPlanesNew</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>WORD&nbsp;</td>
          <td class="mdname" nowrap> <em>bBitsPixelNew</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>LR_flags</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>cxOld</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>cyOld</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>lpBits</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPBITMAPINFO&nbsp;</td>
          <td class="mdname" nowrap> <em>lpbi</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HPALETTE&nbsp;</td>
          <td class="mdname" nowrap> <em>hpal</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l02950">2950</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l01680">Convert1BppToMonoBitmap()</a>, <a class="el" href="../../d9/d7/ntuser_2kernel_2clipbrd_8c-source.html#l01114">CreateScreenBitmap()</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d2/d7/clglobal_8c-source.html#l00090">gcsHdc</a>, <a class="el" href="../../d2/d7/clglobal_8c-source.html#l00101">ghdcBits2</a>, <a class="el" href="../../d4/d9/clres_8c.html#a15">lpbch</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">LPVOID</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01071">PUSIF_PALETTEDISPLAY</a>, <a class="el" href="../../d4/d9/user32_8def-source.html#l00720">RealizePalette</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l00023">RESCLR_BLACK</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l00024">RESCLR_WHITE</a>, <a class="el" href="../../d4/d9/user32_8def-source.html#l00718">SelectPalette</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00299">SetBestStretchMode</a>, <a class="el" href="../../d8/d6/cldib_8c-source.html#l00084">SmartStretchDIBits()</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01076">TEST_PUSIF</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d5/d8/clres_8c-source.html#l03679">ConvertDIBBitmap()</a>, and <a class="el" href="../../d5/d8/clres_8c-source.html#l03344">ConvertDIBIcon()</a>.
<p>
<pre class="fragment"><div>02961 {
02962     HBITMAP hbmpNew = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
02963     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    fStretch;
02964     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    f1Bpp = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
02965 
02966     RtlEnterCriticalSection(&amp;gcsHdc);
02967 
02968     <span class="keywordflow">if</span> (cxNew == 0)
02969         cxNew = cxOld;
02970 
02971     <span class="keywordflow">if</span> (cyNew == 0)
02972         cyNew = cyOld;
02973 
02974     fStretch = ((cxNew != cxOld) || (cyNew != cyOld));
02975 
02976     <span class="comment">/*</span>
02977 <span class="comment">     * If LR_flags indicate DIB-Section, then return that as the</span>
02978 <span class="comment">     * bitmap handle.</span>
02979 <span class="comment">     */</span>
02980     <span class="keywordflow">if</span> (LR_flags &amp; (LR_CREATEDIBSECTION | LR_CREATEREALDIB)) {
02981 
02982         <span class="keywordtype">int</span>   cxTemp;
02983         <span class="keywordtype">int</span>   cyTemp;
02984         <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>  fOldFormat;
02985         <a class="code" href="../../d0/d5/perfuser_8c.html#a5">LPVOID</a> dwDummy;
02986         <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> dwTemp;
02987 
02988 <span class="preprocessor">#define lpbch ((LPBITMAPCOREHEADER)lpbi)</span>
02989 <span class="preprocessor"></span>
02990         fOldFormat = ((WORD)lpbi-&gt;bmiHeader.biSize == <span class="keyword">sizeof</span>(BITMAPCOREHEADER));
02991 
02992         <span class="keywordflow">if</span> (fOldFormat) {
02993 
02994             cxTemp = <a class="code" href="../../d4/d9/clres_8c.html#a15">lpbch</a>-&gt;bcWidth;
02995             cyTemp = <a class="code" href="../../d4/d9/clres_8c.html#a15">lpbch</a>-&gt;bcHeight;
02996 
02997             <a class="code" href="../../d4/d9/clres_8c.html#a15">lpbch</a>-&gt;bcWidth  = (WORD)cxNew;
02998             <a class="code" href="../../d4/d9/clres_8c.html#a15">lpbch</a>-&gt;bcHeight = (WORD)cyNew;
02999 
03000         } <span class="keywordflow">else</span> {
03001 
03002             cxTemp = lpbi-&gt;bmiHeader.biWidth;
03003             cyTemp = lpbi-&gt;bmiHeader.biHeight;
03004             dwTemp = lpbi-&gt;bmiHeader.biCompression;
03005 
03006             lpbi-&gt;bmiHeader.biWidth  = cxNew;
03007             lpbi-&gt;bmiHeader.biHeight = cyNew;
03008 
03009             <span class="keywordflow">if</span> (dwTemp != BI_BITFIELDS)
03010                 lpbi-&gt;bmiHeader.biCompression = BI_RGB;
03011         }
03012 
03013         <span class="keywordflow">if</span> (LR_flags &amp; LR_CREATEREALDIB) {
03014             hbmpNew = CreateDIBitmap(ghdcBits2,
03015                                      (LPBITMAPINFOHEADER)lpbi,
03016                                      CBM_CREATEDIB,
03017                                      NULL,
03018                                      lpbi,
03019                                      DIB_RGB_COLORS);
03020         } <span class="keywordflow">else</span> {
03021             hbmpNew = CreateDIBSection(ghdcBits2,
03022                                        lpbi,
03023                                        DIB_RGB_COLORS,
03024                                        &amp;dwDummy,
03025                                        0,
03026                                        0);
03027         }
03028 
03029         <span class="keywordflow">if</span> (fOldFormat) {
03030             <a class="code" href="../../d4/d9/clres_8c.html#a15">lpbch</a>-&gt;bcWidth  = (WORD)cxTemp;
03031             <a class="code" href="../../d4/d9/clres_8c.html#a15">lpbch</a>-&gt;bcHeight = (WORD)cyTemp;
03032         } <span class="keywordflow">else</span> {
03033             lpbi-&gt;bmiHeader.biWidth       = cxTemp;
03034             lpbi-&gt;bmiHeader.biHeight      = cyTemp;
03035             lpbi-&gt;bmiHeader.biCompression = dwTemp;
03036         }
03037 <span class="preprocessor">#undef lpbch</span>
03038 <span class="preprocessor"></span>    }
03039 
03040     <span class="keywordflow">if</span> (hbmpNew == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
03041 
03042         hbmpNew = <a class="code" href="../../d8/d8/ntuser_2kernel_2clipbrd_8c.html#a28">CreateScreenBitmap</a>(cxNew,
03043                                      cyNew,
03044                                      bPlanesNew,
03045                                      bBitsPixelNew,
03046                                      NULL,
03047                                      &amp;f1Bpp);
03048     }
03049 
03050     <span class="keywordflow">if</span> (hbmpNew) {
03051 
03052         <span class="keywordtype">int</span>     nStretchMode;
03053         <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>   rgbBk;
03054         <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>   rgbText;
03055         HBITMAP hbmpT;
03056         <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    fFail;
03057 
03058         <span class="comment">/*</span>
03059 <span class="comment">         * We need to select in appropriate bitmap immediately!  That way,</span>
03060 <span class="comment">         * if we need to handle palette realization, the color matching</span>
03061 <span class="comment">         * will work properly.</span>
03062 <span class="comment">         */</span>
03063         hbmpT = SelectBitmap(ghdcBits2, hbmpNew);
03064 
03065         <span class="comment">/*</span>
03066 <span class="comment">         * Setup for stretching</span>
03067 <span class="comment">         */</span>
03068         <span class="keywordflow">if</span> (fStretch) {
03069             nStretchMode = <a class="code" href="../../d6/d0/usercli_8h.html#a31">SetBestStretchMode</a>(ghdcBits2,
03070                                               bPlanesNew,
03071                                               bBitsPixelNew);
03072         }
03073 
03074         rgbBk   = SetBkColor(ghdcBits2, RESCLR_WHITE);
03075         rgbText = SetTextColor(ghdcBits2, RESCLR_BLACK);
03076 
03077         <span class="comment">/*</span>
03078 <span class="comment">         * Realize the palette.</span>
03079 <span class="comment">         */</span>
03080         <span class="keywordflow">if</span> (hpal) {
03081 <span class="preprocessor">#if DBG</span>
03082 <span class="preprocessor"></span>            UserAssert(<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a368">TEST_PUSIF</a>(PUSIF_PALETTEDISPLAY));
03083 <span class="preprocessor">#endif // DBG</span>
03084 <span class="preprocessor"></span>
03085             hpal = <a class="code" href="../../d3/d0/user32_8def.html#a83">SelectPalette</a>(ghdcBits2, hpal, FALSE);
03086             <a class="code" href="../../d3/d0/user32_8def.html#a84">RealizePalette</a>(ghdcBits2);
03087         }
03088 
03089         <span class="keywordflow">if</span> (fStretch) {
03090 
03091             fFail = <a class="code" href="../../d6/d0/usercli_8h.html#a661">SmartStretchDIBits</a>(ghdcBits2,
03092                                0,
03093                                0,
03094                                cxNew,
03095                                cyNew,
03096                                0,
03097                                0,
03098                                cxOld,
03099                                cyOld,
03100                                lpBits,
03101                                lpbi,
03102                                DIB_RGB_COLORS,
03103                                SRCCOPY) &lt;= 0;
03104         } <span class="keywordflow">else</span> {
03105 
03106             fFail = SetDIBits(ghdcBits2,
03107                       hbmpNew,
03108                       0,
03109                       cyNew,
03110                       lpBits,
03111                       lpbi,
03112                       DIB_RGB_COLORS) &lt;= 0;
03113         }
03114 
03115         <span class="comment">/*</span>
03116 <span class="comment">         * Unrealize the palette</span>
03117 <span class="comment">         */</span>
03118         <span class="keywordflow">if</span> (hpal) {
03119             <a class="code" href="../../d3/d0/user32_8def.html#a83">SelectPalette</a>(ghdcBits2, hpal, TRUE);
03120             <a class="code" href="../../d3/d0/user32_8def.html#a84">RealizePalette</a>(ghdcBits2);
03121         }
03122 
03123         <span class="comment">/*</span>
03124 <span class="comment">         * Cleanup after stretching</span>
03125 <span class="comment">         */</span>
03126         SetTextColor(ghdcBits2, rgbText);
03127         SetBkColor(ghdcBits2, rgbBk);
03128         <span class="keywordflow">if</span> (fStretch)
03129             SetStretchBltMode(ghdcBits2, nStretchMode);
03130 
03131         SelectBitmap(ghdcBits2, hbmpT);
03132 
03133         <span class="comment">/*</span>
03134 <span class="comment">         * If the SetDIBits() of StretchDIBits() failed, it is probably because</span>
03135 <span class="comment">         * GDI or the driver did not like the DIB format.  This may happen if</span>
03136 <span class="comment">         * the file is truncated and we are using a memory mapped file to read</span>
03137 <span class="comment">         * the DIB in.  In this case, an exception gets thrown in GDI, that it</span>
03138 <span class="comment">         * traps and will return failure from the GDI call.</span>
03139 <span class="comment">         */</span>
03140 
03141         <span class="keywordflow">if</span> (fFail) {
03142             DeleteObject(hbmpNew);
03143             hbmpNew = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
03144         }
03145     }
03146 
03147     <span class="comment">/*</span>
03148 <span class="comment">     * If the bitmap was created as a 1bpp, we need to convert to a</span>
03149 <span class="comment">     * true mono-bitmap.  GDI performs different color-matching depending</span>
03150 <span class="comment">     * upon this case.</span>
03151 <span class="comment">     */</span>
03152     <span class="keywordflow">if</span> (f1Bpp &amp;&amp; hbmpNew)
03153         hbmpNew = <a class="code" href="../../d4/d9/clres_8c.html#a71">Convert1BppToMonoBitmap</a>(ghdcBits2, hbmpNew);
03154 
03155     RtlLeaveCriticalSection(&amp;gcsHdc);
03156     <span class="keywordflow">return</span> hbmpNew;
03157 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a88" doxytag="clres.c::ChangeDibColors" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID ChangeDibColors           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN LPBITMAPINFOHEADER&nbsp;</td>
          <td class="mdname" nowrap> <em>lpbih</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>LR_flags</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l03203">3203</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
References <a class="el" href="../../d5/d8/clres_8c-source.html#l00019">BPP01_MAXCOLORS</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l00020">BPP04_MAXCOLORS</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l00021">BPP08_MAXCOLORS</a>, <a class="el" href="../../d3/d4/mips_2flush_8c-source.html#l00027">ChangeColor</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l03165">HowManyColors()</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l00023">RESCLR_BLACK</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l00024">RESCLR_WHITE</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00307">RGBX</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00204">SYSRGB</a>, <a class="el" href="../../d0/d5/ndismain_8h-source.html#l00026">UINT</a>, <a class="el" href="../../d2/d7/hal_8h.html#a212">VOID()</a>, and <a class="el" href="../../d7/d9/usercli_8h-source.html#l02070">WINDOW</a>.
<p>
Referenced by <a class="el" href="../../d5/d8/clres_8c-source.html#l03679">ConvertDIBBitmap()</a>, and <a class="el" href="../../d5/d8/clres_8c-source.html#l03344">ConvertDIBIcon()</a>.
<p>
<pre class="fragment"><div>03206 {
03207     LPDWORD lpColorTable;
03208     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>  rgb;
03209     <a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a>   iColor;
03210     <a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a>   cColors;
03211 
03212     cColors = <a class="code" href="../../d4/d9/clres_8c.html#a87">HowManyColors</a>(lpbih, FALSE, &amp;(LPBYTE)lpColorTable);
03213 
03214     <span class="comment">/*</span>
03215 <span class="comment">     * NT Bug 366661: Don't check the color count here b/c we will do different</span>
03216 <span class="comment">     * things depending on what type of change we are performing.  For example,</span>
03217 <span class="comment">     * when loading hi-color/true-color icons, we always need to do the </span>
03218 <span class="comment">     * monochrome conversion in order to properly get an icon-mask.</span>
03219 <span class="comment">     */</span>
03220 
03221     <span class="comment">/*</span>
03222 <span class="comment">     * LR_MONOCHROME is the only option that handles PM dibs.</span>
03223 <span class="comment">     */</span>
03224     <span class="keywordflow">if</span> (LR_flags &amp; LR_MONOCHROME) {
03225         <span class="comment">/*</span>
03226 <span class="comment">         * LR_MONOCHROME is the only option that handles PM dibs.</span>
03227 <span class="comment">         *</span>
03228 <span class="comment">         * DO THIS NO MATTER WHETHER WE HAVE A COLOR TABLE!  We need </span>
03229 <span class="comment">         * to do this for mono conversion and for &gt; 8 BPP </span>
03230 <span class="comment">         * icons/cursors.  In CopyDibHdr, we already made a copy of </span>
03231 <span class="comment">         * the header big enough to hold 2 colors even on 16 and 24 </span>
03232 <span class="comment">         * BPP images.</span>
03233 <span class="comment">         */</span>
03234 
03235         lpbih-&gt;biBitCount = lpbih-&gt;biPlanes = 1;
03236         lpColorTable[0] = <a class="code" href="../../d4/d9/clres_8c.html#a3">RESCLR_BLACK</a>;
03237         lpColorTable[1] = <a class="code" href="../../d4/d9/clres_8c.html#a4">RESCLR_WHITE</a>;
03238     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (LR_flags &amp; LR_LOADTRANSPARENT) {
03239 
03240         LPBYTE pb;
03241 
03242         <span class="comment">/*</span>
03243 <span class="comment">         * No color table!  Do nothing.</span>
03244 <span class="comment">         */</span>
03245         <span class="keywordflow">if</span> (cColors == 0) {
03246             RIPMSG0(RIP_WARNING, <span class="stringliteral">"ChangeDibColors: DIB doesn't have a color table"</span>);
03247             <span class="keywordflow">return</span>;
03248         }
03249 
03250         pb = (LPBYTE)(lpColorTable + cColors);
03251 
03252         <span class="comment">/*</span>
03253 <span class="comment">         * Change the first pixel's color table entry to RGB_WINDOW</span>
03254 <span class="comment">         * Gosh, I love small-endian</span>
03255 <span class="comment">         */</span>
03256         <span class="keywordflow">if</span> (lpbih-&gt;biCompression == 0)
03257             iColor = (<a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a>)pb[0];
03258         <span class="keywordflow">else</span>
03259             <span class="comment">/*</span>
03260 <span class="comment">             * RLE bitmap, will start with cnt,clr  or  0,cnt,clr</span>
03261 <span class="comment">             */</span>
03262             iColor = (<a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a>)(pb[0] == 0 ? pb[2] : pb[1]);
03263 
03264         <span class="keywordflow">switch</span> (cColors) {
03265         <span class="keywordflow">case</span> <a class="code" href="../../d4/d9/clres_8c.html#a0">BPP01_MAXCOLORS</a>:
03266             iColor &amp;= 0x01;
03267             <span class="keywordflow">break</span>;
03268 
03269         <span class="keywordflow">case</span> <a class="code" href="../../d4/d9/clres_8c.html#a1">BPP04_MAXCOLORS</a>:
03270             iColor &amp;= 0x0F;
03271             <span class="keywordflow">break</span>;
03272 
03273         <span class="keywordflow">case</span> <a class="code" href="../../d4/d9/clres_8c.html#a2">BPP08_MAXCOLORS</a>:
03274             iColor &amp;= 0xFF;
03275             <span class="keywordflow">break</span>;
03276         }
03277 
03278         rgb = (LR_flags &amp; LR_LOADMAP3DCOLORS ? <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a20">SYSRGB</a>(3DFACE) : <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a20">SYSRGB</a>(<a class="code" href="../../d6/d0/usercli_8h.html#a273">WINDOW</a>));
03279 
03280         lpColorTable[iColor] = <a class="code" href="../../d6/d0/usercli_8h.html#a34">RGBX</a>(rgb);
03281 
03282     } <span class="keywordflow">else</span>  <span class="keywordflow">if</span> (LR_flags &amp; LR_LOADMAP3DCOLORS) {
03283 
03284         <span class="comment">/*</span>
03285 <span class="comment">         * Fix up the color table, mapping shades of grey to the current</span>
03286 <span class="comment">         * 3D colors.</span>
03287 <span class="comment">         */</span>
03288         <span class="keywordflow">for</span> (iColor = 0; iColor &lt; cColors; iColor++) {
03289 
03290             <span class="keywordflow">switch</span> (*lpColorTable &amp; 0x00FFFFFF) {
03291 
03292             <span class="keywordflow">case</span> <a class="code" href="../../d6/d0/usercli_8h.html#a34">RGBX</a>(RGB(223, 223, 223)):
03293                 rgb = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a20">SYSRGB</a>(3DLIGHT);
03294                 <span class="keywordflow">goto</span> <a class="code" href="../../d2/d5/mips_2flush_8c.html#a0">ChangeColor</a>;
03295 
03296             <span class="keywordflow">case</span> <a class="code" href="../../d6/d0/usercli_8h.html#a34">RGBX</a>(RGB(192, 192, 192)):
03297                 rgb = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a20">SYSRGB</a>(3DFACE);
03298                 <span class="keywordflow">goto</span> <a class="code" href="../../d2/d5/mips_2flush_8c.html#a0">ChangeColor</a>;
03299 
03300             <span class="keywordflow">case</span> <a class="code" href="../../d6/d0/usercli_8h.html#a34">RGBX</a>(RGB(128, 128, 128)):
03301                 rgb = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a20">SYSRGB</a>(3DSHADOW);
03302 
03303                 <span class="comment">/*</span>
03304 <span class="comment">                 * NOTE: byte-order is different in DIBs than in RGBs</span>
03305 <span class="comment">                 */</span>
03306 <a class="code" href="../../d2/d5/mips_2flush_8c.html#a0">ChangeColor</a>:
03307                 *lpColorTable = <a class="code" href="../../d6/d0/usercli_8h.html#a34">RGBX</a>(rgb);
03308                 <span class="keywordflow">break</span>;
03309             }
03310             lpColorTable++;
03311         }
03312     }
03313 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a71" doxytag="clres.c::Convert1BppToMonoBitmap" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HBITMAP Convert1BppToMonoBitmap           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HDC&nbsp;</td>
          <td class="mdname" nowrap> <em>hdcSrc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HBITMAP&nbsp;</td>
          <td class="mdname" nowrap> <em>hbm1Bpp</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l01680">1680</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
References <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>.
<p>
Referenced by <a class="el" href="../../d5/d8/clres_8c-source.html#l02950">BitmapFromDIB()</a>, and <a class="el" href="../../d5/d8/clres_8c-source.html#l01899">LoadBmp()</a>.
<p>
<pre class="fragment"><div>01683 {
01684     HBITMAP hbmMono = hbm1Bpp;
01685     HBITMAP hbmDst;
01686     HBITMAP hbmS;
01687     HBITMAP hbmD;
01688     HDC     hdcDst;
01689     BITMAP  bm;
01690 
01691     <span class="keywordflow">if</span> (hdcDst = CreateCompatibleDC(hdcSrc)) {
01692 
01693         GetObject(hbm1Bpp, <span class="keyword">sizeof</span>(BITMAP), &amp;bm);
01694 
01695         <span class="keywordflow">if</span> (hbmDst = CreateBitmap(bm.bmWidth, bm.bmHeight, 1, 1, NULL)) {
01696 
01697             hbmS = SelectBitmap(hdcSrc, hbm1Bpp);
01698             hbmD = SelectBitmap(hdcDst, hbmDst);
01699 
01700             BitBlt(hdcDst,
01701                    0,
01702                    0,
01703                    bm.bmWidth,
01704                    bm.bmHeight,
01705                    hdcSrc,
01706                    0,
01707                    0,
01708                    SRCCOPY);
01709 
01710             SelectBitmap(hdcSrc, hbmS);
01711             SelectBitmap(hdcDst, hbmD);
01712 
01713             hbmMono = hbmDst;
01714             DeleteObject(hbm1Bpp);
01715         }
01716 
01717         DeleteDC(hdcDst);
01718     }
01719 
01720     <span class="keywordflow">return</span> hbmMono;
01721 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a92" doxytag="clres.c::ConvertDIBBitmap" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HBITMAP ConvertDIBBitmap           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d6/d0/usercli_8h.html#a378">UPBITMAPINFOHEADER</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>upbih</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>cxDesired</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>cyDesired</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>LR_flags</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT OPTIONAL LPBITMAPINFOHEADER *&nbsp;</td>
          <td class="mdname" nowrap> <em>lplpbih</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN OUT OPTIONAL LPSTR *&nbsp;</td>
          <td class="mdname" nowrap> <em>lplpBits</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l03679">3679</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
References <a class="el" href="../../d5/d8/clres_8c-source.html#l02950">BitmapFromDIB()</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00305">BitmapWidth</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d0/d7/halvprnt_8c-source.html#l00031">BYTE</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l03203">ChangeDibColors()</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l03546">CopyDibHdr()</a>, <a class="el" href="../../d2/d7/clglobal_8c-source.html#l00051">gpsi</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00202">SYSMET</a>, and <a class="el" href="../../d7/d9/usercli_8h-source.html#l00960">UserLocalFree</a>.
<p>
<pre class="fragment"><div>03686 {
03687     LPBITMAPINFOHEADER lpbihNew;
03688     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>               fMono, fMonoGiven;
03689     <a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a>               bPlanesDesired;
03690     <a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a>               bppDesired;
03691     LPSTR              lpBits;
03692     HBITMAP            hBmpRet;
03693 
03694     <span class="comment">/*</span>
03695 <span class="comment">     * Make a copy of the DIB-Header.  This returns a pointer</span>
03696 <span class="comment">     * which was allocated, so it must be freed later.</span>
03697 <span class="comment">     * The also converts the header to BITMAPINFOHEADER format.</span>
03698 <span class="comment">     */</span>
03699     <span class="keywordflow">if</span> ((lpbihNew = <a class="code" href="../../d4/d9/clres_8c.html#a91">CopyDibHdr</a>(upbih, &amp;lpBits, &amp;fMono)) == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
03700         <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
03701 
03702     <span class="comment">/*</span>
03703 <span class="comment">     * When loading a DIB file, we may need to use a different</span>
03704 <span class="comment">     * bits pointer.  See RtlRes.c/RtlLoadObjectFromDIBFile.</span>
03705 <span class="comment">     */</span>
03706     <span class="keywordflow">if</span> (lplpBits &amp;&amp; *lplpBits)
03707         lpBits = *lplpBits;
03708 
03709     fMonoGiven = fMono;
03710 
03711     <span class="keywordflow">if</span> (!fMono) {
03712 
03713         <span class="keywordflow">if</span> (LR_flags &amp; (LR_LOADTRANSPARENT | LR_LOADMAP3DCOLORS))
03714             <a class="code" href="../../d4/d9/clres_8c.html#a88">ChangeDibColors</a>(lpbihNew, LR_flags &amp; ~LR_MONOCHROME);
03715 
03716         bPlanesDesired = <a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;Planes;
03717         bppDesired     = <a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;BitsPixel;
03718         fMono          = LR_flags &amp; LR_MONOCHROME;
03719     }
03720 
03721     <span class="keywordflow">if</span> (fMono) {
03722         bPlanesDesired =
03723         bppDesired     = 1;
03724     }
03725 
03726     <span class="comment">/*</span>
03727 <span class="comment">     * HACK area</span>
03728 <span class="comment">     */</span>
03729     <span class="keywordflow">if</span> (lplpbih != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
03730 
03731         <span class="comment">/*</span>
03732 <span class="comment">         * pass back the translated/copied header</span>
03733 <span class="comment">         */</span>
03734         *lplpbih = lpbihNew;
03735 
03736         <span class="comment">/*</span>
03737 <span class="comment">         * When loading icon/cursors on a system with multiple monitors</span>
03738 <span class="comment">         * with different color depths, always convert to VGA color.</span>
03739 <span class="comment">         */</span>
03740         <span class="keywordflow">if</span> (!fMono &amp;&amp; !<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(SAMEDISPLAYFORMAT)) {
03741             bPlanesDesired = 1;
03742             bppDesired = 4;
03743         }
03744 
03745         <span class="comment">/*</span>
03746 <span class="comment">         * Return a ponter to the bits following this set of bits</span>
03747 <span class="comment">         * if there are any there.</span>
03748 <span class="comment">         *</span>
03749 <span class="comment">         * Note that the header given with an ICON DIB always reflects</span>
03750 <span class="comment">         * twice the height of the icon desired but the COLOR bitmap</span>
03751 <span class="comment">         * (if there is one) will only be half that high.  We need to</span>
03752 <span class="comment">         * fixup cyDesired for monochrome icons so that the mask isnt</span>
03753 <span class="comment">         * stretched to half the height its supposed to be.  Color</span>
03754 <span class="comment">         * bitmaps, however, must have the header corrected to reflect</span>
03755 <span class="comment">         * the bits actual height which is half what the header said.</span>
03756 <span class="comment">         * The correction must later be backed out so that the returned</span>
03757 <span class="comment">         * header reflects the dimensions of the XOR mask that immediately</span>
03758 <span class="comment">         * follows the color mask.</span>
03759 <span class="comment">         */</span>
03760         <span class="keywordflow">if</span> (fMonoGiven) {
03761 
03762             *lplpBits = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
03763 
03764             <span class="keywordflow">if</span> (cyDesired)
03765                 cyDesired &lt;&lt;= 1;    <span class="comment">// mono icon bitmaps are double high.</span>
03766 
03767         } <span class="keywordflow">else</span> {
03768 
03769             UserAssert(!(lpbihNew-&gt;biHeight &amp; 1));
03770             lpbihNew-&gt;biHeight &gt;&gt;= 1;  <span class="comment">// color icon headers are off by 2</span>
03771 
03772             <span class="comment">/*</span>
03773 <span class="comment">             * Gross calculation!  We subtract the XOR part of the mask</span>
03774 <span class="comment">             * for this calculation so that we submit a double-high mask.</span>
03775 <span class="comment">             * The first half of this is garbage, but for icons its not</span>
03776 <span class="comment">             * used.  This may be a bug for cursor use of icons.</span>
03777 <span class="comment">             */</span>
03778             *lplpBits = lpBits +
03779                     (<a class="code" href="../../d6/d0/usercli_8h.html#a33">BitmapWidth</a>(lpbihNew-&gt;biWidth, lpbihNew-&gt;biBitCount) -
03780                     <a class="code" href="../../d6/d0/usercli_8h.html#a33">BitmapWidth</a>(lpbihNew-&gt;biWidth, 1)) *
03781                     lpbihNew-&gt;biHeight;
03782         }
03783     }
03784 
03785     <span class="keywordflow">if</span> (cxDesired == 0)
03786         cxDesired = lpbihNew-&gt;biWidth;
03787 
03788     <span class="keywordflow">if</span> (cyDesired == 0)
03789         cyDesired = lpbihNew-&gt;biHeight;
03790 
03791     hBmpRet = <a class="code" href="../../d4/d9/clres_8c.html#a86">BitmapFromDIB</a>(cxDesired,
03792                             cyDesired,
03793                             bPlanesDesired,
03794                             bppDesired,
03795                             LR_flags,
03796                             lpbihNew-&gt;biWidth,
03797                             lpbihNew-&gt;biHeight,
03798                             lpBits,
03799                             (LPBITMAPINFO)lpbihNew,
03800                             NULL);
03801 
03802     <span class="keywordflow">if</span> (lplpbih == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> || hBmpRet == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
03803         <a class="code" href="../../d6/d0/usercli_8h.html#a138">UserLocalFree</a>(lpbihNew);
03804     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!fMonoGiven) {
03805         lpbihNew-&gt;biHeight &lt;&lt;= 1;   <span class="comment">// restore header for next mask</span>
03806     }
03807 
03808     <span class="keywordflow">return</span> hBmpRet;
03809 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a89" doxytag="clres.c::ConvertDIBIcon" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HICON ConvertDIBIcon           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">LPBITMAPINFOHEADER&nbsp;</td>
          <td class="mdname" nowrap> <em>lpbih</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HINSTANCE&nbsp;</td>
          <td class="mdname" nowrap> <em>hmod</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPCWSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>lpName</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>BOOL&nbsp;</td>
          <td class="mdname" nowrap> <em>fIcon</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>cxNew</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>cyNew</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>LR_flags</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l03344">3344</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
References <a class="el" href="../../d5/d8/clres_8c-source.html#l02950">BitmapFromDIB()</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l03203">ChangeDibColors()</a>, <a class="el" href="../../d6/d0/usercli_8h.html#a659">ConvertDIBBitmap()</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l01029">CreateIcoCur()</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02178">CURSORF_ACONFRAME</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02173">CURSORF_FROMRESOURCE</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02174">CURSORF_GLOBAL</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02175">CURSORF_LRSHARED</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d2/d7/clglobal_8c-source.html#l00053">hmodUser</a>, <a class="el" href="../../d0/d5/ndismain_8h-source.html#l00025">INT</a>, <a class="el" href="../../d4/d8/arcinst_8c-source.html#l00065">MAX_PATH</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00624">MultDiv</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00411">PTR_TO_ID</a>, <a class="el" href="../../d2/d7/clglobal_8c-source.html#l00063">szUSER32</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00960">UserLocalFree</a>, and <a class="el" href="../../d5/d8/clres_8c-source.html#l00128">WowGetModuleFileName()</a>.
<p>
Referenced by <a class="el" href="../../d5/d8/clres_8c-source.html#l01627">CreateIconFromResourceEx()</a>, <a class="el" href="../../d4/d3/client_2acons_8c-source.html#l00279">LoadCursorIconFromFileMap()</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l02847">ObjectFromDIBResource()</a>, <a class="el" href="../../d4/d3/client_2acons_8c-source.html#l00700">ReadIconFromFileMap()</a>, and <a class="el" href="../../d5/d8/clres_8c-source.html#l04200">WowServerLoadCreateCursorIcon()</a>.
<p>
<pre class="fragment"><div>03352 {
03353     LPBITMAPINFOHEADER lpbihNew = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
03354     LPSTR              lpBitsNextMask = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
03355     HICON              hicoNew = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
03356     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>               fOldFormat = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
03357     <a class="code" href="../../d8/d1/structtagCURSORDATA.html">CURSORDATA</a>         cur;
03358     WCHAR              achModName[<a class="code" href="../../d3/d9/arcinst_8c.html#a6">MAX_PATH</a>];
03359 
03360     <span class="comment">/*</span>
03361 <span class="comment">     * Because Icons/Cursors always get public bitmaps, we cannot use</span>
03362 <span class="comment">     * LR_CREATEDIBSECTION on them.</span>
03363 <span class="comment">     */</span>
03364     <span class="keywordflow">if</span> (LR_flags &amp; LR_CREATEDIBSECTION)
03365         LR_flags = (LR_flags &amp; ~LR_CREATEDIBSECTION) | LR_CREATEREALDIB;
03366 
03367     RtlZeroMemory(&amp;cur, <span class="keyword">sizeof</span>(cur));
03368 
03369     <span class="keywordflow">if</span> (!fIcon) {
03370         <span class="comment">/*</span>
03371 <span class="comment">         * Cursors have an extra two words preceeding the BITMAPINFOHEADER</span>
03372 <span class="comment">         * indicating the hot-spot.  After doing the increments, the</span>
03373 <span class="comment">         * pointer should be at the dib-header.</span>
03374 <span class="comment">         */</span>
03375         cur.<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o8">xHotspot</a> = (<span class="keywordtype">short</span>)(<span class="keywordtype">int</span>)*(((LPWORD)lpbih)++);
03376         cur.<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o9">yHotspot</a> = (<span class="keywordtype">short</span>)(<span class="keywordtype">int</span>)*(((LPWORD)lpbih)++);
03377     }
03378 
03379     <span class="comment">/*</span>
03380 <span class="comment">     * Get the XOR/Color mask.</span>
03381 <span class="comment">     * The XOR bits are first in the DIB because the header info</span>
03382 <span class="comment">     * pertains to them.</span>
03383 <span class="comment">     * The AND mask is always monochrome.</span>
03384 <span class="comment">     */</span>
03385     lpBitsNextMask = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;  <span class="comment">// not passing lpBits in.</span>
03386     cur.<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o11">hbmColor</a> = <a class="code" href="../../d6/d0/usercli_8h.html#a659">ConvertDIBBitmap</a>(lpbih,
03387                                     cxNew,
03388                                     cyNew,
03389                                     LR_flags,
03390                                     &amp;lpbihNew,
03391                                     &amp;lpBitsNextMask);
03392     <span class="keywordflow">if</span> (cur.<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o11">hbmColor</a> == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
03393         <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
03394 
03395     <span class="keywordflow">if</span> (hmod == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
03396         cur.<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o2">lpModName</a> = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
03397     } <span class="keywordflow">else</span> {
03398         cur.<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o0">CURSORF_flags</a> = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a534">CURSORF_FROMRESOURCE</a>;
03399         <span class="keywordflow">if</span> (hmod == <a class="code" href="../../d1/d8/clglobal_8c.html#a6">hmodUser</a>) {
03400             cur.<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o2">lpModName</a>     = <a class="code" href="../../d1/d8/clglobal_8c.html#a12">szUSER32</a>;
03401         } <span class="keywordflow">else</span>  {
03402             <a class="code" href="../../d6/d0/usercli_8h.html#a647">WowGetModuleFileName</a>(hmod,
03403                               achModName,
03404                               <span class="keyword">sizeof</span>(achModName) / <span class="keyword">sizeof</span>(WCHAR));
03405             cur.<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o2">lpModName</a> = achModName;
03406         }
03407     }
03408     cur.<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o3">rt</a>     = (fIcon ? <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a99">PTR_TO_ID</a>(RT_ICON) : <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a99">PTR_TO_ID</a>(RT_CURSOR));
03409     cur.<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o1">lpName</a> = (LPWSTR)lpName;
03410     cur.<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o5">bpp</a>    = lpbihNew-&gt;biBitCount * lpbihNew-&gt;biPlanes;
03411 
03412     <span class="keywordflow">if</span> (cxNew == 0)
03413         cxNew = lpbihNew-&gt;biWidth;
03414 
03415     <span class="keywordflow">if</span> (cyNew == 0)
03416         cyNew = lpbihNew-&gt;biHeight / 2;
03417 
03418     <span class="keywordflow">if</span> (!fIcon) {
03419 
03420         cur.<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o8">xHotspot</a> = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a141">MultDiv</a>(cur.<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o8">xHotspot</a>,
03421                                cxNew,
03422                                lpbihNew-&gt;biWidth);
03423         cur.<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o9">yHotspot</a> = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a141">MultDiv</a>(cur.<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o9">yHotspot</a>,
03424                                cyNew,
03425                                lpbihNew-&gt;biHeight / 2);
03426     } <span class="keywordflow">else</span> {
03427 
03428         <span class="comment">/*</span>
03429 <span class="comment">         * For an icon the hot spot is the center of the icon</span>
03430 <span class="comment">         */</span>
03431         cur.<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o8">xHotspot</a> = (<a class="code" href="../../d9/d5/ndismain_8h.html#a263">INT</a>)(cxNew) / 2;
03432         cur.<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o9">yHotspot</a> = (<a class="code" href="../../d9/d5/ndismain_8h.html#a263">INT</a>)(cyNew) / 2;
03433     }
03434 
03435     <span class="comment">/*</span>
03436 <span class="comment">     * Setup header for monochrome DIB.  Note that we use the COPY.</span>
03437 <span class="comment">     */</span>
03438     <a class="code" href="../../d4/d9/clres_8c.html#a88">ChangeDibColors</a>(lpbihNew, LR_MONOCHROME);
03439 
03440     <span class="keywordflow">if</span> (lpBitsNextMask != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
03441         cur.<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o10">hbmMask</a> = <a class="code" href="../../d4/d9/clres_8c.html#a86">BitmapFromDIB</a>(cxNew,
03442                                     cyNew * 2,
03443                                     1,
03444                                     1,
03445                                     0,
03446                                     lpbihNew-&gt;biWidth,
03447                                     lpbihNew-&gt;biHeight,
03448                                     lpBitsNextMask,
03449                                     (LPBITMAPINFO)lpbihNew,
03450                                     NULL);
03451         <span class="keywordflow">if</span> (cur.<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o10">hbmMask</a> == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
03452             DeleteObject(cur.<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o11">hbmColor</a>);
03453             <a class="code" href="../../d6/d0/usercli_8h.html#a138">UserLocalFree</a>(lpbihNew);
03454             <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
03455         }
03456 
03457     } <span class="keywordflow">else</span> {
03458         cur.<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o10">hbmMask</a> = cur.<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o11">hbmColor</a>;
03459         cur.<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o11">hbmColor</a> = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
03460     }
03461 
03462     cur.<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o6">cx</a> = cxNew;
03463     cur.<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o7">cy</a> = cyNew * 2;
03464 
03465     <span class="comment">/*</span>
03466 <span class="comment">     * Free our dib header copy allocated by ConvertDIBBitmap</span>
03467 <span class="comment">     */</span>
03468     <a class="code" href="../../d6/d0/usercli_8h.html#a138">UserLocalFree</a>(lpbihNew);
03469 
03470     <span class="keywordflow">if</span> (LR_flags &amp; LR_SHARED)
03471         cur.<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o0">CURSORF_flags</a> |= <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a536">CURSORF_LRSHARED</a>;
03472 
03473     <span class="keywordflow">if</span> (LR_flags &amp; LR_GLOBAL)
03474         cur.<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o0">CURSORF_flags</a> |= <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a535">CURSORF_GLOBAL</a>;
03475 
03476     <span class="keywordflow">if</span> (LR_flags &amp; LR_ACONFRAME)
03477         cur.<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o0">CURSORF_flags</a> |= <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a539">CURSORF_ACONFRAME</a>;
03478 
03479     <span class="keywordflow">return</span> <a class="code" href="../../d4/d9/clres_8c.html#a56">CreateIcoCur</a>(&amp;cur);
03480 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a34" doxytag="clres.c::CopyAcceleratorTableA" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int CopyAcceleratorTableA           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HACCEL&nbsp;</td>
          <td class="mdname" nowrap> <em>hacc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPACCEL&nbsp;</td>
          <td class="mdname" nowrap> <em>paccel</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>length</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l00236">236</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
References <a class="el" href="../../d6/d5/stierr_8h-source.html#l00030">NT_SUCCESS</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l08729">NtUserCopyAcceleratorTable()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, and <a class="el" href="../../d0/d6/nlsxlat_8c-source.html#l00905">RtlUnicodeToMultiByteN()</a>.
<p>
<pre class="fragment"><div>00240 {
00241     <span class="keywordtype">int</span> retval;
00242 
00243     retval = <a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a305">NtUserCopyAcceleratorTable</a>(hacc, paccel, length);
00244 
00245     <span class="comment">/*</span>
00246 <span class="comment">     * If we are doing a copy and we succeeded then convert the accelerator</span>
00247 <span class="comment">     */</span>
00248     <span class="keywordflow">if</span> ((paccel != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) &amp;&amp; (retval &gt; 0)) {
00249 
00250         <span class="comment">/*</span>
00251 <span class="comment">         * Translate UNICODE character keys to ANSI</span>
00252 <span class="comment">         */</span>
00253         <span class="keywordtype">int</span> nAccel = retval;
00254         LPACCEL pAccelT = paccel;
00255 
00256         <span class="keywordflow">while</span> (nAccel--) {
00257             <span class="keywordflow">if</span> ((pAccelT-&gt;fVirt &amp; FVIRTKEY) == 0) {
00258                 <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(<a class="code" href="../../d9/d6/nlsxlat_8c.html#a37">RtlUnicodeToMultiByteN</a>((PCHAR)&amp;(pAccelT-&gt;key),
00259                                                        <span class="keyword">sizeof</span>(WCHAR),
00260                                                        NULL,
00261                                                        (PWSTR)&amp;(pAccelT-&gt;key),
00262                                                         <span class="keyword">sizeof</span>(pAccelT-&gt;key)))) {
00263                         pAccelT-&gt;key = 0;
00264                     }
00265                 }
00266             pAccelT++;
00267         }
00268     }
00269 
00270     <span class="keywordflow">return</span> retval;
00271 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a28" doxytag="clres.c::CopyBmp" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HBITMAP CopyBmp           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HBITMAP&nbsp;</td>
          <td class="mdname" nowrap> <em>hbmpOrg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>cxNew</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>cyNew</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>LR_flags</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l04377">4377</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
References <a class="el" href="../../d6/d0/usercli_8h.html#a659">ConvertDIBBitmap()</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l04279">DIBFromBitmap()</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d2/d7/clglobal_8c-source.html#l00090">gcsHdc</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l04096">GetIcoCurBpp()</a>, <a class="el" href="../../d2/d7/clglobal_8c-source.html#l00101">ghdcBits2</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, and <a class="el" href="../../d7/d9/usercli_8h-source.html#l00960">UserLocalFree</a>.
<p>
Referenced by <a class="el" href="../../d5/d8/clres_8c-source.html#l04493">CopyIcoCur()</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l01307">CreateIconIndirect()</a>, and <a class="el" href="../../d5/d8/clres_8c-source.html#l04719">InternalCopyImage()</a>.
<p>
<pre class="fragment"><div>04382 {
04383     HBITMAP hbmNew = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
04384     LPBITMAPINFOHEADER pdib;
04385 
04386     RtlEnterCriticalSection(&amp;gcsHdc);
04387 
04388     <span class="keywordflow">if</span> (pdib = <a class="code" href="../../d4/d9/clres_8c.html#a104">DIBFromBitmap</a>(hbmpOrg, ghdcBits2)) {
04389 
04390 <span class="preprocessor">#if 0  // Win-9x comments this code out</span>
04391 <span class="preprocessor"></span>        <span class="keywordflow">if</span> (LR_flags &amp; LR_COPYRETURNORG) {
04392 
04393             <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> bpp = <a class="code" href="../../d6/d0/usercli_8h.html#a654">GetIcoCurBpp</a>(LR_flags);
04394 
04395             <span class="keywordflow">if</span> ((cxNew == 0 || cxNew == pdib-&gt;biWidth)  &amp;&amp;
04396                 (cyNew == 0 || cyNew == pdib-&gt;biHeight) &amp;&amp;
04397                 (bpp == 0 || bpp == pdib-&gt;biBitCount)) {
04398 
04399                 hbmNew = hbmpOrg;
04400             }
04401         }
04402 
04403         <span class="keywordflow">if</span> (hbmNew == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
04404             hbmNew = <a class="code" href="../../d6/d0/usercli_8h.html#a659">ConvertDIBBitmap</a>(pdib, cxNew, cyNew, LR_flags, NULL, NULL);
04405 <span class="preprocessor">#endif</span>
04406 <span class="preprocessor"></span>
04407         hbmNew = <a class="code" href="../../d6/d0/usercli_8h.html#a659">ConvertDIBBitmap</a>(pdib, cxNew, cyNew, LR_flags, NULL, NULL);
04408 
04409         <a class="code" href="../../d6/d0/usercli_8h.html#a138">UserLocalFree</a>(pdib);
04410     }
04411 
04412     RtlLeaveCriticalSection(&amp;gcsHdc);
04413 
04414     <span class="keywordflow">if</span> ((LR_flags &amp; LR_COPYDELETEORG) &amp;&amp; hbmNew &amp;&amp; (hbmNew != hbmpOrg))
04415         DeleteObject(hbmpOrg);
04416 
04417     <span class="keywordflow">return</span> hbmNew;
04418 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a91" doxytag="clres.c::CopyDibHdr" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> LPBITMAPINFOHEADER CopyDibHdr           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d6/d0/usercli_8h.html#a378">UPBITMAPINFOHEADER</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>upbih</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT LPSTR *&nbsp;</td>
          <td class="mdname" nowrap> <em>lplpBits</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT LPBOOL&nbsp;</td>
          <td class="mdname" nowrap> <em>lpfMono</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l03546">3546</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
References <a class="el" href="../../d7/d9/usercli_8h-source.html#l00305">BitmapWidth</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l00036">BMR_CURSOR</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l00034">BMR_ICON</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l00019">BPP01_MAXCOLORS</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l03165">HowManyColors()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l00023">RESCLR_BLACK</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l00024">RESCLR_WHITE</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l03490">TrulyMonochrome()</a>, <a class="el" href="../../d4/d9/clres_8c.html#a16">upbch</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00923">UPBITMAPINFOHEADER</a>, <a class="el" href="../../d4/d9/clres_8c.html#a20">upOldIcoCur</a>, and <a class="el" href="../../d7/d9/usercli_8h-source.html#l00958">UserLocalAlloc</a>.
<p>
Referenced by <a class="el" href="../../d5/d8/clres_8c-source.html#l03679">ConvertDIBBitmap()</a>.
<p>
<pre class="fragment"><div>03550 {
03551 
03552 <span class="preprocessor">#define upbch ((UPBITMAPCOREHEADER)upbih)</span>
03553 <span class="preprocessor"></span>
03554     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>              cColors;
03555     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>              i;
03556     LPBITMAPINFOHEADER lpbihNew;
03557     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>              cbAlloc;
03558     LPBYTE             lpColorTable;
03559     <span class="keyword">struct  </span>{
03560         BITMAPINFOHEADER   bih;
03561         <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>              rgb[256];
03562         <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>              dwBuffer;
03563     } Fake;
03564 
03565     <span class="keywordflow">switch</span> (upbih-&gt;biSize) {
03566     <span class="keywordflow">case</span> <span class="keyword">sizeof</span>(BITMAPINFOHEADER):
03567         <span class="comment">/*</span>
03568 <span class="comment">         * Cool.  No conversion needed.</span>
03569 <span class="comment">         */</span>
03570         cColors   = <a class="code" href="../../d4/d9/clres_8c.html#a87">HowManyColors</a>(upbih, FALSE, &amp;lpColorTable);
03571         *lplpBits = (LPSTR)(((LPDWORD)lpColorTable) + cColors);
03572         <span class="keywordflow">break</span>;
03573 
03574     <span class="keywordflow">case</span> <span class="keyword">sizeof</span>(BITMAPCOREHEADER):
03575         <span class="comment">/*</span>
03576 <span class="comment">         * Convert the BITMAPCOREHEADER to a BITMAPINFOHEADER</span>
03577 <span class="comment">         */</span>
03578         Fake.bih.biSize          = <span class="keyword">sizeof</span>(BITMAPINFOHEADER);
03579         Fake.bih.biWidth         = <a class="code" href="../../d4/d9/clres_8c.html#a16">upbch</a>-&gt;bcWidth;
03580         Fake.bih.biHeight        = <a class="code" href="../../d4/d9/clres_8c.html#a16">upbch</a>-&gt;bcHeight;
03581         Fake.bih.biPlanes        = <a class="code" href="../../d4/d9/clres_8c.html#a16">upbch</a>-&gt;bcPlanes;
03582         Fake.bih.biBitCount      = <a class="code" href="../../d4/d9/clres_8c.html#a16">upbch</a>-&gt;bcBitCount;
03583         Fake.bih.biCompression   =
03584         Fake.bih.biXPelsPerMeter =
03585         Fake.bih.biYPelsPerMeter =
03586         Fake.bih.biClrImportant  = 0;
03587         Fake.bih.biClrUsed       = cColors =
03588                                    <a class="code" href="../../d4/d9/clres_8c.html#a87">HowManyColors</a>(upbih, TRUE, &amp;lpColorTable);
03589         Fake.bih.biSizeImage     =
03590                 <a class="code" href="../../d6/d0/usercli_8h.html#a33">BitmapWidth</a>(Fake.bih.biWidth, Fake.bih.biBitCount) *
03591                             Fake.bih.biHeight;
03592         <span class="comment">/*</span>
03593 <span class="comment">         * Copy and convert tripplet color table to rgbQuad color table.</span>
03594 <span class="comment">         */</span>
03595         <span class="keywordflow">for</span> (i = 0; i &lt; cColors; i++, lpColorTable += 3) {
03596 
03597             Fake.rgb[i] = lpColorTable[0]        +
03598                           (lpColorTable[1] &lt;&lt; 8) +
03599                           (lpColorTable[2] &lt;&lt; 16);
03600         }
03601 
03602         Fake.rgb[i] = *(<a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> UNALIGNED *)lpColorTable;  <span class="comment">// For LR_LOADTRANSPARENT</span>
03603         upbih       = (<a class="code" href="../../d6/d0/usercli_8h.html#a378">UPBITMAPINFOHEADER</a>)&amp;Fake;
03604         *lplpBits   = lpColorTable;
03605         <span class="keywordflow">break</span>;
03606 
03607     <span class="keywordflow">default</span>:
03608 
03609 <span class="preprocessor">#define upOldIcoCur ((UPOLDCURSOR)upbih)</span>
03610 <span class="preprocessor"></span>
03611         <span class="keywordflow">if</span> (<a class="code" href="../../d4/d9/clres_8c.html#a20">upOldIcoCur</a>-&gt;bType == <a class="code" href="../../d4/d9/clres_8c.html#a5">BMR_ICON</a> ||
03612                 <a class="code" href="../../d4/d9/clres_8c.html#a20">upOldIcoCur</a>-&gt;bType == <a class="code" href="../../d4/d9/clres_8c.html#a7">BMR_CURSOR</a>) {
03613             <span class="comment">/*</span>
03614 <span class="comment">             * Convert OLDICON/OLDCURSOR header to BITMAPINFHEADER</span>
03615 <span class="comment">             */</span>
03616             RIPMSG0(RIP_WARNING, <span class="stringliteral">"USER32:Converting a OLD header. - email sanfords if you see this"</span>);
03617             Fake.bih.biSize          = <span class="keyword">sizeof</span>(BITMAPINFOHEADER);
03618             Fake.bih.biWidth         = <a class="code" href="../../d4/d9/clres_8c.html#a20">upOldIcoCur</a>-&gt;cx;
03619             Fake.bih.biHeight        = <a class="code" href="../../d4/d9/clres_8c.html#a20">upOldIcoCur</a>-&gt;cy * 2;
03620             Fake.bih.biPlanes        =
03621             Fake.bih.biBitCount      = 1;
03622             Fake.bih.biCompression   =
03623             Fake.bih.biXPelsPerMeter =
03624             Fake.bih.biYPelsPerMeter =
03625             Fake.bih.biClrImportant  = 0;
03626             Fake.bih.biClrUsed       = cColors = <a class="code" href="../../d4/d9/clres_8c.html#a0">BPP01_MAXCOLORS</a>;
03627             Fake.bih.biSizeImage     =
03628                     <a class="code" href="../../d6/d0/usercli_8h.html#a33">BitmapWidth</a>(<a class="code" href="../../d4/d9/clres_8c.html#a20">upOldIcoCur</a>-&gt;cx, 1) * <a class="code" href="../../d4/d9/clres_8c.html#a20">upOldIcoCur</a>-&gt;cy;
03629             Fake.rgb[0]              = <a class="code" href="../../d4/d9/clres_8c.html#a3">RESCLR_BLACK</a>;
03630             Fake.rgb[1]              = <a class="code" href="../../d4/d9/clres_8c.html#a4">RESCLR_WHITE</a>;
03631             upbih                    = (LPBITMAPINFOHEADER)&amp;Fake;
03632             *lplpBits                = <a class="code" href="../../d4/d9/clres_8c.html#a20">upOldIcoCur</a>-&gt;abBitmap;
03633             Fake.rgb[2]              = *((LPDWORD)*lplpBits);  <span class="comment">// For LR_LOADTRANSPARENT</span>
03634 
03635         } <span class="keywordflow">else</span> {
03636 
03637             RIPMSG0(RIP_WARNING, <span class="stringliteral">"ConvertDIBBitmap: not a valid format"</span>);
03638             <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
03639         }
03640 
03641 <span class="preprocessor">#undef pOldIcoCur</span>
03642 <span class="preprocessor"></span>
03643         <span class="keywordflow">break</span>;
03644     }
03645 
03646     *lpfMono = (cColors == <a class="code" href="../../d4/d9/clres_8c.html#a0">BPP01_MAXCOLORS</a>) &amp;&amp;
03647             <a class="code" href="../../d4/d9/clres_8c.html#a90">TrulyMonochrome</a>((LPBYTE)upbih + <span class="keyword">sizeof</span>(BITMAPINFOHEADER), FALSE);
03648 
03649     cbAlloc = <span class="keyword">sizeof</span>(BITMAPINFOHEADER) + (cColors * <span class="keyword">sizeof</span>(RGBQUAD)) + 4;
03650 
03651     <span class="keywordflow">if</span> (lpbihNew = <a class="code" href="../../d6/d0/usercli_8h.html#a136">UserLocalAlloc</a>(0, cbAlloc))
03652         RtlCopyMemory(lpbihNew, upbih, cbAlloc);
03653 
03654     <span class="keywordflow">return</span> lpbihNew;
03655 
03656 <span class="preprocessor">#undef upbch</span>
03657 <span class="preprocessor"></span>
03658 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a106" doxytag="clres.c::CopyIcoCur" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HICON CopyIcoCur           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HICON&nbsp;</td>
          <td class="mdname" nowrap> <em>hicoSrc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>BOOL&nbsp;</td>
          <td class="mdname" nowrap> <em>fIcon</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>cxNew</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>cyNew</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>LR_flags</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l04493">4493</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
References <a class="el" href="../../d5/d3/kernel_2acons_8c-source.html#l00319">_SetCursorIconData()</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l02338">tagCURSORFIND::bpp</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l04377">CopyBmp()</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l04436">CopyImageFromRes()</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02169">CURSOR_ALWAYSDESTROY</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l02336">tagCURSORFIND::cx</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l02337">tagCURSORFIND::cy</a>, <a class="el" href="../../d2/d0/inctlpan_8c-source.html#l00480">cy</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l01017">DestroyCursor()</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l04096">GetIcoCurBpp()</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l04074">GetIcoCurHeight()</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l04052">GetIcoCurWidth()</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02209">tagCURSORFIND::hcur</a>, <a class="el" href="../../d4/d8/arcinst_8c-source.html#l00065">MAX_PATH</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00624">MultDiv</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l04526">NtUserCallOneParam()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l04033">NtUserDestroyCursor()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l01593">NtUserGetIconInfo()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l01669">NtUserGetIconSize()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00411">PTR_TO_ID</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l02335">tagCURSORFIND::rt</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d5/d8/clres_8c-source.html#l04719">InternalCopyImage()</a>.
<p>
<pre class="fragment"><div>04499 {
04500     HBITMAP        hbmMaskNew;
04501     HBITMAP        hbmColorNew;
04502     <span class="keywordtype">int</span>            cx;
04503     <span class="keywordtype">int</span>            <a class="code" href="../../d1/d1/inctlpan_8c.html#a3">cy</a>;
04504     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>          bpp;
04505     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>          bppDesired;
04506     HICON          hicoDst = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
04507     ICONINFO       ii;
04508     <a class="code" href="../../d8/d1/structtagCURSORDATA.html">CURSORDATA</a>     cur;
04509     UNICODE_STRING strModName;
04510     UNICODE_STRING strResName;
04511     WCHAR          awszModName[<a class="code" href="../../d3/d9/arcinst_8c.html#a6">MAX_PATH</a>];
04512     WCHAR          awszResName[<a class="code" href="../../d3/d9/arcinst_8c.html#a6">MAX_PATH</a>];
04513 
04514     <span class="comment">/*</span>
04515 <span class="comment">     * Extract needed info from existing icon/cursor from the kernel</span>
04516 <span class="comment">     */</span>
04517     <span class="keywordflow">if</span> (!<a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a106">NtUserGetIconSize</a>(hicoSrc, 0, &amp;cx, &amp;cy))
04518         <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
04519 
04520     <a class="code" href="../../d1/d1/inctlpan_8c.html#a3">cy</a> &gt;&gt;= 1;
04521 
04522     <span class="keywordflow">if</span> (LR_flags &amp; LR_CREATEDIBSECTION)
04523         LR_flags = (LR_flags &amp; ~LR_CREATEDIBSECTION) | LR_CREATEREALDIB;
04524 
04525     <span class="comment">/*</span>
04526 <span class="comment">     * Setup unicode-strings for calls to kernel-side.</span>
04527 <span class="comment">     */</span>
04528     strModName.Length        = 0;
04529     strModName.MaximumLength = <a class="code" href="../../d3/d9/arcinst_8c.html#a6">MAX_PATH</a>;
04530     strModName.Buffer        = awszModName;
04531 
04532     strResName.Length        = 0;
04533     strResName.MaximumLength = <a class="code" href="../../d3/d9/arcinst_8c.html#a6">MAX_PATH</a>;
04534     strResName.Buffer        = awszResName;
04535 
04536     <span class="comment">/*</span>
04537 <span class="comment">     * Note: this creates copies of hbmMask and hbmColor that need to be</span>
04538 <span class="comment">     * freed before we leave.</span>
04539 <span class="comment">     */</span>
04540     <span class="keywordflow">if</span> (!<a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a105">NtUserGetIconInfo</a>(hicoSrc,
04541                            &amp;ii,
04542                            &amp;strModName,
04543                            &amp;strResName,
04544                            &amp;bpp,
04545                            TRUE)) {
04546 
04547         <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
04548     }
04549 
04550     cxNew = <a class="code" href="../../d6/d0/usercli_8h.html#a652">GetIcoCurWidth</a>(cxNew, fIcon, LR_flags, cx);
04551     cyNew = <a class="code" href="../../d6/d0/usercli_8h.html#a653">GetIcoCurHeight</a>(cyNew, fIcon, LR_flags, cy);
04552 
04553     <span class="keywordflow">if</span> (LR_flags &amp; LR_COPYFROMRESOURCE) {
04554 
04555         <a class="code" href="../../d9/d1/structtagCURSORFIND.html">CURSORFIND</a> cfSearch;
04556         LPWSTR     pszModName;
04557 
04558         <span class="comment">/*</span>
04559 <span class="comment">         * Setup the search criteria.</span>
04560 <span class="comment">         */</span>
04561         cfSearch.<a class="code" href="../../d9/d1/structtagCURSORFIND.html#o0">hcur</a> = hicoSrc;
04562         cfSearch.<a class="code" href="../../d9/d1/structtagCURSORFIND.html#o1">rt</a>   = PtrToUlong((fIcon ? RT_ICON : RT_CURSOR));
04563         cfSearch.<a class="code" href="../../d9/d1/structtagCURSORFIND.html#o2">cx</a>   = cxNew;
04564         cfSearch.<a class="code" href="../../d9/d1/structtagCURSORFIND.html#o3">cy</a>   = cyNew;
04565         cfSearch.<a class="code" href="../../d9/d1/structtagCURSORFIND.html#o4">bpp</a>  = bpp;
04566 
04567         <span class="comment">/*</span>
04568 <span class="comment">         * Copy the image.  This performs a lookup for the hicoSrc.  If</span>
04569 <span class="comment">         * it is not found in the process and shared caches, then we</span>
04570 <span class="comment">         * will proceed with copying the hicoSrc.  If an icon is found</span>
04571 <span class="comment">         * in the cache, then we will attempt to reload the image for</span>
04572 <span class="comment">         * the best resolution possible.</span>
04573 <span class="comment">         */</span>
04574         pszModName = (strModName.Length ? strModName.Buffer : <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>);
04575 
04576         hicoDst = <a class="code" href="../../d4/d9/clres_8c.html#a105">CopyImageFromRes</a>(pszModName,
04577                                    strResName.Buffer,
04578                                    &amp;cfSearch,
04579                                    LR_flags);
04580 
04581         <span class="keywordflow">if</span> (hicoDst)
04582             <span class="keywordflow">goto</span> CleanupExit;
04583     }
04584 
04585     bppDesired = <a class="code" href="../../d6/d0/usercli_8h.html#a654">GetIcoCurBpp</a>(LR_flags);
04586 
04587     <span class="keywordflow">if</span> ((cxNew != cx) ||
04588         (cyNew != <a class="code" href="../../d1/d1/inctlpan_8c.html#a3">cy</a>) ||
04589         ((bpp != 1) &amp;&amp; (bppDesired != 0) &amp;&amp; (bppDesired != bpp))) {
04590 
04591         <span class="comment">/*</span>
04592 <span class="comment">         * Since we have to stretch or maybe fixup the colors just get</span>
04593 <span class="comment">         * the DIB bits and let ConverDIBBitmap do all the magic.</span>
04594 <span class="comment">         */</span>
04595         hbmMaskNew = <a class="code" href="../../d4/d9/clres_8c.html#a28">CopyBmp</a>(ii.hbmMask, cxNew, cyNew * 2, LR_MONOCHROME);
04596 
04597         <span class="keywordflow">if</span> (hbmMaskNew == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
04598             <span class="keywordflow">goto</span> CleanupExit;
04599 
04600         hbmColorNew = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
04601 
04602         <span class="keywordflow">if</span> (ii.hbmColor) {
04603 
04604             hbmColorNew = <a class="code" href="../../d4/d9/clres_8c.html#a28">CopyBmp</a>(ii.hbmColor, cxNew, cyNew, LR_flags);
04605 
04606             <span class="keywordflow">if</span> (hbmColorNew == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
04607                 DeleteObject(hbmMaskNew);
04608                 <span class="keywordflow">goto</span> CleanupExit;
04609             }
04610         }
04611 
04612         <span class="comment">/*</span>
04613 <span class="comment">         * Replace ii.hbmxxx guys with our fixed up copies and delete the old.</span>
04614 <span class="comment">         */</span>
04615         DeleteObject(ii.hbmMask);
04616         ii.hbmMask = hbmMaskNew;
04617 
04618         <span class="keywordflow">if</span> (ii.hbmColor &amp;&amp; (ii.hbmColor != hbmColorNew)) {
04619             DeleteObject(ii.hbmColor);
04620             ii.hbmColor = hbmColorNew;
04621         }
04622 
04623         <span class="comment">/*</span>
04624 <span class="comment">         * tweak the hotspots for changes in size.</span>
04625 <span class="comment">         */</span>
04626         <span class="keywordflow">if</span> (cxNew != cx)
04627             ii.xHotspot = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a141">MultDiv</a>(ii.xHotspot, cxNew, cx);
04628 
04629         <span class="keywordflow">if</span> (cyNew != <a class="code" href="../../d1/d1/inctlpan_8c.html#a3">cy</a>)
04630             ii.yHotspot = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a141">MultDiv</a>(ii.yHotspot, cyNew, cy);
04631 
04632     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (LR_flags &amp; LR_COPYRETURNORG) {
04633 
04634         hicoDst = hicoSrc;
04635 
04636 CleanupExit:
04637 
04638         <span class="comment">/*</span>
04639 <span class="comment">         * Free up the bitmaps which were created by GetIconInfo().</span>
04640 <span class="comment">         */</span>
04641         DeleteObject(ii.hbmMask);
04642 
04643         <span class="keywordflow">if</span> (ii.hbmColor)
04644             DeleteObject(ii.hbmColor);
04645 
04646         <span class="keywordflow">goto</span> Exit;
04647     }
04648 
04649     <span class="comment">/*</span>
04650 <span class="comment">     * Build the icon/cursor object from the info.  The bitmaps</span>
04651 <span class="comment">     * are not freed in this case.</span>
04652 <span class="comment">     */</span>
04653     hicoDst = (HICON)<a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a174">NtUserCallOneParam</a>(0, SFI__CREATEEMPTYCURSOROBJECT);
04654 
04655     <span class="keywordflow">if</span> (hicoDst == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
04656         <span class="keywordflow">goto</span> CleanupExit;
04657 
04658     RtlZeroMemory(&amp;cur, <span class="keyword">sizeof</span>(cur));
04659     cur.<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o1">lpName</a>    = strResName.Length ? strResName.Buffer : <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
04660     cur.<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o2">lpModName</a> = strModName.Length ? strModName.Buffer : <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
04661     cur.<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o3">rt</a>        = ii.fIcon ? <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a99">PTR_TO_ID</a>(RT_ICON) : <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a99">PTR_TO_ID</a>(RT_CURSOR);
04662     cur.<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o5">bpp</a>       = bpp;
04663     cur.<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o6">cx</a>        = cxNew;
04664     cur.<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o7">cy</a>        = cyNew * 2;
04665     cur.<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o8">xHotspot</a>  = (<span class="keywordtype">short</span>)ii.xHotspot;
04666     cur.<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o9">yHotspot</a>  = (<span class="keywordtype">short</span>)ii.yHotspot;
04667     cur.<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o10">hbmMask</a>   = ii.hbmMask;
04668     cur.<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o11">hbmColor</a>  = ii.hbmColor;
04669 
04670     <span class="keywordflow">if</span> (!<a class="code" href="../../d4/d1/userk_8h.html#a1114">_SetCursorIconData</a>(hicoDst, &amp;cur)) {
04671         <a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a156">NtUserDestroyCursor</a>(hicoDst, CURSOR_ALWAYSDESTROY);
04672         <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
04673     }
04674 
04675 Exit:
04676 
04677     <span class="comment">/*</span>
04678 <span class="comment">     * destroy the original if asked to.</span>
04679 <span class="comment">     */</span>
04680     <span class="keywordflow">if</span> (hicoDst != hicoSrc &amp;&amp; (LR_flags &amp; LR_COPYDELETEORG))
04681         <a class="code" href="../../d4/d9/clres_8c.html#a55">DestroyCursor</a>(hicoSrc);
04682 
04683     <span class="keywordflow">return</span> hicoDst;
04684 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a107" doxytag="clres.c::CopyImage" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HANDLE WINAPI CopyImage           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HANDLE&nbsp;</td>
          <td class="mdname" nowrap> <em>hImage</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>IMAGE_flag</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>cxNew</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>cyNew</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>LR_flags</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l04697">4697</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
References <a class="el" href="../../d5/d8/clres_8c-source.html#l04719">InternalCopyImage()</a>, and <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>.
<p>
<pre class="fragment"><div>04703 {
04704     <span class="keywordflow">if</span> (LR_flags &amp; ~LR_VALID) {
04705         RIPERR0(ERROR_INVALID_PARAMETER, RIP_WARNING, <span class="stringliteral">"CopyImage: bad LR_flags."</span>);
04706         <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
04707     }
04708 
04709     <span class="keywordflow">return</span> <a class="code" href="../../d6/d0/usercli_8h.html#a649">InternalCopyImage</a>(hImage, IMAGE_flag, cxNew, cyNew, LR_flags);
04710 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a105" doxytag="clres.c::CopyImageFromRes" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HICON CopyImageFromRes           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">LPWSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>pszModName</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPWSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>pszResName</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d9/d1/structtagCURSORFIND.html">PCURSORFIND</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pcfSearch</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>LR_flags</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l04436">4436</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
References <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l02338">tagCURSORFIND::bpp</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l02336">tagCURSORFIND::cx</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l02337">tagCURSORFIND::cy</a>, <a class="el" href="../../d9/d8/client_2ntstubs_8c-source.html#l01102">FindExistingCursorIcon()</a>, <a class="el" href="../../d2/d7/clglobal_8c-source.html#l00053">hmodUser</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l02657">LoadIcoCur()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d0/d0/client_2nt6_2user_8h.html#a1073">PCURSORFIND</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l02335">tagCURSORFIND::rt</a>, <a class="el" href="../../d2/d7/clglobal_8c-source.html#l00063">szUSER32</a>, and <a class="el" href="../../d5/d8/clres_8c-source.html#l00157">WowGetModuleHandle()</a>.
<p>
Referenced by <a class="el" href="../../d5/d8/clres_8c-source.html#l04493">CopyIcoCur()</a>.
<p>
<pre class="fragment"><div>04441 {
04442     HINSTANCE hmod;
04443     HICON     hicoDst = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
04444 
04445     <span class="comment">/*</span>
04446 <span class="comment">     * Override the search-criteria if this is the user-module.  By</span>
04447 <span class="comment">     * setting these to zero, we are basically saying "don't care" for</span>
04448 <span class="comment">     * these attributes.</span>
04449 <span class="comment">     */</span>
04450     hmod = (pszModName ? <a class="code" href="../../d4/d9/clres_8c.html#a32">WowGetModuleHandle</a>(pszModName) : <a class="code" href="../../d1/d8/clglobal_8c.html#a6">hmodUser</a>);
04451 
04452     <span class="keywordflow">if</span> (hmod == <a class="code" href="../../d1/d8/clglobal_8c.html#a6">hmodUser</a>) {
04453 
04454         pcfSearch-&gt;<a class="code" href="../../d9/d1/structtagCURSORFIND.html#o2">cx</a>  = 0;
04455         pcfSearch-&gt;<a class="code" href="../../d9/d1/structtagCURSORFIND.html#o3">cy</a>  = 0;
04456         pcfSearch-&gt;<a class="code" href="../../d9/d1/structtagCURSORFIND.html#o4">bpp</a> = 0;
04457 
04458         pszModName = <a class="code" href="../../d1/d8/clglobal_8c.html#a12">szUSER32</a>;
04459     }
04460 
04461     <span class="comment">/*</span>
04462 <span class="comment">     * If a resource has been found with this name/bpp, then attempt</span>
04463 <span class="comment">     * to load the resource with the desired dimensions.</span>
04464 <span class="comment">     */</span>
04465     <span class="keywordflow">if</span> (<a class="code" href="../../d6/d0/usercli_8h.html#a627">FindExistingCursorIcon</a>(pszModName, pszResName, pcfSearch)) {
04466 
04467         hicoDst = <a class="code" href="../../d6/d0/usercli_8h.html#a655">LoadIcoCur</a>(hmod,
04468                              pszResName,
04469                              (LPWSTR)ULongToPtr( pcfSearch-&gt;<a class="code" href="../../d9/d1/structtagCURSORFIND.html#o1">rt</a> ),
04470                              pcfSearch-&gt;<a class="code" href="../../d9/d1/structtagCURSORFIND.html#o2">cx</a>,
04471                              pcfSearch-&gt;<a class="code" href="../../d9/d1/structtagCURSORFIND.html#o3">cy</a>,
04472                              LR_flags);
04473     }
04474 
04475     <span class="keywordflow">return</span> hicoDst;
04476 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a33" doxytag="clres.c::CreateAcceleratorTableA" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HACCEL WINAPI CreateAcceleratorTableA           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">LPACCEL&nbsp;</td>
          <td class="mdname" nowrap> <em>paccel</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>cAccel</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l00199">199</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
References <a class="el" href="../../d2/d0/bench_8c-source.html#l00050">CHAR</a>, <a class="el" href="../../d6/d5/stierr_8h-source.html#l00030">NT_SUCCESS</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l03960">NtUserCreateAcceleratorTable()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, and <a class="el" href="../../d0/d6/nlsxlat_8c-source.html#l00369">RtlMultiByteToUnicodeN()</a>.
<p>
<pre class="fragment"><div>00202 {
00203     <span class="keywordtype">int</span>     nAccel = cAccel;
00204     LPACCEL pAccelT = paccel;
00205 
00206     <span class="comment">/*</span>
00207 <span class="comment">     * Convert any character keys from ANSI to Unicode.</span>
00208 <span class="comment">     */</span>
00209     <span class="keywordflow">while</span> (nAccel--) {
00210 
00211         <span class="keywordflow">if</span> ((pAccelT-&gt;fVirt &amp; FVIRTKEY) == 0) {
00212 
00213             <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(<a class="code" href="../../d9/d6/nlsxlat_8c.html#a33">RtlMultiByteToUnicodeN</a>((LPWSTR)&amp;(pAccelT-&gt;key),
00214                                                    <span class="keyword">sizeof</span>(WCHAR),
00215                                                    NULL,
00216                                                    (LPSTR)&amp;(pAccelT-&gt;key),
00217                                                    <span class="keyword">sizeof</span>(CHAR)))) {
00218                 pAccelT-&gt;key = 0xFFFF;
00219             }
00220         }
00221 
00222         pAccelT++;
00223     }
00224 
00225     <span class="keywordflow">return</span> <a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a153">NtUserCreateAcceleratorTable</a>(paccel, cAccel);
00226 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a58" doxytag="clres.c::CreateCursor" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HCURSOR WINAPI CreateCursor           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HINSTANCE&nbsp;</td>
          <td class="mdname" nowrap> <em>hModule</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>iXhotspot</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>iYhotspot</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>iWidth</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>iHeight</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPBYTE&nbsp;</td>
          <td class="mdname" nowrap> <em>lpANDplane</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPBYTE&nbsp;</td>
          <td class="mdname" nowrap> <em>lpXORplane</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l01244">1244</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
References <a class="el" href="../../d5/d8/clres_8c-source.html#l01084">CreateIcoCurIndirect()</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, and <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00062">SHORT</a>.
<p>
<pre class="fragment"><div>01252 {
01253     <a class="code" href="../../d8/d1/structtagCURSORDATA.html">CURSORDATA</a> cur;
01254     UNREFERENCED_PARAMETER(hModule);
01255 
01256     <span class="keywordflow">if</span> ((iXhotspot &lt; 0) || (iXhotspot &gt; iWidth) ||
01257         (iYhotspot &lt; 0) || (iYhotspot &gt; iHeight)) {
01258         <span class="keywordflow">return</span> 0;
01259     }
01260 
01261     RtlZeroMemory(&amp;cur, <span class="keyword">sizeof</span>(cur));
01262     cur.<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o8">xHotspot</a> = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a>)iXhotspot;
01263     cur.<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o9">yHotspot</a> = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a>)iYhotspot;
01264     cur.<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o6">cx</a>       = (<a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)iWidth;
01265     cur.<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o7">cy</a>       = (<a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)iHeight;
01266 
01267     <span class="keywordflow">return</span> <a class="code" href="../../d4/d9/clres_8c.html#a57">CreateIcoCurIndirect</a>(&amp;cur, 1, 1, lpANDplane, lpXORplane);
01268 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a48" doxytag="clres.c::CreateDialogIndirectParamA" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HWND WINAPI CreateDialogIndirectParamA           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HINSTANCE&nbsp;</td>
          <td class="mdname" nowrap> <em>hmod</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPCDLGTEMPLATEA&nbsp;</td>
          <td class="mdname" nowrap> <em>lpDlgTemplate</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HWND&nbsp;</td>
          <td class="mdname" nowrap> <em>hwndOwner</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>DLGPROC&nbsp;</td>
          <td class="mdname" nowrap> <em>lpDialogFunc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>dwInitParam</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l00796">796</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
References <a class="el" href="../../d5/d8/clres_8c-source.html#l00826">CreateDialogIndirectParamAorW()</a>.
<p>
<pre class="fragment"><div>00802 {
00803     <span class="keywordflow">return</span> <a class="code" href="../../d4/d9/clres_8c.html#a50">CreateDialogIndirectParamAorW</a>(hmod,
00804                                          (LPCDLGTEMPLATE)lpDlgTemplate,
00805                                          hwndOwner,
00806                                          lpDialogFunc,
00807                                          dwInitParam,
00808                                          SCDLG_ANSI);
00809 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a50" doxytag="clres.c::CreateDialogIndirectParamAorW" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HWND WINAPI CreateDialogIndirectParamAorW           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HANDLE&nbsp;</td>
          <td class="mdname" nowrap> <em>hmod</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPCDLGTEMPLATE&nbsp;</td>
          <td class="mdname" nowrap> <em>lpDlgTemplate</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HWND&nbsp;</td>
          <td class="mdname" nowrap> <em>hwndOwner</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>DLGPROC&nbsp;</td>
          <td class="mdname" nowrap> <em>lpDialogFunc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>dwInitParam</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>fAnsi</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l00826">826</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
References <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l00609">GetSizeDialogTemplate()</a>, <a class="el" href="../../d1/d8/dlgbegin_8c-source.html#l00553">InternalCreateDialog()</a>, and <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>.
<p>
Referenced by <a class="el" href="../../d5/d8/clres_8c-source.html#l00796">CreateDialogIndirectParamA()</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l00811">CreateDialogIndirectParamW()</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l00941">CreateDialogParamA()</a>, and <a class="el" href="../../d5/d8/clres_8c-source.html#l00975">CreateDialogParamW()</a>.
<p>
<pre class="fragment"><div>00833 {
00834     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> cb;
00835     HWND  hwndRet;
00836 
00837     <span class="comment">/*</span>
00838 <span class="comment">     * The server routine destroys the menu if it fails.</span>
00839 <span class="comment">     */</span>
00840     cb = <a class="code" href="../../d4/d9/clres_8c.html#a44">GetSizeDialogTemplate</a>(hmod, lpDlgTemplate);
00841 
00842     <span class="keywordflow">if</span> (!cb) {
00843         RIPMSG0(RIP_WARNING, <span class="stringliteral">"CreateDialogIndirect: Invalid Parameter"</span>);
00844         <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00845     }
00846 
00847     hwndRet = <a class="code" href="../../d6/d0/usercli_8h.html#a750">InternalCreateDialog</a>(hmod,
00848                                    (LPDLGTEMPLATE)lpDlgTemplate,
00849                                    cb,
00850                                    hwndOwner,
00851                                    lpDialogFunc,
00852                                    dwInitParam,
00853                                    SCDLG_CLIENT | (fAnsi &amp; (SCDLG_ANSI|SCDLG_16BIT)));
00854 
00855     <span class="keywordflow">return</span> hwndRet;
00856 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a49" doxytag="clres.c::CreateDialogIndirectParamW" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HWND WINAPI CreateDialogIndirectParamW           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HINSTANCE&nbsp;</td>
          <td class="mdname" nowrap> <em>hmod</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPCDLGTEMPLATEW&nbsp;</td>
          <td class="mdname" nowrap> <em>lpDlgTemplate</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HWND&nbsp;</td>
          <td class="mdname" nowrap> <em>hwndOwner</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>DLGPROC&nbsp;</td>
          <td class="mdname" nowrap> <em>lpDialogFunc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>dwInitParam</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l00811">811</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
References <a class="el" href="../../d5/d8/clres_8c-source.html#l00826">CreateDialogIndirectParamAorW()</a>.
<p>
<pre class="fragment"><div>00817 {
00818     <span class="keywordflow">return</span> <a class="code" href="../../d4/d9/clres_8c.html#a50">CreateDialogIndirectParamAorW</a>(hmod,
00819                                          (LPCDLGTEMPLATE)lpDlgTemplate,
00820                                          hwndOwner,
00821                                          lpDialogFunc,
00822                                          dwInitParam,
00823                                          0);
00824 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a53" doxytag="clres.c::CreateDialogParamA" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HWND WINAPI CreateDialogParamA           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HINSTANCE&nbsp;</td>
          <td class="mdname" nowrap> <em>hmod</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPCSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>lpName</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HWND&nbsp;</td>
          <td class="mdname" nowrap> <em>hwndOwner</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>DLGPROC&nbsp;</td>
          <td class="mdname" nowrap> <em>lpDialogFunc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>dwInitParam</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l00941">941</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
References <a class="el" href="../../d5/d8/clres_8c-source.html#l00826">CreateDialogIndirectParamAorW()</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00907">FINDRESOURCEA</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00914">FREERESOURCE</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00911">LOADRESOURCE</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00912">LOCKRESOURCE</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, and <a class="el" href="../../d7/d9/usercli_8h-source.html#l00913">UNLOCKRESOURCE</a>.
<p>
<pre class="fragment"><div>00947 {
00948     HANDLE         h;
00949     LPDLGTEMPLATEA p;
00950     HWND           hwnd = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00951 
00952     <span class="keywordflow">if</span> (h = <a class="code" href="../../d6/d0/usercli_8h.html#a125">FINDRESOURCEA</a>(hmod, lpName, (LPSTR)RT_DIALOG)) {
00953 
00954         <span class="keywordflow">if</span> (h = <a class="code" href="../../d6/d0/usercli_8h.html#a129">LOADRESOURCE</a>(hmod, h)) {
00955 
00956             <span class="keywordflow">if</span> (p = (LPDLGTEMPLATEA)<a class="code" href="../../d6/d0/usercli_8h.html#a130">LOCKRESOURCE</a>(h, hmod)) {
00957 
00958                 hwnd = <a class="code" href="../../d4/d9/clres_8c.html#a50">CreateDialogIndirectParamAorW</a>(hmod,
00959                                                      (LPCDLGTEMPLATE)p,
00960                                                      hwndOwner,
00961                                                      lpDialogFunc,
00962                                                      dwInitParam,
00963                                                      SCDLG_ANSI);
00964 
00965                 <a class="code" href="../../d6/d0/usercli_8h.html#a131">UNLOCKRESOURCE</a>(h, hmod);
00966             }
00967 
00968             <a class="code" href="../../d6/d0/usercli_8h.html#a132">FREERESOURCE</a>(h, hmod);
00969         }
00970     }
00971 
00972     <span class="keywordflow">return</span> hwnd;
00973 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a54" doxytag="clres.c::CreateDialogParamW" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HWND WINAPI CreateDialogParamW           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HINSTANCE&nbsp;</td>
          <td class="mdname" nowrap> <em>hmod</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPCWSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>lpName</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HWND&nbsp;</td>
          <td class="mdname" nowrap> <em>hwndOwner</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>DLGPROC&nbsp;</td>
          <td class="mdname" nowrap> <em>lpDialogFunc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>dwInitParam</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l00975">975</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
References <a class="el" href="../../d5/d8/clres_8c-source.html#l00826">CreateDialogIndirectParamAorW()</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00908">FINDRESOURCEW</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00914">FREERESOURCE</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00911">LOADRESOURCE</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00912">LOCKRESOURCE</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, and <a class="el" href="../../d7/d9/usercli_8h-source.html#l00913">UNLOCKRESOURCE</a>.
<p>
<pre class="fragment"><div>00981 {
00982     HANDLE h;
00983     PVOID  p;
00984     HWND   hwnd = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00985 
00986     <span class="keywordflow">if</span> (h = <a class="code" href="../../d6/d0/usercli_8h.html#a126">FINDRESOURCEW</a>(hmod, lpName, RT_DIALOG)) {
00987 
00988         <span class="keywordflow">if</span> (h = <a class="code" href="../../d6/d0/usercli_8h.html#a129">LOADRESOURCE</a>(hmod, h)) {
00989 
00990             <span class="keywordflow">if</span> (p = <a class="code" href="../../d6/d0/usercli_8h.html#a130">LOCKRESOURCE</a>(h, hmod)) {
00991 
00992                 hwnd = <a class="code" href="../../d4/d9/clres_8c.html#a50">CreateDialogIndirectParamAorW</a>(hmod,
00993                                                      p,
00994                                                      hwndOwner,
00995                                                      lpDialogFunc,
00996                                                      dwInitParam,
00997                                                      0);
00998 
00999                 <a class="code" href="../../d6/d0/usercli_8h.html#a131">UNLOCKRESOURCE</a>(h, hmod);
01000             }
01001 
01002             <a class="code" href="../../d6/d0/usercli_8h.html#a132">FREERESOURCE</a>(h, hmod);
01003         }
01004     }
01005 
01006     <span class="keywordflow">return</span> hwnd;
01007 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a56" doxytag="clres.c::CreateIcoCur" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HICON CreateIcoCur           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d8/d1/structtagCURSORDATA.html">PCURSORDATA</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>lpi</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l01029">1029</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
References <a class="el" href="../../d5/d3/kernel_2acons_8c-source.html#l00319">_SetCursorIconData()</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02169">CURSOR_ALWAYSDESTROY</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02184">tagCURSORDATA::CURSORF_flags</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02174">CURSORF_GLOBAL</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02190">tagCURSORDATA::cx</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02191">tagCURSORDATA::cy</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02195">tagCURSORDATA::hbmColor</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02194">tagCURSORDATA::hbmMask</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l04526">NtUserCallOneParam()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l04033">NtUserDestroyCursor()</a>, and <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>.
<p>
Referenced by <a class="el" href="../../d5/d8/clres_8c-source.html#l03344">ConvertDIBIcon()</a>.
<p>
<pre class="fragment"><div>01031 {
01032     HCURSOR hcur;
01033 
01034     UserAssert(lpi-&gt;<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o11">hbmColor</a> || lpi-&gt;<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o10">hbmMask</a>);
01035 
01036     hcur = (HCURSOR)<a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a174">NtUserCallOneParam</a>((lpi-&gt;<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o0">CURSORF_flags</a> &amp; CURSORF_GLOBAL),
01037                                        SFI__CREATEEMPTYCURSOROBJECT);
01038 
01039     <span class="keywordflow">if</span> (hcur == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
01040         <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01041 
01042 <span class="preprocessor">#if DBG</span>
01043 <span class="preprocessor"></span>    {
01044         BITMAP bmMask;
01045         BITMAP bmColor;
01046 
01047         UserAssert(GetObject(lpi-&gt;<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o10">hbmMask</a>, <span class="keyword">sizeof</span>(BITMAP), &amp;bmMask));
01048         
01049         <span class="comment">/* Bug 252902 - joejo</span>
01050 <span class="comment">         * Since the width and height of the mask bitmap is set below</span>
01051 <span class="comment">         * we really don't need to assert on the width/height check. Throwing</span>
01052 <span class="comment">         * a warning should be good enough.</span>
01053 <span class="comment">         */</span>
01054         <span class="keywordflow">if</span> (bmMask.bmWidth != (LONG)lpi-&gt;<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o6">cx</a>) {
01055            RIPMSG1(RIP_WARNING, <span class="stringliteral">"Mask width not equal to requested width: lpi %#p"</span>, lpi);
01056         }
01057 
01058         <span class="keywordflow">if</span> (bmMask.bmHeight != (LONG)lpi-&gt;<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o7">cy</a>) {
01059            RIPMSG1(RIP_WARNING, <span class="stringliteral">"Mask height not equal to requested height: lpi %#p"</span>, lpi);
01060         }
01061 
01062         <span class="keywordflow">if</span> (lpi-&gt;<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o11">hbmColor</a>) {
01063             UserAssert(GetObject(lpi-&gt;<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o11">hbmColor</a>, <span class="keyword">sizeof</span>(BITMAP), &amp;bmColor));
01064             UserAssert(bmMask.bmHeight == bmColor.bmHeight * 2);
01065             UserAssert(bmMask.bmWidth  == bmColor.bmWidth);
01066         }
01067     }
01068 <span class="preprocessor">#endif</span>
01069 <span class="preprocessor"></span>
01070     <span class="keywordflow">if</span> (<a class="code" href="../../d4/d1/userk_8h.html#a1114">_SetCursorIconData</a>(hcur, lpi))
01071         <span class="keywordflow">return</span> hcur;
01072 
01073     <a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a156">NtUserDestroyCursor</a>(hcur, CURSOR_ALWAYSDESTROY);
01074 
01075     <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01076 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a57" doxytag="clres.c::CreateIcoCurIndirect" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HCURSOR CreateIcoCurIndirect           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d8/d1/structtagCURSORDATA.html">PCURSORDATA</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pcurCreate</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>cPlanes</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>cBitsPixel</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>CONST <a class="el" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>lpANDbits</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>CONST <a class="el" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>lpXORbits</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l01084">1084</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
References <a class="el" href="../../d5/d3/kernel_2acons_8c-source.html#l00319">_SetCursorIconData()</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02189">tagCURSORDATA::bpp</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02169">CURSOR_ALWAYSDESTROY</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02184">tagCURSORDATA::CURSORF_flags</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02190">tagCURSORDATA::cx</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02191">tagCURSORDATA::cy</a>, <a class="el" href="../../d2/d0/inctlpan_8c-source.html#l00480">cy</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02195">tagCURSORDATA::hbmColor</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02194">tagCURSORDATA::hbmMask</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02186">tagCURSORDATA::lpModName</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02185">tagCURSORDATA::lpName</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l04526">NtUserCallOneParam()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l04033">NtUserDestroyCursor()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l02323">tagCURSORDATA::rt</a>, <a class="el" href="../../d0/d5/ndismain_8h-source.html#l00026">UINT</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00958">UserLocalAlloc</a>, and <a class="el" href="../../d7/d9/usercli_8h-source.html#l00960">UserLocalFree</a>.
<p>
Referenced by <a class="el" href="../../d5/d8/clres_8c-source.html#l01244">CreateCursor()</a>, and <a class="el" href="../../d5/d8/clres_8c-source.html#l01278">CreateIcon()</a>.
<p>
<pre class="fragment"><div>01090 {
01091     <span class="keywordtype">int</span>     cbBits;
01092     HCURSOR hcurNew;
01093     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    bColor;
01094     <a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a>    cx;
01095     <a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a>    <a class="code" href="../../d1/d1/inctlpan_8c.html#a3">cy</a>;
01096     LPBYTE  pBits = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01097 
01098     <span class="comment">/*</span>
01099 <span class="comment">     * Allocate CURSOR structure.</span>
01100 <span class="comment">     */</span>
01101     hcurNew = (HCURSOR)<a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a174">NtUserCallOneParam</a>(0, SFI__CREATEEMPTYCURSOROBJECT);
01102 
01103     <span class="keywordflow">if</span> (hcurNew == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
01104         <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01105 
01106     <span class="comment">/*</span>
01107 <span class="comment">     * If there is no Color bitmap, create a single buffer that contains both</span>
01108 <span class="comment">     * the AND and XOR bits.  The AND bitmap is always MonoChrome</span>
01109 <span class="comment">     */</span>
01110     bColor = (cPlanes | cBitsPixel) &gt; 1;
01111 
01112     <span class="keywordflow">if</span> (!bColor) {
01113 
01114         cbBits = (((pcurCreate-&gt;<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o6">cx</a> + 0x0F) &amp; ~0x0F) &gt;&gt; 3) * pcurCreate-&gt;<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o7">cy</a>;
01115 
01116         pBits = (LPBYTE)<a class="code" href="../../d6/d0/usercli_8h.html#a136">UserLocalAlloc</a>(HEAP_ZERO_MEMORY, (cbBits * 2));
01117 
01118         <span class="keywordflow">if</span> (pBits == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01119             <a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a156">NtUserDestroyCursor</a>(hcurNew, CURSOR_ALWAYSDESTROY);
01120             <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01121         }
01122 
01123         RtlCopyMemory(pBits, lpANDbits, cbBits);
01124         RtlCopyMemory(pBits + cbBits, lpXORbits, cbBits);
01125         lpANDbits = pBits;
01126     }
01127 
01128     <span class="comment">/*</span>
01129 <span class="comment">     * Create hbmMask (its always MonoChrome)</span>
01130 <span class="comment">     */</span>
01131     cx = pcurCreate-&gt;<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o6">cx</a>;
01132     <a class="code" href="../../d1/d1/inctlpan_8c.html#a3">cy</a> = pcurCreate-&gt;<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o7">cy</a> * 2;
01133 
01134     pcurCreate-&gt;<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o10">hbmMask</a> = CreateBitmap(cx, cy, 1, 1, lpANDbits);
01135 
01136     <span class="keywordflow">if</span> (pcurCreate-&gt;<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o10">hbmMask</a> == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01137 
01138         <span class="comment">/*</span>
01139 <span class="comment">         * If this is a COLOR icon/cursor, lpANDBits doesn't need to be</span>
01140 <span class="comment">         * pcurCreate-&gt;cy * 2; indeed, we don't use this double height at all.</span>
01141 <span class="comment">         * This is a bug that will be fixed post 4.0.</span>
01142 <span class="comment">         * For now, let's try to handle the case where the CreateBitmap call</span>
01143 <span class="comment">         * failed because the caller didn't pass in a double height AND mask</span>
01144 <span class="comment">         * (Win95 doesn't have this bug)</span>
01145 <span class="comment">         */</span>
01146         <span class="keywordflow">if</span> (bColor) {
01147 
01148             RIPMSG0(RIP_WARNING, <span class="stringliteral">"CreateIcoCurIndirect: Retrying hbmMask creation."</span>);
01149 
01150             cbBits = (((pcurCreate-&gt;<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o6">cx</a> + 0x0F) &amp; ~0x0F) &gt;&gt; 3) * pcurCreate-&gt;<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o7">cy</a>;
01151             pBits = (LPBYTE)<a class="code" href="../../d6/d0/usercli_8h.html#a136">UserLocalAlloc</a>(HEAP_ZERO_MEMORY, cbBits*2);
01152 
01153             <span class="keywordflow">if</span> (pBits == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01154                 <a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a156">NtUserDestroyCursor</a>(hcurNew, CURSOR_ALWAYSDESTROY);
01155                 <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01156             }
01157 
01158             RtlCopyMemory(pBits, lpANDbits, cbBits);
01159             pcurCreate-&gt;<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o10">hbmMask</a> = CreateBitmap(cx, cy, 1, 1, pBits);
01160             <a class="code" href="../../d6/d0/usercli_8h.html#a138">UserLocalFree</a>(pBits);
01161 
01162             pBits = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01163         }
01164 
01165         <span class="keywordflow">if</span> (pcurCreate-&gt;<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o10">hbmMask</a> == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01166 
01167             <span class="comment">/*</span>
01168 <span class="comment">             * CreateBitmap() failed.  Clean-up and get out of here.</span>
01169 <span class="comment">             */</span>
01170             <a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a156">NtUserDestroyCursor</a>(hcurNew, CURSOR_ALWAYSDESTROY);
01171 
01172             <span class="keywordflow">if</span> (pBits != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
01173                 <a class="code" href="../../d6/d0/usercli_8h.html#a138">UserLocalFree</a>(pBits);
01174 
01175             <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01176         }
01177     }
01178 
01179     <span class="comment">/*</span>
01180 <span class="comment">     * Create hbmColor or NULL it so that CallOEMCursor doesn't think we are</span>
01181 <span class="comment">     * color.</span>
01182 <span class="comment">     */</span>
01183     <span class="keywordflow">if</span> (bColor) {
01184         pcurCreate-&gt;<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o11">hbmColor</a> = CreateBitmap(cx,
01185                                             cy / 2,
01186                                             cPlanes,
01187                                             cBitsPixel,
01188                                             lpXORbits);
01189 
01190         <span class="keywordflow">if</span> (pcurCreate-&gt;<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o11">hbmColor</a> == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01191 
01192             <span class="comment">/*</span>
01193 <span class="comment">             * CreateBitmap() failed.  Clean-up and get out of here.</span>
01194 <span class="comment">             */</span>
01195             DeleteObject(pcurCreate-&gt;<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o10">hbmMask</a>);
01196             <a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a156">NtUserDestroyCursor</a>(hcurNew, CURSOR_ALWAYSDESTROY);
01197             <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01198         }
01199 
01200         pcurCreate-&gt;<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o5">bpp</a> = (cPlanes * cBitsPixel);
01201 
01202     } <span class="keywordflow">else</span> {
01203         pcurCreate-&gt;<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o11">hbmColor</a> = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01204         pcurCreate-&gt;<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o5">bpp</a>      = 1;
01205     }
01206 
01207     <span class="comment">/*</span>
01208 <span class="comment">     * Load contents into the cursor/icon object</span>
01209 <span class="comment">     */</span>
01210     pcurCreate-&gt;<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o7">cy</a>            = <a class="code" href="../../d1/d1/inctlpan_8c.html#a3">cy</a>;
01211     pcurCreate-&gt;<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o2">lpModName</a>     = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01212     pcurCreate-&gt;<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o1">lpName</a>        = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01213     pcurCreate-&gt;<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o3">rt</a>            = 0;
01214     pcurCreate-&gt;<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o0">CURSORF_flags</a> = 0;
01215 
01216     <span class="keywordflow">if</span> (<a class="code" href="../../d4/d1/userk_8h.html#a1114">_SetCursorIconData</a>(hcurNew, pcurCreate)) {
01217         <span class="keywordflow">if</span> (pBits != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
01218             <a class="code" href="../../d6/d0/usercli_8h.html#a138">UserLocalFree</a>(pBits);
01219         <span class="keywordflow">return</span> hcurNew;
01220     }
01221 
01222     <span class="comment">/*</span>
01223 <span class="comment">     * Could not set up cursor/icon, so free resources.</span>
01224 <span class="comment">     */</span>
01225     <a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a156">NtUserDestroyCursor</a>(hcurNew, CURSOR_ALWAYSDESTROY);
01226     DeleteObject(pcurCreate-&gt;<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o10">hbmMask</a>);
01227 
01228     <span class="keywordflow">if</span> (pcurCreate-&gt;<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o11">hbmColor</a>)
01229         DeleteObject(pcurCreate-&gt;<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o11">hbmColor</a>);
01230     <span class="keywordflow">if</span> (pBits != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
01231         <a class="code" href="../../d6/d0/usercli_8h.html#a138">UserLocalFree</a>(pBits);
01232 
01233     <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01234 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a59" doxytag="clres.c::CreateIcon" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HICON WINAPI CreateIcon           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HINSTANCE&nbsp;</td>
          <td class="mdname" nowrap> <em>hModule</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>iWidth</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>iHeight</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>planes</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>bpp</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>CONST <a class="el" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>lpANDplane</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>CONST <a class="el" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>lpXORplane</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l01278">1278</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
References <a class="el" href="../../d5/d8/clres_8c-source.html#l01084">CreateIcoCurIndirect()</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, and <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00062">SHORT</a>.
<p>
<pre class="fragment"><div>01286 {
01287     <a class="code" href="../../d8/d1/structtagCURSORDATA.html">CURSORDATA</a> cur;
01288     UNREFERENCED_PARAMETER(hModule);
01289 
01290     RtlZeroMemory(&amp;cur, <span class="keyword">sizeof</span>(cur));
01291     cur.<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o8">xHotspot</a> = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a>)(iWidth / 2);
01292     cur.<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o9">yHotspot</a> = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a>)(iHeight / 2);
01293     cur.<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o6">cx</a>       = (<a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)iWidth;
01294     cur.<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o7">cy</a>       = (<a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)iHeight;
01295 
01296     <span class="keywordflow">return</span> <a class="code" href="../../d4/d9/clres_8c.html#a57">CreateIcoCurIndirect</a>(&amp;cur, planes, bpp, lpANDplane, lpXORplane);
01297 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a69" doxytag="clres.c::CreateIconFromResource" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HICON WINAPI CreateIconFromResource           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>presbits</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>dwResSize</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>BOOL&nbsp;</td>
          <td class="mdname" nowrap> <em>fIcon</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>dwVer</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l01604">1604</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
References <a class="el" href="../../d5/d8/clres_8c-source.html#l01627">CreateIconFromResourceEx()</a>.
<p>
<pre class="fragment"><div>01609 {
01610     <span class="keywordflow">return</span> <a class="code" href="../../d4/d9/clres_8c.html#a70">CreateIconFromResourceEx</a>(presbits,
01611                                     dwResSize,
01612                                     fIcon,
01613                                     dwVer,
01614                                     0,
01615                                     0,
01616                                     LR_DEFAULTSIZE | LR_SHARED);
01617 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a70" doxytag="clres.c::CreateIconFromResourceEx" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HICON WINAPI CreateIconFromResourceEx           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>presbits</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>dwResSize</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>BOOL&nbsp;</td>
          <td class="mdname" nowrap> <em>fIcon</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>dwVer</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>cxDesired</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>cyDesired</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>LR_flags</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l01627">1627</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
References <a class="el" href="../../d5/d8/clres_8c-source.html#l03344">ConvertDIBIcon()</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l04074">GetIcoCurHeight()</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l04052">GetIcoCurWidth()</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l00060">ISRIFFFORMAT</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l01573">LoadCursorIconFromResource()</a>, and <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>.
<p>
Referenced by <a class="el" href="../../d7/d1/output_8c-source.html#l04700">ConsoleWindowProc()</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l01604">CreateIconFromResource()</a>, <a class="el" href="../../d7/d9/extract_8c-source.html#l00517">ExtractIconFromEXE()</a>, and <a class="el" href="../../d4/d1/rtlres_8c-source.html#l00396">IconFromBestImage()</a>.
<p>
<pre class="fragment"><div>01635 {
01636     UNREFERENCED_PARAMETER(dwResSize);
01637 
01638     <span class="comment">/*</span>
01639 <span class="comment">     * NT Specific code to validate the version.</span>
01640 <span class="comment">     */</span>
01641     <span class="keywordflow">if</span> ((dwVer &lt; 0x00020000) || (dwVer &gt; 0x00030000)) {
01642         RIPMSG0(RIP_WARNING, <span class="stringliteral">"CreateIconFromResourceEx: Invalid Paramter"</span>);
01643         <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01644     }
01645 
01646     <span class="comment">/*</span>
01647 <span class="comment">     * Set desired size of resource based on flags and/or true</span>
01648 <span class="comment">     * dimensions passed in.</span>
01649 <span class="comment">     */</span>
01650     cxDesired = <a class="code" href="../../d6/d0/usercli_8h.html#a652">GetIcoCurWidth</a>(cxDesired , fIcon, LR_flags, 0);
01651     cyDesired = <a class="code" href="../../d6/d0/usercli_8h.html#a653">GetIcoCurHeight</a>(cyDesired, fIcon, LR_flags, 0);
01652 
01653     <span class="keywordflow">if</span> (<a class="code" href="../../d4/d9/clres_8c.html#a10">ISRIFFFORMAT</a>(presbits)) {
01654         <span class="keywordflow">return</span> <a class="code" href="../../d4/d9/clres_8c.html#a68">LoadCursorIconFromResource</a> (presbits, NULL, cxDesired, cyDesired, LR_flags);
01655     } <span class="keywordflow">else</span> {
01656         <span class="keywordflow">return</span> <a class="code" href="../../d6/d0/usercli_8h.html#a660">ConvertDIBIcon</a>((LPBITMAPINFOHEADER)presbits,
01657                               NULL,
01658                               NULL,
01659                               fIcon,
01660                               cxDesired,
01661                               cyDesired,
01662                               LR_flags);
01663     }
01664 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a60" doxytag="clres.c::CreateIconIndirect" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HICON WINAPI CreateIconIndirect           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">PICONINFO&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>piconinfo</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l01307">1307</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
References <a class="el" href="../../d5/d3/kernel_2acons_8c-source.html#l00319">_SetCursorIconData()</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l04377">CopyBmp()</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02169">CURSOR_ALWAYSDESTROY</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d2/d7/clglobal_8c-source.html#l00090">gcsHdc</a>, <a class="el" href="../../d2/d7/clglobal_8c-source.html#l00101">ghdcBits2</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l04526">NtUserCallOneParam()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l04033">NtUserDestroyCursor()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00411">PTR_TO_ID</a>, and <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00062">SHORT</a>.
<p>
Referenced by <a class="el" href="../../d4/d7/client_8c-source.html#l00150">CopyIcon()</a>, and <a class="el" href="../../d7/d9/extract_8c-source.html#l00426">ExtractIconFromBMP()</a>.
<p>
<pre class="fragment"><div>01309 {
01310     HCURSOR    hcur;
01311     <a class="code" href="../../d8/d1/structtagCURSORDATA.html">CURSORDATA</a> cur;
01312     BITMAP     bmMask;
01313     BITMAP     bmColor;
01314     HBITMAP    hbmpBits2, hbmpMem;
01315     HDC        hdcMem;
01316 
01317     <span class="comment">/*</span>
01318 <span class="comment">     * Make sure the bitmaps are real, and get their dimensions.</span>
01319 <span class="comment">     */</span>
01320     <span class="keywordflow">if</span> (!GetObjectW(piconinfo-&gt;hbmMask, <span class="keyword">sizeof</span>(BITMAP), &amp;bmMask))
01321         <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01322 
01323     <span class="keywordflow">if</span> (piconinfo-&gt;hbmColor != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01324         <span class="keywordflow">if</span> (!GetObjectW(piconinfo-&gt;hbmColor, <span class="keyword">sizeof</span>(BITMAP), &amp;bmColor))
01325             <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01326     }
01327 
01328     <span class="comment">/*</span>
01329 <span class="comment">     * Allocate CURSOR structure.</span>
01330 <span class="comment">     */</span>
01331     hcur = (HCURSOR)<a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a174">NtUserCallOneParam</a>(0, SFI__CREATEEMPTYCURSOROBJECT);
01332     <span class="keywordflow">if</span> (hcur == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
01333         <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01334 
01335     <span class="comment">/*</span>
01336 <span class="comment">     * Internally, USER stores the height as 2 icons high - because when</span>
01337 <span class="comment">     * loading bits from a resource, in both b/w and color icons, the</span>
01338 <span class="comment">     * bits are stored on top of one another (AND/XOR mask, AND/COLOR bitmap).</span>
01339 <span class="comment">     * When bitmaps are passed in to CreateIconIndirect(), they are passed</span>
01340 <span class="comment">     * as two bitmaps in the color case, and one bitmap (with the stacked</span>
01341 <span class="comment">     * masks) in the black and white case.  Adjust cur.cy so it is 2 icons</span>
01342 <span class="comment">     * high in both cases.</span>
01343 <span class="comment">     */</span>
01344 
01345     RtlZeroMemory(&amp;cur, <span class="keyword">sizeof</span>(cur));
01346     cur.<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o6">cx</a> = bmMask.bmWidth;
01347 
01348     <span class="keywordflow">if</span> (piconinfo-&gt;hbmColor == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01349 
01350         cur.<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o7">cy</a>  = bmMask.bmHeight;
01351         cur.<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o5">bpp</a> = 1;
01352 
01353     } <span class="keywordflow">else</span> {
01354         cur.<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o7">cy</a>       = bmMask.bmHeight * 2;
01355         cur.<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o5">bpp</a>      = (<a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)(bmColor.bmBitsPixel * bmColor.bmPlanes);
01356         cur.<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o11">hbmColor</a> = <a class="code" href="../../d4/d9/clres_8c.html#a28">CopyBmp</a>(piconinfo-&gt;hbmColor, 0, 0, LR_DEFAULTCOLOR);
01357 
01358         <span class="keywordflow">if</span> (cur.<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o11">hbmColor</a> == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01359             RIPMSG0(RIP_WARNING, <span class="stringliteral">"CreateIconIndirect: Failed to copy piconinfo-&gt;hbmColor"</span>);
01360             <span class="keywordflow">goto</span> CleanUp;
01361         }
01362     }
01363 
01364     <span class="comment">/*</span>
01365 <span class="comment">     * hbmMask must always be double height, even for color icons.</span>
01366 <span class="comment">     * So cy might be equal to bmMask.bmHeight * 2 at this point.</span>
01367 <span class="comment">     * If this is the case, the second half of hbmMask won't be initilized;</span>
01368 <span class="comment">     * nobody is supposed to use it but GDI expects it there when checking the</span>
01369 <span class="comment">     * bitmap dimensions (for cursors)</span>
01370 <span class="comment">     */</span>
01371     cur.<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o10">hbmMask</a>  =  CreateBitmap(cur.<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o6">cx</a>, cur.<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o7">cy</a>, 1, 1, NULL);
01372 
01373     <span class="keywordflow">if</span> (cur.<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o10">hbmMask</a> == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01374         RIPMSG0(RIP_WARNING, <span class="stringliteral">"CreateIconIndirect: Failed to create cur.hbmMask"</span>);
01375         <span class="keywordflow">goto</span> CleanUp;
01376     }
01377 
01378     RtlEnterCriticalSection(&amp;gcsHdc);
01379 
01380 
01381     <span class="keywordflow">if</span> (hdcMem = CreateCompatibleDC (ghdcBits2)) {
01382 
01383         hbmpMem = SelectObject(hdcMem, cur.<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o10">hbmMask</a>);
01384         hbmpBits2 = SelectObject(ghdcBits2, piconinfo-&gt;hbmMask);
01385 
01386         BitBlt(hdcMem,
01387                0,
01388                0,
01389                bmMask.bmWidth,
01390                bmMask.bmHeight,
01391                ghdcBits2,
01392                0,
01393                0,
01394                SRCCOPY);
01395 
01396         SelectObject(hdcMem, hbmpMem);
01397         SelectObject(ghdcBits2, hbmpBits2);
01398         DeleteDC (hdcMem);
01399 
01400     } <span class="keywordflow">else</span> {
01401 
01402         RtlLeaveCriticalSection(&amp;gcsHdc);
01403         RIPMSG0(RIP_WARNING, <span class="stringliteral">"CreateIconIndirect: CreateCompatibleDC failed"</span>);
01404         <span class="keywordflow">goto</span> CleanUp;
01405     }
01406 
01407     RtlLeaveCriticalSection(&amp;gcsHdc);
01408 
01409     <span class="comment">/*</span>
01410 <span class="comment">     * rt and Hotspot</span>
01411 <span class="comment">     */</span>
01412     <span class="keywordflow">if</span> (piconinfo-&gt;fIcon) {
01413         cur.<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o3">rt</a>        = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a99">PTR_TO_ID</a>(RT_ICON);
01414         cur.<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o8">xHotspot</a> = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a>)(cur.<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o6">cx</a> / 2);
01415         cur.<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o9">yHotspot</a> = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a>)(cur.<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o7">cy</a> / 4);
01416     } <span class="keywordflow">else</span> {
01417         cur.<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o3">rt</a>        = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a99">PTR_TO_ID</a>(RT_CURSOR);
01418         cur.<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o8">xHotspot</a> = ((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a>)piconinfo-&gt;xHotspot);
01419         cur.<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o9">yHotspot</a> = ((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a>)piconinfo-&gt;yHotspot);
01420     }
01421 
01422 
01423     <span class="keywordflow">if</span> (<a class="code" href="../../d4/d1/userk_8h.html#a1114">_SetCursorIconData</a>(hcur, &amp;cur)) {
01424         <span class="keywordflow">return</span> hcur;
01425     }
01426 
01427 CleanUp:
01428     <span class="comment">/*</span>
01429 <span class="comment">     * Note that if this fails, the bitmaps have NOT been made public.</span>
01430 <span class="comment">     */</span>
01431     <span class="keywordflow">if</span> (cur.<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o10">hbmMask</a> != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01432         DeleteObject(cur.<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o10">hbmMask</a>);
01433     }
01434     <span class="keywordflow">if</span> (cur.<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o11">hbmColor</a> != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01435         DeleteObject(cur.<a class="code" href="../../d8/d1/structtagCURSORDATA.html#o11">hbmColor</a>);
01436     }
01437 
01438     <a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a156">NtUserDestroyCursor</a>(hcur, CURSOR_ALWAYSDESTROY);
01439     <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01440 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a72" doxytag="clres.c::CreateScreenBitmap" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HBITMAP CreateScreenBitmap           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>cx</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>cy</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>planes</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>bpp</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>lpBits</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPBOOL&nbsp;</td>
          <td class="mdname" nowrap> <em>pf1Bpp</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l01732">1732</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
References <a class="el" href="../../d2/d0/inctlpan_8c-source.html#l00480">cy</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l00054">GETINITDC</a>, <a class="el" href="../../d2/d7/clglobal_8c-source.html#l00051">gpsi</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">LPVOID</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l00057">RELEASEINITDC</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, and <a class="el" href="../../d0/d5/ndismain_8h-source.html#l00026">UINT</a>.
<p>
<pre class="fragment"><div>01739 {
01740     HDC     hdcScreen;
01741     HBITMAP hbm = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01742     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>   dwCount;
01743 
01744     <span class="keyword">static</span> <span class="keyword">struct </span>{
01745         BITMAPINFOHEADER bi;
01746         <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>            ct[16];
01747     } dib4Vga = {{<span class="keyword">sizeof</span>(BITMAPINFOHEADER),
01748                   0,
01749                   0,
01750                   1,
01751                   4,
01752                   BI_RGB,
01753                   0,
01754                   0,
01755                   0,
01756                   16,
01757                   0
01758                  },
01759                  {0x00000000,
01760                   0x00800000,
01761                   0x00008000,
01762                   0x00808000,
01763                   0x00000080,
01764                   0x00800080,
01765                   0x00008080,
01766                   0x00C0C0C0,
01767                   0x00808080,
01768                   0x00FF0000,
01769                   0x0000FF00,
01770                   0x00FFFF00,
01771                   0x000000FF,
01772                   0x00FF00FF,
01773                   0x0000FFFF,
01774                   0x00FFFFFF
01775                  }
01776                 };
01777 
01778     <span class="keyword">static</span> <span class="keyword">struct </span>{
01779         BITMAPINFOHEADER bi;
01780         <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>            ct[2];
01781     } dib1Vga = {{<span class="keyword">sizeof</span>(BITMAPINFOHEADER),
01782                   0,
01783                   0,
01784                   1,
01785                   1,
01786                   BI_RGB,
01787                   0,
01788                   0,
01789                   0,
01790                   2,
01791                   0
01792                  },
01793                  {0x00000000,
01794                   0x00FFFFFF
01795                  }
01796                 };
01797 
01798 
01799     <span class="comment">/*</span>
01800 <span class="comment">     * Create the surface.</span>
01801 <span class="comment">     */</span>
01802     <span class="keywordflow">if</span> (hdcScreen = <a class="code" href="../../d4/d9/clres_8c.html#a8">GETINITDC</a>()) {
01803 
01804         <span class="comment">/*</span>
01805 <span class="comment">         * This appears to mess up color to mono conversion by losing all</span>
01806 <span class="comment">         * the data and forcing all non-forground colors to black.</span>
01807 <span class="comment">         * (try copyimage with IDC_WARNING_DEFAULT)</span>
01808 <span class="comment">         * This is what win95 does but their system works.  The scary thing</span>
01809 <span class="comment">         * (according to marke) is that win95 may have changed GDI to make</span>
01810 <span class="comment">         * this work.</span>
01811 <span class="comment">         *</span>
01812 <span class="comment">         * In order to get nearest-color-matching compatible with Win95,</span>
01813 <span class="comment">         * we're going to need to use the CreateDIBitmap() for mono-surfaces.</span>
01814 <span class="comment">         * This code-path will do nearest-color, rather than color-matching.</span>
01815 <span class="comment">         */</span>
01816         <span class="keywordflow">if</span> ((bpp == 1) &amp;&amp; (planes == 1)) {
01817 
01818             dib1Vga.bi.biWidth  = cx;
01819             dib1Vga.bi.biHeight = <a class="code" href="../../d1/d1/inctlpan_8c.html#a3">cy</a>;
01820 
01821             hbm = CreateDIBitmap(hdcScreen,
01822                                  (LPBITMAPINFOHEADER)&amp;dib1Vga,
01823                                  CBM_CREATEDIB,
01824                                  NULL,
01825                                  (LPBITMAPINFO)&amp;dib1Vga,
01826                                  DIB_RGB_COLORS);
01827 
01828             *pf1Bpp = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01829 
01830         } <span class="keywordflow">else</span> {
01831 
01832             <span class="keywordflow">if</span> (((planes == 0) || (planes == <a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;Planes)) &amp;&amp;
01833                 ((bpp == 0) || (bpp == <a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;BitsPixel))) {
01834 
01835                 hbm = CreateCompatibleBitmap(hdcScreen, cx, cy);
01836 
01837             } <span class="keywordflow">else</span> {
01838 
01839                 dib4Vga.bi.biBitCount = planes * bpp ? planes * bpp : <a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;BitCount;
01840 
01841 <span class="preprocessor">#if 0 // We use to do the dib-section create, but this breaks icons</span>
01842 <span class="preprocessor"></span>      <span class="comment">// when they are made public (can't make a dibsection public). So</span>
01843       <span class="comment">// we now wil create this as a real-dib.</span>
01844       <span class="comment">//</span>
01845                 {
01846                 <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> dwDummy;
01847 
01848                 dib4Vga.bi.biWidth    =  cx;
01849                 dib4Vga.bi.biHeight   = -<a class="code" href="../../d1/d1/inctlpan_8c.html#a3">cy</a>;     <span class="comment">// top-down DIB (like a DDB)</span>
01850 
01851                 hbm = CreateDIBSection(hdcScreen,
01852                                        (LPBITMAPINFO)&amp;dib4Vga,
01853                                        DIB_RGB_COLORS,
01854                                        (LPVOID)&amp;dwDummy,
01855                                        0,
01856                                        0);
01857                 }
01858 <span class="preprocessor">#else</span>
01859 <span class="preprocessor"></span>                dib4Vga.bi.biWidth  = cx;
01860                 dib4Vga.bi.biHeight = <a class="code" href="../../d1/d1/inctlpan_8c.html#a3">cy</a>;
01861 
01862                 hbm = CreateDIBitmap(hdcScreen,
01863                                      (LPBITMAPINFOHEADER)&amp;dib4Vga,
01864                                      CBM_CREATEDIB,
01865                                      NULL,
01866                                      (LPBITMAPINFO)&amp;dib4Vga,
01867                                      DIB_RGB_COLORS);
01868 <span class="preprocessor">#endif</span>
01869 <span class="preprocessor"></span>            }
01870         }
01871 
01872         <a class="code" href="../../d4/d9/clres_8c.html#a9">RELEASEINITDC</a>(hdcScreen);
01873     }
01874 
01875     <span class="keywordflow">if</span> (hbm &amp;&amp; lpBits) {
01876 
01877         BITMAP bm;
01878 
01879         GetObject(hbm, <span class="keyword">sizeof</span>(BITMAP), &amp;bm);
01880         dwCount = (<a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)(<a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a>)(bm.bmWidthBytes * bm.bmPlanes) * (<a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)(<a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a>)<a class="code" href="../../d1/d1/inctlpan_8c.html#a3">cy</a>;
01881         SetBitmapBits(hbm, dwCount, lpBits);
01882     }
01883 
01884     <span class="keywordflow">return</span> hbm;
01885 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a37" doxytag="clres.c::DestroyAcceleratorTable" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL DestroyAcceleratorTable           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HACCEL&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>hAccel</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l00358">358</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l02134">tagACCELCACHE::dwLockCount</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l00285">FindAccResource()</a>, <a class="el" href="../../d2/d7/clglobal_8c-source.html#l00092">gcsAccelCache</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l04012">NtUserDestroyAcceleratorTable()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l02133">tagACCELCACHE::pacNext</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
<pre class="fragment"><div>00359 {
00360     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> fUnlocked = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00361     <a class="code" href="../../d9/d7/structtagACCELCACHE.html">PACCELCACHE</a> *ppacNext, pac;
00362 
00363     <span class="comment">/*</span>
00364 <span class="comment">     * If we added this table to our list, decrement the lock count</span>
00365 <span class="comment">     */</span>
00366     RtlEnterCriticalSection(&amp;gcsAccelCache);
00367         ppacNext = <a class="code" href="../../d4/d9/clres_8c.html#a35">FindAccResource</a>(hAccel, NULL);
00368         <span class="keywordflow">if</span> (*ppacNext != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00369             pac = *ppacNext;
00370             <span class="comment">/*</span>
00371 <span class="comment">             * Found it. Decrement lock count.</span>
00372 <span class="comment">             */</span>
00373             UserAssert(pac-&gt;<a class="code" href="../../d9/d7/structtagACCELCACHE.html#o1">dwLockCount</a> != 0);
00374             fUnlocked = (--pac-&gt;<a class="code" href="../../d9/d7/structtagACCELCACHE.html#o1">dwLockCount</a> == 0);
00375             <span class="comment">/*</span>
00376 <span class="comment">             * If noboby else wants this around, unlink it and nuke it.</span>
00377 <span class="comment">             */</span>
00378             <span class="keywordflow">if</span> (fUnlocked) {
00379                 *ppacNext = pac-&gt;<a class="code" href="../../d9/d7/structtagACCELCACHE.html#o0">pacNext</a>;
00380                 LocalFree(pac);
00381             }
00382         }
00383     RtlLeaveCriticalSection(&amp;gcsAccelCache);
00384 
00385     <span class="comment">/*</span>
00386 <span class="comment">     * If not totally deref'ed, return FALSE (win95 compat).</span>
00387 <span class="comment">     */</span>
00388     <span class="keywordflow">if</span> (fUnlocked) {
00389         <span class="keywordflow">return</span> <a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a155">NtUserDestroyAcceleratorTable</a>(hAccel);
00390     } <span class="keywordflow">else</span> {
00391         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00392     }
00393 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a55" doxytag="clres.c::DestroyCursor" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL WINAPI DestroyCursor           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HCURSOR&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>hcur</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l01017">1017</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02170">CURSOR_CALLFROMCLIENT</a>, and <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l04033">NtUserDestroyCursor()</a>.
<p>
Referenced by <a class="el" href="../../d5/d8/clres_8c-source.html#l04493">CopyIcoCur()</a>, and <a class="el" href="../../d7/d9/extract_8c-source.html#l00368">ExtractIconFromICO()</a>.
<p>
<pre class="fragment"><div>01019 {
01020     <span class="keywordflow">return</span> <a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a156">NtUserDestroyCursor</a>(hcur, CURSOR_CALLFROMCLIENT);
01021 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a45" doxytag="clres.c::DialogBoxIndirectParamA" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> INT_PTR WINAPI DialogBoxIndirectParamA           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HINSTANCE&nbsp;</td>
          <td class="mdname" nowrap> <em>hmod</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPCDLGTEMPLATEA&nbsp;</td>
          <td class="mdname" nowrap> <em>lpDlgTemplate</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HWND&nbsp;</td>
          <td class="mdname" nowrap> <em>hwndOwner</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>DLGPROC&nbsp;</td>
          <td class="mdname" nowrap> <em>lpDialogFunc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>dwInitParam</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l00728">728</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
References <a class="el" href="../../d5/d8/clres_8c-source.html#l00758">DialogBoxIndirectParamAorW()</a>.
<p>
<pre class="fragment"><div>00734 {
00735     <span class="keywordflow">return</span> <a class="code" href="../../d4/d9/clres_8c.html#a47">DialogBoxIndirectParamAorW</a>(hmod,
00736                                       (LPCDLGTEMPLATEW)lpDlgTemplate,
00737                                       hwndOwner,
00738                                       lpDialogFunc,
00739                                       dwInitParam,
00740                                       SCDLG_ANSI);
00741 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a47" doxytag="clres.c::DialogBoxIndirectParamAorW" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> INT_PTR WINAPI DialogBoxIndirectParamAorW           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HINSTANCE&nbsp;</td>
          <td class="mdname" nowrap> <em>hmod</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPCDLGTEMPLATEW&nbsp;</td>
          <td class="mdname" nowrap> <em>lpDlgTemplate</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HWND&nbsp;</td>
          <td class="mdname" nowrap> <em>hwndOwner</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>DLGPROC&nbsp;</td>
          <td class="mdname" nowrap> <em>lpDialogFunc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>dwInitParam</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>fAnsiFlags</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l00758">758</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
References <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l00609">GetSizeDialogTemplate()</a>, and <a class="el" href="../../d4/d8/dlgmgr_8c-source.html#l01246">InternalDialogBox()</a>.
<p>
Referenced by <a class="el" href="../../d5/d8/clres_8c-source.html#l00728">DialogBoxIndirectParamA()</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l00743">DialogBoxIndirectParamW()</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l00868">DialogBoxParamA()</a>, and <a class="el" href="../../d5/d8/clres_8c-source.html#l00902">DialogBoxParamW()</a>.
<p>
<pre class="fragment"><div>00765 {
00766     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> cb;
00767 
00768     <span class="comment">/*</span>
00769 <span class="comment">     * The server routine destroys the menu if it fails.</span>
00770 <span class="comment">     */</span>
00771     cb = <a class="code" href="../../d4/d9/clres_8c.html#a44">GetSizeDialogTemplate</a>(hmod, lpDlgTemplate);
00772 
00773     <span class="keywordflow">if</span> (!cb) {
00774         RIPMSG0(RIP_WARNING, <span class="stringliteral">"DialogBoxIndirectParam: Invalid Paramter"</span>);
00775         <span class="keywordflow">return</span> -1;
00776     }
00777 
00778     <span class="keywordflow">return</span> <a class="code" href="../../d6/d0/usercli_8h.html#a751">InternalDialogBox</a>(hmod,
00779                             (LPDLGTEMPLATE)lpDlgTemplate,
00780                             hwndOwner,
00781                             lpDialogFunc,
00782                             dwInitParam,
00783                             SCDLG_CLIENT | (fAnsiFlags &amp; (SCDLG_ANSI | SCDLG_16BIT)));
00784 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a46" doxytag="clres.c::DialogBoxIndirectParamW" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> INT_PTR WINAPI DialogBoxIndirectParamW           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HINSTANCE&nbsp;</td>
          <td class="mdname" nowrap> <em>hmod</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPCDLGTEMPLATEW&nbsp;</td>
          <td class="mdname" nowrap> <em>lpDlgTemplate</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HWND&nbsp;</td>
          <td class="mdname" nowrap> <em>hwndOwner</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>DLGPROC&nbsp;</td>
          <td class="mdname" nowrap> <em>lpDialogFunc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>dwInitParam</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l00743">743</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
References <a class="el" href="../../d5/d8/clres_8c-source.html#l00758">DialogBoxIndirectParamAorW()</a>.
<p>
<pre class="fragment"><div>00749 {
00750     <span class="keywordflow">return</span> <a class="code" href="../../d4/d9/clres_8c.html#a47">DialogBoxIndirectParamAorW</a>(hmod,
00751                                       lpDlgTemplate,
00752                                       hwndOwner,
00753                                       lpDialogFunc,
00754                                       dwInitParam,
00755                                       0);
00756 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a51" doxytag="clres.c::DialogBoxParamA" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> INT_PTR WINAPI DialogBoxParamA           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HINSTANCE&nbsp;</td>
          <td class="mdname" nowrap> <em>hmod</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPCSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>lpName</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HWND&nbsp;</td>
          <td class="mdname" nowrap> <em>hwndOwner</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>DLGPROC&nbsp;</td>
          <td class="mdname" nowrap> <em>lpDialogFunc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>dwInitParam</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l00868">868</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
References <a class="el" href="../../d5/d8/clres_8c-source.html#l00758">DialogBoxIndirectParamAorW()</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00907">FINDRESOURCEA</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00914">FREERESOURCE</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00911">LOADRESOURCE</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00912">LOCKRESOURCE</a>, and <a class="el" href="../../d7/d9/usercli_8h-source.html#l00913">UNLOCKRESOURCE</a>.
<p>
Referenced by <a class="el" href="../../d7/d4/mdiwin_8c-source.html#l02101">DefFrameProcWorker()</a>.
<p>
<pre class="fragment"><div>00874 {
00875     HANDLE h;
00876     PVOID  p;
00877     INT_PTR i = -1;
00878 
00879     <span class="keywordflow">if</span> (h = <a class="code" href="../../d6/d0/usercli_8h.html#a125">FINDRESOURCEA</a>(hmod, (LPSTR)lpName, (LPSTR)RT_DIALOG)) {
00880 
00881         <span class="keywordflow">if</span> (h = <a class="code" href="../../d6/d0/usercli_8h.html#a129">LOADRESOURCE</a>(hmod, h)) {
00882 
00883             <span class="keywordflow">if</span> (p = <a class="code" href="../../d6/d0/usercli_8h.html#a130">LOCKRESOURCE</a>(h, hmod)) {
00884 
00885                 i = <a class="code" href="../../d4/d9/clres_8c.html#a47">DialogBoxIndirectParamAorW</a>(hmod,
00886                                                p,
00887                                                hwndOwner,
00888                                                lpDialogFunc,
00889                                                dwInitParam,
00890                                                SCDLG_ANSI);
00891 
00892                 <a class="code" href="../../d6/d0/usercli_8h.html#a131">UNLOCKRESOURCE</a>(h, hmod);
00893             }
00894 
00895             <a class="code" href="../../d6/d0/usercli_8h.html#a132">FREERESOURCE</a>(h, hmod);
00896         }
00897     }
00898 
00899     <span class="keywordflow">return</span> i;
00900 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a52" doxytag="clres.c::DialogBoxParamW" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> INT_PTR WINAPI DialogBoxParamW           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HINSTANCE&nbsp;</td>
          <td class="mdname" nowrap> <em>hmod</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPCWSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>lpName</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HWND&nbsp;</td>
          <td class="mdname" nowrap> <em>hwndOwner</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>DLGPROC&nbsp;</td>
          <td class="mdname" nowrap> <em>lpDialogFunc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>dwInitParam</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l00902">902</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
References <a class="el" href="../../d5/d8/clres_8c-source.html#l00758">DialogBoxIndirectParamAorW()</a>, and <a class="el" href="../../d7/d9/usercli_8h-source.html#l00908">FINDRESOURCEW</a>.
<p>
Referenced by <a class="el" href="../../d7/d4/mdiwin_8c-source.html#l02101">DefFrameProcWorker()</a>.
<p>
<pre class="fragment"><div>00908 {
00909     HANDLE h;
00910     PVOID  p;
00911     INT_PTR i = -1;
00912 
00913     UserAssert(LOWORD(hmod) == 0); <span class="comment">// This should never be a WOW module</span>
00914 
00915     <span class="keywordflow">if</span> (h = <a class="code" href="../../d6/d0/usercli_8h.html#a126">FINDRESOURCEW</a>(hmod, lpName, RT_DIALOG)) {
00916 
00917         <span class="keywordflow">if</span> (p = LoadResource(hmod, h)) {
00918 
00919             i = <a class="code" href="../../d4/d9/clres_8c.html#a47">DialogBoxIndirectParamAorW</a>(hmod,
00920                                            p,
00921                                            hwndOwner,
00922                                            lpDialogFunc,
00923                                            dwInitParam,
00924                                            0);
00925         }
00926     }
00927 
00928     <span class="keywordflow">return</span> i;
00929 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a104" doxytag="clres.c::DIBFromBitmap" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PVOID DIBFromBitmap           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HBITMAP&nbsp;</td>
          <td class="mdname" nowrap> <em>hbmp</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HDC&nbsp;</td>
          <td class="mdname" nowrap> <em>hdc</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l04279">4279</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
References <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00958">UserLocalAlloc</a>, and <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02223">WIDTHBYTES</a>.
<p>
Referenced by <a class="el" href="../../d5/d8/clres_8c-source.html#l04377">CopyBmp()</a>.
<p>
<pre class="fragment"><div>04282 {
04283     BITMAP             bmp;
04284     LPBITMAPINFOHEADER lpbi;
04285     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>              cbBits;
04286     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>              cbPalette;
04287     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>              cbTotal;
04288     WORD               cBits;
04289 
04290     UserAssert(hbmp);
04291     UserAssert(hdc);
04292 
04293     <span class="keywordflow">if</span> (GetObject(hbmp, <span class="keyword">sizeof</span>(BITMAP), &amp;bmp) == 0)
04294         <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
04295 
04296     cBits = ((WORD)bmp.bmPlanes * (WORD)bmp.bmBitsPixel);
04297 
04298 TrySmallerDIB:
04299 
04300     cbBits = (<a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a548">WIDTHBYTES</a>((WORD)bmp.bmWidth * cBits) * (<a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)bmp.bmHeight;
04301 
04302     cbPalette = 0;
04303     <span class="keywordflow">if</span> (cBits &lt;= 8)
04304         cbPalette = (1 &lt;&lt; cBits) * <span class="keyword">sizeof</span>(RGBQUAD);
04305     <span class="keywordflow">else</span>
04306         cbPalette = 3 * <span class="keyword">sizeof</span>(RGBQUAD);
04307 
04308     cbTotal  = <span class="keyword">sizeof</span>(BITMAPINFOHEADER) + cbPalette + cbBits;
04309     lpbi = (LPBITMAPINFOHEADER)<a class="code" href="../../d6/d0/usercli_8h.html#a136">UserLocalAlloc</a>(HEAP_ZERO_MEMORY, cbTotal);
04310     <span class="keywordflow">if</span> (lpbi == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
04311 
04312         <span class="comment">/*</span>
04313 <span class="comment">         * Try a smaller DIB, if we can.  We can't if the DIB is mono.</span>
04314 <span class="comment">         */</span>
04315         <span class="keywordflow">switch</span> (cBits) {
04316         <span class="keywordflow">case</span> 4:
04317             cBits = 1;
04318             <span class="keywordflow">break</span>;
04319 
04320         <span class="keywordflow">case</span> 8:
04321             cBits = 4;
04322             <span class="keywordflow">break</span>;
04323 
04324         <span class="keywordflow">case</span> 16:
04325             cBits = 8;
04326             <span class="keywordflow">break</span>;
04327 
04328         <span class="keywordflow">case</span> 24:
04329             cBits = 16;
04330             <span class="keywordflow">break</span>;
04331 
04332         <span class="keywordflow">case</span> 32:
04333             cBits = 24;
04334             <span class="keywordflow">break</span>;
04335 
04336         <span class="keywordflow">default</span>:
04337             <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;   <span class="comment">// 1 or wierd.</span>
04338         }
04339 
04340         RIPMSG1(RIP_WARNING, <span class="stringliteral">"Not enough memory to create large color DIB, trying %d bpp."</span>, cBits);
04341         <span class="keywordflow">goto</span> TrySmallerDIB;
04342     }
04343 
04344     RtlZeroMemory(lpbi, <span class="keyword">sizeof</span>(BITMAPINFOHEADER));
04345     lpbi-&gt;biSize        = <span class="keyword">sizeof</span>(BITMAPINFOHEADER);
04346     lpbi-&gt;biWidth       = bmp.bmWidth;
04347     lpbi-&gt;biHeight      = bmp.bmHeight;
04348     lpbi-&gt;biPlanes      = 1;
04349     lpbi-&gt;biBitCount    = cBits;
04350 
04351     <span class="comment">/*</span>
04352 <span class="comment">     * Get old bitmap's DIB bits, using the current DC.</span>
04353 <span class="comment">     */</span>
04354     GetDIBits(hdc,
04355               hbmp,
04356               0,
04357               lpbi-&gt;biHeight,
04358               ((LPSTR)lpbi) + lpbi-&gt;biSize + cbPalette,
04359               (LPBITMAPINFO)lpbi,
04360               DIB_RGB_COLORS);
04361 
04362     lpbi-&gt;biClrUsed   = cbPalette / <span class="keyword">sizeof</span>(RGBQUAD);
04363     lpbi-&gt;biSizeImage = cbBits;
04364 
04365     <span class="keywordflow">return</span> lpbi;
04366 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a35" doxytag="clres.c::FindAccResource" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d9/d7/structtagACCELCACHE.html">PACCELCACHE</a>* FindAccResource           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HACCEL&nbsp;</td>
          <td class="mdname" nowrap> <em>hAccel</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>pRes</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l00285">285</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
References <a class="el" href="../../d7/d9/usercli_8h-source.html#l02134">tagACCELCACHE::dwLockCount</a>, <a class="el" href="../../d2/d7/clglobal_8c-source.html#l00170">gpac</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l02135">tagACCELCACHE::hAccel</a>, <a class="el" href="../../d1/d0/inc_2user_8h.html#a1179">HMValidateHandleNoDesktop()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l02133">tagACCELCACHE::pacNext</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l02136">tagACCELCACHE::pRes</a>, and <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00913">TYPE_ACCELTABLE</a>.
<p>
Referenced by <a class="el" href="../../d5/d8/clres_8c-source.html#l00358">DestroyAcceleratorTable()</a>, and <a class="el" href="../../d5/d8/clres_8c-source.html#l00403">LoadAcc()</a>.
<p>
<pre class="fragment"><div>00286 {
00287      <span class="comment">/************************************</span>
00288 <span class="comment">     * The caller must own gcsAccelCache *</span>
00289 <span class="comment">     *************************************/</span>
00290 
00291     <a class="code" href="../../d9/d7/structtagACCELCACHE.html">PACCELCACHE</a> * ppacNext = &amp;<a class="code" href="../../d1/d8/clglobal_8c.html#a66">gpac</a>;
00292     <a class="code" href="../../d9/d7/structtagACCELCACHE.html">PACCELCACHE</a> pac;
00293 
00294     <span class="comment">/*</span>
00295 <span class="comment">     * This is meant to search by handle or by pointer, not both</span>
00296 <span class="comment">     * So at least one of the parameters must be NULL.</span>
00297 <span class="comment">     */</span>
00298     UserAssert(!(hAccel &amp;&amp; pRes));
00299     <span class="comment">/*</span>
00300 <span class="comment">     * Walk the table</span>
00301 <span class="comment">     */</span>
00302     <span class="keywordflow">while</span> (*ppacNext != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00303         pac = *ppacNext;
00304         <span class="keywordflow">if</span> ((pac-&gt;<a class="code" href="../../d9/d7/structtagACCELCACHE.html#o3">pRes</a> == pRes) || (pac-&gt;<a class="code" href="../../d9/d7/structtagACCELCACHE.html#o2">hAccel</a> == hAccel)) {
00305             <span class="comment">/*</span>
00306 <span class="comment">            * Found it. Validate this entry before returning.</span>
00307 <span class="comment">            */</span>
00308             UserAssert(pac-&gt;<a class="code" href="../../d9/d7/structtagACCELCACHE.html#o1">dwLockCount</a> != 0);
00309             UserAssert(<a class="code" href="../../d1/d0/inc_2user_8h.html#a1179">HMValidateHandleNoDesktop</a>(pac-&gt;<a class="code" href="../../d9/d7/structtagACCELCACHE.html#o2">hAccel</a>, TYPE_ACCELTABLE));
00310             <span class="keywordflow">break</span>;
00311         }
00312 
00313         ppacNext = &amp;(pac-&gt;<a class="code" href="../../d9/d7/structtagACCELCACHE.html#o0">pacNext</a>);
00314     }
00315 
00316     <span class="keywordflow">return</span> ppacNext;
00317 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a96" doxytag="clres.c::GetBestImage" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> UINT GetBestImage           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">LPRESDIR&nbsp;</td>
          <td class="mdname" nowrap> <em>lprd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>uCount</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>cxDesired</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>cyDesired</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>bpp</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>BOOL&nbsp;</td>
          <td class="mdname" nowrap> <em>fIcon</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l03980">3980</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
References <a class="el" href="../../d2/d7/clglobal_8c-source.html#l00051">gpsi</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l03903">MatchImage()</a>, and <a class="el" href="../../d0/d5/ndismain_8h-source.html#l00026">UINT</a>.
<p>
Referenced by <a class="el" href="../../d5/d8/clres_8c-source.html#l04759">RtlGetIdFromDirectory()</a>.
<p>
<pre class="fragment"><div>03987 {
03988     <a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a> uIndex;
03989     <a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a> uT;
03990     <a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a> uIndexBest = 0;
03991     <a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a> uBest = (<a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a>)-1;
03992 
03993 
03994     <span class="comment">/*</span>
03995 <span class="comment">     * Get desired number of colors in # value, not bits value.  Note that</span>
03996 <span class="comment">     * we do NOT allow you to have  16- or 32- or 24- bit color icons.</span>
03997 <span class="comment">     *</span>
03998 <span class="comment">     * the icon resources can be 16, 24, 32 bpp, but the restable only has</span>
03999 <span class="comment">     * a color count, so a HiColor icon would have a max value in the</span>
04000 <span class="comment">     * restable.  we treat a 0 in the color count as "max colors"</span>
04001 <span class="comment">     */</span>
04002     <span class="keywordflow">if</span> (bpp == 0)
04003         bpp = (<a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a>)<a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;BitCount;
04004 
04005     <span class="keywordflow">if</span> (bpp &gt; 8)
04006         bpp = 8;
04007 
04008     bpp = 1 &lt;&lt; bpp;
04009 
04010     <span class="comment">/*</span>
04011 <span class="comment">     * Loop through resource entries, saving the "closest" item so far.  Most</span>
04012 <span class="comment">     * of the real work is in MatchImage(), which uses a fabricated formula</span>
04013 <span class="comment">     * to give us the results that we desire.  Namely, an image as close in</span>
04014 <span class="comment">     * size to what we want preferring bigger over smaller, then an image</span>
04015 <span class="comment">     * with the right color format</span>
04016 <span class="comment">     */</span>
04017     <span class="keywordflow">for</span> (uIndex = 0; uIndex &lt; uCount; uIndex++, lprd++) {
04018 
04019         <span class="comment">/*</span>
04020 <span class="comment">         * Get "matching" value.  How close are we to what we want?</span>
04021 <span class="comment">         */</span>
04022         uT = <a class="code" href="../../d4/d9/clres_8c.html#a95">MatchImage</a>(lprd, &amp;cxDesired, &amp;cyDesired, bpp, fIcon);
04023 
04024         <span class="keywordflow">if</span> (!uT) {
04025 
04026             <span class="comment">/*</span>
04027 <span class="comment">             * We've found an exact match!</span>
04028 <span class="comment">             */</span>
04029             <span class="keywordflow">return</span> uIndex;
04030 
04031         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (uT &lt; uBest) {
04032 
04033             <span class="comment">/*</span>
04034 <span class="comment">             * We've found a better match than the current alternative.</span>
04035 <span class="comment">             */</span>
04036             uBest = uT;
04037             uIndexBest = uIndex;
04038         }
04039     }
04040 
04041     <span class="keywordflow">return</span> uIndexBest;
04042 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a62" doxytag="clres.c::GetCursorFrameInfo" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HCURSOR WINAPI GetCursorFrameInfo           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HCURSOR&nbsp;</td>
          <td class="mdname" nowrap> <em>hcur</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPWSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>lpName</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>iFrame</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPDWORD&nbsp;</td>
          <td class="mdname" nowrap> <em>pjifRate</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPINT&nbsp;</td>
          <td class="mdname" nowrap> <em>pccur</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l01465">1465</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
References <a class="el" href="../../d5/d8/clres_8c-source.html#l02657">LoadIcoCur()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l07184">NtUserGetCursorFrameInfo()</a>, and <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>.
<p>
Referenced by <a class="el" href="../../d6/d4/statctl_8c-source.html#l01211">xxxNextAniIconStep()</a>, and <a class="el" href="../../d6/d4/statctl_8c-source.html#l00094">xxxSetStaticImage()</a>.
<p>
<pre class="fragment"><div>01471 {
01472     <span class="comment">/*</span>
01473 <span class="comment">     * Caller wants us to return the version of this cursor that is stored</span>
01474 <span class="comment">     * in the display driver.</span>
01475 <span class="comment">     */</span>
01476     <span class="keywordflow">if</span> (hcur == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01477 
01478         <span class="keywordflow">return</span> <a class="code" href="../../d6/d0/usercli_8h.html#a655">LoadIcoCur</a>(NULL,
01479                           lpName,
01480                           RT_CURSOR,
01481                           0,
01482                           0,
01483                           LR_DEFAULTSIZE);
01484     }
01485 
01486     <span class="keywordflow">return</span> <a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a268">NtUserGetCursorFrameInfo</a>(hcur, iFrame, pjifRate, pccur);
01487 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a99" doxytag="clres.c::GetIcoCurBpp" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> _inline <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> GetIcoCurBpp           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">UINT&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>lrFlags</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l04096">4096</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
References <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01071">PUSIF_PALETTEDISPLAY</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00202">SYSMET</a>, and <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01076">TEST_PUSIF</a>.
<p>
Referenced by <a class="el" href="../../d5/d8/clres_8c-source.html#l04377">CopyBmp()</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l04493">CopyIcoCur()</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l02657">LoadIcoCur()</a>, and <a class="el" href="../../d5/d8/clres_8c-source.html#l04759">RtlGetIdFromDirectory()</a>.
<p>
<pre class="fragment"><div>04098 {
04099     <span class="keywordflow">if</span> (lrFlags &amp; LR_MONOCHROME) {
04100 
04101 <span class="preprocessor">#if DBG</span>
04102 <span class="preprocessor"></span>        <span class="keywordflow">if</span> (lrFlags &amp; LR_VGACOLOR) {
04103             RIPMSG0(RIP_WARNING, <span class="stringliteral">"lrFlags has both MONOCHROME and VGACOLOR; assuming MONOCHROME"</span>);
04104         }
04105 <span class="preprocessor">#endif</span>
04106 <span class="preprocessor"></span>        <span class="keywordflow">return</span> 1;
04107 
04108     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (
04109             <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a368">TEST_PUSIF</a>(PUSIF_PALETTEDISPLAY) ||
04110             (lrFlags &amp; LR_VGACOLOR) ||
04111             !<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(SAMEDISPLAYFORMAT)) {
04112 
04113         <span class="keywordflow">return</span> 4;
04114     } <span class="keywordflow">else</span> {
04115         <span class="keywordflow">return</span> 0;
04116     }
04117 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a98" doxytag="clres.c::GetIcoCurHeight" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> _inline <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> GetIcoCurHeight           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>cyOrg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>BOOL&nbsp;</td>
          <td class="mdname" nowrap> <em>fIcon</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>lrFlags</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>cyDes</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l04074">4074</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
References <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, and <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00202">SYSMET</a>.
<p>
Referenced by <a class="el" href="../../d5/d8/clres_8c-source.html#l04493">CopyIcoCur()</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l01627">CreateIconFromResourceEx()</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l02657">LoadIcoCur()</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l04759">RtlGetIdFromDirectory()</a>, and <a class="el" href="../../d5/d8/clres_8c-source.html#l04200">WowServerLoadCreateCursorIcon()</a>.
<p>
<pre class="fragment"><div>04079 {
04080     <span class="keywordflow">if</span> (cyOrg) {
04081         <span class="keywordflow">return</span> cyOrg;
04082     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (lrFlags &amp; LR_DEFAULTSIZE) {
04083         <span class="keywordflow">return</span> (fIcon ? <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(CYICON) : <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(CYCURSOR));
04084     } <span class="keywordflow">else</span> {
04085         <span class="keywordflow">return</span> cyDes;
04086     }
04087 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a97" doxytag="clres.c::GetIcoCurWidth" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> _inline <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> GetIcoCurWidth           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>cxOrg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>BOOL&nbsp;</td>
          <td class="mdname" nowrap> <em>fIcon</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>lrFlags</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>cxDes</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l04052">4052</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
References <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, and <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00202">SYSMET</a>.
<p>
Referenced by <a class="el" href="../../d5/d8/clres_8c-source.html#l04493">CopyIcoCur()</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l01627">CreateIconFromResourceEx()</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l02657">LoadIcoCur()</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l04759">RtlGetIdFromDirectory()</a>, and <a class="el" href="../../d5/d8/clres_8c-source.html#l04200">WowServerLoadCreateCursorIcon()</a>.
<p>
<pre class="fragment"><div>04057 {
04058     <span class="keywordflow">if</span> (cxOrg) {
04059         <span class="keywordflow">return</span> cxOrg;
04060     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (lrFlags &amp; LR_DEFAULTSIZE) {
04061         <span class="keywordflow">return</span> (fIcon ? <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(CXICON) : <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(CXCURSOR));
04062     } <span class="keywordflow">else</span> {
04063         <span class="keywordflow">return</span> cxDes;
04064     }
04065 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a82" doxytag="clres.c::GetIconIdEx" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> UINT GetIconIdEx           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HINSTANCE&nbsp;</td>
          <td class="mdname" nowrap> <em>hmod</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HANDLE&nbsp;</td>
          <td class="mdname" nowrap> <em>hrsd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPCWSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>lpszType</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>cxDesired</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>cyDesired</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>LR_flags</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l02502">2502</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
References <a class="el" href="../../d7/d9/usercli_8h-source.html#l00912">LOCKRESOURCE</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l01550">LookupIconIdFromDirectoryEx()</a>, <a class="el" href="../../d0/d7/halvprnt_8c-source.html#l00031">PBYTE</a>, <a class="el" href="../../d0/d5/ndismain_8h-source.html#l00026">UINT</a>, and <a class="el" href="../../d7/d9/usercli_8h-source.html#l00913">UNLOCKRESOURCE</a>.
<p>
Referenced by <a class="el" href="../../d5/d8/clres_8c-source.html#l02544">LoadDIB()</a>.
<p>
<pre class="fragment"><div>02509 {
02510     <span class="keywordtype">int</span>         idIcon = 0;
02511     LPNEWHEADER lpnh;
02512 
02513     <span class="keywordflow">if</span> (lpnh = (LPNEWHEADER)<a class="code" href="../../d6/d0/usercli_8h.html#a130">LOCKRESOURCE</a>(hrsd, hmod)) {
02514 
02515         <span class="comment">/*</span>
02516 <span class="comment">         * Do a sanity check on this data structure.  Otherwise we'll GP FAULT</span>
02517 <span class="comment">         * when extracting an icon from a corrupted area.  Fix for B#9290.</span>
02518 <span class="comment">         * SANKAR, 08/13/91</span>
02519 <span class="comment">         */</span>
02520         <span class="keywordflow">if</span> ((lpnh-&gt;Reserved == 0) &amp;&amp;
02521             ((lpnh-&gt;ResType == IMAGE_ICON) || (lpnh-&gt;ResType == IMAGE_CURSOR))) {
02522 
02523             idIcon = <a class="code" href="../../d4/d9/clres_8c.html#a67">LookupIconIdFromDirectoryEx</a>((PBYTE)lpnh,
02524                                                  (lpszType == RT_ICON),
02525                                                  cxDesired,
02526                                                  cyDesired,
02527                                                  LR_flags);
02528         }
02529 
02530         <a class="code" href="../../d6/d0/usercli_8h.html#a131">UNLOCKRESOURCE</a>(hrsd, hmod);
02531     }
02532 
02533     <span class="keywordflow">return</span> idIcon;
02534 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a61" doxytag="clres.c::GetIconInfo" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL WINAPI GetIconInfo           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HICON&nbsp;</td>
          <td class="mdname" nowrap> <em>hicon</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>PICONINFO&nbsp;</td>
          <td class="mdname" nowrap> <em>piconinfo</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l01450">1450</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l01593">NtUserGetIconInfo()</a>, and <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>.
<p>
Referenced by <a class="el" href="../../d4/d7/client_8c-source.html#l00150">CopyIcon()</a>.
<p>
<pre class="fragment"><div>01453 {
01454     <span class="keywordflow">return</span> <a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a105">NtUserGetIconInfo</a>(hicon, piconinfo, NULL, NULL, NULL, FALSE);
01455 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a44" doxytag="clres.c::GetSizeDialogTemplate" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> GetSizeDialogTemplate           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HINSTANCE&nbsp;</td>
          <td class="mdname" nowrap> <em>hmod</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPCDLGTEMPLATE&nbsp;</td>
          <td class="mdname" nowrap> <em>pdt</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l00609">609</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00916">GETEXPWINVER</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l00589">SkipIDorString()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d0/d5/ndismain_8h-source.html#l00026">UINT</a>, and <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00475">VER40</a>.
<p>
Referenced by <a class="el" href="../../d5/d8/clres_8c-source.html#l00826">CreateDialogIndirectParamAorW()</a>, and <a class="el" href="../../d5/d8/clres_8c-source.html#l00758">DialogBoxIndirectParamAorW()</a>.
<p>
<pre class="fragment"><div>00612 {
00613     <a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a>           cdit;
00614     LPBYTE         pb;
00615     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>           fChicago;
00616     LPDLGTEMPLATE2 pdt2;
00617 
00618     <span class="keywordflow">if</span> (HIWORD(pdt-&gt;style) == 0xFFFF) {
00619 
00620         pdt2 = (LPDLGTEMPLATE2)pdt;
00621         fChicago = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00622 
00623         <span class="comment">/*</span>
00624 <span class="comment">         * Fail if the app is passing invalid style bits.</span>
00625 <span class="comment">         */</span>
00626         <span class="keywordflow">if</span> (pdt2-&gt;style &amp; ~(DS_VALID40 | 0xffff0000)) {
00627             RIPMSG0(RIP_WARNING, <span class="stringliteral">"Bad dialog style bits - please remove"</span>);
00628             <span class="keywordflow">return</span> 0;
00629         }
00630 
00631         pb = (LPBYTE)(((LPDLGTEMPLATE2)pdt) + 1);
00632 
00633     } <span class="keywordflow">else</span> {
00634 
00635         fChicago = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00636 
00637         <span class="comment">/*</span>
00638 <span class="comment">         * Check if invalid style bits are being passed. Fail if the app</span>
00639 <span class="comment">         * is a new app ( &gt;= VER40).</span>
00640 <span class="comment">         * This is to ensure that we are compatible with Chicago.</span>
00641 <span class="comment">         */</span>
00642         <span class="keywordflow">if</span> ((pdt-&gt;style &amp; ~(DS_VALID40 | 0xffff0000)) &amp;&amp;
00643                 (<a class="code" href="../../d6/d0/usercli_8h.html#a134">GETEXPWINVER</a>(hmod) &gt;= <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a101">VER40</a>)) {
00644 
00645             <span class="comment">/*</span>
00646 <span class="comment">             * It's a new app with invalid style bits - fail.</span>
00647 <span class="comment">             */</span>
00648             RIPMSG0(RIP_WARNING, <span class="stringliteral">"Bad dialog style bits - please remove"</span>);
00649             <span class="keywordflow">return</span> 0;
00650         }
00651 
00652         pb = (LPBYTE)(pdt + 1);
00653     }
00654 
00655     <span class="comment">/*</span>
00656 <span class="comment">     * If there is a menu ordinal, add 4 bytes skip it. Otherwise it is a</span>
00657 <span class="comment">     * string or just a 0.</span>
00658 <span class="comment">     */</span>
00659     pb = <a class="code" href="../../d4/d9/clres_8c.html#a43">SkipIDorString</a>(pb);
00660 
00661     <span class="comment">/*</span>
00662 <span class="comment">     * Skip window class and window text, adjust to next word boundary.</span>
00663 <span class="comment">     */</span>
00664     pb = <a class="code" href="../../d4/d9/clres_8c.html#a43">SkipIDorString</a>(pb);
00665     pb = <a class="code" href="../../d4/d9/clres_8c.html#a43">SkipIDorString</a>(pb);
00666 
00667     <span class="comment">/*</span>
00668 <span class="comment">     * Skip font type, size and name, adjust to next dword boundary.</span>
00669 <span class="comment">     */</span>
00670     <span class="keywordflow">if</span> ((fChicago ? pdt2-&gt;style : pdt-&gt;style) &amp; DS_SETFONT) {
00671         pb += fChicago ? <span class="keyword">sizeof</span>(<a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>) + <span class="keyword">sizeof</span>(WORD): <span class="keyword">sizeof</span>(WORD);
00672         pb = <a class="code" href="../../d4/d9/clres_8c.html#a43">SkipIDorString</a>(pb);
00673     }
00674     pb = (LPBYTE)(((ULONG_PTR)pb + 3) &amp; ~3);
00675 
00676     <span class="comment">/*</span>
00677 <span class="comment">     * Loop through dialog items now...</span>
00678 <span class="comment">     */</span>
00679     cdit = fChicago ? pdt2-&gt;cDlgItems : pdt-&gt;cdit;
00680 
00681     <span class="keywordflow">while</span> (cdit-- != 0) {
00682 
00683         <a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a> cbCreateParams;
00684 
00685         pb += fChicago ? <span class="keyword">sizeof</span>(DLGITEMTEMPLATE2) : <span class="keyword">sizeof</span>(DLGITEMTEMPLATE);
00686 
00687         <span class="comment">/*</span>
00688 <span class="comment">         * Skip the dialog control class name.</span>
00689 <span class="comment">         */</span>
00690         pb = <a class="code" href="../../d4/d9/clres_8c.html#a43">SkipIDorString</a>(pb);
00691 
00692         <span class="comment">/*</span>
00693 <span class="comment">         * Look at window text now.</span>
00694 <span class="comment">         */</span>
00695         pb = <a class="code" href="../../d4/d9/clres_8c.html#a43">SkipIDorString</a>(pb);
00696 
00697         cbCreateParams = *((LPWORD)pb);
00698 
00699         <span class="comment">/*</span>
00700 <span class="comment">         * skip any CreateParams which include the generated size WORD.</span>
00701 <span class="comment">         */</span>
00702         <span class="keywordflow">if</span> (cbCreateParams)
00703             pb += cbCreateParams;
00704 
00705         pb += <span class="keyword">sizeof</span>(WORD);
00706 
00707         <span class="comment">/*</span>
00708 <span class="comment">         * Point at the next dialog item. (DWORD aligned)</span>
00709 <span class="comment">         */</span>
00710         pb = (LPBYTE)(((ULONG_PTR)pb + 3) &amp; ~3);
00711     }
00712 
00713     <span class="comment">/*</span>
00714 <span class="comment">     * Return template size.</span>
00715 <span class="comment">     */</span>
00716     <span class="keywordflow">return</span> (<a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)(pb - (LPBYTE)pdt);
00717 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a87" doxytag="clres.c::HowManyColors" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> HowManyColors           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d6/d0/usercli_8h.html#a378">UPBITMAPINFOHEADER</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>upbih</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOL&nbsp;</td>
          <td class="mdname" nowrap> <em>fOldFormat</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT OPTIONAL LPBYTE *&nbsp;</td>
          <td class="mdname" nowrap> <em>ppColorTable</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l03165">3165</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
References <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d4/d9/clres_8c.html#a16">upbch</a>, and <a class="el" href="../../d7/d9/usercli_8h-source.html#l00923">UPBITMAPINFOHEADER</a>.
<p>
Referenced by <a class="el" href="../../d5/d8/clres_8c-source.html#l03203">ChangeDibColors()</a>, and <a class="el" href="../../d5/d8/clres_8c-source.html#l03546">CopyDibHdr()</a>.
<p>
<pre class="fragment"><div>03169 {
03170 <span class="preprocessor">#define upbch ((UPBITMAPCOREHEADER)upbih)</span>
03171 <span class="preprocessor"></span>
03172     <span class="keywordflow">if</span> (fOldFormat) {
03173         <span class="keywordflow">if</span> (ppColorTable != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
03174             *ppColorTable = (LPBYTE)(<a class="code" href="../../d4/d9/clres_8c.html#a16">upbch</a> + 1);
03175         }
03176         <span class="keywordflow">if</span> (<a class="code" href="../../d4/d9/clres_8c.html#a16">upbch</a>-&gt;bcBitCount &lt;= 8)
03177             <span class="keywordflow">return</span> (1 &lt;&lt; <a class="code" href="../../d4/d9/clres_8c.html#a16">upbch</a>-&gt;bcBitCount);
03178     } <span class="keywordflow">else</span> {
03179         <span class="keywordflow">if</span> (ppColorTable != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
03180             *ppColorTable = (LPBYTE)(upbih + 1);
03181         }
03182         <span class="keywordflow">if</span> (upbih-&gt;biClrUsed)
03183             <span class="keywordflow">return</span> (<a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)upbih-&gt;biClrUsed;
03184         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (upbih-&gt;biBitCount &lt;= 8)
03185             <span class="keywordflow">return</span> (1 &lt;&lt; upbih-&gt;biBitCount);
03186         <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((upbih-&gt;biBitCount == 16) || (upbih-&gt;biBitCount == 32))
03187             <span class="keywordflow">return</span> 3;
03188     }
03189     <span class="keywordflow">return</span> 0;
03190 
03191 <span class="preprocessor">#undef upbch</span>
03192 <span class="preprocessor"></span>}
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a108" doxytag="clres.c::InternalCopyImage" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HANDLE InternalCopyImage           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HANDLE&nbsp;</td>
          <td class="mdname" nowrap> <em>hImage</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>IMAGE_flag</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>cxNew</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>cyNew</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>LR_flags</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l04719">4719</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
References <a class="el" href="../../d5/d8/clres_8c-source.html#l04377">CopyBmp()</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l04493">CopyIcoCur()</a>, and <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>.
<p>
Referenced by <a class="el" href="../../d5/d8/clres_8c-source.html#l04697">CopyImage()</a>.
<p>
<pre class="fragment"><div>04725 {
04726     <span class="keywordflow">switch</span> (IMAGE_flag) {
04727 
04728     <span class="keywordflow">case</span> IMAGE_BITMAP:
04729         <span class="keywordflow">if</span> (GetObjectType(hImage) != OBJ_BITMAP) {
04730             RIPMSG0(RIP_ERROR, <span class="stringliteral">"CopyImage: invalid bitmap"</span>);
04731             <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
04732         }
04733 
04734         <span class="keywordflow">return</span> (HICON)<a class="code" href="../../d4/d9/clres_8c.html#a28">CopyBmp</a>(hImage, cxNew, cyNew, LR_flags);
04735 
04736     <span class="keywordflow">case</span> IMAGE_CURSOR:
04737     <span class="keywordflow">case</span> IMAGE_ICON:
04738 
04739         <span class="keywordflow">return</span> <a class="code" href="../../d4/d9/clres_8c.html#a106">CopyIcoCur</a>(hImage,
04740                           (IMAGE_flag == IMAGE_ICON),
04741                           cxNew,
04742                           cyNew,
04743                           LR_flags);
04744     }
04745 
04746     RIPERR0(ERROR_INVALID_PARAMETER, RIP_WARNING, <span class="stringliteral">"CopyImage: bad IMAGE_flag."</span>);
04747 
04748     <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
04749 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a38" doxytag="clres.c::LoadAcc" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HANDLE LoadAcc           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HINSTANCE&nbsp;</td>
          <td class="mdname" nowrap> <em>hmod</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HANDLE&nbsp;</td>
          <td class="mdname" nowrap> <em>hrl</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l00403">403</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
References <a class="el" href="../../d5/d8/clres_8c-source.html#l00327">AddAccResource()</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l00401">FACCEL_VALID</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l00285">FindAccResource()</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00735">FLASTKEY</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00914">FREERESOURCE</a>, <a class="el" href="../../d2/d7/clglobal_8c-source.html#l00092">gcsAccelCache</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00911">LOADRESOURCE</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00912">LOCKRESOURCE</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l03960">NtUserCreateAcceleratorTable()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d4/d9/clres_8c.html#a21">PRESOURCE_ACCEL</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00913">UNLOCKRESOURCE</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00958">UserLocalAlloc</a>, and <a class="el" href="../../d7/d9/usercli_8h-source.html#l00960">UserLocalFree</a>.
<p>
Referenced by <a class="el" href="../../d5/d8/clres_8c-source.html#l00501">LoadAcceleratorsA()</a>, and <a class="el" href="../../d5/d8/clres_8c-source.html#l00512">LoadAcceleratorsW()</a>.
<p>
<pre class="fragment"><div>00406 {
00407     <a class="code" href="../../d9/d7/structtagACCELCACHE.html">PACCELCACHE</a> * ppacNext;
00408     HANDLE handle = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00409 
00410     <span class="keywordflow">if</span> (hrl != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00411 
00412         <span class="keywordflow">if</span> (hrl = <a class="code" href="../../d6/d0/usercli_8h.html#a129">LOADRESOURCE</a>(hmod, hrl)) {
00413 
00414             <a class="code" href="../../d4/d9/clres_8c.html#a21">PRESOURCE_ACCEL</a> paccel;
00415 
00416             <span class="keywordflow">if</span> ((paccel = (<a class="code" href="../../d4/d9/clres_8c.html#a21">PRESOURCE_ACCEL</a>)<a class="code" href="../../d6/d0/usercli_8h.html#a130">LOCKRESOURCE</a>(hrl, hmod)) != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00417 
00418                 <span class="keywordtype">int</span> nAccel = 0;
00419                 <span class="keywordtype">int</span> i;
00420                 LPACCEL paccelT;
00421 
00422                 <span class="comment">/*</span>
00423 <span class="comment">                 * Check if we've already loaded accelerators from this</span>
00424 <span class="comment">                 *  same address</span>
00425 <span class="comment">                 */</span>
00426                 RtlEnterCriticalSection(&amp;gcsAccelCache);
00427                     ppacNext = <a class="code" href="../../d4/d9/clres_8c.html#a35">FindAccResource</a>(NULL, paccel);
00428                     <span class="keywordflow">if</span> (*ppacNext != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00429                         (*ppacNext)-&gt;dwLockCount++;
00430                         handle = (*ppacNext)-&gt;hAccel;
00431                     }
00432                 RtlLeaveCriticalSection(&amp;gcsAccelCache);
00433                 <span class="comment">/*</span>
00434 <span class="comment">                 * If we found this table on the global list,</span>
00435 <span class="comment">                 *  return the same handle (Win95 compat)</span>
00436 <span class="comment">                 */</span>
00437                 <span class="keywordflow">if</span> (handle != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00438                     <span class="keywordflow">goto</span> UnlockAndFree;
00439                 }
00440 
00441                 <span class="keywordflow">while</span> (!((paccel[nAccel].accel.fVirt) &amp; <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a190">FLASTKEY</a>)) {
00442 
00443                     <span class="keywordflow">if</span> (paccel[nAccel].accel.fVirt &amp; ~<a class="code" href="../../d4/d9/clres_8c.html#a13">FACCEL_VALID</a>) {
00444                         RIPMSG0(RIP_WARNING, <span class="stringliteral">"LoadAcc: Invalid Parameter"</span>);
00445                         <span class="keywordflow">goto</span> UnlockAndFree;
00446                     }
00447 
00448                     nAccel++;
00449                 }
00450 
00451                 <span class="keywordflow">if</span> (paccel[nAccel].accel.fVirt &amp; ~<a class="code" href="../../d4/d9/clres_8c.html#a13">FACCEL_VALID</a>) {
00452                     RIPMSG0(RIP_WARNING, <span class="stringliteral">"LoadAcc: Invalid Parameter"</span>);
00453                     <span class="keywordflow">goto</span> UnlockAndFree;
00454                 }
00455 
00456                 <span class="comment">/*</span>
00457 <span class="comment">                 * Since the accelerator table is coming from a resource, each</span>
00458 <span class="comment">                 * element has an extra WORD of padding which we strip here</span>
00459 <span class="comment">                 * to conform with the public (and internal) ACCEL structure.</span>
00460 <span class="comment">                 */</span>
00461                 paccelT = <a class="code" href="../../d6/d0/usercli_8h.html#a136">UserLocalAlloc</a>(0, <span class="keyword">sizeof</span>(ACCEL) * (nAccel + 1));
00462                 <span class="keywordflow">if</span> (paccelT == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00463                     <span class="keywordflow">goto</span> UnlockAndFree;
00464                 }
00465                 <span class="keywordflow">for</span> (i = 0; i &lt; nAccel + 1; i++) {
00466                     paccelT[i] = paccel[i].accel;
00467                 }
00468 
00469                 handle = <a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a153">NtUserCreateAcceleratorTable</a>(paccelT,
00470                                                       nAccel + 1);
00471 
00472                 <a class="code" href="../../d6/d0/usercli_8h.html#a138">UserLocalFree</a>(paccelT);
00473 
00474                 <span class="comment">/*</span>
00475 <span class="comment">                 * Add this handle/address to the global table so</span>
00476 <span class="comment">                 *  we won't load it twice.</span>
00477 <span class="comment">                 */</span>
00478                 <span class="keywordflow">if</span> (handle != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00479                     <a class="code" href="../../d4/d9/clres_8c.html#a36">AddAccResource</a>(handle, paccel);
00480                 }
00481 UnlockAndFree:
00482 
00483                 <a class="code" href="../../d6/d0/usercli_8h.html#a131">UNLOCKRESOURCE</a>(hrl, hmod);
00484             }
00485 
00486             <a class="code" href="../../d6/d0/usercli_8h.html#a132">FREERESOURCE</a>(hrl, hmod);
00487         }
00488     }
00489 
00490     <span class="keywordflow">return</span> handle;
00491 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a39" doxytag="clres.c::LoadAcceleratorsA" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HACCEL WINAPI LoadAcceleratorsA           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HINSTANCE&nbsp;</td>
          <td class="mdname" nowrap> <em>hmod</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPCSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>lpAccName</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l00501">501</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
References <a class="el" href="../../d7/d9/usercli_8h-source.html#l00907">FINDRESOURCEA</a>, and <a class="el" href="../../d5/d8/clres_8c-source.html#l00403">LoadAcc()</a>.
<p>
<pre class="fragment"><div>00504 {
00505     HANDLE hRes;
00506 
00507     hRes = <a class="code" href="../../d6/d0/usercli_8h.html#a125">FINDRESOURCEA</a>((HANDLE)hmod, lpAccName, (LPSTR)RT_ACCELERATOR);
00508 
00509     <span class="keywordflow">return</span> (HACCEL)<a class="code" href="../../d4/d9/clres_8c.html#a38">LoadAcc</a>(hmod, hRes);
00510 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a40" doxytag="clres.c::LoadAcceleratorsW" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HACCEL WINAPI LoadAcceleratorsW           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HINSTANCE&nbsp;</td>
          <td class="mdname" nowrap> <em>hmod</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPCWSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>lpAccName</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l00512">512</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
References <a class="el" href="../../d7/d9/usercli_8h-source.html#l00908">FINDRESOURCEW</a>, and <a class="el" href="../../d5/d8/clres_8c-source.html#l00403">LoadAcc()</a>.
<p>
<pre class="fragment"><div>00515 {
00516     HANDLE hRes;
00517 
00518     hRes = <a class="code" href="../../d6/d0/usercli_8h.html#a126">FINDRESOURCEW</a>((HANDLE)hmod, lpAccName, RT_ACCELERATOR);
00519 
00520     <span class="keywordflow">return</span> (HACCEL)<a class="code" href="../../d4/d9/clres_8c.html#a38">LoadAcc</a>(hmod, hRes);
00521 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a74" doxytag="clres.c::LoadBitmapA" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HBITMAP WINAPI LoadBitmapA           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HINSTANCE&nbsp;</td>
          <td class="mdname" nowrap> <em>hmod</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPCSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>lpName</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l02292">2292</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
References <a class="el" href="../../d5/d8/smbtrsup_8c-source.html#l00151">ID</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l01899">LoadBmp()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, and <a class="el" href="../../d7/d9/usercli_8h-source.html#l00960">UserLocalFree</a>.
<p>
<pre class="fragment"><div>02295 {
02296     LPWSTR  lpUniName;
02297     HBITMAP hRet;
02298 
02299     <span class="keywordflow">if</span> (<a class="code" href="../../d4/d9/smbtrsup_8c.html#a7">ID</a>(lpName))
02300         <span class="keywordflow">return</span> <a class="code" href="../../d4/d9/clres_8c.html#a73">LoadBmp</a>(hmod, (LPCWSTR)lpName, 0, 0, 0);
02301 
02302     <span class="keywordflow">if</span> (!MBToWCS(lpName, -1, &amp;lpUniName, -1, TRUE))
02303         <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
02304 
02305     hRet = <a class="code" href="../../d4/d9/clres_8c.html#a73">LoadBmp</a>(hmod, lpUniName, 0, 0, 0);
02306 
02307     <a class="code" href="../../d6/d0/usercli_8h.html#a138">UserLocalFree</a>(lpUniName);
02308 
02309     <span class="keywordflow">return</span> hRet;
02310 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a75" doxytag="clres.c::LoadBitmapW" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HBITMAP WINAPI LoadBitmapW           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HINSTANCE&nbsp;</td>
          <td class="mdname" nowrap> <em>hmod</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPCWSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>lpName</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l02312">2312</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
References <a class="el" href="../../d5/d8/clres_8c-source.html#l01899">LoadBmp()</a>.
<p>
<pre class="fragment"><div>02315 {
02316     <span class="keywordflow">return</span> <a class="code" href="../../d4/d9/clres_8c.html#a73">LoadBmp</a>(hmod, lpName, 0, 0, 0);
02317 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a73" doxytag="clres.c::LoadBmp" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HBITMAP LoadBmp           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HINSTANCE&nbsp;</td>
          <td class="mdname" nowrap> <em>hmod</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPCWSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>lpName</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>cxDesired</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>cyDesired</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>flags</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l01899">1899</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
References <a class="el" href="../../d0/d2/mngrayc_8c-source.html#l00029">BitBltSysBmp()</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l01680">Convert1BppToMonoBitmap()</a>, <a class="el" href="../../d9/d7/ntuser_2kernel_2clipbrd_8c-source.html#l01114">CreateScreenBitmap()</a>, <a class="el" href="../../d0/d1/rtl_2draw_8c-source.html#l00729">DrawFrameControl()</a>, <a class="el" href="../../d4/d7/client_8c-source.html#l01210">DrawIconEx()</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d0/d1/rtl_2draw_8c-source.html#l00061">FillRect()</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00908">FINDRESOURCEW</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00914">FREERESOURCE</a>, <a class="el" href="../../d2/d7/clglobal_8c-source.html#l00090">gcsHdc</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l01123">GETAPPVER</a>, <a class="el" href="../../d2/d7/clglobal_8c-source.html#l00101">ghdcBits2</a>, <a class="el" href="../../d2/d7/clglobal_8c-source.html#l00051">gpsi</a>, <a class="el" href="../../d2/d7/clglobal_8c-source.html#l00053">hmodUser</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00911">LOADRESOURCE</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00912">LOCKRESOURCE</a>, <a class="el" href="../../d4/d9/clres_8c.html#a14">MAX_BMPMAP</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l01738">MAX_RESOURCE_INDEX</a>, <a class="el" href="../../d0/d0/client_2nt6_2user_8h.html#a1077">MENU</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l00063">MR_FAILFOR40</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l00064">MR_MONOCHROME</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l09755">NtUserBitBltSysBmp()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00232">NUM_BUTTON_STATES</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00231">NUM_BUTTON_TYPES</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01031">OBI_CHECK</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01009">OBI_DNARROW</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01010">OBI_DNARROW_D</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01012">OBI_DNARROW_I</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01017">OBI_LFARROW</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01018">OBI_LFARROW_D</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01020">OBI_LFARROW_I</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01021">OBI_MENUARROW</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01022">OBI_MENUCHECK</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01004">OBI_NCGRIP</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01030">OBI_RADIOMASK</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00981">OBI_REDUCE_MBAR</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00982">OBI_REDUCE_MBAR_D</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00985">OBI_RESTORE_MBAR</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00986">OBI_RESTORE_MBAR_D</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01013">OBI_RGARROW</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01014">OBI_RGARROW_D</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01016">OBI_RGARROW_I</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01005">OBI_UPARROW</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01006">OBI_UPARROW_D</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01008">OBI_UPARROW_I</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00973">OBI_ZOOM</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00974">OBI_ZOOM_D</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l02847">ObjectFromDIBResource()</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l01730">OFFSET_120_DPI</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l01729">OFFSET_96_DPI</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00411">PTR_TO_ID</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l00023">RESCLR_BLACK</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l00024">RESCLR_WHITE</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00212">SYSHBR</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00202">SYSMET</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00913">UNLOCKRESOURCE</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00475">VER40</a>, and <a class="el" href="../../d7/d9/usercli_8h-source.html#l02070">WINDOW</a>.
<p>
Referenced by <a class="el" href="../../d5/d8/clres_8c-source.html#l02292">LoadBitmapA()</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l02312">LoadBitmapW()</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l02443">LoadImageW()</a>, and <a class="el" href="../../d5/d8/clres_8c-source.html#l04158">WOWLoadBitmapA()</a>.
<p>
<pre class="fragment"><div>01905 {
01906     HBITMAP hbmp = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01907     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    fFree = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01908     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    f1Bpp = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01909 
01910 <span class="comment">/***************************************************************************\</span>
01911 <span class="comment">* Bitmap Resource Table</span>
01912 <span class="comment">*</span>
01913 <span class="comment">* As of WIN4.0, most system bitmaps are rendered instead of grabbed from the</span>
01914 <span class="comment">* display driver.  However, a lot of apps, especially those that fake their</span>
01915 <span class="comment">* own MDI, do LoadBitmap(NULL, OBM_...) to grab a system bitmap.  So we</span>
01916 <span class="comment">* hook those requests here and copy our rendered bitmaps into a newly-</span>
01917 <span class="comment">* created bitmap.  Note that this is actually faster than loading from a</span>
01918 <span class="comment">* resource table!</span>
01919 <span class="comment">*</span>
01920 <span class="comment">* BOGUS -- give 'em old close buttons, not new cool X's</span>
01921 <span class="comment">*</span>
01922 <span class="comment">\***************************************************************************/</span>
01923 <span class="preprocessor">#define MAX_BMPMAP  32</span>
01924 <span class="preprocessor"></span>
01925     CONST <span class="keyword">static</span> <a class="code" href="../../d6/d0/structtagMAPRES.html">MAPRES</a> MapOemBmp[<a class="code" href="../../d4/d9/clres_8c.html#a14">MAX_BMPMAP</a>] = {
01926 
01927         {OBM_BTNCORNERS , <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a338">OBI_RADIOMASK</a>      ,               },
01928         {OBM_BTSIZE     , <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a312">OBI_NCGRIP</a>         ,               },
01929         {OBM_CHECK      , <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a330">OBI_MENUCHECK</a>      , <a class="code" href="../../d4/d9/clres_8c.html#a12">MR_MONOCHROME</a> },
01930         {OBM_CHECKBOXES , <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a339">OBI_CHECK</a>          ,               },
01931         {OBM_COMBO      , <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a317">OBI_DNARROW</a>        ,               },
01932         {OBM_DNARROW    , <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a317">OBI_DNARROW</a>        ,               },
01933         {OBM_DNARROWD   , <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a318">OBI_DNARROW_D</a>      ,               },
01934         {OBM_DNARROWI   , <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a320">OBI_DNARROW_I</a>      ,               },
01935         {OBM_LFARROW    , <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a325">OBI_LFARROW</a>        ,               },
01936         {OBM_LFARROWD   , <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a326">OBI_LFARROW_D</a>      ,               },
01937         {OBM_LFARROWI   , <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a328">OBI_LFARROW_I</a>      ,               },
01938 
01939         <span class="comment">/*</span>
01940 <span class="comment">         * Use MONO bitmaps in future once flat/mono controls are worked out.</span>
01941 <span class="comment">         */</span>
01942         {OBM_OLD_DNARROW, <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a317">OBI_DNARROW</a>        , <a class="code" href="../../d4/d9/clres_8c.html#a11">MR_FAILFOR40</a>  },
01943         {OBM_OLD_LFARROW, <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a325">OBI_LFARROW</a>        , <a class="code" href="../../d4/d9/clres_8c.html#a11">MR_FAILFOR40</a>  },
01944         {OBM_OLD_REDUCE , <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a289">OBI_REDUCE_MBAR</a>    , <a class="code" href="../../d4/d9/clres_8c.html#a11">MR_FAILFOR40</a>  },
01945         {OBM_OLD_RESTORE, <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a293">OBI_RESTORE_MBAR</a>   , <a class="code" href="../../d4/d9/clres_8c.html#a11">MR_FAILFOR40</a>  },
01946         {OBM_OLD_RGARROW, <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a321">OBI_RGARROW</a>        , <a class="code" href="../../d4/d9/clres_8c.html#a11">MR_FAILFOR40</a>  },
01947         {OBM_OLD_UPARROW, <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a313">OBI_UPARROW</a>        , <a class="code" href="../../d4/d9/clres_8c.html#a11">MR_FAILFOR40</a>  },
01948         {OBM_OLD_ZOOM   , <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a281">OBI_ZOOM</a>           , <a class="code" href="../../d4/d9/clres_8c.html#a11">MR_FAILFOR40</a>  },
01949 
01950         {OBM_MNARROW    , <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a329">OBI_MENUARROW</a>      , <a class="code" href="../../d4/d9/clres_8c.html#a12">MR_MONOCHROME</a> },
01951         {OBM_REDUCE     , <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a289">OBI_REDUCE_MBAR</a>    ,               },
01952         {OBM_REDUCED    , <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a290">OBI_REDUCE_MBAR_D</a>  ,               },
01953         {OBM_RESTORE    , <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a293">OBI_RESTORE_MBAR</a>   ,               },
01954         {OBM_RESTORED   , <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a294">OBI_RESTORE_MBAR_D</a> ,               },
01955         {OBM_RGARROW    , <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a321">OBI_RGARROW</a>        ,               },
01956         {OBM_RGARROWD   , <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a322">OBI_RGARROW_D</a>      ,               },
01957         {OBM_RGARROWI   , <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a324">OBI_RGARROW_I</a>      ,               },
01958         {OBM_SIZE       , <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a312">OBI_NCGRIP</a>         ,               },
01959         {OBM_UPARROW    , <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a313">OBI_UPARROW</a>        ,               },
01960         {OBM_UPARROWD   , <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a314">OBI_UPARROW_D</a>      ,               },
01961         {OBM_UPARROWI   , <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a316">OBI_UPARROW_I</a>      ,               },
01962         {OBM_ZOOM       , <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a281">OBI_ZOOM</a>           ,               },
01963         {OBM_ZOOMD      , <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a282">OBI_ZOOM_D</a>         ,               }
01964     };
01965 
01966 
01967     <span class="comment">/*</span>
01968 <span class="comment">     * If hmod is valid, load the client-side bits.</span>
01969 <span class="comment">     */</span>
01970     <span class="keywordflow">if</span> (hmod == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01971 
01972         HBITMAP hOldBmp;
01973         WORD    bm;
01974         WORD    wID;
01975         <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    fCombo;
01976         <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    fCheckBoxes;
01977         <span class="keywordtype">int</span>     i;
01978         RECT    rc;
01979         <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    fSysMenu = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01980         <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    fMenu = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01981         <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    fMono = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01982 
01983         hmod = <a class="code" href="../../d1/d8/clglobal_8c.html#a6">hmodUser</a>;
01984 
01985         <span class="comment">/*</span>
01986 <span class="comment">         * Since the resource is coming from USER32, we only</span>
01987 <span class="comment">         * deal with ID types.</span>
01988 <span class="comment">         */</span>
01989         wID = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a99">PTR_TO_ID</a>(lpName);
01990 
01991         <span class="keywordflow">switch</span>(wID) {
01992         <span class="keywordflow">case</span> OBM_OLD_CLOSE:
01993             <span class="keywordflow">if</span> (<a class="code" href="../../d6/d0/usercli_8h.html#a150">GETAPPVER</a>() &gt;= <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a101">VER40</a>)
01994                 <span class="keywordflow">goto</span> FailOldLoad;
01995 
01996             <span class="comment">/*</span>
01997 <span class="comment">             * fall through to the Close case.</span>
01998 <span class="comment">             */</span>
01999 
02000         <span class="keywordflow">case</span> OBM_CLOSE:
02001             <span class="comment">/* the new look for the system menu is to use the window's</span>
02002 <span class="comment">             * class icon -- but since here we don't know which window</span>
02003 <span class="comment">             * they'll be using this for, fall back on the good ole'</span>
02004 <span class="comment">             * windows logo icon</span>
02005 <span class="comment">             */</span>
02006             cxDesired = (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(CXMENUSIZE) + <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(CXEDGE)) * 2;
02007             cyDesired = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(CYMENUSIZE) + (2 * <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(CYEDGE));
02008             fSysMenu  = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
02009             <span class="keywordflow">break</span>;
02010 
02011         <span class="keywordflow">case</span> OBM_TRUETYPE: {
02012 
02013                 PVOID  p;
02014                 HANDLE h;
02015                 <span class="keywordtype">int</span>    nOffset;
02016 
02017                 <span class="comment">/*</span>
02018 <span class="comment">                 * Offset into resource.</span>
02019 <span class="comment">                 */</span>
02020                 <span class="keywordflow">if</span> (<a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;dmLogPixels == 120) {
02021                     nOffset = <a class="code" href="../../d6/d0/usercli_8h.html#a245">OFFSET_120_DPI</a>;
02022                 } <span class="keywordflow">else</span> {
02023                     nOffset = <a class="code" href="../../d6/d0/usercli_8h.html#a244">OFFSET_96_DPI</a>;
02024                 }
02025 
02026                 lpName = (LPWSTR)(<a class="code" href="../../d6/d0/usercli_8h.html#a247">MAX_RESOURCE_INDEX</a> -
02027                         ((ULONG_PTR)lpName) + nOffset);
02028 
02029                 <span class="keywordflow">if</span> (h = <a class="code" href="../../d6/d0/usercli_8h.html#a126">FINDRESOURCEW</a>(hmod, (LPWSTR)lpName, RT_BITMAP)) {
02030 
02031                     <span class="keywordflow">if</span> (h = <a class="code" href="../../d6/d0/usercli_8h.html#a129">LOADRESOURCE</a>(hmod, h)) {
02032 
02033                         <span class="keywordflow">if</span> (p = <a class="code" href="../../d6/d0/usercli_8h.html#a130">LOCKRESOURCE</a>(h, hmod)) {
02034 
02035 
02036                             hbmp = (HBITMAP)<a class="code" href="../../d6/d0/usercli_8h.html#a656">ObjectFromDIBResource</a>(hmod,
02037                                                                   lpName,
02038                                                                   RT_BITMAP,
02039                                                                   cxDesired,
02040                                                                   cyDesired,
02041                                                                   flags);
02042 
02043                             <a class="code" href="../../d6/d0/usercli_8h.html#a131">UNLOCKRESOURCE</a>(h, hmod);
02044                         }
02045 
02046                         <a class="code" href="../../d6/d0/usercli_8h.html#a132">FREERESOURCE</a>(h, hmod);
02047                     }
02048                 }
02049 
02050                 <span class="keywordflow">goto</span> LoadBmpDone;
02051             }
02052             <span class="keywordflow">break</span>;
02053 
02054         <span class="keywordflow">default</span>:
02055             fCombo      = (wID == OBM_COMBO);
02056             fCheckBoxes = (wID == OBM_CHECKBOXES);
02057 
02058             <span class="comment">/*</span>
02059 <span class="comment">             * hard loop to check for mapping.</span>
02060 <span class="comment">             */</span>
02061             <span class="keywordflow">for</span> (i=0; (i &lt; <a class="code" href="../../d4/d9/clres_8c.html#a14">MAX_BMPMAP</a>) &amp;&amp; (MapOemBmp[i].idDisp != wID); i++);
02062 
02063             <span class="keywordflow">if</span> (i == <a class="code" href="../../d4/d9/clres_8c.html#a14">MAX_BMPMAP</a>)
02064                 <span class="keywordflow">goto</span> LoadForReal;
02065 
02066             <span class="keywordflow">if</span> ((MapOemBmp[i].bFlags &amp; <a class="code" href="../../d4/d9/clres_8c.html#a11">MR_FAILFOR40</a>) &amp;&amp;
02067                     (<a class="code" href="../../d6/d0/usercli_8h.html#a150">GETAPPVER</a>() &gt;= <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a101">VER40</a>)) {
02068 
02069 FailOldLoad:
02070                 RIPMSG0(RIP_WARNING, <span class="stringliteral">"LoadBitmap: old IDs not allowed for 4.0 apps"</span>);
02071                 <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
02072             }
02073 
02074             <span class="keywordflow">if</span> (MapOemBmp[i].bFlags &amp; <a class="code" href="../../d4/d9/clres_8c.html#a12">MR_MONOCHROME</a>)
02075                 fMono = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
02076 
02077             bm = MapOemBmp[i].idUser;
02078 
02079             <span class="keywordflow">if</span> ((bm == <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a289">OBI_REDUCE_MBAR</a>) || (bm == <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a293">OBI_RESTORE_MBAR</a>))
02080                 fMenu = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
02081 
02082             cxDesired = <a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;oembmi[bm].cx;
02083             cyDesired = <a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;oembmi[bm].cy;
02084 
02085             <span class="keywordflow">if</span> (fMenu)
02086                 cyDesired += (2 * <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(CYEDGE));
02087 
02088             <span class="keywordflow">if</span> (fCheckBoxes) {
02089                 cxDesired *= <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a31">NUM_BUTTON_STATES</a>;
02090                 cyDesired *= <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a30">NUM_BUTTON_TYPES</a>;
02091             } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (fCombo) {
02092                 cxDesired -= (2 * <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(CXEDGE));
02093                 cyDesired -= (2 * <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(CYEDGE));
02094             }
02095             <span class="keywordflow">break</span>;
02096         }
02097 
02098         <span class="comment">/*</span>
02099 <span class="comment">         * Creates DIB section or color compatible.</span>
02100 <span class="comment">         */</span>
02101         <span class="keywordflow">if</span> (fMono) {
02102 
02103             <span class="comment">/*</span>
02104 <span class="comment">             * Create mono-bitmaps as DIBs on NT.  On Win95 this is</span>
02105 <span class="comment">             * called as:</span>
02106 <span class="comment">             *</span>
02107 <span class="comment">             *   hbmp = CreateBitmap(cxDesired, cyDesired, 1, 1, NULL);</span>
02108 <span class="comment">             *</span>
02109 <span class="comment">             * However, due to color-matching differences, we need to</span>
02110 <span class="comment">             * use dibs to get the nearest-color-matching.  At the</span>
02111 <span class="comment">             * end of this routine we will convert to a true-mono so that</span>
02112 <span class="comment">             * foreground/background matching can be performed normally.</span>
02113 <span class="comment">             */</span>
02114             hbmp = <a class="code" href="../../d8/d8/ntuser_2kernel_2clipbrd_8c.html#a28">CreateScreenBitmap</a>(cxDesired, cyDesired, 1, 1, NULL, &amp;f1Bpp);
02115 
02116         } <span class="keywordflow">else</span> {
02117 
02118             hbmp = <a class="code" href="../../d8/d8/ntuser_2kernel_2clipbrd_8c.html#a28">CreateScreenBitmap</a>(cxDesired, cyDesired, 0, 0, NULL, &amp;f1Bpp);
02119         }
02120 
02121         <span class="keywordflow">if</span> (hbmp == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
02122             <span class="keywordflow">goto</span> LoadBmpDone;
02123 
02124         RtlEnterCriticalSection(&amp;gcsHdc);
02125         hOldBmp = SelectBitmap(ghdcBits2, hbmp);
02126         UserAssert(GetBkColor(ghdcBits2) == RGB(255,255,255));
02127         UserAssert(GetTextColor(ghdcBits2) == RGB(0, 0, 0));
02128 
02129         rc.top    = 0;
02130         rc.left   = 0;
02131         rc.bottom = cyDesired;
02132         rc.right  = cxDesired;
02133 
02134         <span class="keywordflow">if</span> (fMono) {
02135             PatBlt(ghdcBits2, 0, 0, cxDesired, cyDesired, WHITENESS);
02136         } <span class="keywordflow">else</span> {
02137             <a class="code" href="../../d9/d1/rtl_2draw_8c.html#a3">FillRect</a>(ghdcBits2,
02138                      &amp;rc,
02139                      ((fMenu | fSysMenu) ? <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a22">SYSHBR</a>(<a class="code" href="../../d1/d1/structtagMENU.html">MENU</a>) : <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a22">SYSHBR</a>(WINDOW)));
02140         }
02141 
02142         <span class="keywordflow">if</span> (fSysMenu) {
02143             <span class="keywordtype">int</span> x = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(CXEDGE);
02144             <span class="keywordtype">int</span> i;
02145 
02146             cxDesired /= 2;
02147 
02148             <span class="keywordflow">for</span> (i=0; i &lt; 2; i++) {
02149 
02150                 <a class="code" href="../../d3/d8/client_8c.html#a50">DrawIconEx</a>(ghdcBits2,
02151                            x,
02152                            <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(CYEDGE),
02153                            <a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;hIconSmWindows,
02154                            cxDesired - 2 * <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(CXEDGE),
02155                            <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(CYMENUSIZE) - <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(CYEDGE),
02156                            0,
02157                            NULL,
02158                            DI_NORMAL);
02159 
02160                 x += cxDesired;
02161             }
02162 
02163         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (fCombo) {
02164 
02165             <span class="comment">/*</span>
02166 <span class="comment">             * Revisit when we start using TTF -- that'll take care of</span>
02167 <span class="comment">             * this hack.</span>
02168 <span class="comment">             */</span>
02169             rc.top     = -<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(CYEDGE);
02170             rc.bottom +=  <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(CYEDGE);
02171             rc.left    = -<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(CXEDGE);
02172             rc.right  +=  <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(CXEDGE);
02173 
02174             <a class="code" href="../../d9/d1/rtl_2draw_8c.html#a14">DrawFrameControl</a>(ghdcBits2,
02175                              &amp;rc,
02176                              DFC_SCROLL,
02177                              DFCS_SCROLLDOWN);
02178 
02179         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (fCheckBoxes) {
02180 
02181             <span class="keywordtype">int</span>   wType;
02182             <span class="keywordtype">int</span>   wState;
02183             <span class="keywordtype">int</span>   x;
02184             <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> clrTextSave;
02185             <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> clrBkSave;
02186             <span class="keywordtype">int</span>   y = 0;
02187 
02188             <span class="keywordflow">for</span> (wType=0; wType &lt; <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a30">NUM_BUTTON_TYPES</a>; wType++) {
02189 
02190                 x = 0;
02191 
02192                 cxDesired = <a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;oembmi[bm].cx;
02193                 cyDesired = <a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;oembmi[bm].cy;
02194 
02195                 <span class="keywordflow">if</span> (wType == 1) {
02196 
02197                     <span class="comment">/*</span>
02198 <span class="comment">                     * BOGUS UGLINESS -- will be fixed once the Graphics dudes</span>
02199 <span class="comment">                     * get me the icon TTF -- I'll revisit this then and make</span>
02200 <span class="comment">                     * REAL</span>
02201 <span class="comment">                     */</span>
02202                     clrTextSave = SetTextColor(ghdcBits2, RESCLR_BLACK);
02203                     clrBkSave   = SetBkColor  (ghdcBits2, RESCLR_WHITE);
02204 
02205                     <span class="keywordflow">for</span> (wState = 0; wState &lt; <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a31">NUM_BUTTON_STATES</a>; wState++) {
02206 
02207                         <a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a330">NtUserBitBltSysBmp</a>(ghdcBits2,
02208                                            x,
02209                                            y,
02210                                            cxDesired,
02211                                            cyDesired,
02212                                            <a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;oembmi[OBI_RADIOMASK].x,
02213                                            <a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;oembmi[OBI_RADIOMASK].y,
02214                                            SRCAND);
02215 
02216                         <a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a330">NtUserBitBltSysBmp</a>(ghdcBits2,
02217                                            x,
02218                                            y,
02219                                            cxDesired,
02220                                            cyDesired,
02221                                            <a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;oembmi[bm].x,
02222                                            <a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;oembmi[bm].y,
02223                                            SRCINVERT);
02224                         x += cxDesired;
02225                         bm++;
02226                     }
02227 
02228                     SetTextColor(ghdcBits2, clrTextSave);
02229                     SetBkColor(ghdcBits2, clrBkSave);
02230 
02231                 } <span class="keywordflow">else</span> {
02232 
02233                     <span class="keywordflow">for</span> (wState=0; wState &lt; <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a31">NUM_BUTTON_STATES</a>; wState++) {
02234 
02235                         <a class="code" href="../../d4/d1/userk_8h.html#a1773">BitBltSysBmp</a>(ghdcBits2, x, y, bm);
02236                         x += cxDesired;
02237                         bm++;
02238                     }
02239 
02240                     <span class="comment">/*</span>
02241 <span class="comment">                     * Skip OBI_*_CDI.</span>
02242 <span class="comment">                     */</span>
02243                     bm++;
02244                 }
02245 
02246                 y += cyDesired;
02247             }
02248 
02249         } <span class="keywordflow">else</span> {
02250 
02251             <a class="code" href="../../d4/d1/userk_8h.html#a1773">BitBltSysBmp</a>(ghdcBits2, 0, fMenu ? <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(CYEDGE) : 0, bm);
02252         }
02253 
02254         SelectBitmap(ghdcBits2, hOldBmp);
02255 
02256         <span class="comment">/*</span>
02257 <span class="comment">         * If the bitmap was created as a 1bpp, we need to convert to a</span>
02258 <span class="comment">         * true mono-bitmap.  GDI performs different color-matching depending</span>
02259 <span class="comment">         * upon this case.</span>
02260 <span class="comment">         */</span>
02261         <span class="keywordflow">if</span> (f1Bpp &amp;&amp; hbmp)
02262             hbmp = <a class="code" href="../../d4/d9/clres_8c.html#a71">Convert1BppToMonoBitmap</a>(ghdcBits2, hbmp);
02263 
02264         RtlLeaveCriticalSection(&amp;gcsHdc);
02265 
02266     } <span class="keywordflow">else</span> {
02267 
02268 LoadForReal:
02269 
02270         hbmp = (HBITMAP)<a class="code" href="../../d6/d0/usercli_8h.html#a656">ObjectFromDIBResource</a>(hmod,
02271                                               lpName,
02272                                               RT_BITMAP,
02273                                               cxDesired,
02274                                               cyDesired,
02275                                               flags);
02276     }
02277 
02278 LoadBmpDone:
02279 
02280     <span class="keywordflow">return</span> hbmp;
02281 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a76" doxytag="clres.c::LoadCursorA" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HCURSOR WINAPI LoadCursorA           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HINSTANCE&nbsp;</td>
          <td class="mdname" nowrap> <em>hmod</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPCSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>lpName</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l02329">2329</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
References <a class="el" href="../../d5/d8/smbtrsup_8c-source.html#l00151">ID</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l02349">LoadCursorW()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, and <a class="el" href="../../d7/d9/usercli_8h-source.html#l00960">UserLocalFree</a>.
<p>
<pre class="fragment"><div>02332 {
02333     HCURSOR hRet;
02334     LPWSTR  lpUniName;
02335 
02336     <span class="keywordflow">if</span> (<a class="code" href="../../d4/d9/smbtrsup_8c.html#a7">ID</a>(lpName))
02337         <span class="keywordflow">return</span> <a class="code" href="../../d4/d9/clres_8c.html#a77">LoadCursorW</a>(hmod, (LPWSTR)lpName);
02338 
02339     <span class="keywordflow">if</span> (!MBToWCS(lpName, -1, &amp;lpUniName, -1, TRUE))
02340         <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
02341 
02342     hRet = <a class="code" href="../../d4/d9/clres_8c.html#a77">LoadCursorW</a>(hmod, lpUniName);
02343 
02344     <a class="code" href="../../d6/d0/usercli_8h.html#a138">UserLocalFree</a>(lpUniName);
02345 
02346     <span class="keywordflow">return</span> hRet;
02347 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a68" doxytag="clres.c::LoadCursorIconFromResource" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HANDLE LoadCursorIconFromResource           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>presbits</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPCWSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>lpName</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>cxDesired</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>cyDesired</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>LR_flags</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l01573">1573</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d6/d0/usercli_8h.html#a380">FILEINFO</a>, <a class="el" href="../../d4/d3/client_2acons_8c-source.html#l00279">LoadCursorIconFromFileMap()</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l01635">_FILEINFO::pFileEnd</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l01633">_FILEINFO::pFileMap</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l01634">_FILEINFO::pFilePtr</a>, and <a class="el" href="../../d7/d9/usercli_8h-source.html#l01636">_FILEINFO::pszName</a>.
<p>
Referenced by <a class="el" href="../../d5/d8/clres_8c-source.html#l01627">CreateIconFromResourceEx()</a>, and <a class="el" href="../../d5/d8/clres_8c-source.html#l02847">ObjectFromDIBResource()</a>.
<p>
<pre class="fragment"><div>01579 {
01580     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>     fAni;
01581     <a class="code" href="../../d1/d2/struct__FILEINFO.html">FILEINFO</a> fi;
01582     LPWSTR   lpwszRT;
01583 
01584     fi.<a class="code" href="../../d1/d2/struct__FILEINFO.html#o0">pFileMap</a> = presbits;
01585     fi.<a class="code" href="../../d1/d2/struct__FILEINFO.html#o1">pFilePtr</a> = fi.<a class="code" href="../../d1/d2/struct__FILEINFO.html#o0">pFileMap</a>;
01586     fi.<a class="code" href="../../d1/d2/struct__FILEINFO.html#o2">pFileEnd</a> = fi.<a class="code" href="../../d1/d2/struct__FILEINFO.html#o0">pFileMap</a> + <span class="keyword">sizeof</span> (RTAG) + ((RTAG *)presbits)-&gt;ckSize;
01587     fi.<a class="code" href="../../d1/d2/struct__FILEINFO.html#o3">pszName</a>  = lpName;
01588 
01589     <span class="keywordflow">return</span> <a class="code" href="../../d6/d0/usercli_8h.html#a651">LoadCursorIconFromFileMap</a>(&amp;fi,
01590                                      &amp;lpwszRT,
01591                                      cxDesired,
01592                                      cyDesired,
01593                                      LR_flags,
01594                                      &amp;fAni);
01595 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a77" doxytag="clres.c::LoadCursorW" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HCURSOR WINAPI LoadCursorW           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HINSTANCE&nbsp;</td>
          <td class="mdname" nowrap> <em>hmod</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPCWSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>lpName</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l02349">2349</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
References <a class="el" href="../../d5/d8/clres_8c-source.html#l02657">LoadIcoCur()</a>.
<p>
Referenced by <a class="el" href="../../d5/d8/clres_8c-source.html#l02329">LoadCursorA()</a>.
<p>
<pre class="fragment"><div>02352 {
02353 
02354     <span class="keywordflow">return</span> <a class="code" href="../../d6/d0/usercli_8h.html#a655">LoadIcoCur</a>(hmod,
02355                       lpName,
02356                       RT_CURSOR,
02357                       0,
02358                       0,
02359                       LR_DEFAULTSIZE | LR_SHARED);
02360 
02361 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a83" doxytag="clres.c::LoadDIB" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HANDLE LoadDIB           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HINSTANCE&nbsp;</td>
          <td class="mdname" nowrap> <em>hmod</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPCWSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>lpName</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPWSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>type</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>cxDesired</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>cyDesired</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>LR_flags</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l02544">2544</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
References <a class="el" href="../../d7/d9/usercli_8h-source.html#l00908">FINDRESOURCEW</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l02502">GetIconIdEx()</a>, <a class="el" href="../../d2/d7/clglobal_8c-source.html#l00053">hmodUser</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00911">LOADRESOURCE</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00411">PTR_TO_ID</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l00088">SplFindResource()</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l00105">SplFreeResource()</a>, <a class="el" href="../../d4/d4/i386_2trapc_8c-source.html#l00076">type</a>, and <a class="el" href="../../d0/d5/ndismain_8h-source.html#l00026">UINT</a>.
<p>
Referenced by <a class="el" href="../../d5/d8/clres_8c-source.html#l02847">ObjectFromDIBResource()</a>.
<p>
<pre class="fragment"><div>02551 {
02552     HANDLE  hDir;
02553     <a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a>    idIcon;
02554     LPWSTR  lpszGroupType;
02555     HANDLE  hRes = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
02556 
02557     <span class="keywordflow">switch</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a99">PTR_TO_ID</a>(type)) {
02558 
02559     <span class="keywordflow">case</span> <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a99">PTR_TO_ID</a>(RT_ICON):
02560     case <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a99">PTR_TO_ID</a>(RT_CURSOR):
02561 
02562         lpszGroupType = RT_GROUP_CURSOR + (<a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> - RT_CURSOR);
02563 
02564         <span class="comment">/*</span>
02565 <span class="comment">         * For WOW support, OIC_ICON and OIC_SIZE need to be supported.</span>
02566 <span class="comment">         * Since these resources match other existing resources, we map</span>
02567 <span class="comment">         * them here so we produce results that emulates</span>
02568 <span class="comment">         * behavor as if we had the actual resources in USER.</span>
02569 <span class="comment">         *</span>
02570 <span class="comment">         * Note that obsolete mapping of lpName in LoadIcoCur prevents</span>
02571 <span class="comment">         * win4.0 apps from getting here.</span>
02572 <span class="comment">         */</span>
02573         <span class="keywordflow">if</span> (hmod == <a class="code" href="../../d1/d8/clglobal_8c.html#a6">hmodUser</a>) {
02574 
02575             <span class="keywordflow">switch</span> ((ULONG_PTR)lpName) {
02576             <span class="keywordflow">case</span> OCR_SIZE:
02577                 lpName = (LPCWSTR)OCR_SIZEALL_DEFAULT;
02578                 <span class="keywordflow">break</span>;
02579 
02580             <span class="keywordflow">case</span> OCR_ICON:
02581                 lpName = (LPCWSTR)OCR_ICON_DEFAULT;
02582                 <span class="keywordflow">break</span>;
02583             }
02584         }
02585         <span class="comment">/*</span>
02586 <span class="comment">         * The resource is actually a directory which contains multiple</span>
02587 <span class="comment">         * individual image resources we must choose from.</span>
02588 <span class="comment">         * Locate the directory</span>
02589 <span class="comment">         */</span>
02590         <span class="keywordflow">if</span> (hDir = <a class="code" href="../../d4/d9/clres_8c.html#a29">SplFindResource</a>(hmod, lpName, (LPCWSTR)lpszGroupType)) {
02591 
02592             <span class="comment">/*</span>
02593 <span class="comment">             * Load the directory.</span>
02594 <span class="comment">             */</span>
02595             <span class="keywordflow">if</span> (hDir = <a class="code" href="../../d6/d0/usercli_8h.html#a129">LOADRESOURCE</a>(hmod, hDir)) {
02596 
02597                 <span class="comment">/*</span>
02598 <span class="comment">                 * Get the name of the best individual image.</span>
02599 <span class="comment">                 */</span>
02600                 <span class="keywordflow">if</span> (idIcon = <a class="code" href="../../d4/d9/clres_8c.html#a82">GetIconIdEx</a>(hmod,
02601                                          hDir,
02602                                          type,
02603                                          cxDesired,
02604                                          cyDesired,
02605                                          LR_flags)) {
02606 
02607                     <span class="comment">/*</span>
02608 <span class="comment">                     * NOTE: Don't free the directory resource!!! - ChipA.</span>
02609 <span class="comment">                     * We can't call SplFindResource here, because idIcon</span>
02610 <span class="comment">                     * is internal to us and GetDriverResourceId()</span>
02611 <span class="comment">                     * doesn't know how to map it.</span>
02612 <span class="comment">                     */</span>
02613                     hRes = <a class="code" href="../../d6/d0/usercli_8h.html#a126">FINDRESOURCEW</a>(hmod, MAKEINTRESOURCE(idIcon), type);
02614                 }
02615 
02616                 <span class="comment">/*</span>
02617 <span class="comment">                 * BOGUS:</span>
02618 <span class="comment">                 * It would be very cool if we could loop through all the</span>
02619 <span class="comment">                 * items in the directory and free 'em too.  Free the ones</span>
02620 <span class="comment">                 * except for the one we're about to load, that is.</span>
02621 <span class="comment">                 *</span>
02622 <span class="comment">                 * Free directory resources TWICE so they get really freed.</span>
02623 <span class="comment">                 */</span>
02624                 <a class="code" href="../../d4/d9/clres_8c.html#a30">SplFreeResource</a>(hDir, hmod, LR_flags);
02625             }
02626         } <span class="keywordflow">else</span> {
02627             <span class="comment">/*</span>
02628 <span class="comment">             * Failed to load a regular icon\cursor.</span>
02629 <span class="comment">             * Try to load an animated icon/cursor with the same name</span>
02630 <span class="comment">             */</span>
02631             hRes = <a class="code" href="../../d4/d9/clres_8c.html#a29">SplFindResource</a>(hmod, lpName,
02632                     <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a99">PTR_TO_ID</a>(type) == <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a99">PTR_TO_ID</a>(RT_CURSOR) ? RT_ANICURSOR : RT_ANIICON);
02633         }
02634         <span class="keywordflow">break</span>;
02635 
02636     <span class="keywordflow">case</span> <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a99">PTR_TO_ID</a>(RT_BITMAP):
02637         hRes = <a class="code" href="../../d4/d9/clres_8c.html#a29">SplFindResource</a>(hmod, lpName, RT_BITMAP);
02638         <span class="keywordflow">break</span>;
02639 
02640     <span class="keywordflow">default</span>:
02641         RIPMSG0(RIP_WARNING, <span class="stringliteral">"LoadDIB: Invalid resource type"</span>);
02642         <span class="keywordflow">break</span>;
02643     }
02644 
02645     <span class="keywordflow">if</span> (hRes)
02646         hRes = <a class="code" href="../../d6/d0/usercli_8h.html#a129">LOADRESOURCE</a>(hmod, hRes);
02647 
02648     <span class="keywordflow">return</span> hRes;
02649 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a84" doxytag="clres.c::LoadIcoCur" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HICON LoadIcoCur           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HINSTANCE&nbsp;</td>
          <td class="mdname" nowrap> <em>hmod</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPCWSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>pszResName</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPWSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>type</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>cxDesired</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>cyDesired</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>LR_flags</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l02657">2657</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
References <a class="el" href="../../d5/d8/clres_8c-source.html#l00070">tagMAPRES::bFlags</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l02338">tagCURSORFIND::bpp</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l03173">ConnectIfNecessary</a>, <a class="el" href="../../d0/d0/client_2nt6_2user_8h.html#a1072">CURSORFIND</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l02336">tagCURSORFIND::cx</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l02337">tagCURSORFIND::cy</a>, <a class="el" href="../../d9/d8/client_2ntstubs_8c-source.html#l01102">FindExistingCursorIcon()</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l01123">GETAPPVER</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l04096">GetIcoCurBpp()</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l04074">GetIcoCurHeight()</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l04052">GetIcoCurWidth()</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02209">tagCURSORFIND::hcur</a>, <a class="el" href="../../d2/d7/clglobal_8c-source.html#l00053">hmodUser</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l00068">tagMAPRES::idDisp</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l00069">tagMAPRES::idUser</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00410">IS_PTR</a>, <a class="el" href="../../d4/d9/clres_8c.html#a26">LPMAPRES</a>, <a class="el" href="../../d4/d8/arcinst_8c-source.html#l00065">MAX_PATH</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l00063">MR_FAILFOR40</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l02847">ObjectFromDIBResource()</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00411">PTR_TO_ID</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l02335">tagCURSORFIND::rt</a>, <a class="el" href="../../d2/d7/clglobal_8c-source.html#l00063">szUSER32</a>, <a class="el" href="../../d4/d4/i386_2trapc_8c-source.html#l00076">type</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00475">VER40</a>, and <a class="el" href="../../d5/d8/clres_8c-source.html#l00128">WowGetModuleFileName()</a>.
<p>
Referenced by <a class="el" href="../../d5/d8/clres_8c-source.html#l04436">CopyImageFromRes()</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l01465">GetCursorFrameInfo()</a>, <a class="el" href="../../d7/d7/clinit_8c-source.html#l00307">LoadCursorsAndIcons()</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l02349">LoadCursorW()</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l02393">LoadIconW()</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l02443">LoadImageW()</a>, <a class="el" href="../../d9/d8/client_2ntstubs_8c-source.html#l01078">SetSystemCursor()</a>, and <a class="el" href="../../d5/d8/clres_8c-source.html#l04200">WowServerLoadCreateCursorIcon()</a>.
<p>
<pre class="fragment"><div>02664 {
02665     HICON     hico;
02666     LPWSTR    pszModName;
02667     WCHAR     achModName[<a class="code" href="../../d3/d9/arcinst_8c.html#a6">MAX_PATH</a>];
02668 
02669     <a class="code" href="../../d1/d0/inc_2user_8h.html#a848">ConnectIfNecessary</a>();
02670 
02671     <span class="comment">/*</span>
02672 <span class="comment">     * Setup module name and handles for lookup.</span>
02673 <span class="comment">     */</span>
02674     <span class="keywordflow">if</span> (hmod == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)  {
02675 
02676         hmod = <a class="code" href="../../d1/d8/clglobal_8c.html#a6">hmodUser</a>;
02677         pszModName = <a class="code" href="../../d1/d8/clglobal_8c.html#a12">szUSER32</a>;
02678 
02679     } <span class="keywordflow">else</span> {
02680 
02681         <a class="code" href="../../d6/d0/usercli_8h.html#a647">WowGetModuleFileName</a>(hmod,
02682                              achModName,
02683                              <span class="keyword">sizeof</span>(achModName) / <span class="keyword">sizeof</span>(WCHAR));
02684 
02685         pszModName = achModName;
02686     }
02687 
02688     <span class="keywordflow">if</span> (LR_flags &amp; LR_CREATEDIBSECTION)
02689         LR_flags = (LR_flags &amp; ~LR_CREATEDIBSECTION) | LR_CREATEREALDIB;
02690 
02691     <span class="comment">/*</span>
02692 <span class="comment">     * Setup defaults.</span>
02693 <span class="comment">     */</span>
02694     <span class="keywordflow">if</span> ((hmod == <a class="code" href="../../d1/d8/clglobal_8c.html#a6">hmodUser</a>) &amp;&amp; !<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a98">IS_PTR</a>(pszResName)) {
02695 
02696         <span class="keywordtype">int</span>      imapMax;
02697         <a class="code" href="../../d6/d0/structtagMAPRES.html">LPMAPRES</a> lpMapRes;
02698 
02699         <span class="comment">/*</span>
02700 <span class="comment">         * Map some old OEM IDs for people.</span>
02701 <span class="comment">         */</span>
02702         <span class="keywordflow">if</span> (<a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> == RT_ICON) {
02703 
02704             <span class="keyword">static</span> <a class="code" href="../../d6/d0/structtagMAPRES.html">MAPRES</a> MapOemOic[] = {
02705                 {OCR_ICOCUR, OIC_WINLOGO, <a class="code" href="../../d4/d9/clres_8c.html#a11">MR_FAILFOR40</a>}
02706             };
02707 
02708             lpMapRes = MapOemOic;
02709             imapMax  = 1;
02710 
02711         } <span class="keywordflow">else</span> {
02712 
02713             <span class="keyword">static</span> <a class="code" href="../../d6/d0/structtagMAPRES.html">MAPRES</a> MapOemOcr[] = {
02714                 {OCR_ICON, OCR_ICON, <a class="code" href="../../d4/d9/clres_8c.html#a11">MR_FAILFOR40</a>},
02715                 {OCR_SIZE, OCR_SIZE, <a class="code" href="../../d4/d9/clres_8c.html#a11">MR_FAILFOR40</a>}
02716             };
02717 
02718             lpMapRes = MapOemOcr;
02719             imapMax  = 2;
02720         }
02721 
02722         <span class="keywordflow">while</span> (--imapMax &gt;= 0) {
02723 
02724             <span class="keywordflow">if</span> (lpMapRes-&gt;<a class="code" href="../../d6/d0/structtagMAPRES.html#o0">idDisp</a> == <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a99">PTR_TO_ID</a>(pszResName)) {
02725 
02726                 <span class="keywordflow">if</span> ((lpMapRes-&gt;<a class="code" href="../../d6/d0/structtagMAPRES.html#o2">bFlags</a> &amp; <a class="code" href="../../d4/d9/clres_8c.html#a11">MR_FAILFOR40</a>) &amp;&amp;
02727                     <a class="code" href="../../d6/d0/usercli_8h.html#a150">GETAPPVER</a>() &gt;= <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a101">VER40</a>) {
02728 
02729                     RIPMSG1(RIP_WARNING,
02730                           <span class="stringliteral">"LoadIcoCur: Old ID 0x%x not allowed for 4.0 apps"</span>,
02731                           <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a99">PTR_TO_ID</a>(pszResName));
02732 
02733                     <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
02734                 }
02735 
02736                 pszResName = MAKEINTRESOURCE(lpMapRes-&gt;<a class="code" href="../../d6/d0/structtagMAPRES.html#o1">idUser</a>);
02737                 <span class="keywordflow">break</span>;
02738             }
02739 
02740             ++lpMapRes;
02741         }
02742     }
02743 
02744     <span class="comment">/*</span>
02745 <span class="comment">     * Determine size of requested object.</span>
02746 <span class="comment">     */</span>
02747     cxDesired = <a class="code" href="../../d6/d0/usercli_8h.html#a652">GetIcoCurWidth</a>(cxDesired , (type == RT_ICON), LR_flags, 0);
02748     cyDesired = <a class="code" href="../../d6/d0/usercli_8h.html#a653">GetIcoCurHeight</a>(cyDesired, (type == RT_ICON), LR_flags, 0);
02749 
02750     <span class="comment">/*</span>
02751 <span class="comment">     * See if this is a cached icon/cursor, and grab it if we have one</span>
02752 <span class="comment">     * already.</span>
02753 <span class="comment">     */</span>
02754     <span class="keywordflow">if</span> (LR_flags &amp; LR_SHARED) {
02755 
02756         <a class="code" href="../../d9/d1/structtagCURSORFIND.html">CURSORFIND</a> cfSearch;
02757 
02758         <span class="comment">/*</span>
02759 <span class="comment">         * Note that win95 fails to load any USER resources unless</span>
02760 <span class="comment">         * LR_SHARED is specified - so we do too.  Also, win95 will</span>
02761 <span class="comment">         * ignore your cx, cy and LR_flag parameters and just give</span>
02762 <span class="comment">         * you whats in the cache so we do too.</span>
02763 <span class="comment">         * A shame but thats life...</span>
02764 <span class="comment">         *</span>
02765 <span class="comment">         * Setup search criteria.  Since this is a load, we will have</span>
02766 <span class="comment">         * no source-cursor to lookup.  Find something respectable.</span>
02767 <span class="comment">         */</span>
02768         cfSearch.<a class="code" href="../../d9/d1/structtagCURSORFIND.html#o0">hcur</a> = (HCURSOR)<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
02769         cfSearch.<a class="code" href="../../d9/d1/structtagCURSORFIND.html#o1">rt</a>   = PtrToUlong(type);
02770 
02771         <span class="keywordflow">if</span> (hmod == <a class="code" href="../../d1/d8/clglobal_8c.html#a6">hmodUser</a>) {
02772 
02773             cfSearch.<a class="code" href="../../d9/d1/structtagCURSORFIND.html#o2">cx</a>  = 0;
02774             cfSearch.<a class="code" href="../../d9/d1/structtagCURSORFIND.html#o3">cy</a>  = 0;
02775             cfSearch.<a class="code" href="../../d9/d1/structtagCURSORFIND.html#o4">bpp</a> = 0;
02776 
02777         } <span class="keywordflow">else</span> {
02778 
02779             cfSearch.<a class="code" href="../../d9/d1/structtagCURSORFIND.html#o2">cx</a>  = cxDesired;
02780             cfSearch.<a class="code" href="../../d9/d1/structtagCURSORFIND.html#o3">cy</a>  = cyDesired;
02781 
02782 <span class="comment">/*</span>
02783 <span class="comment"> * On NT we have a more strict cache-lookup.  By passing in (zero), we</span>
02784 <span class="comment"> * will tell the cache-lookup to ignore the bpp.  This fixes a problem</span>
02785 <span class="comment"> * in Crayola Art Studio where the coloring-book cursor was being created</span>
02786 <span class="comment"> * as an invisible cursor.  This lookup is compatible with Win95.</span>
02787 <span class="comment"> */</span>
02788 <span class="preprocessor">#if 0</span>
02789 <span class="preprocessor"></span>            cfSearch.<a class="code" href="../../d9/d1/structtagCURSORFIND.html#o4">bpp</a> = <a class="code" href="../../d6/d0/usercli_8h.html#a654">GetIcoCurBpp</a>(LR_flags);
02790 <span class="preprocessor">#else</span>
02791 <span class="preprocessor"></span>            cfSearch.<a class="code" href="../../d9/d1/structtagCURSORFIND.html#o4">bpp</a> = 0;
02792 <span class="preprocessor">#endif</span>
02793 <span class="preprocessor"></span>        }
02794 
02795         hico = <a class="code" href="../../d6/d0/usercli_8h.html#a627">FindExistingCursorIcon</a>(pszModName, pszResName, &amp;cfSearch);
02796 
02797         <span class="keywordflow">if</span> (hico != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
02798             <span class="keywordflow">goto</span> IcoCurFound;
02799     }
02800 
02801 <span class="preprocessor">#ifdef LATER // SanfordS</span>
02802 <span class="preprocessor"></span>    <span class="comment">/*</span>
02803 <span class="comment">     * We need to handle the case where a configurable icon has been</span>
02804 <span class="comment">     * loaded from some arbitrary module or file and someone now wants</span>
02805 <span class="comment">     * to load the same thing in a different size or color content.</span>
02806 <span class="comment">     *</span>
02807 <span class="comment">     * A cheezier alternative is to just call CopyImage on what we</span>
02808 <span class="comment">     * found.</span>
02809 <span class="comment">     */</span>
02810     <span class="keywordflow">if</span> (hmod == <a class="code" href="../../d1/d8/clglobal_8c.html#a6">hmodUser</a>) {
02811         hico = <a class="code" href="../../d6/d0/usercli_8h.html#a627">FindExistingCursorIcon</a>(NULL,
02812                                       szUSER,
02813                                       type,
02814                                       pszResName,
02815                                       0,
02816                                       0,
02817                                       0);
02818         <span class="keywordflow">if</span> (hico != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
02819             <span class="comment">/*</span>
02820 <span class="comment">             * Find out where the original came from and load it.</span>
02821 <span class="comment">             * This may require some redesign to remember the</span>
02822 <span class="comment">             * filename that LR_LOADFROMFILE images came from.</span>
02823 <span class="comment">             */</span>
02824             _GetIconInfo(....);
02825             <span class="keywordflow">return</span> <a class="code" href="../../d6/d0/usercli_8h.html#a655">LoadIcoCur</a>(....);
02826         }
02827     }
02828 <span class="preprocessor">#endif</span>
02829 <span class="preprocessor"></span>
02830     hico = (HICON)<a class="code" href="../../d6/d0/usercli_8h.html#a656">ObjectFromDIBResource</a>(hmod,
02831                                         pszResName,
02832                                         type,
02833                                         cxDesired,
02834                                         cyDesired,
02835                                         LR_flags);
02836 
02837 IcoCurFound:
02838 
02839     <span class="keywordflow">return</span> hico;
02840 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a78" doxytag="clres.c::LoadIconA" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HICON WINAPI LoadIconA           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HINSTANCE&nbsp;</td>
          <td class="mdname" nowrap> <em>hmod</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPCSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>lpName</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l02373">2373</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
References <a class="el" href="../../d5/d8/smbtrsup_8c-source.html#l00151">ID</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l02393">LoadIconW()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, and <a class="el" href="../../d7/d9/usercli_8h-source.html#l00960">UserLocalFree</a>.
<p>
<pre class="fragment"><div>02376 {
02377     HICON  hRet;
02378     LPWSTR lpUniName;
02379 
02380     <span class="keywordflow">if</span> (<a class="code" href="../../d4/d9/smbtrsup_8c.html#a7">ID</a>(lpName))
02381         <span class="keywordflow">return</span> <a class="code" href="../../d4/d9/clres_8c.html#a79">LoadIconW</a>(hmod, (LPWSTR)lpName);
02382 
02383     <span class="keywordflow">if</span> (!MBToWCS(lpName, -1, &amp;lpUniName, -1, TRUE))
02384         <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
02385 
02386     hRet = <a class="code" href="../../d4/d9/clres_8c.html#a79">LoadIconW</a>(hmod, lpUniName);
02387 
02388     <a class="code" href="../../d6/d0/usercli_8h.html#a138">UserLocalFree</a>(lpUniName);
02389 
02390     <span class="keywordflow">return</span> hRet;
02391 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a79" doxytag="clres.c::LoadIconW" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HICON WINAPI LoadIconW           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HINSTANCE&nbsp;</td>
          <td class="mdname" nowrap> <em>hmod</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPCWSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>lpName</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l02393">2393</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
References <a class="el" href="../../d5/d8/clres_8c-source.html#l02657">LoadIcoCur()</a>.
<p>
Referenced by <a class="el" href="../../d1/d8/clmsg_8c-source.html#l00574">DefWindowProcWorker()</a>, and <a class="el" href="../../d5/d8/clres_8c-source.html#l02373">LoadIconA()</a>.
<p>
<pre class="fragment"><div>02396 {
02397     <span class="keywordflow">return</span> <a class="code" href="../../d6/d0/usercli_8h.html#a655">LoadIcoCur</a>(hmod,
02398                       lpName,
02399                       RT_ICON,
02400                       0,
02401                       0,
02402                       LR_DEFAULTSIZE | LR_SHARED);
02403 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a80" doxytag="clres.c::LoadImageA" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HANDLE WINAPI LoadImageA           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HINSTANCE&nbsp;</td>
          <td class="mdname" nowrap> <em>hmod</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPCSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>lpName</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>type</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>cxDesired</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>cyDesired</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>flags</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l02414">2414</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
References <a class="el" href="../../d5/d8/smbtrsup_8c-source.html#l00151">ID</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l02443">LoadImageW()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d4/d4/i386_2trapc_8c-source.html#l00076">type</a>, and <a class="el" href="../../d7/d9/usercli_8h-source.html#l00960">UserLocalFree</a>.
<p>
<pre class="fragment"><div>02421 {
02422     LPWSTR lpUniName;
02423     HANDLE hRet;
02424 
02425     <span class="keywordflow">if</span> (<a class="code" href="../../d4/d9/smbtrsup_8c.html#a7">ID</a>(lpName))
02426         <span class="keywordflow">return</span> <a class="code" href="../../d4/d9/clres_8c.html#a81">LoadImageW</a>(hmod,
02427                           (LPCWSTR)lpName,
02428                           type,
02429                           cxDesired,
02430                           cyDesired,
02431                           flags);
02432 
02433     <span class="keywordflow">if</span> (!MBToWCS(lpName, -1, &amp;lpUniName, -1, TRUE))
02434         <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
02435 
02436     hRet = <a class="code" href="../../d4/d9/clres_8c.html#a81">LoadImageW</a>(hmod, lpUniName, type, cxDesired, cyDesired, flags);
02437 
02438     <a class="code" href="../../d6/d0/usercli_8h.html#a138">UserLocalFree</a>(lpUniName);
02439 
02440     <span class="keywordflow">return</span> hRet;
02441 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a81" doxytag="clres.c::LoadImageW" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HANDLE WINAPI LoadImageW           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HINSTANCE&nbsp;</td>
          <td class="mdname" nowrap> <em>hmod</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPCWSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>lpName</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>IMAGE_code</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>cxDesired</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>cyDesired</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>flags</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l02443">2443</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
References <a class="el" href="../../d7/d9/usercli_8h-source.html#l00916">GETEXPWINVER</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l01899">LoadBmp()</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l02657">LoadIcoCur()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, and <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00475">VER40</a>.
<p>
Referenced by <a class="el" href="../../d5/d8/clres_8c-source.html#l02414">LoadImageA()</a>.
<p>
<pre class="fragment"><div>02450 {
02451     <span class="comment">/*</span>
02452 <span class="comment">     * If we specified LR_LOADFROMFILE, then we can tweak the</span>
02453 <span class="comment">     * flags to turn off LR_SHARED.</span>
02454 <span class="comment">     */</span>
02455     <span class="keywordflow">if</span> (flags &amp; LR_LOADFROMFILE)
02456         flags &amp;= ~LR_SHARED;
02457 
02458     <span class="keywordflow">switch</span> (IMAGE_code) {
02459     <span class="keywordflow">case</span> IMAGE_BITMAP:
02460         <span class="keywordflow">return</span> (HANDLE)<a class="code" href="../../d4/d9/clres_8c.html#a73">LoadBmp</a>(hmod, lpName, cxDesired, cyDesired, flags);
02461 
02462     <span class="keywordflow">case</span> IMAGE_CURSOR:
02463 <span class="preprocessor">#if 0 //CHRISWIL : oemInfo.fColorCursors doesn't exist on NT.</span>
02464 <span class="preprocessor"></span>        <span class="keywordflow">if</span> (!oemInfo.fColorCursors)
02465             flags |= LR_MONOCHROME;
02466 <span class="preprocessor">#endif</span>
02467 <span class="preprocessor"></span>
02468     <span class="keywordflow">case</span> IMAGE_ICON:
02469 
02470         <span class="comment">/*</span>
02471 <span class="comment">         * On WinNT 3.51, an app can successfully load a</span>
02472 <span class="comment">         * USER icon without specifying LR_SHARED. We enable</span>
02473 <span class="comment">         * these apps to succeed, but make 4.0 apps conform to</span>
02474 <span class="comment">         * Windows95 behavior.</span>
02475 <span class="comment">         */</span>
02476 
02477         <span class="keywordflow">if</span> (!hmod &amp;&amp; <a class="code" href="../../d6/d0/usercli_8h.html#a134">GETEXPWINVER</a>(NULL) &lt; <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a101">VER40</a>) {
02478             flags |= LR_SHARED;
02479         }
02480 
02481         <span class="keywordflow">return</span> (HANDLE)<a class="code" href="../../d6/d0/usercli_8h.html#a655">LoadIcoCur</a>(hmod,
02482                                   lpName,
02483                                   ((IMAGE_code == IMAGE_ICON) ? RT_ICON : RT_CURSOR),
02484                                   cxDesired,
02485                                   cyDesired,
02486                                   flags);
02487 
02488     <span class="keywordflow">default</span>:
02489         RIPMSG0(RIP_WARNING, <span class="stringliteral">"LoadImage: invalid IMAGE_code"</span>);
02490         <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
02491     }
02492 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a41" doxytag="clres.c::LoadStringA" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int WINAPI LoadStringA           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HINSTANCE&nbsp;</td>
          <td class="mdname" nowrap> <em>hmod</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>wID</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>lpAnsiBuffer</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>cchBufferMax</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l00531">531</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
References <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d0/d5/ndismain_8h-source.html#l00025">INT</a>, <a class="el" href="../../d6/d0/usercli_8h.html#a427">LoadStringOrError()</a>, and <a class="el" href="../../d6/d3/acpitabl_8h-source.html#l00366">min</a>.
<p>
<pre class="fragment"><div>00536 {
00537     LPWSTR          lpUniBuffer;
00538     <a class="code" href="../../d9/d5/ndismain_8h.html#a263">INT</a>             cchUnicode;
00539     <a class="code" href="../../d9/d5/ndismain_8h.html#a263">INT</a>             cbAnsi = 0;
00540 
00541     <span class="comment">/*</span>
00542 <span class="comment">     * LoadStringOrError appends a NULL but does not include it in the</span>
00543 <span class="comment">     * return count-of-bytes</span>
00544 <span class="comment">     */</span>
00545     cchUnicode = <a class="code" href="../../d6/d0/usercli_8h.html#a427">LoadStringOrError</a>((HANDLE)hmod,
00546                                       wID,
00547                                       (LPWSTR)&amp;lpUniBuffer,
00548                                       0,
00549                                       0);
00550 
00551     <span class="keywordflow">if</span> (cchUnicode) {
00552 
00553         cbAnsi = WCSToMB(lpUniBuffer,
00554                          cchUnicode,
00555                          &amp;lpAnsiBuffer,
00556                          cchBufferMax - 1,
00557                          FALSE);
00558 
00559         cbAnsi = <a class="code" href="../../d5/d4/acpitabl_8h.html#a69">min</a>(cbAnsi, cchBufferMax - 1);
00560     }
00561 
00562     <span class="comment">/*</span>
00563 <span class="comment">     * Append a NULL but do not include it in the count returned</span>
00564 <span class="comment">     */</span>
00565     lpAnsiBuffer[cbAnsi] = 0;
00566     <span class="keywordflow">return</span> cbAnsi;
00567 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a42" doxytag="clres.c::LoadStringW" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int WINAPI LoadStringW           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HINSTANCE&nbsp;</td>
          <td class="mdname" nowrap> <em>hmod</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>wID</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPWSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>lpBuffer</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>cchBufferMax</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l00569">569</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
References <a class="el" href="../../d6/d0/usercli_8h.html#a427">LoadStringOrError()</a>.
<p>
Referenced by <a class="el" href="../../d7/d3/msgbox_8c-source.html#l00489">MessageBoxWorker()</a>.
<p>
<pre class="fragment"><div>00574 {
00575     <span class="keywordflow">return</span> <a class="code" href="../../d6/d0/usercli_8h.html#a427">LoadStringOrError</a>((HANDLE)hmod,
00576                                 wID,
00577                                 lpBuffer,
00578                                 cchBufferMax,
00579                                 0);
00580 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a66" doxytag="clres.c::LookupIconIdFromDirectory" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int WINAPI LookupIconIdFromDirectory           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>presbits</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>BOOL&nbsp;</td>
          <td class="mdname" nowrap> <em>fIcon</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l01537">1537</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
References <a class="el" href="../../d5/d8/clres_8c-source.html#l01550">LookupIconIdFromDirectoryEx()</a>.
<p>
<pre class="fragment"><div>01540 {
01541     <span class="keywordflow">return</span> <a class="code" href="../../d4/d9/clres_8c.html#a67">LookupIconIdFromDirectoryEx</a>(presbits, fIcon, 0, 0, 0);
01542 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a67" doxytag="clres.c::LookupIconIdFromDirectoryEx" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int WINAPI LookupIconIdFromDirectoryEx           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>presbits</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>BOOL&nbsp;</td>
          <td class="mdname" nowrap> <em>fIcon</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>cxDesired</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>cyDesired</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>LR_flags</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l01550">1550</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
References <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l03173">ConnectIfNecessary</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, and <a class="el" href="../../d5/d8/clres_8c-source.html#l04759">RtlGetIdFromDirectory()</a>.
<p>
Referenced by <a class="el" href="../../d7/d9/extract_8c-source.html#l00517">ExtractIconFromEXE()</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l02502">GetIconIdEx()</a>, <a class="el" href="../../d4/d1/rtlres_8c-source.html#l00396">IconFromBestImage()</a>, and <a class="el" href="../../d5/d8/clres_8c-source.html#l01537">LookupIconIdFromDirectory()</a>.
<p>
<pre class="fragment"><div>01556 {
01557     <a class="code" href="../../d1/d0/inc_2user_8h.html#a848">ConnectIfNecessary</a>();
01558 
01559     <span class="keywordflow">return</span> <a class="code" href="../../d6/d0/usercli_8h.html#a428">RtlGetIdFromDirectory</a>(presbits,
01560                                  fIcon,
01561                                  cxDesired,
01562                                  cyDesired,
01563                                  LR_flags,
01564                                  NULL);
01565 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a94" doxytag="clres.c::Magnitude" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> UINT Magnitude           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>nValue</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l03844">3844</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
References <a class="el" href="../../d0/d5/ndismain_8h-source.html#l00026">UINT</a>.
<p>
Referenced by <a class="el" href="../../d5/d8/clres_8c-source.html#l03903">MatchImage()</a>.
<p>
<pre class="fragment"><div>03846 {
03847     <span class="keywordflow">if</span> (nValue &lt; 4)
03848         <span class="keywordflow">return</span> 1;
03849     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (nValue &lt; 8)
03850         <span class="keywordflow">return</span> 2;
03851     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (nValue &lt; 16)
03852         <span class="keywordflow">return</span> 3;
03853     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (nValue &lt; 256)
03854         <span class="keywordflow">return</span> 4;
03855     <span class="keywordflow">else</span>
03856         <span class="keywordflow">return</span> 8;
03857 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a95" doxytag="clres.c::MatchImage" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> UINT MatchImage           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">LPRESDIR&nbsp;</td>
          <td class="mdname" nowrap> <em>lprd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPINT&nbsp;</td>
          <td class="mdname" nowrap> <em>lpcxWant</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPINT&nbsp;</td>
          <td class="mdname" nowrap> <em>lpcyWant</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>uColorsWant</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>BOOL&nbsp;</td>
          <td class="mdname" nowrap> <em>fIcon</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l03903">3903</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
References <a class="el" href="../../d5/d8/clres_8c-source.html#l00019">BPP01_MAXCOLORS</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l00021">BPP08_MAXCOLORS</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l03844">Magnitude()</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l03823">MyAbs()</a>, and <a class="el" href="../../d0/d5/ndismain_8h-source.html#l00026">UINT</a>.
<p>
Referenced by <a class="el" href="../../d5/d8/clres_8c-source.html#l03980">GetBestImage()</a>.
<p>
<pre class="fragment"><div>03909 {
03910     <a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a> uColorsNew;
03911     <span class="keywordtype">int</span>  cxNew;
03912     <span class="keywordtype">int</span>  cyNew;
03913 
03914     cxNew = lprd-&gt;Icon.Width;
03915     cyNew = lprd-&gt;Icon.Height;
03916 
03917     <span class="keywordflow">if</span> (fIcon) {
03918         uColorsNew = lprd-&gt;Icon.ColorCount;
03919     } <span class="keywordflow">else</span> {
03920         cyNew &gt;&gt;= 1;
03921         uColorsNew = <a class="code" href="../../d4/d9/clres_8c.html#a0">BPP01_MAXCOLORS</a>;
03922     }
03923 
03924     <span class="comment">/*</span>
03925 <span class="comment">     * 0 really means maximum size (256) or colors (256).</span>
03926 <span class="comment">     */</span>
03927     <span class="keywordflow">if</span> (!cxNew)
03928         cxNew = <a class="code" href="../../d4/d9/clres_8c.html#a2">BPP08_MAXCOLORS</a>;
03929 
03930     <span class="keywordflow">if</span> (!*lpcxWant)
03931         *lpcxWant = cxNew;
03932 
03933     <span class="keywordflow">if</span> (!cyNew)
03934         cyNew = <a class="code" href="../../d4/d9/clres_8c.html#a2">BPP08_MAXCOLORS</a>;
03935 
03936     <span class="keywordflow">if</span> (!*lpcyWant)
03937         *lpcyWant = cyNew;
03938 
03939     <span class="keywordflow">if</span> (!uColorsNew)
03940         uColorsNew = <a class="code" href="../../d4/d9/clres_8c.html#a2">BPP08_MAXCOLORS</a>;
03941 
03942     <span class="comment">/*</span>
03943 <span class="comment">     * Here are the rules for our "match" formula:</span>
03944 <span class="comment">     *      (1) A close size match is much preferable to a color match</span>
03945 <span class="comment">     *      (2) Fewer colors are better than more</span>
03946 <span class="comment">     *      (3) Bigger icons are better than smaller</span>
03947 <span class="comment">     *</span>
03948 <span class="comment">     * The color count, width, and height are powers of 2.  So we use Magnitude()</span>
03949 <span class="comment">     * which calculates the order of magnitude in base 2.</span>
03950 <span class="comment">     */</span>
03951 <span class="preprocessor">#if 0 //CHRISWIL: Not in Win95</span>
03952 <span class="preprocessor"></span>
03953     <span class="keywordflow">return</span> (MagnitudeDiff(uColorsWant, uColorsNew) +
03954             MagnitudeDiff(cxNew, *lpcxWant) +
03955             MagnitudeDiff(cyNew, *lpcyWant));
03956 
03957 <span class="preprocessor">#else</span>
03958 <span class="preprocessor"></span>
03959     <span class="keywordflow">return</span>( 2*<a class="code" href="../../d4/d9/clres_8c.html#a93">MyAbs</a>(<a class="code" href="../../d4/d9/clres_8c.html#a94">Magnitude</a>(uColorsWant), <a class="code" href="../../d4/d9/clres_8c.html#a94">Magnitude</a>(uColorsNew)) +
03960               <a class="code" href="../../d4/d9/clres_8c.html#a93">MyAbs</a>(cxNew, *lpcxWant) +
03961               <a class="code" href="../../d4/d9/clres_8c.html#a93">MyAbs</a>(cyNew, *lpcyWant));
03962 <span class="preprocessor">#endif</span>
03963 <span class="preprocessor"></span>}
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a93" doxytag="clres.c::MyAbs" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> UINT MyAbs           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>valueHave</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>valueWant</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l03823">3823</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
References <a class="el" href="../../d0/d5/ndismain_8h-source.html#l00026">UINT</a>.
<p>
Referenced by <a class="el" href="../../d5/d8/clres_8c-source.html#l03903">MatchImage()</a>.
<p>
<pre class="fragment"><div>03826 {
03827     <span class="keywordtype">int</span> diff = (valueHave - valueWant);
03828 
03829     <span class="keywordflow">if</span> (diff &lt; 0)
03830         diff = 2 * (-diff);
03831 
03832     <span class="keywordflow">return</span> (<a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a>)diff;
03833 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a85" doxytag="clres.c::ObjectFromDIBResource" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HANDLE ObjectFromDIBResource           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HINSTANCE&nbsp;</td>
          <td class="mdname" nowrap> <em>hmod</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPCWSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>lpName</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPWSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>type</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>cxDesired</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>cyDesired</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>LR_flags</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l02847">2847</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
References <a class="el" href="../../d6/d0/usercli_8h.html#a659">ConvertDIBBitmap()</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l03344">ConvertDIBIcon()</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l00060">ISRIFFFORMAT</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l01573">LoadCursorIconFromResource()</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l02544">LoadDIB()</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00912">LOCKRESOURCE</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d0/d7/halvprnt_8c-source.html#l00031">PBYTE</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00411">PTR_TO_ID</a>, <a class="el" href="../../d4/d1/rtlres_8c-source.html#l00142">RtlLoadObjectFromDIBFile()</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l00105">SplFreeResource()</a>, <a class="el" href="../../d4/d4/i386_2trapc_8c-source.html#l00076">type</a>, and <a class="el" href="../../d7/d9/usercli_8h-source.html#l00913">UNLOCKRESOURCE</a>.
<p>
Referenced by <a class="el" href="../../d5/d8/clres_8c-source.html#l01899">LoadBmp()</a>, and <a class="el" href="../../d5/d8/clres_8c-source.html#l02657">LoadIcoCur()</a>.
<p>
<pre class="fragment"><div>02854 {
02855     HANDLE  hObj = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
02856 
02857     <span class="keywordflow">if</span> (LR_flags &amp; LR_LOADFROMFILE) {
02858 
02859         hObj = <a class="code" href="../../d6/d0/usercli_8h.html#a657">RtlLoadObjectFromDIBFile</a>(lpName,
02860                                         type,
02861                                         cxDesired,
02862                                         cyDesired,
02863                                         LR_flags);
02864     } <span class="keywordflow">else</span> {
02865 
02866         HANDLE hdib;
02867 
02868         hdib = <a class="code" href="../../d4/d9/clres_8c.html#a83">LoadDIB</a>(hmod, lpName, type, cxDesired, cyDesired, LR_flags);
02869 
02870         <span class="keywordflow">if</span> (hdib != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
02871 
02872             LPBITMAPINFOHEADER lpbih;
02873 
02874             <span class="comment">/*</span>
02875 <span class="comment">             * We cast the resource-bits to a BITMAPINFOHEADER.  If the</span>
02876 <span class="comment">             * resource is a CURSOR type, then there are actually two</span>
02877 <span class="comment">             * WORDs preceeding the BITMAPINFOHDEADER indicating the</span>
02878 <span class="comment">             * hot-spot.  Be careful in assuming you have a real</span>
02879 <span class="comment">             * dib in this case.</span>
02880 <span class="comment">             */</span>
02881             <span class="keywordflow">if</span>(lpbih = (LPBITMAPINFOHEADER)<a class="code" href="../../d6/d0/usercli_8h.html#a130">LOCKRESOURCE</a>(hdib, hmod)) {
02882 
02883                 <span class="keywordflow">switch</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a99">PTR_TO_ID</a>(type)) {
02884                 <span class="keywordflow">case</span> <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a99">PTR_TO_ID</a>(RT_BITMAP):
02885                     <span class="comment">/*</span>
02886 <span class="comment">                     * Create a physical bitmap from the DIB.</span>
02887 <span class="comment">                     */</span>
02888                     hObj = <a class="code" href="../../d4/d9/clres_8c.html#a92">ConvertDIBBitmap</a>(lpbih,
02889                                             cxDesired,
02890                                             cyDesired,
02891                                             LR_flags,
02892                                             <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>,
02893                                             <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>);
02894                     <span class="keywordflow">break</span>;
02895 
02896                 <span class="keywordflow">case</span> <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a99">PTR_TO_ID</a>(RT_ICON):
02897                 case <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a99">PTR_TO_ID</a>(RT_CURSOR):
02898                 case <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a99">PTR_TO_ID</a>(RT_ANICURSOR):
02899                 case <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a99">PTR_TO_ID</a>(RT_ANIICON):
02900                     <span class="comment">/*</span>
02901 <span class="comment">                     * Animated icon\cursors resources use the RIFF format</span>
02902 <span class="comment">                     */</span>
02903                     if (<a class="code" href="../../d4/d9/clres_8c.html#a10">ISRIFFFORMAT</a>(lpbih)) {
02904                         hObj = <a class="code" href="../../d4/d9/clres_8c.html#a68">LoadCursorIconFromResource</a> ((PBYTE)lpbih, lpName, cxDesired, cyDesired, LR_flags);
02905                     } <span class="keywordflow">else</span> {
02906                         <span class="comment">/*</span>
02907 <span class="comment">                         * Create the object from the DIB.</span>
02908 <span class="comment">                         */</span>
02909                         hObj = <a class="code" href="../../d6/d0/usercli_8h.html#a660">ConvertDIBIcon</a>(lpbih,
02910                                               hmod,
02911                                               lpName,
02912                                               (type == RT_ICON),
02913                                               cxDesired,
02914                                               cyDesired,
02915                                               LR_flags);
02916                     }
02917                     <span class="keywordflow">break</span>;
02918                 }
02919 
02920                 <a class="code" href="../../d6/d0/usercli_8h.html#a131">UNLOCKRESOURCE</a>(hdib, hmod);
02921             }
02922 
02923             <span class="comment">/*</span>
02924 <span class="comment">             * DO THIS TWICE!  The resource compiler always makes icon images</span>
02925 <span class="comment">             * (RT_ICON) in a group icon discardable, whether the group dude</span>
02926 <span class="comment">             * is or not!  So the first free won't really free the thing;</span>
02927 <span class="comment">             * it'll just set the ref count to 0 and let the discard logic</span>
02928 <span class="comment">             * go on its merry way.</span>
02929 <span class="comment">             *</span>
02930 <span class="comment">             * We take care of shared guys, so we don't need this dib no more.</span>
02931 <span class="comment">             * Don't need this DIB no more no more, no more no more no more</span>
02932 <span class="comment">             * don't need this DIB no more.</span>
02933 <span class="comment">             */</span>
02934             <a class="code" href="../../d4/d9/clres_8c.html#a30">SplFreeResource</a>(hdib, hmod, LR_flags);
02935         }
02936     }
02937 
02938     <span class="keywordflow">return</span> hObj;
02939 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a109" doxytag="clres.c::RtlGetIdFromDirectory" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int RtlGetIdFromDirectory           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>presbits</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>BOOL&nbsp;</td>
          <td class="mdname" nowrap> <em>fIcon</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>cxDesired</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>cyDesired</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>LR_flags</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>PDWORD&nbsp;</td>
          <td class="mdname" nowrap> <em>pdwResSize</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l04759">4759</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
References <a class="el" href="../../d5/d8/clres_8c-source.html#l03980">GetBestImage()</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l04096">GetIcoCurBpp()</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l04074">GetIcoCurHeight()</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l04052">GetIcoCurWidth()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, and <a class="el" href="../../d0/d5/ndismain_8h-source.html#l00026">UINT</a>.
<p>
Referenced by <a class="el" href="../../d5/d8/clres_8c-source.html#l01550">LookupIconIdFromDirectoryEx()</a>, and <a class="el" href="../../d4/d3/client_2acons_8c-source.html#l00454">ReadIconGuts()</a>.
<p>
<pre class="fragment"><div>04766 {
04767     LPNEWHEADER lpnh;
04768     LPRESDIR    lprsd;
04769     <a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a>        iImage;
04770     <a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a>        cImage;
04771     <a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a>        bpp;
04772 
04773     <span class="comment">/*</span>
04774 <span class="comment">     * Make sure this is pointing to valid resource bits.</span>
04775 <span class="comment">     */</span>
04776     <span class="keywordflow">if</span> (presbits == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
04777         <span class="keywordflow">return</span> 0;
04778 
04779     lpnh = (LPNEWHEADER)presbits;
04780 
04781     <span class="comment">/*</span>
04782 <span class="comment">     * Fill in defaults.</span>
04783 <span class="comment">     */</span>
04784     cxDesired = <a class="code" href="../../d6/d0/usercli_8h.html#a652">GetIcoCurWidth</a>(cxDesired, fIcon, LR_flags, 0);
04785     cyDesired = <a class="code" href="../../d6/d0/usercli_8h.html#a653">GetIcoCurHeight</a>(cyDesired, fIcon, LR_flags, 0);
04786 
04787     bpp = <a class="code" href="../../d6/d0/usercli_8h.html#a654">GetIcoCurBpp</a>(LR_flags);
04788 
04789     <span class="comment">/*</span>
04790 <span class="comment">     * We'll use the first image in the directory if we can't find one</span>
04791 <span class="comment">     * that's appropriate.</span>
04792 <span class="comment">     */</span>
04793     cImage = lpnh-&gt;ResCount;
04794     lprsd  = (LPRESDIR)(lpnh + 1);
04795 
04796     iImage = <a class="code" href="../../d4/d9/clres_8c.html#a96">GetBestImage</a>(lprsd, cImage, cxDesired, cyDesired, bpp, fIcon);
04797 
04798     <span class="keywordflow">if</span> (iImage == cImage)
04799         iImage = 0;
04800 
04801     <span class="keywordflow">if</span> (pdwResSize != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
04802         *pdwResSize = (lprsd + iImage)-&gt;BytesInRes;
04803 
04804     <span class="keywordflow">return</span> ((LPRESDIR)(lprsd + iImage))-&gt;idIcon;
04805 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a43" doxytag="clres.c::SkipIDorString" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a> SkipIDorString           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">LPBYTE&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>pb</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l00589">589</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
References <a class="el" href="../../d0/d7/halvprnt_8c-source.html#l00031">PBYTE</a>.
<p>
Referenced by <a class="el" href="../../d5/d8/clres_8c-source.html#l00609">GetSizeDialogTemplate()</a>.
<p>
<pre class="fragment"><div>00591 {
00592     <span class="keywordflow">if</span> (*((LPWORD)pb) == 0xFFFF)
00593         <span class="keywordflow">return</span> (pb + 4);
00594 
00595     <span class="keywordflow">while</span> (*((PWCHAR)pb)++ != 0);
00596 
00597     <span class="keywordflow">return</span> pb;
00598 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a29" doxytag="clres.c::SplFindResource" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HANDLE SplFindResource           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HINSTANCE&nbsp;</td>
          <td class="mdname" nowrap> <em>hmod</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPCWSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>lpName</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPCWSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>lpType</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l00088">88</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
References <a class="el" href="../../d7/d9/usercli_8h-source.html#l00908">FINDRESOURCEW</a>.
<p>
Referenced by <a class="el" href="../../d5/d8/clres_8c-source.html#l02544">LoadDIB()</a>.
<p>
<pre class="fragment"><div>00092 {
00093     <span class="keywordflow">return</span> <a class="code" href="../../d6/d0/usercli_8h.html#a126">FINDRESOURCEW</a>(hmod, lpName, lpType);
00094 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a30" doxytag="clres.c::SplFreeResource" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID SplFreeResource           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HANDLE&nbsp;</td>
          <td class="mdname" nowrap> <em>hRes</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HINSTANCE&nbsp;</td>
          <td class="mdname" nowrap> <em>hmod</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>lrFlags</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l00105">105</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
References <a class="el" href="../../d7/d9/usercli_8h-source.html#l00914">FREERESOURCE</a>, <a class="el" href="../../d2/d7/clglobal_8c-source.html#l00053">hmodUser</a>, and <a class="el" href="../../d2/d7/hal_8h.html#a212">VOID()</a>.
<p>
Referenced by <a class="el" href="../../d5/d8/clres_8c-source.html#l02544">LoadDIB()</a>, and <a class="el" href="../../d5/d8/clres_8c-source.html#l02847">ObjectFromDIBResource()</a>.
<p>
<pre class="fragment"><div>00109 {
00110     <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d0/usercli_8h.html#a132">FREERESOURCE</a>(hRes, hmod) &amp;&amp;
00111         ((hmod == <a class="code" href="../../d1/d8/clglobal_8c.html#a6">hmodUser</a>) || (lrFlags &amp; LR_SHARED))) {
00112 
00113         <a class="code" href="../../d6/d0/usercli_8h.html#a132">FREERESOURCE</a>(hRes, hmod);
00114     }
00115 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a90" doxytag="clres.c::TrulyMonochrome" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL TrulyMonochrome           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d0/d5/perfuser_8c.html#a5">LPVOID</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>lpColorTable</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>BOOL&nbsp;</td>
          <td class="mdname" nowrap> <em>fOldFormat</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l03490">3490</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d4/d9/clres_8c.html#a17">lpRGB</a>, <a class="el" href="../../d4/d9/clres_8c.html#a18">lpRGBw</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l00023">RESCLR_BLACK</a>, and <a class="el" href="../../d5/d8/clres_8c-source.html#l00024">RESCLR_WHITE</a>.
<p>
Referenced by <a class="el" href="../../d5/d8/clres_8c-source.html#l03546">CopyDibHdr()</a>.
<p>
<pre class="fragment"><div>03493 {
03494 <span class="preprocessor">    #define lpRGB  ((UNALIGNED LONG *)lpColorTable)</span>
03495 <span class="preprocessor"></span><span class="preprocessor">    #define lpRGBw ((UNALIGNED WORD *)lpColorTable)</span>
03496 <span class="preprocessor"></span>
03497     <span class="keywordflow">if</span> (fOldFormat) {
03498 
03499         <span class="comment">/*</span>
03500 <span class="comment">         * Honey - its triplets.</span>
03501 <span class="comment">         */</span>
03502         <span class="keywordflow">if</span> (<a class="code" href="../../d4/d9/clres_8c.html#a18">lpRGBw</a>[0] == 0x0000)
03503             <span class="keywordflow">return</span> (<a class="code" href="../../d4/d9/clres_8c.html#a18">lpRGBw</a>[1] == 0xFF00) &amp;&amp; (<a class="code" href="../../d4/d9/clres_8c.html#a18">lpRGBw</a>[2] == 0xFFFF);
03504         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d4/d9/clres_8c.html#a18">lpRGBw</a>[0] == 0xFFFF)
03505             <span class="keywordflow">return</span> (<a class="code" href="../../d4/d9/clres_8c.html#a18">lpRGBw</a>[1] == 0x00FF) &amp;&amp; (<a class="code" href="../../d4/d9/clres_8c.html#a18">lpRGBw</a>[2] == 0x0000);
03506 
03507     } <span class="keywordflow">else</span> {
03508 
03509         <span class="comment">/*</span>
03510 <span class="comment">         * Honey - its quadruplets!</span>
03511 <span class="comment">         */</span>
03512         <span class="keywordflow">if</span> (<a class="code" href="../../d4/d9/clres_8c.html#a17">lpRGB</a>[0] == <a class="code" href="../../d4/d9/clres_8c.html#a3">RESCLR_BLACK</a>)
03513             <span class="keywordflow">return</span> (<a class="code" href="../../d4/d9/clres_8c.html#a17">lpRGB</a>[1] == <a class="code" href="../../d4/d9/clres_8c.html#a4">RESCLR_WHITE</a>);
03514         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d4/d9/clres_8c.html#a17">lpRGB</a>[0] == <a class="code" href="../../d4/d9/clres_8c.html#a4">RESCLR_WHITE</a>)
03515             <span class="keywordflow">return</span> (<a class="code" href="../../d4/d9/clres_8c.html#a17">lpRGB</a>[1] == <a class="code" href="../../d4/d9/clres_8c.html#a3">RESCLR_BLACK</a>);
03516     }
03517 
03518 <span class="preprocessor">    #undef lpRGB</span>
03519 <span class="preprocessor"></span><span class="preprocessor">    #undef lpRGBw</span>
03520 <span class="preprocessor"></span>
03521     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
03522 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a100" doxytag="clres.c::WOWFindResourceExWCover" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HANDLE WOWFindResourceExWCover           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HANDLE&nbsp;</td>
          <td class="mdname" nowrap> <em>hmod</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPCWSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>rt</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPCWSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>lpUniName</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>WORD&nbsp;</td>
          <td class="mdname" nowrap> <em>LangId</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l04127">4127</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
References <a class="el" href="../../d7/d9/usercli_8h-source.html#l00909">FINDRESOURCEEXA</a>, <a class="el" href="../../d5/d8/smbtrsup_8c-source.html#l00151">ID</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, and <a class="el" href="../../d7/d9/usercli_8h-source.html#l00960">UserLocalFree</a>.
<p>
Referenced by <a class="el" href="../../d4/d7/client_8c-source.html#l02696">UserRegisterWowHandlers()</a>.
<p>
<pre class="fragment"><div>04132 {
04133     LPSTR  lpAnsiName;
04134     HANDLE hRes;
04135 
04136     <span class="keywordflow">if</span> (<a class="code" href="../../d4/d9/smbtrsup_8c.html#a7">ID</a>(lpUniName))
04137         <span class="keywordflow">return</span> <a class="code" href="../../d6/d0/usercli_8h.html#a127">FINDRESOURCEEXA</a>(hmod, (LPSTR)lpUniName, (LPSTR)rt, LangId);
04138 
04139     <span class="comment">/*</span>
04140 <span class="comment">     * Otherwise convert the name of the menu then call LoadMenu</span>
04141 <span class="comment">     */</span>
04142     <span class="keywordflow">if</span> (!WCSToMB(lpUniName, -1, &amp;lpAnsiName, -1, TRUE))
04143         <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
04144 
04145     hRes = <a class="code" href="../../d6/d0/usercli_8h.html#a127">FINDRESOURCEEXA</a>(hmod, lpAnsiName, (LPSTR)rt, LangId);
04146 
04147     <a class="code" href="../../d6/d0/usercli_8h.html#a138">UserLocalFree</a>(lpAnsiName);
04148 
04149     <span class="keywordflow">return</span> hRes;
04150 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a31" doxytag="clres.c::WowGetModuleFileName" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL WowGetModuleFileName           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HMODULE&nbsp;</td>
          <td class="mdname" nowrap> <em>hModule</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPWSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>pwsz</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>cchMax</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l00128">128</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d5/d8/clres_8c-source.html#l03344">ConvertDIBIcon()</a>, and <a class="el" href="../../d5/d8/clres_8c-source.html#l02657">LoadIcoCur()</a>.
<p>
<pre class="fragment"><div>00132 {
00133     <span class="keywordflow">if</span> (!GetModuleFileName(hModule, pwsz, cchMax)) {
00134 
00135         <span class="keywordflow">if</span> (cchMax &lt; 10) {
00136             RIPMSG0(RIP_WARNING, <span class="stringliteral">"WowGetModuleFileName: exceeded Char-Max"</span>);
00137             <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00138         }
00139 
00140         wsprintf(pwsz, TEXT(<span class="stringliteral">"\001%08lx"</span>), hModule);
00141     }
00142 
00143     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00144 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a32" doxytag="clres.c::WowGetModuleHandle" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HMODULE WowGetModuleHandle           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">LPCWSTR&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>pwsz</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l00157">157</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
References <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, and <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>.
<p>
Referenced by <a class="el" href="../../d5/d8/clres_8c-source.html#l04436">CopyImageFromRes()</a>.
<p>
<pre class="fragment"><div>00159 {
00160     HMODULE hMod = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00161     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>   digit;
00162 
00163     <span class="keywordflow">if</span> (pwsz[0] == TEXT(<span class="charliteral">'\001'</span>)) {
00164 
00165         <span class="comment">/*</span>
00166 <span class="comment">         * Cant seem to link to swscanf without CRT0 problems so just</span>
00167 <span class="comment">         * do it by hand.</span>
00168 <span class="comment">         */</span>
00169         <span class="keywordflow">while</span> (*(++pwsz)) {
00170 
00171             <span class="keywordflow">if</span> (*pwsz == TEXT(<span class="charliteral">' '</span>))
00172                 <span class="keywordflow">continue</span>;
00173 
00174             digit = *pwsz - TEXT(<span class="charliteral">'0'</span>);
00175 
00176             <span class="keywordflow">if</span> (digit &gt; 9)
00177                 digit += (<a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)(TEXT(<span class="charliteral">'0'</span>) - TEXT(<span class="charliteral">'a'</span>) + 10);
00178 
00179             (ULONG_PTR)hMod &lt;&lt;= 4;
00180             (ULONG_PTR)hMod += digit;
00181         }
00182 
00183     } <span class="keywordflow">else</span> {
00184 
00185         hMod = GetModuleHandle(pwsz);
00186     }
00187 
00188     <span class="keywordflow">return</span> hMod;
00189 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a101" doxytag="clres.c::WOWLoadBitmapA" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HBITMAP WOWLoadBitmapA           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HINSTANCE&nbsp;</td>
          <td class="mdname" nowrap> <em>hmod</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPCSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>lpName</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPBYTE&nbsp;</td>
          <td class="mdname" nowrap> <em>pResData</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>cbResData</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l04158">4158</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
References <a class="el" href="../../d6/d0/usercli_8h.html#a659">ConvertDIBBitmap()</a>, <a class="el" href="../../d5/d8/smbtrsup_8c-source.html#l00151">ID</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l01899">LoadBmp()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, and <a class="el" href="../../d7/d9/usercli_8h-source.html#l00960">UserLocalFree</a>.
<p>
Referenced by <a class="el" href="../../d4/d7/client_8c-source.html#l02696">UserRegisterWowHandlers()</a>.
<p>
<pre class="fragment"><div>04163 {
04164     LPWSTR  lpUniName;
04165     HBITMAP hRet;
04166 
04167     UNREFERENCED_PARAMETER(cbResData);
04168 
04169     <span class="keywordflow">if</span> (pResData == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
04170 
04171         <span class="keywordflow">if</span> (<a class="code" href="../../d4/d9/smbtrsup_8c.html#a7">ID</a>(lpName))
04172             <span class="keywordflow">return</span> <a class="code" href="../../d4/d9/clres_8c.html#a73">LoadBmp</a>(hmod, (LPCWSTR)lpName, 0, 0, 0);
04173 
04174         <span class="keywordflow">if</span> (!MBToWCS(lpName, -1, &amp;lpUniName, -1, TRUE))
04175             <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
04176 
04177         hRet = <a class="code" href="../../d4/d9/clres_8c.html#a73">LoadBmp</a>(hmod, lpUniName, 0, 0, 0);
04178 
04179         <a class="code" href="../../d6/d0/usercli_8h.html#a138">UserLocalFree</a>(lpUniName);
04180 
04181     } <span class="keywordflow">else</span> {
04182 
04183         hRet = <a class="code" href="../../d6/d0/usercli_8h.html#a659">ConvertDIBBitmap</a>((LPBITMAPINFOHEADER)pResData,
04184                                 0,
04185                                 0,
04186                                 LR_DEFAULTSIZE,
04187                                 NULL,
04188                                 NULL);
04189     }
04190 
04191     <span class="keywordflow">return</span> hRet;
04192 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a102" doxytag="clres.c::WowServerLoadCreateCursorIcon" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HICON WowServerLoadCreateCursorIcon           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HANDLE&nbsp;</td>
          <td class="mdname" nowrap> <em>hmod</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPWSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>pszModName</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>dwExpWinVer</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPCWSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>lpName</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>cb</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>pResData</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPWSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>type</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>BOOL&nbsp;</td>
          <td class="mdname" nowrap> <em>fClient</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l04200">4200</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l03344">ConvertDIBIcon()</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l04074">GetIcoCurHeight()</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l04052">GetIcoCurWidth()</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l02657">LoadIcoCur()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d4/d4/i386_2trapc_8c-source.html#l00076">type</a>, and <a class="el" href="../../d0/d5/ndismain_8h-source.html#l00026">UINT</a>.
<p>
Referenced by <a class="el" href="../../d4/d7/client_8c-source.html#l02696">UserRegisterWowHandlers()</a>.
<p>
<pre class="fragment"><div>04209 {
04210     HICON hRet;
04211     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>  fIcon = (<a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> == RT_ICON);
04212     <a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a>  LR_Flags = LR_SHARED;
04213 
04214     UNREFERENCED_PARAMETER(pszModName);
04215     UNREFERENCED_PARAMETER(dwExpWinVer);
04216     UNREFERENCED_PARAMETER(cb);
04217     UNREFERENCED_PARAMETER(fClient);
04218 
04219     <span class="keywordflow">if</span> (!fIcon)
04220         LR_Flags |= LR_MONOCHROME;
04221 
04222     <span class="keywordflow">if</span> (pResData == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
04223 
04224         hRet = <a class="code" href="../../d6/d0/usercli_8h.html#a655">LoadIcoCur</a>(hmod,
04225                           lpName,
04226                           type,
04227                           0,
04228                           0,
04229                           LR_Flags | LR_DEFAULTSIZE);
04230 
04231     } <span class="keywordflow">else</span> {
04232 
04233         hRet = <a class="code" href="../../d6/d0/usercli_8h.html#a660">ConvertDIBIcon</a>((LPBITMAPINFOHEADER)pResData,
04234                               hmod,
04235                               lpName,
04236                               fIcon,
04237                               <a class="code" href="../../d6/d0/usercli_8h.html#a652">GetIcoCurWidth</a>(0 , fIcon, LR_DEFAULTSIZE, 0),
04238                               <a class="code" href="../../d6/d0/usercli_8h.html#a653">GetIcoCurHeight</a>(0, fIcon, LR_DEFAULTSIZE, 0),
04239                               LR_Flags);
04240     }
04241 
04242     <span class="keywordflow">return</span> hRet;
04243 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a103" doxytag="clres.c::WowServerLoadCreateMenu" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HMENU WowServerLoadCreateMenu           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HANDLE&nbsp;</td>
          <td class="mdname" nowrap> <em>hMod</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPCSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>lpName</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>CONST LPMENUTEMPLATE&nbsp;</td>
          <td class="mdname" nowrap> <em>pmt</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>cb</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>BOOL&nbsp;</td>
          <td class="mdname" nowrap> <em>fCallClient</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d8/clres_8c-source.html#l04250">4250</a> of file <a class="el" href="../../d5/d8/clres_8c-source.html">clres.c</a>.
<p>
References <a class="el" href="../../d0/d8/clmenu_8c-source.html#l00319">CreateMenuFromResource()</a>, <a class="el" href="../../d0/d8/clmenu_8c-source.html#l00410">LoadMenuA()</a>, and <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>.
<p>
<pre class="fragment"><div>04256 {
04257     UNREFERENCED_PARAMETER(cb);
04258     UNREFERENCED_PARAMETER(fCallClient);
04259 
04260     <span class="keywordflow">if</span> (pmt == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
04261         <span class="keywordflow">return</span> <a class="code" href="../../d9/d8/clmenu_8c.html#a5">LoadMenuA</a>(hMod, lpName);
04262     } <span class="keywordflow">else</span>
04263         <span class="keywordflow">return</span> <a class="code" href="../../d6/d0/usercli_8h.html#a650">CreateMenuFromResource</a>(pmt);
04264 }
</div></pre>    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:43:06 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
