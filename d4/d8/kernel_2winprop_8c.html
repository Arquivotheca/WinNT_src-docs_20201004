<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: kernel/winprop.c File Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>winprop.c File Reference</h1><code>#include "<a class="el" href="../../d1/d3/w32_2ntuser_2kernel_2precomp_8h-source.html">precomp.h</a>"</code><br>

<p>
<a href="../../d5/d7/kernel_2winprop_8c-source.html">Go to the source code of this file.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d8/kernel_2winprop_8c.html#a0">InternalSetProp</a> (<a class="el" href="../../d6/d9/structtagWND.html">PWND</a> pwnd, LPWSTR pszKey, HANDLE hData, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> <a class="el" href="../../d3/d8/propapi_8h.html#a34">dwFlags</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HANDLE&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d8/kernel_2winprop_8c.html#a1">InternalRemoveProp</a> (<a class="el" href="../../d6/d9/structtagWND.html">PWND</a> pwnd, LPWSTR pszKey, BOOL fInternal)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d8/kernel_2winprop_8c.html#a2">_BuildPropList</a> (<a class="el" href="../../d6/d9/structtagWND.html">PWND</a> pwnd, <a class="el" href="../../d2/d1/struct__PROPSET.html">PROPSET</a> aPropSet[], UINT cPropMax, <a class="el" href="../../d9/d5/ndismain_8h.html#a266">PUINT</a> pcPropNeeded)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d1/d4/structtagPROP.html">PPROP</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d8/kernel_2winprop_8c.html#a3">CreateProp</a> (<a class="el" href="../../d6/d9/structtagWND.html">PWND</a> pwnd)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d8/kernel_2winprop_8c.html#a4">DeleteProperties</a> (<a class="el" href="../../d6/d9/structtagWND.html">PWND</a> pwnd)</td></tr>

</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a2" doxytag="kernel/winprop.c::_BuildPropList" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS _BuildPropList           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d6/d9/structtagWND.html">PWND</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pwnd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d2/d1/struct__PROPSET.html">PROPSET</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>aPropSet</em>[], </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>cPropMax</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d9/d5/ndismain_8h.html#a266">PUINT</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pcPropNeeded</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d7/kernel_2winprop_8c-source.html#l00141">141</a> of file <a class="el" href="../../d5/d7/kernel_2winprop_8c-source.html">kernel/winprop.c</a>.
<p>
References <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l01815">tagPROPLIST::aprop</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l00681">_PROPSET::atom</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l01800">tagPROP::atomKey</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l01801">tagPROP::fs</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01717">tagPROP::hData</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l00680">_PROPSET::hData</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l01814">tagPROPLIST::iFirstFree</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l01847">tagWND::ppropList</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01722">PROPF_INTERNAL</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00135">Status</a>, and <a class="el" href="../../d0/d5/ndismain_8h-source.html#l00026">UINT</a>.
<p>
Referenced by <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l08333">NtUserBuildPropList()</a>.
<p>
<pre class="fragment"><div>00146 {
00147     <a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a> i;
00148     <a class="code" href="../../d5/d4/structtagPROPLIST.html">PPROPLIST</a> ppropList;
00149     <a class="code" href="../../d1/d4/structtagPROP.html">PPROP</a> pProp;
00150     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> iRetCnt = 0;            <span class="comment">// The number of Props returned</span>
00151     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> iProp = 0;
00152     <a class="code" href="../../d2/d1/struct__PROPSET.html">PPROPSET</a> pPropSetLast = (aPropSet + cPropMax - 1);
00153     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
00154 
00155     <span class="comment">/*</span>
00156 <span class="comment">     * If the Window does not have a property list then we're done</span>
00157 <span class="comment">     */</span>
00158     ppropList = pwnd-&gt;<a class="code" href="../../d6/d9/structtagWND.html#o13">ppropList</a>;
00159     <span class="keywordflow">if</span> (ppropList == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00160         *pcPropNeeded = 0;
00161         <span class="keywordflow">return</span> STATUS_SUCCESS;
00162     }
00163 
00164     <span class="comment">/*</span>
00165 <span class="comment">     * For each element in the property list enumerate it.</span>
00166 <span class="comment">     * (only if it is not internal!)</span>
00167 <span class="comment">     */</span>
00168     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = STATUS_SUCCESS;
00169     pProp = ppropList-&gt;<a class="code" href="../../d5/d4/structtagPROPLIST.html#o2">aprop</a>;
00170     <span class="keywordflow">for</span> (i = ppropList-&gt;<a class="code" href="../../d5/d4/structtagPROPLIST.html#o1">iFirstFree</a>; i &gt; 0; i--) {
00171 
00172         <span class="comment">/*</span>
00173 <span class="comment">         * if we run out of space in shared memory return</span>
00174 <span class="comment">         * STATUS_BUFFER_TOO_SMALL</span>
00175 <span class="comment">         */</span>
00176         <span class="keywordflow">if</span> (&amp;aPropSet[iProp] &gt; pPropSetLast) {
00177 
00178             <span class="comment">/*</span>
00179 <span class="comment">             * Reset to the beginning of the output</span>
00180 <span class="comment">             * buffer so we can continue and compute</span>
00181 <span class="comment">             * the needed space.</span>
00182 <span class="comment">             */</span>
00183             iProp = 0;
00184             <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = STATUS_BUFFER_TOO_SMALL;
00185         }
00186 
00187         <span class="keywordflow">if</span> (!(pProp-&gt;<a class="code" href="../../d1/d4/structtagPROP.html#o2">fs</a> &amp; <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a498">PROPF_INTERNAL</a>)) {
00188             aPropSet[iProp].<a class="code" href="../../d2/d1/struct__PROPSET.html#o0">hData</a> = pProp-&gt;<a class="code" href="../../d1/d4/structtagPROP.html#o0">hData</a>;
00189             aPropSet[iProp].<a class="code" href="../../d2/d1/struct__PROPSET.html#o1">atom</a> = pProp-&gt;<a class="code" href="../../d1/d4/structtagPROP.html#o1">atomKey</a>;
00190             iProp++;
00191             iRetCnt++;
00192         }
00193         pProp++;
00194     }
00195 
00196     <span class="comment">/*</span>
00197 <span class="comment">     * Return the number of PROPLISTs given back to the client</span>
00198 <span class="comment">     */</span>
00199 
00200     *pcPropNeeded = iRetCnt;
00201 
00202     <span class="keywordflow">return</span> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
00203 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="kernel/winprop.c::CreateProp" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d1/d4/structtagPROP.html">PPROP</a> CreateProp           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d6/d9/structtagWND.html">PWND</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>pwnd</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d7/kernel_2winprop_8c-source.html#l00217">217</a> of file <a class="el" href="../../d5/d7/kernel_2winprop_8c-source.html">kernel/winprop.c</a>.
<p>
References <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l01815">tagPROPLIST::aprop</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l01813">tagPROPLIST::cEntries</a>, <a class="el" href="../../d0/d6/desktop_8c-source.html#l00047">DesktopAlloc()</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l02697">DesktopFree</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l02633">DTAG_PROPLIST</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l01827">tagWND::head</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l01814">tagPROPLIST::iFirstFree</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l01847">tagWND::ppropList</a>, <a class="el" href="../../d0/d0/client_2nt6_2user_8h.html#a1045">PROP</a>, and <a class="el" href="../../d0/d0/client_2nt6_2user_8h.html#a1047">PROPLIST</a>.
<p>
Referenced by <a class="el" href="../../d5/d7/kernel_2winprop_8c-source.html#l00039">InternalSetProp()</a>.
<p>
<pre class="fragment"><div>00219 {
00220     <a class="code" href="../../d5/d4/structtagPROPLIST.html">PPROPLIST</a> ppropList;
00221     <a class="code" href="../../d1/d4/structtagPROP.html">PPROP</a> pprop;
00222 
00223     <span class="keywordflow">if</span> (pwnd-&gt;<a class="code" href="../../d6/d9/structtagWND.html#o13">ppropList</a> == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00224         pwnd-&gt;<a class="code" href="../../d6/d9/structtagWND.html#o13">ppropList</a> = (<a class="code" href="../../d5/d4/structtagPROPLIST.html">PPROPLIST</a>)<a class="code" href="../../d4/d1/userk_8h.html#a1020">DesktopAlloc</a>(pwnd-&gt;<a class="code" href="../../d6/d9/structtagWND.html#o0">head</a>.rpdesk,
00225                                                   <span class="keyword">sizeof</span>(<a class="code" href="../../d5/d4/structtagPROPLIST.html">PROPLIST</a>),
00226                                                   DTAG_PROPLIST);
00227         <span class="keywordflow">if</span> (pwnd-&gt;<a class="code" href="../../d6/d9/structtagWND.html#o13">ppropList</a> == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00228             <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00229         }
00230         pwnd-&gt;<a class="code" href="../../d6/d9/structtagWND.html#o13">ppropList</a>-&gt;<a class="code" href="../../d5/d4/structtagPROPLIST.html#o0">cEntries</a> = 1;
00231     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pwnd-&gt;<a class="code" href="../../d6/d9/structtagWND.html#o13">ppropList</a>-&gt;<a class="code" href="../../d5/d4/structtagPROPLIST.html#o1">iFirstFree</a> == pwnd-&gt;<a class="code" href="../../d6/d9/structtagWND.html#o13">ppropList</a>-&gt;<a class="code" href="../../d5/d4/structtagPROPLIST.html#o0">cEntries</a>) {
00232         ppropList = (<a class="code" href="../../d5/d4/structtagPROPLIST.html">PPROPLIST</a>)<a class="code" href="../../d4/d1/userk_8h.html#a1020">DesktopAlloc</a>(pwnd-&gt;<a class="code" href="../../d6/d9/structtagWND.html#o0">head</a>.rpdesk,
00233                                             <span class="keyword">sizeof</span>(<a class="code" href="../../d5/d4/structtagPROPLIST.html">PROPLIST</a>) + pwnd-&gt;<a class="code" href="../../d6/d9/structtagWND.html#o13">ppropList</a>-&gt;<a class="code" href="../../d5/d4/structtagPROPLIST.html#o0">cEntries</a> * <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d4/structtagPROP.html">PROP</a>),
00234                                             DTAG_PROPLIST);
00235         <span class="keywordflow">if</span> (ppropList == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00236             <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00237         }
00238         RtlCopyMemory(ppropList, pwnd-&gt;<a class="code" href="../../d6/d9/structtagWND.html#o13">ppropList</a>, <span class="keyword">sizeof</span>(<a class="code" href="../../d5/d4/structtagPROPLIST.html">PROPLIST</a>) + (pwnd-&gt;<a class="code" href="../../d6/d9/structtagWND.html#o13">ppropList</a>-&gt;<a class="code" href="../../d5/d4/structtagPROPLIST.html#o0">cEntries</a> - 1) * <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d4/structtagPROP.html">PROP</a>));
00239         <a class="code" href="../../d4/d1/userk_8h.html#a313">DesktopFree</a>(pwnd-&gt;<a class="code" href="../../d6/d9/structtagWND.html#o0">head</a>.rpdesk, pwnd-&gt;<a class="code" href="../../d6/d9/structtagWND.html#o13">ppropList</a>);
00240         pwnd-&gt;<a class="code" href="../../d6/d9/structtagWND.html#o13">ppropList</a> = ppropList;
00241         pwnd-&gt;<a class="code" href="../../d6/d9/structtagWND.html#o13">ppropList</a>-&gt;<a class="code" href="../../d5/d4/structtagPROPLIST.html#o0">cEntries</a>++;
00242     }
00243     pprop = &amp;pwnd-&gt;<a class="code" href="../../d6/d9/structtagWND.html#o13">ppropList</a>-&gt;<a class="code" href="../../d5/d4/structtagPROPLIST.html#o2">aprop</a>[pwnd-&gt;<a class="code" href="../../d6/d9/structtagWND.html#o13">ppropList</a>-&gt;<a class="code" href="../../d5/d4/structtagPROPLIST.html#o1">iFirstFree</a>];
00244     pwnd-&gt;<a class="code" href="../../d6/d9/structtagWND.html#o13">ppropList</a>-&gt;<a class="code" href="../../d5/d4/structtagPROPLIST.html#o1">iFirstFree</a>++;
00245 
00246     <span class="keywordflow">return</span> pprop;
00247 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a4" doxytag="kernel/winprop.c::DeleteProperties" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void DeleteProperties           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d6/d9/structtagWND.html">PWND</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>pwnd</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d7/kernel_2winprop_8c-source.html#l00265">265</a> of file <a class="el" href="../../d5/d7/kernel_2winprop_8c-source.html">kernel/winprop.c</a>.
<p>
References <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l01815">tagPROPLIST::aprop</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l02697">DesktopFree</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l01801">tagPROP::fs</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01717">tagPROP::hData</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l01827">tagWND::head</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l01814">tagPROPLIST::iFirstFree</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l01847">tagWND::ppropList</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01722">PROPF_INTERNAL</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01724">PROPF_NOPOOL</a>, and <a class="el" href="../../d0/d5/ndismain_8h-source.html#l00026">UINT</a>.
<p>
Referenced by <a class="el" href="../../d5/d7/createw_8c-source.html#l02218">xxxFreeWindow()</a>.
<p>
<pre class="fragment"><div>00267 {
00268     <a class="code" href="../../d1/d4/structtagPROP.html">PPROP</a> pprop;
00269     <a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a> i;
00270 
00271     UserAssert(pwnd-&gt;<a class="code" href="../../d6/d9/structtagWND.html#o13">ppropList</a>);
00272 
00273     <span class="comment">/*</span>
00274 <span class="comment">     * Loop through the whole list of properties on this window.</span>
00275 <span class="comment">     */</span>
00276     pprop = pwnd-&gt;<a class="code" href="../../d6/d9/structtagWND.html#o13">ppropList</a>-&gt;<a class="code" href="../../d5/d4/structtagPROPLIST.html#o2">aprop</a>;
00277     <span class="keywordflow">for</span> (i = pwnd-&gt;<a class="code" href="../../d6/d9/structtagWND.html#o13">ppropList</a>-&gt;<a class="code" href="../../d5/d4/structtagPROPLIST.html#o1">iFirstFree</a>; i &gt; 0; i--) {
00278 
00279         <span class="comment">/*</span>
00280 <span class="comment">         * Is this an internal property?  If so, free any data we allocated</span>
00281 <span class="comment">         * for it.</span>
00282 <span class="comment">         */</span>
00283         <span class="keywordflow">if</span> ((pprop-&gt;<a class="code" href="../../d1/d4/structtagPROP.html#o2">fs</a> &amp; <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a498">PROPF_INTERNAL</a>) &amp;&amp; !(pprop-&gt;<a class="code" href="../../d1/d4/structtagPROP.html#o2">fs</a> &amp; <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a500">PROPF_NOPOOL</a>)) {
00284                 UserFreePool(pprop-&gt;<a class="code" href="../../d1/d4/structtagPROP.html#o0">hData</a>);
00285         }
00286 
00287         <span class="comment">/*</span>
00288 <span class="comment">         * Advance to the next property in the list.</span>
00289 <span class="comment">         */</span>
00290         pprop++;
00291     }
00292 
00293     <span class="comment">/*</span>
00294 <span class="comment">     * All properties gone, free the property list and clear out the</span>
00295 <span class="comment">     * window's property list pointer.</span>
00296 <span class="comment">     */</span>
00297     <a class="code" href="../../d4/d1/userk_8h.html#a313">DesktopFree</a>(pwnd-&gt;<a class="code" href="../../d6/d9/structtagWND.html#o0">head</a>.rpdesk, pwnd-&gt;<a class="code" href="../../d6/d9/structtagWND.html#o13">ppropList</a>);
00298     pwnd-&gt;<a class="code" href="../../d6/d9/structtagWND.html#o13">ppropList</a> = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00299 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="kernel/winprop.c::InternalRemoveProp" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HANDLE InternalRemoveProp           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d6/d9/structtagWND.html">PWND</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pwnd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPWSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>pszKey</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>BOOL&nbsp;</td>
          <td class="mdname" nowrap> <em>fInternal</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d7/kernel_2winprop_8c-source.html#l00098">98</a> of file <a class="el" href="../../d5/d7/kernel_2winprop_8c-source.html">kernel/winprop.c</a>.
<p>
References <a class="el" href="../../d8/d7/rtl_2winprop_8c-source.html#l00046">_FindProp()</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l01815">tagPROPLIST::aprop</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01717">tagPROP::hData</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l01814">tagPROPLIST::iFirstFree</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, and <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l01847">tagWND::ppropList</a>.
<p>
Referenced by <a class="el" href="../../d6/d3/kernel_2ddetrack_8c-source.html#l02176">_DdeSetQualityOfService()</a>, <a class="el" href="../../d3/d9/kernel_2help_8c-source.html#l00022">_SetWindowContextHelpId()</a>, <a class="el" href="../../d9/d2/dwp_8c-source.html#l01067">DestroyWindowSmIcon()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l10107">MESSAGECALL()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l09202">NtUserRemoveProp()</a>, <a class="el" href="../../d9/d3/sprite_8c-source.html#l00207">RemoveRedirectionBitmap()</a>, <a class="el" href="../../d6/d3/kernel_2ddetrack_8c-source.html#l00264">UnlinkConv()</a>, <a class="el" href="../../d9/d2/dc_8c-source.html#l00415">UserAssociateHwnd()</a>, and <a class="el" href="../../d5/d7/createw_8c-source.html#l02218">xxxFreeWindow()</a>.
<p>
<pre class="fragment"><div>00102 {
00103     <a class="code" href="../../d1/d4/structtagPROP.html">PPROP</a> pprop;
00104     <a class="code" href="../../d1/d4/structtagPROP.html">PPROP</a> ppropLast;
00105     HANDLE hT;
00106 
00107     <span class="comment">/*</span>
00108 <span class="comment">     * Find the property to be removed.</span>
00109 <span class="comment">     */</span>
00110     pprop = <a class="code" href="../../d7/d8/rtl_2winprop_8c.html#a1">_FindProp</a>(pwnd, pszKey, fInternal);
00111     <span class="keywordflow">if</span> (pprop == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00112         <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00113 
00114     <span class="comment">/*</span>
00115 <span class="comment">     * Remember what it was pointing at.</span>
00116 <span class="comment">     */</span>
00117     hT = pprop-&gt;<a class="code" href="../../d1/d4/structtagPROP.html#o0">hData</a>;
00118 
00119     <span class="comment">/*</span>
00120 <span class="comment">     * Move the property at the end of the list into this slot.</span>
00121 <span class="comment">     */</span>
00122     pwnd-&gt;<a class="code" href="../../d6/d9/structtagWND.html#o13">ppropList</a>-&gt;<a class="code" href="../../d5/d4/structtagPROPLIST.html#o1">iFirstFree</a>--;
00123     ppropLast = &amp;pwnd-&gt;<a class="code" href="../../d6/d9/structtagWND.html#o13">ppropList</a>-&gt;<a class="code" href="../../d5/d4/structtagPROPLIST.html#o2">aprop</a>[pwnd-&gt;<a class="code" href="../../d6/d9/structtagWND.html#o13">ppropList</a>-&gt;<a class="code" href="../../d5/d4/structtagPROPLIST.html#o1">iFirstFree</a>];
00124     *pprop = *ppropLast;
00125     RtlZeroMemory(ppropLast, <span class="keyword">sizeof</span>(*ppropLast));
00126 
00127     <span class="keywordflow">return</span> hT;
00128 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a0" doxytag="kernel/winprop.c::InternalSetProp" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL InternalSetProp           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d6/d9/structtagWND.html">PWND</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pwnd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPWSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>pszKey</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HANDLE&nbsp;</td>
          <td class="mdname" nowrap> <em>hData</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>dwFlags</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d7/kernel_2winprop_8c-source.html#l00039">39</a> of file <a class="el" href="../../d5/d7/kernel_2winprop_8c-source.html">kernel/winprop.c</a>.
<p>
References <a class="el" href="../../d8/d7/rtl_2winprop_8c-source.html#l00046">_FindProp()</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l01800">tagPROP::atomKey</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d5/d7/kernel_2winprop_8c-source.html#l00217">CreateProp()</a>, <a class="el" href="../../d4/d7/propapi_8h-source.html#l00043">dwFlags</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l01801">tagPROP::fs</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01717">tagPROP::hData</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00410">IS_PTR</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01722">PROPF_INTERNAL</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00411">PTR_TO_ID</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d6/d3/kernel_2ddetrack_8c-source.html#l02176">_DdeSetQualityOfService()</a>, <a class="el" href="../../d3/d9/kernel_2help_8c-source.html#l00022">_SetWindowContextHelpId()</a>, <a class="el" href="../../d6/d3/kernel_2ddetrack_8c-source.html#l00217">AddConvProp()</a>, <a class="el" href="../../d9/d2/movesize_8c-source.html#l00335">CkptRestore()</a>, <a class="el" href="../../d9/d3/sprite_8c-source.html#l00054">CreateRedirectionBitmap()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l10107">MESSAGECALL()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l12887">NtUserSetAppImeLevel()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l09220">NtUserSetProp()</a>, <a class="el" href="../../d6/d3/kernel_2ddetrack_8c-source.html#l00264">UnlinkConv()</a>, <a class="el" href="../../d9/d2/dc_8c-source.html#l00415">UserAssociateHwnd()</a>, <a class="el" href="../../d9/d2/dwp_8c-source.html#l01223">xxxCreateWindowSmIcon()</a>, and <a class="el" href="../../d9/d2/dwp_8c-source.html#l01109">xxxDWP_SetIcon()</a>.
<p>
<pre class="fragment"><div>00044 {
00045     <a class="code" href="../../d1/d4/structtagPROP.html">PPROP</a> pprop;
00046 
00047     <span class="keywordflow">if</span> (pszKey == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00048         RIPERR0(ERROR_INVALID_PARAMETER,
00049                 RIP_WARNING,
00050                 <span class="stringliteral">"Invalid parameter \"pszKey\" (NULL) to InternalSetProp"</span>);
00051 
00052         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00053     }
00054 
00055     <span class="comment">/*</span>
00056 <span class="comment">     * If no property list exists for this window, create one.</span>
00057 <span class="comment">     */</span>
00058     pprop = <a class="code" href="../../d7/d8/rtl_2winprop_8c.html#a1">_FindProp</a>(pwnd, pszKey, dwFlags &amp; PROPF_INTERNAL);
00059     <span class="keywordflow">if</span> (pprop == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00060 
00061         <span class="comment">/*</span>
00062 <span class="comment">         * pszKey must be an atom within the server.</span>
00063 <span class="comment">         */</span>
00064         UserAssert(!<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a98">IS_PTR</a>(pszKey));
00065 
00066         <span class="comment">/*</span>
00067 <span class="comment">         * CreateProp allocates the property and links it into the window's</span>
00068 <span class="comment">         * property list.</span>
00069 <span class="comment">         */</span>
00070         pprop = <a class="code" href="../../d4/d8/kernel_2winprop_8c.html#a3">CreateProp</a>(pwnd);
00071         <span class="keywordflow">if</span> (pprop == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00072             <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00073 
00074         pprop-&gt;<a class="code" href="../../d1/d4/structtagPROP.html#o1">atomKey</a> = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a99">PTR_TO_ID</a>(pszKey);
00075         pprop-&gt;<a class="code" href="../../d1/d4/structtagPROP.html#o2">fs</a> = (WORD)<a class="code" href="../../d3/d8/propapi_8h.html#a34">dwFlags</a>;
00076     }
00077 
00078     pprop-&gt;<a class="code" href="../../d1/d4/structtagPROP.html#o0">hData</a> = hData;
00079 
00080     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00081 }
</div></pre>    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:46:09 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
