<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: xxflshtb.c File Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>xxflshtb.c File Reference</h1><code>#include "<a class="el" href="../../d1/d9/ki_8h-source.html">ki.h</a>"</code><br>

<p>
<a href="../../d5/d0/xxflshtb_8c-source.html">Go to the source code of this file.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/xxflshtb_8c.html#a0">KiFlushEntireTbTarget</a> (IN PULONG SignalDone, IN PVOID Parameter1, IN PVOID Parameter2, IN PVOID Parameter3)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/xxflshtb_8c.html#a1">KiFlushMultipleTbTarget</a> (IN PULONG SignalDone, IN PVOID Number, IN PVOID Virtual, IN PVOID Pid)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/xxflshtb_8c.html#a2">KiFlushSingleTbTarget</a> (IN PULONG SignalDone, IN PVOID Virtual, IN PVOID Pid, IN PVOID Parameter3)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/xxflshtb_8c.html#a3">KiFlushMultipleTbTarget64</a> (IN PULONG SignalDone, IN PVOID Number, IN PVOID Virtual, IN PVOID Pid)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/xxflshtb_8c.html#a4">KiFlushSingleTbTarget64</a> (IN PULONG SignalDone, IN PVOID Virtual, IN PVOID Pid, IN PVOID Parameter3)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/xxflshtb_8c.html#a5">KeFlushEntireTb</a> (IN BOOLEAN Invalid, IN BOOLEAN AllProcessors)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/xxflshtb_8c.html#a6">KeFlushMultipleTb</a> (IN ULONG Number, IN PVOID *Virtual, IN BOOLEAN Invalid, IN BOOLEAN AllProcessors, IN PHARDWARE_PTE *PtePointer OPTIONAL, IN HARDWARE_PTE PteValue)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/xxflshtb_8c.html#a7">KeFlushMultipleTb64</a> (IN ULONG Number, IN PULONG *Virtual, IN BOOLEAN Invalid, IN BOOLEAN AllProcessors, IN PHARDWARE_PTE *PtePointer OPTIONAL, IN HARDWARE_PTE PteValue)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HARDWARE_PTE&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/xxflshtb_8c.html#a8">KeFlushSingleTb</a> (IN PVOID Virtual, IN BOOLEAN Invalid, IN BOOLEAN AllProcessors, IN PHARDWARE_PTE PtePointer, IN HARDWARE_PTE PteValue)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HARDWARE_PTE&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/xxflshtb_8c.html#a9">KeFlushSingleTb64</a> (IN ULONG Virtual, IN BOOLEAN Invalid, IN BOOLEAN AllProcessors, IN PHARDWARE_PTE PtePointer, IN HARDWARE_PTE PteValue)</td></tr>

</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a5" doxytag="xxflshtb.c::KeFlushEntireTb" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID KeFlushEntireTb           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>Invalid</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>AllProcessors</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d0/xxflshtb_8c-source.html#l00074">74</a> of file <a class="el" href="../../d5/d0/xxflshtb_8c-source.html">xxflshtb.c</a>.
<p>
References <a class="el" href="../../d5/d8/ke_8h-source.html#l00747">_KPROCESS::ActiveProcessors</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00575">_KTHREAD::ApcState</a>, <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00087">DISPATCH_LEVEL</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l02766">KeActiveProcessors</a>, <a class="el" href="../../d4/d9/ke_8h.html#a374">KeFlushCurrentTb()</a>, <a class="el" href="../../d3/d6/alpha_2kdpcpu_8h-source.html#l00070">KeGetCurrentThread</a>, <a class="el" href="../../d9/d5/verifier_8c.html#a117">KeLowerIrql()</a>, <a class="el" href="../../d8/d4/alpha_2flushtb_8c-source.html#l00188">KiFlushEntireTbTarget()</a>, <a class="el" href="../../d0/d3/mpipi_8c-source.html#l00319">KiIpiSendPacket()</a>, <a class="el" href="../../d3/d0/xipi_8c-source.html#l00182">KiIpiStallOnPacketTargets()</a>, <a class="el" href="../../d1/d9/ki_8h-source.html#l00128">KiLockContextSwap</a>, <a class="el" href="../../d1/d9/ki_8h-source.html#l00131">KiUnlockContextSwap</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, and <a class="el" href="../../d5/d8/ke_8h-source.html#l00244">_KAPC_STATE::Process</a>.
<p>
<pre class="fragment"><div>00081                    :
00082 
00083     This function flushes <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> entire <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a46">translation</a> buffer (TB) on all
00084     processors that are currently running threads which are children
00085     of the current process or flushes the entire translation buffer
00086     on all processors in the host configuration.
00087 
00088 Arguments:
00089 
00090     Invalid - Supplies a <span class="keywordtype">boolean</span> value that specifies the reason for
00091         flushing the translation buffer.
00092 
00093     AllProcessors - Supplies a <span class="keywordtype">boolean</span> value that determines which
00094         translation buffers are to be flushed.
00095 
00096 Return Value:
00097 
00098     None.
00099 
00100 --*/
00101 
00102 {
00103 
00104     KIRQL OldIrql;
00105     <a class="code" href="../../d5/d7/struct__KPROCESS.html">PKPROCESS</a> Process;
00106     KAFFINITY TargetProcessors;
00107     <a class="code" href="../../d1/d8/struct__KTHREAD.html">PKTHREAD</a> Thread;
00108 
00109     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(KeGetCurrentIrql() &lt;= DISPATCH_LEVEL);
00110 
00111     <span class="comment">//</span>
00112     <span class="comment">// Compute the target set of processors, disable context switching,</span>
00113     <span class="comment">// and send the flush entire parameters to the target processors,</span>
00114     <span class="comment">// if any, for execution.</span>
00115     <span class="comment">//</span>
00116 
00117 <span class="preprocessor">#if defined(NT_UP)</span>
00118 <span class="preprocessor"></span>
00119     OldIrql = KeRaiseIrqlToSynchLevel();
00120 
00121 <span class="preprocessor">#else</span>
00122 <span class="preprocessor"></span>
00123     <span class="keywordflow">if</span> (AllProcessors != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
00124         OldIrql = KeRaiseIrqlToSynchLevel();
00125         TargetProcessors = <a class="code" href="../../d4/d9/ke_8h.html#a123">KeActiveProcessors</a>;
00126 
00127     } <span class="keywordflow">else</span> {
00128         Thread = <a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a3">KeGetCurrentThread</a>();
00129         Process = Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o14">ApcState</a>.<a class="code" href="../../d3/d5/struct__KAPC__STATE.html#o1">Process</a>;
00130         <a class="code" href="../../d0/d0/ki_8h.html#a11">KiLockContextSwap</a>(&amp;OldIrql);
00131         TargetProcessors = Process-&gt;<a class="code" href="../../d5/d7/struct__KPROCESS.html#o3">ActiveProcessors</a>;
00132     }
00133 
00134     TargetProcessors &amp;= PCR-&gt;NotMember;
00135     <span class="keywordflow">if</span> (TargetProcessors != 0) {
00136         <a class="code" href="../../d0/d0/ki_8h.html#a91">KiIpiSendPacket</a>(TargetProcessors,
00137                         KiFlushEntireTbTarget,
00138                         NULL,
00139                         NULL,
00140                         NULL);
00141     }
00142 
00143 <span class="preprocessor">#endif</span>
00144 <span class="preprocessor"></span>
00145     <span class="comment">//</span>
00146     <span class="comment">// Flush TB on current processor.</span>
00147     <span class="comment">//</span>
00148 
00149     <a class="code" href="../../d4/d9/ke_8h.html#a374">KeFlushCurrentTb</a>();
00150 
00151     <span class="comment">//</span>
00152     <span class="comment">// Wait until all target processors have finished.</span>
00153     <span class="comment">//</span>
00154 
00155 <span class="preprocessor">#if defined(NT_UP)</span>
00156 <span class="preprocessor"></span>
00157     <a class="code" href="../../d9/d5/verifier_8c.html#a117">KeLowerIrql</a>(OldIrql);
00158 
00159 <span class="preprocessor">#else</span>
00160 <span class="preprocessor"></span>
00161     <span class="keywordflow">if</span> (TargetProcessors != 0) {
00162         <a class="code" href="../../d2/d1/xipi_8c.html#a2">KiIpiStallOnPacketTargets</a>();
00163     }
00164 
00165     <span class="keywordflow">if</span> (AllProcessors != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
00166         <a class="code" href="../../d9/d5/verifier_8c.html#a117">KeLowerIrql</a>(OldIrql);
00167 
00168     } <span class="keywordflow">else</span> {
00169         <a class="code" href="../../d0/d0/ki_8h.html#a12">KiUnlockContextSwap</a>(OldIrql);
00170     }
00171 
00172 <span class="preprocessor">#endif</span>
00173 <span class="preprocessor"></span>
00174     <span class="keywordflow">return</span>;
00175 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a6" doxytag="xxflshtb.c::KeFlushMultipleTb" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID KeFlushMultipleTb           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Number</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PVOID *&nbsp;</td>
          <td class="mdname" nowrap> <em>Virtual</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>Invalid</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>AllProcessors</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PHARDWARE_PTE *PtePointer&nbsp;</td>
          <td class="mdname" nowrap> <em>OPTIONAL</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN HARDWARE_PTE&nbsp;</td>
          <td class="mdname" nowrap> <em>PteValue</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d0/xxflshtb_8c-source.html#l00222">222</a> of file <a class="el" href="../../d5/d0/xxflshtb_8c-source.html">xxflshtb.c</a>.
<p>
References <a class="el" href="../../d5/d8/ke_8h-source.html#l00747">_KPROCESS::ActiveProcessors</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00575">_KTHREAD::ApcState</a>, <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00087">DISPATCH_LEVEL</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d2/d9/cmchek_8c-source.html#l00095">Index</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l02766">KeActiveProcessors</a>, <a class="el" href="../../d3/d6/alpha_2kdpcpu_8h-source.html#l00070">KeGetCurrentThread</a>, <a class="el" href="../../d9/d5/verifier_8c.html#a117">KeLowerIrql()</a>, <a class="el" href="../../d0/d0/ki_8h.html#a115">KiFlushMultipleTb()</a>, <a class="el" href="../../d8/d4/alpha_2flushtb_8c-source.html#l00353">KiFlushMultipleTbTarget()</a>, <a class="el" href="../../d0/d3/mpipi_8c-source.html#l00319">KiIpiSendPacket()</a>, <a class="el" href="../../d3/d0/xipi_8c-source.html#l00182">KiIpiStallOnPacketTargets()</a>, <a class="el" href="../../d1/d9/ki_8h-source.html#l00128">KiLockContextSwap</a>, <a class="el" href="../../d1/d9/ki_8h-source.html#l00131">KiUnlockContextSwap</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00244">_KAPC_STATE::Process</a>, and <a class="el" href="../../d6/d8/alpha_2exdsptch_8c-source.html#l00105">Virtual</a>.
<p>
<pre class="fragment"><div>00233                    :
00234 
00235     This function flushes multiple entries from <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a46">translation</a> buffer
00236     on all processors that are currently running threads which are
00237     children of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> current process or flushes a multiple entries from
00238     <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a46">translation</a> buffer on all processors in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> host configuration.
00239 
00240 Arguments:
00241 
00242     Number - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> number of TB entries to flush.
00243 
00244     <a class="code" href="../../d5/d9/alpha_2exdsptch_8c.html#a2">Virtual</a> - Supplies a pointer to an array of <span class="keyword">virtual</span> addresses that
00245         are within <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> pages whose <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a46">translation</a> buffer entries are to be
00246         flushed.
00247 
00248     Invalid - Supplies a <span class="keywordtype">boolean</span> value that specifies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a10">reason</a> <span class="keywordflow">for</span>
00249         flushing <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a46">translation</a> buffer.
00250 
00251     AllProcessors - Supplies a <span class="keywordtype">boolean</span> value that determines which
00252         <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a46">translation</a> buffers are to be flushed.
00253 
00254     PtePointer - Supplies an optional pointer to an array of pointers to
00255        page table entries that receive <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified page table entry
00256        value.
00257 
00258     PteValue - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <span class="keyword">new</span> page table entry value.
00259 
00260 Return Value:
00261 
00262     The previous contents of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified page table entry <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned
00263     as <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> function value.
00264 
00265 --*/
00266 
00267 {
00268 
00269     ULONG <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>;
00270     KIRQL OldIrql;
00271     <a class="code" href="../../d5/d7/struct__KPROCESS.html">PKPROCESS</a> Process;
00272     KAFFINITY TargetProcessors;
00273     <a class="code" href="../../d1/d8/struct__KTHREAD.html">PKTHREAD</a> Thread;
00274 
00275     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(KeGetCurrentIrql() == DISPATCH_LEVEL);
00276     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(Number &lt;= FLUSH_MULTIPLE_MAXIMUM);
00277 
00278     <span class="comment">//</span>
00279     <span class="comment">// Compute the target set of processors.</span>
00280     <span class="comment">//</span>
00281 
00282 <span class="preprocessor">#if !defined(NT_UP)</span>
00283 <span class="preprocessor"></span>
00284     <span class="keywordflow">if</span> (AllProcessors != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
00285         OldIrql = KeRaiseIrqlToSynchLevel();
00286         TargetProcessors = <a class="code" href="../../d4/d9/ke_8h.html#a123">KeActiveProcessors</a>;
00287 
00288     } <span class="keywordflow">else</span> {
00289         Thread = <a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a3">KeGetCurrentThread</a>();
00290         Process = Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o14">ApcState</a>.<a class="code" href="../../d3/d5/struct__KAPC__STATE.html#o1">Process</a>;
00291         <a class="code" href="../../d0/d0/ki_8h.html#a11">KiLockContextSwap</a>(&amp;OldIrql);
00292         TargetProcessors = Process-&gt;<a class="code" href="../../d5/d7/struct__KPROCESS.html#o3">ActiveProcessors</a>;
00293     }
00294 
00295     TargetProcessors &amp;= PCR-&gt;NotMember;
00296 
00297 <span class="preprocessor">#endif</span>
00298 <span class="preprocessor"></span>
00299     <span class="comment">//</span>
00300     <span class="comment">// If a page table entry address array is specified, then set the</span>
00301     <span class="comment">// specified page table entries to the specific value.</span>
00302     <span class="comment">//</span>
00303 
00304     <span class="keywordflow">if</span> (ARGUMENT_PRESENT(PtePointer)) {
00305         <span class="keywordflow">for</span> (<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> = 0; <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> &lt; Number; <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> += 1) {
00306             *PtePointer[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>] = PteValue;
00307         }
00308     }
00309 
00310     <span class="comment">//</span>
00311     <span class="comment">// If any target processors are specified, then send a flush multiple</span>
00312     <span class="comment">// packet to the target set of processor.</span>
00313     <span class="comment">//</span>
00314 
00315 <span class="preprocessor">#if !defined(NT_UP)</span>
00316 <span class="preprocessor"></span>
00317     <span class="keywordflow">if</span> (TargetProcessors != 0) {
00318         <a class="code" href="../../d0/d0/ki_8h.html#a91">KiIpiSendPacket</a>(TargetProcessors,
00319                         KiFlushMultipleTbTarget,
00320                         (PVOID)Number,
00321                         (PVOID)Virtual,
00322                         NULL);
00323     }
00324 
00325 <span class="preprocessor">#endif</span>
00326 <span class="preprocessor"></span>
00327     <span class="comment">//</span>
00328     <span class="comment">// Flush the specified entries from the TB on the current processor.</span>
00329     <span class="comment">//</span>
00330 
00331     <a class="code" href="../../d0/d0/ki_8h.html#a115">KiFlushMultipleTb</a>(Invalid, &amp;Virtual[0], Number);
00332 
00333     <span class="comment">//</span>
00334     <span class="comment">// Wait until all target processors have finished.</span>
00335     <span class="comment">//</span>
00336 
00337 <span class="preprocessor">#if !defined(NT_UP)</span>
00338 <span class="preprocessor"></span>
00339     <span class="keywordflow">if</span> (TargetProcessors != 0) {
00340         <a class="code" href="../../d2/d1/xipi_8c.html#a2">KiIpiStallOnPacketTargets</a>();
00341     }
00342 
00343     <span class="keywordflow">if</span> (AllProcessors != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
00344         <a class="code" href="../../d9/d5/verifier_8c.html#a117">KeLowerIrql</a>(OldIrql);
00345 
00346     } <span class="keywordflow">else</span> {
00347         <a class="code" href="../../d0/d0/ki_8h.html#a12">KiUnlockContextSwap</a>(OldIrql);
00348     }
00349 
00350 <span class="preprocessor">#endif</span>
00351 <span class="preprocessor"></span>
00352     <span class="keywordflow">return</span>;
00353 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a7" doxytag="xxflshtb.c::KeFlushMultipleTb64" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID KeFlushMultipleTb64           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Number</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PULONG *&nbsp;</td>
          <td class="mdname" nowrap> <em>Virtual</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>Invalid</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>AllProcessors</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PHARDWARE_PTE *PtePointer&nbsp;</td>
          <td class="mdname" nowrap> <em>OPTIONAL</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN HARDWARE_PTE&nbsp;</td>
          <td class="mdname" nowrap> <em>PteValue</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d0/xxflshtb_8c-source.html#l00422">422</a> of file <a class="el" href="../../d5/d0/xxflshtb_8c-source.html">xxflshtb.c</a>.
<p>
References <a class="el" href="../../d5/d8/ke_8h-source.html#l00747">_KPROCESS::ActiveProcessors</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00575">_KTHREAD::ApcState</a>, <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00087">DISPATCH_LEVEL</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d2/d9/cmchek_8c-source.html#l00095">Index</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l02766">KeActiveProcessors</a>, <a class="el" href="../../d3/d6/alpha_2kdpcpu_8h-source.html#l00070">KeGetCurrentThread</a>, <a class="el" href="../../d9/d5/verifier_8c.html#a117">KeLowerIrql()</a>, <a class="el" href="../../d8/d4/alpha_2flushtb_8c-source.html#l00733">KiFlushMultipleTbTarget64()</a>, <a class="el" href="../../d0/d3/mpipi_8c-source.html#l00319">KiIpiSendPacket()</a>, <a class="el" href="../../d3/d0/xipi_8c-source.html#l00182">KiIpiStallOnPacketTargets()</a>, <a class="el" href="../../d1/d9/ki_8h-source.html#l00128">KiLockContextSwap</a>, <a class="el" href="../../d1/d9/ki_8h-source.html#l00131">KiUnlockContextSwap</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00244">_KAPC_STATE::Process</a>, and <a class="el" href="../../d6/d8/alpha_2exdsptch_8c-source.html#l00105">Virtual</a>.
<p>
<pre class="fragment"><div>00433                    :
00434 
00435     This function flushes multiple entries from <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a46">translation</a> buffer
00436     on all processors that are currently running threads which are
00437     children of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> current process or flushes a multiple entries from
00438     <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a46">translation</a> buffer on all processors in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> host configuration.
00439 
00440 Arguments:
00441 
00442     Number - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> number of TB entries to flush.
00443 
00444     <a class="code" href="../../d5/d9/alpha_2exdsptch_8c.html#a2">Virtual</a> - Supplies a pointer to an array of <span class="keyword">virtual</span> page numbers that
00445         are flushed from <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> TB.
00446 
00447     Invalid - Supplies a <span class="keywordtype">boolean</span> value that specifies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a10">reason</a> <span class="keywordflow">for</span>
00448         flushing <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a46">translation</a> buffer.
00449 
00450     AllProcessors - Supplies a <span class="keywordtype">boolean</span> value that determines which
00451         <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a46">translation</a> buffers are to be flushed.
00452 
00453     PtePointer - Supplies an optional pointer to an array of pointers to
00454        page table entries that receive <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified page table entry
00455        value.
00456 
00457     PteValue - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <span class="keyword">new</span> page table entry value.
00458 
00459 Return Value:
00460 
00461     The previous contents of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified page table entry <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned
00462     as <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> function value.
00463 
00464 --*/
00465 
00466 {
00467 
00468     ULONG <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>;
00469     KIRQL OldIrql;
00470     <a class="code" href="../../d5/d7/struct__KPROCESS.html">PKPROCESS</a> Process;
00471     KAFFINITY TargetProcessors;
00472     <a class="code" href="../../d1/d8/struct__KTHREAD.html">PKTHREAD</a> Thread;
00473 
00474     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(KeGetCurrentIrql() == DISPATCH_LEVEL);
00475     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(Number &lt;= FLUSH_MULTIPLE_MAXIMUM);
00476 
00477     <span class="comment">//</span>
00478     <span class="comment">// Compute the target set of processors.</span>
00479     <span class="comment">//</span>
00480 
00481 <span class="preprocessor">#if !defined(NT_UP)</span>
00482 <span class="preprocessor"></span>
00483     <span class="keywordflow">if</span> (AllProcessors != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
00484         OldIrql = KeRaiseIrqlToSynchLevel();
00485         TargetProcessors = <a class="code" href="../../d4/d9/ke_8h.html#a123">KeActiveProcessors</a>;
00486 
00487     } <span class="keywordflow">else</span> {
00488         Thread = <a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a3">KeGetCurrentThread</a>();
00489         Process = Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o14">ApcState</a>.<a class="code" href="../../d3/d5/struct__KAPC__STATE.html#o1">Process</a>;
00490         <a class="code" href="../../d0/d0/ki_8h.html#a11">KiLockContextSwap</a>(&amp;OldIrql);
00491         TargetProcessors = Process-&gt;<a class="code" href="../../d5/d7/struct__KPROCESS.html#o3">ActiveProcessors</a>;
00492     }
00493 
00494     TargetProcessors &amp;= PCR-&gt;NotMember;
00495 
00496 <span class="preprocessor">#endif</span>
00497 <span class="preprocessor"></span>
00498     <span class="comment">//</span>
00499     <span class="comment">// If a page table entry address array is specified, then set the</span>
00500     <span class="comment">// specified page table entries to the specific value.</span>
00501     <span class="comment">//</span>
00502 
00503     <span class="keywordflow">if</span> (ARGUMENT_PRESENT(PtePointer)) {
00504         <span class="keywordflow">for</span> (<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> = 0; <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> &lt; Number; <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> += 1) {
00505             *PtePointer[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>] = PteValue;
00506         }
00507     }
00508 
00509     <span class="comment">//</span>
00510     <span class="comment">// If any target processors are specified, then send a flush multiple</span>
00511     <span class="comment">// packet to the target set of processor.</span>
00512     <span class="comment">//</span>
00513 
00514 <span class="preprocessor">#if !defined(NT_UP)</span>
00515 <span class="preprocessor"></span>
00516     <span class="keywordflow">if</span> (TargetProcessors != 0) {
00517         <a class="code" href="../../d0/d0/ki_8h.html#a91">KiIpiSendPacket</a>(TargetProcessors,
00518                         KiFlushMultipleTbTarget64,
00519                         (PVOID)Number,
00520                         (PVOID)Virtual,
00521                         NULL);
00522     }
00523 
00524 <span class="preprocessor">#endif</span>
00525 <span class="preprocessor"></span>
00526     <span class="comment">//</span>
00527     <span class="comment">// Flush the specified entries from the TB on the current processor.</span>
00528     <span class="comment">//</span>
00529 
00530     KiFlushMultipleTb64(Invalid, &amp;Virtual[0], Number);
00531 
00532     <span class="comment">//</span>
00533     <span class="comment">// Wait until all target processors have finished.</span>
00534     <span class="comment">//</span>
00535 
00536 <span class="preprocessor">#if !defined(NT_UP)</span>
00537 <span class="preprocessor"></span>
00538     <span class="keywordflow">if</span> (TargetProcessors != 0) {
00539         <a class="code" href="../../d2/d1/xipi_8c.html#a2">KiIpiStallOnPacketTargets</a>();
00540     }
00541 
00542     <span class="keywordflow">if</span> (AllProcessors != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
00543         <a class="code" href="../../d9/d5/verifier_8c.html#a117">KeLowerIrql</a>(OldIrql);
00544 
00545     } <span class="keywordflow">else</span> {
00546         <a class="code" href="../../d0/d0/ki_8h.html#a12">KiUnlockContextSwap</a>(OldIrql);
00547     }
00548 
00549 <span class="preprocessor">#endif</span>
00550 <span class="preprocessor"></span>
00551     <span class="keywordflow">return</span>;
00552 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a8" doxytag="xxflshtb.c::KeFlushSingleTb" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HARDWARE_PTE KeFlushSingleTb           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>Virtual</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>Invalid</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>AllProcessors</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PHARDWARE_PTE&nbsp;</td>
          <td class="mdname" nowrap> <em>PtePointer</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN HARDWARE_PTE&nbsp;</td>
          <td class="mdname" nowrap> <em>PteValue</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d0/xxflshtb_8c-source.html#l00620">620</a> of file <a class="el" href="../../d5/d0/xxflshtb_8c-source.html">xxflshtb.c</a>.
<p>
References <a class="el" href="../../d5/d8/ke_8h-source.html#l00747">_KPROCESS::ActiveProcessors</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00575">_KTHREAD::ApcState</a>, <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00087">DISPATCH_LEVEL</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l02766">KeActiveProcessors</a>, <a class="el" href="../../d3/d6/alpha_2kdpcpu_8h-source.html#l00070">KeGetCurrentThread</a>, <a class="el" href="../../d9/d5/verifier_8c.html#a117">KeLowerIrql()</a>, <a class="el" href="../../d0/d0/ki_8h.html#a114">KiFlushSingleTb()</a>, <a class="el" href="../../d8/d4/alpha_2flushtb_8c-source.html#l00535">KiFlushSingleTbTarget()</a>, <a class="el" href="../../d0/d3/mpipi_8c-source.html#l00319">KiIpiSendPacket()</a>, <a class="el" href="../../d3/d0/xipi_8c-source.html#l00182">KiIpiStallOnPacketTargets()</a>, <a class="el" href="../../d1/d9/ki_8h-source.html#l00128">KiLockContextSwap</a>, <a class="el" href="../../d1/d9/ki_8h-source.html#l00131">KiUnlockContextSwap</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00244">_KAPC_STATE::Process</a>, and <a class="el" href="../../d6/d8/alpha_2exdsptch_8c-source.html#l00105">Virtual</a>.
<p>
<pre class="fragment"><div>00630                    :
00631 
00632     This function flushes a single entry from <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a46">translation</a> buffer
00633     on all processors that are currently running threads which are
00634     children of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> current process or flushes a single entry from
00635     <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a46">translation</a> buffer on all processors in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> host configuration.
00636 
00637 Arguments:
00638 
00639     <a class="code" href="../../d5/d9/alpha_2exdsptch_8c.html#a2">Virtual</a> - Supplies a <span class="keyword">virtual</span> address that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> within <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> page whose
00640         <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a46">translation</a> buffer entry <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to be flushed.
00641 
00642     Invalid - Supplies a <span class="keywordtype">boolean</span> value that specifies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a10">reason</a> <span class="keywordflow">for</span>
00643         flushing <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a46">translation</a> buffer.
00644 
00645     AllProcessors - Supplies a <span class="keywordtype">boolean</span> value that determines which
00646         <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a46">translation</a> buffers are to be flushed.
00647 
00648     PtePointer - Supplies a pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> page table entry which
00649         receives <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified value.
00650 
00651     PteValue - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <span class="keyword">new</span> page table entry value.
00652 
00653 Return Value:
00654 
00655     The previous contents of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified page table entry <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned
00656     as <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> function value.
00657 
00658 --*/
00659 
00660 {
00661 
00662     KIRQL OldIrql;
00663     HARDWARE_PTE OldPte;
00664     <a class="code" href="../../d5/d7/struct__KPROCESS.html">PKPROCESS</a> Process;
00665     KAFFINITY TargetProcessors;
00666     <a class="code" href="../../d1/d8/struct__KTHREAD.html">PKTHREAD</a> Thread;
00667 
00668     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(KeGetCurrentIrql() == DISPATCH_LEVEL);
00669 
00670     <span class="comment">//</span>
00671     <span class="comment">// Compute the target set of processors.</span>
00672     <span class="comment">//</span>
00673 
00674 <span class="preprocessor">#if !defined(NT_UP)</span>
00675 <span class="preprocessor"></span>
00676     <span class="keywordflow">if</span> (AllProcessors != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
00677         OldIrql = KeRaiseIrqlToSynchLevel();
00678         TargetProcessors = <a class="code" href="../../d4/d9/ke_8h.html#a123">KeActiveProcessors</a>;
00679 
00680     } <span class="keywordflow">else</span> {
00681         Thread = <a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a3">KeGetCurrentThread</a>();
00682         Process = Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o14">ApcState</a>.<a class="code" href="../../d3/d5/struct__KAPC__STATE.html#o1">Process</a>;
00683         <a class="code" href="../../d0/d0/ki_8h.html#a11">KiLockContextSwap</a>(&amp;OldIrql);
00684         TargetProcessors = Process-&gt;<a class="code" href="../../d5/d7/struct__KPROCESS.html#o3">ActiveProcessors</a>;
00685     }
00686 
00687     TargetProcessors &amp;= PCR-&gt;NotMember;
00688 
00689 <span class="preprocessor">#endif</span>
00690 <span class="preprocessor"></span>
00691     <span class="comment">//</span>
00692     <span class="comment">// Capture the previous contents of the page table entry and set the</span>
00693     <span class="comment">// page table entry to the new value.</span>
00694     <span class="comment">//</span>
00695 
00696     OldPte = *PtePointer;
00697     *PtePointer = PteValue;
00698 
00699     <span class="comment">//</span>
00700     <span class="comment">// If any target processors are specified, then send a flush single</span>
00701     <span class="comment">// packet to the target set of processors.</span>
00702 
00703 <span class="preprocessor">#if !defined(NT_UP)</span>
00704 <span class="preprocessor"></span>
00705     <span class="keywordflow">if</span> (TargetProcessors != 0) {
00706         <a class="code" href="../../d0/d0/ki_8h.html#a91">KiIpiSendPacket</a>(TargetProcessors,
00707                         KiFlushSingleTbTarget,
00708                         (PVOID)Virtual,
00709                         NULL,
00710                         NULL);
00711     }
00712 
00713 <span class="preprocessor">#endif</span>
00714 <span class="preprocessor"></span>
00715     <span class="comment">//</span>
00716     <span class="comment">// Flush the specified entry from the TB on the current processor.</span>
00717     <span class="comment">//</span>
00718 
00719     <a class="code" href="../../d0/d0/ki_8h.html#a114">KiFlushSingleTb</a>(Invalid, Virtual);
00720 
00721     <span class="comment">//</span>
00722     <span class="comment">// Wait until all target processors have finished.</span>
00723     <span class="comment">//</span>
00724 
00725 <span class="preprocessor">#if !defined(NT_UP)</span>
00726 <span class="preprocessor"></span>
00727     <span class="keywordflow">if</span> (TargetProcessors != 0) {
00728         <a class="code" href="../../d2/d1/xipi_8c.html#a2">KiIpiStallOnPacketTargets</a>();
00729     }
00730 
00731     <span class="keywordflow">if</span> (AllProcessors != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
00732         <a class="code" href="../../d9/d5/verifier_8c.html#a117">KeLowerIrql</a>(OldIrql);
00733 
00734     } <span class="keywordflow">else</span> {
00735         <a class="code" href="../../d0/d0/ki_8h.html#a12">KiUnlockContextSwap</a>(OldIrql);
00736     }
00737 
00738 <span class="preprocessor">#endif</span>
00739 <span class="preprocessor"></span>
00740     <span class="keywordflow">return</span> OldPte;
00741 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a9" doxytag="xxflshtb.c::KeFlushSingleTb64" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HARDWARE_PTE KeFlushSingleTb64           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Virtual</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>Invalid</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>AllProcessors</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PHARDWARE_PTE&nbsp;</td>
          <td class="mdname" nowrap> <em>PtePointer</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN HARDWARE_PTE&nbsp;</td>
          <td class="mdname" nowrap> <em>PteValue</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d0/xxflshtb_8c-source.html#l00795">795</a> of file <a class="el" href="../../d5/d0/xxflshtb_8c-source.html">xxflshtb.c</a>.
<p>
References <a class="el" href="../../d5/d8/ke_8h-source.html#l00747">_KPROCESS::ActiveProcessors</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00575">_KTHREAD::ApcState</a>, <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00087">DISPATCH_LEVEL</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l02766">KeActiveProcessors</a>, <a class="el" href="../../d3/d6/alpha_2kdpcpu_8h-source.html#l00070">KeGetCurrentThread</a>, <a class="el" href="../../d9/d5/verifier_8c.html#a117">KeLowerIrql()</a>, <a class="el" href="../../d8/d4/alpha_2flushtb_8c-source.html#l00932">KiFlushSingleTbTarget64()</a>, <a class="el" href="../../d0/d3/mpipi_8c-source.html#l00319">KiIpiSendPacket()</a>, <a class="el" href="../../d3/d0/xipi_8c-source.html#l00182">KiIpiStallOnPacketTargets()</a>, <a class="el" href="../../d1/d9/ki_8h-source.html#l00128">KiLockContextSwap</a>, <a class="el" href="../../d1/d9/ki_8h-source.html#l00131">KiUnlockContextSwap</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00244">_KAPC_STATE::Process</a>, and <a class="el" href="../../d6/d8/alpha_2exdsptch_8c-source.html#l00105">Virtual</a>.
<p>
<pre class="fragment"><div>00805                    :
00806 
00807     This function flushes a single entry from <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a46">translation</a> buffer
00808     on all processors that are currently running threads which are
00809     children of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> current process or flushes a single entry from
00810     <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a46">translation</a> buffer on all processors in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> host configuration.
00811 
00812 Arguments:
00813 
00814     <a class="code" href="../../d5/d9/alpha_2exdsptch_8c.html#a2">Virtual</a> - Supplies a <span class="keyword">virtual</span> page number that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> flushed from <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> TB.
00815 
00816     Invalid - Supplies a <span class="keywordtype">boolean</span> value that specifies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a10">reason</a> <span class="keywordflow">for</span>
00817         flushing <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a46">translation</a> buffer.
00818 
00819     AllProcessors - Supplies a <span class="keywordtype">boolean</span> value that determines which
00820         <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a46">translation</a> buffers are to be flushed.
00821 
00822     PtePointer - Supplies a pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> page table entry which
00823         receives <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified value.
00824 
00825     PteValue - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <span class="keyword">new</span> page table entry value.
00826 
00827 Return Value:
00828 
00829     The previous contents of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified page table entry <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned
00830     as <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> function value.
00831 
00832 --*/
00833 
00834 {
00835 
00836     KIRQL OldIrql;
00837     HARDWARE_PTE OldPte;
00838     <a class="code" href="../../d5/d7/struct__KPROCESS.html">PKPROCESS</a> Process;
00839     KAFFINITY TargetProcessors;
00840     <a class="code" href="../../d1/d8/struct__KTHREAD.html">PKTHREAD</a> Thread;
00841 
00842     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(KeGetCurrentIrql() == DISPATCH_LEVEL);
00843 
00844     <span class="comment">//</span>
00845     <span class="comment">// Compute the target set of processors.</span>
00846     <span class="comment">//</span>
00847 
00848 <span class="preprocessor">#if !defined(NT_UP)</span>
00849 <span class="preprocessor"></span>
00850     <span class="keywordflow">if</span> (AllProcessors != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
00851         OldIrql = KeRaiseIrqlToSynchLevel();
00852         TargetProcessors = <a class="code" href="../../d4/d9/ke_8h.html#a123">KeActiveProcessors</a>;
00853 
00854     } <span class="keywordflow">else</span> {
00855         Thread = <a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a3">KeGetCurrentThread</a>();
00856         Process = Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o14">ApcState</a>.<a class="code" href="../../d3/d5/struct__KAPC__STATE.html#o1">Process</a>;
00857         <a class="code" href="../../d0/d0/ki_8h.html#a11">KiLockContextSwap</a>(&amp;OldIrql);
00858         TargetProcessors = Process-&gt;<a class="code" href="../../d5/d7/struct__KPROCESS.html#o3">ActiveProcessors</a>;
00859     }
00860 
00861     TargetProcessors &amp;= PCR-&gt;NotMember;
00862 
00863 <span class="preprocessor">#endif</span>
00864 <span class="preprocessor"></span>
00865     <span class="comment">//</span>
00866     <span class="comment">// Capture the previous contents of the page table entry and set the</span>
00867     <span class="comment">// page table entry to the new value.</span>
00868     <span class="comment">//</span>
00869 
00870     OldPte = *PtePointer;
00871     *PtePointer = PteValue;
00872 
00873     <span class="comment">//</span>
00874     <span class="comment">// If any target processors are specified, then send a flush single</span>
00875     <span class="comment">// packet to the target set of processors.</span>
00876 
00877 <span class="preprocessor">#if !defined(NT_UP)</span>
00878 <span class="preprocessor"></span>
00879     <span class="keywordflow">if</span> (TargetProcessors != 0) {
00880         <a class="code" href="../../d0/d0/ki_8h.html#a91">KiIpiSendPacket</a>(TargetProcessors,
00881                         KiFlushSingleTbTarget64,
00882                         (PVOID)Virtual,
00883                         NULL,
00884                         NULL);
00885     }
00886 
00887 <span class="preprocessor">#endif</span>
00888 <span class="preprocessor"></span>
00889     <span class="comment">//</span>
00890     <span class="comment">// Flush the specified entry from the TB on the current processor.</span>
00891     <span class="comment">//</span>
00892 
00893     KiFlushSingleTb64(Invalid, Virtual);
00894 
00895     <span class="comment">//</span>
00896     <span class="comment">// Wait until all target processors have finished.</span>
00897     <span class="comment">//</span>
00898 
00899 <span class="preprocessor">#if !defined(NT_UP)</span>
00900 <span class="preprocessor"></span>
00901     <span class="keywordflow">if</span> (TargetProcessors != 0) {
00902         <a class="code" href="../../d2/d1/xipi_8c.html#a2">KiIpiStallOnPacketTargets</a>();
00903     }
00904 
00905     <span class="keywordflow">if</span> (AllProcessors != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
00906         <a class="code" href="../../d9/d5/verifier_8c.html#a117">KeLowerIrql</a>(OldIrql);
00907 
00908     } <span class="keywordflow">else</span> {
00909         <a class="code" href="../../d0/d0/ki_8h.html#a12">KiUnlockContextSwap</a>(OldIrql);
00910     }
00911 
00912 <span class="preprocessor">#endif</span>
00913 <span class="preprocessor"></span>
00914     <span class="keywordflow">return</span> OldPte;
00915 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a0" doxytag="xxflshtb.c::KiFlushEntireTbTarget" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID KiFlushEntireTbTarget           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>SignalDone</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>Parameter1</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>Parameter2</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>Parameter3</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="xxflshtb.c::KiFlushMultipleTbTarget" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID KiFlushMultipleTbTarget           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>SignalDone</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>Number</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>Virtual</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>Pid</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d0/xxflshtb_8c-source.html#l00359">359</a> of file <a class="el" href="../../d5/d0/xxflshtb_8c-source.html">xxflshtb.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d2/d9/cmchek_8c-source.html#l00095">Index</a>, <a class="el" href="../../d0/d0/ki_8h.html#a115">KiFlushMultipleTb()</a>, <a class="el" href="../../d0/d0/ki_8h.html#a93">KiIpiSignalPacketDone()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, and <a class="el" href="../../d6/d8/alpha_2exdsptch_8c-source.html#l00105">Virtual</a>.
<p>
<pre class="fragment"><div>00368                    :
00369 
00370     This <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> target function <span class="keywordflow">for</span> flushing multiple TB entries.
00371 
00372 Arguments:
00373 
00374     SignalDone Supplies a pointer to a variable that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> cleared when <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00375         requested operation has been performed.
00376 
00377     Number - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> number of TB entries to flush.
00378 
00379     <a class="code" href="../../d5/d9/alpha_2exdsptch_8c.html#a2">Virtual</a> - Supplies a pointer to an array of <span class="keyword">virtual</span> addresses that
00380         are within <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> pages whose <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a46">translation</a> buffer entries are to be
00381         flushed.
00382 
00383     Pid - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> PID of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> TB entries to flush.
00384 
00385 Return Value:
00386 
00387     None.
00388 
00389 --*/
00390 
00391 {
00392 
00393     ULONG <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>;
00394     PVOID Array[FLUSH_MULTIPLE_MAXIMUM];
00395 
00396     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>((ULONG)Number &lt;= FLUSH_MULTIPLE_MAXIMUM);
00397 
00398     <span class="comment">//</span>
00399     <span class="comment">// Capture the virtual addresses that are to be flushed from the TB</span>
00400     <span class="comment">// on the current processor and clear the packet address.</span>
00401     <span class="comment">//</span>
00402 
00403     <span class="keywordflow">for</span> (<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> = 0; <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> &lt; (ULONG)Number; <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> += 1) {
00404         Array[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>] = ((PVOID *)(<a class="code" href="../../d5/d9/alpha_2exdsptch_8c.html#a2">Virtual</a>))[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>];
00405     }
00406 
00407     <a class="code" href="../../d0/d0/ki_8h.html#a93">KiIpiSignalPacketDone</a>(SignalDone);
00408 
00409     <span class="comment">//</span>
00410     <span class="comment">// Flush the specified virtual addresses from the TB on the current</span>
00411     <span class="comment">// processor.</span>
00412     <span class="comment">//</span>
00413 
00414     <a class="code" href="../../d0/d0/ki_8h.html#a115">KiFlushMultipleTb</a>(TRUE, &amp;Array[0], (ULONG)Number);
00415     <span class="keywordflow">return</span>;
00416 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="xxflshtb.c::KiFlushMultipleTbTarget64" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID KiFlushMultipleTbTarget64           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>SignalDone</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>Number</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>Virtual</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>Pid</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d0/xxflshtb_8c-source.html#l00558">558</a> of file <a class="el" href="../../d5/d0/xxflshtb_8c-source.html">xxflshtb.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d2/d9/cmchek_8c-source.html#l00095">Index</a>, <a class="el" href="../../d0/d0/ki_8h.html#a93">KiIpiSignalPacketDone()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, and <a class="el" href="../../d6/d8/alpha_2exdsptch_8c-source.html#l00105">Virtual</a>.
<p>
<pre class="fragment"><div>00567                    :
00568 
00569     This <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> target function <span class="keywordflow">for</span> flushing multiple TB entries.
00570 
00571 Arguments:
00572 
00573     SignalDone Supplies a pointer to a variable that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> cleared when <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00574         requested operation has been performed.
00575 
00576     Number - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> number of TB entries to flush.
00577 
00578     <a class="code" href="../../d5/d9/alpha_2exdsptch_8c.html#a2">Virtual</a> - Supplies a pointer to an array of <span class="keyword">virtual</span> page numbers that
00579         are flushed from <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> TB.
00580 
00581     Pid - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> PID of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> TB entries to flush.
00582 
00583 Return Value:
00584 
00585     None.
00586 
00587 --*/
00588 
00589 {
00590 
00591     ULONG <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>;
00592     PULONG Array[FLUSH_MULTIPLE_MAXIMUM];
00593 
00594     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>((ULONG)Number &lt;= FLUSH_MULTIPLE_MAXIMUM);
00595 
00596     <span class="comment">//</span>
00597     <span class="comment">// Capture the virtual addresses that are to be flushed from the TB</span>
00598     <span class="comment">// on the current processor and clear the packet address.</span>
00599     <span class="comment">//</span>
00600 
00601     <span class="keywordflow">for</span> (<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> = 0; <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> &lt; (ULONG)Number; <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> += 1) {
00602         Array[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>] = ((PULONG *)(<a class="code" href="../../d5/d9/alpha_2exdsptch_8c.html#a2">Virtual</a>))[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>];
00603     }
00604 
00605     <a class="code" href="../../d0/d0/ki_8h.html#a93">KiIpiSignalPacketDone</a>(SignalDone);
00606 
00607     <span class="comment">//</span>
00608     <span class="comment">// Flush the specified virtual addresses from the TB on the current</span>
00609     <span class="comment">// processor.</span>
00610     <span class="comment">//</span>
00611 
00612     KiFlushMultipleTb64(TRUE, &amp;Array[0], (ULONG)Number);
00613     <span class="keywordflow">return</span>;
00614 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a2" doxytag="xxflshtb.c::KiFlushSingleTbTarget" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID KiFlushSingleTbTarget           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>SignalDone</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>Virtual</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>Pid</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>Parameter3</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d0/xxflshtb_8c-source.html#l00747">747</a> of file <a class="el" href="../../d5/d0/xxflshtb_8c-source.html">xxflshtb.c</a>.
<p>
References <a class="el" href="../../d0/d0/ki_8h.html#a114">KiFlushSingleTb()</a>, <a class="el" href="../../d0/d0/ki_8h.html#a93">KiIpiSignalPacketDone()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, and <a class="el" href="../../d6/d8/alpha_2exdsptch_8c-source.html#l00105">Virtual</a>.
<p>
<pre class="fragment"><div>00756                    :
00757 
00758     This <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> target function <span class="keywordflow">for</span> flushing a single TB entry.
00759 
00760 Arguments:
00761 
00762     SignalDone Supplies a pointer to a variable that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> cleared when <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00763         requested operation has been performed.
00764 
00765     <a class="code" href="../../d5/d9/alpha_2exdsptch_8c.html#a2">Virtual</a> - Supplies a <span class="keyword">virtual</span> address that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> within <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> page whose
00766         <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a46">translation</a> buffer entry <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to be flushed.
00767 
00768     RequestPacket - Supplies a pointer to a flush single TB packet address.
00769 
00770     Pid - Not used.
00771 
00772     Parameter3 - Not used.
00773 
00774 Return Value:
00775 
00776     None.
00777 
00778 --*/
00779 
00780 {
00781 
00782     <span class="comment">//</span>
00783     <span class="comment">// Flush a single entry form the TB on the current processor.</span>
00784     <span class="comment">//</span>
00785 
00786     <a class="code" href="../../d0/d0/ki_8h.html#a93">KiIpiSignalPacketDone</a>(SignalDone);
00787     <a class="code" href="../../d0/d0/ki_8h.html#a114">KiFlushSingleTb</a>(TRUE, Virtual);
00788     <span class="keywordflow">return</span>;
00789 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a4" doxytag="xxflshtb.c::KiFlushSingleTbTarget64" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID KiFlushSingleTbTarget64           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>SignalDone</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>Virtual</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>Pid</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>Parameter3</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d0/xxflshtb_8c-source.html#l00921">921</a> of file <a class="el" href="../../d5/d0/xxflshtb_8c-source.html">xxflshtb.c</a>.
<p>
References <a class="el" href="../../d0/d0/ki_8h.html#a93">KiIpiSignalPacketDone()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, and <a class="el" href="../../d6/d8/alpha_2exdsptch_8c-source.html#l00105">Virtual</a>.
<p>
<pre class="fragment"><div>00930                    :
00931 
00932     This <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> target function <span class="keywordflow">for</span> flushing a single TB entry.
00933 
00934 Arguments:
00935 
00936     SignalDone Supplies a pointer to a variable that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> cleared when <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00937         requested operation has been performed.
00938 
00939     <a class="code" href="../../d5/d9/alpha_2exdsptch_8c.html#a2">Virtual</a> - Supplies a <span class="keyword">virtual</span> page number that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> flushed from <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> TB.
00940 
00941     RequestPacket - Supplies a pointer to a flush single TB packet address.
00942 
00943     Pid - Not used.
00944 
00945     Parameter3 - Not used.
00946 
00947 Return Value:
00948 
00949     None.
00950 
00951 --*/
00952 
00953 {
00954 
00955     <span class="comment">//</span>
00956     <span class="comment">// Flush a single entry form the TB on the current processor.</span>
00957     <span class="comment">//</span>
00958 
00959     <a class="code" href="../../d0/d0/ki_8h.html#a93">KiIpiSignalPacketDone</a>(SignalDone);
00960     KiFlushSingleTb64(TRUE, (ULONG)Virtual);
00961     <span class="keywordflow">return</span>;
00962 }

</div></pre>    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:46:11 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
