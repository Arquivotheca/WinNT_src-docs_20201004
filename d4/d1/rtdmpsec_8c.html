<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: rtdmpsec.c File Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>rtdmpsec.c File Reference</h1><code>#include "<a class="el" href="../../d2/d1/cmp_8h-source.html">cmp.h</a>"</code><br>
<code>#include &lt;stdio.h&gt;</code><br>
<code>#include &lt;stdlib.h&gt;</code><br>
<code>#include &lt;string.h&gt;</code><br>

<p>
<a href="../../d5/d0/rtdmpsec_8c-source.html">Go to the source code of this file.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Classes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d7/struct__KNOWN__ACE.html">_KNOWN_ACE</a></td></tr>

<tr><td colspan=2><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/rtdmpsec_8c.html#a0">WORK_SIZE</a>&nbsp;&nbsp;&nbsp;1024</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/rtdmpsec_8c.html#a1">FirstAce</a>(Acl)&nbsp;&nbsp;&nbsp;((PVOID)((PUCHAR)(Acl) + sizeof(ACL)))</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/rtdmpsec_8c.html#a2">NextAce</a>(Ace)&nbsp;&nbsp;&nbsp;((PVOID)((PUCHAR)(Ace) + ((PACE_HEADER)(Ace))-&gt;AceSize))</td></tr>

<tr><td colspan=2><br><h2>Typedefs</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d4/d7/struct__KNOWN__ACE.html">_KNOWN_ACE</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/rtdmpsec_8c.html#a3">KNOWN_ACE</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d4/d7/struct__KNOWN__ACE.html">_KNOWN_ACE</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/rtdmpsec_8c.html#a4">PKNOWN_ACE</a></td></tr>

<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/rtdmpsec_8c.html#a17">InitVars</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/rtdmpsec_8c.html#a18">PrintAcl</a> (IN PACL Acl)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/rtdmpsec_8c.html#a19">PrintAccessMask</a> (IN ACCESS_MASK AccessMask)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void __cdecl&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/rtdmpsec_8c.html#a20">main</a> (int, char *)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/rtdmpsec_8c.html#a21">processargs</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/rtdmpsec_8c.html#a22">print</a> (PUNICODE_STRING)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/rtdmpsec_8c.html#a23">DumpSecurity</a> (HANDLE <a class="el" href="../../d5/d6/w98_2lh__open_2pi__basic_8h.html#a29">Handle</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/rtdmpsec_8c.html#a24">Dump</a> (HANDLE <a class="el" href="../../d5/d6/w98_2lh__open_2pi__basic_8h.html#a29">Handle</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void __cdecl&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/rtdmpsec_8c.html#a25">main</a> (int argc, char *argv[])</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/rtdmpsec_8c.html#a26">processargs</a> (int argc, char *argv[])</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/rtdmpsec_8c.html#a27">SidTranslation</a> (PSID Sid, PSTRING AccountName)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/rtdmpsec_8c.html#a28">DisplayAccountSid</a> (PSID Sid)</td></tr>

<tr><td colspan=2><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>UNICODE_STRING&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/rtdmpsec_8c.html#a5">WorkName</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>WCHAR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/rtdmpsec_8c.html#a6">workbuffer</a> [WORK_SIZE]</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>PSID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/rtdmpsec_8c.html#a7">NullSid</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>PSID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/rtdmpsec_8c.html#a8">WorldSid</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>PSID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/rtdmpsec_8c.html#a9">LocalSid</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>PSID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/rtdmpsec_8c.html#a10">CreatorOwnerSid</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>PSID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/rtdmpsec_8c.html#a11">NtAuthoritySid</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>PSID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/rtdmpsec_8c.html#a12">DialupSid</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>PSID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/rtdmpsec_8c.html#a13">NetworkSid</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>PSID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/rtdmpsec_8c.html#a14">BatchSid</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>PSID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/rtdmpsec_8c.html#a15">InteractiveSid</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>PSID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/rtdmpsec_8c.html#a16">LocalSystemSid</a></td></tr>

</table>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="a1" doxytag="rtdmpsec.c::FirstAce" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define FirstAce          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">Acl&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;((PVOID)((PUCHAR)(Acl) + sizeof(ACL)))</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html#l00053">53</a> of file <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html">rtdmpsec.c</a>.
<p>
Referenced by <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l01139">DumpAcl()</a>, <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html#l00585">PrintAcl()</a>, <a class="el" href="../../d3/d3/acledit_8c-source.html#l00718">RtlAddAce()</a>, <a class="el" href="../../d3/d3/acledit_8c-source.html#l00895">RtlDeleteAce()</a>, <a class="el" href="../../d3/d3/acledit_8c-source.html#l02599">RtlFirstFreeAce()</a>, <a class="el" href="../../d3/d3/acledit_8c-source.html#l00996">RtlGetAce()</a>, <a class="el" href="../../d9/d5/sertl_8c-source.html#l03812">RtlpApplyAclToObject()</a>, <a class="el" href="../../d9/d5/sertl_8c-source.html#l07461">RtlpConvertAclToAutoInherit()</a>, <a class="el" href="../../d9/d5/sertl_8c-source.html#l04371">RtlpCopyAces()</a>, <a class="el" href="../../d9/d5/sertl_8c-source.html#l08588">RtlpCreateServerAcl()</a>, <a class="el" href="../../d9/d5/sertl_8c-source.html#l05722">RtlpGenerateInheritAcl()</a>, <a class="el" href="../../d9/d5/sertl_8c-source.html#l04716">RtlpInheritAcl2()</a>, <a class="el" href="../../d9/d5/sertl_8c-source.html#l08362">RtlpIsDuplicateAce()</a>, <a class="el" href="../../d1/d3/accessck_8c-source.html#l03871">SeFastTraverseCheck()</a>, <a class="el" href="../../d1/d3/accessck_8c-source.html#l01564">SepAccessCheck()</a>, <a class="el" href="../../d4/d4/seaudit_8c-source.html#l03952">SepExamineSacl()</a>, <a class="el" href="../../d4/d4/seaudit_8c-source.html#l04257">SepExamineSaclEx()</a>, <a class="el" href="../../d1/d3/accessck_8c-source.html#l00992">SepMaximumAccessCheck()</a>, <a class="el" href="../../d1/d3/accessck_8c-source.html#l01304">SepNormalAccessCheck()</a>, and <a class="el" href="../../d2/d4/seassign_8c-source.html#l00762">SepPrintAcl()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a2" doxytag="rtdmpsec.c::NextAce" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define NextAce          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">Ace&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;((PVOID)((PUCHAR)(Ace) + ((PACE_HEADER)(Ace))-&gt;AceSize))</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html#l00059">59</a> of file <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html">rtdmpsec.c</a>.
<p>
Referenced by <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l01139">DumpAcl()</a>, <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html#l00585">PrintAcl()</a>, <a class="el" href="../../d3/d3/acledit_8c-source.html#l00718">RtlAddAce()</a>, <a class="el" href="../../d3/d3/acledit_8c-source.html#l00895">RtlDeleteAce()</a>, <a class="el" href="../../d3/d3/acledit_8c-source.html#l02599">RtlFirstFreeAce()</a>, <a class="el" href="../../d3/d3/acledit_8c-source.html#l00996">RtlGetAce()</a>, <a class="el" href="../../d9/d5/sertl_8c-source.html#l03812">RtlpApplyAclToObject()</a>, <a class="el" href="../../d9/d5/sertl_8c-source.html#l07461">RtlpConvertAclToAutoInherit()</a>, <a class="el" href="../../d9/d5/sertl_8c-source.html#l04371">RtlpCopyAces()</a>, <a class="el" href="../../d9/d5/sertl_8c-source.html#l08588">RtlpCreateServerAcl()</a>, <a class="el" href="../../d9/d5/sertl_8c-source.html#l05722">RtlpGenerateInheritAcl()</a>, <a class="el" href="../../d9/d5/sertl_8c-source.html#l08362">RtlpIsDuplicateAce()</a>, <a class="el" href="../../d1/d3/accessck_8c-source.html#l03871">SeFastTraverseCheck()</a>, <a class="el" href="../../d1/d3/accessck_8c-source.html#l01564">SepAccessCheck()</a>, <a class="el" href="../../d4/d4/seaudit_8c-source.html#l03952">SepExamineSacl()</a>, <a class="el" href="../../d4/d4/seaudit_8c-source.html#l04257">SepExamineSaclEx()</a>, <a class="el" href="../../d1/d3/accessck_8c-source.html#l00992">SepMaximumAccessCheck()</a>, <a class="el" href="../../d1/d3/accessck_8c-source.html#l01304">SepNormalAccessCheck()</a>, and <a class="el" href="../../d2/d4/seassign_8c-source.html#l00762">SepPrintAcl()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a0" doxytag="rtdmpsec.c::WORK_SIZE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define WORK_SIZE&nbsp;&nbsp;&nbsp;1024          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html#l00047">47</a> of file <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html">rtdmpsec.c</a>.    </td>
  </tr>
</table>
<hr><h2>Typedef Documentation</h2>
<a class="anchor" name="a3" doxytag="rtdmpsec.c::KNOWN_ACE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d4/d7/struct__KNOWN__ACE.html">_KNOWN_ACE</a>  <a class="el" href="../../d4/d7/struct__KNOWN__ACE.html">KNOWN_ACE</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d9/d5/sertl_8c-source.html#l03880">RtlpCopyEffectiveAce()</a>, <a class="el" href="../../d9/d5/sertl_8c-source.html#l08588">RtlpCreateServerAcl()</a>, and <a class="el" href="../../d3/d3/acledit_8c-source.html#l00187">RtlValidAcl()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a4" doxytag="rtdmpsec.c::PKNOWN_ACE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d4/d7/struct__KNOWN__ACE.html">_KNOWN_ACE</a> * <a class="el" href="../../d4/d7/struct__KNOWN__ACE.html">PKNOWN_ACE</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html#l00585">PrintAcl()</a>, and <a class="el" href="../../d3/d3/acledit_8c-source.html#l00187">RtlValidAcl()</a>.    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a28" doxytag="rtdmpsec.c::DisplayAccountSid" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID DisplayAccountSid           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">PSID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Sid</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html#l00447">447</a> of file <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html">rtdmpsec.c</a>.
<p>
References <a class="el" href="../../d7/d1/rtqkey_8c-source.html#l00042">Buffer</a>, <a class="el" href="../../d9/d5/sertl_8c-source.html#l01253">RtlIdentifierAuthoritySid()</a>, <a class="el" href="../../d9/d5/sertl_8c-source.html#l01316">RtlSubAuthorityCountSid()</a>, <a class="el" href="../../d9/d5/sertl_8c-source.html#l01286">RtlSubAuthoritySid()</a>, <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html#l00390">SidTranslation()</a>, and <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00064">USHORT</a>.
<p>
<pre class="fragment"><div>00450 {
00451     UCHAR <a class="code" href="../../d6/d2/rtqkey_8c.html#a3">Buffer</a>[128];
00452     STRING AccountName;
00453     UCHAR i;
00454     ULONG Tmp;
00455     PSID_IDENTIFIER_AUTHORITY IdentifierAuthority;
00456     UCHAR SubAuthorityCount;
00457 
00458     <a class="code" href="../../d6/d2/rtqkey_8c.html#a3">Buffer</a>[0] = 0;
00459 
00460     AccountName.MaximumLength = 127;
00461     AccountName.Length = 0;
00462     AccountName.Buffer = (PVOID)&amp;<a class="code" href="../../d6/d2/rtqkey_8c.html#a3">Buffer</a>[0];
00463 
00464 
00465 
00466     <span class="keywordflow">if</span> (<a class="code" href="../../d1/d9/uipers_8c.html#a6">SidTranslation</a>( (PSID)Sid, &amp;AccountName) ) {
00467 
00468         printf(<span class="stringliteral">"%s\n"</span>, AccountName.Buffer );
00469 
00470     } <span class="keywordflow">else</span> {
00471         IdentifierAuthority = <a class="code" href="../../d8/d6/sertl_8c.html#a42">RtlIdentifierAuthoritySid</a>(Sid);
00472 
00473         <span class="comment">//</span>
00474         <span class="comment">// HACK! HACK!</span>
00475         <span class="comment">// The next line prints the revision of the SID.  Since there is no</span>
00476         <span class="comment">// rtl routine which gives us the SID revision, we must make due.</span>
00477         <span class="comment">// luckily, the revision field is the first field in the SID, so we</span>
00478         <span class="comment">// can just cast the pointer.</span>
00479         <span class="comment">//</span>
00480 
00481         printf(<span class="stringliteral">"S-%u-"</span>, (USHORT) *((PUCHAR) Sid) );
00482 
00483         <span class="keywordflow">if</span> (  (IdentifierAuthority-&gt;Value[0] != 0)  ||
00484               (IdentifierAuthority-&gt;Value[1] != 0)     ){
00485             printf(<span class="stringliteral">"0x%02hx%02hx%02hx%02hx%02hx%02hx"</span>,
00486                         IdentifierAuthority-&gt;Value[0],
00487                         IdentifierAuthority-&gt;Value[1],
00488                         IdentifierAuthority-&gt;Value[2],
00489                         IdentifierAuthority-&gt;Value[3],
00490                         IdentifierAuthority-&gt;Value[4],
00491                         IdentifierAuthority-&gt;Value[5] );
00492         } <span class="keywordflow">else</span> {
00493             Tmp = IdentifierAuthority-&gt;Value[5]          +
00494                   (IdentifierAuthority-&gt;Value[4] &lt;&lt;  8)  +
00495                   (IdentifierAuthority-&gt;Value[3] &lt;&lt; 16)  +
00496                   (IdentifierAuthority-&gt;Value[2] &lt;&lt; 24);
00497             printf(<span class="stringliteral">"%lu"</span>, Tmp);
00498         }
00499 
00500         SubAuthorityCount = *<a class="code" href="../../d8/d6/sertl_8c.html#a44">RtlSubAuthorityCountSid</a>(Sid);
00501         <span class="keywordflow">for</span> (i=0;i&lt;SubAuthorityCount ;i++ ) {
00502             printf(<span class="stringliteral">"-%lu"</span>, (*<a class="code" href="../../d8/d6/sertl_8c.html#a43">RtlSubAuthoritySid</a>(Sid, i)));
00503         }
00504         printf(<span class="stringliteral">"\n"</span>);
00505 
00506     }
00507 
00508 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a24" doxytag="rtdmpsec.c::Dump" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void Dump           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HANDLE&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Handle</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d3/d0/rtdmp_8c-source.html#l00126">Dump()</a>, <a class="el" href="../../d3/d4/editreg_8c-source.html#l00966">List()</a>, and <a class="el" href="../../d3/d0/rtdmp_8c-source.html#l00076">main()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a23" doxytag="rtdmpsec.c::DumpSecurity" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void DumpSecurity           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HANDLE&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Handle</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html#l00283">283</a> of file <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html">rtdmpsec.c</a>.
<p>
References <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00161">Dacl</a>, <a class="el" href="../../d0/d1/fedefs_8h-source.html#l00051">exit</a>, <a class="el" href="../../d8/d9/cmdat2_8c-source.html#l00091">Handle</a>, <a class="el" href="../../d6/d5/stierr_8h-source.html#l00030">NT_SUCCESS</a>, <a class="el" href="../../d0/d1/obse_8c-source.html#l00255">NtQuerySecurityObject()</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html#l00585">PrintAcl()</a>, <a class="el" href="../../d9/d5/sertl_8c-source.html#l02665">RtlGetDaclSecurityDescriptor()</a>, and <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00135">Status</a>.
<p>
<pre class="fragment"><div>00286 {
00287     PSECURITY_DESCRIPTOR SecurityDescriptor;
00288     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
00289     ULONG Length;
00290     PACL <a class="code" href="../../d6/d0/ctaccess_8c.html#a55">Dacl</a>;
00291     BOOLEAN DaclPresent;
00292     BOOLEAN DaclDefaulted;
00293 
00294     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d9/d1/obse_8c.html#a2">NtQuerySecurityObject</a>( Handle,
00295                                     DACL_SECURITY_INFORMATION,
00296                                     NULL,
00297                                     0,
00298                                     &amp;Length );
00299 
00300     <span class="keywordflow">if</span> (<a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> != STATUS_BUFFER_TOO_SMALL) {
00301         printf(<span class="stringliteral">"DumpSecurity t0: NtQuerySecurityObject failed %lx\n"</span>,Status);
00302         <a class="code" href="../../d9/d1/fedefs_8h.html#a16">exit</a>(1);
00303     }
00304 
00305     SecurityDescriptor = malloc(Length);
00306     <span class="keywordflow">if</span> (SecurityDescriptor == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00307         printf(<span class="stringliteral">"DumpSecurity: couldn't malloc buffer\n"</span>);
00308         <a class="code" href="../../d9/d1/fedefs_8h.html#a16">exit</a>(1);
00309     }
00310 
00311     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d9/d1/obse_8c.html#a2">NtQuerySecurityObject</a>( Handle,
00312                                     DACL_SECURITY_INFORMATION,
00313                                     SecurityDescriptor,
00314                                     Length,
00315                                     &amp;Length );
00316 
00317     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status)) {
00318         printf(<span class="stringliteral">"DumpSecurity t1: NtQuerySecurityObject failed %lx\n"</span>,Status);
00319         <a class="code" href="../../d9/d1/fedefs_8h.html#a16">exit</a>(1);
00320     }
00321 
00322     <a class="code" href="../../d6/d0/ctaccess_8c.html#a55">Dacl</a> = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00323 
00324     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d8/d6/sertl_8c.html#a61">RtlGetDaclSecurityDescriptor</a>( SecurityDescriptor,
00325                                            &amp;DaclPresent,
00326                                            &amp;Dacl,
00327                                            &amp;DaclDefaulted );
00328     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status)) {
00329         printf(<span class="stringliteral">"DumpSecurity t2: RtlGetDaclSecurityDescriptor failed %lx\n"</span>,Status);
00330     }
00331 
00332     <span class="keywordflow">if</span> (DaclPresent) {
00333         <a class="code" href="../../d4/d1/rtdmpsec_8c.html#a18">PrintAcl</a>(Dacl);
00334     } <span class="keywordflow">else</span> {
00335         printf(<span class="stringliteral">"\tAcl not present\n"</span>);
00336     }
00337 
00338 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a17" doxytag="rtdmpsec.c::InitVars" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID InitVars           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html#l00511">511</a> of file <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html">rtdmpsec.c</a>.
<p>
References <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html#l00121">BatchSid</a>, <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html#l00111">CreatorOwnerSid</a>, <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html#l00119">DialupSid</a>, <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html#l00122">InteractiveSid</a>, <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html#l00110">LocalSid</a>, <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html#l00123">LocalSystemSid</a>, <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html#l00120">NetworkSid</a>, <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html#l00117">NtAuthoritySid</a>, <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html#l00108">NullSid</a>, <a class="el" href="../../d9/d5/sertl_8c-source.html#l01166">RtlInitializeSid()</a>, <a class="el" href="../../d9/d5/sertl_8c-source.html#l01030">RtlLengthRequiredSid()</a>, <a class="el" href="../../d9/d5/sertl_8c-source.html#l01286">RtlSubAuthoritySid()</a>, and <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html#l00109">WorldSid</a>.
<p>
Referenced by <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html#l00126">main()</a>.
<p>
<pre class="fragment"><div>00512 {
00513     ULONG SidWithZeroSubAuthorities;
00514     ULONG SidWithOneSubAuthority;
00515     ULONG SidWithThreeSubAuthorities;
00516     ULONG SidWithFourSubAuthorities;
00517 
00518     SID_IDENTIFIER_AUTHORITY NullSidAuthority    = SECURITY_NULL_SID_AUTHORITY;
00519     SID_IDENTIFIER_AUTHORITY WorldSidAuthority   = SECURITY_WORLD_SID_AUTHORITY;
00520     SID_IDENTIFIER_AUTHORITY LocalSidAuthority   = SECURITY_LOCAL_SID_AUTHORITY;
00521     SID_IDENTIFIER_AUTHORITY CreatorSidAuthority = SECURITY_CREATOR_SID_AUTHORITY;
00522 
00523     SID_IDENTIFIER_AUTHORITY NtAuthority = SECURITY_NT_AUTHORITY;
00524 
00525 
00526     <span class="comment">//</span>
00527     <span class="comment">//  The following SID sizes need to be allocated</span>
00528     <span class="comment">//</span>
00529 
00530     SidWithZeroSubAuthorities  = <a class="code" href="../../d8/d6/sertl_8c.html#a38">RtlLengthRequiredSid</a>( 0 );
00531     SidWithOneSubAuthority     = <a class="code" href="../../d8/d6/sertl_8c.html#a38">RtlLengthRequiredSid</a>( 1 );
00532     SidWithThreeSubAuthorities = <a class="code" href="../../d8/d6/sertl_8c.html#a38">RtlLengthRequiredSid</a>( 3 );
00533     SidWithFourSubAuthorities  = <a class="code" href="../../d8/d6/sertl_8c.html#a38">RtlLengthRequiredSid</a>( 4 );
00534 
00535     <span class="comment">//</span>
00536     <span class="comment">//  Allocate and initialize the universal SIDs</span>
00537     <span class="comment">//</span>
00538 
00539     <a class="code" href="../../d4/d1/rtdmpsec_8c.html#a7">NullSid</a>         = (PSID)malloc(SidWithOneSubAuthority);
00540     <a class="code" href="../../d4/d1/rtdmpsec_8c.html#a8">WorldSid</a>        = (PSID)malloc(SidWithOneSubAuthority);
00541     <a class="code" href="../../d4/d1/rtdmpsec_8c.html#a9">LocalSid</a>        = (PSID)malloc(SidWithOneSubAuthority);
00542     <a class="code" href="../../d4/d1/rtdmpsec_8c.html#a10">CreatorOwnerSid</a> = (PSID)malloc(SidWithOneSubAuthority);
00543 
00544     <a class="code" href="../../d8/d6/sertl_8c.html#a40">RtlInitializeSid</a>( NullSid,    &amp;NullSidAuthority, 1 );
00545     <a class="code" href="../../d8/d6/sertl_8c.html#a40">RtlInitializeSid</a>( WorldSid,   &amp;WorldSidAuthority, 1 );
00546     <a class="code" href="../../d8/d6/sertl_8c.html#a40">RtlInitializeSid</a>( LocalSid,   &amp;LocalSidAuthority, 1 );
00547     <a class="code" href="../../d8/d6/sertl_8c.html#a40">RtlInitializeSid</a>( CreatorOwnerSid, &amp;CreatorSidAuthority, 1 );
00548 
00549     *(<a class="code" href="../../d8/d6/sertl_8c.html#a43">RtlSubAuthoritySid</a>( NullSid, 0 ))         = SECURITY_NULL_RID;
00550     *(<a class="code" href="../../d8/d6/sertl_8c.html#a43">RtlSubAuthoritySid</a>( WorldSid, 0 ))        = SECURITY_WORLD_RID;
00551     *(<a class="code" href="../../d8/d6/sertl_8c.html#a43">RtlSubAuthoritySid</a>( LocalSid, 0 ))        = SECURITY_LOCAL_RID;
00552     *(<a class="code" href="../../d8/d6/sertl_8c.html#a43">RtlSubAuthoritySid</a>( CreatorOwnerSid, 0 )) = SECURITY_CREATOR_OWNER_RID;
00553 
00554     <span class="comment">//</span>
00555     <span class="comment">// Allocate and initialize the NT defined SIDs</span>
00556     <span class="comment">//</span>
00557 
00558     <a class="code" href="../../d4/d1/rtdmpsec_8c.html#a11">NtAuthoritySid</a>  = (PSID)malloc(SidWithZeroSubAuthorities);
00559     <a class="code" href="../../d4/d1/rtdmpsec_8c.html#a12">DialupSid</a>       = (PSID)malloc(SidWithOneSubAuthority);
00560     <a class="code" href="../../d4/d1/rtdmpsec_8c.html#a13">NetworkSid</a>      = (PSID)malloc(SidWithOneSubAuthority);
00561     <a class="code" href="../../d4/d1/rtdmpsec_8c.html#a14">BatchSid</a>        = (PSID)malloc(SidWithOneSubAuthority);
00562     <a class="code" href="../../d4/d1/rtdmpsec_8c.html#a15">InteractiveSid</a>  = (PSID)malloc(SidWithOneSubAuthority);
00563     <a class="code" href="../../d4/d1/rtdmpsec_8c.html#a16">LocalSystemSid</a>  = (PSID)malloc(SidWithOneSubAuthority);
00564 
00565     <a class="code" href="../../d8/d6/sertl_8c.html#a40">RtlInitializeSid</a>( NtAuthoritySid,   &amp;NtAuthority, 0 );
00566     <a class="code" href="../../d8/d6/sertl_8c.html#a40">RtlInitializeSid</a>( DialupSid,        &amp;NtAuthority, 1 );
00567     <a class="code" href="../../d8/d6/sertl_8c.html#a40">RtlInitializeSid</a>( NetworkSid,       &amp;NtAuthority, 1 );
00568     <a class="code" href="../../d8/d6/sertl_8c.html#a40">RtlInitializeSid</a>( BatchSid,         &amp;NtAuthority, 1 );
00569     <a class="code" href="../../d8/d6/sertl_8c.html#a40">RtlInitializeSid</a>( InteractiveSid,   &amp;NtAuthority, 1 );
00570     <a class="code" href="../../d8/d6/sertl_8c.html#a40">RtlInitializeSid</a>( LocalSystemSid,   &amp;NtAuthority, 1 );
00571 
00572     *(<a class="code" href="../../d8/d6/sertl_8c.html#a43">RtlSubAuthoritySid</a>( DialupSid,       0 )) = SECURITY_DIALUP_RID;
00573     *(<a class="code" href="../../d8/d6/sertl_8c.html#a43">RtlSubAuthoritySid</a>( NetworkSid,      0 )) = SECURITY_NETWORK_RID;
00574     *(<a class="code" href="../../d8/d6/sertl_8c.html#a43">RtlSubAuthoritySid</a>( BatchSid,        0 )) = SECURITY_BATCH_RID;
00575     *(<a class="code" href="../../d8/d6/sertl_8c.html#a43">RtlSubAuthoritySid</a>( InteractiveSid,  0 )) = SECURITY_INTERACTIVE_RID;
00576     *(<a class="code" href="../../d8/d6/sertl_8c.html#a43">RtlSubAuthoritySid</a>( LocalSystemSid,  0 )) = SECURITY_LOCAL_SYSTEM_RID;
00577 
00578     <span class="keywordflow">return</span>;
00579 
00580 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a25" doxytag="rtdmpsec.c::main" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void __cdecl main           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>argc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>argv</em>[]</td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html#l00126">126</a> of file <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html">rtdmpsec.c</a>.
<p>
References <a class="el" href="../../d4/d1/rtdmpsec_8c.html#a24">Dump()</a>, <a class="el" href="../../d0/d1/fedefs_8h-source.html#l00051">exit</a>, <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html#l00511">InitVars()</a>, <a class="el" href="../../d3/d9/aw_8h-source.html#l00031">L</a>, <a class="el" href="../../d6/d5/stierr_8h-source.html#l00030">NT_SUCCESS</a>, <a class="el" href="../../d8/d6/ntapi_8c-source.html#l01870">NtOpenKey()</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00027">ObjectAttributes</a>, <a class="el" href="../../d8/d0/rtbatcr_8c.html#a13">processargs()</a>, <a class="el" href="../../d9/d9/rtbatcr_8c-source.html#l00051">WORK_SIZE</a>, <a class="el" href="../../d9/d9/rtbatcr_8c-source.html#l00068">workbuffer</a>, and <a class="el" href="../../d9/d9/rtbatcr_8c-source.html#l00067">WorkName</a>.
<p>
<pre class="fragment"><div>00130 {
00131     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> status;
00132     OBJECT_ATTRIBUTES <a class="code" href="../../d7/d0/ctlnpqos_8c.html#a4">ObjectAttributes</a>;
00133     HANDLE          BaseHandle;
00134 
00135     <a class="code" href="../../d4/d1/rtdmpsec_8c.html#a17">InitVars</a>();
00136 
00137     <span class="comment">//</span>
00138     <span class="comment">// Process args</span>
00139     <span class="comment">//</span>
00140 
00141     <a class="code" href="../../d8/d0/rtbatcr_8c.html#a10">WorkName</a>.MaximumLength = <a class="code" href="../../d8/d0/rtbatcr_8c.html#a0">WORK_SIZE</a>;
00142     <a class="code" href="../../d8/d0/rtbatcr_8c.html#a10">WorkName</a>.Length = 0<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>;
00143     <a class="code" href="../../d8/d0/rtbatcr_8c.html#a10">WorkName</a>.Buffer = &amp;(<a class="code" href="../../d8/d0/rtbatcr_8c.html#a11">workbuffer</a>[0]);
00144 
00145     <a class="code" href="../../d8/d0/rtbatcr_8c.html#a13">processargs</a>(argc, argv);
00146 
00147 
00148     <span class="comment">//</span>
00149     <span class="comment">// Set up and open KeyPath</span>
00150     <span class="comment">//</span>
00151 
00152     printf(<span class="stringliteral">"rtdmpsec: starting\n"</span>);
00153 
00154     InitializeObjectAttributes(
00155         &amp;ObjectAttributes,
00156         &amp;WorkName,
00157         0,
00158         (HANDLE)NULL,
00159         NULL
00160         );
00161     <a class="code" href="../../d7/d0/ctlnpqos_8c.html#a4">ObjectAttributes</a>.Attributes |= OBJ_CASE_INSENSITIVE;
00162 
00163     status = <a class="code" href="../../d7/d7/ntapi_8c.html#a23">NtOpenKey</a>(
00164                 &amp;BaseHandle,
00165                 MAXIMUM_ALLOWED,
00166                 &amp;ObjectAttributes
00167                 );
00168     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(status)) {
00169         printf(<span class="stringliteral">"rtdmpsec: t0: %08lx\n"</span>, status);
00170         <a class="code" href="../../d9/d1/fedefs_8h.html#a16">exit</a>(1);
00171     }
00172 
00173     <a class="code" href="../../d4/d1/rtdmpsec_8c.html#a24">Dump</a>(BaseHandle);
00174 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a20" doxytag="rtdmpsec.c::main" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void __cdecl main           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a22" doxytag="rtdmpsec.c::print" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void print           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">PUNICODE_STRING&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d3/d0/rtdmp_8c-source.html#l00126">Dump()</a>, and <a class="el" href="../../d3/d0/rtdmp_8c-source.html#l00223">DumpValues()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a19" doxytag="rtdmpsec.c::PrintAccessMask" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID PrintAccessMask           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN ACCESS_MASK&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>AccessMask</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html#l00722">722</a> of file <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html">rtdmpsec.c</a>.
<p>
Referenced by <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html#l00585">PrintAcl()</a>.
<p>
<pre class="fragment"><div>00725 {
00726     printf(<span class="stringliteral">"\n\tAccess Mask: "</span>);
00727 
00728     <span class="keywordflow">if</span> (AccessMask == KEY_ALL_ACCESS) {
00729         printf(<span class="stringliteral">"KEY_ALL_ACCESS\n\t             "</span>);
00730         <span class="keywordflow">return</span>;
00731     }
00732     <span class="keywordflow">if</span> (AccessMask == KEY_READ) {
00733         printf(<span class="stringliteral">"KEY_READ\n\t             "</span>);
00734         <span class="keywordflow">return</span>;
00735     }
00736     <span class="keywordflow">if</span> (AccessMask == KEY_WRITE) {
00737         printf(<span class="stringliteral">"KEY_WRITE\n\t             "</span>);
00738         <span class="keywordflow">return</span>;
00739     }
00740 
00741     <span class="keywordflow">if</span> (AccessMask &amp; KEY_QUERY_VALUE) {
00742         printf(<span class="stringliteral">"KEY_QUERY_VALUE\n\t             "</span>);
00743     }
00744     <span class="keywordflow">if</span> (AccessMask &amp; KEY_SET_VALUE) {
00745         printf(<span class="stringliteral">"KEY_SET_VALUE\n\t             "</span>);
00746     }
00747     <span class="keywordflow">if</span> (AccessMask &amp; KEY_CREATE_SUB_KEY) {
00748         printf(<span class="stringliteral">"KEY_CREATE_SUB_KEY\n\t             "</span>);
00749     }
00750     <span class="keywordflow">if</span> (AccessMask &amp; KEY_ENUMERATE_SUB_KEYS) {
00751         printf(<span class="stringliteral">"KEY_ENUMERATE_SUB_KEYS\n\t             "</span>);
00752     }
00753     <span class="keywordflow">if</span> (AccessMask &amp; KEY_NOTIFY) {
00754         printf(<span class="stringliteral">"KEY_NOTIFY\n\t             "</span>);
00755     }
00756     <span class="keywordflow">if</span> (AccessMask &amp; KEY_CREATE_LINK) {
00757         printf(<span class="stringliteral">"KEY_CREATE_LINK\n\t             "</span>);
00758     }
00759     <span class="keywordflow">if</span> (AccessMask &amp; GENERIC_ALL) {
00760         printf(<span class="stringliteral">"GENERIC_ALL\n\t             "</span>);
00761     }
00762     <span class="keywordflow">if</span> (AccessMask &amp; GENERIC_EXECUTE) {
00763         printf(<span class="stringliteral">"GENERIC_EXECUTE\n\t             "</span>);
00764     }
00765     <span class="keywordflow">if</span> (AccessMask &amp; GENERIC_WRITE) {
00766         printf(<span class="stringliteral">"GENERIC_WRITE\n\t             "</span>);
00767     }
00768     <span class="keywordflow">if</span> (AccessMask &amp; GENERIC_READ) {
00769         printf(<span class="stringliteral">"GENERIC_READ\n\t             "</span>);
00770     }
00771     <span class="keywordflow">if</span> (AccessMask &amp; GENERIC_READ) {
00772         printf(<span class="stringliteral">"GENERIC_READ\n\t             "</span>);
00773     }
00774     <span class="keywordflow">if</span> (AccessMask &amp; MAXIMUM_ALLOWED) {
00775         printf(<span class="stringliteral">"MAXIMUM_ALLOWED\n\t             "</span>);
00776     }
00777     <span class="keywordflow">if</span> (AccessMask &amp; ACCESS_SYSTEM_SECURITY) {
00778         printf(<span class="stringliteral">"ACCESS_SYSTEM_SECURITY\n\t             "</span>);
00779     }
00780     <span class="keywordflow">if</span> (AccessMask &amp; WRITE_OWNER) {
00781         printf(<span class="stringliteral">"WRITE_OWNER\n\t             "</span>);
00782     }
00783     <span class="keywordflow">if</span> (AccessMask &amp; WRITE_DAC) {
00784         printf(<span class="stringliteral">"WRITE_DAC\n\t             "</span>);
00785     }
00786     <span class="keywordflow">if</span> (AccessMask &amp; READ_CONTROL) {
00787         printf(<span class="stringliteral">"READ_CONTROL\n\t             "</span>);
00788     }
00789     <span class="keywordflow">if</span> (AccessMask &amp; DELETE) {
00790         printf(<span class="stringliteral">"DELETE\n\t             "</span>);
00791     }
00792 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a18" doxytag="rtdmpsec.c::PrintAcl" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID PrintAcl           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PACL&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Acl</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html#l00585">585</a> of file <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html">rtdmpsec.c</a>.
<p>
References <a class="el" href="../../d2/d8/uipers_8c-source.html#l00131">DisplayAccountSid()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html#l00053">FirstAce</a>, <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html#l00059">NextAce</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d4/d1/rtdmpsec_8c.html#a4">PKNOWN_ACE</a>, <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html#l00722">PrintAccessMask()</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html#l00283">DumpSecurity()</a>.
<p>
<pre class="fragment"><div>00591                    :
00592 
00593     This routine dumps an Acl <span class="keywordflow">for</span> debug purposes (via printf).  It <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a>
00594     specialized to dump standard aces.
00595 
00596 Arguments:
00597 
00598     Acl - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> Acl to dump
00599 
00600 Return Value:
00601 
00602     None
00603 
00604 --*/
00605 
00606 
00607 {
00608     ULONG i;
00609     <a class="code" href="../../d4/d7/struct__KNOWN__ACE.html">PKNOWN_ACE</a> Ace;
00610     BOOLEAN KnownType;
00611     PCHAR AceTypes[] = { <span class="stringliteral">"Access Allowed"</span>,
00612                          <span class="stringliteral">"Access Denied "</span>,
00613                          <span class="stringliteral">"System Audit  "</span>,
00614                          <span class="stringliteral">"System Alarm  "</span>
00615                        };
00616 
00617     <span class="keywordflow">if</span> (Acl == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00618 
00619         printf(<span class="stringliteral">"\tAcl == ALL ACCESS GRANTED!\n"</span>);
00620         <span class="keywordflow">return</span>;
00621 
00622     }
00623 
00624     <span class="comment">//</span>
00625     <span class="comment">//  Dump the Acl header</span>
00626     <span class="comment">//</span>
00627 
00628     printf(<span class="stringliteral">"\tRevision: %02x"</span>, Acl-&gt;AclRevision);
00629     printf(<span class="stringliteral">" Size: %04x"</span>, Acl-&gt;AclSize);
00630     printf(<span class="stringliteral">" AceCount: %04x\n"</span>, Acl-&gt;AceCount);
00631 
00632     <span class="comment">//</span>
00633     <span class="comment">//  Now for each Ace we want do dump it</span>
00634     <span class="comment">//</span>
00635 
00636     <span class="keywordflow">for</span> (i = 0, Ace = <a class="code" href="../../d4/d1/rtdmpsec_8c.html#a1">FirstAce</a>(Acl);
00637          i &lt; Acl-&gt;AceCount;
00638          i++, Ace = <a class="code" href="../../d4/d1/rtdmpsec_8c.html#a2">NextAce</a>(Ace) ) {
00639 
00640         <span class="comment">//</span>
00641         <span class="comment">//  print out the ace header</span>
00642         <span class="comment">//</span>
00643 
00644         printf(<span class="stringliteral">"\n\tAceHeader: %08lx "</span>, *(PULONG)Ace);
00645 
00646         <span class="comment">//</span>
00647         <span class="comment">//  special case on the standard ace types</span>
00648         <span class="comment">//</span>
00649 
00650         <span class="keywordflow">if</span> ((Ace-&gt;Header.AceType == ACCESS_ALLOWED_ACE_TYPE) ||
00651             (Ace-&gt;Header.AceType == ACCESS_DENIED_ACE_TYPE) ||
00652             (Ace-&gt;Header.AceType == SYSTEM_AUDIT_ACE_TYPE) ||
00653             (Ace-&gt;Header.AceType == SYSTEM_ALARM_ACE_TYPE)) {
00654 
00655             <span class="comment">//</span>
00656             <span class="comment">//  The following array is indexed by ace types and must</span>
00657             <span class="comment">//  follow the allowed, denied, audit, alarm seqeuence</span>
00658             <span class="comment">//</span>
00659 
00660             PCHAR AceTypes[] = { <span class="stringliteral">"Access Allowed"</span>,
00661                                  <span class="stringliteral">"Access Denied "</span>,
00662                                  <span class="stringliteral">"System Audit  "</span>,
00663                                  <span class="stringliteral">"System Alarm  "</span>
00664                                };
00665 
00666             printf(AceTypes[Ace-&gt;Header.AceType]);
00667             <a class="code" href="../../d4/d1/rtdmpsec_8c.html#a19">PrintAccessMask</a>(Ace-&gt;Mask);
00668             KnownType = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00669 
00670         } <span class="keywordflow">else</span> {
00671 
00672             KnownType = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00673             printf(<span class="stringliteral">" Unknown Ace Type\n"</span>);
00674 
00675         }
00676 
00677         printf(<span class="stringliteral">"\n"</span>);
00678 
00679         printf(<span class="stringliteral">"\tAceSize = %d\n"</span>,Ace-&gt;Header.AceSize);
00680 
00681         printf(<span class="stringliteral">"\tAce Flags = "</span>);
00682         <span class="keywordflow">if</span> (Ace-&gt;Header.AceFlags &amp; OBJECT_INHERIT_ACE) {
00683             printf(<span class="stringliteral">"OBJECT_INHERIT_ACE\n"</span>);
00684             printf(<span class="stringliteral">"                   "</span>);
00685         }
00686 
00687         <span class="keywordflow">if</span> (Ace-&gt;Header.AceFlags &amp; CONTAINER_INHERIT_ACE) {
00688             printf(<span class="stringliteral">"CONTAINER_INHERIT_ACE\n"</span>);
00689             printf(<span class="stringliteral">"                   "</span>);
00690         }
00691 
00692         <span class="keywordflow">if</span> (Ace-&gt;Header.AceFlags &amp; NO_PROPAGATE_INHERIT_ACE) {
00693             printf(<span class="stringliteral">"NO_PROPAGATE_INHERIT_ACE\n"</span>);
00694             printf(<span class="stringliteral">"                   "</span>);
00695         }
00696 
00697         <span class="keywordflow">if</span> (Ace-&gt;Header.AceFlags &amp; INHERIT_ONLY_ACE) {
00698             printf(<span class="stringliteral">"INHERIT_ONLY_ACE\n"</span>);
00699             printf(<span class="stringliteral">"                   "</span>);
00700         }
00701 
00702         <span class="keywordflow">if</span> (Ace-&gt;Header.AceFlags &amp; SUCCESSFUL_ACCESS_ACE_FLAG) {
00703             printf(<span class="stringliteral">"SUCCESSFUL_ACCESS_ACE_FLAG\n"</span>);
00704             printf(<span class="stringliteral">"            "</span>);
00705         }
00706 
00707         <span class="keywordflow">if</span> (Ace-&gt;Header.AceFlags &amp; FAILED_ACCESS_ACE_FLAG) {
00708             printf(<span class="stringliteral">"FAILED_ACCESS_ACE_FLAG\n"</span>);
00709             printf(<span class="stringliteral">"            "</span>);
00710         }
00711 
00712         printf(<span class="stringliteral">"\n"</span>);
00713 
00714         printf(<span class="stringliteral">"\tSid = "</span>);
00715         <a class="code" href="../../d1/d9/uipers_8c.html#a5">DisplayAccountSid</a>(&amp;Ace-&gt;SidStart);
00716     }
00717 
00718 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a26" doxytag="rtdmpsec.c::processargs" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void processargs           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>argc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>char *&nbsp;</td>
          <td class="mdname" nowrap> <em>argv</em>[]</td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html#l00360">360</a> of file <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html">rtdmpsec.c</a>.
<p>
References <a class="el" href="../../d0/d1/fedefs_8h-source.html#l00051">exit</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d7/d5/nls_8c-source.html#l00082">RtlAnsiStringToUnicodeString()</a>, <a class="el" href="../../d3/d6/string_8c-source.html#l00102">RtlInitAnsiString()</a>, and <a class="el" href="../../d9/d9/rtbatcr_8c-source.html#l00067">WorkName</a>.
<p>
<pre class="fragment"><div>00364 {
00365     ANSI_STRING temp;
00366 
00367     <span class="keywordflow">if</span> ( (argc != 2) )
00368     {
00369         printf(<span class="stringliteral">"Usage: %s &lt;KeyPath&gt;\n"</span>,
00370                 argv[0]);
00371         <a class="code" href="../../d9/d1/fedefs_8h.html#a16">exit</a>(1);
00372     }
00373 
00374     <a class="code" href="../../d2/d7/string_8c.html#a6">RtlInitAnsiString</a>(
00375         &amp;temp,
00376         argv[1]
00377         );
00378 
00379     <a class="code" href="../../d6/d6/nls_8c.html#a21">RtlAnsiStringToUnicodeString</a>(
00380         &amp;WorkName,
00381         &amp;temp,
00382         FALSE
00383         );
00384 
00385     <span class="keywordflow">return</span>;
00386 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a21" doxytag="rtdmpsec.c::processargs" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void processargs           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a27" doxytag="rtdmpsec.c::SidTranslation" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN SidTranslation           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">PSID&nbsp;</td>
          <td class="mdname" nowrap> <em>Sid</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>PSTRING&nbsp;</td>
          <td class="mdname" nowrap> <em>AccountName</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html#l00390">390</a> of file <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html">rtdmpsec.c</a>.
<p>
References <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html#l00121">BatchSid</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html#l00122">InteractiveSid</a>, <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html#l00110">LocalSid</a>, <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html#l00123">LocalSystemSid</a>, <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html#l00120">NetworkSid</a>, <a class="el" href="../../d9/d5/sertl_8c-source.html#l00871">RtlEqualSid()</a>, <a class="el" href="../../d3/d6/string_8c-source.html#l00056">RtlInitString()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, and <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html#l00109">WorldSid</a>.
<p>
Referenced by <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html#l00447">DisplayAccountSid()</a>.
<p>
<pre class="fragment"><div>00396 {
00397     <span class="keywordflow">if</span> (<a class="code" href="../../d8/d6/sertl_8c.html#a36">RtlEqualSid</a>(Sid, WorldSid)) {
00398         <a class="code" href="../../d2/d7/string_8c.html#a5">RtlInitString</a>( AccountName, <span class="stringliteral">"WORLD"</span>);
00399         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00400     }
00401 
00402     <span class="keywordflow">if</span> (<a class="code" href="../../d8/d6/sertl_8c.html#a36">RtlEqualSid</a>(Sid, LocalSid)) {
00403         <a class="code" href="../../d2/d7/string_8c.html#a5">RtlInitString</a>( AccountName, <span class="stringliteral">"LOCAL"</span>);
00404 
00405         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00406     }
00407 
00408     <span class="keywordflow">if</span> (<a class="code" href="../../d8/d6/sertl_8c.html#a36">RtlEqualSid</a>(Sid, NetworkSid)) {
00409         <a class="code" href="../../d2/d7/string_8c.html#a5">RtlInitString</a>( AccountName, <span class="stringliteral">"NETWORK"</span>);
00410 
00411         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00412     }
00413 
00414     <span class="keywordflow">if</span> (<a class="code" href="../../d8/d6/sertl_8c.html#a36">RtlEqualSid</a>(Sid, BatchSid)) {
00415         <a class="code" href="../../d2/d7/string_8c.html#a5">RtlInitString</a>( AccountName, <span class="stringliteral">"BATCH"</span>);
00416 
00417         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00418     }
00419 
00420     <span class="keywordflow">if</span> (<a class="code" href="../../d8/d6/sertl_8c.html#a36">RtlEqualSid</a>(Sid, InteractiveSid)) {
00421         <a class="code" href="../../d2/d7/string_8c.html#a5">RtlInitString</a>( AccountName, <span class="stringliteral">"INTERACTIVE"</span>);
00422         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00423     }
00424 
00425     <span class="keywordflow">if</span> (<a class="code" href="../../d8/d6/sertl_8c.html#a36">RtlEqualSid</a>(Sid, LocalSystemSid)) {
00426         <a class="code" href="../../d2/d7/string_8c.html#a5">RtlInitString</a>( AccountName, <span class="stringliteral">"SYSTEM"</span>);
00427         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00428     }
00429 
00430 <span class="comment">//</span>
00431 <span class="comment">//    if (RtlEqualSid(Sid, LocalManagerSid)) {</span>
00432 <span class="comment">//      RtlInitString( AccountName, "LOCAL MANAGER");</span>
00433 <span class="comment">//      return(TRUE);</span>
00434 <span class="comment">//  }</span>
00435 
00436 <span class="comment">//  if (RtlEqualSid(Sid, LocalAdminSid)) {</span>
00437 <span class="comment">//      RtlInitString( AccountName, "LOCAL ADMIN");</span>
00438 <span class="comment">//      return(TRUE);</span>
00439 <span class="comment">//  }</span>
00440 
00441     <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00442 
00443 }
</div></pre>    </td>
  </tr>
</table>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="a14" doxytag="rtdmpsec.c::BatchSid" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PSID <a class="el" href="../../d4/d6/tsevars_8c.html#a37">BatchSid</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html#l00121">121</a> of file <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html">rtdmpsec.c</a>.
<p>
Referenced by <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html#l00511">InitVars()</a>, <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html#l00390">SidTranslation()</a>, <a class="el" href="../../d2/d0/ctsertl_8c-source.html#l00042">TestSeSid()</a>, and <a class="el" href="../../d5/d5/tsevars_8c-source.html#l00167">TSeVariableInitialization()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a10" doxytag="rtdmpsec.c::CreatorOwnerSid" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PSID <a class="el" href="../../d4/d1/rtdmpsec_8c.html#a10">CreatorOwnerSid</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html#l00111">111</a> of file <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html">rtdmpsec.c</a>.
<p>
Referenced by <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html#l00511">InitVars()</a>, and <a class="el" href="../../d9/d5/sertl_8c-source.html#l07461">RtlpConvertAclToAutoInherit()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a12" doxytag="rtdmpsec.c::DialupSid" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PSID <a class="el" href="../../d4/d6/tsevars_8c.html#a35">DialupSid</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html#l00119">119</a> of file <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html">rtdmpsec.c</a>.
<p>
Referenced by <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html#l00511">InitVars()</a>, <a class="el" href="../../d2/d0/ctsertl_8c-source.html#l00042">TestSeSid()</a>, and <a class="el" href="../../d5/d5/tsevars_8c-source.html#l00167">TSeVariableInitialization()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a15" doxytag="rtdmpsec.c::InteractiveSid" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PSID <a class="el" href="../../d4/d6/tsevars_8c.html#a38">InteractiveSid</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html#l00122">122</a> of file <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html">rtdmpsec.c</a>.
<p>
Referenced by <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html#l00511">InitVars()</a>, <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html#l00390">SidTranslation()</a>, <a class="el" href="../../d2/d0/ctsertl_8c-source.html#l00042">TestSeSid()</a>, and <a class="el" href="../../d5/d5/tsevars_8c-source.html#l00167">TSeVariableInitialization()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a9" doxytag="rtdmpsec.c::LocalSid" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PSID <a class="el" href="../../d4/d6/tsevars_8c.html#a32">LocalSid</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html#l00110">110</a> of file <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html">rtdmpsec.c</a>.
<p>
Referenced by <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html#l00511">InitVars()</a>, <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html#l00390">SidTranslation()</a>, <a class="el" href="../../d2/d0/ctsertl_8c-source.html#l00042">TestSeSid()</a>, and <a class="el" href="../../d5/d5/tsevars_8c-source.html#l00167">TSeVariableInitialization()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a16" doxytag="rtdmpsec.c::LocalSystemSid" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PSID <a class="el" href="../../d4/d6/tsevars_8c.html#a39">LocalSystemSid</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html#l00123">123</a> of file <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html">rtdmpsec.c</a>.
<p>
Referenced by <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html#l00511">InitVars()</a>, <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html#l00390">SidTranslation()</a>, <a class="el" href="../../d2/d0/ctsertl_8c-source.html#l00042">TestSeSid()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l07648">TestTokenAssignPrimary()</a>, and <a class="el" href="../../d5/d5/tsevars_8c-source.html#l00167">TSeVariableInitialization()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a13" doxytag="rtdmpsec.c::NetworkSid" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PSID <a class="el" href="../../d4/d6/tsevars_8c.html#a36">NetworkSid</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html#l00120">120</a> of file <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html">rtdmpsec.c</a>.
<p>
Referenced by <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html#l00511">InitVars()</a>, <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html#l00390">SidTranslation()</a>, <a class="el" href="../../d2/d0/ctsertl_8c-source.html#l00042">TestSeSid()</a>, and <a class="el" href="../../d5/d5/tsevars_8c-source.html#l00167">TSeVariableInitialization()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a11" doxytag="rtdmpsec.c::NtAuthoritySid" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PSID <a class="el" href="../../d4/d6/tsevars_8c.html#a34">NtAuthoritySid</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html#l00117">117</a> of file <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html">rtdmpsec.c</a>.
<p>
Referenced by <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html#l00511">InitVars()</a>, <a class="el" href="../../d2/d0/ctsertl_8c-source.html#l00042">TestSeSid()</a>, and <a class="el" href="../../d5/d5/tsevars_8c-source.html#l00167">TSeVariableInitialization()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a7" doxytag="rtdmpsec.c::NullSid" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PSID <a class="el" href="../../d4/d6/tsevars_8c.html#a30">NullSid</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html#l00108">108</a> of file <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html">rtdmpsec.c</a>.
<p>
Referenced by <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html#l00511">InitVars()</a>, <a class="el" href="../../d2/d0/ctsertl_8c-source.html#l00042">TestSeSid()</a>, and <a class="el" href="../../d5/d5/tsevars_8c-source.html#l00167">TSeVariableInitialization()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a6" doxytag="rtdmpsec.c::workbuffer" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> WCHAR <a class="el" href="../../d8/d3/rtvbatcr_8c.html#a10">workbuffer</a>[WORK_SIZE]          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html#l00102">102</a> of file <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html">rtdmpsec.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a5" doxytag="rtdmpsec.c::WorkName" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> UNICODE_STRING <a class="el" href="../../d8/d3/rtvbatcr_8c.html#a9">WorkName</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html#l00101">101</a> of file <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html">rtdmpsec.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a8" doxytag="rtdmpsec.c::WorldSid" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PSID <a class="el" href="../../d4/d6/tsevars_8c.html#a31">WorldSid</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html#l00109">109</a> of file <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html">rtdmpsec.c</a>.
<p>
Referenced by <a class="el" href="../../d8/d1/cmse_8c-source.html#l01227">CmpHiveRootSecurityDescriptor()</a>, <a class="el" href="../../d1/d6/server_2server_8c-source.html#l00705">CreateBSMEventSD()</a>, <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00299">CreateDAclToken()</a>, <a class="el" href="../../d5/d2/rtsetsec_8c-source.html#l00122">GenerateDescriptor()</a>, <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html#l00511">InitVars()</a>, <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html#l00390">SidTranslation()</a>, <a class="el" href="../../d2/d0/ctsertl_8c-source.html#l00042">TestSeSid()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l04885">TestTokenAdjustGroups()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l07648">TestTokenAssignPrimary()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00421">TestTokenCreate()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l01085">TestTokenFilter()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l01434">TestTokenQuery()</a>, and <a class="el" href="../../d5/d5/tsevars_8c-source.html#l00167">TSeVariableInitialization()</a>.    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:45:30 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
