<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: cmdline.h File Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>cmdline.h File Reference</h1>
<p>
<a href="../../d5/d0/cmdline_8h-source.html">Go to the source code of this file.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Classes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d7/struct__COMMAND.html">_COMMAND</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d0/struct__CLE__POPUP.html">_CLE_POPUP</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d7/struct__COMMAND__HISTORY.html">_COMMAND_HISTORY</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d2/d8/struct__COOKED__READ__DATA.html">_COOKED_READ_DATA</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d6/struct__ALIAS.html">_ALIAS</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d8/struct__EXE__ALIAS__LIST.html">_EXE_ALIAS_LIST</a></td></tr>

<tr><td colspan=2><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/cmdline_8h.html#a0">CLEPF_FALSE_UNICODE</a>&nbsp;&nbsp;&nbsp;0x0001</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/cmdline_8h.html#a1">POPUP_SIZE_X</a>(POPUP)&nbsp;&nbsp;&nbsp;(<a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a13">SHORT</a>)(((POPUP)-&gt;Region.Right - (POPUP)-&gt;Region.Left - 1))</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/cmdline_8h.html#a2">POPUP_SIZE_Y</a>(POPUP)&nbsp;&nbsp;&nbsp;(<a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a13">SHORT</a>)(((POPUP)-&gt;Region.Bottom - (POPUP)-&gt;Region.Top - 1))</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/cmdline_8h.html#a3">COMMAND_NUMBER_SIZE</a>&nbsp;&nbsp;&nbsp;8</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/cmdline_8h.html#a4">CLE_ALLOCATED</a>&nbsp;&nbsp;&nbsp;0x00000001</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/cmdline_8h.html#a5">CLE_RESET</a>&nbsp;&nbsp;&nbsp;0x00000002</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/cmdline_8h.html#a6">DEFAULT_NUMBER_OF_COMMANDS</a>&nbsp;&nbsp;&nbsp;25</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/cmdline_8h.html#a7">DEFAULT_NUMBER_OF_BUFFERS</a>&nbsp;&nbsp;&nbsp;4</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/cmdline_8h.html#a8">COMMAND_NUM_TO_INDEX</a>(NUM, CMDHIST)&nbsp;&nbsp;&nbsp;(<a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a13">SHORT</a>)(((NUM+(CMDHIST)-&gt;FirstCommand)%((CMDHIST)-&gt;MaximumNumberOfCommands)))</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/cmdline_8h.html#a9">COMMAND_INDEX_TO_NUM</a>(INDEX, CMDHIST)&nbsp;&nbsp;&nbsp;(<a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a13">SHORT</a>)(((INDEX+((CMDHIST)-&gt;MaximumNumberOfCommands)-(CMDHIST)-&gt;FirstCommand)%((CMDHIST)-&gt;MaximumNumberOfCommands)))</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/cmdline_8h.html#a10">COMMAND_IND_PREV</a>(IND, CMDHIST)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/cmdline_8h.html#a11">COMMAND_IND_NEXT</a>(IND, CMDHIST)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/cmdline_8h.html#a12">COMMAND_IND_DEC</a>(IND, CMDHIST)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/cmdline_8h.html#a13">COMMAND_IND_INC</a>(IND, CMDHIST)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/cmdline_8h.html#a14">CLE_NO_POPUPS</a>(<a class="el" href="../../d9/d7/struct__COMMAND__HISTORY.html">COMMAND_HISTORY</a>)&nbsp;&nbsp;&nbsp;(&amp;(<a class="el" href="../../d9/d7/struct__COMMAND__HISTORY.html">COMMAND_HISTORY</a>)-&gt;PopupList == (<a class="el" href="../../d9/d7/struct__COMMAND__HISTORY.html">COMMAND_HISTORY</a>)-&gt;PopupList.Blink)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/cmdline_8h.html#a15">FMCFL_EXACT_MATCH</a>&nbsp;&nbsp;&nbsp;1</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/cmdline_8h.html#a16">FMCFL_JUST_LOOKING</a>&nbsp;&nbsp;&nbsp;2</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/cmdline_8h.html#a17">WC_DESTRUCTIVE_BACKSPACE</a>&nbsp;&nbsp;&nbsp;0x01</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/cmdline_8h.html#a18">WC_KEEP_CURSOR_VISIBLE</a>&nbsp;&nbsp;&nbsp;0x02</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/cmdline_8h.html#a19">WC_ECHO</a>&nbsp;&nbsp;&nbsp;0x04</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/cmdline_8h.html#a20">WC_FALSIFY_UNICODE</a>&nbsp;&nbsp;&nbsp;0x08</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/cmdline_8h.html#a21">WC_LIMIT_BACKSPACE</a>&nbsp;&nbsp;&nbsp;0x10</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/cmdline_8h.html#a22">UCLP_WRAP</a>&nbsp;&nbsp;&nbsp;1</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/cmdline_8h.html#a23">IS_WORD_DELIM</a>(wch)&nbsp;&nbsp;&nbsp;((wch) == L' ' || (<a class="el" href="../../d4/d1/cmdline_8h.html#a38">gaWordDelimChars</a>[0] &amp;&amp; IsWordDelim(wch)))</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/cmdline_8h.html#a24">WORD_DELIM_MAX</a>&nbsp;&nbsp;&nbsp;32</td></tr>

<tr><td colspan=2><br><h2>Typedefs</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d8/d7/struct__COMMAND.html">_COMMAND</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/cmdline_8h.html#a25">COMMAND</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d8/d7/struct__COMMAND.html">_COMMAND</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/cmdline_8h.html#a26">PCOMMAND</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef ULONG(*&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/cmdline_8h.html#a27">PCLE_POPUP_INPUT_ROUTINE</a> )(IN PVOID CookedReadData, IN PCSR_API_MSG WaitReplyMessage, IN PCSR_THREAD WaitingThread, IN BOOLEAN WaitRoutine)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d1/d0/struct__CLE__POPUP.html">_CLE_POPUP</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/cmdline_8h.html#a28">CLE_POPUP</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d1/d0/struct__CLE__POPUP.html">_CLE_POPUP</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/cmdline_8h.html#a29">PCLE_POPUP</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d9/d7/struct__COMMAND__HISTORY.html">_COMMAND_HISTORY</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/cmdline_8h.html#a30">COMMAND_HISTORY</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d9/d7/struct__COMMAND__HISTORY.html">_COMMAND_HISTORY</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/cmdline_8h.html#a31">PCOMMAND_HISTORY</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d2/d8/struct__COOKED__READ__DATA.html">_COOKED_READ_DATA</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/cmdline_8h.html#a32">COOKED_READ_DATA</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d2/d8/struct__COOKED__READ__DATA.html">_COOKED_READ_DATA</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/cmdline_8h.html#a33">PCOOKED_READ_DATA</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d1/d6/struct__ALIAS.html">_ALIAS</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/cmdline_8h.html#a34">ALIAS</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d1/d6/struct__ALIAS.html">_ALIAS</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/cmdline_8h.html#a35">PALIAS</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d6/d8/struct__EXE__ALIAS__LIST.html">_EXE_ALIAS_LIST</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/cmdline_8h.html#a36">EXE_ALIAS_LIST</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d6/d8/struct__EXE__ALIAS__LIST.html">_EXE_ALIAS_LIST</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/cmdline_8h.html#a37">PEXE_ALIAS_LIST</a></td></tr>

<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/cmdline_8h.html#a40">ProcessCommandLine</a> (IN <a class="el" href="../../d2/d8/struct__COOKED__READ__DATA.html">PCOOKED_READ_DATA</a> CookedReadData, IN WCHAR Char, IN <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> KeyState, IN PCSR_API_MSG WaitReplyMessage, IN PCSR_THREAD WaitingThread, IN BOOLEAN WaitRoutine)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/cmdline_8h.html#a41">DeleteCommandLine</a> (IN OUT <a class="el" href="../../d2/d8/struct__COOKED__READ__DATA.html">PCOOKED_READ_DATA</a> CookedReadData, IN BOOL UpdateFields)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/cmdline_8h.html#a42">RedrawCommandLine</a> (IN <a class="el" href="../../d2/d8/struct__COOKED__READ__DATA.html">PCOOKED_READ_DATA</a> CookedReadData)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/cmdline_8h.html#a43">EmptyCommandHistory</a> (IN <a class="el" href="../../d9/d7/struct__COMMAND__HISTORY.html">PCOMMAND_HISTORY</a> CommandHistory)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d9/d7/struct__COMMAND__HISTORY.html">PCOMMAND_HISTORY</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/cmdline_8h.html#a44">ReallocCommandHistory</a> (IN <a class="el" href="../../d1/d3/struct__CONSOLE__INFORMATION.html">PCONSOLE_INFORMATION</a> Console, IN <a class="el" href="../../d9/d7/struct__COMMAND__HISTORY.html">PCOMMAND_HISTORY</a> CurrentCommandHistory, IN <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> NumCommands)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d9/d7/struct__COMMAND__HISTORY.html">PCOMMAND_HISTORY</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/cmdline_8h.html#a45">FindExeCommandHistory</a> (IN <a class="el" href="../../d1/d3/struct__CONSOLE__INFORMATION.html">PCONSOLE_INFORMATION</a> Console, IN PVOID AppName, IN <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> AppNameLength, IN BOOLEAN UnicodeExe)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d9/d7/struct__COMMAND__HISTORY.html">PCOMMAND_HISTORY</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/cmdline_8h.html#a46">FindCommandHistory</a> (IN <a class="el" href="../../d1/d3/struct__CONSOLE__INFORMATION.html">PCONSOLE_INFORMATION</a> Console, IN HANDLE ProcessHandle)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/cmdline_8h.html#a47">RetrieveNumberOfSpaces</a> (IN <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a13">SHORT</a> OriginalCursorPositionX, IN PWCHAR <a class="el" href="../../d8/d6/ttri_8c.html#a3">Buffer</a>, IN ULONG CurrentPosition)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/cmdline_8h.html#a48">RetrieveTotalNumberOfSpaces</a> (IN <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a13">SHORT</a> OriginalCursorPositionX, IN PWCHAR <a class="el" href="../../d8/d6/ttri_8c.html#a3">Buffer</a>, IN ULONG CurrentPosition)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/cmdline_8h.html#a49">GetChar</a> (IN <a class="el" href="../../d7/d2/struct__INPUT__INFORMATION.html">PINPUT_INFORMATION</a> InputInfo, OUT PWCHAR Char, IN BOOLEAN Wait, IN <a class="el" href="../../d1/d3/struct__CONSOLE__INFORMATION.html">PCONSOLE_INFORMATION</a> Console, IN <a class="el" href="../../d4/d3/struct__HANDLE__DATA.html">PHANDLE_DATA</a> HandleData, IN PCSR_API_MSG Message OPTIONAL, IN CSR_WAIT_ROUTINE WaitRoutine OPTIONAL, IN PVOID WaitParameter OPTIONAL, IN ULONG WaitParameterLength OPTIONAL, IN BOOLEAN WaitBlockExists OPTIONAL, OUT PBOOLEAN CommandLineEditingKeys OPTIONAL, OUT PBOOLEAN CommandLinePopupKeys OPTIONAL, OUT PBOOLEAN EnableScrollMode OPTIONAL, OUT PDWORD KeyState OPTIONAL)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/cmdline_8h.html#a50">IsCommandLinePopupKey</a> (IN OUT PKEY_EVENT_RECORD KeyEvent)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/cmdline_8h.html#a51">IsCommandLineEditingKey</a> (IN OUT PKEY_EVENT_RECORD KeyEvent)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/cmdline_8h.html#a52">CleanUpPopups</a> (IN <a class="el" href="../../d2/d8/struct__COOKED__READ__DATA.html">PCOOKED_READ_DATA</a> CookedReadData)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/cmdline_8h.html#a53">ProcessCookedReadInput</a> (IN <a class="el" href="../../d2/d8/struct__COOKED__READ__DATA.html">PCOOKED_READ_DATA</a> CookedReadData, IN WCHAR Char, IN <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> KeyState, OUT PNTSTATUS <a class="el" href="../../d2/d1/cttoken_8c.html#a18">Status</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/cmdline_8h.html#a54">DrawCommandListBorder</a> (IN <a class="el" href="../../d1/d0/struct__CLE__POPUP.html">PCLE_POPUP</a> Popup, IN <a class="el" href="../../d7/d8/struct__SCREEN__INFORMATION.html">PSCREEN_INFORMATION</a> ScreenInfo)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d8/d7/struct__COMMAND.html">PCOMMAND</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/cmdline_8h.html#a55">GetLastCommand</a> (IN <a class="el" href="../../d9/d7/struct__COMMAND__HISTORY.html">PCOMMAND_HISTORY</a> CommandHistory)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a13">SHORT</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/cmdline_8h.html#a56">FindMatchingCommand</a> (IN <a class="el" href="../../d9/d7/struct__COMMAND__HISTORY.html">PCOMMAND_HISTORY</a> CommandHistory, IN PWCHAR CurrentCommand, IN ULONG CurrentCommandLength, IN <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a13">SHORT</a> CurrentIndex, IN <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> Flags)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/cmdline_8h.html#a57">CommandNumberPopup</a> (IN <a class="el" href="../../d2/d8/struct__COOKED__READ__DATA.html">PCOOKED_READ_DATA</a> CookedReadData, IN PCSR_API_MSG WaitReplyMessage, IN PCSR_THREAD WaitingThread, IN BOOLEAN WaitRoutine)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/cmdline_8h.html#a58">CookedReadWaitRoutine</a> (IN PLIST_ENTRY WaitQueue, IN PCSR_THREAD WaitingThread, IN PCSR_API_MSG WaitReplyMessage, IN PVOID WaitParameter, IN PVOID SatisfyParameter1, IN PVOID SatisfyParameter2, IN ULONG WaitFlags)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/cmdline_8h.html#a59">ReadRectFromScreenBuffer</a> (IN <a class="el" href="../../d7/d8/struct__SCREEN__INFORMATION.html">PSCREEN_INFORMATION</a> ScreenInfo, IN COORD SourcePoint, IN PCHAR_INFO Target, IN COORD TargetSize, IN PSMALL_RECT TargetRect)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/cmdline_8h.html#a60">WriteCharsFromInput</a> (IN <a class="el" href="../../d7/d8/struct__SCREEN__INFORMATION.html">PSCREEN_INFORMATION</a> ScreenInfo, IN PWCHAR lpBufferBackupLimit, IN PWCHAR lpBuffer, IN PWCHAR lpString, IN OUT PDWORD NumBytes, OUT PLONG NumSpaces OPTIONAL, IN <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a13">SHORT</a> OriginalXPosition, IN <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> <a class="el" href="../../d3/d8/propapi_8h.html#a34">dwFlags</a>, OUT <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a21">PSHORT</a> ScrollY OPTIONAL)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/cmdline_8h.html#a61">DrawCommandListPopup</a> (IN <a class="el" href="../../d1/d0/struct__CLE__POPUP.html">PCLE_POPUP</a> Popup, IN <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a13">SHORT</a> CurrentCommand, IN <a class="el" href="../../d9/d7/struct__COMMAND__HISTORY.html">PCOMMAND_HISTORY</a> CommandHistory, IN <a class="el" href="../../d7/d8/struct__SCREEN__INFORMATION.html">PSCREEN_INFORMATION</a> ScreenInfo)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/cmdline_8h.html#a62">UpdateCommandListPopup</a> (IN <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a13">SHORT</a> Delta, IN OUT <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a21">PSHORT</a> CurrentCommand, IN <a class="el" href="../../d9/d7/struct__COMMAND__HISTORY.html">PCOMMAND_HISTORY</a> CommandHistory, IN <a class="el" href="../../d1/d0/struct__CLE__POPUP.html">PCLE_POPUP</a> Popup, IN <a class="el" href="../../d7/d8/struct__SCREEN__INFORMATION.html">PSCREEN_INFORMATION</a> ScreenInfo, IN <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> Flags)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/cmdline_8h.html#a63">InitExtendedEditKeys</a> (CONST ExtKeyDefBuf *lpbuf)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/cmdline_8h.html#a64">IsPauseKey</a> (IN PKEY_EVENT_RECORD pKeyEvent)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/cmdline_8h.html#a65">IsWordDelim</a> (WCHAR)</td></tr>

<tr><td colspan=2><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>WCHAR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/cmdline_8h.html#a38">gaWordDelimChars</a> []</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>CONST WCHAR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/cmdline_8h.html#a39">gaWordDelimCharsDefault</a> []</td></tr>

</table>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="a4" doxytag="cmdline.h::CLE_ALLOCATED" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define CLE_ALLOCATED&nbsp;&nbsp;&nbsp;0x00000001          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d0/cmdline_8h-source.html#l00065">65</a> of file <a class="el" href="../../d5/d0/cmdline_8h-source.html">cmdline.h</a>.
<p>
Referenced by <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l04744">AddCommand()</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l01683">AllocateCommandHistory()</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l04564">FindCommandHistory()</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l01637">FindExeCommandHistory()</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l04605">FreeCommandHistory()</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l03272">ProcessCommandLine()</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l04665">ResizeCommandHistoryBuffers()</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l04834">RetrieveCommand()</a>, and <a class="el" href="../../d0/d4/ntcon_2server_2getset_8c-source.html#l00942">UpdatePopups()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a14" doxytag="cmdline.h::CLE_NO_POPUPS" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define CLE_NO_POPUPS          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d9/d7/struct__COMMAND__HISTORY.html">COMMAND_HISTORY</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;(&amp;(<a class="el" href="../../d9/d7/struct__COMMAND__HISTORY.html">COMMAND_HISTORY</a>)-&gt;PopupList == (<a class="el" href="../../d9/d7/struct__COMMAND__HISTORY.html">COMMAND_HISTORY</a>)-&gt;PopupList.Blink)</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d0/cmdline_8h-source.html#l00154">154</a> of file <a class="el" href="../../d5/d0/cmdline_8h-source.html">cmdline.h</a>.
<p>
Referenced by <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l01683">AllocateCommandHistory()</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l01993">CleanUpPopups()</a>, <a class="el" href="../../d1/d6/server_2stream_8c-source.html#l01541">CookedReadWaitRoutine()</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l01910">EndPopup()</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l02793">ProcessCommandNumberInput()</a>, and <a class="el" href="../../d0/d4/ntcon_2server_2getset_8c-source.html#l00942">UpdatePopups()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a5" doxytag="cmdline.h::CLE_RESET" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define CLE_RESET&nbsp;&nbsp;&nbsp;0x00000002          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d0/cmdline_8h-source.html#l00066">66</a> of file <a class="el" href="../../d5/d0/cmdline_8h-source.html">cmdline.h</a>.
<p>
Referenced by <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l04744">AddCommand()</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l03245">AtFirstCommand()</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l03227">EmptyCommandHistory()</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l04078">FindMatchingCommand()</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l01597">ReallocCommandHistory()</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l04726">ResetCommandHistory()</a>, and <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l04834">RetrieveCommand()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a0" doxytag="cmdline.h::CLEPF_FALSE_UNICODE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define CLEPF_FALSE_UNICODE&nbsp;&nbsp;&nbsp;0x0001          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d0/cmdline_8h-source.html#l00039">39</a> of file <a class="el" href="../../d5/d0/cmdline_8h-source.html">cmdline.h</a>.
<p>
Referenced by <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l01817">BeginPopup()</a>, and <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l01910">EndPopup()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a12" doxytag="cmdline.h::COMMAND_IND_DEC" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define COMMAND_IND_DEC          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IND,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>CMDHIST&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div>{                                                   \
    <span class="keywordflow">if</span> (IND &lt;= 0) {                                 \
        IND = (CMDHIST)-&gt;MaximumNumberOfCommands;   \
    }                                               \
    IND--;                                          \
}
</div></pre>
<p>
Definition at line <a class="el" href="../../d5/d0/cmdline_8h-source.html#l00138">138</a> of file <a class="el" href="../../d5/d0/cmdline_8h-source.html">cmdline.h</a>.
<p>
Referenced by <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l04026">RemoveCommand()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a13" doxytag="cmdline.h::COMMAND_IND_INC" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define COMMAND_IND_INC          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IND,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>CMDHIST&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div>{                                                   \
    ++IND;                                          \
    <span class="keywordflow">if</span> (IND &gt;= (CMDHIST)-&gt;MaximumNumberOfCommands){ \
        IND = 0;                                    \
    }                                               \
}
</div></pre>
<p>
Definition at line <a class="el" href="../../d5/d0/cmdline_8h-source.html#l00146">146</a> of file <a class="el" href="../../d5/d0/cmdline_8h-source.html">cmdline.h</a>.
<p>
Referenced by <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l04744">AddCommand()</a>, and <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l04026">RemoveCommand()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a11" doxytag="cmdline.h::COMMAND_IND_NEXT" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define COMMAND_IND_NEXT          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IND,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>CMDHIST&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div>{                                                   \
    ++IND;                                          \
    <span class="keywordflow">if</span> (IND &gt;= (CMDHIST)-&gt;NumberOfCommands){        \
        IND = 0;                                    \
    }                                               \
}
</div></pre>
<p>
Definition at line <a class="el" href="../../d5/d0/cmdline_8h-source.html#l00130">130</a> of file <a class="el" href="../../d5/d0/cmdline_8h-source.html">cmdline.h</a>.
<p>
Referenced by <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l04834">RetrieveCommand()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a10" doxytag="cmdline.h::COMMAND_IND_PREV" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define COMMAND_IND_PREV          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IND,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>CMDHIST&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div>{                                                   \
    <span class="keywordflow">if</span> (IND &lt;= 0) {                                 \
        IND = (CMDHIST)-&gt;NumberOfCommands;          \
    }                                               \
    IND--;                                          \
}
</div></pre>
<p>
Definition at line <a class="el" href="../../d5/d0/cmdline_8h-source.html#l00122">122</a> of file <a class="el" href="../../d5/d0/cmdline_8h-source.html">cmdline.h</a>.
<p>
Referenced by <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l04744">AddCommand()</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l04078">FindMatchingCommand()</a>, and <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l04834">RetrieveCommand()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a9" doxytag="cmdline.h::COMMAND_INDEX_TO_NUM" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define COMMAND_INDEX_TO_NUM          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">INDEX,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>CMDHIST&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;(<a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a13">SHORT</a>)(((INDEX+((CMDHIST)-&gt;MaximumNumberOfCommands)-(CMDHIST)-&gt;FirstCommand)%((CMDHIST)-&gt;MaximumNumberOfCommands)))</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d0/cmdline_8h-source.html#l00113">113</a> of file <a class="el" href="../../d5/d0/cmdline_8h-source.html">cmdline.h</a>.
<p>
Referenced by <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l01817">BeginPopup()</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l02935">CommandListPopup()</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l04026">RemoveCommand()</a>, and <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l04500">UpdateCommandListPopup()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a8" doxytag="cmdline.h::COMMAND_NUM_TO_INDEX" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define COMMAND_NUM_TO_INDEX          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">NUM,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>CMDHIST&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;(<a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a13">SHORT</a>)(((NUM+(CMDHIST)-&gt;FirstCommand)%((CMDHIST)-&gt;MaximumNumberOfCommands)))</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d0/cmdline_8h-source.html#l00112">112</a> of file <a class="el" href="../../d5/d0/cmdline_8h-source.html">cmdline.h</a>.
<p>
Referenced by <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l04346">DrawCommandListPopup()</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l03272">ProcessCommandLine()</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l02793">ProcessCommandNumberInput()</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l01597">ReallocCommandHistory()</a>, and <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l04500">UpdateCommandListPopup()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="cmdline.h::COMMAND_NUMBER_SIZE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define COMMAND_NUMBER_SIZE&nbsp;&nbsp;&nbsp;8          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d0/cmdline_8h-source.html#l00059">59</a> of file <a class="el" href="../../d5/d0/cmdline_8h-source.html">cmdline.h</a>.
<p>
Referenced by <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l04346">DrawCommandListPopup()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a7" doxytag="cmdline.h::DEFAULT_NUMBER_OF_BUFFERS" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define DEFAULT_NUMBER_OF_BUFFERS&nbsp;&nbsp;&nbsp;4          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d0/cmdline_8h-source.html#l00083">83</a> of file <a class="el" href="../../d5/d0/cmdline_8h-source.html">cmdline.h</a>.
<p>
Referenced by <a class="el" href="../../d1/d4/srvinit_8c-source.html#l02132">InitializeConsoleAttributes()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a6" doxytag="cmdline.h::DEFAULT_NUMBER_OF_COMMANDS" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define DEFAULT_NUMBER_OF_COMMANDS&nbsp;&nbsp;&nbsp;25          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d0/cmdline_8h-source.html#l00082">82</a> of file <a class="el" href="../../d5/d0/cmdline_8h-source.html">cmdline.h</a>.
<p>
Referenced by <a class="el" href="../../d1/d4/srvinit_8c-source.html#l02132">InitializeConsoleAttributes()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a15" doxytag="cmdline.h::FMCFL_EXACT_MATCH" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define FMCFL_EXACT_MATCH&nbsp;&nbsp;&nbsp;1          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d0/cmdline_8h-source.html#l00306">306</a> of file <a class="el" href="../../d5/d0/cmdline_8h-source.html">cmdline.h</a>.
<p>
Referenced by <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l04744">AddCommand()</a>, and <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l04078">FindMatchingCommand()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a16" doxytag="cmdline.h::FMCFL_JUST_LOOKING" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define FMCFL_JUST_LOOKING&nbsp;&nbsp;&nbsp;2          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d0/cmdline_8h-source.html#l00307">307</a> of file <a class="el" href="../../d5/d0/cmdline_8h-source.html">cmdline.h</a>.
<p>
Referenced by <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l04078">FindMatchingCommand()</a>, and <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l02287">ProcessCommandListInput()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a23" doxytag="cmdline.h::IS_WORD_DELIM" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define IS_WORD_DELIM          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">wch&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;((wch) == L' ' || (<a class="el" href="../../d4/d1/cmdline_8h.html#a38">gaWordDelimChars</a>[0] &amp;&amp; IsWordDelim(wch)))</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d0/cmdline_8h-source.html#l00399">399</a> of file <a class="el" href="../../d5/d0/cmdline_8h-source.html">cmdline.h</a>.
<p>
Referenced by <a class="el" href="../../d4/d2/ntcon_2server_2input_8c-source.html#l03080">HandleMouseEvent()</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l03272">ProcessCommandLine()</a>, and <a class="el" href="../../d1/d6/server_2stream_8c-source.html#l00876">ProcessCookedReadInput()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="cmdline.h::POPUP_SIZE_X" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define POPUP_SIZE_X          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">POPUP&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;(<a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a13">SHORT</a>)(((POPUP)-&gt;Region.Right - (POPUP)-&gt;Region.Left - 1))</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d0/cmdline_8h-source.html#l00057">57</a> of file <a class="el" href="../../d5/d0/cmdline_8h-source.html">cmdline.h</a>.
<p>
Referenced by <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l03150">CommandNumberPopup()</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l04123">DrawCommandListBorder()</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l04346">DrawCommandListPopup()</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l02986">DrawPromptPopup()</a>, and <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l04301">UpdateHighlight()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a2" doxytag="cmdline.h::POPUP_SIZE_Y" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define POPUP_SIZE_Y          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">POPUP&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;(<a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a13">SHORT</a>)(((POPUP)-&gt;Region.Bottom - (POPUP)-&gt;Region.Top - 1))</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d0/cmdline_8h-source.html#l00058">58</a> of file <a class="el" href="../../d5/d0/cmdline_8h-source.html">cmdline.h</a>.
<p>
Referenced by <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l02935">CommandListPopup()</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l04123">DrawCommandListBorder()</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l04346">DrawCommandListPopup()</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l02986">DrawPromptPopup()</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l02287">ProcessCommandListInput()</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l04500">UpdateCommandListPopup()</a>, and <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l04301">UpdateHighlight()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a22" doxytag="cmdline.h::UCLP_WRAP" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define UCLP_WRAP&nbsp;&nbsp;&nbsp;1          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d0/cmdline_8h-source.html#l00378">378</a> of file <a class="el" href="../../d5/d0/cmdline_8h-source.html">cmdline.h</a>.
<p>
Referenced by <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l02287">ProcessCommandListInput()</a>, and <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l04500">UpdateCommandListPopup()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a17" doxytag="cmdline.h::WC_DESTRUCTIVE_BACKSPACE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define WC_DESTRUCTIVE_BACKSPACE&nbsp;&nbsp;&nbsp;0x01          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d0/cmdline_8h-source.html#l00353">353</a> of file <a class="el" href="../../d5/d0/cmdline_8h-source.html">cmdline.h</a>.
<p>
Referenced by <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l03272">ProcessCommandLine()</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l02793">ProcessCommandNumberInput()</a>, <a class="el" href="../../d1/d6/server_2stream_8c-source.html#l00876">ProcessCookedReadInput()</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l02546">ProcessCopyFromCharInput()</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l02677">ProcessCopyToCharInput()</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l02061">RedrawCommandLine()</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l02136">SetCurrentCommandLine()</a>, and <a class="el" href="../../d1/d2/__stream_8h-source.html#l00203">WWSB_WriteChars()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a19" doxytag="cmdline.h::WC_ECHO" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define WC_ECHO&nbsp;&nbsp;&nbsp;0x04          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d0/cmdline_8h-source.html#l00355">355</a> of file <a class="el" href="../../d5/d0/cmdline_8h-source.html">cmdline.h</a>.
<p>
Referenced by <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l03272">ProcessCommandLine()</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l02793">ProcessCommandNumberInput()</a>, <a class="el" href="../../d1/d6/server_2stream_8c-source.html#l00876">ProcessCookedReadInput()</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l02546">ProcessCopyFromCharInput()</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l02677">ProcessCopyToCharInput()</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l02061">RedrawCommandLine()</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l02136">SetCurrentCommandLine()</a>, and <a class="el" href="../../d1/d2/__stream_8h-source.html#l00203">WWSB_WriteChars()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a20" doxytag="cmdline.h::WC_FALSIFY_UNICODE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define WC_FALSIFY_UNICODE&nbsp;&nbsp;&nbsp;0x08          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d0/cmdline_8h-source.html#l00356">356</a> of file <a class="el" href="../../d5/d0/cmdline_8h-source.html">cmdline.h</a>.
<p>
Referenced by <a class="el" href="../../d1/d6/server_2stream_8c-source.html#l03047">WriteCharsFromInput()</a>, and <a class="el" href="../../d1/d2/__stream_8h-source.html#l00203">WWSB_WriteChars()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a18" doxytag="cmdline.h::WC_KEEP_CURSOR_VISIBLE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define WC_KEEP_CURSOR_VISIBLE&nbsp;&nbsp;&nbsp;0x02          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d0/cmdline_8h-source.html#l00354">354</a> of file <a class="el" href="../../d5/d0/cmdline_8h-source.html">cmdline.h</a>.
<p>
Referenced by <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l03272">ProcessCommandLine()</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l02793">ProcessCommandNumberInput()</a>, <a class="el" href="../../d1/d6/server_2stream_8c-source.html#l00876">ProcessCookedReadInput()</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l02546">ProcessCopyFromCharInput()</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l02677">ProcessCopyToCharInput()</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l02061">RedrawCommandLine()</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l02136">SetCurrentCommandLine()</a>, and <a class="el" href="../../d1/d2/__stream_8h-source.html#l00203">WWSB_WriteChars()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a21" doxytag="cmdline.h::WC_LIMIT_BACKSPACE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define WC_LIMIT_BACKSPACE&nbsp;&nbsp;&nbsp;0x10          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d0/cmdline_8h-source.html#l00357">357</a> of file <a class="el" href="../../d5/d0/cmdline_8h-source.html">cmdline.h</a>.
<p>
Referenced by <a class="el" href="../../d1/d2/__stream_8h-source.html#l00809">WWSB_DoWriteConsole()</a>, and <a class="el" href="../../d1/d2/__stream_8h-source.html#l00203">WWSB_WriteChars()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a24" doxytag="cmdline.h::WORD_DELIM_MAX" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define WORD_DELIM_MAX&nbsp;&nbsp;&nbsp;32          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d0/cmdline_8h-source.html#l00405">405</a> of file <a class="el" href="../../d5/d0/cmdline_8h-source.html">cmdline.h</a>.
<p>
Referenced by <a class="el" href="../../d1/d4/srvinit_8c-source.html#l02210">GetRegistryValues()</a>, and <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l00309">IsWordDelim()</a>.    </td>
  </tr>
</table>
<hr><h2>Typedef Documentation</h2>
<a class="anchor" name="a34" doxytag="cmdline.h::ALIAS" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d1/d6/struct__ALIAS.html">_ALIAS</a>  <a class="el" href="../../d1/d6/struct__ALIAS.html">ALIAS</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l00447">FindAlias()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a28" doxytag="cmdline.h::CLE_POPUP" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d1/d0/struct__CLE__POPUP.html">_CLE_POPUP</a>  <a class="el" href="../../d1/d0/struct__CLE__POPUP.html">CLE_POPUP</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l01817">BeginPopup()</a>, and <a class="el" href="../../d1/d6/server_2stream_8c-source.html#l01541">CookedReadWaitRoutine()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a25" doxytag="cmdline.h::COMMAND" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d8/d7/struct__COMMAND.html">_COMMAND</a>  <a class="el" href="../../d8/d7/struct__COMMAND.html">COMMAND</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l04744">AddCommand()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a30" doxytag="cmdline.h::COMMAND_HISTORY" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d9/d7/struct__COMMAND__HISTORY.html">_COMMAND_HISTORY</a>  <a class="el" href="../../d9/d7/struct__COMMAND__HISTORY.html">COMMAND_HISTORY</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l01597">ReallocCommandHistory()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a32" doxytag="cmdline.h::COOKED_READ_DATA" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d2/d8/struct__COOKED__READ__DATA.html">_COOKED_READ_DATA</a>  <a class="el" href="../../d2/d8/struct__COOKED__READ__DATA.html">COOKED_READ_DATA</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d1/d6/server_2stream_8c-source.html#l01778">ReadChars()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a36" doxytag="cmdline.h::EXE_ALIAS_LIST" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d6/d8/struct__EXE__ALIAS__LIST.html">_EXE_ALIAS_LIST</a>  <a class="el" href="../../d6/d8/struct__EXE__ALIAS__LIST.html">EXE_ALIAS_LIST</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l00329">AddExeAliasList()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a35" doxytag="cmdline.h::PALIAS" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d1/d6/struct__ALIAS.html">_ALIAS</a> * <a class="el" href="../../d1/d6/struct__ALIAS.html">PALIAS</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a29" doxytag="cmdline.h::PCLE_POPUP" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d1/d0/struct__CLE__POPUP.html">_CLE_POPUP</a> * <a class="el" href="../../d1/d0/struct__CLE__POPUP.html">PCLE_POPUP</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l01817">BeginPopup()</a>, and <a class="el" href="../../d1/d6/server_2stream_8c-source.html#l01541">CookedReadWaitRoutine()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a27" doxytag="cmdline.h::PCLE_POPUP_INPUT_ROUTINE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef ULONG(* <a class="el" href="../../d4/d1/cmdline_8h.html#a27">PCLE_POPUP_INPUT_ROUTINE</a>)(IN PVOID CookedReadData, IN PCSR_API_MSG WaitReplyMessage, IN PCSR_THREAD WaitingThread, IN BOOLEAN WaitRoutine)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d0/cmdline_8h-source.html#l00029">29</a> of file <a class="el" href="../../d5/d0/cmdline_8h-source.html">cmdline.h</a>.
<p>
Referenced by <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l02935">CommandListPopup()</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l03150">CommandNumberPopup()</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l03040">CopyFromCharPopup()</a>, and <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l03096">CopyToCharPopup()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a26" doxytag="cmdline.h::PCOMMAND" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d8/d7/struct__COMMAND.html">_COMMAND</a> * <a class="el" href="../../d8/d7/struct__COMMAND.html">PCOMMAND</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a31" doxytag="cmdline.h::PCOMMAND_HISTORY" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d9/d7/struct__COMMAND__HISTORY.html">_COMMAND_HISTORY</a> * <a class="el" href="../../d9/d7/struct__COMMAND__HISTORY.html">PCOMMAND_HISTORY</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a33" doxytag="cmdline.h::PCOOKED_READ_DATA" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d2/d8/struct__COOKED__READ__DATA.html">_COOKED_READ_DATA</a> * <a class="el" href="../../d2/d8/struct__COOKED__READ__DATA.html">PCOOKED_READ_DATA</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d1/d2/__stream_8h-source.html#l00046">WWSB_AdjustCursorPosition()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a37" doxytag="cmdline.h::PEXE_ALIAS_LIST" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d6/d8/struct__EXE__ALIAS__LIST.html">_EXE_ALIAS_LIST</a> * <a class="el" href="../../d6/d8/struct__EXE__ALIAS__LIST.html">PEXE_ALIAS_LIST</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a52" doxytag="cmdline.h::CleanUpPopups" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID CleanUpPopups           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d2/d8/struct__COOKED__READ__DATA.html">PCOOKED_READ_DATA</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>CookedReadData</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l01993">1993</a> of file <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html">server/cmdline.c</a>.
<p>
References <a class="el" href="../../d5/d0/cmdline_8h-source.html#l00154">CLE_NO_POPUPS</a>, and <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l01910">EndPopup()</a>.
<p>
Referenced by <a class="el" href="../../d1/d6/server_2stream_8c-source.html#l01541">CookedReadWaitRoutine()</a>.
<p>
<pre class="fragment"><div>01996 {
01997     <a class="code" href="../../d9/d7/struct__COMMAND__HISTORY.html">PCOMMAND_HISTORY</a> CommandHistory;
01998 
01999     CommandHistory = CookedReadData-&gt;CommandHistory;
02000     <span class="keywordflow">if</span> (!CommandHistory)
02001         <span class="keywordflow">return</span>;
02002     <span class="keywordflow">while</span> (!<a class="code" href="../../d4/d1/cmdline_8h.html#a14">CLE_NO_POPUPS</a>(CommandHistory)) {
02003         <a class="code" href="../../d3/d1/server_2cmdline_8c.html#a46">EndPopup</a>(CookedReadData-&gt;ScreenInfo,CommandHistory);
02004     }
02005 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a57" doxytag="cmdline.h::CommandNumberPopup" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS CommandNumberPopup           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d2/d8/struct__COOKED__READ__DATA.html">PCOOKED_READ_DATA</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>CookedReadData</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PCSR_API_MSG&nbsp;</td>
          <td class="mdname" nowrap> <em>WaitReplyMessage</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PCSR_THREAD&nbsp;</td>
          <td class="mdname" nowrap> <em>WaitingThread</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>WaitRoutine</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l03150">3150</a> of file <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html">server/cmdline.c</a>.
<p>
References <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l00065">COMMAND_NUMBER_LENGTH</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l02986">DrawPromptPopup()</a>, <a class="el" href="../../d1/d4/srvinit_8c-source.html#l02643">GetConsoleLangId()</a>, <a class="el" href="../../d7/d5/ntcon_2server_2globals_8h-source.html#l00027">ghInstance</a>, <a class="el" href="../../d9/d4/consrv_8h-source.html#l00157">LoadStringEx</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l00066">MINIMUM_COMMAND_PROMPT_SIZE</a>, <a class="el" href="../../d7/d6/menu_8h-source.html#l00030">msgCmdLineF9</a>, <a class="el" href="../../d6/d5/stierr_8h-source.html#l00030">NT_SUCCESS</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d5/d0/cmdline_8h-source.html#l00050">_CLE_POPUP::NumberRead</a>, <a class="el" href="../../d5/d0/cmdline_8h-source.html#l00029">PCLE_POPUP_INPUT_ROUTINE</a>, <a class="el" href="../../d5/d0/cmdline_8h-source.html#l00057">POPUP_SIZE_X</a>, <a class="el" href="../../d5/d0/cmdline_8h-source.html#l00051">_CLE_POPUP::PopupInputRoutine</a>, <a class="el" href="../../d5/d0/cmdline_8h-source.html#l00078">_COMMAND_HISTORY::PopupList</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l02793">ProcessCommandNumberInput()</a>, <a class="el" href="../../d5/d0/cmdline_8h-source.html#l00043">_CLE_POPUP::Region</a>, <a class="el" href="../../d7/d0/ntcon_2server_2cursor_8c-source.html#l00474">SetCursorPosition()</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00062">SHORT</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00135">Status</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l03272">ProcessCommandLine()</a>, and <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l02287">ProcessCommandListInput()</a>.
<p>
<pre class="fragment"><div>03163                 :
03164 
03165         <a class="code" href="../../d1/d7/server_8h.html#a64">CONSOLE_STATUS_WAIT</a> - we ran <a class="code" href="../../d6/d0/wsprintf_8c.html#a0">out</a> of input, so
03166             a wait block was created
03167 
03168         STATUS_SUCCESS - read was fully completed (user hit <span class="keywordflow">return</span>)
03169 
03170 --*/
03171 
03172 {
03173     <a class="code" href="../../d1/d0/struct__CLE__POPUP.html">PCLE_POPUP</a> Popup;
03174     <a class="code" href="../../d9/d7/struct__COMMAND__HISTORY.html">PCOMMAND_HISTORY</a> CommandHistory;
03175     COORD CursorPosition;
03176     WCHAR ItemString[70];
03177     <span class="keywordtype">int</span> ItemLength;
03178     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
03179     LANGID   LangId;
03180 
03181     CommandHistory = CookedReadData-&gt;CommandHistory;
03182     Popup = CONTAINING_RECORD( CommandHistory-&gt;<a class="code" href="../../d9/d7/struct__COMMAND__HISTORY.html#o9">PopupList</a>.Flink, <a class="code" href="../../d1/d0/struct__CLE__POPUP.html">CLE_POPUP</a>, ListLink );
03183 
03184     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d0/d5/srvinit_8c.html#a45">GetConsoleLangId</a>(CookedReadData-&gt;ScreenInfo-&gt;Console-&gt;OutputCP, &amp;LangId);
03185     <span class="keywordflow">if</span> (<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status)) {
03186         ItemLength = <a class="code" href="../../d8/d5/consrv_8h.html#a34">LoadStringEx</a>(ghInstance,msgCmdLineF9,ItemString,70,LangId);
03187     }
03188     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status) || ItemLength == 0) {
03189         ItemLength = LoadString(ghInstance,msgCmdLineF9,ItemString,70);
03190     }
03191 
03192     <span class="keywordflow">if</span> (ItemLength &gt; <a class="code" href="../../d4/d1/cmdline_8h.html#a1">POPUP_SIZE_X</a>(Popup) - <a class="code" href="../../d3/d1/server_2cmdline_8c.html#a3">COMMAND_NUMBER_LENGTH</a>) {
03193         ItemLength = <a class="code" href="../../d4/d1/cmdline_8h.html#a1">POPUP_SIZE_X</a>(Popup) - <a class="code" href="../../d3/d1/server_2cmdline_8c.html#a3">COMMAND_NUMBER_LENGTH</a>;
03194     }
03195     <a class="code" href="../../d3/d1/server_2cmdline_8c.html#a59">DrawPromptPopup</a>(Popup,
03196                     CookedReadData-&gt;ScreenInfo,
03197                     ItemString,
03198                     ItemLength
03199                    );
03200     CursorPosition.X = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a>)(Popup-&gt;<a class="code" href="../../d1/d0/struct__CLE__POPUP.html#o1">Region</a>.Right - <a class="code" href="../../d3/d1/server_2cmdline_8c.html#a4">MINIMUM_COMMAND_PROMPT_SIZE</a>);
03201     CursorPosition.Y = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a>)(Popup-&gt;<a class="code" href="../../d1/d0/struct__CLE__POPUP.html#o1">Region</a>.Top+1);
03202     <a class="code" href="../../d6/d1/ntcon_2server_2cursor_8c.html#a7">SetCursorPosition</a>(CookedReadData-&gt;ScreenInfo,
03203                       CursorPosition,
03204                       TRUE
03205                      );
03206     Popup-&gt;<a class="code" href="../../d1/d0/struct__CLE__POPUP.html#o8">NumberRead</a>=0;
03207     Popup-&gt;<a class="code" href="../../d1/d0/struct__CLE__POPUP.html#o9">PopupInputRoutine</a> = (<a class="code" href="../../d4/d1/cmdline_8h.html#a27">PCLE_POPUP_INPUT_ROUTINE</a>) <a class="code" href="../../d3/d1/server_2cmdline_8c.html#a57">ProcessCommandNumberInput</a>;
03208     <span class="keywordflow">return</span> <a class="code" href="../../d3/d1/server_2cmdline_8c.html#a57">ProcessCommandNumberInput</a>(CookedReadData,
03209                                      WaitReplyMessage,
03210                                      WaitingThread,
03211                                      WaitRoutine
03212                                     );
03213 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a58" doxytag="cmdline.h::CookedReadWaitRoutine" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN CookedReadWaitRoutine           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PLIST_ENTRY&nbsp;</td>
          <td class="mdname" nowrap> <em>WaitQueue</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PCSR_THREAD&nbsp;</td>
          <td class="mdname" nowrap> <em>WaitingThread</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PCSR_API_MSG&nbsp;</td>
          <td class="mdname" nowrap> <em>WaitReplyMessage</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>WaitParameter</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>SatisfyParameter1</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>SatisfyParameter2</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>WaitFlags</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d6/server_2stream_8c-source.html#l01541">1541</a> of file <a class="el" href="../../d1/d6/server_2stream_8c-source.html">server/stream.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d5/d0/cmdline_8h-source.html#l00096">_COOKED_READ_DATA::BackupLimit</a>, <a class="el" href="../../d6/d4/conmsg_8h-source.html#l00440">_CONSOLE_READCONSOLE_MSG::Buffer</a>, <a class="el" href="../../d0/d9/tcmpmem_8c-source.html#l00035">BUFFER_SIZE</a>, <a class="el" href="../../d5/d0/cmdline_8h-source.html#l00093">_COOKED_READ_DATA::BytesRead</a>, <a class="el" href="../../d6/d4/conmsg_8h-source.html#l00443">_CONSOLE_READCONSOLE_MSG::CaptureBufferSize</a>, <a class="el" href="../../d5/d0/cmdline_8h-source.html#l00154">CLE_NO_POPUPS</a>, <a class="el" href="../../d4/d1/cmdline_8h.html#a28">CLE_POPUP</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l01993">CleanUpPopups()</a>, <a class="el" href="../../d1/d6/server_2stream_8c-source.html#l02929">CloseOutputHandle()</a>, <a class="el" href="../../d5/d0/cmdline_8h-source.html#l00099">_COOKED_READ_DATA::CommandHistory</a>, <a class="el" href="../../d5/d0/cmdline_8h-source.html#l00088">_COOKED_READ_DATA::Console</a>, <a class="el" href="../../d0/d3/input_8h-source.html#l00110">CONSOLE_CTRL_BREAK_SEEN</a>, <a class="el" href="../../d0/d3/input_8h-source.html#l00109">CONSOLE_CTRL_C_SEEN</a>, <a class="el" href="../../d2/d6/server_8h-source.html#l00392">CONSOLE_FROMTHREADPERPROCESSDATA</a>, <a class="el" href="../../d2/d6/server_8h-source.html#l00351">CONSOLE_STATUS_READ_COMPLETE</a>, <a class="el" href="../../d2/d6/server_8h-source.html#l00350">CONSOLE_STATUS_WAIT</a>, <a class="el" href="../../d2/d6/server_8h-source.html#l00352">CONSOLE_STATUS_WAIT_NO_BLOCK</a>, <a class="el" href="../../d9/d4/consrv_8h-source.html#l00193">ConsoleHeapFree</a>, <a class="el" href="../../d2/d6/server_8h-source.html#l00348">ConsoleLocked</a>, <a class="el" href="../../d1/d6/server_2stream_8c-source.html#l01237">CookedRead()</a>, <a class="el" href="../../d3/d7/w32_2ntcon_2server_2handle_8c-source.html#l01501">DereferenceIoHandleNoCheck()</a>, <a class="el" href="../../d5/d0/cmdline_8h-source.html#l00100">_COOKED_READ_DATA::Echo</a>, <a class="el" href="../../d5/d0/cmdline_8h-source.html#l00106">_COOKED_READ_DATA::ExeName</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d2/d6/server_8h-source.html#l00306">HANDLE_CLOSING</a>, <a class="el" href="../../d2/d6/server_8h-source.html#l00307">HANDLE_INPUT_PENDING</a>, <a class="el" href="../../d5/d0/cmdline_8h-source.html#l00105">_COOKED_READ_DATA::HandleIndex</a>, <a class="el" href="../../d0/d3/input_8h-source.html#l00066">_INPUT_READ_HANDLE_DATA::InputHandleFlags</a>, <a class="el" href="../../d2/d6/server_8h-source.html#l00318">_HANDLE_DATA::InputReadData</a>, <a class="el" href="../../d0/d3/input_8h-source.html#l00112">LockReadCount</a>, <a class="el" href="../../d6/d5/stierr_8h-source.html#l00030">NT_SUCCESS</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d4/d1/cmdline_8h.html#a29">PCLE_POPUP</a>, <a class="el" href="../../d5/d0/cmdline_8h-source.html#l00051">_CLE_POPUP::PopupInputRoutine</a>, <a class="el" href="../../d5/d0/cmdline_8h-source.html#l00078">_COMMAND_HISTORY::PopupList</a>, <a class="el" href="../../d5/d0/cmdline_8h-source.html#l00104">_COOKED_READ_DATA::ProcessData</a>, <a class="el" href="../../d0/d3/input_8h-source.html#l00065">_INPUT_READ_HANDLE_DATA::ReadCount</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00135">Status</a>, <a class="el" href="../../d5/d0/cmdline_8h-source.html#l00089">_COOKED_READ_DATA::TempHandle</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d0/d3/input_8h-source.html#l00113">UnlockReadCount</a>, and <a class="el" href="../../d5/d0/cmdline_8h-source.html#l00091">_COOKED_READ_DATA::UserBuffer</a>.
<p>
Referenced by <a class="el" href="../../d1/d6/server_2stream_8c-source.html#l01237">CookedRead()</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l02287">ProcessCommandListInput()</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l02793">ProcessCommandNumberInput()</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l02546">ProcessCopyFromCharInput()</a>, and <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l02677">ProcessCopyToCharInput()</a>.
<p>
<pre class="fragment"><div>01553                    :
01554 
01555     This routine <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> called to complete a cooked read that blocked in
01556     <a class="code" href="../../d8/d5/consrv_8h.html#a136">ReadInputBuffer</a>.  The context of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> read was saved in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> CookedReadData
01557     structure.  This routine <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> called when events have been written to
01558     <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> input buffer.  It <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> called in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> context of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> writing thread.
01559     It may be called more than once.
01560 
01561 Arguments:
01562 
01563     WaitQueue - pointer to queue containing wait block
01564 
01565     WaitingThread - pointer to waiting thread
01566 
01567     WaitReplyMessage - pointer to reply message
01568 
01569     CookedReadData - pointer to data saved in <a class="code" href="../../d8/d5/consrv_8h.html#a221">ReadChars</a>
01570 
01571     SatisfyParameter1 - <span class="keywordflow">if</span> <span class="keyword">this</span> routine was called (indirectly) by
01572     CloseInputHandle, this argument contains a HandleData pointer of
01573     the dying handle.  otherwise, it contains NULL.
01574 
01575     SatisfyParameter2 - if this routine is called because a ctrl-c or
01576     ctrl-break was seen, this argument contains CONSOLE_CTRL_SEEN.
01577     otherwise it contains NULL.
01578 
01579     WaitFlags - Flags indicating status of wait.
01580 
01581 Return Value:
01582 
01583 --*/
01584 
01585 
01586 {
01587     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
01588     <a class="code" href="../../d1/d3/struct__CONSOLE__INFORMATION.html">PCONSOLE_INFORMATION</a> Console;
01589     <a class="code" href="../../d2/d8/struct__COOKED__READ__DATA.html">PCOOKED_READ_DATA</a> CookedReadData;
01590     <a class="code" href="../../d3/d4/struct__CONSOLE__READCONSOLE__MSG.html">PCONSOLE_READCONSOLE_MSG</a> a;
01591     <a class="code" href="../../d4/d3/struct__HANDLE__DATA.html">PHANDLE_DATA</a> HandleData;
01592 
01593     a = (<a class="code" href="../../d3/d4/struct__CONSOLE__READCONSOLE__MSG.html">PCONSOLE_READCONSOLE_MSG</a>)&amp;WaitReplyMessage-&gt;u.ApiMessageData;
01594     CookedReadData = (<a class="code" href="../../d2/d8/struct__COOKED__READ__DATA.html">PCOOKED_READ_DATA</a>)WaitParameter;
01595 
01596     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d2/d8/w32_2ntcon_2server_2handle_8c.html#a30">DereferenceIoHandleNoCheck</a>(CookedReadData-&gt;<a class="code" href="../../d2/d8/struct__COOKED__READ__DATA.html#o18">ProcessData</a>,
01597                                         CookedReadData-&gt;<a class="code" href="../../d2/d8/struct__COOKED__READ__DATA.html#o19">HandleIndex</a>,
01598                                         &amp;HandleData
01599                                        );
01600     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a> (<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status));
01601     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(!(HandleData-&gt;<a class="code" href="../../d4/d3/struct__HANDLE__DATA.html#o6">InputReadData</a>-&gt;<a class="code" href="../../d8/d2/struct__INPUT__READ__HANDLE__DATA.html#o2">InputHandleFlags</a> &amp; HANDLE_INPUT_PENDING));
01602 
01603     <span class="comment">//</span>
01604     <span class="comment">// see if this routine was called by CloseInputHandle.  if it</span>
01605     <span class="comment">// was, see if this wait block corresponds to the dying handle.</span>
01606     <span class="comment">// if it doesn't, just return.</span>
01607     <span class="comment">//</span>
01608 
01609     <span class="keywordflow">if</span> (SatisfyParameter1 != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> &amp;&amp;
01610         SatisfyParameter1 != HandleData) {
01611         <span class="comment">//DbgPrint("CookedReadWaitRoutine exit 1\n");</span>
01612         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01613     }
01614 
01615     Console = CookedReadData-&gt;<a class="code" href="../../d2/d8/struct__COOKED__READ__DATA.html#o2">Console</a>;
01616 
01617     <span class="comment">//</span>
01618     <span class="comment">// this routine should be called by a thread owning the same</span>
01619     <span class="comment">// lock on the same console as we're reading from.</span>
01620     <span class="comment">//</span>
01621 
01622     <a class="code" href="../../d9/d3/input_8h.html#a25">LockReadCount</a>(HandleData);
01623     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(HandleData-&gt;<a class="code" href="../../d4/d3/struct__HANDLE__DATA.html#o6">InputReadData</a>-&gt;<a class="code" href="../../d8/d2/struct__INPUT__READ__HANDLE__DATA.html#o1">ReadCount</a>);
01624     HandleData-&gt;<a class="code" href="../../d4/d3/struct__HANDLE__DATA.html#o6">InputReadData</a>-&gt;<a class="code" href="../../d8/d2/struct__INPUT__READ__HANDLE__DATA.html#o1">ReadCount</a> -= 1;
01625     <a class="code" href="../../d9/d3/input_8h.html#a26">UnlockReadCount</a>(HandleData);
01626 
01627     <span class="comment">//</span>
01628     <span class="comment">// if ctrl-c or ctrl-break was seen, terminate read.</span>
01629     <span class="comment">//</span>
01630 
01631     <span class="keywordflow">if</span> ((ULONG_PTR)SatisfyParameter2 &amp; (<a class="code" href="../../d9/d3/input_8h.html#a23">CONSOLE_CTRL_C_SEEN</a> | <a class="code" href="../../d9/d3/input_8h.html#a24">CONSOLE_CTRL_BREAK_SEEN</a>)) {
01632         <span class="keywordflow">if</span> (CookedReadData-&gt;<a class="code" href="../../d2/d8/struct__COOKED__READ__DATA.html#o14">Echo</a>) {
01633             <a class="code" href="../../d0/d7/server_2stream_8c.html#a36">CloseOutputHandle</a>(<a class="code" href="../../d1/d7/server_8h.html#a83">CONSOLE_FROMTHREADPERPROCESSDATA</a>(WaitingThread),
01634                               CookedReadData-&gt;<a class="code" href="../../d2/d8/struct__COOKED__READ__DATA.html#o2">Console</a>,
01635                               &amp;CookedReadData-&gt;<a class="code" href="../../d2/d8/struct__COOKED__READ__DATA.html#o3">TempHandle</a>,
01636                               NULL,
01637                               FALSE
01638                              );
01639         }
01640         <span class="comment">//DbgPrint("CookedReadWaitRoutine exit 2\n");</span>
01641         WaitReplyMessage-&gt;ReturnValue = STATUS_ALERTED;
01642         <a class="code" href="../../d8/d5/consrv_8h.html#a38">ConsoleHeapFree</a>(CookedReadData-&gt;<a class="code" href="../../d2/d8/struct__COOKED__READ__DATA.html#o10">BackupLimit</a>);
01643         <a class="code" href="../../d8/d5/consrv_8h.html#a38">ConsoleHeapFree</a>(CookedReadData-&gt;<a class="code" href="../../d2/d8/struct__COOKED__READ__DATA.html#o20">ExeName</a>);
01644 <span class="preprocessor">#if defined(FE_SB)</span>
01645 <span class="preprocessor"></span>        CookedReadData-&gt;<a class="code" href="../../d2/d8/struct__COOKED__READ__DATA.html#o2">Console</a>-&gt;lpCookedReadData = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01646 <span class="preprocessor">#endif</span>
01647 <span class="preprocessor"></span>        <a class="code" href="../../d8/d5/consrv_8h.html#a38">ConsoleHeapFree</a>(CookedReadData);
01648         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01649     }
01650 
01651     <span class="comment">//</span>
01652     <span class="comment">// see if called by CsrDestroyProcess or CsrDestroyThread</span>
01653     <span class="comment">// via CsrNotifyWaitBlock.   if so, just decrement the ReadCount</span>
01654     <span class="comment">// and return.</span>
01655     <span class="comment">//</span>
01656 
01657     <span class="keywordflow">if</span> (WaitFlags &amp; CSR_PROCESS_TERMINATING) {
01658         <span class="keywordflow">if</span> (CookedReadData-&gt;<a class="code" href="../../d2/d8/struct__COOKED__READ__DATA.html#o14">Echo</a>) {
01659             <a class="code" href="../../d0/d7/server_2stream_8c.html#a36">CloseOutputHandle</a>(<a class="code" href="../../d1/d7/server_8h.html#a83">CONSOLE_FROMTHREADPERPROCESSDATA</a>(WaitingThread),
01660                               CookedReadData-&gt;<a class="code" href="../../d2/d8/struct__COOKED__READ__DATA.html#o2">Console</a>,
01661                               &amp;CookedReadData-&gt;<a class="code" href="../../d2/d8/struct__COOKED__READ__DATA.html#o3">TempHandle</a>,
01662                               NULL,
01663                               FALSE
01664                              );
01665         }
01666         <span class="comment">//DbgPrint("CookedReadWaitRoutine exit 3\n");</span>
01667         WaitReplyMessage-&gt;ReturnValue = (ULONG)STATUS_THREAD_IS_TERMINATING;
01668 
01669         <span class="comment">//</span>
01670         <span class="comment">// clean up popup data structures</span>
01671         <span class="comment">//</span>
01672 
01673         <a class="code" href="../../d4/d1/cmdline_8h.html#a52">CleanUpPopups</a>(CookedReadData);
01674         <a class="code" href="../../d8/d5/consrv_8h.html#a38">ConsoleHeapFree</a>(CookedReadData-&gt;<a class="code" href="../../d2/d8/struct__COOKED__READ__DATA.html#o10">BackupLimit</a>);
01675         <a class="code" href="../../d8/d5/consrv_8h.html#a38">ConsoleHeapFree</a>(CookedReadData-&gt;<a class="code" href="../../d2/d8/struct__COOKED__READ__DATA.html#o20">ExeName</a>);
01676 <span class="preprocessor">#if defined(FE_SB)</span>
01677 <span class="preprocessor"></span>        CookedReadData-&gt;<a class="code" href="../../d2/d8/struct__COOKED__READ__DATA.html#o2">Console</a>-&gt;lpCookedReadData = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01678 <span class="preprocessor">#endif</span>
01679 <span class="preprocessor"></span>        <a class="code" href="../../d8/d5/consrv_8h.html#a38">ConsoleHeapFree</a>(CookedReadData);
01680         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01681     }
01682 
01683     <span class="comment">//</span>
01684     <span class="comment">// We must see if we were woken up because the handle is being</span>
01685     <span class="comment">// closed.  if so, we decrement the read count.  if it goes to</span>
01686     <span class="comment">// zero, we wake up the close thread.  otherwise, we wake up any</span>
01687     <span class="comment">// other thread waiting for data.</span>
01688     <span class="comment">//</span>
01689 
01690     <span class="keywordflow">if</span> (HandleData-&gt;<a class="code" href="../../d4/d3/struct__HANDLE__DATA.html#o6">InputReadData</a>-&gt;<a class="code" href="../../d8/d2/struct__INPUT__READ__HANDLE__DATA.html#o2">InputHandleFlags</a> &amp; <a class="code" href="../../d1/d7/server_8h.html#a51">HANDLE_CLOSING</a>) {
01691         <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a> (SatisfyParameter1 == HandleData);
01692         <span class="keywordflow">if</span> (CookedReadData-&gt;<a class="code" href="../../d2/d8/struct__COOKED__READ__DATA.html#o14">Echo</a>) {
01693             <a class="code" href="../../d0/d7/server_2stream_8c.html#a36">CloseOutputHandle</a>(<a class="code" href="../../d1/d7/server_8h.html#a83">CONSOLE_FROMTHREADPERPROCESSDATA</a>(WaitingThread),
01694                               CookedReadData-&gt;<a class="code" href="../../d2/d8/struct__COOKED__READ__DATA.html#o2">Console</a>,
01695                               &amp;CookedReadData-&gt;<a class="code" href="../../d2/d8/struct__COOKED__READ__DATA.html#o3">TempHandle</a>,
01696                               NULL,
01697                               FALSE
01698                              );
01699         }
01700         <span class="comment">//DbgPrint("CookedReadWaitRoutine exit 4\n");</span>
01701         WaitReplyMessage-&gt;ReturnValue = STATUS_ALERTED;
01702 
01703         <span class="comment">//</span>
01704         <span class="comment">// clean up popup data structures</span>
01705         <span class="comment">//</span>
01706 
01707         <a class="code" href="../../d4/d1/cmdline_8h.html#a52">CleanUpPopups</a>(CookedReadData);
01708         <a class="code" href="../../d8/d5/consrv_8h.html#a38">ConsoleHeapFree</a>(CookedReadData-&gt;<a class="code" href="../../d2/d8/struct__COOKED__READ__DATA.html#o10">BackupLimit</a>);
01709         <a class="code" href="../../d8/d5/consrv_8h.html#a38">ConsoleHeapFree</a>(CookedReadData-&gt;<a class="code" href="../../d2/d8/struct__COOKED__READ__DATA.html#o20">ExeName</a>);
01710 <span class="preprocessor">#if defined(FE_SB)</span>
01711 <span class="preprocessor"></span>        CookedReadData-&gt;<a class="code" href="../../d2/d8/struct__COOKED__READ__DATA.html#o2">Console</a>-&gt;lpCookedReadData = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01712 <span class="preprocessor">#endif</span>
01713 <span class="preprocessor"></span>        <a class="code" href="../../d8/d5/consrv_8h.html#a38">ConsoleHeapFree</a>(CookedReadData);
01714         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01715     }
01716 
01717     <span class="comment">//</span>
01718     <span class="comment">// if we get to here, this routine was called either by the input</span>
01719     <span class="comment">// thread or a write routine.  both of these callers grab the</span>
01720     <span class="comment">// current console lock.</span>
01721     <span class="comment">//</span>
01722 
01723     <span class="comment">//</span>
01724     <span class="comment">// this routine should be called by a thread owning the same</span>
01725     <span class="comment">// lock on the same console as we're reading from.</span>
01726     <span class="comment">//</span>
01727 
01728     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a> (<a class="code" href="../../d1/d7/server_8h.html#a63">ConsoleLocked</a>(Console));
01729 
01730     <span class="keywordflow">if</span> (CookedReadData-&gt;<a class="code" href="../../d2/d8/struct__COOKED__READ__DATA.html#o13">CommandHistory</a>) {
01731         <a class="code" href="../../d1/d0/struct__CLE__POPUP.html">PCLE_POPUP</a> Popup;
01732         <span class="keywordflow">if</span> (!<a class="code" href="../../d4/d1/cmdline_8h.html#a14">CLE_NO_POPUPS</a>(CookedReadData-&gt;<a class="code" href="../../d2/d8/struct__COOKED__READ__DATA.html#o13">CommandHistory</a>)) {
01733             Popup = CONTAINING_RECORD( CookedReadData-&gt;<a class="code" href="../../d2/d8/struct__COOKED__READ__DATA.html#o13">CommandHistory</a>-&gt;<a class="code" href="../../d9/d7/struct__COMMAND__HISTORY.html#o9">PopupList</a>.Flink, <a class="code" href="../../d1/d0/struct__CLE__POPUP.html">CLE_POPUP</a>, ListLink );
01734             <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = (Popup-&gt;<a class="code" href="../../d1/d0/struct__CLE__POPUP.html#o9">PopupInputRoutine</a>)(CookedReadData,
01735                                                 WaitReplyMessage,
01736                                                 WaitingThread,
01737                                                 <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
01738             <span class="keywordflow">if</span> (<a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> == <a class="code" href="../../d1/d7/server_8h.html#a65">CONSOLE_STATUS_READ_COMPLETE</a> ||
01739                 (<a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> != <a class="code" href="../../d1/d7/server_8h.html#a64">CONSOLE_STATUS_WAIT</a> &amp;&amp;
01740                  <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> != <a class="code" href="../../d1/d7/server_8h.html#a66">CONSOLE_STATUS_WAIT_NO_BLOCK</a>) ) {
01741                 <a class="code" href="../../d8/d5/consrv_8h.html#a38">ConsoleHeapFree</a>(CookedReadData-&gt;<a class="code" href="../../d2/d8/struct__COOKED__READ__DATA.html#o10">BackupLimit</a>);
01742                 <a class="code" href="../../d8/d5/consrv_8h.html#a38">ConsoleHeapFree</a>(CookedReadData-&gt;<a class="code" href="../../d2/d8/struct__COOKED__READ__DATA.html#o20">ExeName</a>);
01743 <span class="preprocessor">#if defined(FE_SB)</span>
01744 <span class="preprocessor"></span>                CookedReadData-&gt;<a class="code" href="../../d2/d8/struct__COOKED__READ__DATA.html#o2">Console</a>-&gt;lpCookedReadData = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01745 <span class="preprocessor">#endif</span>
01746 <span class="preprocessor"></span>                <a class="code" href="../../d8/d5/consrv_8h.html#a38">ConsoleHeapFree</a>(CookedReadData);
01747                 <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01748             }
01749             <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01750         }
01751     }
01752     <span class="keywordflow">if</span> (a-&gt;<a class="code" href="../../d3/d4/struct__CONSOLE__READCONSOLE__MSG.html#o6">CaptureBufferSize</a> &lt;= <a class="code" href="../../d9/d9/tcmpmem_8c.html#a0">BUFFER_SIZE</a> &amp;&amp;
01753         CookedReadData-&gt;<a class="code" href="../../d2/d8/struct__COOKED__READ__DATA.html#o7">BytesRead</a> == 0) {
01754         CookedReadData-&gt;<a class="code" href="../../d2/d8/struct__COOKED__READ__DATA.html#o5">UserBuffer</a> = a-&gt;<a class="code" href="../../d3/d4/struct__CONSOLE__READCONSOLE__MSG.html#o3">Buffer</a>;
01755     }
01756     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d0/d7/server_2stream_8c.html#a24">CookedRead</a>(CookedReadData,
01757                         WaitReplyMessage,
01758                         WaitingThread,
01759                         TRUE
01760                        );
01761 
01762     <span class="keywordflow">if</span> (<a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> != <a class="code" href="../../d1/d7/server_8h.html#a64">CONSOLE_STATUS_WAIT</a>) {
01763         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01764     } <span class="keywordflow">else</span> {
01765         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01766     }
01767 
01768     <span class="comment">//</span>
01769     <span class="comment">// satisfy the unreferenced parameter warnings.</span>
01770     <span class="comment">//</span>
01771 
01772     UNREFERENCED_PARAMETER(WaitQueue);
01773     UNREFERENCED_PARAMETER(SatisfyParameter2);
01774 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a41" doxytag="cmdline.h::DeleteCommandLine" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID DeleteCommandLine           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN OUT <a class="el" href="../../d2/d8/struct__COOKED__READ__DATA.html">PCOOKED_READ_DATA</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>CookedReadData</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOL&nbsp;</td>
          <td class="mdname" nowrap> <em>UpdateFields</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l02009">2009</a> of file <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html">server/cmdline.c</a>.
<p>
References <a class="el" href="../../d6/d4/conmsg_8h-source.html#l00272">CONSOLE_FALSE_UNICODE</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d7/d7/dispatch_8h-source.html#l00075">FillOutput</a>, <a class="el" href="../../d7/d0/ntcon_2server_2cursor_8c-source.html#l00474">SetCursorPosition()</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l03272">ProcessCommandLine()</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l02793">ProcessCommandNumberInput()</a>, <a class="el" href="../../d1/d6/server_2stream_8c-source.html#l00876">ProcessCookedReadInput()</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l02546">ProcessCopyFromCharInput()</a>, <a class="el" href="../../d2/d6/ntcon_2server_2menu_8c-source.html#l00459">PropertiesUpdate()</a>, and <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l02136">SetCurrentCommandLine()</a>.
<p>
<pre class="fragment"><div>02013 {
02014     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> CharsToWrite = CookedReadData-&gt;NumberOfVisibleChars;
02015     COORD Coord = CookedReadData-&gt;OriginalCursorPosition;
02016 
02017     <span class="comment">//</span>
02018     <span class="comment">// catch the case where the current command has scrolled off the</span>
02019     <span class="comment">// top of the screen.</span>
02020     <span class="comment">//</span>
02021 
02022     <span class="keywordflow">if</span> (Coord.Y &lt; 0) {
02023         CharsToWrite += CookedReadData-&gt;ScreenInfo-&gt;ScreenBufferSize.X * Coord.Y;
02024         CharsToWrite += CookedReadData-&gt;OriginalCursorPosition.X;   <span class="comment">// account for prompt</span>
02025         CookedReadData-&gt;OriginalCursorPosition.X = 0;
02026         CookedReadData-&gt;OriginalCursorPosition.Y = 0;
02027         Coord.X = 0;
02028         Coord.Y = 0;
02029     }
02030 <span class="preprocessor">#if defined(FE_SB)</span>
02031 <span class="preprocessor"></span>    <span class="keywordflow">if</span> (CONSOLE_IS_DBCS_OUTPUTCP(CookedReadData-&gt;ScreenInfo-&gt;Console) &amp;&amp;
02032         !CheckBisectStringW(CookedReadData-&gt;ScreenInfo,
02033                            CookedReadData-&gt;ScreenInfo-&gt;Console-&gt;CP,
02034                            CookedReadData-&gt;BackupLimit,
02035                            CharsToWrite,
02036                            CookedReadData-&gt;ScreenInfo-&gt;ScreenBufferSize.X
02037                             -CookedReadData-&gt;OriginalCursorPosition.X
02038                            )) {
02039         CharsToWrite++;
02040     }
02041 <span class="preprocessor">#endif</span>
02042 <span class="preprocessor"></span>    <a class="code" href="../../d6/d8/dispatch_8h.html#a6">FillOutput</a>(CookedReadData-&gt;ScreenInfo,
02043                (WCHAR)<span class="charliteral">' '</span>,
02044                Coord,
02045                CONSOLE_FALSE_UNICODE, <span class="comment">// faster than real unicode</span>
02046                &amp;CharsToWrite
02047               );
02048     <span class="keywordflow">if</span> (UpdateFields) {
02049         CookedReadData-&gt;BufPtr=CookedReadData-&gt;BackupLimit;
02050         CookedReadData-&gt;BytesRead=0;
02051         CookedReadData-&gt;CurrentPosition=0;
02052         CookedReadData-&gt;NumberOfVisibleChars = 0;
02053     }
02054     <a class="code" href="../../d6/d1/ntcon_2server_2cursor_8c.html#a7">SetCursorPosition</a>(CookedReadData-&gt;ScreenInfo,
02055                       CookedReadData-&gt;OriginalCursorPosition,
02056                       TRUE
02057                      );
02058 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a54" doxytag="cmdline.h::DrawCommandListBorder" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID DrawCommandListBorder           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d1/d0/struct__CLE__POPUP.html">PCLE_POPUP</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Popup</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d7/d8/struct__SCREEN__INFORMATION.html">PSCREEN_INFORMATION</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>ScreenInfo</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l04123">4123</a> of file <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html">server/cmdline.c</a>.
<p>
References <a class="el" href="../../d6/d4/conmsg_8h-source.html#l00271">CONSOLE_ATTRIBUTE</a>, <a class="el" href="../../d6/d4/conmsg_8h-source.html#l00270">CONSOLE_REAL_UNICODE</a>, <a class="el" href="../../d3/d9/nt6_2user32_8def-source.html#l00714">else</a>, <a class="el" href="../../d7/d7/dispatch_8h-source.html#l00075">FillOutput</a>, <a class="el" href="../../d5/d0/cmdline_8h-source.html#l00057">POPUP_SIZE_X</a>, <a class="el" href="../../d5/d0/cmdline_8h-source.html#l00058">POPUP_SIZE_Y</a>, and <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00062">SHORT</a>.
<p>
Referenced by <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l01817">BeginPopup()</a>.
<p>
<pre class="fragment"><div>04127 {
04128     COORD WriteCoord;
04129     ULONG Length;
04130     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a> i;
04131 
04132     <span class="comment">//</span>
04133     <span class="comment">// fill attributes of top line</span>
04134     <span class="comment">//</span>
04135     WriteCoord.X = Popup-&gt;Region.Left;
04136     WriteCoord.Y = Popup-&gt;Region.Top;
04137     Length = <a class="code" href="../../d4/d1/cmdline_8h.html#a1">POPUP_SIZE_X</a>(Popup) + 2;
04138     <a class="code" href="../../d6/d8/dispatch_8h.html#a6">FillOutput</a>(ScreenInfo,
04139                Popup-&gt;Attributes,
04140                WriteCoord,
04141                CONSOLE_ATTRIBUTE,
04142                &amp;Length
04143               );
04144     <span class="comment">//</span>
04145     <span class="comment">// draw upper left corner</span>
04146     <span class="comment">//</span>
04147     Length = 1;
04148     <a class="code" href="../../d6/d8/dispatch_8h.html#a6">FillOutput</a>(ScreenInfo,
04149 #<span class="keywordflow">if</span> defined(FE_SB)
04150                ScreenInfo-&gt;LineChar[UPPER_LEFT_CORNER],
04151 #<a class="code" href="../../d2/d0/nt6_2user32_8def.html#a85">else</a>
04152                (WCHAR)0x250c,
04153 #endif
04154                WriteCoord,
04155                CONSOLE_REAL_UNICODE,
04156                &amp;Length
04157               );
04158 
04159     <span class="comment">//</span>
04160     <span class="comment">// draw upper bar</span>
04161     <span class="comment">//</span>
04162 
04163     WriteCoord.X += 1;
04164     Length = <a class="code" href="../../d4/d1/cmdline_8h.html#a1">POPUP_SIZE_X</a>(Popup);
04165     <a class="code" href="../../d6/d8/dispatch_8h.html#a6">FillOutput</a>(ScreenInfo,
04166 #<span class="keywordflow">if</span> defined(FE_SB)
04167                ScreenInfo-&gt;LineChar[HORIZONTAL_LINE],
04168 #<a class="code" href="../../d2/d0/nt6_2user32_8def.html#a85">else</a>
04169                (WCHAR)0x2500,
04170 #endif
04171                WriteCoord,
04172                CONSOLE_REAL_UNICODE,
04173                &amp;Length
04174               );
04175 
04176     <span class="comment">//</span>
04177     <span class="comment">// draw upper right corner</span>
04178     <span class="comment">//</span>
04179 
04180     WriteCoord.X = Popup-&gt;Region.Right;
04181     Length = 1;
04182     <a class="code" href="../../d6/d8/dispatch_8h.html#a6">FillOutput</a>(ScreenInfo,
04183 #<span class="keywordflow">if</span> defined(FE_SB)
04184                ScreenInfo-&gt;LineChar[UPPER_RIGHT_CORNER],
04185 #<a class="code" href="../../d2/d0/nt6_2user32_8def.html#a85">else</a>
04186                (WCHAR)0x2510,
04187 #endif
04188                WriteCoord,
04189                CONSOLE_REAL_UNICODE,
04190                &amp;Length
04191               );
04192 
04193     <span class="keywordflow">for</span> (i=0;i&lt;<a class="code" href="../../d4/d1/cmdline_8h.html#a2">POPUP_SIZE_Y</a>(Popup);i++) {
04194         WriteCoord.Y += 1;
04195         WriteCoord.X = Popup-&gt;Region.Left;
04196 
04197         <span class="comment">//</span>
04198         <span class="comment">// fill attributes</span>
04199         <span class="comment">//</span>
04200 
04201         Length = <a class="code" href="../../d4/d1/cmdline_8h.html#a1">POPUP_SIZE_X</a>(Popup) + 2;
04202         <a class="code" href="../../d6/d8/dispatch_8h.html#a6">FillOutput</a>(ScreenInfo,
04203                    Popup-&gt;Attributes,
04204                    WriteCoord,
04205                    CONSOLE_ATTRIBUTE,
04206                    &amp;Length
04207                   );
04208         Length = 1;
04209         <a class="code" href="../../d6/d8/dispatch_8h.html#a6">FillOutput</a>(ScreenInfo,
04210 #<span class="keywordflow">if</span> defined(FE_SB)
04211                    ScreenInfo-&gt;LineChar[VERTICAL_LINE],
04212 #<a class="code" href="../../d2/d0/nt6_2user32_8def.html#a85">else</a>
04213                    (WCHAR)0x2502,
04214 #endif
04215                    WriteCoord,
04216                    CONSOLE_REAL_UNICODE,
04217                    &amp;Length
04218                   );
04219         WriteCoord.X = Popup-&gt;Region.Right;
04220         Length = 1;
04221         <a class="code" href="../../d6/d8/dispatch_8h.html#a6">FillOutput</a>(ScreenInfo,
04222 #<span class="keywordflow">if</span> defined(FE_SB)
04223                    ScreenInfo-&gt;LineChar[VERTICAL_LINE],
04224 #<a class="code" href="../../d2/d0/nt6_2user32_8def.html#a85">else</a>
04225                    (WCHAR)0x2502,
04226 #endif
04227                    WriteCoord,
04228                    CONSOLE_REAL_UNICODE,
04229                    &amp;Length
04230                   );
04231     }
04232 
04233     <span class="comment">//</span>
04234     <span class="comment">// draw bottom line</span>
04235     <span class="comment">//</span>
04236     <span class="comment">// fill attributes of top line</span>
04237     <span class="comment">//</span>
04238 
04239     WriteCoord.X = Popup-&gt;Region.Left;
04240     WriteCoord.Y = Popup-&gt;Region.Bottom;
04241     Length = <a class="code" href="../../d4/d1/cmdline_8h.html#a1">POPUP_SIZE_X</a>(Popup) + 2;
04242     <a class="code" href="../../d6/d8/dispatch_8h.html#a6">FillOutput</a>(ScreenInfo,
04243                Popup-&gt;Attributes,
04244                WriteCoord,
04245                CONSOLE_ATTRIBUTE,
04246                &amp;Length
04247               );
04248     <span class="comment">//</span>
04249     <span class="comment">// draw bottom left corner</span>
04250     <span class="comment">//</span>
04251 
04252     Length = 1;
04253     WriteCoord.X = Popup-&gt;Region.Left;
04254     <a class="code" href="../../d6/d8/dispatch_8h.html#a6">FillOutput</a>(ScreenInfo,
04255 #<span class="keywordflow">if</span> defined(FE_SB)
04256                ScreenInfo-&gt;LineChar[BOTTOM_LEFT_CORNER],
04257 #<a class="code" href="../../d2/d0/nt6_2user32_8def.html#a85">else</a>
04258                (WCHAR)0x2514,
04259 #endif
04260                WriteCoord,
04261                CONSOLE_REAL_UNICODE,
04262                &amp;Length
04263               );
04264 
04265     <span class="comment">//</span>
04266     <span class="comment">// draw lower bar</span>
04267     <span class="comment">//</span>
04268 
04269     WriteCoord.X += 1;
04270     Length = <a class="code" href="../../d4/d1/cmdline_8h.html#a1">POPUP_SIZE_X</a>(Popup);
04271     <a class="code" href="../../d6/d8/dispatch_8h.html#a6">FillOutput</a>(ScreenInfo,
04272 #<span class="keywordflow">if</span> defined(FE_SB)
04273                ScreenInfo-&gt;LineChar[HORIZONTAL_LINE],
04274 #<a class="code" href="../../d2/d0/nt6_2user32_8def.html#a85">else</a>
04275                (WCHAR)0x2500,
04276 #endif
04277                WriteCoord,
04278                CONSOLE_REAL_UNICODE,
04279                &amp;Length
04280               );
04281 
04282     <span class="comment">//</span>
04283     <span class="comment">// draw lower right corner</span>
04284     <span class="comment">//</span>
04285 
04286     WriteCoord.X = Popup-&gt;Region.Right;
04287     Length = 1;
04288     <a class="code" href="../../d6/d8/dispatch_8h.html#a6">FillOutput</a>(ScreenInfo,
04289 #<span class="keywordflow">if</span> defined(FE_SB)
04290                ScreenInfo-&gt;LineChar[BOTTOM_RIGHT_CORNER],
04291 #<a class="code" href="../../d2/d0/nt6_2user32_8def.html#a85">else</a>
04292                (WCHAR)0x2518,
04293 #endif
04294                WriteCoord,
04295                CONSOLE_REAL_UNICODE,
04296                &amp;Length
04297               );
04298 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a61" doxytag="cmdline.h::DrawCommandListPopup" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID DrawCommandListPopup           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d1/d0/struct__CLE__POPUP.html">PCLE_POPUP</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Popup</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a13">SHORT</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>CurrentCommand</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d9/d7/struct__COMMAND__HISTORY.html">PCOMMAND_HISTORY</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>CommandHistory</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d7/d8/struct__SCREEN__INFORMATION.html">PSCREEN_INFORMATION</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>ScreenInfo</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l04346">4346</a> of file <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html">server/cmdline.c</a>.
<p>
References <a class="el" href="../../d2/d0/bench_8c-source.html#l00050">CHAR</a>, <a class="el" href="../../d5/d0/cmdline_8h-source.html#l00112">COMMAND_NUM_TO_INDEX</a>, <a class="el" href="../../d5/d0/cmdline_8h-source.html#l00059">COMMAND_NUMBER_SIZE</a>, <a class="el" href="../../d6/d4/conmsg_8h-source.html#l00269">CONSOLE_ASCII</a>, <a class="el" href="../../d6/d4/conmsg_8h-source.html#l00271">CONSOLE_ATTRIBUTE</a>, <a class="el" href="../../d6/d4/conmsg_8h-source.html#l00272">CONSOLE_FALSE_UNICODE</a>, <a class="el" href="../../d8/d1/output_8h-source.html#l00150">CONSOLE_OEMFONT_DISPLAY</a>, <a class="el" href="../../d6/d4/conmsg_8h-source.html#l00270">CONSOLE_REAL_UNICODE</a>, <a class="el" href="../../d9/d4/consrv_8h-source.html#l00180">ConsoleHeapAlloc</a>, <a class="el" href="../../d9/d4/consrv_8h-source.html#l00193">ConsoleHeapFree</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d5/d9/w32_2ntcon_2server_2misc_8c-source.html#l01676">FalseUnicodeToRealUnicode()</a>, <a class="el" href="../../d7/d7/dispatch_8h-source.html#l00075">FillOutput</a>, <a class="el" href="../../d0/d2/ldrp_8h-source.html#l00457">MAKE_TAG</a>, <a class="el" href="../../d9/d5/sertl_8c-source.html#l00332">max</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d5/d0/cmdline_8h-source.html#l00057">POPUP_SIZE_X</a>, <a class="el" href="../../d5/d0/cmdline_8h-source.html#l00058">POPUP_SIZE_Y</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00062">SHORT</a>, and <a class="el" href="../../d7/d7/dispatch_8h-source.html#l00039">WriteOutputString</a>.
<p>
Referenced by <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l02935">CommandListPopup()</a>, and <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l04500">UpdateCommandListPopup()</a>.
<p>
<pre class="fragment"><div>04352 {
04353     WORD Attributes;
04354     ULONG lStringLength,CommandNumberLength;
04355     <a class="code" href="../../d1/d1/bench_8c.html#a16">CHAR</a> CommandNumber[<a class="code" href="../../d4/d1/cmdline_8h.html#a3">COMMAND_NUMBER_SIZE</a>];
04356     PCHAR CommandNumberPtr;
04357     COORD WriteCoord;
04358     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a> i;
04359 
04360     <span class="comment">//</span>
04361     <span class="comment">// draw empty popup</span>
04362     <span class="comment">//</span>
04363 
04364     WriteCoord.X = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a>)(Popup-&gt;Region.Left+1);
04365     WriteCoord.Y = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a>)(Popup-&gt;Region.Top+1);
04366     lStringLength = <a class="code" href="../../d4/d1/cmdline_8h.html#a1">POPUP_SIZE_X</a>(Popup);
04367     <span class="keywordflow">for</span> (i=0;i&lt;<a class="code" href="../../d4/d1/cmdline_8h.html#a2">POPUP_SIZE_Y</a>(Popup);i++) {
04368         <a class="code" href="../../d6/d8/dispatch_8h.html#a6">FillOutput</a>(ScreenInfo,
04369                    Popup-&gt;Attributes,
04370                    WriteCoord,
04371                    CONSOLE_ATTRIBUTE,
04372                    &amp;lStringLength
04373                   );
04374         <a class="code" href="../../d6/d8/dispatch_8h.html#a6">FillOutput</a>(ScreenInfo,
04375                    (WCHAR)<span class="charliteral">' '</span>,
04376                    WriteCoord,
04377                    CONSOLE_FALSE_UNICODE, <span class="comment">// faster than real unicode</span>
04378                    &amp;lStringLength
04379                   );
04380         WriteCoord.Y += 1;
04381     }
04382 
04383     WriteCoord.Y = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a>)(Popup-&gt;Region.Top+1);
04384     <span class="keywordflow">for</span> (i=<a class="code" href="../../d8/d6/sertl_8c.html#a1">max</a>((SHORT)(Popup-&gt;BottomIndex-<a class="code" href="../../d4/d1/cmdline_8h.html#a2">POPUP_SIZE_Y</a>(Popup)+1),0);i&lt;=Popup-&gt;BottomIndex;i++) {
04385 
04386         <span class="comment">//</span>
04387         <span class="comment">// write command number to screen</span>
04388         <span class="comment">//</span>
04389 
04390         CommandNumberPtr = _itoa(i,CommandNumber,10);
04391         CommandNumberLength = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a>)lstrlenA(CommandNumberPtr);
04392         CommandNumber[CommandNumberLength] = <span class="charliteral">':'</span>;
04393         CommandNumber[CommandNumberLength+1] = <span class="charliteral">' '</span>;
04394         CommandNumberLength+=2;
04395         <span class="keywordflow">if</span> (CommandNumberLength &gt; (ULONG)<a class="code" href="../../d4/d1/cmdline_8h.html#a1">POPUP_SIZE_X</a>(Popup))
04396             CommandNumberLength = (ULONG)<a class="code" href="../../d4/d1/cmdline_8h.html#a1">POPUP_SIZE_X</a>(Popup);
04397         WriteCoord.X = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a>)(Popup-&gt;Region.Left+1);
04398         <a class="code" href="../../d6/d8/dispatch_8h.html#a2">WriteOutputString</a>(ScreenInfo,
04399                           CommandNumberPtr,
04400                           WriteCoord,
04401                           CONSOLE_ASCII,
04402                           &amp;CommandNumberLength,
04403                           NULL
04404                          );
04405 
04406         <span class="comment">//</span>
04407         <span class="comment">// write command to screen</span>
04408         <span class="comment">//</span>
04409 
04410         lStringLength = CommandHistory-&gt;Commands[<a class="code" href="../../d4/d1/cmdline_8h.html#a8">COMMAND_NUM_TO_INDEX</a>(i,CommandHistory)]-&gt;CommandLength/<span class="keyword">sizeof</span>(WCHAR);
04411 <span class="preprocessor">#if defined(FE_SB)</span>
04412 <span class="preprocessor"></span>        {
04413             <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> lTmpStringLength;
04414             LONG lPopupLength;
04415             LPWSTR lpStr;
04416 
04417             lTmpStringLength = lStringLength;
04418             lPopupLength = <a class="code" href="../../d4/d1/cmdline_8h.html#a1">POPUP_SIZE_X</a>(Popup) - CommandNumberLength;
04419             lpStr = CommandHistory-&gt;Commands[<a class="code" href="../../d4/d1/cmdline_8h.html#a8">COMMAND_NUM_TO_INDEX</a>(i,CommandHistory)]-&gt;Command;
04420             <span class="keywordflow">while</span> (lTmpStringLength--) {
04421                 <span class="keywordflow">if</span> (IsConsoleFullWidth(ScreenInfo-&gt;Console-&gt;hDC,
04422                                        ScreenInfo-&gt;Console-&gt;OutputCP,*lpStr++)) {
04423                     lPopupLength -= 2;
04424                 }
04425                 <span class="keywordflow">else</span> {
04426                     lPopupLength--;
04427                 }
04428                 <span class="keywordflow">if</span> (lPopupLength &lt;= 0) {
04429                     lStringLength -= lTmpStringLength;
04430                     <span class="keywordflow">if</span> (lPopupLength &lt; 0)
04431                         lStringLength--;
04432                     <span class="keywordflow">break</span>;
04433                 }
04434             }
04435         }
04436 <span class="preprocessor">#else</span>
04437 <span class="preprocessor"></span>        <span class="keywordflow">if</span> ((lStringLength+CommandNumberLength) &gt; (ULONG)<a class="code" href="../../d4/d1/cmdline_8h.html#a1">POPUP_SIZE_X</a>(Popup))
04438             lStringLength = (ULONG)(<a class="code" href="../../d4/d1/cmdline_8h.html#a1">POPUP_SIZE_X</a>(Popup)-CommandNumberLength);
04439 <span class="preprocessor">#endif</span>
04440 <span class="preprocessor"></span>        WriteCoord.X = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a>)(WriteCoord.X + CommandNumberLength);
04441 <span class="preprocessor">#if defined(FE_SB)</span>
04442 <span class="preprocessor"></span>        {
04443             PWCHAR TransBuffer;
04444 
04445             TransBuffer = <a class="code" href="../../d8/d5/consrv_8h.html#a36">ConsoleHeapAlloc</a>(<a class="code" href="../../d9/d2/ldrp_8h.html#a11">MAKE_TAG</a>( TMP_DBCS_TAG ),lStringLength * <span class="keyword">sizeof</span>(WCHAR));
04446             <span class="keywordflow">if</span> (TransBuffer == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
04447                 <span class="keywordflow">return</span>;
04448             }
04449 
04450             RtlCopyMemory(TransBuffer,CommandHistory-&gt;Commands[<a class="code" href="../../d4/d1/cmdline_8h.html#a8">COMMAND_NUM_TO_INDEX</a>(i,CommandHistory)]-&gt;Command,lStringLength * <span class="keyword">sizeof</span>(WCHAR));
04451             <a class="code" href="../../d6/d8/dispatch_8h.html#a2">WriteOutputString</a>(ScreenInfo,
04452                               TransBuffer,
04453                               WriteCoord,
04454                               CONSOLE_REAL_UNICODE,
04455                               &amp;lStringLength,
04456                               NULL
04457                              );
04458             <a class="code" href="../../d8/d5/consrv_8h.html#a38">ConsoleHeapFree</a>(TransBuffer);
04459         }
04460 <span class="preprocessor">#else</span>
04461 <span class="preprocessor"></span>        <a class="code" href="../../d6/d8/dispatch_8h.html#a2">WriteOutputString</a>(ScreenInfo,
04462                           CommandHistory-&gt;Commands[<a class="code" href="../../d4/d1/cmdline_8h.html#a8">COMMAND_NUM_TO_INDEX</a>(i,CommandHistory)]-&gt;Command,
04463                           WriteCoord,
04464                           CONSOLE_REAL_UNICODE,
04465                           &amp;lStringLength,
04466                           NULL
04467                          );
04468         <span class="comment">// convert back to true unicode (got converted by WriteOutputString)</span>
04469         <span class="keywordflow">if</span> ((ScreenInfo-&gt;Flags &amp; <a class="code" href="../../d7/d2/output_8h.html#a2">CONSOLE_OEMFONT_DISPLAY</a>) &amp;&amp;
04470                 !(ScreenInfo-&gt;Console-&gt;FullScreenFlags &amp; CONSOLE_FULLSCREEN)) {
04471             <a class="code" href="../../d4/d0/w32_2ntcon_2server_2misc_8c.html#a43">FalseUnicodeToRealUnicode</a>(CommandHistory-&gt;Commands[<a class="code" href="../../d4/d1/cmdline_8h.html#a8">COMMAND_NUM_TO_INDEX</a>(i,CommandHistory)]-&gt;Command,
04472                     lStringLength,
04473                     ScreenInfo-&gt;Console-&gt;OutputCP);
04474         }
04475 <span class="preprocessor">#endif</span>
04476 <span class="preprocessor"></span>
04477         <span class="comment">//</span>
04478         <span class="comment">// write attributes to screen</span>
04479         <span class="comment">//</span>
04480 
04481         <span class="keywordflow">if</span> (<a class="code" href="../../d4/d1/cmdline_8h.html#a8">COMMAND_NUM_TO_INDEX</a>(i,CommandHistory) == CurrentCommand) {
04482             WriteCoord.X = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a>)(Popup-&gt;Region.Left+1);
04483             <span class="comment">// inverted attributes</span>
04484             Attributes = (WORD)(((Popup-&gt;Attributes &lt;&lt; 4) &amp; 0xf0) |
04485                                 ((Popup-&gt;Attributes &gt;&gt; 4) &amp; 0x0f));
04486             lStringLength = <a class="code" href="../../d4/d1/cmdline_8h.html#a1">POPUP_SIZE_X</a>(Popup);
04487             <a class="code" href="../../d6/d8/dispatch_8h.html#a6">FillOutput</a>(ScreenInfo,
04488                        Attributes,
04489                        WriteCoord,
04490                        CONSOLE_ATTRIBUTE,
04491                        &amp;lStringLength
04492                       );
04493         }
04494 
04495         WriteCoord.Y += 1;
04496     }
04497 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a43" doxytag="cmdline.h::EmptyCommandHistory" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID EmptyCommandHistory           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d9/d7/struct__COMMAND__HISTORY.html">PCOMMAND_HISTORY</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>CommandHistory</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l03227">3227</a> of file <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html">server/cmdline.c</a>.
<p>
References <a class="el" href="../../d5/d0/cmdline_8h-source.html#l00066">CLE_RESET</a>, <a class="el" href="../../d9/d4/consrv_8h-source.html#l00193">ConsoleHeapFree</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, and <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00062">SHORT</a>.
<p>
Referenced by <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l03272">ProcessCommandLine()</a>, and <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l01393">SrvExpungeConsoleCommandHistory()</a>.
<p>
<pre class="fragment"><div>03230 {
03231     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a> i;
03232     <span class="keywordflow">if</span> (CommandHistory==<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
03233         <span class="keywordflow">return</span>;
03234     <span class="keywordflow">for</span> (i=0;i&lt;CommandHistory-&gt;NumberOfCommands;i++) {
03235         <a class="code" href="../../d8/d5/consrv_8h.html#a38">ConsoleHeapFree</a>(CommandHistory-&gt;Commands[i]);
03236     }
03237     CommandHistory-&gt;NumberOfCommands = 0;
03238     CommandHistory-&gt;LastAdded = -1;
03239     CommandHistory-&gt;LastDisplayed = -1;
03240     CommandHistory-&gt;FirstCommand = 0;
03241     CommandHistory-&gt;Flags = <a class="code" href="../../d4/d1/cmdline_8h.html#a5">CLE_RESET</a>;
03242 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a46" doxytag="cmdline.h::FindCommandHistory" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d9/d7/struct__COMMAND__HISTORY.html">PCOMMAND_HISTORY</a> FindCommandHistory           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d1/d3/struct__CONSOLE__INFORMATION.html">PCONSOLE_INFORMATION</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Console</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN HANDLE&nbsp;</td>
          <td class="mdname" nowrap> <em>ProcessHandle</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l04564">4564</a> of file <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html">server/cmdline.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d5/d0/cmdline_8h-source.html#l00065">CLE_ALLOCATED</a>, <a class="el" href="../../d2/d8/icmui_8def-source.html#l00012">History</a>, and <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>.
<p>
Referenced by <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l04605">FreeCommandHistory()</a>, and <a class="el" href="../../d1/d6/server_2stream_8c-source.html#l02263">SrvReadConsole()</a>.
<p>
<pre class="fragment"><div>04571                    :
04572 
04573     This routine marks <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> command history buffer freed.
04574 
04575 Arguments:
04576 
04577     Console - pointer to console.
04578 
04579     ProcessHandle - handle to client process.
04580 
04581 Return Value:
04582 
04583     none.
04584 
04585 --*/
04586 
04587 {
04588     <a class="code" href="../../d9/d7/struct__COMMAND__HISTORY.html">PCOMMAND_HISTORY</a> <a class="code" href="../../d1/d9/icmui_8def.html#a3">History</a>;
04589     PLIST_ENTRY ListHead, ListNext;
04590 
04591     ListHead = &amp;Console-&gt;CommandHistoryList;
04592     ListNext = ListHead-&gt;Flink;
04593     <span class="keywordflow">while</span> (ListNext != ListHead) {
04594         <a class="code" href="../../d1/d9/icmui_8def.html#a3">History</a> = CONTAINING_RECORD( ListNext, <a class="code" href="../../d9/d7/struct__COMMAND__HISTORY.html">COMMAND_HISTORY</a>, ListLink );
04595         ListNext = ListNext-&gt;Flink;
04596         <span class="keywordflow">if</span> (<a class="code" href="../../d1/d9/icmui_8def.html#a3">History</a>-&gt;ProcessHandle == ProcessHandle) {
04597             <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(<a class="code" href="../../d1/d9/icmui_8def.html#a3">History</a>-&gt;Flags &amp; CLE_ALLOCATED);
04598             <span class="keywordflow">return</span> <a class="code" href="../../d1/d9/icmui_8def.html#a3">History</a>;
04599         }
04600     }
04601     <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
04602 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a45" doxytag="cmdline.h::FindExeCommandHistory" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d9/d7/struct__COMMAND__HISTORY.html">PCOMMAND_HISTORY</a> FindExeCommandHistory           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d1/d3/struct__CONSOLE__INFORMATION.html">PCONSOLE_INFORMATION</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Console</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>AppName</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>AppNameLength</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>UnicodeExe</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l01637">1637</a> of file <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html">server/cmdline.c</a>.
<p>
References <a class="el" href="../../d5/d0/cmdline_8h-source.html#l00065">CLE_ALLOCATED</a>, <a class="el" href="../../d9/d4/consrv_8h-source.html#l00180">ConsoleHeapAlloc</a>, <a class="el" href="../../d9/d4/consrv_8h-source.html#l00193">ConsoleHeapFree</a>, <a class="el" href="../../d5/d9/w32_2ntcon_2server_2misc_8c-source.html#l01345">ConvertInputToUnicode()</a>, <a class="el" href="../../d2/d8/icmui_8def-source.html#l00012">History</a>, <a class="el" href="../../d0/d2/ldrp_8h-source.html#l00457">MAKE_TAG</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l00390">my_wcsncmpi</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d9/d4/consrv_8h-source.html#l00062">TMP_TAG</a>, <a class="el" href="../../d3/d9/nt6_2user32_8def-source.html#l00844">Unicode</a>, and <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00064">USHORT</a>.
<p>
Referenced by <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l01393">SrvExpungeConsoleCommandHistory()</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l01500">SrvGetConsoleCommandHistory()</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l01458">SrvGetConsoleCommandHistoryLength()</a>, and <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l01424">SrvSetConsoleNumberOfCommands()</a>.
<p>
<pre class="fragment"><div>01643 {
01644     <a class="code" href="../../d9/d7/struct__COMMAND__HISTORY.html">PCOMMAND_HISTORY</a> <a class="code" href="../../d1/d9/icmui_8def.html#a3">History</a>;
01645     PLIST_ENTRY ListHead, ListNext;
01646     PWCHAR AppNamePtr;
01647 
01648     <span class="keywordflow">if</span> (!<a class="code" href="../../d2/d0/nt6_2user32_8def.html#a96">Unicode</a>) {
01649         AppNamePtr = (PWCHAR)<a class="code" href="../../d8/d5/consrv_8h.html#a36">ConsoleHeapAlloc</a>(<a class="code" href="../../d9/d2/ldrp_8h.html#a11">MAKE_TAG</a>( TMP_TAG ),AppNameLength * <span class="keyword">sizeof</span>(WCHAR));
01650         <span class="keywordflow">if</span> (AppNamePtr == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01651             <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01652         }
01653         AppNameLength = <a class="code" href="../../d4/d0/w32_2ntcon_2server_2misc_8c.html#a36">ConvertInputToUnicode</a>(Console-&gt;CP,
01654                                   AppName,
01655                                   AppNameLength,
01656                                   AppNamePtr,
01657                                   AppNameLength);
01658         AppNameLength *= 2;
01659     } <span class="keywordflow">else</span> {
01660         AppNamePtr = AppName;
01661     }
01662     ListHead = &amp;Console-&gt;CommandHistoryList;
01663     ListNext = ListHead-&gt;Flink;
01664     <span class="keywordflow">while</span> (ListNext != ListHead) {
01665         <a class="code" href="../../d1/d9/icmui_8def.html#a3">History</a> = CONTAINING_RECORD( ListNext, <a class="code" href="../../d9/d7/struct__COMMAND__HISTORY.html">COMMAND_HISTORY</a>, ListLink );
01666         ListNext = ListNext-&gt;Flink;
01667 
01668         <span class="keywordflow">if</span> (<a class="code" href="../../d1/d9/icmui_8def.html#a3">History</a>-&gt;Flags &amp; <a class="code" href="../../d4/d1/cmdline_8h.html#a4">CLE_ALLOCATED</a> &amp;&amp;
01669             !<a class="code" href="../../d3/d1/server_2cmdline_8c.html#a9">my_wcsncmpi</a>(<a class="code" href="../../d1/d9/icmui_8def.html#a3">History</a>-&gt;AppName,AppNamePtr,(USHORT)AppNameLength)) {
01670             <span class="keywordflow">if</span> (!<a class="code" href="../../d2/d0/nt6_2user32_8def.html#a96">Unicode</a>) {
01671                 <a class="code" href="../../d8/d5/consrv_8h.html#a38">ConsoleHeapFree</a>(AppNamePtr);
01672             }
01673             <span class="keywordflow">return</span> <a class="code" href="../../d1/d9/icmui_8def.html#a3">History</a>;
01674         }
01675     }
01676     <span class="keywordflow">if</span> (!<a class="code" href="../../d2/d0/nt6_2user32_8def.html#a96">Unicode</a>) {
01677         <a class="code" href="../../d8/d5/consrv_8h.html#a38">ConsoleHeapFree</a>(AppNamePtr);
01678     }
01679     <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01680 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a56" doxytag="cmdline.h::FindMatchingCommand" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a13">SHORT</a> FindMatchingCommand           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d9/d7/struct__COMMAND__HISTORY.html">PCOMMAND_HISTORY</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>CommandHistory</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PWCHAR&nbsp;</td>
          <td class="mdname" nowrap> <em>CurrentCommand</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>CurrentCommandLength</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a13">SHORT</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>CurrentIndex</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Flags</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l04078">4078</a> of file <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html">server/cmdline.c</a>.
<p>
References <a class="el" href="../../d5/d0/cmdline_8h-source.html#l00066">CLE_RESET</a>, <a class="el" href="../../d5/d0/cmdline_8h-source.html#l00024">_COMMAND::Command</a>, <a class="el" href="../../d5/d0/cmdline_8h-source.html#l00122">COMMAND_IND_PREV</a>, <a class="el" href="../../d5/d0/cmdline_8h-source.html#l00023">_COMMAND::CommandLength</a>, <a class="el" href="../../d5/d0/cmdline_8h-source.html#l00306">FMCFL_EXACT_MATCH</a>, <a class="el" href="../../d5/d0/cmdline_8h-source.html#l00307">FMCFL_JUST_LOOKING</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l00391">my_wcsncmp</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00062">SHORT</a>, and <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00064">USHORT</a>.
<p>
Referenced by <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l04744">AddCommand()</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l03272">ProcessCommandLine()</a>, and <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l02287">ProcessCommandListInput()</a>.
<p>
<pre class="fragment"><div>04094 {
04095     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a> i;
04096 
04097     <span class="keywordflow">if</span> (CommandHistory-&gt;NumberOfCommands == 0) {
04098         <span class="keywordflow">return</span> -1;
04099     }
04100     <span class="keywordflow">if</span> (!(Flags &amp; <a class="code" href="../../d4/d1/cmdline_8h.html#a16">FMCFL_JUST_LOOKING</a>) &amp;&amp; (CommandHistory-&gt;Flags &amp; <a class="code" href="../../d4/d1/cmdline_8h.html#a5">CLE_RESET</a>)) {
04101         CommandHistory-&gt;Flags &amp;= ~<a class="code" href="../../d4/d1/cmdline_8h.html#a5">CLE_RESET</a>;
04102     } <span class="keywordflow">else</span> {
04103         <a class="code" href="../../d4/d1/cmdline_8h.html#a10">COMMAND_IND_PREV</a>(CommandIndex, CommandHistory);
04104     }
04105     <span class="keywordflow">if</span> (cbIn == 0) {
04106         <span class="keywordflow">return</span> CommandIndex;
04107     }
04108     <span class="keywordflow">for</span> (i=0;i&lt;CommandHistory-&gt;NumberOfCommands;i++) {
04109         <a class="code" href="../../d8/d7/struct__COMMAND.html">PCOMMAND</a> pcmdT = CommandHistory-&gt;Commands[CommandIndex];
04110 
04111         <span class="keywordflow">if</span> ((!(Flags &amp; <a class="code" href="../../d4/d1/cmdline_8h.html#a15">FMCFL_EXACT_MATCH</a>) &amp;&amp; (cbIn &lt;= pcmdT-&gt;<a class="code" href="../../d8/d7/struct__COMMAND.html#o0">CommandLength</a>)) ||
04112                 ((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)cbIn == pcmdT-&gt;<a class="code" href="../../d8/d7/struct__COMMAND.html#o0">CommandLength</a>)) {
04113             <span class="keywordflow">if</span> (!<a class="code" href="../../d3/d1/server_2cmdline_8c.html#a10">my_wcsncmp</a>(pcmdT-&gt;<a class="code" href="../../d8/d7/struct__COMMAND.html#o1">Command</a>, pwszIn, (USHORT)cbIn)) {
04114                 <span class="keywordflow">return</span> CommandIndex;
04115             }
04116         }
04117         <a class="code" href="../../d4/d1/cmdline_8h.html#a10">COMMAND_IND_PREV</a>(CommandIndex, CommandHistory);
04118     }
04119     <span class="keywordflow">return</span> -1;
04120 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a49" doxytag="cmdline.h::GetChar" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS GetChar           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d7/d2/struct__INPUT__INFORMATION.html">PINPUT_INFORMATION</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>InputInfo</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT PWCHAR&nbsp;</td>
          <td class="mdname" nowrap> <em>Char</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>Wait</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d1/d3/struct__CONSOLE__INFORMATION.html">PCONSOLE_INFORMATION</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Console</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d4/d3/struct__HANDLE__DATA.html">PHANDLE_DATA</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>HandleData</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PCSR_API_MSG Message&nbsp;</td>
          <td class="mdname" nowrap> <em>OPTIONAL</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN CSR_WAIT_ROUTINE WaitRoutine&nbsp;</td>
          <td class="mdname" nowrap> <em>OPTIONAL</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PVOID WaitParameter&nbsp;</td>
          <td class="mdname" nowrap> <em>OPTIONAL</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG WaitParameterLength&nbsp;</td>
          <td class="mdname" nowrap> <em>OPTIONAL</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN WaitBlockExists&nbsp;</td>
          <td class="mdname" nowrap> <em>OPTIONAL</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT PBOOLEAN CommandLineEditingKeys&nbsp;</td>
          <td class="mdname" nowrap> <em>OPTIONAL</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT PBOOLEAN CommandLinePopupKeys&nbsp;</td>
          <td class="mdname" nowrap> <em>OPTIONAL</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT PBOOLEAN EnableScrollMode&nbsp;</td>
          <td class="mdname" nowrap> <em>OPTIONAL</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT PDWORD KeyState&nbsp;</td>
          <td class="mdname" nowrap> <em>OPTIONAL</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d6/server_2stream_8c-source.html#l00263">263</a> of file <a class="el" href="../../d1/d6/server_2stream_8c-source.html">server/stream.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d2/d0/bench_8c-source.html#l00050">CHAR</a>, <a class="el" href="../../d5/d9/w32_2ntcon_2server_2misc_8c-source.html#l01469">CharToWchar()</a>, <a class="el" href="../../d9/d8/client_2ntstubs_8c-source.html#l00086">Event()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d6/d8/ntrtlp_8h-source.html#l00184">HIBYTE</a>, <a class="el" href="../../d4/d1/cmdline_8h.html#a51">IsCommandLineEditingKey()</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l02179">IsCommandLinePopupKey()</a>, <a class="el" href="../../d3/d3/tounicod_8c-source.html#l00244">IsDbcsExemptionForHighAnsi()</a>, <a class="el" href="../../d1/d6/server_2stream_8c-source.html#l00229">KEYEVENTSTATE_EQUAL_WINMODS</a>, <a class="el" href="../../d6/d8/ntrtlp_8h-source.html#l00183">LOBYTE</a>, <a class="el" href="../../d6/d5/stierr_8h-source.html#l00030">NT_SUCCESS</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d4/d2/ntcon_2server_2input_8c-source.html#l00959">ReadInputBuffer()</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00062">SHORT</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00135">Status</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d0/d5/ndismain_8h-source.html#l00026">UINT</a>, and <a class="el" href="../../d1/d7/ntcftxt_8h-source.html#l01013">VkKeyScan()</a>.
<p>
Referenced by <a class="el" href="../../d0/d6/almisc_8c-source.html#l00788">CommonMenuDisplay()</a>, <a class="el" href="../../d1/d6/server_2stream_8c-source.html#l01237">CookedRead()</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l02287">ProcessCommandListInput()</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l02793">ProcessCommandNumberInput()</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l02546">ProcessCopyFromCharInput()</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l02677">ProcessCopyToCharInput()</a>, <a class="el" href="../../d1/d6/server_2stream_8c-source.html#l00471">RawReadWaitRoutine()</a>, and <a class="el" href="../../d1/d6/server_2stream_8c-source.html#l01778">ReadChars()</a>.
<p>
<pre class="fragment"><div>00282                    :
00283 
00284     This routine <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> used in stream input.  It gets input and filters <a class="code" href="../../d1/d9/icmui_8def.html#a4">it</a>
00285     <span class="keywordflow">for</span> unicode characters.
00286 
00287 Arguments:
00288 
00289     InputInfo - Pointer to input buffer information.
00290 
00291     Char - <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a96">Unicode</a> <span class="keywordtype">char</span> input.
00292 
00293     Wait - <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> routine shouldn'<a class="code" href="../../d4/d1/genmips_8c.html#a17">t</a> wait <span class="keywordflow">for</span> input.
00294 
00295     Console - Pointer to console buffer information.
00296 
00297     HandleData - Pointer to handle data structure.
00298 
00299     Message - csr api message.
00300 
00301     WaitRoutine - Routine to call when wait <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> woken up.
00302 
00303     WaitParameter - Parameter to pass to wait routine.
00304 
00305     WaitParameterLength - Length of wait parameter.
00306 
00307     WaitBlockExists - <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> <span class="keywordflow">if</span> wait block has already been created.
00308 
00309     CommandLineEditingKeys - <span class="keywordflow">if</span> present, arrow keys will be returned. on
00310     output, <span class="keywordflow">if</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>, Char contains <span class="keyword">virtual</span> key code <span class="keywordflow">for</span> arrow key.
00311 
00312     CommandLinePopupKeys - <span class="keywordflow">if</span> present, arrow keys will be returned. on
00313     output, <span class="keywordflow">if</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>, Char contains <span class="keyword">virtual</span> key code <span class="keywordflow">for</span> arrow key.
00314 
00315 Return Value:
00316 
00317 --*/
00318 
00319 {
00320     ULONG NumRead;
00321     INPUT_RECORD <a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a5">Event</a>;
00322     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
00323 
00324     <span class="keywordflow">if</span> (ARGUMENT_PRESENT(CommandLineEditingKeys)) {
00325         *CommandLineEditingKeys = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00326     }
00327     <span class="keywordflow">if</span> (ARGUMENT_PRESENT(CommandLinePopupKeys)) {
00328         *CommandLinePopupKeys = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00329     }
00330     <span class="keywordflow">if</span> (ARGUMENT_PRESENT(EnableScrollMode)) {
00331         *EnableScrollMode = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00332     }
00333     <span class="keywordflow">if</span> (ARGUMENT_PRESENT(KeyState)) {
00334         *KeyState = 0;
00335     }
00336 
00337     NumRead = 1;
00338     <span class="keywordflow">while</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>) {
00339         <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> =<a class="code" href="../../d3/d3/ntcon_2server_2input_8c.html#a25">ReadInputBuffer</a>(InputInfo,
00340                                  &amp;Event,
00341                                  &amp;NumRead,
00342                                  FALSE,
00343                                  Wait,
00344                                  TRUE,
00345                                  Console,
00346                                  HandleData,
00347                                  Message,
00348                                  WaitRoutine,
00349                                  WaitParameter,
00350                                  WaitParameterLength,
00351                                  WaitBlockExists
00352 #<span class="keywordflow">if</span> defined(FE_SB)
00353                                  ,
00354                                  TRUE
00355 #endif
00356                                 );
00357         <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status)) {
00358             <span class="keywordflow">return</span> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
00359         }
00360         <span class="keywordflow">if</span> (NumRead == 0) {
00361             <span class="keywordflow">if</span> (Wait) {
00362                 <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a> (FALSE);
00363             }
00364             <span class="keywordflow">else</span> {
00365                 <span class="keywordflow">return</span> STATUS_UNSUCCESSFUL;
00366             }
00367         }
00368         <span class="keywordflow">if</span> (<a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a5">Event</a>.EventType == KEY_EVENT) {
00369             <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> fCommandLineEditKey;
00370 
00371             <span class="keywordflow">if</span> (ARGUMENT_PRESENT(CommandLineEditingKeys)) {
00372                 fCommandLineEditKey = <a class="code" href="../../d4/d1/cmdline_8h.html#a51">IsCommandLineEditingKey</a>(&amp;<a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a5">Event</a>.Event.KeyEvent);
00373             } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ARGUMENT_PRESENT(CommandLinePopupKeys)) {
00374                 fCommandLineEditKey = <a class="code" href="../../d4/d1/cmdline_8h.html#a50">IsCommandLinePopupKey</a>(&amp;<a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a5">Event</a>.Event.KeyEvent);
00375             } <span class="keywordflow">else</span> {
00376                 fCommandLineEditKey = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00377             }
00378 
00379             <span class="comment">//</span>
00380             <span class="comment">// Always return keystate if caller asked for it.</span>
00381             <span class="comment">//</span>
00382             <span class="keywordflow">if</span> (ARGUMENT_PRESENT(KeyState)) {
00383                 *KeyState = <a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a5">Event</a>.Event.KeyEvent.dwControlKeyState;
00384             }
00385 
00386             <span class="keywordflow">if</span> (<a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a5">Event</a>.Event.KeyEvent.uChar.UnicodeChar != 0 &amp;&amp;
00387                     !fCommandLineEditKey) {
00388 
00389                 <span class="comment">//</span>
00390                 <span class="comment">// chars that are generated using alt+numpad</span>
00391                 <span class="comment">//</span>
00392                 <span class="keywordflow">if</span> (!<a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a5">Event</a>.Event.KeyEvent.bKeyDown &amp;&amp;
00393                         <a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a5">Event</a>.Event.KeyEvent.wVirtualKeyCode == VK_MENU) {
00394                     <span class="keywordflow">if</span> (<a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a5">Event</a>.Event.KeyEvent.dwControlKeyState &amp; ALTNUMPAD_BIT)
00395                     {
00396                         <span class="keywordflow">if</span> (CONSOLE_IS_DBCS_CP(Console) &amp;&amp; <a class="code" href="../../d5/d9/ntrtlp_8h.html#a5">HIBYTE</a>(<a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a5">Event</a>.Event.KeyEvent.uChar.UnicodeChar)) {
00397                             <span class="keywordtype">char</span> chT[2] = {
00398                                 <a class="code" href="../../d5/d9/ntrtlp_8h.html#a5">HIBYTE</a>(<a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a5">Event</a>.Event.KeyEvent.uChar.UnicodeChar),
00399                                 <a class="code" href="../../d5/d9/ntrtlp_8h.html#a4">LOBYTE</a>(<a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a5">Event</a>.Event.KeyEvent.uChar.UnicodeChar),
00400                             };
00401                             *Char = <a class="code" href="../../d4/d0/w32_2ntcon_2server_2misc_8c.html#a39">CharToWchar</a>(Console, Console-&gt;CP, chT);
00402                         } <span class="keywordflow">else</span> {
00403                             <span class="comment">// Because USER doesn't know our codepage, it gives us the</span>
00404                             <span class="comment">// raw OEM char and we convert it to a Unicode character.</span>
00405                             <span class="keywordtype">char</span> chT = <a class="code" href="../../d5/d9/ntrtlp_8h.html#a4">LOBYTE</a>(<a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a5">Event</a>.Event.KeyEvent.uChar.UnicodeChar);
00406                             <a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a> uCodePage = Console-&gt;CP;
00407 
00408                             <span class="comment">//</span>
00409                             <span class="comment">// FarEast hack for High ANSI OEM characters.</span>
00410                             <span class="comment">//</span>
00411                             <span class="keywordflow">if</span> (CONSOLE_IS_DBCS_CP(Console)) {
00412                                 <span class="keywordflow">if</span> (<a class="code" href="../../d2/d4/tounicod_8c.html#a15">IsDbcsExemptionForHighAnsi</a>(uCodePage, chT)) {
00413                                     <span class="comment">/*</span>
00414 <span class="comment">                                     * FarEast hack:</span>
00415 <span class="comment">                                     * treat characters in High ANSI area as if they are</span>
00416 <span class="comment">                                     * the ones of Codepage 1252.</span>
00417 <span class="comment">                                     */</span>
00418                                     uCodePage = 1252;
00419                                 }
00420                             }
00421                             *Char = <a class="code" href="../../d4/d0/w32_2ntcon_2server_2misc_8c.html#a39">CharToWchar</a>(Console, uCodePage, &amp;chT);
00422                         }
00423                     } <span class="keywordflow">else</span> {
00424                         *Char = <a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a5">Event</a>.Event.KeyEvent.uChar.UnicodeChar;
00425                     }
00426                     <span class="keywordflow">return</span> STATUS_SUCCESS;
00427                 }
00428                 <span class="comment">//</span>
00429                 <span class="comment">// Ignore Escape and Newline chars</span>
00430                 <span class="comment">//</span>
00431                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a5">Event</a>.Event.KeyEvent.bKeyDown &amp;&amp;
00432                         <a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a5">Event</a>.Event.KeyEvent.wVirtualKeyCode != VK_ESCAPE &amp;&amp;
00433                         <a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a5">Event</a>.Event.KeyEvent.uChar.UnicodeChar != 0x0a) {
00434 
00435                     *Char = <a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a5">Event</a>.Event.KeyEvent.uChar.UnicodeChar;
00436                     <span class="keywordflow">return</span> STATUS_SUCCESS;
00437                 }
00438             }
00439 
00440             <span class="keywordflow">if</span> (<a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a5">Event</a>.Event.KeyEvent.bKeyDown) {
00441                 <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a> sTmp;
00442                 <span class="keywordflow">if</span> (ARGUMENT_PRESENT(CommandLineEditingKeys) &amp;&amp;
00443                         fCommandLineEditKey) {
00444                     *CommandLineEditingKeys = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00445                     *Char = (WCHAR) <a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a5">Event</a>.Event.KeyEvent.wVirtualKeyCode;
00446                     <span class="keywordflow">return</span> STATUS_SUCCESS;
00447                 }
00448                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ARGUMENT_PRESENT(CommandLinePopupKeys) &amp;&amp;
00449                         fCommandLineEditKey) {
00450                     *CommandLinePopupKeys = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00451                     *Char = (<a class="code" href="../../d1/d1/bench_8c.html#a16">CHAR</a>) <a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a5">Event</a>.Event.KeyEvent.wVirtualKeyCode;
00452                     <span class="keywordflow">return</span> STATUS_SUCCESS;
00453                 }
00454 
00455                 sTmp = <a class="code" href="../../d0/d8/ntcftxt_8h.html#a31">VkKeyScan</a>(0);
00456 
00457                 <span class="keywordflow">if</span> ((<a class="code" href="../../d5/d9/ntrtlp_8h.html#a4">LOBYTE</a>(sTmp) == <a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a5">Event</a>.Event.KeyEvent.wVirtualKeyCode) &amp;&amp;
00458                     <a class="code" href="../../d0/d7/server_2stream_8c.html#a7">KEYEVENTSTATE_EQUAL_WINMODS</a>(Event, <a class="code" href="../../d5/d9/ntrtlp_8h.html#a5">HIBYTE</a>(sTmp))) {
00459                     <span class="comment">/*</span>
00460 <span class="comment">                     * This really is the character 0x0000</span>
00461 <span class="comment">                     */</span>
00462                     *Char = <a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a5">Event</a>.Event.KeyEvent.uChar.UnicodeChar;
00463                     <span class="keywordflow">return</span> STATUS_SUCCESS;
00464                 }
00465             }
00466         }
00467     }
00468 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a55" doxytag="cmdline.h::GetLastCommand" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d8/d7/struct__COMMAND.html">PCOMMAND</a> GetLastCommand           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d9/d7/struct__COMMAND__HISTORY.html">PCOMMAND_HISTORY</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>CommandHistory</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l03217">3217</a> of file <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html">server/cmdline.c</a>.
<p>
References <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>.
<p>
Referenced by <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l03272">ProcessCommandLine()</a>, and <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l02677">ProcessCopyToCharInput()</a>.
<p>
<pre class="fragment"><div>03220 {
03221     <span class="keywordflow">if</span> (CommandHistory-&gt;NumberOfCommands == 0)
03222         <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
03223     <span class="keywordflow">return</span> CommandHistory-&gt;Commands[CommandHistory-&gt;LastDisplayed];
03224 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a63" doxytag="cmdline.h::InitExtendedEditKeys" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID InitExtendedEditKeys           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">CONST ExtKeyDefBuf *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>lpbuf</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l00186">186</a> of file <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html">server/cmdline.c</a>.
<p>
References <a class="el" href="../../d0/d7/halvprnt_8c-source.html#l00031">BYTE</a>, <a class="el" href="../../d7/d5/memprint_8h-source.html#l00079">DbgPrint</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l00088">gaDefaultKeyDef</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l00086">gaKeyDef</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, and <a class="el" href="../../d2/d7/hal_8h.html#a212">VOID()</a>.
<p>
Referenced by <a class="el" href="../../d1/d4/srvinit_8c-source.html#l02210">GetRegistryValues()</a>.
<p>
<pre class="fragment"><div>00187 {
00188     CONST <a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a>* lpbyte;
00189     <span class="keywordtype">int</span> i;
00190     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> dwCheckSum;
00191 
00192     <span class="comment">//</span>
00193     <span class="comment">// Sanity check</span>
00194     <span class="comment">// If pKeyDefBuf is NULL, give it the default value.</span>
00195     <span class="comment">// If the version is not supported, just use the default and bail.</span>
00196     <span class="comment">//</span>
00197     <span class="keywordflow">if</span> (pKeyDefBuf == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> || pKeyDefBuf-&gt;dwVersion != 0) {
00198 <span class="preprocessor">#if DBG</span>
00199 <span class="preprocessor"></span>        <span class="keywordflow">if</span> (pKeyDefBuf != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00200             <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"InitExtendedEditKeys: Unsupported version number(%d)\n"</span>, pKeyDefBuf-&gt;dwVersion);
00201         }
00202 <span class="preprocessor">#endif</span>
00203 <span class="preprocessor"></span>retry_clean:
00204         memcpy(gaKeyDef, gaDefaultKeyDef, <span class="keyword">sizeof</span> gaKeyDef);
00205         <span class="keywordflow">return</span>;
00206     }
00207 
00208     <span class="comment">//</span>
00209     <span class="comment">// Calculate check sum</span>
00210     <span class="comment">//</span>
00211     dwCheckSum = 0;
00212     <span class="keywordflow">for</span> (lpbyte = (CONST <a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a>*)pKeyDefBuf, i = FIELD_OFFSET(ExtKeyDefBuf, table); i &lt; <span class="keyword">sizeof</span> *pKeyDefBuf; ++i) {
00213         dwCheckSum += lpbyte[i];
00214     }
00215     <span class="keywordflow">if</span> (dwCheckSum != pKeyDefBuf-&gt;dwCheckSum) {
00216 <span class="preprocessor">#if DBG</span>
00217 <span class="preprocessor"></span>        <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"InitExtendedEditKeys: Checksum(%d) does not match.\n"</span>, pKeyDefBuf-&gt;dwCheckSum);
00218 <span class="preprocessor">#endif</span>
00219 <span class="preprocessor"></span>        <span class="keywordflow">goto</span> retry_clean;
00220     }
00221 
00222     <span class="comment">//</span>
00223     <span class="comment">// Copy the entity</span>
00224     <span class="comment">//</span>
00225 
00226     memcpy(gaKeyDef, pKeyDefBuf-&gt;table, <span class="keyword">sizeof</span> gaKeyDef);
00227 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a51" doxytag="cmdline.h::IsCommandLineEditingKey" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL IsCommandLineEditingKey           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN OUT PKEY_EVENT_RECORD&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>KeyEvent</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d1/d6/server_2stream_8c-source.html#l00263">GetChar()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a50" doxytag="cmdline.h::IsCommandLinePopupKey" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL IsCommandLinePopupKey           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN OUT PKEY_EVENT_RECORD&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>KeyEvent</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l02179">2179</a> of file <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html">server/cmdline.c</a>.
<p>
References <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d7/d5/ntcon_2server_2globals_8h-source.html#l00054">gExtendedEditKey</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l00229">ParseEditKeyInfo()</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d1/d6/server_2stream_8c-source.html#l00263">GetChar()</a>.
<p>
<pre class="fragment"><div>02182 {
02183     <span class="keywordflow">if</span> (!(KeyEvent-&gt;dwControlKeyState &amp;
02184             (RIGHT_ALT_PRESSED | LEFT_ALT_PRESSED |
02185              RIGHT_CTRL_PRESSED | LEFT_CTRL_PRESSED))) {
02186         <span class="keywordflow">switch</span> (KeyEvent-&gt;wVirtualKeyCode) {
02187         <span class="keywordflow">case</span> VK_ESCAPE:
02188         <span class="keywordflow">case</span> VK_PRIOR:
02189         <span class="keywordflow">case</span> VK_NEXT:
02190         <span class="keywordflow">case</span> VK_END:
02191         <span class="keywordflow">case</span> VK_HOME:
02192         <span class="keywordflow">case</span> VK_LEFT:
02193         <span class="keywordflow">case</span> VK_UP:
02194         <span class="keywordflow">case</span> VK_RIGHT:
02195         <span class="keywordflow">case</span> VK_DOWN:
02196         <span class="keywordflow">case</span> VK_F9:
02197             <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
02198         <span class="keywordflow">default</span>:
02199             <span class="keywordflow">break</span>;
02200         }
02201     }
02202 
02203     <span class="comment">//</span>
02204     <span class="comment">// Extended key handling</span>
02205     <span class="comment">//</span>
02206     <span class="keywordflow">if</span> (<a class="code" href="../../d6/d6/ntcon_2server_2globals_8h.html#a24">gExtendedEditKey</a> &amp;&amp; <a class="code" href="../../d3/d1/server_2cmdline_8c.html#a17">ParseEditKeyInfo</a>(KeyEvent)) {
02207         <span class="keywordflow">return</span> KeyEvent-&gt;uChar.UnicodeChar == 0;
02208     }
02209 
02210     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
02211 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a64" doxytag="cmdline.h::IsPauseKey" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL IsPauseKey           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PKEY_EVENT_RECORD&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>pKeyEvent</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l00289">289</a> of file <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html">server/cmdline.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l00078">CTRL_BUT_NOT_ALT</a>, <a class="el" href="../../d7/d5/ntcon_2server_2globals_8h-source.html#l00054">gExtendedEditKey</a>, <a class="el" href="../../d3/d9/aw_8h-source.html#l00031">L</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, and <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l00229">ParseEditKeyInfo()</a>.
<p>
Referenced by <a class="el" href="../../d4/d2/ntcon_2server_2input_8c-source.html#l01340">PreprocessInput()</a>.
<p>
<pre class="fragment"><div>00290 {
00291     <span class="keywordflow">if</span> (<a class="code" href="../../d6/d6/ntcon_2server_2globals_8h.html#a24">gExtendedEditKey</a>) {
00292         KEY_EVENT_RECORD KeyEvent = *pKeyEvent;
00293         CONST ExtKeySubst* pKeySubst = <a class="code" href="../../d3/d1/server_2cmdline_8c.html#a17">ParseEditKeyInfo</a>(&amp;KeyEvent);
00294 
00295         <span class="keywordflow">return</span> pKeySubst != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> &amp;&amp; pKeySubst-&gt;wVirKey == VK_PAUSE;
00296     }
00297 
00298     <span class="keywordflow">return</span> pKeyEvent-&gt;wVirtualKeyCode == <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="charliteral">'S'</span> &amp;&amp; <a class="code" href="../../d3/d1/server_2cmdline_8c.html#a8">CTRL_BUT_NOT_ALT</a>(pKeyEvent-&gt;dwControlKeyState);
00299 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a65" doxytag="cmdline.h::IsWordDelim" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL IsWordDelim           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">WCHAR&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l00309">309</a> of file <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html">server/cmdline.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l00306">gaWordDelimChars</a>, <a class="el" href="../../d3/d9/aw_8h-source.html#l00031">L</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, and <a class="el" href="../../d5/d0/cmdline_8h-source.html#l00405">WORD_DELIM_MAX</a>.
<p>
<pre class="fragment"><div>00310 {
00311     <span class="keywordtype">int</span> i;
00312 
00313     <span class="comment">//</span>
00314     <span class="comment">// Before it reaches here, L' ' case should have beeen already detected,</span>
00315     <span class="comment">// and gaWordDelimChars is specified.</span>
00316     <span class="comment">//</span>
00317     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(wch != L<span class="charliteral">' '</span> &amp;&amp; gaWordDelimChars[0]);
00318 
00319     <span class="keywordflow">for</span> (i = 0; <a class="code" href="../../d3/d1/server_2cmdline_8c.html#a14">gaWordDelimChars</a>[i] &amp;&amp; i &lt; <a class="code" href="../../d4/d1/cmdline_8h.html#a24">WORD_DELIM_MAX</a>; ++i) {
00320         <span class="keywordflow">if</span> (wch == <a class="code" href="../../d3/d1/server_2cmdline_8c.html#a14">gaWordDelimChars</a>[i]) {
00321             <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00322         }
00323     }
00324 
00325     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00326 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a40" doxytag="cmdline.h::ProcessCommandLine" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS ProcessCommandLine           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d2/d8/struct__COOKED__READ__DATA.html">PCOOKED_READ_DATA</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>CookedReadData</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN WCHAR&nbsp;</td>
          <td class="mdname" nowrap> <em>Char</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>KeyState</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PCSR_API_MSG&nbsp;</td>
          <td class="mdname" nowrap> <em>WaitReplyMessage</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PCSR_THREAD&nbsp;</td>
          <td class="mdname" nowrap> <em>WaitingThread</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>WaitRoutine</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l03272">3272</a> of file <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html">server/cmdline.c</a>.
<p>
References <a class="el" href="../../d7/d7/dispatch_8h-source.html#l00115">AdjustCursorPosition</a>, <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d0/d3/input_8h-source.html#l00094">AT_EOL</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l03245">AtFirstCommand()</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l03262">AtLastCommand()</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l01817">BeginPopup()</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d5/d0/cmdline_8h-source.html#l00065">CLE_ALLOCATED</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l00878">ClearAliases()</a>, <a class="el" href="../../d5/d0/cmdline_8h-source.html#l00024">_COMMAND::Command</a>, <a class="el" href="../../d5/d0/cmdline_8h-source.html#l00112">COMMAND_NUM_TO_INDEX</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l00065">COMMAND_NUMBER_LENGTH</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l00064">COMMAND_NUMBER_PROMPT_LENGTH</a>, <a class="el" href="../../d5/d0/cmdline_8h-source.html#l00023">_COMMAND::CommandLength</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l02935">CommandListPopup()</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l03150">CommandNumberPopup()</a>, <a class="el" href="../../d9/d4/consrv_8h-source.html#l00149">CONSOLE_IS_DBCS_ENABLED</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l00062">COPY_FROM_CHAR_PROMPT_LENGTH</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l00061">COPY_TO_CHAR_PROMPT_LENGTH</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l03040">CopyFromCharPopup()</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l03096">CopyToCharPopup()</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l00076">CTRL_PRESSED</a>, <a class="el" href="../../d7/d4/ioep_8h-source.html#l00067">DBGPRINT</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l02009">DeleteCommandLine()</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l03227">EmptyCommandHistory()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l04078">FindMatchingCommand()</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l03217">GetLastCommand()</a>, <a class="el" href="../../d5/d0/cmdline_8h-source.html#l00399">IS_WORD_DELIM</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l00066">MINIMUM_COMMAND_PROMPT_SIZE</a>, <a class="el" href="../../d6/d5/stierr_8h-source.html#l00030">NT_SUCCESS</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d0/d7/halvprnt_8c-source.html#l00031">PBYTE</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l04834">RetrieveCommand()</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l02111">RetrieveNthCommand()</a>, <a class="el" href="../../d1/d6/server_2stream_8c-source.html#l00818">RetrieveNumberOfSpaces()</a>, <a class="el" href="../../d1/d6/server_2stream_8c-source.html#l00774">RetrieveTotalNumberOfSpaces()</a>, <a class="el" href="../../d7/d0/ntcon_2server_2cursor_8c-source.html#l00288">SetCursorMode()</a>, <a class="el" href="../../d7/d0/ntcon_2server_2cursor_8c-source.html#l00474">SetCursorPosition()</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00062">SHORT</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00135">Status</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00064">USHORT</a>, <a class="el" href="../../d5/d0/cmdline_8h-source.html#l00353">WC_DESTRUCTIVE_BACKSPACE</a>, <a class="el" href="../../d5/d0/cmdline_8h-source.html#l00355">WC_ECHO</a>, <a class="el" href="../../d5/d0/cmdline_8h-source.html#l00354">WC_KEEP_CURSOR_VISIBLE</a>, and <a class="el" href="../../d1/d6/server_2stream_8c-source.html#l03047">WriteCharsFromInput()</a>.
<p>
Referenced by <a class="el" href="../../d1/d6/server_2stream_8c-source.html#l01237">CookedRead()</a>, and <a class="el" href="../../d1/d6/server_2stream_8c-source.html#l00876">ProcessCookedReadInput()</a>.
<p>
<pre class="fragment"><div>03286                 :
03287 
03288     <a class="code" href="../../d1/d7/server_8h.html#a64">CONSOLE_STATUS_WAIT</a> - <a class="code" href="../../d3/d1/server_2cmdline_8c.html#a58">CommandListPopup</a> ran <a class="code" href="../../d6/d0/wsprintf_8c.html#a0">out</a> of input
03289     <a class="code" href="../../d1/d7/server_8h.html#a65">CONSOLE_STATUS_READ_COMPLETE</a> - user hit &lt;enter&gt; in <a class="code" href="../../d3/d1/server_2cmdline_8c.html#a58">CommandListPopup</a>
03290     STATUS_SUCCESS - everything's cool
03291 
03292 --*/
03293 
03294 {
03295     COORD CurrentPosition;
03296     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> CharsToWrite;
03297     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
03298     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> UpdateCursorPosition;
03299     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a> ScrollY=0;
03300     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> fStartFromDelim;
03301 
03302     UpdateCursorPosition = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
03303     <span class="keywordflow">if</span> (Char == VK_F7 &amp;&amp;
03304         !(KeyState &amp; (RIGHT_CTRL_PRESSED | LEFT_CTRL_PRESSED | RIGHT_ALT_PRESSED | LEFT_ALT_PRESSED))) {
03305         COORD PopupSize;
03306 
03307         <span class="keywordflow">if</span> (CookedReadData-&gt;CommandHistory &amp;&amp;
03308             CookedReadData-&gt;CommandHistory-&gt;NumberOfCommands) {
03309             PopupSize.X = 40;
03310             PopupSize.Y = 10;
03311             <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d3/d1/server_2cmdline_8c.html#a45">BeginPopup</a>(CookedReadData-&gt;ScreenInfo,
03312                        CookedReadData-&gt;CommandHistory,
03313                        PopupSize
03314                       );
03315             <span class="keywordflow">if</span> (<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status)) {
03316                 <span class="comment">// CommandListPopup does EndPopup call</span>
03317                 <span class="keywordflow">return</span> <a class="code" href="../../d3/d1/server_2cmdline_8c.html#a58">CommandListPopup</a>(CookedReadData,
03318                                         WaitReplyMessage,
03319                                         WaitingThread,
03320                                         WaitRoutine
03321                                        );
03322             }
03323         }
03324     } <span class="keywordflow">else</span> {
03325         <span class="keywordflow">switch</span> (Char) {
03326             <span class="keywordflow">case</span> VK_ESCAPE:
03327                 <a class="code" href="../../d4/d1/cmdline_8h.html#a41">DeleteCommandLine</a>(CookedReadData,
03328                                   TRUE);
03329                 <span class="keywordflow">break</span>;
03330             <span class="keywordflow">case</span> VK_UP:
03331             <span class="keywordflow">case</span> VK_DOWN:
03332             <span class="keywordflow">case</span> VK_F5:
03333                 <span class="keywordflow">if</span> (Char == VK_F5)
03334                     Char = VK_UP;
03335                 <span class="comment">// for doskey compatibility, buffer isn't circular</span>
03336                 <span class="keywordflow">if</span> (Char==VK_UP &amp;&amp; !<a class="code" href="../../d3/d1/server_2cmdline_8c.html#a65">AtFirstCommand</a>(CookedReadData-&gt;CommandHistory) ||
03337                     Char==VK_DOWN &amp;&amp; !<a class="code" href="../../d3/d1/server_2cmdline_8c.html#a66">AtLastCommand</a>(CookedReadData-&gt;CommandHistory)) {
03338                     <a class="code" href="../../d4/d1/cmdline_8h.html#a41">DeleteCommandLine</a>(CookedReadData,
03339                                       TRUE);
03340                     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d8/d5/consrv_8h.html#a253">RetrieveCommand</a>(CookedReadData-&gt;CommandHistory,
03341                                              Char,
03342                                              CookedReadData-&gt;BackupLimit,
03343                                              CookedReadData-&gt;BufferSize,
03344                                              &amp;CookedReadData-&gt;BytesRead);
03345                     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(CookedReadData-&gt;BackupLimit == CookedReadData-&gt;BufPtr);
03346                     <span class="keywordflow">if</span> (CookedReadData-&gt;Echo) {
03347                         <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d0/d7/server_2stream_8c.html#a38">WriteCharsFromInput</a>(CookedReadData-&gt;ScreenInfo,
03348                                 CookedReadData-&gt;BackupLimit,
03349                                 CookedReadData-&gt;BufPtr,
03350                                 CookedReadData-&gt;BufPtr,
03351                                 &amp;CookedReadData-&gt;BytesRead,
03352                                 (PLONG)&amp;CookedReadData-&gt;NumberOfVisibleChars,
03353                                 CookedReadData-&gt;OriginalCursorPosition.X,
03354                                 WC_DESTRUCTIVE_BACKSPACE |
03355                                         WC_KEEP_CURSOR_VISIBLE | WC_ECHO,
03356                                 &amp;ScrollY );
03357                         <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status));
03358                         CookedReadData-&gt;OriginalCursorPosition.Y += ScrollY;
03359                     }
03360                     CharsToWrite = CookedReadData-&gt;BytesRead/<span class="keyword">sizeof</span>(WCHAR);
03361                     CookedReadData-&gt;CurrentPosition = CharsToWrite;
03362                     CookedReadData-&gt;BufPtr = CookedReadData-&gt;BackupLimit + CharsToWrite;
03363                 }
03364                 <span class="keywordflow">break</span>;
03365             <span class="keywordflow">case</span> VK_PRIOR:
03366             <span class="keywordflow">case</span> VK_NEXT:
03367                 <span class="keywordflow">if</span> (CookedReadData-&gt;CommandHistory &amp;&amp;
03368                     CookedReadData-&gt;CommandHistory-&gt;NumberOfCommands) {
03369 
03370                 <span class="comment">//</span>
03371                 <span class="comment">// display oldest or newest command</span>
03372                 <span class="comment">//</span>
03373 
03374                 <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a> CommandNumber;
03375                 <span class="keywordflow">if</span> (Char == VK_PRIOR) {
03376                     CommandNumber = 0;
03377                 } <span class="keywordflow">else</span> {
03378                     CommandNumber = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a>)(CookedReadData-&gt;CommandHistory-&gt;NumberOfCommands-1);
03379                 }
03380                 <a class="code" href="../../d4/d1/cmdline_8h.html#a41">DeleteCommandLine</a>(CookedReadData,
03381                                   TRUE);
03382                 <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d3/d1/server_2cmdline_8c.html#a50">RetrieveNthCommand</a>(CookedReadData-&gt;CommandHistory,
03383                                             <a class="code" href="../../d4/d1/cmdline_8h.html#a8">COMMAND_NUM_TO_INDEX</a>(CommandNumber,CookedReadData-&gt;CommandHistory),
03384                                             CookedReadData-&gt;BackupLimit,
03385                                             CookedReadData-&gt;BufferSize,
03386                                             &amp;CookedReadData-&gt;BytesRead);
03387                 <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(CookedReadData-&gt;BackupLimit == CookedReadData-&gt;BufPtr);
03388                 <span class="keywordflow">if</span> (CookedReadData-&gt;Echo) {
03389                     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d0/d7/server_2stream_8c.html#a38">WriteCharsFromInput</a>(CookedReadData-&gt;ScreenInfo,
03390                                         CookedReadData-&gt;BackupLimit,
03391                                         CookedReadData-&gt;BufPtr,
03392                                         CookedReadData-&gt;BufPtr,
03393                                         &amp;CookedReadData-&gt;BytesRead,
03394                                         (PLONG)&amp;CookedReadData-&gt;NumberOfVisibleChars,
03395                                         CookedReadData-&gt;OriginalCursorPosition.X,
03396                                         WC_DESTRUCTIVE_BACKSPACE |
03397                                                 WC_KEEP_CURSOR_VISIBLE | WC_ECHO,
03398                                         &amp;ScrollY
03399                                         );
03400                     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status));
03401                     CookedReadData-&gt;OriginalCursorPosition.Y += ScrollY;
03402                 }
03403                 CharsToWrite = CookedReadData-&gt;BytesRead/<span class="keyword">sizeof</span>(WCHAR);
03404                 CookedReadData-&gt;CurrentPosition = CharsToWrite;
03405                 CookedReadData-&gt;BufPtr = CookedReadData-&gt;BackupLimit + CharsToWrite;
03406                 }
03407                 <span class="keywordflow">break</span>;
03408             <span class="keywordflow">case</span> VK_END:
03409                 <span class="keywordflow">if</span> (KeyState &amp; (RIGHT_CTRL_PRESSED | LEFT_CTRL_PRESSED)) {
03410                     <a class="code" href="../../d4/d1/cmdline_8h.html#a41">DeleteCommandLine</a>(CookedReadData,
03411                                       FALSE);
03412                     CookedReadData-&gt;BytesRead = CookedReadData-&gt;CurrentPosition*<span class="keyword">sizeof</span>(WCHAR);
03413                     <span class="keywordflow">if</span> (CookedReadData-&gt;Echo) {
03414                         <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d0/d7/server_2stream_8c.html#a38">WriteCharsFromInput</a>(CookedReadData-&gt;ScreenInfo,
03415                                             CookedReadData-&gt;BackupLimit,
03416                                             CookedReadData-&gt;BackupLimit,
03417                                             CookedReadData-&gt;BackupLimit,
03418                                             &amp;CookedReadData-&gt;BytesRead,
03419                                             (PLONG)&amp;CookedReadData-&gt;NumberOfVisibleChars,
03420                                             CookedReadData-&gt;OriginalCursorPosition.X,
03421                                             WC_DESTRUCTIVE_BACKSPACE |
03422                                                 WC_KEEP_CURSOR_VISIBLE | WC_ECHO,
03423                                             NULL
03424                                             );
03425                         <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status));
03426                     }
03427                 } <span class="keywordflow">else</span> {
03428                     CookedReadData-&gt;CurrentPosition = CookedReadData-&gt;BytesRead/<span class="keyword">sizeof</span>(WCHAR);
03429                     CookedReadData-&gt;BufPtr = CookedReadData-&gt;BackupLimit + CookedReadData-&gt;CurrentPosition;
03430                     CurrentPosition.X = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a>)(CookedReadData-&gt;OriginalCursorPosition.X + CookedReadData-&gt;NumberOfVisibleChars);
03431                     CurrentPosition.Y = CookedReadData-&gt;OriginalCursorPosition.Y;
03432 <span class="preprocessor">#if defined(FE_SB)</span>
03433 <span class="preprocessor"></span>                    <span class="keywordflow">if</span> (CheckBisectProcessW(CookedReadData-&gt;ScreenInfo,
03434                                             CookedReadData-&gt;ScreenInfo-&gt;Console-&gt;CP,
03435                                             CookedReadData-&gt;BackupLimit,
03436                                             CookedReadData-&gt;CurrentPosition,
03437                                             CookedReadData-&gt;ScreenInfo-&gt;ScreenBufferSize.X-CookedReadData-&gt;OriginalCursorPosition.X,
03438                                             CookedReadData-&gt;OriginalCursorPosition.X,
03439                                             TRUE)) {
03440                         CurrentPosition.X++;
03441                     }
03442 <span class="preprocessor">#endif</span>
03443 <span class="preprocessor"></span>                    UpdateCursorPosition = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
03444                 }
03445                 <span class="keywordflow">break</span>;
03446             <span class="keywordflow">case</span> VK_HOME:
03447                 <span class="keywordflow">if</span> (KeyState &amp; (RIGHT_CTRL_PRESSED | LEFT_CTRL_PRESSED)) {
03448                     <a class="code" href="../../d4/d1/cmdline_8h.html#a41">DeleteCommandLine</a>(CookedReadData,
03449                                       FALSE);
03450                     CookedReadData-&gt;BytesRead -= CookedReadData-&gt;CurrentPosition*<span class="keyword">sizeof</span>(WCHAR);
03451                     CookedReadData-&gt;CurrentPosition = 0;
03452                     RtlCopyMemory(CookedReadData-&gt;BackupLimit,
03453                            CookedReadData-&gt;BufPtr,
03454                            CookedReadData-&gt;BytesRead
03455                            );
03456                     CookedReadData-&gt;BufPtr = CookedReadData-&gt;BackupLimit;
03457                     <span class="keywordflow">if</span> (CookedReadData-&gt;Echo) {
03458                         <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d0/d7/server_2stream_8c.html#a38">WriteCharsFromInput</a>(CookedReadData-&gt;ScreenInfo,
03459                                             CookedReadData-&gt;BackupLimit,
03460                                             CookedReadData-&gt;BackupLimit,
03461                                             CookedReadData-&gt;BackupLimit,
03462                                             &amp;CookedReadData-&gt;BytesRead,
03463                                             (PLONG)&amp;CookedReadData-&gt;NumberOfVisibleChars,
03464                                             CookedReadData-&gt;OriginalCursorPosition.X,
03465                                             WC_DESTRUCTIVE_BACKSPACE |
03466                                                 WC_KEEP_CURSOR_VISIBLE | WC_ECHO,
03467                                             NULL
03468                                             );
03469                         <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status));
03470                     }
03471                     CurrentPosition = CookedReadData-&gt;OriginalCursorPosition;
03472                     UpdateCursorPosition = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
03473                 } <span class="keywordflow">else</span> {
03474                     CookedReadData-&gt;CurrentPosition = 0;
03475                     CookedReadData-&gt;BufPtr = CookedReadData-&gt;BackupLimit;
03476                     CurrentPosition = CookedReadData-&gt;OriginalCursorPosition;
03477                     UpdateCursorPosition = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
03478                 }
03479                 <span class="keywordflow">break</span>;
03480             <span class="keywordflow">case</span> VK_LEFT:
03481                 <span class="keywordflow">if</span> (KeyState &amp; (RIGHT_CTRL_PRESSED | LEFT_CTRL_PRESSED)) {
03482                     PWCHAR LastWord;
03483                     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> NonSpaceCharSeen=<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
03484                     <span class="keywordflow">if</span> (CookedReadData-&gt;BufPtr != CookedReadData-&gt;BackupLimit) {
03485                         LastWord = CookedReadData-&gt;BufPtr-1;
03486                         <span class="keywordflow">while</span> (LastWord != CookedReadData-&gt;BackupLimit) {
03487                             <span class="keywordflow">if</span> (!<a class="code" href="../../d4/d1/cmdline_8h.html#a23">IS_WORD_DELIM</a>(*LastWord))
03488                                 NonSpaceCharSeen=<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
03489                             <span class="keywordflow">else</span>
03490                                 <span class="keywordflow">if</span> (NonSpaceCharSeen)
03491                                     <span class="keywordflow">break</span>;
03492                             LastWord--;
03493                         }
03494                         <span class="keywordflow">if</span> (LastWord != CookedReadData-&gt;BackupLimit) {
03495                             CookedReadData-&gt;BufPtr = LastWord+1;
03496                         } <span class="keywordflow">else</span> {
03497                             CookedReadData-&gt;BufPtr = LastWord;
03498                         }
03499                         CookedReadData-&gt;CurrentPosition=(ULONG)(CookedReadData-&gt;BufPtr-CookedReadData-&gt;BackupLimit);
03500                         CurrentPosition = CookedReadData-&gt;OriginalCursorPosition;
03501 <span class="preprocessor">#if defined(FE_SB)</span>
03502 <span class="preprocessor"></span>                        CurrentPosition.X = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a>)(CurrentPosition.X +
03503                             <a class="code" href="../../d0/d7/server_2stream_8c.html#a21">RetrieveTotalNumberOfSpaces</a>(CookedReadData-&gt;OriginalCursorPosition.X,
03504                                                         CookedReadData-&gt;BackupLimit,
03505                                                         CookedReadData-&gt;CurrentPosition,
03506                                                         CookedReadData-&gt;ScreenInfo-&gt;Console));
03507                         <span class="keywordflow">if</span> (CheckBisectStringW(CookedReadData-&gt;ScreenInfo,
03508                                                CookedReadData-&gt;ScreenInfo-&gt;Console-&gt;CP,
03509                                                CookedReadData-&gt;BackupLimit,
03510                                                CookedReadData-&gt;CurrentPosition+1,
03511                                                CookedReadData-&gt;ScreenInfo-&gt;ScreenBufferSize.X
03512                                                 -CookedReadData-&gt;OriginalCursorPosition.X
03513                                                )) {
03514                             CurrentPosition.X++;
03515                         }
03516 <span class="preprocessor">#else</span>
03517 <span class="preprocessor"></span>                        CurrentPosition.X = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a>)(CurrentPosition.X + <a class="code" href="../../d0/d7/server_2stream_8c.html#a21">RetrieveTotalNumberOfSpaces</a>(CookedReadData-&gt;OriginalCursorPosition.X,
03518                                                                          CookedReadData-&gt;BackupLimit,
03519                                                                          CookedReadData-&gt;CurrentPosition));
03520 <span class="preprocessor">#endif</span>
03521 <span class="preprocessor"></span>                        UpdateCursorPosition = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
03522                     }
03523                 } <span class="keywordflow">else</span> {
03524                     <span class="keywordflow">if</span> (CookedReadData-&gt;BufPtr != CookedReadData-&gt;BackupLimit) {
03525                         CookedReadData-&gt;BufPtr--;
03526                         CookedReadData-&gt;CurrentPosition--;
03527                         CurrentPosition.X = CookedReadData-&gt;ScreenInfo-&gt;BufferInfo.TextInfo.CursorPosition.X;
03528                         CurrentPosition.Y = CookedReadData-&gt;ScreenInfo-&gt;BufferInfo.TextInfo.CursorPosition.Y;
03529 <span class="preprocessor">#if defined(FE_SB)</span>
03530 <span class="preprocessor"></span>                        CurrentPosition.X = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a>)(CurrentPosition.X -
03531                             <a class="code" href="../../d0/d7/server_2stream_8c.html#a22">RetrieveNumberOfSpaces</a>(CookedReadData-&gt;OriginalCursorPosition.X,
03532                                                    CookedReadData-&gt;BackupLimit,
03533                                                    CookedReadData-&gt;CurrentPosition,
03534                                                    CookedReadData-&gt;ScreenInfo-&gt;Console,
03535                                                    CookedReadData-&gt;ScreenInfo-&gt;Console-&gt;CP));
03536                         <span class="keywordflow">if</span> (CheckBisectProcessW(CookedReadData-&gt;ScreenInfo,
03537                                                 CookedReadData-&gt;ScreenInfo-&gt;Console-&gt;CP,
03538                                                 CookedReadData-&gt;BackupLimit,
03539                                                 CookedReadData-&gt;CurrentPosition+2,
03540                                                 CookedReadData-&gt;ScreenInfo-&gt;ScreenBufferSize.X
03541                                                  -CookedReadData-&gt;OriginalCursorPosition.X,
03542                                                 CookedReadData-&gt;OriginalCursorPosition.X,
03543                                                 TRUE)) {
03544                             <span class="keywordflow">if</span> ((CurrentPosition.X == -2) ||
03545                                 (CurrentPosition.X == -1)) {
03546                                 CurrentPosition.X--;
03547                             }
03548                         }
03549 <span class="preprocessor">#else</span>
03550 <span class="preprocessor"></span>                        CurrentPosition.X = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a>)(CurrentPosition.X - <a class="code" href="../../d0/d7/server_2stream_8c.html#a22">RetrieveNumberOfSpaces</a>(CookedReadData-&gt;OriginalCursorPosition.X,
03551                                                                     CookedReadData-&gt;BackupLimit,
03552                                                                     CookedReadData-&gt;CurrentPosition));
03553 <span class="preprocessor">#endif</span>
03554 <span class="preprocessor"></span>                        UpdateCursorPosition = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
03555                     }
03556                 }
03557                 <span class="keywordflow">break</span>;
03558             <span class="keywordflow">case</span> VK_RIGHT:
03559             <span class="keywordflow">case</span> VK_F1:
03560 
03561                 <span class="comment">//</span>
03562                 <span class="comment">// we don't need to check for end of buffer here because we've</span>
03563                 <span class="comment">// already done it.</span>
03564                 <span class="comment">//</span>
03565 
03566                 <span class="keywordflow">if</span> (KeyState &amp; (RIGHT_CTRL_PRESSED | LEFT_CTRL_PRESSED)) {
03567                     <span class="keywordflow">if</span> (Char != VK_F1) {
03568                         PWCHAR NextWord;
03569                         <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a> i;
03570                         <span class="keywordflow">if</span> (CookedReadData-&gt;CurrentPosition &lt; (CookedReadData-&gt;BytesRead/<span class="keyword">sizeof</span>(WCHAR))) {
03571                             NextWord = CookedReadData-&gt;BufPtr;
03572                             <span class="keywordflow">for</span> (i=(<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a>)(CookedReadData-&gt;CurrentPosition);
03573                                  i&lt;(<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a>)((CookedReadData-&gt;BytesRead-1)/<span class="keyword">sizeof</span>(WCHAR));
03574                                  i++) {
03575                                 <span class="keywordflow">if</span> (<a class="code" href="../../d4/d1/cmdline_8h.html#a23">IS_WORD_DELIM</a>(*NextWord)) {
03576                                     i++;
03577                                     NextWord++;
03578                                     <span class="keywordflow">while</span> ((i&lt;(<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a>)((CookedReadData-&gt;BytesRead-1)/<span class="keyword">sizeof</span>(WCHAR))) &amp;&amp;
03579                                             <a class="code" href="../../d4/d1/cmdline_8h.html#a23">IS_WORD_DELIM</a>(*NextWord)) {
03580                                         i++;
03581                                         NextWord++;
03582                                     }
03583                                     <span class="keywordflow">break</span>;
03584                                 }
03585                                 NextWord++;
03586                             }
03587                             CookedReadData-&gt;BufPtr = NextWord;
03588                             CookedReadData-&gt;CurrentPosition=(ULONG)(CookedReadData-&gt;BufPtr-CookedReadData-&gt;BackupLimit);
03589 <span class="preprocessor">#if defined(FE_SB)</span>
03590 <span class="preprocessor"></span>                            CurrentPosition = CookedReadData-&gt;OriginalCursorPosition;
03591                             CurrentPosition.X = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a>)(CurrentPosition.X +
03592                                 <a class="code" href="../../d0/d7/server_2stream_8c.html#a21">RetrieveTotalNumberOfSpaces</a>(CookedReadData-&gt;OriginalCursorPosition.X,
03593                                                             CookedReadData-&gt;BackupLimit,
03594                                                             CookedReadData-&gt;CurrentPosition,
03595                                                             CookedReadData-&gt;ScreenInfo-&gt;Console));
03596                             <span class="keywordflow">if</span> (CheckBisectStringW(CookedReadData-&gt;ScreenInfo,
03597                                                    CookedReadData-&gt;ScreenInfo-&gt;Console-&gt;CP,
03598                                                    CookedReadData-&gt;BackupLimit,
03599                                                    CookedReadData-&gt;CurrentPosition+1,
03600                                                    CookedReadData-&gt;ScreenInfo-&gt;ScreenBufferSize.X
03601                                                     -CookedReadData-&gt;OriginalCursorPosition.X
03602                                                    )) {
03603                                 CurrentPosition.X++;
03604                             }
03605 <span class="preprocessor">#else</span>
03606 <span class="preprocessor"></span>                            CurrentPosition = CookedReadData-&gt;OriginalCursorPosition;
03607                             CurrentPosition.X = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a>)(CurrentPosition.X + <a class="code" href="../../d0/d7/server_2stream_8c.html#a21">RetrieveTotalNumberOfSpaces</a>(CookedReadData-&gt;OriginalCursorPosition.X,
03608                                                                              CookedReadData-&gt;BackupLimit,
03609                                                                              CookedReadData-&gt;CurrentPosition));
03610 <span class="preprocessor">#endif</span>
03611 <span class="preprocessor"></span>                            UpdateCursorPosition = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
03612                         }
03613                     }
03614                 } <span class="keywordflow">else</span> {
03615 
03616                     <span class="comment">//</span>
03617                     <span class="comment">// if not at the end of the line, move cursor position right</span>
03618                     <span class="comment">//</span>
03619 
03620                     <span class="keywordflow">if</span> (CookedReadData-&gt;CurrentPosition &lt; (CookedReadData-&gt;BytesRead/<span class="keyword">sizeof</span>(WCHAR))) {
03621                         CurrentPosition = CookedReadData-&gt;ScreenInfo-&gt;BufferInfo.TextInfo.CursorPosition;
03622 <span class="preprocessor">#if defined(FE_SB)</span>
03623 <span class="preprocessor"></span>                        CurrentPosition.X = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a>)(CurrentPosition.X +
03624                             <a class="code" href="../../d0/d7/server_2stream_8c.html#a22">RetrieveNumberOfSpaces</a>(CookedReadData-&gt;OriginalCursorPosition.X,
03625                                                    CookedReadData-&gt;BackupLimit,
03626                                                    CookedReadData-&gt;CurrentPosition,
03627                                                    CookedReadData-&gt;ScreenInfo-&gt;Console,
03628                                                    CookedReadData-&gt;ScreenInfo-&gt;Console-&gt;CP));
03629                         <span class="keywordflow">if</span> (CheckBisectProcessW(CookedReadData-&gt;ScreenInfo,
03630                                                 CookedReadData-&gt;ScreenInfo-&gt;Console-&gt;CP,
03631                                                 CookedReadData-&gt;BackupLimit,
03632                                                 CookedReadData-&gt;CurrentPosition+2,
03633                                                 CookedReadData-&gt;ScreenInfo-&gt;ScreenBufferSize.X
03634                                                  -CookedReadData-&gt;OriginalCursorPosition.X,
03635                                                 CookedReadData-&gt;OriginalCursorPosition.X,
03636                                                 TRUE)) {
03637                             <span class="keywordflow">if</span> (CurrentPosition.X == (CookedReadData-&gt;ScreenInfo-&gt;ScreenBufferSize.X-1))
03638                                 CurrentPosition.X++;
03639                         }
03640 <span class="preprocessor">#else</span>
03641 <span class="preprocessor"></span>                        CurrentPosition.X = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a>)(CurrentPosition.X + <a class="code" href="../../d0/d7/server_2stream_8c.html#a22">RetrieveNumberOfSpaces</a>(CookedReadData-&gt;OriginalCursorPosition.X,
03642                                                                     CookedReadData-&gt;BackupLimit,
03643                                                                     CookedReadData-&gt;CurrentPosition));
03644 <span class="preprocessor">#endif</span>
03645 <span class="preprocessor"></span>                        CookedReadData-&gt;BufPtr++;
03646                         CookedReadData-&gt;CurrentPosition++;
03647                         UpdateCursorPosition = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
03648 
03649                     <span class="comment">//</span>
03650                     <span class="comment">// if at the end of the line, copy a character from the</span>
03651                     <span class="comment">// same position in the last command</span>
03652                     <span class="comment">//</span>
03653 
03654                     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (CookedReadData-&gt;CommandHistory) {
03655                         <a class="code" href="../../d8/d7/struct__COMMAND.html">PCOMMAND</a> LastCommand;
03656                         <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> NumSpaces;
03657                         LastCommand = <a class="code" href="../../d4/d1/cmdline_8h.html#a55">GetLastCommand</a>(CookedReadData-&gt;CommandHistory);
03658                         <span class="keywordflow">if</span> (LastCommand &amp;&amp; (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)(LastCommand-&gt;<a class="code" href="../../d8/d7/struct__COMMAND.html#o0">CommandLength</a>/<span class="keyword">sizeof</span>(WCHAR)) &gt; (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)CookedReadData-&gt;CurrentPosition) {
03659                             *CookedReadData-&gt;BufPtr = LastCommand-&gt;<a class="code" href="../../d8/d7/struct__COMMAND.html#o1">Command</a>[CookedReadData-&gt;CurrentPosition];
03660                             CookedReadData-&gt;BytesRead += <span class="keyword">sizeof</span>(WCHAR);
03661                             CookedReadData-&gt;CurrentPosition++;
03662                             <span class="keywordflow">if</span> (CookedReadData-&gt;Echo) {
03663                                 CharsToWrite = <span class="keyword">sizeof</span>(WCHAR);
03664                                 <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d0/d7/server_2stream_8c.html#a38">WriteCharsFromInput</a>(
03665                                         CookedReadData-&gt;ScreenInfo,
03666                                         CookedReadData-&gt;BackupLimit,
03667                                         CookedReadData-&gt;BufPtr,
03668                                         CookedReadData-&gt;BufPtr,
03669                                         &amp;CharsToWrite,
03670                                         (PLONG)&amp;NumSpaces,
03671                                         CookedReadData-&gt;OriginalCursorPosition.X,
03672                                         WC_DESTRUCTIVE_BACKSPACE |
03673                                                 WC_KEEP_CURSOR_VISIBLE | WC_ECHO,
03674                                         &amp;ScrollY);
03675                                 <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status));
03676                                 CookedReadData-&gt;OriginalCursorPosition.Y += ScrollY;
03677                                 CookedReadData-&gt;NumberOfVisibleChars += NumSpaces;
03678                             }
03679                             CookedReadData-&gt;BufPtr+=1;
03680                         }
03681                     }
03682                 }
03683                 <span class="keywordflow">break</span>;
03684             <span class="keywordflow">case</span> VK_F2:
03685 
03686                 <span class="comment">//</span>
03687                 <span class="comment">// copy the previous command to the current command, up to but</span>
03688                 <span class="comment">// not including the character specified by the user.  the user</span>
03689                 <span class="comment">// is prompted via popup to enter a character.</span>
03690                 <span class="comment">//</span>
03691 
03692                 <span class="keywordflow">if</span> (CookedReadData-&gt;CommandHistory) {
03693                     COORD PopupSize;
03694 
03695                     PopupSize.X = <a class="code" href="../../d3/d1/server_2cmdline_8c.html#a0">COPY_TO_CHAR_PROMPT_LENGTH</a>+2;
03696                     PopupSize.Y = 1;
03697                     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d3/d1/server_2cmdline_8c.html#a45">BeginPopup</a>(CookedReadData-&gt;ScreenInfo,
03698                                CookedReadData-&gt;CommandHistory,
03699                                PopupSize
03700                               );
03701                     <span class="keywordflow">if</span> (<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status)) {
03702                         <span class="comment">// CopyToCharPopup does EndPopup call</span>
03703                         <span class="keywordflow">return</span> <a class="code" href="../../d3/d1/server_2cmdline_8c.html#a61">CopyToCharPopup</a>(CookedReadData,
03704                                                WaitReplyMessage,
03705                                                WaitingThread,
03706                                                WaitRoutine
03707                                               );
03708                     }
03709                 }
03710                 <span class="keywordflow">break</span>;
03711             <span class="keywordflow">case</span> VK_F3:
03712 
03713                 <span class="comment">//</span>
03714                 <span class="comment">// copy the remainder of the previous command to the current command.</span>
03715                 <span class="comment">//</span>
03716 
03717                 <span class="keywordflow">if</span> (CookedReadData-&gt;CommandHistory) {
03718                     <a class="code" href="../../d8/d7/struct__COMMAND.html">PCOMMAND</a> LastCommand;
03719                     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> NumSpaces;
03720                     <span class="keywordtype">int</span> j;  <span class="comment">// chars, not bytes</span>
03721                     LastCommand = <a class="code" href="../../d4/d1/cmdline_8h.html#a55">GetLastCommand</a>(CookedReadData-&gt;CommandHistory);
03722                     <span class="keywordflow">if</span> (LastCommand &amp;&amp; (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)(LastCommand-&gt;<a class="code" href="../../d8/d7/struct__COMMAND.html#o0">CommandLength</a>/<span class="keyword">sizeof</span>(WCHAR)) &gt; (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)CookedReadData-&gt;CurrentPosition) {
03723                         j = (LastCommand-&gt;<a class="code" href="../../d8/d7/struct__COMMAND.html#o0">CommandLength</a>/<span class="keyword">sizeof</span>(WCHAR)) - CookedReadData-&gt;CurrentPosition;
03724                         RtlCopyMemory(CookedReadData-&gt;BufPtr,
03725                                 &amp;LastCommand-&gt;<a class="code" href="../../d8/d7/struct__COMMAND.html#o1">Command</a>[CookedReadData-&gt;CurrentPosition],
03726                                 j*<span class="keyword">sizeof</span>(WCHAR)
03727                                );
03728                         CookedReadData-&gt;CurrentPosition += j;
03729                         j *= <span class="keyword">sizeof</span>(WCHAR);
03730                         CookedReadData-&gt;BytesRead += j;
03731                         <span class="keywordflow">if</span> (CookedReadData-&gt;Echo) {
03732                             <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d0/d7/server_2stream_8c.html#a38">WriteCharsFromInput</a>(CookedReadData-&gt;ScreenInfo,
03733                                     CookedReadData-&gt;BackupLimit,
03734                                     CookedReadData-&gt;BufPtr,
03735                                     CookedReadData-&gt;BufPtr,
03736                                     (PDWORD) &amp;j,
03737                                     (PLONG)&amp;NumSpaces,
03738                                     CookedReadData-&gt;OriginalCursorPosition.X,
03739                                     WC_DESTRUCTIVE_BACKSPACE |
03740                                             WC_KEEP_CURSOR_VISIBLE | WC_ECHO,
03741                                     &amp;ScrollY);
03742                             <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status));
03743                             CookedReadData-&gt;OriginalCursorPosition.Y += ScrollY;
03744                             CookedReadData-&gt;NumberOfVisibleChars += NumSpaces;
03745                         }
03746                         CookedReadData-&gt;BufPtr+=j/<span class="keyword">sizeof</span>(WCHAR);
03747                     }
03748                 }
03749                 <span class="keywordflow">break</span>;
03750             <span class="keywordflow">case</span> VK_F4:
03751 
03752                 <span class="comment">//</span>
03753                 <span class="comment">// copy the previous command to the current command, from</span>
03754                 <span class="comment">// the letter specified by the user.   the user</span>
03755                 <span class="comment">// is prompted via popup to enter a character.</span>
03756                 <span class="comment">//</span>
03757 
03758                 <span class="keywordflow">if</span> (CookedReadData-&gt;CommandHistory) {
03759                     COORD PopupSize;
03760 
03761                     PopupSize.X = <a class="code" href="../../d3/d1/server_2cmdline_8c.html#a1">COPY_FROM_CHAR_PROMPT_LENGTH</a>+2;
03762                     PopupSize.Y = 1;
03763                     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d3/d1/server_2cmdline_8c.html#a45">BeginPopup</a>(CookedReadData-&gt;ScreenInfo,
03764                                CookedReadData-&gt;CommandHistory,
03765                                PopupSize
03766                               );
03767                     <span class="keywordflow">if</span> (<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status)) {
03768                         <span class="comment">// CopyFromCharPopup does EndPopup call</span>
03769                         <span class="keywordflow">return</span> <a class="code" href="../../d3/d1/server_2cmdline_8c.html#a60">CopyFromCharPopup</a>(CookedReadData,
03770                                                WaitReplyMessage,
03771                                                WaitingThread,
03772                                                WaitRoutine
03773                                               );
03774                     }
03775                 }
03776                 <span class="keywordflow">break</span>;
03777             <span class="keywordflow">case</span> VK_F6:
03778 
03779                 <span class="comment">//</span>
03780                 <span class="comment">// place a ctrl-z in the current command line</span>
03781                 <span class="comment">//</span>
03782 
03783                 {
03784                 <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> NumSpaces;
03785                 *CookedReadData-&gt;BufPtr = (WCHAR)0x1a; <span class="comment">// ctrl-z</span>
03786                 CookedReadData-&gt;BytesRead += <span class="keyword">sizeof</span>(WCHAR);
03787                 CookedReadData-&gt;CurrentPosition++;
03788                 <span class="keywordflow">if</span> (CookedReadData-&gt;Echo) {
03789                     CharsToWrite = <span class="keyword">sizeof</span>(WCHAR);
03790                     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d0/d7/server_2stream_8c.html#a38">WriteCharsFromInput</a>(CookedReadData-&gt;ScreenInfo,
03791                                         CookedReadData-&gt;BackupLimit,
03792                                         CookedReadData-&gt;BufPtr,
03793                                         CookedReadData-&gt;BufPtr,
03794                                         &amp;CharsToWrite,
03795                                         (PLONG)&amp;NumSpaces,
03796                                         CookedReadData-&gt;OriginalCursorPosition.X,
03797                                         WC_DESTRUCTIVE_BACKSPACE |
03798                                                 WC_KEEP_CURSOR_VISIBLE | WC_ECHO,
03799                                         &amp;ScrollY
03800                                         );
03801                     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status));
03802                     CookedReadData-&gt;OriginalCursorPosition.Y += ScrollY;
03803                     CookedReadData-&gt;NumberOfVisibleChars += NumSpaces;
03804                 }
03805                 CookedReadData-&gt;BufPtr+=1;
03806                 }
03807                 <span class="keywordflow">break</span>;
03808             <span class="keywordflow">case</span> VK_F7:
03809                 <span class="keywordflow">if</span> (KeyState &amp; (RIGHT_ALT_PRESSED | LEFT_ALT_PRESSED)) {
03810                     <a class="code" href="../../d4/d1/cmdline_8h.html#a43">EmptyCommandHistory</a>(CookedReadData-&gt;CommandHistory);
03811                     CookedReadData-&gt;CommandHistory-&gt;Flags |= <a class="code" href="../../d4/d1/cmdline_8h.html#a4">CLE_ALLOCATED</a>;
03812                 }
03813                 <span class="keywordflow">break</span>;
03814             <span class="keywordflow">case</span> VK_F8:
03815                 <span class="keywordflow">if</span> (CookedReadData-&gt;CommandHistory) {
03816                     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a> i;
03817 
03818                     <span class="comment">//</span>
03819                     <span class="comment">// cycles through the stored commands that start with</span>
03820                     <span class="comment">// the characters in the current command</span>
03821                     <span class="comment">//</span>
03822 
03823                     i = <a class="code" href="../../d4/d1/cmdline_8h.html#a56">FindMatchingCommand</a>(CookedReadData-&gt;CommandHistory,
03824                             CookedReadData-&gt;BackupLimit,
03825                             CookedReadData-&gt;CurrentPosition*<span class="keyword">sizeof</span>(WCHAR),
03826                             CookedReadData-&gt;CommandHistory-&gt;LastDisplayed, 0);
03827                     <span class="keywordflow">if</span> (i!=-1) {
03828                         <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a> CurrentPosition;
03829                         COORD CursorPosition;
03830 
03831                         <span class="comment">//</span>
03832                         <span class="comment">// save cursor position</span>
03833                         <span class="comment">//</span>
03834 
03835                         CurrentPosition = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a>)CookedReadData-&gt;CurrentPosition;
03836                         CursorPosition = CookedReadData-&gt;ScreenInfo-&gt;BufferInfo.TextInfo.CursorPosition;
03837 
03838                         <a class="code" href="../../d4/d1/cmdline_8h.html#a41">DeleteCommandLine</a>(CookedReadData,
03839                                           TRUE);
03840                         <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d3/d1/server_2cmdline_8c.html#a50">RetrieveNthCommand</a>(CookedReadData-&gt;CommandHistory,
03841                                                     i,
03842                                                     CookedReadData-&gt;BackupLimit,
03843                                                     CookedReadData-&gt;BufferSize,
03844                                                     &amp;CookedReadData-&gt;BytesRead);
03845                         <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(CookedReadData-&gt;BackupLimit == CookedReadData-&gt;BufPtr);
03846                         <span class="keywordflow">if</span> (CookedReadData-&gt;Echo) {
03847                             <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d0/d7/server_2stream_8c.html#a38">WriteCharsFromInput</a>(CookedReadData-&gt;ScreenInfo,
03848                                     CookedReadData-&gt;BackupLimit,
03849                                     CookedReadData-&gt;BufPtr,
03850                                     CookedReadData-&gt;BufPtr,
03851                                     &amp;CookedReadData-&gt;BytesRead,
03852                                     (PLONG)&amp;CookedReadData-&gt;NumberOfVisibleChars,
03853                                     CookedReadData-&gt;OriginalCursorPosition.X,
03854                                     WC_DESTRUCTIVE_BACKSPACE |
03855                                             WC_KEEP_CURSOR_VISIBLE | WC_ECHO,
03856                                     &amp;ScrollY);
03857                             <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status));
03858                             CookedReadData-&gt;OriginalCursorPosition.Y += ScrollY;
03859                         }
03860                         CursorPosition.Y += ScrollY;
03861 
03862                         <span class="comment">//</span>
03863                         <span class="comment">// restore cursor position</span>
03864                         <span class="comment">//</span>
03865 
03866                         CookedReadData-&gt;BufPtr = CookedReadData-&gt;BackupLimit + CurrentPosition;
03867                         CookedReadData-&gt;CurrentPosition = CurrentPosition;
03868                         <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d6/d1/ntcon_2server_2cursor_8c.html#a7">SetCursorPosition</a>(CookedReadData-&gt;ScreenInfo,
03869                                                    CursorPosition,
03870                                                    TRUE
03871                                                   );
03872                         <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status));
03873                     }
03874                 }
03875                 <span class="keywordflow">break</span>;
03876             <span class="keywordflow">case</span> VK_F9:
03877 
03878                 <span class="comment">//</span>
03879                 <span class="comment">// prompt the user to enter the desired command number.</span>
03880                 <span class="comment">// copy that command to the command line.</span>
03881                 <span class="comment">//</span>
03882 
03883                 {
03884                 COORD PopupSize;
03885 
03886                 <span class="keywordflow">if</span> (CookedReadData-&gt;CommandHistory &amp;&amp;
03887                     CookedReadData-&gt;CommandHistory-&gt;NumberOfCommands &amp;&amp;
03888                     CookedReadData-&gt;ScreenInfo-&gt;ScreenBufferSize.X &gt;= <a class="code" href="../../d3/d1/server_2cmdline_8c.html#a4">MINIMUM_COMMAND_PROMPT_SIZE</a>+2) {  <span class="comment">// 2 is for border</span>
03889                     PopupSize.X = <a class="code" href="../../d3/d1/server_2cmdline_8c.html#a2">COMMAND_NUMBER_PROMPT_LENGTH</a>+<a class="code" href="../../d3/d1/server_2cmdline_8c.html#a3">COMMAND_NUMBER_LENGTH</a>;
03890                     PopupSize.Y = 1;
03891                     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d3/d1/server_2cmdline_8c.html#a45">BeginPopup</a>(CookedReadData-&gt;ScreenInfo,
03892                                         CookedReadData-&gt;CommandHistory,
03893                                         PopupSize
03894                                        );
03895                     <span class="keywordflow">if</span> (<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status)) {
03896                         <span class="comment">// CommandNumberPopup does EndPopup call</span>
03897                         <span class="keywordflow">return</span> <a class="code" href="../../d4/d1/cmdline_8h.html#a57">CommandNumberPopup</a>(CookedReadData,
03898                                                   WaitReplyMessage,
03899                                                   WaitingThread,
03900                                                   WaitRoutine
03901                                                  );
03902                     }
03903                 }
03904                 }
03905                 <span class="keywordflow">break</span>;
03906             <span class="keywordflow">case</span> VK_F10:
03907                 <span class="keywordflow">if</span> (KeyState &amp; (RIGHT_ALT_PRESSED | LEFT_ALT_PRESSED)) {
03908                     <a class="code" href="../../d3/d1/server_2cmdline_8c.html#a32">ClearAliases</a>(CookedReadData-&gt;Console);
03909                 }
03910                 <span class="keywordflow">break</span>;
03911             <span class="keywordflow">case</span> VK_INSERT:
03912                 CookedReadData-&gt;InsertMode = !CookedReadData-&gt;InsertMode;
03913                 <a class="code" href="../../d6/d1/ntcon_2server_2cursor_8c.html#a5">SetCursorMode</a>(CookedReadData-&gt;ScreenInfo,
03914                               (BOOLEAN)(CookedReadData-&gt;InsertMode != CookedReadData-&gt;Console-&gt;InsertMode));
03915                 <span class="keywordflow">break</span>;
03916         <span class="keywordflow">case</span> VK_DELETE:
03917                 <span class="keywordflow">if</span> (!<a class="code" href="../../d9/d3/input_8h.html#a12">AT_EOL</a>(CookedReadData)) {
03918                     COORD CursorPosition;
03919 
03920                     fStartFromDelim = <a class="code" href="../../d4/d1/cmdline_8h.html#a23">IS_WORD_DELIM</a>(*CookedReadData-&gt;BufPtr);
03921 
03922 del_repeat:
03923                     <span class="comment">//</span>
03924                     <span class="comment">// save cursor position</span>
03925                     <span class="comment">//</span>
03926 
03927                     CursorPosition = CookedReadData-&gt;ScreenInfo-&gt;BufferInfo.TextInfo.CursorPosition;
03928 
03929                     <span class="comment">//</span>
03930                     <span class="comment">// deletecommandline</span>
03931                     <span class="comment">//</span>
03932 
03933                     <a class="code" href="../../d4/d1/cmdline_8h.html#a41">DeleteCommandLine</a>(CookedReadData,
03934                                       FALSE);
03935                     <span class="comment">//</span>
03936                     <span class="comment">// delete char</span>
03937                     <span class="comment">//</span>
03938 
03939                     CookedReadData-&gt;BytesRead -= <span class="keyword">sizeof</span>(WCHAR);
03940                     RtlCopyMemory(CookedReadData-&gt;BufPtr,
03941                            CookedReadData-&gt;BufPtr+1,
03942                            CookedReadData-&gt;BytesRead - (CookedReadData-&gt;CurrentPosition*<span class="keyword">sizeof</span>(WCHAR))
03943                           );
03944 
03945 <span class="preprocessor">#if defined(FE_SB)</span>
03946 <span class="preprocessor"></span>                    {
03947                         PWCHAR buf = (PWCHAR)((<a class="code" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a>)CookedReadData-&gt;BackupLimit +
03948                                                      CookedReadData-&gt;BytesRead    );
03949                         *buf = (WCHAR)<span class="charliteral">' '</span>;
03950                     }
03951 <span class="preprocessor">#endif</span>
03952 <span class="preprocessor"></span>                    <span class="comment">//</span>
03953                     <span class="comment">// write commandline</span>
03954                     <span class="comment">//</span>
03955 
03956                     <span class="keywordflow">if</span> (CookedReadData-&gt;Echo) {
03957                         <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d0/d7/server_2stream_8c.html#a38">WriteCharsFromInput</a>(CookedReadData-&gt;ScreenInfo,
03958                                 CookedReadData-&gt;BackupLimit,
03959                                 CookedReadData-&gt;BackupLimit,
03960                                 CookedReadData-&gt;BackupLimit,
03961                                 &amp;CookedReadData-&gt;BytesRead,
03962                                 (PLONG)&amp;CookedReadData-&gt;NumberOfVisibleChars,
03963                                 CookedReadData-&gt;OriginalCursorPosition.X,
03964                                 WC_DESTRUCTIVE_BACKSPACE |
03965                                         WC_KEEP_CURSOR_VISIBLE | WC_ECHO,
03966                                 NULL);
03967                         <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status));
03968                     }
03969 
03970                     <span class="comment">//</span>
03971                     <span class="comment">// restore cursor position</span>
03972                     <span class="comment">//</span>
03973 
03974                     <span class="keywordflow">if</span> (<a class="code" href="../../d8/d5/consrv_8h.html#a32">CONSOLE_IS_DBCS_ENABLED</a>() &amp;&amp; CONSOLE_IS_DBCS_CP(CookedReadData-&gt;Console)) {
03975                         <span class="keywordflow">if</span> (CheckBisectProcessW(CookedReadData-&gt;ScreenInfo,
03976                                                 CookedReadData-&gt;ScreenInfo-&gt;Console-&gt;CP,
03977                                                 CookedReadData-&gt;BackupLimit,
03978                                                 CookedReadData-&gt;CurrentPosition+1,
03979                                                 CookedReadData-&gt;ScreenInfo-&gt;ScreenBufferSize.X
03980                                                  -CookedReadData-&gt;OriginalCursorPosition.X,
03981                                                 CookedReadData-&gt;OriginalCursorPosition.X,
03982                                                 TRUE)) {
03983                             CursorPosition.X++;
03984                         }
03985                         CurrentPosition = CursorPosition;
03986                         <span class="keywordflow">if</span> (CookedReadData-&gt;Echo) {
03987                             <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d6/d8/dispatch_8h.html#a10">AdjustCursorPosition</a>(CookedReadData-&gt;ScreenInfo,
03988                                                           CurrentPosition,
03989                                                           TRUE,
03990                                                           NULL);
03991                             <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status));
03992                         }
03993                     }
03994                     <span class="keywordflow">else</span> {
03995                         <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d6/d1/ntcon_2server_2cursor_8c.html#a7">SetCursorPosition</a>(CookedReadData-&gt;ScreenInfo,
03996                                                    CursorPosition,
03997                                                    TRUE
03998                                                   );
03999                         <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status));
04000                     }
04001 
04002                     <span class="comment">// If Ctrl key is pressed, delete a word.</span>
04003                     <span class="comment">// If the start point was word delimiter, just remove delimiters portion only.</span>
04004                     <span class="keywordflow">if</span> ((KeyState &amp; <a class="code" href="../../d3/d1/server_2cmdline_8c.html#a7">CTRL_PRESSED</a>) &amp;&amp; !<a class="code" href="../../d9/d3/input_8h.html#a12">AT_EOL</a>(CookedReadData) &amp;&amp;
04005                             fStartFromDelim ^ !<a class="code" href="../../d4/d1/cmdline_8h.html#a23">IS_WORD_DELIM</a>(*CookedReadData-&gt;BufPtr)) {
04006                         <a class="code" href="../../d6/d5/ioep_8h.html#a21">DBGPRINT</a>((<span class="stringliteral">"Repeating it(%x).\n"</span>, *CookedReadData-&gt;BufPtr));
04007                         <span class="keywordflow">goto</span> del_repeat;
04008                     }
04009                 }
04010                 <span class="keywordflow">break</span>;
04011             <span class="keywordflow">default</span>:
04012                 <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(FALSE);
04013                 <span class="keywordflow">break</span>;
04014         }
04015     }
04016     <span class="keywordflow">if</span> (UpdateCursorPosition &amp;&amp; CookedReadData-&gt;Echo) {
04017         <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d6/d8/dispatch_8h.html#a10">AdjustCursorPosition</a>(CookedReadData-&gt;ScreenInfo,
04018                                       CurrentPosition,
04019                                       TRUE,
04020                                       NULL);
04021         <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status));
04022     }
04023     <span class="keywordflow">return</span> STATUS_SUCCESS;
04024 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a53" doxytag="cmdline.h::ProcessCookedReadInput" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL ProcessCookedReadInput           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d2/d8/struct__COOKED__READ__DATA.html">PCOOKED_READ_DATA</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>CookedReadData</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN WCHAR&nbsp;</td>
          <td class="mdname" nowrap> <em>Char</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>KeyState</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT PNTSTATUS&nbsp;</td>
          <td class="mdname" nowrap> <em>Status</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d6/server_2stream_8c-source.html#l00876">876</a> of file <a class="el" href="../../d1/d6/server_2stream_8c-source.html">server/stream.c</a>.
<p>
References <a class="el" href="../../d7/d7/dispatch_8h-source.html#l00115">AdjustCursorPosition</a>, <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d0/d3/input_8h-source.html#l00094">AT_EOL</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l02009">DeleteCommandLine()</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d7/d5/ntcon_2server_2globals_8h-source.html#l00054">gExtendedEditKey</a>, <a class="el" href="../../d0/d3/input_8h-source.html#l00095">INSERT_MODE</a>, <a class="el" href="../../d5/d0/cmdline_8h-source.html#l00399">IS_WORD_DELIM</a>, <a class="el" href="../../d3/d9/aw_8h-source.html#l00031">L</a>, <a class="el" href="../../d6/d5/stierr_8h-source.html#l00030">NT_SUCCESS</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d0/d7/halvprnt_8c-source.html#l00031">PBYTE</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l03272">ProcessCommandLine()</a>, <a class="el" href="../../d1/d6/server_2stream_8c-source.html#l00818">RetrieveNumberOfSpaces()</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00062">SHORT</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00135">Status</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d5/d4/conimep_8h-source.html#l00175">UNICODE_BACKSPACE</a>, <a class="el" href="../../d5/d4/conimep_8h-source.html#l00176">UNICODE_BACKSPACE2</a>, <a class="el" href="../../d5/d4/conimep_8h-source.html#l00177">UNICODE_CARRIAGERETURN</a>, <a class="el" href="../../d5/d4/conimep_8h-source.html#l00178">UNICODE_LINEFEED</a>, <a class="el" href="../../d5/d0/cmdline_8h-source.html#l00353">WC_DESTRUCTIVE_BACKSPACE</a>, <a class="el" href="../../d5/d0/cmdline_8h-source.html#l00355">WC_ECHO</a>, <a class="el" href="../../d5/d0/cmdline_8h-source.html#l00354">WC_KEEP_CURSOR_VISIBLE</a>, and <a class="el" href="../../d1/d6/server_2stream_8c-source.html#l03047">WriteCharsFromInput()</a>.
<p>
Referenced by <a class="el" href="../../d1/d6/server_2stream_8c-source.html#l01237">CookedRead()</a>, and <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l02287">ProcessCommandListInput()</a>.
<p>
<pre class="fragment"><div>00885                 :
00886 
00887         <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> <span class="keywordflow">if</span> read <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> completed
00888 --*/
00889 
00890 {
00891     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> NumSpaces;
00892     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a> ScrollY=0;
00893     ULONG NumToWrite;
00894     WCHAR wchOrig = Char;
00895     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> fStartFromDelim;
00896 
00897     *<a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = STATUS_SUCCESS;
00898     <span class="keywordflow">if</span> (CookedReadData-&gt;BytesRead &gt;= (CookedReadData-&gt;BufferSize-(2*<span class="keyword">sizeof</span>(WCHAR))) &amp;&amp;
00899         Char != <a class="code" href="../../d4/d5/conimep_8h.html#a53">UNICODE_CARRIAGERETURN</a> &amp;&amp;
00900         Char != <a class="code" href="../../d4/d5/conimep_8h.html#a51">UNICODE_BACKSPACE</a>) {
00901         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00902     }
00903 
00904     <span class="keywordflow">if</span> (CookedReadData-&gt;CtrlWakeupMask != 0 &amp;&amp;
00905         Char &lt; <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="charliteral">' '</span> &amp;&amp; (CookedReadData-&gt;CtrlWakeupMask &amp; (1 &lt;&lt; Char))) {
00906         *CookedReadData-&gt;BufPtr = Char;
00907         CookedReadData-&gt;BytesRead += <span class="keyword">sizeof</span>(WCHAR);
00908         CookedReadData-&gt;BufPtr+=1;
00909         CookedReadData-&gt;CurrentPosition+=1;
00910         CookedReadData-&gt;ControlKeyState = KeyState;
00911         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00912     }
00913 
00914 
00915     <span class="keywordflow">if</span> (Char == EXTKEY_ERASE_PREV_WORD) {
00916         Char = <a class="code" href="../../d4/d5/conimep_8h.html#a51">UNICODE_BACKSPACE</a>;
00917 
00918     }
00919     <span class="keywordflow">if</span> (<a class="code" href="../../d9/d3/input_8h.html#a12">AT_EOL</a>(CookedReadData)) {
00920 
00921         <span class="comment">//</span>
00922         <span class="comment">// if at end of line, processing is relatively simple. just store the</span>
00923         <span class="comment">// character and write it to the screen.</span>
00924         <span class="comment">//</span>
00925 
00926 
00927         <span class="keywordflow">if</span> (Char == <a class="code" href="../../d4/d5/conimep_8h.html#a52">UNICODE_BACKSPACE2</a>) {
00928             Char = <a class="code" href="../../d4/d5/conimep_8h.html#a51">UNICODE_BACKSPACE</a>;
00929         }
00930         <span class="keywordflow">if</span> (Char != <a class="code" href="../../d4/d5/conimep_8h.html#a51">UNICODE_BACKSPACE</a> ||
00931             CookedReadData-&gt;BufPtr != CookedReadData-&gt;BackupLimit) {
00932 
00933             fStartFromDelim = <a class="code" href="../../d6/d6/ntcon_2server_2globals_8h.html#a24">gExtendedEditKey</a> &amp;&amp; <a class="code" href="../../d4/d1/cmdline_8h.html#a23">IS_WORD_DELIM</a>(CookedReadData-&gt;BufPtr[-1]);
00934 
00935 eol_repeat:
00936             <span class="keywordflow">if</span> (CookedReadData-&gt;Echo) {
00937                 NumToWrite=<span class="keyword">sizeof</span>(WCHAR);
00938                 *<a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d0/d7/server_2stream_8c.html#a38">WriteCharsFromInput</a>(CookedReadData-&gt;ScreenInfo,
00939                                     CookedReadData-&gt;BackupLimit,
00940                                     CookedReadData-&gt;BufPtr,
00941                                     &amp;Char,
00942                                     &amp;NumToWrite,
00943                                     (PLONG)&amp;NumSpaces,
00944                                     CookedReadData-&gt;OriginalCursorPosition.X,
00945                                     WC_DESTRUCTIVE_BACKSPACE |
00946                                             WC_KEEP_CURSOR_VISIBLE | WC_ECHO,
00947                                     &amp;ScrollY
00948                                     );
00949                 <span class="keywordflow">if</span> (<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(*Status)) {
00950                     CookedReadData-&gt;OriginalCursorPosition.Y += ScrollY;
00951                 } <span class="keywordflow">else</span> {
00952                     RIPMSG1(RIP_WARNING, <span class="stringliteral">"WriteCharsFromInput failed %x"</span>, *Status);
00953                 }
00954             }
00955             CookedReadData-&gt;NumberOfVisibleChars += NumSpaces;
00956             <span class="keywordflow">if</span> (Char == <a class="code" href="../../d4/d5/conimep_8h.html#a51">UNICODE_BACKSPACE</a> &amp;&amp; CookedReadData-&gt;Processed) {
00957                 CookedReadData-&gt;BytesRead -= <span class="keyword">sizeof</span>(WCHAR);
00958                 *CookedReadData-&gt;BufPtr=(WCHAR)<span class="charliteral">' '</span>;
00959                 CookedReadData-&gt;BufPtr-=1;
00960                 CookedReadData-&gt;CurrentPosition-=1;
00961 
00962                 <span class="comment">// Repeat until it hits the word boundary</span>
00963                 <span class="keywordflow">if</span> (<a class="code" href="../../d6/d6/ntcon_2server_2globals_8h.html#a24">gExtendedEditKey</a> &amp;&amp;
00964                         wchOrig == EXTKEY_ERASE_PREV_WORD &amp;&amp;
00965                         CookedReadData-&gt;BufPtr != CookedReadData-&gt;BackupLimit &amp;&amp;
00966                         fStartFromDelim ^ !<a class="code" href="../../d4/d1/cmdline_8h.html#a23">IS_WORD_DELIM</a>(CookedReadData-&gt;BufPtr[-1])) {
00967                     <span class="keywordflow">goto</span> eol_repeat;
00968                 }
00969             }
00970             <span class="keywordflow">else</span> {
00971                 *CookedReadData-&gt;BufPtr = Char;
00972                 CookedReadData-&gt;BytesRead += <span class="keyword">sizeof</span>(WCHAR);
00973                 CookedReadData-&gt;BufPtr+=1;
00974                 CookedReadData-&gt;CurrentPosition+=1;
00975             }
00976         }
00977     } <span class="keywordflow">else</span> {
00978         <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> CallWrite=<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00979 
00980         <span class="comment">//</span>
00981         <span class="comment">// processing in the middle of the line is more complex:</span>
00982         <span class="comment">//</span>
00983         <span class="comment">//</span>
00984         <span class="comment">// calculate new cursor position</span>
00985         <span class="comment">// store new char</span>
00986         <span class="comment">// clear the current command line from the screen</span>
00987         <span class="comment">// write the new command line to the screen</span>
00988         <span class="comment">// update the cursor position</span>
00989         <span class="comment">//</span>
00990 
00991         <span class="keywordflow">if</span> (Char == <a class="code" href="../../d4/d5/conimep_8h.html#a51">UNICODE_BACKSPACE</a> &amp;&amp; CookedReadData-&gt;Processed) {
00992 
00993             <span class="comment">//</span>
00994             <span class="comment">// for backspace, use writechars to calculate the new cursor position.</span>
00995             <span class="comment">// this call also sets the cursor to the right position for the</span>
00996             <span class="comment">// second call to writechars.</span>
00997             <span class="comment">//</span>
00998             <span class="keywordflow">if</span> (CookedReadData-&gt;BufPtr != CookedReadData-&gt;BackupLimit) {
00999 
01000                 fStartFromDelim = <a class="code" href="../../d6/d6/ntcon_2server_2globals_8h.html#a24">gExtendedEditKey</a> &amp;&amp; <a class="code" href="../../d4/d1/cmdline_8h.html#a23">IS_WORD_DELIM</a>(CookedReadData-&gt;BufPtr[-1]);
01001 
01002 bs_repeat:
01003 
01004                 <span class="comment">//</span>
01005                 <span class="comment">// we call writechar here so that cursor position gets updated</span>
01006                 <span class="comment">// correctly.  we also call it later if we're not at eol so</span>
01007                 <span class="comment">// that the remainder of the string can be updated correctly.</span>
01008                 <span class="comment">//</span>
01009 
01010                 <span class="keywordflow">if</span> (CookedReadData-&gt;Echo) {
01011                     NumToWrite=<span class="keyword">sizeof</span>(WCHAR);
01012                     *<a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d0/d7/server_2stream_8c.html#a38">WriteCharsFromInput</a>(CookedReadData-&gt;ScreenInfo,
01013                              CookedReadData-&gt;BackupLimit,
01014                              CookedReadData-&gt;BufPtr,
01015                              &amp;Char,
01016                              &amp;NumToWrite,
01017                              NULL,
01018                              CookedReadData-&gt;OriginalCursorPosition.X,
01019                              WC_DESTRUCTIVE_BACKSPACE |
01020                                      WC_KEEP_CURSOR_VISIBLE | WC_ECHO,
01021                              NULL);
01022 
01023                     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(*Status)) {
01024                         RIPMSG1(RIP_WARNING, <span class="stringliteral">"WriteCharsFromInput failed %x"</span>, *Status);
01025                     }
01026                 }
01027                 CookedReadData-&gt;BytesRead -= <span class="keyword">sizeof</span>(WCHAR);
01028                 CookedReadData-&gt;BufPtr-=1;
01029                 CookedReadData-&gt;CurrentPosition-=1;
01030                 RtlCopyMemory(CookedReadData-&gt;BufPtr,
01031                        CookedReadData-&gt;BufPtr+1,
01032                        CookedReadData-&gt;BytesRead - (CookedReadData-&gt;CurrentPosition * <span class="keyword">sizeof</span>(WCHAR))
01033                       );
01034 <span class="preprocessor">#if defined(FE_SB)</span>
01035 <span class="preprocessor"></span>                {
01036                     PWCHAR buf = (PWCHAR)((<a class="code" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a>)CookedReadData-&gt;BackupLimit +
01037                                                  CookedReadData-&gt;BytesRead    );
01038                     *buf = (WCHAR)<span class="charliteral">' '</span>;
01039                 }
01040 <span class="preprocessor">#endif</span>
01041 <span class="preprocessor"></span>                NumSpaces = 0;
01042 
01043                 <span class="comment">// Repeat until it hits the word boundary</span>
01044                 <span class="keywordflow">if</span> (<a class="code" href="../../d6/d6/ntcon_2server_2globals_8h.html#a24">gExtendedEditKey</a> &amp;&amp;
01045                         wchOrig == EXTKEY_ERASE_PREV_WORD &amp;&amp;
01046                         CookedReadData-&gt;BufPtr != CookedReadData-&gt;BackupLimit &amp;&amp;
01047                         fStartFromDelim ^ !<a class="code" href="../../d4/d1/cmdline_8h.html#a23">IS_WORD_DELIM</a>(CookedReadData-&gt;BufPtr[-1])) {
01048                     <span class="keywordflow">goto</span> bs_repeat;
01049                 }
01050             } <span class="keywordflow">else</span> {
01051                  CallWrite = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01052             }
01053         } <span class="keywordflow">else</span> {
01054 
01055             <span class="comment">//</span>
01056             <span class="comment">// store the char</span>
01057             <span class="comment">//</span>
01058 
01059             <span class="keywordflow">if</span> (Char == <a class="code" href="../../d4/d5/conimep_8h.html#a53">UNICODE_CARRIAGERETURN</a>) {
01060                 CookedReadData-&gt;BufPtr = (PWCHAR)((<a class="code" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a>)CookedReadData-&gt;BackupLimit + CookedReadData-&gt;BytesRead);
01061                 *CookedReadData-&gt;BufPtr = Char;
01062                 CookedReadData-&gt;BufPtr+=1;
01063                 CookedReadData-&gt;BytesRead += <span class="keyword">sizeof</span>(WCHAR);
01064                 CookedReadData-&gt;CurrentPosition += 1;
01065             } <span class="keywordflow">else</span> {
01066 <span class="preprocessor">#if defined(FE_SB)</span>
01067 <span class="preprocessor"></span>                <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> fBisect = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01068                 <span class="keywordflow">if</span> (CookedReadData-&gt;Echo) {
01069                     <span class="keywordflow">if</span> (CheckBisectProcessW(CookedReadData-&gt;ScreenInfo,
01070                                             CookedReadData-&gt;ScreenInfo-&gt;Console-&gt;CP,
01071                                             CookedReadData-&gt;BackupLimit,
01072                                             CookedReadData-&gt;CurrentPosition+1,
01073                                             CookedReadData-&gt;ScreenInfo-&gt;ScreenBufferSize.X
01074                                              -CookedReadData-&gt;OriginalCursorPosition.X,
01075                                             CookedReadData-&gt;OriginalCursorPosition.X,
01076                                             TRUE)) {
01077                         fBisect = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01078                     }
01079                 }
01080 <span class="preprocessor">#endif</span>
01081 <span class="preprocessor"></span>                <span class="keywordflow">if</span> (<a class="code" href="../../d9/d3/input_8h.html#a13">INSERT_MODE</a>(CookedReadData)) {
01082                     memmove(CookedReadData-&gt;BufPtr+1,
01083                             CookedReadData-&gt;BufPtr,
01084                             CookedReadData-&gt;BytesRead - (CookedReadData-&gt;CurrentPosition * <span class="keyword">sizeof</span>(WCHAR))
01085                            );
01086                     CookedReadData-&gt;BytesRead += <span class="keyword">sizeof</span>(WCHAR);
01087                 }
01088                 *CookedReadData-&gt;BufPtr = Char;
01089                 CookedReadData-&gt;BufPtr+=1;
01090                 CookedReadData-&gt;CurrentPosition += 1;
01091 
01092                 <span class="comment">//</span>
01093                 <span class="comment">// calculate new cursor position</span>
01094                 <span class="comment">//</span>
01095 
01096                 <span class="keywordflow">if</span> (CookedReadData-&gt;Echo) {
01097                     NumSpaces = <a class="code" href="../../d0/d7/server_2stream_8c.html#a22">RetrieveNumberOfSpaces</a>(CookedReadData-&gt;OriginalCursorPosition.X,
01098                                                        CookedReadData-&gt;BackupLimit,
01099                                                        CookedReadData-&gt;CurrentPosition-1
01100 #<span class="keywordflow">if</span> defined(FE_SB)
01101                                                        ,
01102                                                        CookedReadData-&gt;ScreenInfo-&gt;Console,
01103                                                        CookedReadData-&gt;ScreenInfo-&gt;Console-&gt;CP
01104 #endif
01105                                                       );
01106 <span class="preprocessor">#if defined(FE_SB)</span>
01107 <span class="preprocessor"></span>                    <span class="keywordflow">if</span> (NumSpaces &gt; 0 &amp;&amp; fBisect)
01108                         NumSpaces--;
01109 <span class="preprocessor">#endif</span>
01110 <span class="preprocessor"></span>                }
01111             }
01112         }
01113 
01114         <span class="keywordflow">if</span> (CookedReadData-&gt;Echo &amp;&amp; CallWrite) {
01115 
01116             COORD CursorPosition;
01117 
01118             <span class="comment">//</span>
01119             <span class="comment">// save cursor position</span>
01120             <span class="comment">//</span>
01121 
01122             CursorPosition = CookedReadData-&gt;ScreenInfo-&gt;BufferInfo.TextInfo.CursorPosition;
01123             CursorPosition.X = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a>)(CursorPosition.X+NumSpaces);
01124 
01125             <span class="comment">//</span>
01126             <span class="comment">// clear the current command line from the screen</span>
01127             <span class="comment">//</span>
01128 
01129             <a class="code" href="../../d4/d1/cmdline_8h.html#a41">DeleteCommandLine</a>(CookedReadData,
01130                               FALSE);
01131 
01132             <span class="comment">//</span>
01133             <span class="comment">// write the new command line to the screen</span>
01134             <span class="comment">//</span>
01135 
01136             NumToWrite = CookedReadData-&gt;BytesRead;
01137             *<a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d0/d7/server_2stream_8c.html#a38">WriteCharsFromInput</a>(CookedReadData-&gt;ScreenInfo,
01138                                 CookedReadData-&gt;BackupLimit,
01139                                 CookedReadData-&gt;BackupLimit,
01140                                 CookedReadData-&gt;BackupLimit,
01141                                 &amp;NumToWrite,
01142                                 (PLONG)&amp;CookedReadData-&gt;NumberOfVisibleChars,
01143                                 CookedReadData-&gt;OriginalCursorPosition.X,
01144                                 (Char != UNICODE_CARRIAGERETURN) ?
01145                                      WC_DESTRUCTIVE_BACKSPACE | WC_ECHO :
01146                                      WC_DESTRUCTIVE_BACKSPACE | WC_KEEP_CURSOR_VISIBLE | WC_ECHO,
01147                                 &amp;ScrollY
01148                                 );
01149             <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(*Status)) {
01150                 RIPMSG1(RIP_WARNING, <span class="stringliteral">"WriteCharsFromInput failed %x"</span>, *Status);
01151                 CookedReadData-&gt;BytesRead = 0;
01152                 <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01153             }
01154 
01155             <span class="comment">//</span>
01156             <span class="comment">// update cursor position</span>
01157             <span class="comment">//</span>
01158 
01159             <span class="keywordflow">if</span> (Char != <a class="code" href="../../d4/d5/conimep_8h.html#a53">UNICODE_CARRIAGERETURN</a>) {
01160 <span class="preprocessor">#if defined(FE_SB)</span>
01161 <span class="preprocessor"></span>                <span class="keywordflow">if</span> (CheckBisectProcessW(CookedReadData-&gt;ScreenInfo,
01162                                         CookedReadData-&gt;ScreenInfo-&gt;Console-&gt;CP,
01163                                         CookedReadData-&gt;BackupLimit,
01164                                         CookedReadData-&gt;CurrentPosition+1,
01165                                         CookedReadData-&gt;ScreenInfo-&gt;ScreenBufferSize.X
01166                                          -CookedReadData-&gt;OriginalCursorPosition.X,
01167                                         CookedReadData-&gt;OriginalCursorPosition.X,
01168                                         TRUE)) {
01169                     <span class="keywordflow">if</span> (CursorPosition.X == (CookedReadData-&gt;ScreenInfo-&gt;ScreenBufferSize.X-1))
01170                         CursorPosition.X++;
01171                 }
01172 <span class="preprocessor">#endif</span>
01173 <span class="preprocessor"></span>
01174                 <span class="comment">// adjust cursor position for WriteChars</span>
01175                 CookedReadData-&gt;OriginalCursorPosition.Y += ScrollY;
01176                 CursorPosition.Y += ScrollY;
01177                 *<a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d6/d8/dispatch_8h.html#a10">AdjustCursorPosition</a>(CookedReadData-&gt;ScreenInfo,
01178                                               CursorPosition,
01179                                               TRUE,
01180                                               NULL);
01181                 <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(*Status));
01182                 <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(*Status)) {
01183                     CookedReadData-&gt;BytesRead = 0;
01184                     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01185                 }
01186             }
01187         }
01188     }
01189 
01190     <span class="comment">//</span>
01191     <span class="comment">// in cooked mode, enter (carriage return) is converted to</span>
01192     <span class="comment">// carriage return linefeed (0xda).  carriage return is always</span>
01193     <span class="comment">// stored at the end of the buffer.</span>
01194     <span class="comment">//</span>
01195 
01196     <span class="keywordflow">if</span> (Char == <a class="code" href="../../d4/d5/conimep_8h.html#a53">UNICODE_CARRIAGERETURN</a>) {
01197         <span class="keywordflow">if</span> (CookedReadData-&gt;Processed) {
01198             <span class="keywordflow">if</span> (CookedReadData-&gt;BytesRead &lt; CookedReadData-&gt;BufferSize) {
01199                 *CookedReadData-&gt;BufPtr = <a class="code" href="../../d4/d5/conimep_8h.html#a54">UNICODE_LINEFEED</a>;
01200                 <span class="keywordflow">if</span> (CookedReadData-&gt;Echo) {
01201                     NumToWrite=<span class="keyword">sizeof</span>(WCHAR);
01202                     *<a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d0/d7/server_2stream_8c.html#a38">WriteCharsFromInput</a>(CookedReadData-&gt;ScreenInfo,
01203                              CookedReadData-&gt;BackupLimit,
01204                              CookedReadData-&gt;BufPtr,
01205                              CookedReadData-&gt;BufPtr,
01206                              &amp;NumToWrite,
01207                              NULL,
01208                              CookedReadData-&gt;OriginalCursorPosition.X,
01209                              WC_DESTRUCTIVE_BACKSPACE |
01210                                      WC_KEEP_CURSOR_VISIBLE | WC_ECHO,
01211                              NULL);
01212 
01213                     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(*Status)) {
01214                         RIPMSG1(RIP_WARNING, <span class="stringliteral">"WriteCharsFromInput failed %x"</span>, *Status);
01215                     }
01216                 }
01217                 CookedReadData-&gt;BytesRead += <span class="keyword">sizeof</span>(WCHAR);
01218                 CookedReadData-&gt;BufPtr++;
01219                 CookedReadData-&gt;CurrentPosition += 1;
01220             }
01221         }
01222         <span class="comment">//</span>
01223         <span class="comment">// reset the cursor back to 25% if necessary</span>
01224         <span class="comment">//</span>
01225         <span class="keywordflow">if</span> (CookedReadData-&gt;Line) {
01226             <span class="keywordflow">if</span> (CookedReadData-&gt;InsertMode != CookedReadData-&gt;Console-&gt;InsertMode) {
01227                 <a class="code" href="../../d4/d1/cmdline_8h.html#a40">ProcessCommandLine</a>(CookedReadData,VK_INSERT,0,NULL,NULL,FALSE); <span class="comment">// make cursor small</span>
01228             }
01229             *<a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = STATUS_SUCCESS;
01230             <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01231         }
01232     }
01233     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01234 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a59" doxytag="cmdline.h::ReadRectFromScreenBuffer" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID ReadRectFromScreenBuffer           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d7/d8/struct__SCREEN__INFORMATION.html">PSCREEN_INFORMATION</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>ScreenInfo</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN COORD&nbsp;</td>
          <td class="mdname" nowrap> <em>SourcePoint</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PCHAR_INFO&nbsp;</td>
          <td class="mdname" nowrap> <em>Target</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN COORD&nbsp;</td>
          <td class="mdname" nowrap> <em>TargetSize</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PSMALL_RECT&nbsp;</td>
          <td class="mdname" nowrap> <em>TargetRect</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d1/output_8c-source.html#l01415">1415</a> of file <a class="el" href="../../d7/d1/output_8c-source.html">output.c</a>.
<p>
<pre class="fragment"><div>01425                    :
01426 
01427     This routine copies a rectangular region from <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> screen buffer.
01428     no clipping <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> done.
01429 
01430 Arguments:
01431 
01432     ScreenInfo - pointer to screen info
01433 
01434     SourcePoint - upper left coordinates of source rectangle
01435 
01436     Target - pointer to target buffer
01437 
01438     TargetSize - dimensions of target buffer
01439 
01440     TargetRect - rectangle in source buffer to copy
01441 
01442 Return Value:
01443 
01444     none.
01445 
01446 --*/
01447 
01448 {
01449 
01450     PCHAR_INFO TargetPtr;
01451     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a> i,j,k;
01452     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a> XSize,YSize;
01453     BOOLEAN WholeTarget;
01454     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a> RowIndex;
01455     <a class="code" href="../../d9/d4/struct__ROW.html">PROW</a> Row;
01456     PWCHAR Char;
01457     <a class="code" href="../../d3/d2/struct__ATTR__PAIR.html">PATTR_PAIR</a> Attr;
01458     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a> CountOfAttr;
01459 
01460     <a class="code" href="../../d8/d5/consrv_8h.html#a3">DBGOUTPUT</a>((<span class="stringliteral">"ReadRectFromScreenBuffer\n"</span>));
01461 
01462     XSize = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a>)(TargetRect-&gt;Right - TargetRect-&gt;Left + 1);
01463     YSize = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a>)(TargetRect-&gt;Bottom - TargetRect-&gt;Top + 1);
01464 
01465     TargetPtr = Target;
01466     WholeTarget = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01467     <span class="keywordflow">if</span> (XSize == TargetSize.X) {
01468         <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a> (TargetRect-&gt;Left == 0);
01469         <span class="keywordflow">if</span> (TargetRect-&gt;Top != 0) {
01470             TargetPtr = (PCHAR_INFO)
01471                 ((<a class="code" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a>)Target + <a class="code" href="../../d3/d6/iostubs_8c.html#a0">SCREEN_BUFFER_POINTER</a>(TargetRect-&gt;Left,
01472                                                        TargetRect-&gt;Top,
01473                                                        TargetSize.X,
01474                                                        <span class="keyword">sizeof</span>(CHAR_INFO)));
01475         }
01476         WholeTarget = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01477     }
01478     RowIndex = (ScreenInfo-&gt;BufferInfo.TextInfo.FirstRow+SourcePoint.Y) % ScreenInfo-&gt;ScreenBufferSize.Y;
01479     <span class="keywordflow">for</span> (i=0;i&lt;YSize;i++) {
01480         <span class="keywordflow">if</span> (!WholeTarget) {
01481             TargetPtr = (PCHAR_INFO)
01482                 ((<a class="code" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a>)Target + <a class="code" href="../../d3/d6/iostubs_8c.html#a0">SCREEN_BUFFER_POINTER</a>(TargetRect-&gt;Left,
01483                                                        TargetRect-&gt;Top+i,
01484                                                        TargetSize.X,
01485                                                        <span class="keyword">sizeof</span>(CHAR_INFO)));
01486         }
01487 
01488         <span class="comment">//</span>
01489         <span class="comment">// copy the chars and attrs from their respective arrays</span>
01490         <span class="comment">//</span>
01491 
01492         Row = &amp;ScreenInfo-&gt;BufferInfo.TextInfo.Rows[RowIndex];
01493         Char = &amp;Row-&gt;<a class="code" href="../../d9/d4/struct__ROW.html#o0">CharRow</a>.<a class="code" href="../../d6/d9/struct__CHAR__ROW.html#o4">Chars</a>[SourcePoint.X];
01494         <a class="code" href="../../d6/d2/output_8c.html#a47">FindAttrIndex</a>(Row-&gt;<a class="code" href="../../d9/d4/struct__ROW.html#o1">AttrRow</a>.<a class="code" href="../../d4/d2/struct__ATTR__ROW.html#o2">Attrs</a>,
01495                       SourcePoint.X,
01496                       &amp;Attr,
01497                       &amp;CountOfAttr
01498                      );
01499         k=0;
01500 <span class="preprocessor">#if defined(FE_SB)</span>
01501 <span class="preprocessor"></span>        <span class="keywordflow">if</span> (CONSOLE_IS_DBCS_OUTPUTCP(ScreenInfo-&gt;Console)) {
01502             <a class="code" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a> AttrP = &amp;Row-&gt;<a class="code" href="../../d9/d4/struct__ROW.html#o0">CharRow</a>.KAttrs[SourcePoint.X];
01503             <span class="keywordflow">for</span> (j=0;j&lt;XSize;TargetPtr++) {
01504                 <a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a> AttrR;
01505                 AttrR = *AttrP++;
01506                 <span class="keywordflow">if</span> (j==0 &amp;&amp; AttrR &amp; ATTR_TRAILING_BYTE)
01507                 {
01508                     TargetPtr-&gt;Char.UnicodeChar = <a class="code" href="../../d9/d5/verifier_8c.html#a6">UNICODE_SPACE</a>;
01509                     AttrR = 0;
01510                 }
01511                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> (j+1 &gt;= XSize &amp;&amp; AttrR &amp; ATTR_LEADING_BYTE)
01512                 {
01513                     TargetPtr-&gt;Char.UnicodeChar = <a class="code" href="../../d9/d5/verifier_8c.html#a6">UNICODE_SPACE</a>;
01514                     AttrR = 0;
01515                 }
01516                 <span class="keywordflow">else</span>
01517                     TargetPtr-&gt;Char.UnicodeChar = *Char;
01518                 Char++;
01519                 TargetPtr-&gt;Attributes = Attr-&gt;<a class="code" href="../../d3/d2/struct__ATTR__PAIR.html#o1">Attr</a> | (WCHAR)(AttrR &amp; ATTR_DBCSSBCS_BYTE) &lt;&lt; 8;
01520                 j+=1;
01521                 <span class="keywordflow">if</span> (++k==CountOfAttr &amp;&amp; j&lt;XSize) {
01522                     Attr++;
01523                     k=0;
01524                     CountOfAttr = Attr-&gt;<a class="code" href="../../d3/d2/struct__ATTR__PAIR.html#o0">Length</a>;
01525                 }
01526             }
01527         }
01528         <span class="keywordflow">else</span>{
01529 <span class="preprocessor">#endif</span>
01530 <span class="preprocessor"></span>        <span class="keywordflow">for</span> (j=0;j&lt;XSize;TargetPtr++) {
01531             TargetPtr-&gt;Char.UnicodeChar = *Char++;
01532             TargetPtr-&gt;Attributes = Attr-&gt;<a class="code" href="../../d3/d2/struct__ATTR__PAIR.html#o1">Attr</a>;
01533             j+=1;
01534             <span class="keywordflow">if</span> (++k==CountOfAttr &amp;&amp; j&lt;XSize) {
01535                 Attr++;
01536                 k=0;
01537                 CountOfAttr = Attr-&gt;<a class="code" href="../../d3/d2/struct__ATTR__PAIR.html#o0">Length</a>;
01538             }
01539         }
01540 <span class="preprocessor">#if defined(FE_SB)</span>
01541 <span class="preprocessor"></span>        }
01542 <span class="preprocessor">#endif</span>
01543 <span class="preprocessor"></span>
01544         <span class="keywordflow">if</span> (++RowIndex == ScreenInfo-&gt;ScreenBufferSize.Y) {
01545             RowIndex = 0;
01546         }
01547     }
01548 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a44" doxytag="cmdline.h::ReallocCommandHistory" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d9/d7/struct__COMMAND__HISTORY.html">PCOMMAND_HISTORY</a> ReallocCommandHistory           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d1/d3/struct__CONSOLE__INFORMATION.html">PCONSOLE_INFORMATION</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Console</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d9/d7/struct__COMMAND__HISTORY.html">PCOMMAND_HISTORY</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>CurrentCommandHistory</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>NumCommands</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l01597">1597</a> of file <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html">server/cmdline.c</a>.
<p>
References <a class="el" href="../../d5/d0/cmdline_8h-source.html#l00066">CLE_RESET</a>, <a class="el" href="../../d4/d1/cmdline_8h.html#a30">COMMAND_HISTORY</a>, <a class="el" href="../../d5/d0/cmdline_8h-source.html#l00112">COMMAND_NUM_TO_INDEX</a>, <a class="el" href="../../d9/d4/consrv_8h-source.html#l00180">ConsoleHeapAlloc</a>, <a class="el" href="../../d9/d4/consrv_8h-source.html#l00193">ConsoleHeapFree</a>, <a class="el" href="../../d2/d8/icmui_8def-source.html#l00012">History</a>, <a class="el" href="../../d9/d4/consrv_8h-source.html#l00065">HISTORY_TAG</a>, <a class="el" href="../../d0/d2/ldrp_8h-source.html#l00457">MAKE_TAG</a>, <a class="el" href="../../d6/d3/acpitabl_8h-source.html#l00366">min</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, and <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00062">SHORT</a>.
<p>
Referenced by <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l04665">ResizeCommandHistoryBuffers()</a>, and <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l01424">SrvSetConsoleNumberOfCommands()</a>.
<p>
<pre class="fragment"><div>01602 {
01603     <a class="code" href="../../d9/d7/struct__COMMAND__HISTORY.html">PCOMMAND_HISTORY</a> <a class="code" href="../../d1/d9/icmui_8def.html#a3">History</a>;
01604     <span class="keywordtype">int</span> i;
01605 
01606     <span class="keywordflow">if</span> (CurrentCommandHistory == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> ||
01607         CurrentCommandHistory-&gt;MaximumNumberOfCommands==(<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a>)NumCommands) {
01608         <span class="keywordflow">return</span> CurrentCommandHistory;
01609     }
01610     <a class="code" href="../../d1/d9/icmui_8def.html#a3">History</a> = (<a class="code" href="../../d9/d7/struct__COMMAND__HISTORY.html">PCOMMAND_HISTORY</a>)<a class="code" href="../../d8/d5/consrv_8h.html#a36">ConsoleHeapAlloc</a>(<a class="code" href="../../d9/d2/ldrp_8h.html#a11">MAKE_TAG</a>( HISTORY_TAG ),<span class="keyword">sizeof</span>(<a class="code" href="../../d9/d7/struct__COMMAND__HISTORY.html">COMMAND_HISTORY</a>) + ((NumCommands-1) * <span class="keyword">sizeof</span>(<a class="code" href="../../d8/d7/struct__COMMAND.html">PCOMMAND</a>)));
01611     <span class="keywordflow">if</span> (<a class="code" href="../../d1/d9/icmui_8def.html#a3">History</a> == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01612         <span class="keywordflow">return</span> CurrentCommandHistory;
01613     }
01614     *<a class="code" href="../../d1/d9/icmui_8def.html#a3">History</a>=*CurrentCommandHistory;
01615     <a class="code" href="../../d1/d9/icmui_8def.html#a3">History</a>-&gt;Flags |= <a class="code" href="../../d4/d1/cmdline_8h.html#a5">CLE_RESET</a>;
01616     <a class="code" href="../../d1/d9/icmui_8def.html#a3">History</a>-&gt;NumberOfCommands = <a class="code" href="../../d5/d4/acpitabl_8h.html#a69">min</a>(<a class="code" href="../../d1/d9/icmui_8def.html#a3">History</a>-&gt;NumberOfCommands, (SHORT)NumCommands);
01617     <a class="code" href="../../d1/d9/icmui_8def.html#a3">History</a>-&gt;LastAdded = <a class="code" href="../../d1/d9/icmui_8def.html#a3">History</a>-&gt;NumberOfCommands - 1;
01618     <a class="code" href="../../d1/d9/icmui_8def.html#a3">History</a>-&gt;LastDisplayed = <a class="code" href="../../d1/d9/icmui_8def.html#a3">History</a>-&gt;NumberOfCommands - 1;
01619     <a class="code" href="../../d1/d9/icmui_8def.html#a3">History</a>-&gt;FirstCommand = 0;
01620     <a class="code" href="../../d1/d9/icmui_8def.html#a3">History</a>-&gt;MaximumNumberOfCommands=(<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a>)NumCommands;
01621     <span class="keywordflow">for</span> (i=0; i&lt;<a class="code" href="../../d1/d9/icmui_8def.html#a3">History</a>-&gt;NumberOfCommands; i++) {
01622         <a class="code" href="../../d1/d9/icmui_8def.html#a3">History</a>-&gt;Commands[i] = CurrentCommandHistory-&gt;Commands[<a class="code" href="../../d4/d1/cmdline_8h.html#a8">COMMAND_NUM_TO_INDEX</a>(i,CurrentCommandHistory)];
01623     }
01624     <span class="keywordflow">for</span> (; i&lt;CurrentCommandHistory-&gt;NumberOfCommands; i++) {
01625         <a class="code" href="../../d8/d5/consrv_8h.html#a38">ConsoleHeapFree</a>(CurrentCommandHistory-&gt;Commands[<a class="code" href="../../d4/d1/cmdline_8h.html#a8">COMMAND_NUM_TO_INDEX</a>(i,CurrentCommandHistory)]);
01626     }
01627 
01628     RemoveEntryList(&amp;CurrentCommandHistory-&gt;ListLink);
01629     InitializeListHead(&amp;<a class="code" href="../../d1/d9/icmui_8def.html#a3">History</a>-&gt;PopupList);
01630     InsertHeadList(&amp;Console-&gt;CommandHistoryList,&amp;<a class="code" href="../../d1/d9/icmui_8def.html#a3">History</a>-&gt;ListLink);
01631 
01632     <a class="code" href="../../d8/d5/consrv_8h.html#a38">ConsoleHeapFree</a>(CurrentCommandHistory);
01633     <span class="keywordflow">return</span> <a class="code" href="../../d1/d9/icmui_8def.html#a3">History</a>;
01634 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a42" doxytag="cmdline.h::RedrawCommandLine" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID RedrawCommandLine           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d2/d8/struct__COOKED__READ__DATA.html">PCOOKED_READ_DATA</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>CookedReadData</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d2/d6/ntcon_2server_2menu_8c-source.html#l00459">PropertiesUpdate()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a47" doxytag="cmdline.h::RetrieveNumberOfSpaces" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG RetrieveNumberOfSpaces           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a13">SHORT</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>OriginalCursorPositionX</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PWCHAR&nbsp;</td>
          <td class="mdname" nowrap> <em>Buffer</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>CurrentPosition</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d6/server_2stream_8c-source.html#l00818">818</a> of file <a class="el" href="../../d1/d6/server_2stream_8c-source.html">server/stream.c</a>.
<p>
References <a class="el" href="../../d7/d1/rtqkey_8c-source.html#l00042">Buffer</a>, <a class="el" href="../../d1/d6/server_2stream_8c-source.html#l00024">IS_CONTROL_CHAR</a>, <a class="el" href="../../d0/d3/input_8h-source.html#l00092">NUMBER_OF_SPACES_IN_TAB</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00062">SHORT</a>, and <a class="el" href="../../d0/d5/verifier_8c-source.html#l03108">UNICODE_TAB</a>.
<p>
Referenced by <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l03272">ProcessCommandLine()</a>, <a class="el" href="../../d1/d6/server_2stream_8c-source.html#l00876">ProcessCookedReadInput()</a>, and <a class="el" href="../../d1/d2/__stream_8h-source.html#l00203">WWSB_WriteChars()</a>.
<p>
<pre class="fragment"><div>00836 {
00837     WCHAR Char;
00838     ULONG i,NumSpaces;
00839     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a> XPosition;
00840 
00841     Char = <a class="code" href="../../d6/d2/rtqkey_8c.html#a3">Buffer</a>[CurrentPosition];
00842     <span class="keywordflow">if</span> (Char == <a class="code" href="../../d9/d5/verifier_8c.html#a3">UNICODE_TAB</a>) {
00843         NumSpaces=0;
00844         XPosition=OriginalCursorPositionX;
00845         <span class="keywordflow">for</span> (i=0;i&lt;=CurrentPosition;i++) {
00846             Char = <a class="code" href="../../d6/d2/rtqkey_8c.html#a3">Buffer</a>[i];
00847             <span class="keywordflow">if</span> (Char == <a class="code" href="../../d9/d5/verifier_8c.html#a3">UNICODE_TAB</a>) {
00848                 NumSpaces = <a class="code" href="../../d9/d3/input_8h.html#a11">NUMBER_OF_SPACES_IN_TAB</a>(XPosition);
00849             } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d0/d7/server_2stream_8c.html#a0">IS_CONTROL_CHAR</a>(Char)) {
00850                 NumSpaces = 2;
00851 <span class="preprocessor">#if defined(FE_SB)</span>
00852 <span class="preprocessor"></span>            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (IsConsoleFullWidth(Console-&gt;hDC,CodePage,Char)) {
00853                 NumSpaces = 2;
00854 <span class="preprocessor">#endif</span>
00855 <span class="preprocessor"></span>            } <span class="keywordflow">else</span> {
00856                 NumSpaces = 1;
00857             }
00858             XPosition = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a>)(XPosition+NumSpaces);
00859         }
00860         <span class="keywordflow">return</span> NumSpaces;
00861     }
00862     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d0/d7/server_2stream_8c.html#a0">IS_CONTROL_CHAR</a>(Char)) {
00863         <span class="keywordflow">return</span> 2;
00864     }
00865 <span class="preprocessor">#if defined(FE_SB)</span>
00866 <span class="preprocessor"></span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (IsConsoleFullWidth(Console-&gt;hDC,CodePage,Char)) {
00867         <span class="keywordflow">return</span> 2;
00868     }
00869 <span class="preprocessor">#endif</span>
00870 <span class="preprocessor"></span>    <span class="keywordflow">else</span> {
00871         <span class="keywordflow">return</span> 1;
00872     }
00873 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a48" doxytag="cmdline.h::RetrieveTotalNumberOfSpaces" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG RetrieveTotalNumberOfSpaces           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a13">SHORT</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>OriginalCursorPositionX</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PWCHAR&nbsp;</td>
          <td class="mdname" nowrap> <em>Buffer</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>CurrentPosition</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d6/server_2stream_8c-source.html#l00774">774</a> of file <a class="el" href="../../d1/d6/server_2stream_8c-source.html">server/stream.c</a>.
<p>
References <a class="el" href="../../d7/d1/rtqkey_8c-source.html#l00042">Buffer</a>, <a class="el" href="../../d1/d6/server_2stream_8c-source.html#l00024">IS_CONTROL_CHAR</a>, <a class="el" href="../../d0/d3/input_8h-source.html#l00092">NUMBER_OF_SPACES_IN_TAB</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00062">SHORT</a>, and <a class="el" href="../../d0/d5/verifier_8c-source.html#l03108">UNICODE_TAB</a>.
<p>
Referenced by <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l03272">ProcessCommandLine()</a>, and <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l02061">RedrawCommandLine()</a>.
<p>
<pre class="fragment"><div>00791 {
00792     WCHAR Char;
00793     ULONG i,NumSpacesForChar,NumSpaces;
00794     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a> XPosition;
00795 
00796     XPosition=OriginalCursorPositionX;
00797     NumSpaces=0;
00798     <span class="keywordflow">for</span> (i=0;i&lt;CurrentPosition;i++) {
00799         Char = <a class="code" href="../../d6/d2/rtqkey_8c.html#a3">Buffer</a>[i];
00800         <span class="keywordflow">if</span> (Char == <a class="code" href="../../d9/d5/verifier_8c.html#a3">UNICODE_TAB</a>) {
00801             NumSpacesForChar = <a class="code" href="../../d9/d3/input_8h.html#a11">NUMBER_OF_SPACES_IN_TAB</a>(XPosition);
00802         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d0/d7/server_2stream_8c.html#a0">IS_CONTROL_CHAR</a>(Char)) {
00803             NumSpacesForChar = 2;
00804 <span class="preprocessor">#if defined(FE_SB)</span>
00805 <span class="preprocessor"></span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (IsConsoleFullWidth(Console-&gt;hDC,Console-&gt;CP,Char)) {
00806             NumSpacesForChar = 2;
00807 <span class="preprocessor">#endif</span>
00808 <span class="preprocessor"></span>        } <span class="keywordflow">else</span> {
00809             NumSpacesForChar = 1;
00810         }
00811         XPosition = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a>)(XPosition+NumSpacesForChar);
00812         NumSpaces += NumSpacesForChar;
00813     }
00814     <span class="keywordflow">return</span> NumSpaces;
00815 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a62" doxytag="cmdline.h::UpdateCommandListPopup" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID UpdateCommandListPopup           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a13">SHORT</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Delta</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN OUT <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a21">PSHORT</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>CurrentCommand</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d9/d7/struct__COMMAND__HISTORY.html">PCOMMAND_HISTORY</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>CommandHistory</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d1/d0/struct__CLE__POPUP.html">PCLE_POPUP</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Popup</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d7/d8/struct__SCREEN__INFORMATION.html">PSCREEN_INFORMATION</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>ScreenInfo</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Flags</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l04500">4500</a> of file <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html">server/cmdline.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d5/d0/cmdline_8h-source.html#l00113">COMMAND_INDEX_TO_NUM</a>, <a class="el" href="../../d5/d0/cmdline_8h-source.html#l00112">COMMAND_NUM_TO_INDEX</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l04346">DrawCommandListPopup()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d5/d0/cmdline_8h-source.html#l00058">POPUP_SIZE_Y</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00062">SHORT</a>, <a class="el" href="../../d9/d6/lh__open_2pi__mem_8h-source.html#l00017">Size</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d5/d0/cmdline_8h-source.html#l00378">UCLP_WRAP</a>, and <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l04301">UpdateHighlight()</a>.
<p>
Referenced by <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l02287">ProcessCommandListInput()</a>.
<p>
<pre class="fragment"><div>04508 {
04509     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a> <a class="code" href="../../d8/d7/lh__open_2pi__mem_8h.html#a0">Size</a>;
04510     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a> CurCmdNum;
04511     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a> NewCmdNum;
04512     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> Scroll=<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
04513 
04514     <span class="keywordflow">if</span> (Delta == 0) {
04515         <span class="keywordflow">return</span>;
04516     }
04517     <a class="code" href="../../d8/d7/lh__open_2pi__mem_8h.html#a0">Size</a> = <a class="code" href="../../d4/d1/cmdline_8h.html#a2">POPUP_SIZE_Y</a>(Popup);
04518 
04519     <span class="keywordflow">if</span> (Flags &amp; <a class="code" href="../../d4/d1/cmdline_8h.html#a22">UCLP_WRAP</a>) {
04520         CurCmdNum = *CurrentCommand;
04521         NewCmdNum = CurCmdNum + Delta;
04522         NewCmdNum = <a class="code" href="../../d4/d1/cmdline_8h.html#a9">COMMAND_INDEX_TO_NUM</a>(NewCmdNum, CommandHistory);
04523         CurCmdNum = <a class="code" href="../../d4/d1/cmdline_8h.html#a9">COMMAND_INDEX_TO_NUM</a>(CurCmdNum, CommandHistory);
04524     } <span class="keywordflow">else</span> {
04525         CurCmdNum = <a class="code" href="../../d4/d1/cmdline_8h.html#a9">COMMAND_INDEX_TO_NUM</a>(*CurrentCommand, CommandHistory);
04526         NewCmdNum = CurCmdNum + Delta;
04527         <span class="keywordflow">if</span> (NewCmdNum &gt;= CommandHistory-&gt;NumberOfCommands) {
04528             NewCmdNum = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a>)(CommandHistory-&gt;NumberOfCommands-1);
04529         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (NewCmdNum &lt; 0) {
04530             NewCmdNum = 0;
04531         }
04532     }
04533     Delta = NewCmdNum - CurCmdNum;
04534 
04535     <span class="comment">// determine amount to scroll, if any</span>
04536 
04537     <span class="keywordflow">if</span> (NewCmdNum &lt;= Popup-&gt;BottomIndex-<a class="code" href="../../d8/d7/lh__open_2pi__mem_8h.html#a0">Size</a>) {
04538         Popup-&gt;BottomIndex += Delta;
04539         <span class="keywordflow">if</span> (Popup-&gt;BottomIndex &lt; (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a>)(<a class="code" href="../../d8/d7/lh__open_2pi__mem_8h.html#a0">Size</a>-1)) {
04540             Popup-&gt;BottomIndex = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a>)(<a class="code" href="../../d8/d7/lh__open_2pi__mem_8h.html#a0">Size</a>-1);
04541         }
04542         Scroll = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
04543     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (NewCmdNum &gt; Popup-&gt;BottomIndex) {
04544         Popup-&gt;BottomIndex += Delta;
04545         <span class="keywordflow">if</span> (Popup-&gt;BottomIndex &gt;= CommandHistory-&gt;NumberOfCommands) {
04546             Popup-&gt;BottomIndex = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a>)(CommandHistory-&gt;NumberOfCommands-1);
04547         }
04548         Scroll = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
04549     }
04550 
04551 
04552     <span class="comment">//</span>
04553     <span class="comment">// write commands to popup</span>
04554     <span class="comment">//</span>
04555     <span class="keywordflow">if</span> (Scroll) {
04556         <a class="code" href="../../d4/d1/cmdline_8h.html#a61">DrawCommandListPopup</a>(Popup,<a class="code" href="../../d4/d1/cmdline_8h.html#a8">COMMAND_NUM_TO_INDEX</a>(NewCmdNum,CommandHistory),CommandHistory,ScreenInfo);
04557     } <span class="keywordflow">else</span> {
04558         <a class="code" href="../../d3/d1/server_2cmdline_8c.html#a71">UpdateHighlight</a>(Popup,<a class="code" href="../../d4/d1/cmdline_8h.html#a9">COMMAND_INDEX_TO_NUM</a>((*CurrentCommand),CommandHistory),NewCmdNum,ScreenInfo);
04559     }
04560     *CurrentCommand = <a class="code" href="../../d4/d1/cmdline_8h.html#a8">COMMAND_NUM_TO_INDEX</a>(NewCmdNum,CommandHistory);
04561 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a60" doxytag="cmdline.h::WriteCharsFromInput" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS WriteCharsFromInput           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d7/d8/struct__SCREEN__INFORMATION.html">PSCREEN_INFORMATION</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>ScreenInfo</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PWCHAR&nbsp;</td>
          <td class="mdname" nowrap> <em>lpBufferBackupLimit</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PWCHAR&nbsp;</td>
          <td class="mdname" nowrap> <em>lpBuffer</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PWCHAR&nbsp;</td>
          <td class="mdname" nowrap> <em>lpString</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN OUT PDWORD&nbsp;</td>
          <td class="mdname" nowrap> <em>NumBytes</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT PLONG NumSpaces&nbsp;</td>
          <td class="mdname" nowrap> <em>OPTIONAL</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a13">SHORT</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>OriginalXPosition</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>dwFlags</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a21">PSHORT</a> ScrollY&nbsp;</td>
          <td class="mdname" nowrap> <em>OPTIONAL</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d6/server_2stream_8c-source.html#l03047">3047</a> of file <a class="el" href="../../d1/d6/server_2stream_8c-source.html">server/stream.c</a>.
<p>
References <a class="el" href="../../d8/d1/output_8h-source.html#l00149">CONSOLE_GRAPHICS_BUFFER</a>, <a class="el" href="../../d8/d1/output_8h-source.html#l00150">CONSOLE_OEMFONT_DISPLAY</a>, <a class="el" href="../../d4/d7/propapi_8h-source.html#l00043">dwFlags</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d5/d0/cmdline_8h-source.html#l00356">WC_FALSIFY_UNICODE</a>, and <a class="el" href="../../d7/d7/dispatch_8h-source.html#l00101">WriteChars</a>.
<p>
Referenced by <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l03272">ProcessCommandLine()</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l02793">ProcessCommandNumberInput()</a>, <a class="el" href="../../d1/d6/server_2stream_8c-source.html#l00876">ProcessCookedReadInput()</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l02546">ProcessCopyFromCharInput()</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l02677">ProcessCopyToCharInput()</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l02061">RedrawCommandLine()</a>, and <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l02136">SetCurrentCommandLine()</a>.
<p>
<pre class="fragment"><div>03061                    :
03062 
03063     This routine converts chars from their <span class="keyword">true</span> unicode representation
03064     to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a96">Unicode</a> representation (UnicodeAnsi) that will generate
03065     the correct glyph given an OEM font and an ANSI translation by GDI.
03066     It then calls WriteChars.
03067 
03068 Arguments:
03069 
03070     ScreenInfo - Pointer to screen buffer information structure.
03071 
03072     lpBufferBackupLimit - Pointer to beginning of buffer.
03073 
03074     lpBuffer - Pointer to buffer to copy string to.  assumed to be at least
03075     as <span class="keywordtype">long</span> as lpString.  This pointer is updated to point to the next
03076     position in the buffer.
03077 
03078     lpString - Pointer to string to write.
03079 
03080     NumBytes - On input, number of bytes to write.  On output, number of
03081     bytes written.
03082 
03083     NumSpaces - On output, the number of spaces consumed by the written characters.
03084 
03085     dwFlags -
03086       WC_DESTRUCTIVE_BACKSPACE backspace overwrites characters.
03087       WC_KEEP_CURSOR_VISIBLE   change window origin desirable when hit rt. edge
03088       WC_ECHO                  if called by Read (echoing characters)
03089       WC_FALSIFY_UNICODE       if RealUnicodeToFalseUnicode need be called.
03090 
03091 Return Value:
03092 
03093 Note:
03094 
03095     This routine does not process tabs and backspace properly.  That code
03096     will be implemented as part of the line editing services.
03097 
03098 --*/
03099 
03100 {
03101     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> Length,i;
03102 
03103     <span class="keywordflow">if</span> (ScreenInfo-&gt;Flags &amp; <a class="code" href="../../d7/d2/output_8h.html#a1">CONSOLE_GRAPHICS_BUFFER</a>) {
03104         <span class="keywordflow">return</span> STATUS_UNSUCCESSFUL;
03105     }
03106 
03107     <span class="keywordflow">if</span> (!(ScreenInfo-&gt;Flags &amp; <a class="code" href="../../d7/d2/output_8h.html#a2">CONSOLE_OEMFONT_DISPLAY</a>) ||
03108             (ScreenInfo-&gt;Console-&gt;FullScreenFlags &amp; CONSOLE_FULLSCREEN)) {
03109         <span class="keywordflow">goto</span> SimpleWrite;
03110     }
03111 
03112     Length = *NumBytes / <span class="keyword">sizeof</span>(WCHAR);
03113     <span class="keywordflow">for</span> (i=0;i&lt;Length;i++) {
03114         <span class="keywordflow">if</span> (lpString[i] &gt; 0x7f) {
03115             <a class="code" href="../../d3/d8/propapi_8h.html#a34">dwFlags</a> |= <a class="code" href="../../d4/d1/cmdline_8h.html#a20">WC_FALSIFY_UNICODE</a>;
03116             <span class="keywordflow">break</span>;
03117         }
03118     }
03119 
03120 SimpleWrite:
03121     <span class="keywordflow">return</span> <a class="code" href="../../d6/d8/dispatch_8h.html#a9">WriteChars</a>(ScreenInfo,
03122                     lpBufferBackupLimit,
03123                     lpBuffer,
03124                     lpString,
03125                     NumBytes,
03126                     NumSpaces,
03127                     OriginalXPosition,
03128                     dwFlags,
03129                     ScrollY
03130                    );
03131 }

</div></pre>    </td>
  </tr>
</table>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="a38" doxytag="cmdline.h::gaWordDelimChars" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> WCHAR <a class="el" href="../../d4/d1/cmdline_8h.html#a38">gaWordDelimChars</a>[]          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d0/cmdline_8h-source.html#l00401">401</a> of file <a class="el" href="../../d5/d0/cmdline_8h-source.html">cmdline.h</a>.
<p>
Referenced by <a class="el" href="../../d1/d4/srvinit_8c-source.html#l02210">GetRegistryValues()</a>, and <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l00309">IsWordDelim()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a39" doxytag="cmdline.h::gaWordDelimCharsDefault" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> CONST WCHAR <a class="el" href="../../d4/d1/cmdline_8h.html#a39">gaWordDelimCharsDefault</a>[]          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d0/cmdline_8h-source.html#l00402">402</a> of file <a class="el" href="../../d5/d0/cmdline_8h-source.html">cmdline.h</a>.
<p>
Referenced by <a class="el" href="../../d1/d4/srvinit_8c-source.html#l02210">GetRegistryValues()</a>.    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:43:08 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
