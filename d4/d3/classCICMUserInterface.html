<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: CICMUserInterface class Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>CICMUserInterface Class Reference</h1><code>#include &lt;<a class="el" href="../../d0/d8/shellext_8h-source.html">shellext.h</a>&gt;</code>
<p>
<a href="../../d3/d4/classCICMUserInterface-members.html">List of all members.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d3/classCICMUserInterface.html#a0">CICMUserInterface</a> (<a class="el" href="../../d9/d8/shellext_8h.html#a8">UITYPE</a> utThis)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d3/classCICMUserInterface.html#a1">~CICMUserInterface</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>STDMETHODIMP&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d3/classCICMUserInterface.html#a2">QueryInterface</a> (REFIID, <a class="el" href="../../d0/d5/perfuser_8c.html#a5">LPVOID</a> FAR *)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d3/classCICMUserInterface.html#a3">STDMETHODIMP_</a> (ULONG) AddRef()</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d3/classCICMUserInterface.html#a4">STDMETHODIMP_</a> (ULONG) Release()</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>STDMETHODIMP&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d3/classCICMUserInterface.html#a5">QueryContextMenu</a> (HMENU hMenu, <a class="el" href="../../d9/d5/ndismain_8h.html#a265">UINT</a> indexMenu, UINT idCmdFirst, UINT idCmdLast, UINT uFlags)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>STDMETHODIMP&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d3/classCICMUserInterface.html#a6">InvokeCommand</a> (LPCMINVOKECOMMANDINFO lpcmi)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>STDMETHODIMP&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d3/classCICMUserInterface.html#a7">GetCommandString</a> (UINT_PTR idCmd, UINT uFlags, UINT FAR *reserved, LPSTR pszName, UINT cchMax)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>STDMETHODIMP&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d3/classCICMUserInterface.html#a8">Initialize</a> (LPCITEMIDLIST pIDFolder, LPDATAOBJECT pDataObj, HKEY hKeyID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>STDMETHODIMP&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d3/classCICMUserInterface.html#a9">GetIconLocation</a> (UINT uFlags, LPTSTR szIconFile, UINT cchMax, int *piIndex, UINT *pwFlags)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>STDMETHODIMP&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d3/classCICMUserInterface.html#a10">Extract</a> (LPCTSTR pszFile, UINT nIconIndex, HICON *phiconLarge, HICON *phiconSmall, UINT nIconSize)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>STDMETHODIMP&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d3/classCICMUserInterface.html#a11">GetClassID</a> (LPCLSID lpClassID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>STDMETHODIMP&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d3/classCICMUserInterface.html#a12">IsDirty</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>STDMETHODIMP&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d3/classCICMUserInterface.html#a13">Load</a> (LPCOLESTR lpszFileName, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> grfMode)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>STDMETHODIMP&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d3/classCICMUserInterface.html#a14">Save</a> (LPCOLESTR lpszFileName, <a class="el" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> fRemember)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>STDMETHODIMP&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d3/classCICMUserInterface.html#a15">SaveCompleted</a> (LPCOLESTR lpszFileName)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>STDMETHODIMP&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d3/classCICMUserInterface.html#a16">GetCurFile</a> (LPOLESTR FAR *lplpszFileName)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>STDMETHODIMP&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d3/classCICMUserInterface.html#a17">AddPages</a> (LPFNADDPROPSHEETPAGE lpfnAddPage, LPARAM lParam)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>STDMETHODIMP&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d3/classCICMUserInterface.html#a18">ReplacePage</a> (UINT uPageID, LPFNADDPROPSHEETPAGE lpfnReplaceWith, LPARAM lParam)</td></tr>

<tr><td colspan=2><br><h2>Private Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>HRESULT&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d3/classCICMUserInterface.html#d0">AddPrinterTab</a> (LPFNADDPROPSHEETPAGE lpfnAddPage, LPARAM lParam)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HRESULT&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d3/classCICMUserInterface.html#d1">AddAssociateTab</a> (LPFNADDPROPSHEETPAGE lpfnAddPage, LPARAM lParam)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HRESULT&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d3/classCICMUserInterface.html#d2">AddProfileTab</a> (LPFNADDPROPSHEETPAGE lpfnAddPage, LPARAM lParam)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HRESULT&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d3/classCICMUserInterface.html#d3">AddScannerTab</a> (LPFNADDPROPSHEETPAGE lpfnAddPage, LPARAM lParam)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HRESULT&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d3/classCICMUserInterface.html#d4">AddMonitorTab</a> (LPFNADDPROPSHEETPAGE lpfnAddPage, LPARAM lParam)</td></tr>

<tr><td colspan=2><br><h2>Private Attributes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d3/classCICMUserInterface.html#r0">m_ulcReferences</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>LPDATAOBJECT&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d3/classCICMUserInterface.html#r1">m_lpdoTarget</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d1/d7/classCString.html">CString</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d3/classCICMUserInterface.html#r2">m_csFile</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>TCHAR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d3/classCICMUserInterface.html#r3">m_acWork</a> [80]</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d9/d8/shellext_8h.html#a8">UITYPE</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d3/classCICMUserInterface.html#r4">m_utThis</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d3/classCICMUserInterface.html#r5">m_bInstalledContext</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d3/classCICMUserInterface.html#r6">m_bMultiSelection</a></td></tr>

</table>
<hr><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" name="a0" doxytag="CICMUserInterface::CICMUserInterface" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> CICMUserInterface::CICMUserInterface           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d9/d8/shellext_8h.html#a8">UITYPE</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>utThis</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00307">307</a> of file <a class="el" href="../../d9/d7/shellext_8cpp-source.html">shellext.cpp</a>.
<p>
References <a class="el" href="../../d3/d8/icmui_8h-source.html#l00050">CGlobals::Attach()</a>, <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00307">CICMUserInterface()</a>, <a class="el" href="../../d0/d8/shellext_8h-source.html#l00105">m_lpdoTarget</a>, <a class="el" href="../../d0/d8/shellext_8h-source.html#l00104">m_ulcReferences</a>, <a class="el" href="../../d0/d8/shellext_8h-source.html#l00109">m_utThis</a>, and <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>.
<p>
Referenced by <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00307">CICMUserInterface()</a>.
<p>
<pre class="fragment"><div>00307                                                   {
00308     <a class="code" href="../../d4/d3/classCICMUserInterface.html#r1">m_lpdoTarget</a> = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00309     <a class="code" href="../../d4/d3/classCICMUserInterface.html#r0">m_ulcReferences</a> = 0;
00310     <a class="code" href="../../d4/d3/classCICMUserInterface.html#r4">m_utThis</a> = utThis;
00311     <a class="code" href="../../d0/d3/classCGlobals.html#e0">CGlobals::Attach</a>();
00312     _RPTF2(_CRT_WARN, <span class="stringliteral">"CICMUserInterface(%d) constructed @ %lX\n"</span>, utThis, <span class="keyword">this</span>);
00313 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="CICMUserInterface::~CICMUserInterface" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> CICMUserInterface::~<a class="el" href="../../d4/d3/classCICMUserInterface.html">CICMUserInterface</a>           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [inline]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d8/shellext_8h-source.html#l00131">131</a> of file <a class="el" href="../../d0/d8/shellext_8h-source.html">shellext.h</a>.
<p>
References <a class="el" href="../../d3/d8/icmui_8h-source.html#l00051">CGlobals::Detach()</a>, and <a class="el" href="../../d0/d8/shellext_8h-source.html#l00105">m_lpdoTarget</a>.
<p>
<pre class="fragment"><div>00131                          { 
00132 
00133         <span class="keywordflow">if</span>  (<a class="code" href="../../d4/d3/classCICMUserInterface.html#r1">m_lpdoTarget</a>)
00134             <a class="code" href="../../d4/d3/classCICMUserInterface.html#r1">m_lpdoTarget</a> -&gt; Release();
00135         <a class="code" href="../../d0/d3/classCGlobals.html#e1">CGlobals::Detach</a>();
00136     }
</div></pre>    </td>
  </tr>
</table>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="d1" doxytag="CICMUserInterface::AddAssociateTab" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HRESULT CICMUserInterface::AddAssociateTab           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">LPFNADDPROPSHEETPAGE&nbsp;</td>
          <td class="mdname" nowrap> <em>lpfnAddPage</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>lParam</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [private]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00772">772</a> of file <a class="el" href="../../d9/d7/shellext_8cpp-source.html">shellext.cpp</a>.
<p>
References <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00772">AddAssociateTab()</a>, <a class="el" href="../../d7/d6/aug98_2dll32_2icmdll_8h-source.html#l00010">FAR</a>, <a class="el" href="../../d6/d5/w98_2lh__open_2pi__basic_8h-source.html#l00053">Handle</a>, <a class="el" href="../../d0/d8/shellext_8h-source.html#l00105">m_lpdoTarget</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, and <a class="el" href="../../d0/d5/ndismain_8h-source.html#l00026">UINT</a>.
<p>
Referenced by <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00772">AddAssociateTab()</a>, and <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00693">AddPages()</a>.
<p>
<pre class="fragment"><div>00773                                                           {
00774 
00775     _RPTF0(_CRT_WARN, <span class="stringliteral">"CICMUserInterface::AddAssociateTab\n"</span>);
00776 
00777     <span class="comment">//  Load the profile(s) in the list.</span>
00778 
00779     FORMATETC       fmte = {CF_HDROP, (DVTARGETDEVICE <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a5">FAR</a> *)<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>,
00780                             DVASPECT_CONTENT, -1, TYMED_HGLOBAL };
00781     STGMEDIUM       stgm;
00782     HRESULT         hres = <a class="code" href="../../d4/d3/classCICMUserInterface.html#r1">m_lpdoTarget</a> ?
00783         <a class="code" href="../../d4/d3/classCICMUserInterface.html#r1">m_lpdoTarget</a> -&gt; GetData(&amp;fmte, &amp;stgm) : 0;
00784 
00785     <span class="keywordflow">if</span>  (!SUCCEEDED(hres))
00786         <span class="keywordflow">return</span>  NOERROR;    <span class="comment">//  Why bother reporting a failure, here?</span>
00787 
00788     <a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a>    ucFiles = stgm.hGlobal ?
00789         DragQueryFile((HDROP) stgm.hGlobal, 0xFFFFFFFFL , 0, 0) : 0;
00790 
00791     <span class="keywordflow">if</span>  (ucFiles != 1)
00792         <span class="keywordflow">return</span>  NOERROR;
00793 
00794     TCHAR   acFile[_MAX_PATH];
00795 
00796     DragQueryFile((HDROP) stgm.hGlobal, 0, acFile,
00797         <span class="keyword">sizeof</span> acFile/ <span class="keyword">sizeof</span> acFile[0]);
00798 
00799     <span class="comment">//  Create the property sheet- it will get deleted if it is not in</span>
00800     <span class="comment">//  use when the shell tries to unload the extension</span>
00801 
00802     <a class="code" href="../../d9/d5/classCProfileAssociationPage.html">CProfileAssociationPage</a> *pcpap =
00803         <span class="keyword">new</span> <a class="code" href="../../d9/d5/classCProfileAssociationPage.html">CProfileAssociationPage</a>(CGlobals::Instance(), acFile);
00804 
00805     <span class="keywordflow">if</span>  (!(*lpfnAddPage)(pcpap -&gt; <a class="code" href="../../d5/d6/w98_2lh__open_2pi__basic_8h.html#a29">Handle</a>(), lParam))
00806         DestroyPropertySheetPage(pcpap -&gt; <a class="code" href="../../d5/d6/w98_2lh__open_2pi__basic_8h.html#a29">Handle</a>());
00807 
00808     <span class="keywordflow">return</span>  NOERROR;
00809 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="d4" doxytag="CICMUserInterface::AddMonitorTab" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HRESULT CICMUserInterface::AddMonitorTab           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">LPFNADDPROPSHEETPAGE&nbsp;</td>
          <td class="mdname" nowrap> <em>lpfnAddPage</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>lParam</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [private]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00816">816</a> of file <a class="el" href="../../d9/d7/shellext_8cpp-source.html">shellext.cpp</a>.
<p>
References <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00816">AddMonitorTab()</a>, <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00104">CMonitorList::Count()</a>, <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00105">CMonitorList::DeviceName()</a>, <a class="el" href="../../d1/d7/ntcftxt_8h-source.html#l01102">EnumDisplayDevices()</a>, <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00159">CMonitorList::Enumerate()</a>, <a class="el" href="../../d7/d6/aug98_2dll32_2icmdll_8h-source.html#l00010">FAR</a>, <a class="el" href="../../d6/d5/w98_2lh__open_2pi__basic_8h-source.html#l00053">Handle</a>, <a class="el" href="../../d0/d8/shellext_8h-source.html#l00105">m_lpdoTarget</a>, and <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>.
<p>
Referenced by <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00816">AddMonitorTab()</a>, and <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00693">AddPages()</a>.
<p>
<pre class="fragment"><div>00817                                                         {
00818 
00819     <span class="comment">//  Create the property sheet- it will get deleted if it is not in</span>
00820     <span class="comment">//  use when the shell tries to unload the extension</span>
00821 
00822     <a class="code" href="../../d1/d7/classCString.html">CString</a> csMonitorDevice;
00823     <a class="code" href="../../d1/d7/classCString.html">CString</a> csMonitorFriendlyName;
00824 
00825     <span class="keywordflow">if</span> (<a class="code" href="../../d4/d3/classCICMUserInterface.html#r1">m_lpdoTarget</a>) {
00826 
00827         FORMATETC fmte = { (CLIPFORMAT)RegisterClipboardFormat(_TEXT(<span class="stringliteral">"Display Device"</span>)),
00828                            (DVTARGETDEVICE <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a5">FAR</a> *) <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>,
00829                            DVASPECT_CONTENT, -1, TYMED_HGLOBAL };
00830         STGMEDIUM stgm;
00831 
00832         <span class="comment">// Get device name from IDataObject.</span>
00833 
00834         HRESULT   hres = <a class="code" href="../../d4/d3/classCICMUserInterface.html#r1">m_lpdoTarget</a> -&gt; GetData(&amp;fmte, &amp;stgm);
00835 
00836         <span class="keywordflow">if</span>  (!SUCCEEDED(hres) || !stgm.hGlobal) {
00837             <span class="keywordflow">return</span>  NOERROR;    <span class="comment">//  Why bother reporting a failure, here?</span>
00838         }
00839 
00840         <span class="comment">// The storage contains Display device path (\\.\DisplayX) in UNICODE.</span>
00841 
00842         LPCWSTR lpDeviceName = (LPCWSTR) GlobalLock(stgm.hGlobal);
00843         <a class="code" href="../../d1/d7/classCString.html">CString</a> csMonitorDevicePath = lpDeviceName;
00844         GlobalUnlock(stgm.hGlobal);
00845 
00846         <span class="comment">// Query the device id, friendly name and other on the display device.</span>
00847 
00848         DISPLAY_DEVICE ddPriv;
00849 
00850         ddPriv.cb = <span class="keyword">sizeof</span>(ddPriv);
00851 
00852         <span class="keywordflow">if</span> (!<a class="code" href="../../d0/d8/ntcftxt_8h.html#a33">EnumDisplayDevices</a>((LPCTSTR)csMonitorDevicePath, 0, &amp;ddPriv, 0))
00853         {
00854             <span class="keywordflow">return</span>  NOERROR;    <span class="comment">//  Why bother reporting a failure, here?</span>
00855         }
00856 
00857 <span class="preprocessor">        #if HIDEYUKN_DBG</span>
00858 <span class="preprocessor"></span>            MessageBox(NULL,csMonitorDevicePath,TEXT(<span class="stringliteral">""</span>),MB_OK);
00859             MessageBox(NULL,(LPCTSTR)ddPriv.DeviceID,TEXT(<span class="stringliteral">""</span>),MB_OK);
00860             MessageBox(NULL,(LPCTSTR)ddPriv.DeviceString,TEXT(<span class="stringliteral">""</span>),MB_OK);
00861 <span class="preprocessor">        #endif</span>
00862 <span class="preprocessor"></span>
00863         <span class="comment">// Use deviceId (PnP Id) as device name, and set friendly name</span>
00864 
00865         csMonitorDevice       = (LPTSTR)(ddPriv.DeviceID);
00866         csMonitorFriendlyName = (LPTSTR)(ddPriv.DeviceString);
00867     }
00868     <span class="keywordflow">else</span>
00869     {
00870         <span class="comment">// if we don't have IDataObject, enumerate monitor,</span>
00871         <span class="comment">// then use 1st entry.</span>
00872 
00873         <a class="code" href="../../d2/d4/classCMonitorList.html">CMonitorList</a>    cml;
00874         cml.<a class="code" href="../../d2/d4/classCMonitorList.html#a6">Enumerate</a>();
00875         _ASSERTE(cml.<a class="code" href="../../d2/d4/classCMonitorList.html#a2">Count</a>());  <span class="comment">// At least, we should have one Monitor.</span>
00876         csMonitorDevice = csMonitorFriendlyName = cml.<a class="code" href="../../d2/d4/classCMonitorList.html#a3">DeviceName</a>(0);
00877     }
00878 
00879     <a class="code" href="../../d3/d4/classCMonitorProfileManagement.html">CMonitorProfileManagement</a> *pcmpm =
00880         <span class="keyword">new</span> <a class="code" href="../../d3/d4/classCMonitorProfileManagement.html">CMonitorProfileManagement</a>(csMonitorDevice,
00881                                       csMonitorFriendlyName,
00882                                       CGlobals::Instance());
00883 
00884 
00885     <span class="keywordflow">if</span>  (!(*lpfnAddPage)(pcmpm -&gt; <a class="code" href="../../d5/d6/w98_2lh__open_2pi__basic_8h.html#a29">Handle</a>(), lParam))
00886         DestroyPropertySheetPage(pcmpm -&gt; <a class="code" href="../../d5/d6/w98_2lh__open_2pi__basic_8h.html#a29">Handle</a>());
00887 
00888     <span class="keywordflow">return</span>  NOERROR;
00889 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a17" doxytag="CICMUserInterface::AddPages" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> STDMETHODIMP CICMUserInterface::AddPages           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">LPFNADDPROPSHEETPAGE&nbsp;</td>
          <td class="mdname" nowrap> <em>lpfnAddPage</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>lParam</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00693">693</a> of file <a class="el" href="../../d9/d7/shellext_8cpp-source.html">shellext.cpp</a>.
<p>
References <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00772">AddAssociateTab()</a>, <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00816">AddMonitorTab()</a>, <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00693">AddPages()</a>, <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l01028">AddPrinterTab()</a>, <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00731">AddProfileTab()</a>, <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00893">AddScannerTab()</a>, <a class="el" href="../../d9/d8/shellext_8h.html#a8a3">IsMonitor</a>, <a class="el" href="../../d9/d8/shellext_8h.html#a8a1">IsPrinter</a>, <a class="el" href="../../d9/d8/shellext_8h.html#a8a0">IsProfile</a>, <a class="el" href="../../d9/d8/shellext_8h.html#a8a2">IsScanner</a>, and <a class="el" href="../../d0/d8/shellext_8h-source.html#l00109">m_utThis</a>.
<p>
Referenced by <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00693">AddPages()</a>.
<p>
<pre class="fragment"><div>00694                                                            {
00695     _RPTF0(_CRT_WARN, <span class="stringliteral">"CICMUserInterface::AddPages\n"</span>);
00696 
00697     HRESULT hResult = NOERROR;
00698     
00699     <span class="keywordflow">switch</span>  (<a class="code" href="../../d4/d3/classCICMUserInterface.html#r4">m_utThis</a>) {
00700         <span class="keywordflow">case</span>    <a class="code" href="../../d9/d8/shellext_8h.html#a8a0">IsProfile</a>: {
00701             hResult = <a class="code" href="../../d4/d3/classCICMUserInterface.html#d2">AddProfileTab</a>(lpfnAddPage, lParam);
00702             <span class="keywordflow">if</span> (hResult == NOERROR) {
00703                 hResult = <a class="code" href="../../d4/d3/classCICMUserInterface.html#d1">AddAssociateTab</a>(lpfnAddPage, lParam);
00704             }
00705             <span class="keywordflow">break</span>;
00706         }
00707 
00708         <span class="keywordflow">case</span>    <a class="code" href="../../d9/d8/shellext_8h.html#a8a3">IsMonitor</a>: {
00709             hResult = <a class="code" href="../../d4/d3/classCICMUserInterface.html#d4">AddMonitorTab</a>(lpfnAddPage, lParam);
00710             <span class="keywordflow">break</span>;
00711         }
00712 
00713         <span class="keywordflow">case</span>    <a class="code" href="../../d9/d8/shellext_8h.html#a8a1">IsPrinter</a>: {
00714             hResult = <a class="code" href="../../d4/d3/classCICMUserInterface.html#d0">AddPrinterTab</a>(lpfnAddPage, lParam);
00715             <span class="keywordflow">break</span>;
00716         }
00717 
00718         <span class="keywordflow">case</span>    <a class="code" href="../../d9/d8/shellext_8h.html#a8a2">IsScanner</a>: {
00719             hResult = <a class="code" href="../../d4/d3/classCICMUserInterface.html#d3">AddScannerTab</a>(lpfnAddPage, lParam);
00720             <span class="keywordflow">break</span>;
00721         }
00722     }
00723 
00724     <span class="keywordflow">return</span>  hResult;
00725 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="d0" doxytag="CICMUserInterface::AddPrinterTab" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HRESULT CICMUserInterface::AddPrinterTab           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">LPFNADDPROPSHEETPAGE&nbsp;</td>
          <td class="mdname" nowrap> <em>lpfnAddPage</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>lParam</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [private]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l01028">1028</a> of file <a class="el" href="../../d9/d7/shellext_8cpp-source.html">shellext.cpp</a>.
<p>
References <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l01028">AddPrinterTab()</a>, <a class="el" href="../../d7/d6/aug98_2dll32_2icmdll_8h-source.html#l00010">FAR</a>, <a class="el" href="../../d6/d5/w98_2lh__open_2pi__basic_8h-source.html#l00053">Handle</a>, <a class="el" href="../../d0/d8/shellext_8h-source.html#l00105">m_lpdoTarget</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, and <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00949">RetrievePrinterName()</a>.
<p>
Referenced by <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00693">AddPages()</a>, and <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l01028">AddPrinterTab()</a>.
<p>
<pre class="fragment"><div>01029                                                         {
01030 
01031     <span class="comment">//  The list is formatted as a Shell IDList Array</span>
01032 
01033     FORMATETC       fmte = { (CLIPFORMAT)RegisterClipboardFormat(_TEXT(<span class="stringliteral">"Shell IDList Array"</span>)),
01034                              (DVTARGETDEVICE <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a5">FAR</a> *) <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>,
01035                              DVASPECT_CONTENT, -1, TYMED_HGLOBAL };
01036     STGMEDIUM       stgm;
01037     HRESULT         hres = <a class="code" href="../../d4/d3/classCICMUserInterface.html#r1">m_lpdoTarget</a> ?
01038         <a class="code" href="../../d4/d3/classCICMUserInterface.html#r1">m_lpdoTarget</a> -&gt; GetData(&amp;fmte, &amp;stgm) : 0;
01039 
01040     <span class="keywordflow">if</span>  (!SUCCEEDED(hres) || !stgm.hGlobal)
01041         <span class="keywordflow">return</span>  NOERROR;    <span class="comment">//  Why bother reporting a failure, here?</span>
01042 
01043     <a class="code" href="../../d1/d7/classCString.html">CString</a> csPrinter;
01044 
01045     <a class="code" href="../../d8/d8/shellext_8cpp.html#a3">RetrievePrinterName</a>((LPIDA) stgm.hGlobal, csPrinter);
01046 
01047 <span class="preprocessor">    #if HIDEYUKN_DBG</span>
01048 <span class="preprocessor"></span>        MessageBox(NULL,csPrinter,TEXT(<span class="stringliteral">""</span>),MB_OK);
01049 <span class="preprocessor">    #endif</span>
01050 <span class="preprocessor"></span>
01051     <span class="comment">//  If this is not a color printer, forget it...</span>
01052 
01053 
01054     <span class="keywordflow">if</span>  (!<a class="code" href="../../d0/d3/classCGlobals.html#e11">CGlobals::ThisIsAColorPrinter</a>(csPrinter))
01055         <span class="keywordflow">return</span>  NOERROR;
01056 
01057     <span class="comment">//  Create the property sheet- it will get deleted if it is not in use when</span>
01058     <span class="comment">//  the shell tries to unload the extension</span>
01059 
01060 
01061     <a class="code" href="../../d6/d5/classCPrinterProfileManagement.html">CPrinterProfileManagement</a> *pcppm =
01062             <span class="keyword">new</span> <a class="code" href="../../d6/d5/classCPrinterProfileManagement.html">CPrinterProfileManagement</a>(csPrinter, CGlobals::Instance());
01063 
01064     <span class="keywordflow">if</span>  (!pcppm)
01065         <span class="keywordflow">return</span>  E_OUTOFMEMORY;
01066 
01067     <span class="keywordflow">if</span>  (!(*lpfnAddPage)(pcppm -&gt; <a class="code" href="../../d5/d6/w98_2lh__open_2pi__basic_8h.html#a29">Handle</a>(), lParam))
01068         DestroyPropertySheetPage(pcppm -&gt; <a class="code" href="../../d5/d6/w98_2lh__open_2pi__basic_8h.html#a29">Handle</a>());
01069 
01070     <span class="keywordflow">return</span>  NOERROR;
01071 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="d2" doxytag="CICMUserInterface::AddProfileTab" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HRESULT CICMUserInterface::AddProfileTab           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">LPFNADDPROPSHEETPAGE&nbsp;</td>
          <td class="mdname" nowrap> <em>lpfnAddPage</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>lParam</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [private]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00731">731</a> of file <a class="el" href="../../d9/d7/shellext_8cpp-source.html">shellext.cpp</a>.
<p>
References <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00731">AddProfileTab()</a>, <a class="el" href="../../d7/d6/aug98_2dll32_2icmdll_8h-source.html#l00010">FAR</a>, <a class="el" href="../../d6/d5/w98_2lh__open_2pi__basic_8h-source.html#l00053">Handle</a>, <a class="el" href="../../d0/d8/shellext_8h-source.html#l00105">m_lpdoTarget</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, and <a class="el" href="../../d0/d5/ndismain_8h-source.html#l00026">UINT</a>.
<p>
Referenced by <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00693">AddPages()</a>, and <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00731">AddProfileTab()</a>.
<p>
<pre class="fragment"><div>00732                                                        {
00733     _RPTF0(_CRT_WARN, <span class="stringliteral">"CICMUserInterface::AddProfileTab\n"</span>);
00734 
00735     <span class="comment">//  Load the profile(s) in the list.</span>
00736 
00737     FORMATETC       fmte = {CF_HDROP, (DVTARGETDEVICE <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a5">FAR</a> *)<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>,
00738                             DVASPECT_CONTENT, -1, TYMED_HGLOBAL };
00739     STGMEDIUM       stgm;
00740     HRESULT         hres = <a class="code" href="../../d4/d3/classCICMUserInterface.html#r1">m_lpdoTarget</a> ?
00741         <a class="code" href="../../d4/d3/classCICMUserInterface.html#r1">m_lpdoTarget</a> -&gt; GetData(&amp;fmte, &amp;stgm) : 0;
00742 
00743 
00744     <span class="keywordflow">if</span>  (!SUCCEEDED(hres))
00745         <span class="keywordflow">return</span>  NOERROR;    <span class="comment">//  Why bother reporting a failure, here?</span>
00746 
00747     <a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a>    ucFiles = stgm.hGlobal ?
00748         DragQueryFile((HDROP) stgm.hGlobal, 0xFFFFFFFFL , 0, 0) : 0;
00749 
00750     <span class="keywordflow">if</span>  (ucFiles != 1)
00751         <span class="keywordflow">return</span>  NOERROR;
00752 
00753     TCHAR   acFile[_MAX_PATH];
00754 
00755     DragQueryFile((HDROP) stgm.hGlobal, 0, acFile,
00756         <span class="keyword">sizeof</span> acFile/ <span class="keyword">sizeof</span> acFile[0]);
00757 
00758     <span class="comment">//  Create the property sheet- it will get deleted if it is not in</span>
00759     <span class="comment">//  use when the shell tries to unload the extension</span>
00760 
00761     <a class="code" href="../../d0/d6/classCProfileInformationPage.html">CProfileInformationPage</a> *pcpip =
00762         <span class="keyword">new</span> <a class="code" href="../../d0/d6/classCProfileInformationPage.html">CProfileInformationPage</a>(CGlobals::Instance(), acFile);
00763 
00764     <span class="keywordflow">if</span>  (!(*lpfnAddPage)(pcpip -&gt; <a class="code" href="../../d5/d6/w98_2lh__open_2pi__basic_8h.html#a29">Handle</a>(), lParam))
00765         DestroyPropertySheetPage(pcpip -&gt; <a class="code" href="../../d5/d6/w98_2lh__open_2pi__basic_8h.html#a29">Handle</a>());
00766 
00767     <span class="keywordflow">return</span>  NOERROR;
00768 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="d3" doxytag="CICMUserInterface::AddScannerTab" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HRESULT CICMUserInterface::AddScannerTab           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">LPFNADDPROPSHEETPAGE&nbsp;</td>
          <td class="mdname" nowrap> <em>lpfnAddPage</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>lParam</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [private]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00893">893</a> of file <a class="el" href="../../d9/d7/shellext_8cpp-source.html">shellext.cpp</a>.
<p>
References <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00893">AddScannerTab()</a>, <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00127">CScannerList::Count()</a>, <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00128">CScannerList::DeviceName()</a>, <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00240">CScannerList::Enumerate()</a>, <a class="el" href="../../d7/d6/aug98_2dll32_2icmdll_8h-source.html#l00010">FAR</a>, <a class="el" href="../../d6/d5/w98_2lh__open_2pi__basic_8h-source.html#l00053">Handle</a>, <a class="el" href="../../d0/d8/shellext_8h-source.html#l00105">m_lpdoTarget</a>, and <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>.
<p>
Referenced by <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00693">AddPages()</a>, and <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00893">AddScannerTab()</a>.
<p>
<pre class="fragment"><div>00894                                                         {
00895 
00896     <span class="comment">//  Create the property sheet- it will get deleted if it is not in</span>
00897     <span class="comment">//  use when the shell tries to unload the extension</span>
00898 
00899     <a class="code" href="../../d1/d7/classCString.html">CString</a> csScannerDevice;
00900 
00901     <span class="keywordflow">if</span> (<a class="code" href="../../d4/d3/classCICMUserInterface.html#r1">m_lpdoTarget</a>) {
00902         FORMATETC fmte = { (CLIPFORMAT)RegisterClipboardFormat(_TEXT(<span class="stringliteral">"STIDeviceName"</span>)),
00903                            (DVTARGETDEVICE <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a5">FAR</a> *) <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>,
00904                            DVASPECT_CONTENT, -1, TYMED_HGLOBAL };
00905         STGMEDIUM stgm;
00906 
00907         <span class="comment">// Get device name from IDataObject.</span>
00908 
00909         HRESULT   hres = <a class="code" href="../../d4/d3/classCICMUserInterface.html#r1">m_lpdoTarget</a> -&gt; GetData(&amp;fmte, &amp;stgm);
00910 
00911         <span class="keywordflow">if</span>  (!SUCCEEDED(hres) || !stgm.hGlobal) {
00912             <span class="keywordflow">return</span>  NOERROR;    <span class="comment">//  Why bother reporting a failure, here?</span>
00913         }
00914 
00915         <span class="comment">// The storage contains Scanner in UNICODE string.</span>
00916 
00917         LPCWSTR lpDeviceName = (LPCWSTR) GlobalLock(stgm.hGlobal);
00918         csScannerDevice = lpDeviceName;
00919         GlobalUnlock(stgm.hGlobal);
00920 
00921 <span class="preprocessor">        #if HIDEYUKN_DBG</span>
00922 <span class="preprocessor"></span>            MessageBox(NULL,csScannerDevice,TEXT(<span class="stringliteral">""</span>),MB_OK);
00923 <span class="preprocessor">        #endif</span>
00924 <span class="preprocessor"></span>
00925     } <span class="keywordflow">else</span> {
00926 
00927         <span class="comment">// if we don't have IDataObject, enumerate monitor,</span>
00928         <span class="comment">// then use 1st entry.</span>
00929 
00930         <a class="code" href="../../d7/d6/classCScannerList.html">CScannerList</a> csl;
00931         csl.<a class="code" href="../../d7/d6/classCScannerList.html#a5">Enumerate</a>();
00932         _ASSERTE(csl.<a class="code" href="../../d7/d6/classCScannerList.html#a2">Count</a>());
00933         csScannerDevice = csl.<a class="code" href="../../d7/d6/classCScannerList.html#a3">DeviceName</a>(0);
00934     }
00935 
00936     <a class="code" href="../../d8/d6/classCScannerProfileManagement.html">CScannerProfileManagement</a> *pcspm =
00937         <span class="keyword">new</span> <a class="code" href="../../d8/d6/classCScannerProfileManagement.html">CScannerProfileManagement</a>(csScannerDevice, CGlobals::Instance());
00938 
00939     <span class="keywordflow">if</span>  (!(*lpfnAddPage)(pcspm -&gt; <a class="code" href="../../d5/d6/w98_2lh__open_2pi__basic_8h.html#a29">Handle</a>(), lParam))
00940         DestroyPropertySheetPage(pcspm -&gt; <a class="code" href="../../d5/d6/w98_2lh__open_2pi__basic_8h.html#a29">Handle</a>());
00941 
00942     <span class="keywordflow">return</span>  NOERROR;
00943 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a10" doxytag="CICMUserInterface::Extract" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> STDMETHODIMP CICMUserInterface::Extract           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">LPCTSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>pszFile</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>nIconIndex</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HICON *&nbsp;</td>
          <td class="mdname" nowrap> <em>phiconLarge</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HICON *&nbsp;</td>
          <td class="mdname" nowrap> <em>phiconSmall</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>nIconSize</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00400">400</a> of file <a class="el" href="../../d9/d7/shellext_8cpp-source.html">shellext.cpp</a>.
<p>
References <a class="el" href="../../d3/d8/ntgdi_2icm_2icmui_2resource_8h-source.html#l00084">DefaultIcon</a>, <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00400">Extract()</a>, <a class="el" href="../../d0/d8/shellext_8h-source.html#l00106">m_csFile</a>, and <a class="el" href="../../d3/d8/ntgdi_2icm_2icmui_2resource_8h-source.html#l00085">UninstalledIcon</a>.
<p>
Referenced by <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00400">Extract()</a>.
<p>
<pre class="fragment"><div>00402                                             {
00403 
00404     *phiconSmall = *phiconLarge = LoadIcon(CGlobals::Instance(),
00405         MAKEINTRESOURCE(CGlobals::IsInstalled(m_csFile) ? DefaultIcon : UninstalledIcon));
00406 
00407     <span class="keywordflow">return</span> NOERROR;
00408 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a11" doxytag="CICMUserInterface::GetClassID" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> STDMETHODIMP CICMUserInterface::GetClassID           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">LPCLSID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>lpClassID</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [inline]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d8/shellext_8h-source.html#l00177">177</a> of file <a class="el" href="../../d0/d8/shellext_8h-source.html">shellext.h</a>.
<p>
References <a class="el" href="../../d0/d8/shellext_8h-source.html#l00177">GetClassID()</a>.
<p>
Referenced by <a class="el" href="../../d0/d8/shellext_8h-source.html#l00177">GetClassID()</a>.
<p>
<pre class="fragment"><div>00177 { <span class="keywordflow">return</span> E_FAIL; }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a7" doxytag="CICMUserInterface::GetCommandString" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> STDMETHODIMP CICMUserInterface::GetCommandString           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">UINT_PTR&nbsp;</td>
          <td class="mdname" nowrap> <em>idCmd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>uFlags</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT FAR *&nbsp;</td>
          <td class="mdname" nowrap> <em>reserved</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>pszName</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>cchMax</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00661">661</a> of file <a class="el" href="../../d9/d7/shellext_8cpp-source.html">shellext.cpp</a>.
<p>
References <a class="el" href="../../d3/d8/ntgdi_2icm_2icmui_2resource_8h-source.html#l00075">AssociateContextMenuString</a>, <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00661">GetCommandString()</a>, <a class="el" href="../../d3/d8/ntgdi_2icm_2icmui_2resource_8h-source.html#l00074">InstallMultiProfileContextMenuString</a>, <a class="el" href="../../d3/d8/ntgdi_2icm_2icmui_2resource_8h-source.html#l00073">InstallProfileContextMenuString</a>, <a class="el" href="../../d4/d6/stringar_8cpp-source.html#l00189">CString::Load()</a>, <a class="el" href="../../d0/d8/shellext_8h-source.html#l00110">m_bInstalledContext</a>, <a class="el" href="../../d0/d8/shellext_8h-source.html#l00110">m_bMultiSelection</a>, <a class="el" href="../../d3/d8/ntgdi_2icm_2icmui_2resource_8h-source.html#l00072">UninstallMultiProfileContextMenuString</a>, and <a class="el" href="../../d3/d8/ntgdi_2icm_2icmui_2resource_8h-source.html#l00071">UninstallProfileContextMenuString</a>.
<p>
Referenced by <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00661">GetCommandString()</a>.
<p>
<pre class="fragment"><div>00663                                                                  {
00664     <a class="code" href="../../d1/d7/classCString.html">CString</a> csReturnString;
00665 
00666     <span class="keywordflow">switch</span> (idCmd) {
00667         <span class="keywordflow">case</span>    0: {   <span class="comment">// Install/Uninstall was selected.</span>
00668           <span class="keywordflow">if</span>(<a class="code" href="../../d4/d3/classCICMUserInterface.html#r6">m_bMultiSelection</a>) {
00669             csReturnString.<a class="code" href="../../d1/d7/classCString.html#a16">Load</a>(m_bInstalledContext ? UninstallMultiProfileContextMenuString : InstallMultiProfileContextMenuString);
00670           } <span class="keywordflow">else</span> {
00671             csReturnString.<a class="code" href="../../d1/d7/classCString.html#a16">Load</a>(m_bInstalledContext ? UninstallProfileContextMenuString : InstallProfileContextMenuString);
00672           }
00673           lstrcpyn((LPTSTR)pszName, csReturnString, cchMax);
00674           <span class="keywordflow">break</span>;
00675         }
00676 
00677         <span class="keywordflow">case</span>    1: {   <span class="comment">// Associate... was seleted.</span>
00678           <span class="keywordflow">if</span> (!<a class="code" href="../../d4/d3/classCICMUserInterface.html#r6">m_bMultiSelection</a>) {
00679             csReturnString.<a class="code" href="../../d1/d7/classCString.html#a16">Load</a>(AssociateContextMenuString);
00680             lstrcpyn((LPTSTR)pszName, csReturnString, cchMax);
00681           }
00682           <span class="keywordflow">break</span>;
00683         }
00684     }
00685 
00686     <span class="keywordflow">return</span> NOERROR;
00687 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a16" doxytag="CICMUserInterface::GetCurFile" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> STDMETHODIMP CICMUserInterface::GetCurFile           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">LPOLESTR FAR *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>lplpszFileName</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [inline]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d8/shellext_8h-source.html#l00189">189</a> of file <a class="el" href="../../d0/d8/shellext_8h-source.html">shellext.h</a>.
<p>
References <a class="el" href="../../d0/d8/shellext_8h-source.html#l00189">GetCurFile()</a>.
<p>
Referenced by <a class="el" href="../../d0/d8/shellext_8h-source.html#l00189">GetCurFile()</a>.
<p>
<pre class="fragment"><div>00189                                                              {
00190         <span class="keywordflow">return</span>  E_FAIL;
00191     }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a9" doxytag="CICMUserInterface::GetIconLocation" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> STDMETHODIMP CICMUserInterface::GetIconLocation           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>uFlags</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPTSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>szIconFile</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>cchMax</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int *&nbsp;</td>
          <td class="mdname" nowrap> <em>piIndex</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT *&nbsp;</td>
          <td class="mdname" nowrap> <em>pwFlags</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00388">388</a> of file <a class="el" href="../../d9/d7/shellext_8cpp-source.html">shellext.cpp</a>.
<p>
References <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00388">GetIconLocation()</a>, and <a class="el" href="../../d0/d5/ndismain_8h-source.html#l00026">UINT</a>.
<p>
Referenced by <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00388">GetIconLocation()</a>.
<p>
<pre class="fragment"><div>00392                                                                   {
00393 
00394     *puFlags = (GIL_NOTFILENAME|GIL_DONTCACHE); <span class="comment">// Make shell call our Extract function</span>
00395                                                 <span class="comment">// And don't cache in the callee.</span>
00396 
00397     <span class="keywordflow">return</span> S_FALSE;
00398 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a8" doxytag="CICMUserInterface::Initialize" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> STDMETHODIMP CICMUserInterface::Initialize           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">LPCITEMIDLIST&nbsp;</td>
          <td class="mdname" nowrap> <em>pIDFolder</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPDATAOBJECT&nbsp;</td>
          <td class="mdname" nowrap> <em>pDataObj</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HKEY&nbsp;</td>
          <td class="mdname" nowrap> <em>hKeyID</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00363">363</a> of file <a class="el" href="../../d9/d7/shellext_8cpp-source.html">shellext.cpp</a>.
<p>
References <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00363">Initialize()</a>, <a class="el" href="../../d0/d8/shellext_8h-source.html#l00105">m_lpdoTarget</a>, and <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>.
<p>
Referenced by <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00363">Initialize()</a>.
<p>
<pre class="fragment"><div>00365                                                            {
00366 
00367     _RPTF0(_CRT_WARN, <span class="stringliteral">"CICMUserInterface::Initialize\n"</span>);
00368 
00369     <span class="comment">//  The target data object is an HDROP, or list of files from the shell.</span>
00370 
00371     <span class="keywordflow">if</span>  (<a class="code" href="../../d4/d3/classCICMUserInterface.html#r1">m_lpdoTarget</a>) {
00372         <a class="code" href="../../d4/d3/classCICMUserInterface.html#r1">m_lpdoTarget</a> -&gt; Release();
00373         <a class="code" href="../../d4/d3/classCICMUserInterface.html#r1">m_lpdoTarget</a> = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00374     }
00375 
00376     <span class="keywordflow">if</span>  (pdoTarget) {
00377         <a class="code" href="../../d4/d3/classCICMUserInterface.html#r1">m_lpdoTarget</a> = pdoTarget;
00378         <a class="code" href="../../d4/d3/classCICMUserInterface.html#r1">m_lpdoTarget</a> -&gt; AddRef();
00379     }
00380 
00381     <span class="keywordflow">return</span>  NOERROR;
00382 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a6" doxytag="CICMUserInterface::InvokeCommand" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> STDMETHODIMP CICMUserInterface::InvokeCommand           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">LPCMINVOKECOMMANDINFO&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>lpcmi</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00532">532</a> of file <a class="el" href="../../d9/d7/shellext_8cpp-source.html">shellext.cpp</a>.
<p>
References <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d7/d6/aug98_2dll32_2icmdll_8h-source.html#l00010">FAR</a>, <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00182">CProfile::GetName()</a>, <a class="el" href="../../d7/d7/proppage_8cpp-source.html#l00038">CPropertyPage::Handle()</a>, <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00712">CProfile::Install()</a>, <a class="el" href="../../d3/d8/icmui_8h-source.html#l00058">CGlobals::Instance()</a>, <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00532">InvokeCommand()</a>, <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00189">CProfile::IsInstalled()</a>, <a class="el" href="../../d0/d8/shellext_8h-source.html#l00110">m_bInstalledContext</a>, <a class="el" href="../../d0/d8/shellext_8h-source.html#l00105">m_lpdoTarget</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d4/d9/user32_8def-source.html#l00547">SetCursor</a>, <a class="el" href="../../d0/d5/ndismain_8h-source.html#l00026">UINT</a>, and <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00731">CProfile::Uninstall()</a>.
<p>
Referenced by <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00532">InvokeCommand()</a>.
<p>
<pre class="fragment"><div>00532                                                                             {
00533 
00534     <span class="comment">//  If HIWORD(lpcmi-&gt;lpVerb) then we have been called programmatically and</span>
00535     <span class="comment">//  lpVerb us a command that should be invoked. Otherwise, the shell has</span>
00536     <span class="comment">//  called us, abd LOWORD(lpcmi-&gt;lpVerb) is the menu ID the user has selected.</span>
00537     <span class="comment">//  Actually, it's (menu ID - icmdFirst) from QueryContextMenu().</span>
00538 
00539     <span class="keywordflow">if</span> (!HIWORD((ULONG)(ULONG_PTR)lpcmi-&gt;lpVerb))  {
00540 
00541         FORMATETC       fmte = {CF_HDROP, (DVTARGETDEVICE <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a5">FAR</a> *)<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>,
00542                             DVASPECT_CONTENT, -1, TYMED_HGLOBAL };
00543         STGMEDIUM       stgm;
00544         HRESULT         hres = <a class="code" href="../../d4/d3/classCICMUserInterface.html#r1">m_lpdoTarget</a> ?
00545             <a class="code" href="../../d4/d3/classCICMUserInterface.html#r1">m_lpdoTarget</a> -&gt; GetData(&amp;fmte, &amp;stgm) : 0;
00546 
00547         <span class="keywordflow">if</span>  (!SUCCEEDED(hres))
00548             <span class="keywordflow">return</span>  NOERROR;    <span class="comment">//  Why bother reporting a failure, here?</span>
00549 
00550         <a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a>    ucFiles = stgm.hGlobal ?
00551             DragQueryFile((HDROP) stgm.hGlobal, 0xFFFFFFFFL , 0, 0) : 0;
00552 
00553         <span class="keywordflow">if</span>  (!ucFiles)
00554             <span class="keywordflow">return</span>  NOERROR;    <span class="comment">//  Shouldn't happen, but it's not important</span>
00555 
00556         <a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a> idCmd = LOWORD(lpcmi-&gt;lpVerb);
00557 
00558         <span class="comment">// Walk through every selected item to install/uninstall.</span>
00559 
00560         <span class="keywordflow">for</span> (<a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a> u = 0; u &lt; ucFiles; u++) {
00561 
00562             TCHAR   acFile[_MAX_PATH];
00563 
00564             DragQueryFile((HDROP) stgm.hGlobal, u, acFile,
00565                 <span class="keyword">sizeof</span> acFile/ <span class="keyword">sizeof</span> acFile[0]);
00566 
00567             <span class="keywordflow">switch</span> (idCmd) {
00568 
00569                 <span class="keywordflow">case</span>    0: {   <span class="comment">// Install/Uninstall was selected.</span>
00570 
00571                     <span class="comment">// during the installation or un-installation,</span>
00572                     <span class="comment">// change the cursor icon to IDC_APPSTARTING.</span>
00573 
00574                     HCURSOR hCursorOld = <a class="code" href="../../d3/d0/user32_8def.html#a65">SetCursor</a>(LoadCursor(NULL,IDC_APPSTARTING));
00575 
00576                     <a class="code" href="../../d7/d5/classCProfile.html">CProfile</a> csProfile(acFile);
00577 
00578                     <span class="keywordflow">if</span> (<a class="code" href="../../d4/d3/classCICMUserInterface.html#r5">m_bInstalledContext</a>) {
00579 
00580                         <span class="comment">// All selected profile is already installed, then</span>
00581                         <span class="comment">// Uninstall every profile(s) are selected if installed.</span>
00582 
00583                         <span class="keywordflow">if</span> (csProfile.<a class="code" href="../../d7/d5/classCProfile.html#a6">IsInstalled</a>()) {
00584                             csProfile.<a class="code" href="../../d7/d5/classCProfile.html#a15">Uninstall</a>(FALSE); <span class="comment">// never delete file from disk.</span>
00585                         }
00586                     }
00587                     <span class="keywordflow">else</span> {
00588 
00589                         <span class="comment">// Some of selected profile is not installed, then</span>
00590                         <span class="comment">// Install every profile(s) are selected if not installed, yet.</span>
00591 
00592                         <span class="keywordflow">if</span> (!csProfile.<a class="code" href="../../d7/d5/classCProfile.html#a6">IsInstalled</a>()) {
00593                             csProfile.<a class="code" href="../../d7/d5/classCProfile.html#a14">Install</a>();
00594                         }
00595                     }
00596 
00597                     <a class="code" href="../../d3/d0/user32_8def.html#a65">SetCursor</a>(hCursorOld);
00598 
00599                     <span class="keywordflow">break</span>;
00600                 }
00601 
00602                 <span class="keywordflow">case</span>    1: {   <span class="comment">// "Associate..." was selected.</span>
00603 
00604                     <a class="code" href="../../d1/d7/classCString.html">CString</a> csProfileName;
00605 
00606                     <span class="comment">// Get profile "friendly" name.</span>
00607                     {
00608                         <a class="code" href="../../d7/d5/classCProfile.html">CProfile</a> csProfile(acFile);
00609                         csProfileName = csProfile.<a class="code" href="../../d7/d5/classCProfile.html#a2">GetName</a>();
00610                     } <span class="comment">// de-constructer for csProfile should be here.</span>
00611 
00612                     <span class="comment">// Create PropertySheet with "Profile Information" and</span>
00613                     <span class="comment">// "Associate Device" pages</span>
00614 
00615                     PROPSHEETHEADER psh;
00616                     HPROPSHEETPAGE  hpsp[2];
00617 
00618                     <a class="code" href="../../d0/d6/classCProfileInformationPage.html">CProfileInformationPage</a> *pcpip =                       
00619                         <span class="keyword">new</span> <a class="code" href="../../d0/d6/classCProfileInformationPage.html">CProfileInformationPage</a>(CGlobals::Instance(), acFile);
00620                     <a class="code" href="../../d9/d5/classCProfileAssociationPage.html">CProfileAssociationPage</a> *pcpap =
00621                         <span class="keyword">new</span> <a class="code" href="../../d9/d5/classCProfileAssociationPage.html">CProfileAssociationPage</a>(CGlobals::Instance(), acFile);
00622                     <span class="keywordflow">if</span>( (pcpip!=<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)&amp;&amp;(pcpap!=<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) ) {    
00623                         hpsp[0] = pcpip-&gt;<a class="code" href="../../d2/d6/classCPropertyPage.html#a2">Handle</a>();
00624                         hpsp[1] = pcpap-&gt;<a class="code" href="../../d2/d6/classCPropertyPage.html#a2">Handle</a>();
00625     
00626                         ZeroMemory(&amp;psh, <span class="keyword">sizeof</span>(PROPSHEETHEADER));
00627     
00628                         <span class="comment">// fill the property sheet structure.</span>
00629     
00630                         psh.dwSize = <span class="keyword">sizeof</span>(PROPSHEETHEADER);
00631                         psh.hInstance = <a class="code" href="../../d0/d3/classCGlobals.html#e4">CGlobals::Instance</a>();
00632                         psh.hwndParent = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00633                         psh.nStartPage = 1; <span class="comment">// Active "Associate Device" page.</span>
00634                         psh.nPages = 2;
00635                         psh.phpage = hpsp;
00636                         psh.pszCaption = csProfileName;
00637     
00638                         PropertySheet(&amp;psh);
00639     
00640                         <span class="keyword">delete</span> pcpip; <span class="keyword">delete</span> pcpap;
00641                         <span class="keywordflow">break</span>;
00642                     } <span class="keywordflow">else</span> {
00643                       <span class="keywordflow">if</span>(pcpip) <span class="keyword">delete</span> pcpip;
00644                       <span class="keywordflow">if</span>(pcpap) <span class="keyword">delete</span> pcpap;
00645                       <span class="keywordflow">return</span> E_OUTOFMEMORY;
00646                     }
00647                 }
00648             } <span class="comment">// switch (idCmd)</span>
00649         } <span class="comment">// for (UINT u = 0; u &lt; ucFiles; u++)</span>
00650     } <span class="comment">// if (!HIWORD(lpcmi-&gt;lpVerb))</span>
00651 
00652     <span class="keywordflow">return</span> NOERROR;
00653 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a12" doxytag="CICMUserInterface::IsDirty" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> STDMETHODIMP CICMUserInterface::IsDirty           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [inline]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d8/shellext_8h-source.html#l00179">179</a> of file <a class="el" href="../../d0/d8/shellext_8h-source.html">shellext.h</a>.
<p>
<pre class="fragment"><div>00179 { <span class="keywordflow">return</span> S_FALSE; }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a13" doxytag="CICMUserInterface::Load" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> STDMETHODIMP CICMUserInterface::Load           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">LPCOLESTR&nbsp;</td>
          <td class="mdname" nowrap> <em>lpszFileName</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>grfMode</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00412">412</a> of file <a class="el" href="../../d9/d7/shellext_8cpp-source.html">shellext.cpp</a>.
<p>
References <a class="el" href="../../d5/d6/stringar_8h-source.html#l00063">CString::IsEmpty()</a>, <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00412">Load()</a>, and <a class="el" href="../../d0/d8/shellext_8h-source.html#l00106">m_csFile</a>.
<p>
Referenced by <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00412">Load()</a>.
<p>
<pre class="fragment"><div>00413                                                       {
00414     <span class="comment">//  This interface is used to initialize the icon handler- it will</span>
00415     <span class="comment">//  receive the profile name, which we will save for later use.</span>
00416     <span class="comment">//  The CString assigment operator handles any encoding converions needed</span>
00417     <span class="comment">//  encoding conversions for us.</span>
00418 
00419     <a class="code" href="../../d4/d3/classCICMUserInterface.html#r2">m_csFile</a> = lpwstrFileName;
00420 
00421     <span class="keywordflow">return</span>  <a class="code" href="../../d4/d3/classCICMUserInterface.html#r2">m_csFile</a>.<a class="code" href="../../d1/d7/classCString.html#a5">IsEmpty</a>() ? E_OUTOFMEMORY : NO_ERROR;
00422 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a5" doxytag="CICMUserInterface::QueryContextMenu" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> STDMETHODIMP CICMUserInterface::QueryContextMenu           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HMENU&nbsp;</td>
          <td class="mdname" nowrap> <em>hMenu</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>indexMenu</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>idCmdFirst</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>idCmdLast</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>uFlags</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00426">426</a> of file <a class="el" href="../../d9/d7/shellext_8cpp-source.html">shellext.cpp</a>.
<p>
References <a class="el" href="../../d3/d8/ntgdi_2icm_2icmui_2resource_8h-source.html#l00029">AssociateMenuString</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d7/d6/aug98_2dll32_2icmdll_8h-source.html#l00010">FAR</a>, <a class="el" href="../../d3/d8/ntgdi_2icm_2icmui_2resource_8h-source.html#l00027">InstallProfileMenuString</a>, <a class="el" href="../../d4/d6/stringar_8cpp-source.html#l00189">CString::Load()</a>, <a class="el" href="../../d0/d8/shellext_8h-source.html#l00110">m_bInstalledContext</a>, <a class="el" href="../../d0/d8/shellext_8h-source.html#l00110">m_bMultiSelection</a>, <a class="el" href="../../d0/d8/shellext_8h-source.html#l00105">m_lpdoTarget</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00426">QueryContextMenu()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d0/d5/ndismain_8h-source.html#l00026">UINT</a>, and <a class="el" href="../../d3/d8/ntgdi_2icm_2icmui_2resource_8h-source.html#l00028">UninstallProfileMenuString</a>.
<p>
Referenced by <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00426">QueryContextMenu()</a>.
<p>
<pre class="fragment"><div>00428                                                                  {
00429 
00430     <span class="comment">//  Only CMF_NORMAL and CMF_EXPLORE case will be handled.</span>
00431     <span class="comment">//</span>
00432     <span class="comment">//  CMF_CANRENAME     -  This flag is set if the calling application supports</span>
00433     <span class="comment">//                      renaming of items. A context menu extension or drag-and-drop</span>
00434     <span class="comment">//                      handler should ignore this flag. A namespace extension should</span>
00435     <span class="comment">//                      add a rename item to the menu if applicable.</span>
00436     <span class="comment">//  CMF_DEFAULTONLY   -  This flag is set when the user is activating the default action,</span>
00437     <span class="comment">//                      typically by double-clicking. This flag provides a hint for the</span>
00438     <span class="comment">//                      context menu extension to add nothing if it does not modify the</span>
00439     <span class="comment">//                      default item in the menu. A context menu extension or drag-and-drop</span>
00440     <span class="comment">//                      handler should not add any menu items if this value is specified.</span>
00441     <span class="comment">//                      A namespace extension should add only the default item (if any).</span>
00442     <span class="comment">//  CMF_EXPLORE       -  This flag is set when Windows Explorer's tree window is present.</span>
00443     <span class="comment">//                      Context menu handlers should ignore this value.</span>
00444     <span class="comment">//  CMF_INCLUDESTATIC -  This flag is set when a static menu is being constructed.</span>
00445     <span class="comment">//                      Only the browser should use this flag. All other context menu</span>
00446     <span class="comment">//                      extensions should ignore this flag.</span>
00447     <span class="comment">//  CMF_NODEFAULT     -  This flag is set if no item in the menu should be the default item.</span>
00448     <span class="comment">//                      A context menu extension or drag-and-drop handler should ignore this</span>
00449     <span class="comment">//                      flag. A namespace extension should not set any of the menu items to</span>
00450     <span class="comment">//                      the default.</span>
00451     <span class="comment">//  CMF_NORMAL        -  Indicates normal operation. A context menu extension, namespace extension,</span>
00452     <span class="comment">//                      or drag-and-drop handler can add all menu items.</span>
00453     <span class="comment">//  CMF_NOVERBS       -  This flag is set for items displayed in the "Send To:" menu.</span>
00454     <span class="comment">//                      Context menu handlers should ignore this value.</span>
00455     <span class="comment">//  CMF_VERBSONLY     -  This flag is set if the context menu is for a shortcut object.</span>
00456     <span class="comment">//                      Context menu handlers should ignore this value.</span>
00457 
00458     <span class="keywordflow">if</span> (((uFlags &amp; 0x000F) == CMF_NORMAL) || (uFlags &amp; CMF_EXPLORE))
00459     {
00460         <span class="comment">//</span>
00461         <span class="comment">//  Load the profile(s) in the list.</span>
00462         <span class="comment">//</span>
00463         FORMATETC       fmte = {CF_HDROP, (DVTARGETDEVICE <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a5">FAR</a> *)<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>,
00464                                 DVASPECT_CONTENT, -1, TYMED_HGLOBAL };
00465         STGMEDIUM       stgm;
00466         HRESULT         hres = <a class="code" href="../../d4/d3/classCICMUserInterface.html#r1">m_lpdoTarget</a> ?
00467                                <a class="code" href="../../d4/d3/classCICMUserInterface.html#r1">m_lpdoTarget</a> -&gt; GetData(&amp;fmte, &amp;stgm) : 0;
00468 
00469         <span class="keywordflow">if</span>  (!SUCCEEDED(hres))
00470             <span class="keywordflow">return</span>  NOERROR;    <span class="comment">//  Why bother reporting a failure, here?</span>
00471 
00472         <a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a>    ucFiles = stgm.hGlobal ?
00473             DragQueryFile((HDROP) stgm.hGlobal, 0xFFFFFFFFL , 0, 0) : 0;
00474 
00475         <span class="keywordflow">if</span>  (!ucFiles)
00476             <span class="keywordflow">return</span>  NOERROR;    <span class="comment">//  Shouldn't happen, but it's not important</span>
00477         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ucFiles == 1)
00478             <a class="code" href="../../d4/d3/classCICMUserInterface.html#r6">m_bMultiSelection</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00479         <span class="keywordflow">else</span>
00480             <a class="code" href="../../d4/d3/classCICMUserInterface.html#r6">m_bMultiSelection</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00481 
00482         <span class="comment">// Assume in installed context, but we will scan the selected item</span>
00483         <span class="comment">// is really installed everything.</span>
00484 
00485         <a class="code" href="../../d4/d3/classCICMUserInterface.html#r5">m_bInstalledContext</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00486 
00487         TCHAR   acFile[_MAX_PATH];
00488 
00489         <span class="keywordflow">for</span> (<a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a> u = 0; u &lt; ucFiles; u++) {
00490 
00491             DragQueryFile((HDROP) stgm.hGlobal, u, acFile,
00492                 <span class="keyword">sizeof</span> acFile/ <span class="keyword">sizeof</span> acFile[0]);
00493 
00494             <a class="code" href="../../d1/d7/classCString.html">CString</a> csFile = acFile;
00495 
00496             <a class="code" href="../../d4/d3/classCICMUserInterface.html#r5">m_bInstalledContext</a> = (<a class="code" href="../../d4/d3/classCICMUserInterface.html#r5">m_bInstalledContext</a> &amp;&amp; <a class="code" href="../../d0/d3/classCGlobals.html#e8">CGlobals::IsInstalled</a>(csFile));
00497         }
00498 
00499         <a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a> idCmd = idCmdFirst;
00500 
00501         <a class="code" href="../../d1/d7/classCString.html">CString</a> csInstallMenu, csAssociateMenu;
00502 
00503         <span class="comment">//  If every profile(s) are already installed on this system,</span>
00504         <span class="comment">//  display "Uninstall Profile", otherwise display "Install Profile"</span>
00505 
00506         csInstallMenu.<a class="code" href="../../d1/d7/classCString.html#a16">Load</a>(m_bInstalledContext ? UninstallProfileMenuString : InstallProfileMenuString);
00507         ::InsertMenu(hMenu,indexMenu,MF_STRING|MF_BYPOSITION,idCmd,csInstallMenu);
00508 
00509         <span class="comment">//  Set "Install Profile" or "Uninstall Profile" as default.</span>
00510 
00511         SetMenuDefaultItem(hMenu,indexMenu,TRUE);
00512 
00513         <span class="comment">//  Increment Menu pos. and item id.</span>
00514 
00515         indexMenu++; idCmd++;
00516 
00517         <span class="comment">//  Add "Associate..." menu item</span>
00518 
00519         csAssociateMenu.<a class="code" href="../../d1/d7/classCString.html#a16">Load</a>(AssociateMenuString);
00520         ::InsertMenu(hMenu,indexMenu++,MF_STRING|MF_BYPOSITION,idCmd++,csAssociateMenu);
00521 
00522         <span class="comment">//  But if we have multi selection, disable "Associate..."</span>
00523 
00524         <span class="keywordflow">if</span> (<a class="code" href="../../d4/d3/classCICMUserInterface.html#r6">m_bMultiSelection</a>)
00525             ::EnableMenuItem(hMenu,(idCmd-1),MF_GRAYED);
00526         <span class="keywordflow">return</span> (idCmd - idCmdFirst); <span class="comment">// return number of menu inserted.</span>
00527     }
00528 
00529     <span class="keywordflow">return</span> NOERROR;
00530 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a2" doxytag="CICMUserInterface::QueryInterface" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> STDMETHODIMP CICMUserInterface::QueryInterface           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">REFIID&nbsp;</td>
          <td class="mdname" nowrap>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a5">LPVOID</a> FAR *&nbsp;</td>
          <td class="mdname" nowrap></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a18" doxytag="CICMUserInterface::ReplacePage" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> STDMETHODIMP CICMUserInterface::ReplacePage           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>uPageID</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPFNADDPROPSHEETPAGE&nbsp;</td>
          <td class="mdname" nowrap> <em>lpfnReplaceWith</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPARAM&nbsp;</td>
          <td class="mdname" nowrap> <em>lParam</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [inline]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d8/shellext_8h-source.html#l00196">196</a> of file <a class="el" href="../../d0/d8/shellext_8h-source.html">shellext.h</a>.
<p>
References <a class="el" href="../../d0/d8/shellext_8h-source.html#l00196">ReplacePage()</a>.
<p>
Referenced by <a class="el" href="../../d0/d8/shellext_8h-source.html#l00196">ReplacePage()</a>.
<p>
<pre class="fragment"><div>00198                                                { <span class="keywordflow">return</span> E_FAIL; }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a14" doxytag="CICMUserInterface::Save" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> STDMETHODIMP CICMUserInterface::Save           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">LPCOLESTR&nbsp;</td>
          <td class="mdname" nowrap> <em>lpszFileName</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>BOOL&nbsp;</td>
          <td class="mdname" nowrap> <em>fRemember</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [inline]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d8/shellext_8h-source.html#l00183">183</a> of file <a class="el" href="../../d0/d8/shellext_8h-source.html">shellext.h</a>.
<p>
References <a class="el" href="../../d0/d8/shellext_8h-source.html#l00183">Save()</a>.
<p>
Referenced by <a class="el" href="../../d0/d8/shellext_8h-source.html#l00183">Save()</a>.
<p>
<pre class="fragment"><div>00183                                                                  {
00184         <span class="keywordflow">return</span>  E_FAIL;
00185     }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a15" doxytag="CICMUserInterface::SaveCompleted" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> STDMETHODIMP CICMUserInterface::SaveCompleted           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">LPCOLESTR&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>lpszFileName</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [inline]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d8/shellext_8h-source.html#l00187">187</a> of file <a class="el" href="../../d0/d8/shellext_8h-source.html">shellext.h</a>.
<p>
References <a class="el" href="../../d0/d8/shellext_8h-source.html#l00187">SaveCompleted()</a>.
<p>
Referenced by <a class="el" href="../../d0/d8/shellext_8h-source.html#l00187">SaveCompleted()</a>.
<p>
<pre class="fragment"><div>00187 { <span class="keywordflow">return</span> E_FAIL; }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a4" doxytag="CICMUserInterface::STDMETHODIMP_" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> CICMUserInterface::STDMETHODIMP_           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">ULONG&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [inline]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d8/shellext_8h-source.html#l00141">141</a> of file <a class="el" href="../../d0/d8/shellext_8h-source.html">shellext.h</a>.
<p>
References <a class="el" href="../../d3/d9/aw_8h-source.html#l00031">L</a>, <a class="el" href="../../d0/d8/shellext_8h-source.html#l00104">m_ulcReferences</a>, and <a class="el" href="../../d0/d8/shellext_8h-source.html#l00140">STDMETHODIMP_()</a>.
<p>
<pre class="fragment"><div>00141                                       {
00142         <span class="keywordflow">if</span>  (--<a class="code" href="../../d4/d3/classCICMUserInterface.html#r0">m_ulcReferences</a>) 
00143             <span class="keywordflow">return</span>  <a class="code" href="../../d4/d3/classCICMUserInterface.html#r0">m_ulcReferences</a>;
00144         
00145         <span class="keyword">delete</span>  <span class="keyword">this</span>;
00146         <span class="keywordflow">return</span>  0<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>;
00147     }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="CICMUserInterface::STDMETHODIMP_" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> CICMUserInterface::STDMETHODIMP_           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">ULONG&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [inline]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d8/shellext_8h-source.html#l00140">140</a> of file <a class="el" href="../../d0/d8/shellext_8h-source.html">shellext.h</a>.
<p>
References <a class="el" href="../../d0/d8/shellext_8h-source.html#l00104">m_ulcReferences</a>, and <a class="el" href="../../d0/d8/shellext_8h-source.html#l00140">STDMETHODIMP_()</a>.
<p>
Referenced by <a class="el" href="../../d0/d8/shellext_8h-source.html#l00140">STDMETHODIMP_()</a>.
<p>
<pre class="fragment"><div>00140 { <span class="keywordflow">return</span> ++<a class="code" href="../../d4/d3/classCICMUserInterface.html#r0">m_ulcReferences</a>; }
</div></pre>    </td>
  </tr>
</table>
<hr><h2>Member Data Documentation</h2>
<a class="anchor" name="r3" doxytag="CICMUserInterface::m_acWork" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> TCHAR <a class="el" href="../../d4/d3/classCICMUserInterface.html#r3">CICMUserInterface::m_acWork</a>[80]<code> [private]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d8/shellext_8h-source.html#l00108">108</a> of file <a class="el" href="../../d0/d8/shellext_8h-source.html">shellext.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="r5" doxytag="CICMUserInterface::m_bInstalledContext" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL <a class="el" href="../../d4/d3/classCICMUserInterface.html#r5">CICMUserInterface::m_bInstalledContext</a><code> [private]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d8/shellext_8h-source.html#l00110">110</a> of file <a class="el" href="../../d0/d8/shellext_8h-source.html">shellext.h</a>.
<p>
Referenced by <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00661">GetCommandString()</a>, <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00532">InvokeCommand()</a>, and <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00426">QueryContextMenu()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="r6" doxytag="CICMUserInterface::m_bMultiSelection" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL <a class="el" href="../../d4/d3/classCICMUserInterface.html#r6">CICMUserInterface::m_bMultiSelection</a><code> [private]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d8/shellext_8h-source.html#l00110">110</a> of file <a class="el" href="../../d0/d8/shellext_8h-source.html">shellext.h</a>.
<p>
Referenced by <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00661">GetCommandString()</a>, and <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00426">QueryContextMenu()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="r2" doxytag="CICMUserInterface::m_csFile" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d1/d7/classCString.html">CString</a> <a class="el" href="../../d4/d3/classCICMUserInterface.html#r2">CICMUserInterface::m_csFile</a><code> [private]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d8/shellext_8h-source.html#l00106">106</a> of file <a class="el" href="../../d0/d8/shellext_8h-source.html">shellext.h</a>.
<p>
Referenced by <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00400">Extract()</a>, and <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00412">Load()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="r1" doxytag="CICMUserInterface::m_lpdoTarget" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> LPDATAOBJECT <a class="el" href="../../d4/d3/classCICMUserInterface.html#r1">CICMUserInterface::m_lpdoTarget</a><code> [private]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d8/shellext_8h-source.html#l00105">105</a> of file <a class="el" href="../../d0/d8/shellext_8h-source.html">shellext.h</a>.
<p>
Referenced by <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00772">AddAssociateTab()</a>, <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00816">AddMonitorTab()</a>, <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l01028">AddPrinterTab()</a>, <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00731">AddProfileTab()</a>, <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00893">AddScannerTab()</a>, <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00307">CICMUserInterface()</a>, <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00363">Initialize()</a>, <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00532">InvokeCommand()</a>, <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00426">QueryContextMenu()</a>, and <a class="el" href="../../d0/d8/shellext_8h-source.html#l00131">~CICMUserInterface()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="r0" doxytag="CICMUserInterface::m_ulcReferences" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG <a class="el" href="../../d4/d3/classCICMUserInterface.html#r0">CICMUserInterface::m_ulcReferences</a><code> [private]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d8/shellext_8h-source.html#l00104">104</a> of file <a class="el" href="../../d0/d8/shellext_8h-source.html">shellext.h</a>.
<p>
Referenced by <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00307">CICMUserInterface()</a>, and <a class="el" href="../../d0/d8/shellext_8h-source.html#l00140">STDMETHODIMP_()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="r4" doxytag="CICMUserInterface::m_utThis" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d9/d8/shellext_8h.html#a8">UITYPE</a> <a class="el" href="../../d4/d3/classCICMUserInterface.html#r4">CICMUserInterface::m_utThis</a><code> [private]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d8/shellext_8h-source.html#l00109">109</a> of file <a class="el" href="../../d0/d8/shellext_8h-source.html">shellext.h</a>.
<p>
Referenced by <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00693">AddPages()</a>, and <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00307">CICMUserInterface()</a>.    </td>
  </tr>
</table>
<hr>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="../../d0/d8/shellext_8h-source.html">shellext.h</a><li><a class="el" href="../../d9/d7/shellext_8cpp-source.html">shellext.cpp</a></ul>
<hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:46:27 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
