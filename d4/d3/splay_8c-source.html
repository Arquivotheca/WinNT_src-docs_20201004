<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: splay.c Source File</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>splay.c</h1><a href="../../d3/d4/splay_8c.html">Go to the documentation of this file.</a><pre class="fragment"><div>00001 <span class="comment">/*++</span>
00002 <span class="comment"></span>
00003 <span class="comment">Copyright (c) 1989  Microsoft Corporation</span>
00004 <span class="comment"></span>
00005 <span class="comment">Module Name:</span>
00006 <span class="comment"></span>
00007 <span class="comment">    Splay.c</span>
00008 <span class="comment"></span>
00009 <span class="comment">Abstract:</span>
00010 <span class="comment"></span>
00011 <span class="comment">    This module implements the general splay utilities</span>
00012 <span class="comment"></span>
00013 <span class="comment">Author:</span>
00014 <span class="comment"></span>
00015 <span class="comment">    Gary Kimura     [GaryKi]    23-May-1989</span>
00016 <span class="comment"></span>
00017 <span class="comment">Environment:</span>
00018 <span class="comment"></span>
00019 <span class="comment">    Pure utility routine</span>
00020 <span class="comment"></span>
00021 <span class="comment">Revision History:</span>
00022 <span class="comment"></span>
00023 <span class="comment">--*/</span>
00024 
00025 <span class="preprocessor">#include &lt;nt.h&gt;</span>
00026 
00027 <span class="preprocessor">#include &lt;ntrtl.h&gt;</span>
00028 
<a name="l00029"></a><a class="code" href="../../d3/d4/splay_8c.html#a0">00029</a> <span class="preprocessor">#define SwapPointers(Ptr1, Ptr2) {      \</span>
00030 <span class="preprocessor">    PVOID _SWAP_POINTER_TEMP;           \</span>
00031 <span class="preprocessor">    _SWAP_POINTER_TEMP = (PVOID)(Ptr1); \</span>
00032 <span class="preprocessor">    (Ptr1) = (Ptr2);                    \</span>
00033 <span class="preprocessor">    (Ptr2) = _SWAP_POINTER_TEMP; \</span>
00034 <span class="preprocessor">    }</span>
00035 <span class="preprocessor"></span>
<a name="l00036"></a><a class="code" href="../../d3/d4/splay_8c.html#a1">00036</a> <span class="preprocessor">#define ParentsChildPointerAddress(Links) ( \</span>
00037 <span class="preprocessor">    RtlIsLeftChild(Links) ?                 \</span>
00038 <span class="preprocessor">        &amp;(((Links)-&gt;Parent)-&gt;LeftChild)     \</span>
00039 <span class="preprocessor">    :                                       \</span>
00040 <span class="preprocessor">        &amp;(((Links)-&gt;Parent)-&gt;RightChild)    \</span>
00041 <span class="preprocessor">    )</span>
00042 <span class="preprocessor"></span>
00043 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00044 <a class="code" href="../../d3/d4/splay_8c.html#a2">SwapSplayLinks</a> (
00045     IN PRTL_SPLAY_LINKS Link1,
00046     IN PRTL_SPLAY_LINKS Link2
00047     );
00048 
00049 
00050 PRTL_SPLAY_LINKS
<a name="l00051"></a><a class="code" href="../../d3/d4/splay_8c.html#a3">00051</a> <a class="code" href="../../d3/d4/splay_8c.html#a3">RtlSplay</a> (
00052     IN PRTL_SPLAY_LINKS Links
00053     )
00054 
00055 <span class="comment">/*++</span>
00056 <span class="comment"></span>
00057 <span class="comment">Routine Description:</span>
00058 <span class="comment"></span>
00059 <span class="comment">    The Splay function takes as input a pointer to a splay link in a tree</span>
00060 <span class="comment">    and splays the tree.  Its function return value is a pointer to the</span>
00061 <span class="comment">    root of the splayed tree.</span>
00062 <span class="comment"></span>
00063 <span class="comment">Arguments:</span>
00064 <span class="comment"></span>
00065 <span class="comment">    Links - Supplies a pointer to a splay link in a tree.</span>
00066 <span class="comment"></span>
00067 <span class="comment">Return Value:</span>
00068 <span class="comment"></span>
00069 <span class="comment">    PRTL_SPLAY_LINKS - returns a pointer to the root of the splayed tree.</span>
00070 <span class="comment"></span>
00071 <span class="comment">--*/</span>
00072 
00073 {
00074     PRTL_SPLAY_LINKS <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>;
00075     PRTL_SPLAY_LINKS P;
00076     PRTL_SPLAY_LINKS G;
00077 
00078     <span class="comment">//</span>
00079     <span class="comment">//  while links is not the root we need to keep rotating it toward</span>
00080     <span class="comment">//  the root</span>
00081     <span class="comment">//</span>
00082 
00083     <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a> = Links;
00084 
00085     <span class="keywordflow">while</span> (!RtlIsRoot(<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>)) {
00086 
00087         P = RtlParent(<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>);
00088         G = RtlParent(P);
00089 
00090         <span class="keywordflow">if</span> (RtlIsLeftChild(<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>)) {
00091 
00092             <span class="keywordflow">if</span> (RtlIsRoot(P)) {
00093 
00094                 <span class="comment">/*</span>
00095 <span class="comment">                  we have the following case</span>
00096 <span class="comment"></span>
00097 <span class="comment">                          P           L</span>
00098 <span class="comment">                         / \         / \</span>
00099 <span class="comment">                        L   c  ==&gt;  a   P</span>
00100 <span class="comment">                       / \             / \</span>
00101 <span class="comment">                      a   b           b   c</span>
00102 <span class="comment">                */</span>
00103 
00104                 <span class="comment">//</span>
00105                 <span class="comment">//  Connect P &amp; b</span>
00106                 <span class="comment">//</span>
00107 
00108                 P-&gt;LeftChild = <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>-&gt;RightChild;
00109                 <span class="keywordflow">if</span> (P-&gt;LeftChild != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {P-&gt;LeftChild-&gt;Parent = P;}
00110 
00111                 <span class="comment">//</span>
00112                 <span class="comment">//  Connect L &amp; P</span>
00113                 <span class="comment">//</span>
00114 
00115                 <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>-&gt;RightChild = P;
00116                 P-&gt;Parent = <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>;
00117 
00118                 <span class="comment">//</span>
00119                 <span class="comment">//  Make L the root</span>
00120                 <span class="comment">//</span>
00121 
00122                 <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>-&gt;Parent = <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>;
00123 
00124             } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (RtlIsLeftChild(P)) {
00125 
00126                 <span class="comment">/*</span>
00127 <span class="comment">                  we have the following case</span>
00128 <span class="comment"></span>
00129 <span class="comment">                          |           |</span>
00130 <span class="comment">                          G           L</span>
00131 <span class="comment">                         / \         / \</span>
00132 <span class="comment">                        P   d  ==&gt;  a   P</span>
00133 <span class="comment">                       / \             / \</span>
00134 <span class="comment">                      L   c           b   G</span>
00135 <span class="comment">                     / \                 / \</span>
00136 <span class="comment">                    a   b               c   d</span>
00137 <span class="comment">                */</span>
00138 
00139                 <span class="comment">//</span>
00140                 <span class="comment">//  Connect P &amp; b</span>
00141                 <span class="comment">//</span>
00142 
00143                 P-&gt;LeftChild = <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>-&gt;RightChild;
00144                 <span class="keywordflow">if</span> (P-&gt;LeftChild != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {P-&gt;LeftChild-&gt;Parent = P;}
00145 
00146                 <span class="comment">//</span>
00147                 <span class="comment">//  Connect G &amp; c</span>
00148                 <span class="comment">//</span>
00149 
00150                 G-&gt;LeftChild = P-&gt;RightChild;
00151                 <span class="keywordflow">if</span> (G-&gt;LeftChild != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {G-&gt;LeftChild-&gt;Parent = G;}
00152 
00153                 <span class="comment">//</span>
00154                 <span class="comment">//  Connect L &amp; Great GrandParent</span>
00155                 <span class="comment">//</span>
00156 
00157                 <span class="keywordflow">if</span> (RtlIsRoot(G)) {
00158                     <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>-&gt;Parent = <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>;
00159                 } <span class="keywordflow">else</span> {
00160                     <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>-&gt;Parent = G-&gt;Parent;
00161                     *(<a class="code" href="../../d3/d4/splay_8c.html#a1">ParentsChildPointerAddress</a>(G)) = <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>;
00162                 }
00163 
00164                 <span class="comment">//</span>
00165                 <span class="comment">//  Connect L &amp; P</span>
00166                 <span class="comment">//</span>
00167 
00168                 <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>-&gt;RightChild = P;
00169                 P-&gt;Parent = <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>;
00170 
00171                 <span class="comment">//</span>
00172                 <span class="comment">//  Connect P &amp; G</span>
00173                 <span class="comment">//</span>
00174 
00175                 P-&gt;RightChild = G;
00176                 G-&gt;Parent = P;
00177 
00178             } <span class="keywordflow">else</span> { <span class="comment">// RtlIsRightChild(Parent)</span>
00179 
00180                 <span class="comment">/*</span>
00181 <span class="comment">                  we have the following case</span>
00182 <span class="comment"></span>
00183 <span class="comment">                        |                |</span>
00184 <span class="comment">                        G                L</span>
00185 <span class="comment">                       / \             /   \</span>
00186 <span class="comment">                      a   P           G     P</span>
00187 <span class="comment">                         / \         / \   / \</span>
00188 <span class="comment">                        L   d  ==&gt;  a   b c   d</span>
00189 <span class="comment">                       / \</span>
00190 <span class="comment">                      b   c</span>
00191 <span class="comment">                */</span>
00192 
00193                 <span class="comment">//</span>
00194                 <span class="comment">//  Connect G &amp; b</span>
00195                 <span class="comment">//</span>
00196 
00197                 G-&gt;RightChild = <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>-&gt;LeftChild;
00198                 <span class="keywordflow">if</span> (G-&gt;RightChild != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {G-&gt;RightChild-&gt;Parent = G;}
00199 
00200                 <span class="comment">//</span>
00201                 <span class="comment">//  Connect P &amp; c</span>
00202                 <span class="comment">//</span>
00203 
00204                 P-&gt;LeftChild = <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>-&gt;RightChild;
00205                 <span class="keywordflow">if</span> (P-&gt;LeftChild != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {P-&gt;LeftChild-&gt;Parent = P;}
00206 
00207                 <span class="comment">//</span>
00208                 <span class="comment">//  Connect L &amp; Great GrandParent</span>
00209                 <span class="comment">//</span>
00210 
00211                 <span class="keywordflow">if</span> (RtlIsRoot(G)) {
00212                     <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>-&gt;Parent = <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>;
00213                 } <span class="keywordflow">else</span> {
00214                     <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>-&gt;Parent = G-&gt;Parent;
00215                     *(<a class="code" href="../../d3/d4/splay_8c.html#a1">ParentsChildPointerAddress</a>(G)) = <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>;
00216                 }
00217 
00218                 <span class="comment">//</span>
00219                 <span class="comment">//  Connect L &amp; G</span>
00220                 <span class="comment">//</span>
00221 
00222                 <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>-&gt;LeftChild = G;
00223                 G-&gt;Parent = <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>;
00224 
00225                 <span class="comment">//</span>
00226                 <span class="comment">//  Connect L &amp; P</span>
00227                 <span class="comment">//</span>
00228 
00229                 <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>-&gt;RightChild = P;
00230                 P-&gt;Parent = <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>;
00231 
00232             }
00233 
00234         } <span class="keywordflow">else</span> { <span class="comment">// RtlIsRightChild(L)</span>
00235 
00236             <span class="keywordflow">if</span> (RtlIsRoot(P)) {
00237 
00238                 <span class="comment">/*</span>
00239 <span class="comment">                  we have the following case</span>
00240 <span class="comment"></span>
00241 <span class="comment">                        P               L</span>
00242 <span class="comment">                       / \             / \</span>
00243 <span class="comment">                      a   L           P   c</span>
00244 <span class="comment">                         / \         / \</span>
00245 <span class="comment">                        b   c  ==&gt;  a   b</span>
00246 <span class="comment">                */</span>
00247 
00248                 <span class="comment">//</span>
00249                 <span class="comment">//  Connect P &amp; b</span>
00250                 <span class="comment">//</span>
00251 
00252                 P-&gt;RightChild = <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>-&gt;LeftChild;
00253                 <span class="keywordflow">if</span> (P-&gt;RightChild != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {P-&gt;RightChild-&gt;Parent = P;}
00254 
00255                 <span class="comment">//</span>
00256                 <span class="comment">//  Connect P &amp; L</span>
00257                 <span class="comment">//</span>
00258 
00259                 <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>-&gt;LeftChild = P;
00260                 P-&gt;Parent = <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>;
00261 
00262                 <span class="comment">//</span>
00263                 <span class="comment">//  Make L the root</span>
00264                 <span class="comment">//</span>
00265 
00266                 <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>-&gt;Parent = <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>;
00267 
00268             } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (RtlIsRightChild(P)) {
00269 
00270                 <span class="comment">/*</span>
00271 <span class="comment">                  we have the following case</span>
00272 <span class="comment"></span>
00273 <span class="comment">                      |                   |</span>
00274 <span class="comment">                      G                   L</span>
00275 <span class="comment">                     / \                 / \</span>
00276 <span class="comment">                    a   P               P   d</span>
00277 <span class="comment">                       / \             / \</span>
00278 <span class="comment">                      b   L           G   c</span>
00279 <span class="comment">                         / \         / \</span>
00280 <span class="comment">                        c   d  ==&gt;  a   b</span>
00281 <span class="comment">                */</span>
00282 
00283                 <span class="comment">//</span>
00284                 <span class="comment">//  Connect G &amp; b</span>
00285                 <span class="comment">//</span>
00286 
00287                 G-&gt;RightChild = P-&gt;LeftChild;
00288                 <span class="keywordflow">if</span> (G-&gt;RightChild != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {G-&gt;RightChild-&gt;Parent = G;}
00289 
00290                 <span class="comment">//</span>
00291                 <span class="comment">//  Connect P &amp; c</span>
00292                 <span class="comment">//</span>
00293 
00294                 P-&gt;RightChild = <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>-&gt;LeftChild;
00295                 <span class="keywordflow">if</span> (P-&gt;RightChild != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {P-&gt;RightChild-&gt;Parent = P;}
00296 
00297                 <span class="comment">//</span>
00298                 <span class="comment">//  Connect L &amp; Great GrandParent</span>
00299                 <span class="comment">//</span>
00300 
00301                 <span class="keywordflow">if</span> (RtlIsRoot(G)) {
00302                     <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>-&gt;Parent = <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>;
00303                 } <span class="keywordflow">else</span> {
00304                     <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>-&gt;Parent = G-&gt;Parent;
00305                     *(<a class="code" href="../../d3/d4/splay_8c.html#a1">ParentsChildPointerAddress</a>(G)) = <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>;
00306                 }
00307 
00308                 <span class="comment">//</span>
00309                 <span class="comment">//  Connect L &amp; P</span>
00310                 <span class="comment">//</span>
00311 
00312                 <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>-&gt;LeftChild = P;
00313                 P-&gt;Parent = <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>;
00314 
00315                 <span class="comment">//</span>
00316                 <span class="comment">//  Connect P &amp; G</span>
00317                 <span class="comment">//</span>
00318 
00319                 P-&gt;LeftChild = G;
00320                 G-&gt;Parent = P;
00321 
00322             } <span class="keywordflow">else</span> { <span class="comment">// RtlIsLeftChild(P)</span>
00323 
00324                 <span class="comment">/*</span>
00325 <span class="comment">                  we have the following case</span>
00326 <span class="comment"></span>
00327 <span class="comment">                          |              |</span>
00328 <span class="comment">                          G              L</span>
00329 <span class="comment">                         / \           /   \</span>
00330 <span class="comment">                        P   d         P     G</span>
00331 <span class="comment">                       / \           / \   / \</span>
00332 <span class="comment">                      a   L    ==&gt;  a   b c   d</span>
00333 <span class="comment">                         / \</span>
00334 <span class="comment">                        b   c</span>
00335 <span class="comment">                */</span>
00336 
00337                 <span class="comment">//</span>
00338                 <span class="comment">//  Connect P &amp; b</span>
00339                 <span class="comment">//</span>
00340 
00341                 P-&gt;RightChild = <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>-&gt;LeftChild;
00342                 <span class="keywordflow">if</span> (P-&gt;RightChild != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {P-&gt;RightChild-&gt;Parent = P;}
00343 
00344                 <span class="comment">//</span>
00345                 <span class="comment">//  Connect G &amp; c</span>
00346                 <span class="comment">//</span>
00347 
00348                 G-&gt;LeftChild = <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>-&gt;RightChild;
00349                 <span class="keywordflow">if</span> (G-&gt;LeftChild != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {G-&gt;LeftChild-&gt;Parent = G;}
00350 
00351                 <span class="comment">//</span>
00352                 <span class="comment">//  Connect L &amp; Great GrandParent</span>
00353                 <span class="comment">//</span>
00354 
00355                 <span class="keywordflow">if</span> (RtlIsRoot(G)) {
00356                     <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>-&gt;Parent = <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>;
00357                 } <span class="keywordflow">else</span> {
00358                     <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>-&gt;Parent = G-&gt;Parent;
00359                     *(<a class="code" href="../../d3/d4/splay_8c.html#a1">ParentsChildPointerAddress</a>(G)) = <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>;
00360                 }
00361 
00362                 <span class="comment">//</span>
00363                 <span class="comment">//  Connect L &amp; P</span>
00364                 <span class="comment">//</span>
00365 
00366                 <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>-&gt;LeftChild = P;
00367                 P-&gt;Parent = <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>;
00368 
00369                 <span class="comment">//</span>
00370                 <span class="comment">//  Connect L &amp; G</span>
00371                 <span class="comment">//</span>
00372 
00373                 <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>-&gt;RightChild = G;
00374                 G-&gt;Parent = <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>;
00375 
00376             }
00377         }
00378     }
00379 
00380     <span class="keywordflow">return</span> <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>;
00381 }
00382 
00383 
00384 PRTL_SPLAY_LINKS
<a name="l00385"></a><a class="code" href="../../d3/d4/splay_8c.html#a4">00385</a> <a class="code" href="../../d3/d4/splay_8c.html#a4">RtlDelete</a> (
00386     IN PRTL_SPLAY_LINKS Links
00387     )
00388 
00389 <span class="comment">/*++</span>
00390 <span class="comment"></span>
00391 <span class="comment">Routine Description:</span>
00392 <span class="comment"></span>
00393 <span class="comment">    The Delete function takes as input a pointer to a splay link in a tree</span>
00394 <span class="comment">    and deletes that node from the tree.  Its function return value is a</span>
00395 <span class="comment">    pointer to the root of the tree.  If the tree is now empty, the return</span>
00396 <span class="comment">    value is NULL.</span>
00397 <span class="comment"></span>
00398 <span class="comment">Arguments:</span>
00399 <span class="comment"></span>
00400 <span class="comment">    Links - Supplies a pointer to a splay link in a tree.</span>
00401 <span class="comment"></span>
00402 <span class="comment">Return Value:</span>
00403 <span class="comment"></span>
00404 <span class="comment">    PRTL_SPLAY_LINKS - returns a pointer to the root of the tree.</span>
00405 <span class="comment"></span>
00406 <span class="comment">--*/</span>
00407 
00408 {
00409     PRTL_SPLAY_LINKS Predecessor;
00410     PRTL_SPLAY_LINKS Parent;
00411     PRTL_SPLAY_LINKS Child;
00412 
00413     PRTL_SPLAY_LINKS *ParentChildPtr;
00414 
00415     <span class="comment">//</span>
00416     <span class="comment">//  First check to see if Links as two children.  If it does then swap</span>
00417     <span class="comment">//  Links with its subtree predecessor.  Now we are guaranteed that Links</span>
00418     <span class="comment">//  has at most one child.</span>
00419     <span class="comment">//</span>
00420 
00421     <span class="keywordflow">if</span> ((RtlLeftChild(Links) != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) &amp;&amp; (RtlRightChild(Links) != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)) {
00422 
00423         <span class="comment">//</span>
00424         <span class="comment">//  get the predecessor, and swap their position in the tree</span>
00425         <span class="comment">//</span>
00426 
00427         Predecessor = <a class="code" href="../../d3/d4/splay_8c.html#a7">RtlSubtreePredecessor</a>(Links);
00428         <a class="code" href="../../d3/d4/splay_8c.html#a2">SwapSplayLinks</a>(Predecessor, Links);
00429 
00430     }
00431 
00432     <span class="comment">//</span>
00433     <span class="comment">//  If Links has no children then delete links by checking if it is</span>
00434     <span class="comment">//  already the root or has a parent.  If it is the root then the</span>
00435     <span class="comment">//  tree is now empty, otherwise it set the appropriate parent's child</span>
00436     <span class="comment">//  pointer (i.e., the one to links) to NULL, and splay the parent.</span>
00437     <span class="comment">//</span>
00438 
00439     <span class="keywordflow">if</span> ((RtlLeftChild(Links) == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) &amp;&amp; (RtlRightChild(Links) == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)) {
00440 
00441         <span class="comment">//</span>
00442         <span class="comment">//  Links has no children, if it is the root then return NULL</span>
00443         <span class="comment">//</span>
00444 
00445         <span class="keywordflow">if</span> (RtlIsRoot(Links)) {
00446 
00447             <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00448         }
00449 
00450         <span class="comment">//</span>
00451         <span class="comment">//  Links as not children and is not the root, so to the parent's</span>
00452         <span class="comment">//  child pointer to NULL and splay the parent.</span>
00453         <span class="comment">//</span>
00454 
00455         Parent = RtlParent(Links);
00456 
00457         ParentChildPtr = <a class="code" href="../../d3/d4/splay_8c.html#a1">ParentsChildPointerAddress</a>(Links);
00458         *ParentChildPtr = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00459 
00460         <span class="keywordflow">return</span> <a class="code" href="../../d3/d4/splay_8c.html#a3">RtlSplay</a>(Parent);
00461 
00462     }
00463 
00464     <span class="comment">//</span>
00465     <span class="comment">//  otherwise Links has one child.  If it is the root then make the child</span>
00466     <span class="comment">//  the new root, otherwise link together the child and parent, and splay</span>
00467     <span class="comment">//  the parent.  But first remember who our child is.</span>
00468     <span class="comment">//</span>
00469 
00470     <span class="keywordflow">if</span> (RtlLeftChild(Links) != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00471         Child = RtlLeftChild(Links);
00472     } <span class="keywordflow">else</span> {
00473         Child = RtlRightChild(Links);
00474     }
00475 
00476     <span class="comment">//</span>
00477     <span class="comment">//  If links is the root then we make the child the root and return the</span>
00478     <span class="comment">//  child.</span>
00479     <span class="comment">//</span>
00480 
00481     <span class="keywordflow">if</span> (RtlIsRoot(Links)) {
00482         Child-&gt;Parent = Child;
00483         <span class="keywordflow">return</span> Child;
00484     }
00485 
00486     <span class="comment">//</span>
00487     <span class="comment">//  Links is not the root, so set link's parent child pointer to be</span>
00488     <span class="comment">//  the child and the set child's parent to be link's parent, and splay</span>
00489     <span class="comment">//  the parent.</span>
00490     <span class="comment">//</span>
00491 
00492     ParentChildPtr = <a class="code" href="../../d3/d4/splay_8c.html#a1">ParentsChildPointerAddress</a>(Links);
00493     *ParentChildPtr = Child;
00494     Child-&gt;Parent = Links-&gt;Parent;
00495 
00496     <span class="keywordflow">return</span> <a class="code" href="../../d3/d4/splay_8c.html#a3">RtlSplay</a>(RtlParent(Child));
00497 
00498 }
00499 
00500 
00501 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
<a name="l00502"></a><a class="code" href="../../d3/d4/splay_8c.html#a5">00502</a> <a class="code" href="../../d3/d4/splay_8c.html#a5">RtlDeleteNoSplay</a> (
00503     IN PRTL_SPLAY_LINKS Links,
00504     IN OUT PRTL_SPLAY_LINKS *Root
00505     )
00506 
00507 <span class="comment">/*++</span>
00508 <span class="comment"></span>
00509 <span class="comment">Routine Description:</span>
00510 <span class="comment"></span>
00511 <span class="comment">    The Delete function takes as input a pointer to a splay link in a tree,</span>
00512 <span class="comment">    a pointer to the callers pointer to the tree and deletes that node from</span>
00513 <span class="comment">    the tree.  The caller's pointer is updated upon return.  If the tree is</span>
00514 <span class="comment">    now empty, the value is NULL.</span>
00515 <span class="comment"></span>
00516 <span class="comment">    Unfortunately, the original RtlDelete() always splays and this is not</span>
00517 <span class="comment">    always a desireable side-effect.</span>
00518 <span class="comment"></span>
00519 <span class="comment">Arguments:</span>
00520 <span class="comment"></span>
00521 <span class="comment">    Links - Supplies a pointer to a splay link in a tree.</span>
00522 <span class="comment"></span>
00523 <span class="comment">    Root - Pointer to the callers pointer to the root </span>
00524 <span class="comment"></span>
00525 <span class="comment">Return Value:</span>
00526 <span class="comment"></span>
00527 <span class="comment">    None</span>
00528 <span class="comment"></span>
00529 <span class="comment">--*/</span>
00530 
00531 {
00532     PRTL_SPLAY_LINKS Predecessor;
00533     PRTL_SPLAY_LINKS Parent;
00534     PRTL_SPLAY_LINKS Child;
00535 
00536     PRTL_SPLAY_LINKS *ParentChildPtr;
00537 
00538     <span class="comment">//</span>
00539     <span class="comment">//  First check to see if Links as two children.  If it does then swap</span>
00540     <span class="comment">//  Links with its subtree predecessor.  Now we are guaranteed that Links</span>
00541     <span class="comment">//  has at most one child.</span>
00542     <span class="comment">//</span>
00543 
00544     <span class="keywordflow">if</span> ((RtlLeftChild(Links) != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) &amp;&amp; (RtlRightChild(Links) != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)) {
00545 
00546         <span class="comment">//</span>
00547         <span class="comment">//  get the predecessor, and swap their position in the tree</span>
00548         <span class="comment">//</span>
00549 
00550         Predecessor = <a class="code" href="../../d3/d4/splay_8c.html#a7">RtlSubtreePredecessor</a>(Links);
00551 
00552         <span class="keywordflow">if</span> (RtlIsRoot(Links)) {
00553 
00554             <span class="comment">//</span>
00555             <span class="comment">//  If we're switching with the root of the tree, fix the</span>
00556             <span class="comment">//  caller's root pointer</span>
00557             <span class="comment">//</span>
00558 
00559             *Root = Predecessor;
00560         }
00561 
00562         <a class="code" href="../../d3/d4/splay_8c.html#a2">SwapSplayLinks</a>(Predecessor, Links);
00563 
00564     }
00565 
00566     <span class="comment">//</span>
00567     <span class="comment">//  If Links has no children then delete links by checking if it is</span>
00568     <span class="comment">//  already the root or has a parent.  If it is the root then the</span>
00569     <span class="comment">//  tree is now empty, otherwise it set the appropriate parent's child</span>
00570     <span class="comment">//  pointer (i.e., the one to links) to NULL.</span>
00571     <span class="comment">//</span>
00572 
00573     <span class="keywordflow">if</span> ((RtlLeftChild(Links) == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) &amp;&amp; (RtlRightChild(Links) == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)) {
00574 
00575         <span class="comment">//</span>
00576         <span class="comment">//  Links has no children, if it is the root then set root to NULL</span>
00577         <span class="comment">//</span>
00578 
00579         <span class="keywordflow">if</span> (RtlIsRoot(Links)) {
00580 
00581             *Root = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00582 
00583             <span class="keywordflow">return</span>;
00584         }
00585 
00586         <span class="comment">//</span>
00587         <span class="comment">//  Links as not children and is not the root, so to the parent's</span>
00588         <span class="comment">//  child pointer to NULL.</span>
00589         <span class="comment">//</span>
00590 
00591         ParentChildPtr = <a class="code" href="../../d3/d4/splay_8c.html#a1">ParentsChildPointerAddress</a>(Links);
00592         *ParentChildPtr = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00593 
00594         <span class="keywordflow">return</span>;
00595     }
00596 
00597     <span class="comment">//</span>
00598     <span class="comment">//  otherwise Links has one child.  If it is the root then make the child</span>
00599     <span class="comment">//  the new root, otherwise link together the child and parent. But first</span>
00600     <span class="comment">//  remember who our child is.</span>
00601     <span class="comment">//</span>
00602 
00603     <span class="keywordflow">if</span> (RtlLeftChild(Links) != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00604         Child = RtlLeftChild(Links);
00605     } <span class="keywordflow">else</span> {
00606         Child = RtlRightChild(Links);
00607     }
00608 
00609     <span class="comment">//</span>
00610     <span class="comment">//  If links is the root then we make the child the root and return the</span>
00611     <span class="comment">//  child.</span>
00612     <span class="comment">//</span>
00613 
00614     <span class="keywordflow">if</span> (RtlIsRoot(Links)) {
00615         Child-&gt;Parent = Child;
00616 
00617         *Root = Child;
00618 
00619         <span class="keywordflow">return</span>;
00620     }
00621 
00622     <span class="comment">//</span>
00623     <span class="comment">//  Links is not the root, so set link's parent child pointer to be</span>
00624     <span class="comment">//  the child and the set child's parent to be link's parent.</span>
00625     <span class="comment">//</span>
00626 
00627     ParentChildPtr = <a class="code" href="../../d3/d4/splay_8c.html#a1">ParentsChildPointerAddress</a>(Links);
00628     *ParentChildPtr = Child;
00629     Child-&gt;Parent = Links-&gt;Parent;
00630 
00631     <span class="keywordflow">return</span>;
00632 }
00633 
00634 
00635 PRTL_SPLAY_LINKS
<a name="l00636"></a><a class="code" href="../../d3/d4/splay_8c.html#a6">00636</a> <a class="code" href="../../d3/d4/splay_8c.html#a6">RtlSubtreeSuccessor</a> (
00637     IN PRTL_SPLAY_LINKS Links
00638     )
00639 
00640 <span class="comment">/*++</span>
00641 <span class="comment"></span>
00642 <span class="comment">Routine Description:</span>
00643 <span class="comment"></span>
00644 <span class="comment">    The SubtreeSuccessor function takes as input a pointer to a splay link</span>
00645 <span class="comment">    in a tree and returns a pointer to the successor of the input node of</span>
00646 <span class="comment">    the substree rooted at the input node.  If there is not a successor, the</span>
00647 <span class="comment">    return value is NULL.</span>
00648 <span class="comment"></span>
00649 <span class="comment">Arguments:</span>
00650 <span class="comment"></span>
00651 <span class="comment">    Links - Supplies a pointer to a splay link in a tree.</span>
00652 <span class="comment"></span>
00653 <span class="comment">Return Value:</span>
00654 <span class="comment"></span>
00655 <span class="comment">    PRTL_SPLAY_LINKS - returns a pointer to the successor in the subtree</span>
00656 <span class="comment"></span>
00657 <span class="comment">--*/</span>
00658 
00659 {
00660     PRTL_SPLAY_LINKS <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>;
00661 
00662     <span class="comment">/*</span>
00663 <span class="comment">      check to see if there is a right subtree to the input link</span>
00664 <span class="comment">      if there is then the subtree successor is the left most node in</span>
00665 <span class="comment">      the right subtree.  That is find and return P in the following diagram</span>
00666 <span class="comment"></span>
00667 <span class="comment">                  Links</span>
00668 <span class="comment">                     \</span>
00669 <span class="comment">                      .</span>
00670 <span class="comment">                     .</span>
00671 <span class="comment">                    .</span>
00672 <span class="comment">                   /</span>
00673 <span class="comment">                  P</span>
00674 <span class="comment">                   \</span>
00675 <span class="comment">    */</span>
00676 
00677     <span class="keywordflow">if</span> ((<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a> = RtlRightChild(Links)) != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00678 
00679         <span class="keywordflow">while</span> (RtlLeftChild(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>) != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00680             <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a> = RtlLeftChild(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>);
00681         }
00682 
00683         <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>;
00684 
00685     }
00686 
00687     <span class="comment">//</span>
00688     <span class="comment">//  otherwise we are do not have a subtree successor so we simply return</span>
00689     <span class="comment">//  NULL</span>
00690     <span class="comment">//</span>
00691 
00692     <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00693 
00694 }
00695 
00696 
00697 PRTL_SPLAY_LINKS
<a name="l00698"></a><a class="code" href="../../d3/d4/splay_8c.html#a7">00698</a> <a class="code" href="../../d3/d4/splay_8c.html#a7">RtlSubtreePredecessor</a> (
00699     IN PRTL_SPLAY_LINKS Links
00700     )
00701 
00702 <span class="comment">/*++</span>
00703 <span class="comment"></span>
00704 <span class="comment">Routine Description:</span>
00705 <span class="comment"></span>
00706 <span class="comment">    The SubtreePredecessor function takes as input a pointer to a splay link</span>
00707 <span class="comment">    in a tree and returns a pointer to the predecessor of the input node of</span>
00708 <span class="comment">    the substree rooted at the input node.  If there is not a predecessor,</span>
00709 <span class="comment">    the return value is NULL.</span>
00710 <span class="comment"></span>
00711 <span class="comment">Arguments:</span>
00712 <span class="comment"></span>
00713 <span class="comment">    Links - Supplies a pointer to a splay link in a tree.</span>
00714 <span class="comment"></span>
00715 <span class="comment">Return Value:</span>
00716 <span class="comment"></span>
00717 <span class="comment">    PRTL_SPLAY_LINKS - returns a pointer to the predecessor in the subtree</span>
00718 <span class="comment"></span>
00719 <span class="comment">--*/</span>
00720 
00721 {
00722     PRTL_SPLAY_LINKS <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>;
00723 
00724     <span class="comment">//</span>
00725     <span class="comment">//  check to see if there is a left subtree to the input link</span>
00726     <span class="comment">//  if there is then the subtree predecessor is the right most node in</span>
00727     <span class="comment">//  the left subtree.  That is find and return P in the following diagram</span>
00728     <span class="comment">//</span>
00729     <span class="comment">//              Links</span>
00730     <span class="comment">//               /</span>
00731     <span class="comment">//              .</span>
00732     <span class="comment">//               .</span>
00733     <span class="comment">//                .</span>
00734     <span class="comment">//                 P</span>
00735     <span class="comment">//                /</span>
00736     <span class="comment">//</span>
00737 
00738     <span class="keywordflow">if</span> ((<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a> = RtlLeftChild(Links)) != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00739 
00740         <span class="keywordflow">while</span> (RtlRightChild(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>) != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00741             <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a> = RtlRightChild(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>);
00742         }
00743 
00744         <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>;
00745 
00746     }
00747 
00748     <span class="comment">//</span>
00749     <span class="comment">//  otherwise we are do not have a subtree predecessor so we simply return</span>
00750     <span class="comment">//  NULL</span>
00751     <span class="comment">//</span>
00752 
00753     <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00754 
00755 }
00756 
00757 
00758 PRTL_SPLAY_LINKS
<a name="l00759"></a><a class="code" href="../../d3/d4/splay_8c.html#a8">00759</a> <a class="code" href="../../d3/d4/splay_8c.html#a8">RtlRealSuccessor</a> (
00760     IN PRTL_SPLAY_LINKS Links
00761     )
00762 
00763 <span class="comment">/*++</span>
00764 <span class="comment"></span>
00765 <span class="comment">Routine Description:</span>
00766 <span class="comment"></span>
00767 <span class="comment">    The RealSuccessor function takes as input a pointer to a splay link</span>
00768 <span class="comment">    in a tree and returns a pointer to the successor of the input node within</span>
00769 <span class="comment">    the entire tree.  If there is not a successor, the return value is NULL.</span>
00770 <span class="comment"></span>
00771 <span class="comment">Arguments:</span>
00772 <span class="comment"></span>
00773 <span class="comment">    Links - Supplies a pointer to a splay link in a tree.</span>
00774 <span class="comment"></span>
00775 <span class="comment">Return Value:</span>
00776 <span class="comment"></span>
00777 <span class="comment">    PRTL_SPLAY_LINKS - returns a pointer to the successor in the entire tree</span>
00778 <span class="comment"></span>
00779 <span class="comment">--*/</span>
00780 
00781 {
00782     PRTL_SPLAY_LINKS <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>;
00783 
00784     <span class="comment">/*</span>
00785 <span class="comment">      first check to see if there is a right subtree to the input link</span>
00786 <span class="comment">      if there is then the real successor is the left most node in</span>
00787 <span class="comment">      the right subtree.  That is find and return P in the following diagram</span>
00788 <span class="comment"></span>
00789 <span class="comment">                  Links</span>
00790 <span class="comment">                     \</span>
00791 <span class="comment">                      .</span>
00792 <span class="comment">                     .</span>
00793 <span class="comment">                    .</span>
00794 <span class="comment">                   /</span>
00795 <span class="comment">                  P</span>
00796 <span class="comment">                   \</span>
00797 <span class="comment">    */</span>
00798 
00799     <span class="keywordflow">if</span> ((<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a> = RtlRightChild(Links)) != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00800 
00801         <span class="keywordflow">while</span> (RtlLeftChild(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>) != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00802             <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a> = RtlLeftChild(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>);
00803         }
00804 
00805         <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>;
00806 
00807     }
00808 
00809     <span class="comment">/*</span>
00810 <span class="comment">      we do not have a right child so check to see if have a parent and if</span>
00811 <span class="comment">      so find the first ancestor that we are a left decendent of. That</span>
00812 <span class="comment">      is find and return P in the following diagram</span>
00813 <span class="comment"></span>
00814 <span class="comment">                       P</span>
00815 <span class="comment">                      /</span>
00816 <span class="comment">                     .</span>
00817 <span class="comment">                      .</span>
00818 <span class="comment">                       .</span>
00819 <span class="comment">                      Links</span>
00820 <span class="comment">    */</span>
00821 
00822     <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a> = Links;
00823     <span class="keywordflow">while</span> (RtlIsRightChild(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>)) {
00824         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a> = RtlParent(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>);
00825     }
00826 
00827     <span class="keywordflow">if</span> (RtlIsLeftChild(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>)) {
00828         <span class="keywordflow">return</span> RtlParent(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>);
00829     }
00830 
00831     <span class="comment">//</span>
00832     <span class="comment">//  otherwise we are do not have a real successor so we simply return</span>
00833     <span class="comment">//  NULL</span>
00834     <span class="comment">//</span>
00835 
00836     <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00837 
00838 }
00839 
00840 
00841 PRTL_SPLAY_LINKS
<a name="l00842"></a><a class="code" href="../../d3/d4/splay_8c.html#a9">00842</a> <a class="code" href="../../d3/d4/splay_8c.html#a9">RtlRealPredecessor</a> (
00843     IN PRTL_SPLAY_LINKS Links
00844     )
00845 
00846 <span class="comment">/*++</span>
00847 <span class="comment"></span>
00848 <span class="comment">Routine Description:</span>
00849 <span class="comment"></span>
00850 <span class="comment">    The RealPredecessor function takes as input a pointer to a splay link</span>
00851 <span class="comment">    in a tree and returns a pointer to the predecessor of the input node</span>
00852 <span class="comment">    within the entire tree.  If there is not a predecessor, the return value</span>
00853 <span class="comment">    is NULL.</span>
00854 <span class="comment"></span>
00855 <span class="comment">Arguments:</span>
00856 <span class="comment"></span>
00857 <span class="comment">    Links - Supplies a pointer to a splay link in a tree.</span>
00858 <span class="comment"></span>
00859 <span class="comment">Return Value:</span>
00860 <span class="comment"></span>
00861 <span class="comment">    PRTL_SPLAY_LINKS - returns a pointer to the predecessor in the entire tree</span>
00862 <span class="comment"></span>
00863 <span class="comment">--*/</span>
00864 
00865 {
00866     PRTL_SPLAY_LINKS <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>;
00867 
00868     <span class="comment">/*</span>
00869 <span class="comment">      first check to see if there is a left subtree to the input link</span>
00870 <span class="comment">      if there is then the real predecessor is the right most node in</span>
00871 <span class="comment">      the left subtree.  That is find and return P in the following diagram</span>
00872 <span class="comment"></span>
00873 <span class="comment">                  Links</span>
00874 <span class="comment">                   /</span>
00875 <span class="comment">                  .</span>
00876 <span class="comment">                   .</span>
00877 <span class="comment">                    .</span>
00878 <span class="comment">                     P</span>
00879 <span class="comment">                    /</span>
00880 <span class="comment">    */</span>
00881 
00882     <span class="keywordflow">if</span> ((<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a> = RtlLeftChild(Links)) != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00883 
00884         <span class="keywordflow">while</span> (RtlRightChild(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>) != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00885             <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a> = RtlRightChild(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>);
00886         }
00887 
00888         <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>;
00889 
00890     }
00891 
00892     <span class="comment">/*</span>
00893 <span class="comment">      we do not have a left child so check to see if have a parent and if</span>
00894 <span class="comment">      so find the first ancestor that we are a right decendent of. That</span>
00895 <span class="comment">      is find and return P in the following diagram</span>
00896 <span class="comment"></span>
00897 <span class="comment">                       P</span>
00898 <span class="comment">                        \</span>
00899 <span class="comment">                         .</span>
00900 <span class="comment">                        .</span>
00901 <span class="comment">                       .</span>
00902 <span class="comment">                    Links</span>
00903 <span class="comment">    */</span>
00904 
00905     <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a> = Links;
00906     <span class="keywordflow">while</span> (RtlIsLeftChild(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>)) {
00907         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a> = RtlParent(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>);
00908     }
00909 
00910     <span class="keywordflow">if</span> (RtlIsRightChild(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>)) {
00911         <span class="keywordflow">return</span> RtlParent(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a28">Ptr</a>);
00912     }
00913 
00914     <span class="comment">//</span>
00915     <span class="comment">//  otherwise we are do not have a real predecessor so we simply return</span>
00916     <span class="comment">//  NULL</span>
00917     <span class="comment">//</span>
00918 
00919     <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00920 
00921 }
00922 
00923 
00924 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
<a name="l00925"></a><a class="code" href="../../d3/d4/splay_8c.html#a2">00925</a> <a class="code" href="../../d3/d4/splay_8c.html#a2">SwapSplayLinks</a> (
00926     IN PRTL_SPLAY_LINKS Link1,
00927     IN PRTL_SPLAY_LINKS Link2
00928     )
00929 
00930 {
00931     PRTL_SPLAY_LINKS *Parent1ChildPtr;
00932     PRTL_SPLAY_LINKS *Parent2ChildPtr;
00933 
00934     <span class="comment">/*</span>
00935 <span class="comment">      We have the following situation</span>
00936 <span class="comment"></span>
00937 <span class="comment"></span>
00938 <span class="comment">             Parent1            Parent2</span>
00939 <span class="comment">                |                  |</span>
00940 <span class="comment">                |                  |</span>
00941 <span class="comment">              Link1              Link2</span>
00942 <span class="comment">               / \                / \</span>
00943 <span class="comment">              /   \              /   \</span>
00944 <span class="comment">            LC1   RC1          LC2   RC2</span>
00945 <span class="comment"></span>
00946 <span class="comment">      where one of the links can possibly be the root and one of the links</span>
00947 <span class="comment">      can possibly be a direct child of the other.  Without loss of</span>
00948 <span class="comment">      generality we'll make link2 be the possible and root and link1 be</span>
00949 <span class="comment">      the possible child.</span>
00950 <span class="comment">    */</span>
00951 
00952     <span class="keywordflow">if</span> ((RtlIsRoot(Link1)) || (RtlParent(Link2) == Link1)) {
00953         <a class="code" href="../../d3/d4/splay_8c.html#a0">SwapPointers</a>(Link1, Link2);
00954     }
00955 
00956     <span class="comment">//</span>
00957     <span class="comment">//  The four cases we need to handle are</span>
00958     <span class="comment">//</span>
00959     <span class="comment">//  1. Link1 is not a child of link2 and link2 is not the root</span>
00960     <span class="comment">//  2. Link1 is not a child of link2 and link2 is     the root</span>
00961     <span class="comment">//  3. Link1 is     a child of link2 and link2 is not the root</span>
00962     <span class="comment">//  4. Link1 is     a child of link2 and link2 is     the root</span>
00963     <span class="comment">//</span>
00964     <span class="comment">//</span>
00965     <span class="comment">//  Each case will be handled separately</span>
00966     <span class="comment">//</span>
00967 
00968     <span class="keywordflow">if</span> (RtlParent(Link1) != Link2) {
00969 
00970         <span class="keywordflow">if</span> (!RtlIsRoot(Link2)) {
00971 
00972             <span class="comment">//</span>
00973             <span class="comment">//  Case 1 the initial steps are:</span>
00974             <span class="comment">//</span>
00975             <span class="comment">//  1. get both parent child pointers</span>
00976             <span class="comment">//  2. swap the parent child pointers</span>
00977             <span class="comment">//  3. swap the parent pointers</span>
00978             <span class="comment">//</span>
00979 
00980             Parent1ChildPtr = <a class="code" href="../../d3/d4/splay_8c.html#a1">ParentsChildPointerAddress</a>(Link1);
00981             Parent2ChildPtr = <a class="code" href="../../d3/d4/splay_8c.html#a1">ParentsChildPointerAddress</a>(Link2);
00982 
00983             <a class="code" href="../../d3/d4/splay_8c.html#a0">SwapPointers</a>(*Parent1ChildPtr, *Parent2ChildPtr);
00984 
00985             <a class="code" href="../../d3/d4/splay_8c.html#a0">SwapPointers</a>(Link1-&gt;Parent, Link2-&gt;Parent);
00986 
00987         } <span class="keywordflow">else</span> {
00988 
00989             <span class="comment">//</span>
00990             <span class="comment">//  Case 2 the initial steps are:</span>
00991             <span class="comment">//</span>
00992             <span class="comment">//  1. Set link1's parent child pointer to link2</span>
00993             <span class="comment">//  2. Set parent pointer of link2 to link1's parent</span>
00994             <span class="comment">//  3. Set parent pointer of link1 to be itself</span>
00995             <span class="comment">//</span>
00996 
00997             Parent1ChildPtr = <a class="code" href="../../d3/d4/splay_8c.html#a1">ParentsChildPointerAddress</a>(Link1);
00998             *Parent1ChildPtr = Link2;
00999 
01000             Link2-&gt;Parent = Link1-&gt;Parent;
01001 
01002             Link1-&gt;Parent = Link1;
01003 
01004         }
01005 
01006         <span class="comment">//</span>
01007         <span class="comment">//  Case 1 and 2 common steps are:</span>
01008         <span class="comment">//</span>
01009         <span class="comment">//  1. swap the child pointers</span>
01010         <span class="comment">//</span>
01011 
01012         <a class="code" href="../../d3/d4/splay_8c.html#a0">SwapPointers</a>(Link1-&gt;LeftChild, Link2-&gt;LeftChild);
01013         <a class="code" href="../../d3/d4/splay_8c.html#a0">SwapPointers</a>(Link1-&gt;RightChild, Link2-&gt;RightChild);
01014 
01015     } <span class="keywordflow">else</span> { <span class="comment">// RtlParent(Link1) == Link2</span>
01016 
01017         <span class="keywordflow">if</span> (!RtlIsRoot(Link2)) {
01018 
01019             <span class="comment">//</span>
01020             <span class="comment">//  Case 3 the initial steps are:</span>
01021             <span class="comment">//</span>
01022             <span class="comment">//  1. Set Link2's parent child pointer to link1</span>
01023             <span class="comment">//  2. Set Link1's parent pointer to parent of link2</span>
01024             <span class="comment">//</span>
01025 
01026             Parent2ChildPtr = <a class="code" href="../../d3/d4/splay_8c.html#a1">ParentsChildPointerAddress</a>(Link2);
01027             *Parent2ChildPtr = Link1;
01028 
01029             Link1-&gt;Parent = Link2-&gt;Parent;
01030 
01031         } <span class="keywordflow">else</span> {
01032 
01033             <span class="comment">//</span>
01034             <span class="comment">//  Case 4 the initial steps are:</span>
01035             <span class="comment">//</span>
01036             <span class="comment">//  1. Set Link1's parent pointer to be link1</span>
01037             <span class="comment">//</span>
01038 
01039             Link1-&gt;Parent = Link1;
01040 
01041         }
01042 
01043         <span class="comment">//</span>
01044         <span class="comment">//  Case 3 and 4 common steps are:</span>
01045         <span class="comment">//</span>
01046         <span class="comment">//  1. Swap the child pointers</span>
01047         <span class="comment">//  2. if link1 was a left child (i.e., RtlLeftChild(Link1) == Link1)</span>
01048         <span class="comment">//     then set left child of link1 to link2</span>
01049         <span class="comment">//     else set right child of link1 to link2</span>
01050         <span class="comment">//</span>
01051 
01052         <a class="code" href="../../d3/d4/splay_8c.html#a0">SwapPointers</a>(Link1-&gt;LeftChild, Link2-&gt;LeftChild);
01053         <a class="code" href="../../d3/d4/splay_8c.html#a0">SwapPointers</a>(Link1-&gt;RightChild, Link2-&gt;RightChild);
01054 
01055         <span class="keywordflow">if</span> (Link1-&gt;LeftChild == Link1) {
01056             Link1-&gt;LeftChild = Link2;
01057         } <span class="keywordflow">else</span> {
01058             Link1-&gt;RightChild = Link2;
01059         }
01060 
01061     }
01062 
01063     <span class="comment">//</span>
01064     <span class="comment">//  Case 1, 2, 3, 4 common (and final) steps are:</span>
01065     <span class="comment">//</span>
01066     <span class="comment">//  1. Fix the parent pointers of the left and right children</span>
01067     <span class="comment">//</span>
01068 
01069     <span class="keywordflow">if</span> (Link1-&gt;LeftChild  != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {Link1-&gt;LeftChild-&gt;Parent  = Link1;}
01070     <span class="keywordflow">if</span> (Link1-&gt;RightChild != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {Link1-&gt;RightChild-&gt;Parent = Link1;}
01071     <span class="keywordflow">if</span> (Link2-&gt;LeftChild  != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {Link2-&gt;LeftChild-&gt;Parent  = Link2;}
01072     <span class="keywordflow">if</span> (Link2-&gt;RightChild != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {Link2-&gt;RightChild-&gt;Parent = Link2;}
01073 
01074 }
</div></pre><hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:41:51 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
