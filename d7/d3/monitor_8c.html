<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: monitor.c File Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>monitor.c File Reference</h1><code>#include "<a class="el" href="../../d8/d2/w32_2ntuser_2client_2precomp_8h-source.html">precomp.h</a>"</code><br>

<p>
<a href="../../d8/d2/monitor_8c-source.html">Go to the source code of this file.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d3/monitor_8c.html#a0">phszs</a>&nbsp;&nbsp;&nbsp;((MONHSZSTRUCT *)&amp;pep-&gt;Data)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d3/monitor_8c.html#a1">pls</a>&nbsp;&nbsp;&nbsp;((MONLINKSTRUCT *)&amp;pep-&gt;Data)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d3/monitor_8c.html#a2">pcs</a>&nbsp;&nbsp;&nbsp;((MONCONVSTRUCT *)&amp;pep-&gt;Data)</td></tr>

<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d3/monitor_8c.html#a3">MonitorStringHandle</a> (<a class="el" href="../../d2/d0/structtagCL__INSTANCE__INFO.html">PCL_INSTANCE_INFO</a> pcii, HSZ hsz, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> fsAction)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d3/monitor_8c.html#a4">MonitorLink</a> (<a class="el" href="../../d2/d0/structtagCL__INSTANCE__INFO.html">PCL_INSTANCE_INFO</a> pcii, BOOL fEstablished, BOOL fNoData, <a class="el" href="../../d0/d4/ddemlcli_8h.html#a51">LATOM</a> aService, <a class="el" href="../../d0/d4/ddemlcli_8h.html#a51">LATOM</a> aTopic, <a class="el" href="../../d0/d4/ddemlcli_8h.html#a52">GATOM</a> aItem, WORD wFmt, BOOL fServer, HCONV hConvServer, HCONV hConvClient)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d3/monitor_8c.html#a5">MonitorConv</a> (<a class="el" href="../../d2/d1/structtagCONV__INFO.html">PCONV_INFO</a> pcoi, BOOL fConnect)</td></tr>

</table>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="a2" doxytag="monitor.c::pcs" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define pcs&nbsp;&nbsp;&nbsp;((MONCONVSTRUCT *)&amp;pep-&gt;Data)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d9/d7/aug98_2dll32_2csprof_8c-source.html#l00806">GetCPConnSpace()</a>, <a class="el" href="../../d9/d4/aug98_2dll32_2profcrd_8c-source.html#l01954">GetPS2PreviewColorRenderingDictionary()</a>, <a class="el" href="../../d1/d0/lh__core_2genluts_8c-source.html#l03720">InitNamedColorProfileData()</a>, <a class="el" href="../../d8/d2/monitor_8c-source.html#l00167">MonitorConv()</a>, <a class="el" href="../../d9/d4/reader_8c-source.html#l00158">ReaderWndProc()</a>, <a class="el" href="../../d9/d4/aug98_2dll32_2profcrd_8c-source.html#l01756">SendCRDABC()</a>, and <a class="el" href="../../d9/d4/aug98_2dll32_2profcrd_8c-source.html#l01650">SendCRDLMN()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a0" doxytag="monitor.c::phszs" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define phszs&nbsp;&nbsp;&nbsp;((MONHSZSTRUCT *)&amp;pep-&gt;Data)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d8/d2/monitor_8c-source.html#l00031">MonitorStringHandle()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="monitor.c::pls" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define pls&nbsp;&nbsp;&nbsp;((MONLINKSTRUCT *)&amp;pep-&gt;Data)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d8/d2/monitor_8c-source.html#l00090">MonitorLink()</a>.    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a5" doxytag="monitor.c::MonitorConv" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID MonitorConv           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d2/d1/structtagCONV__INFO.html">PCONV_INFO</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pcoi</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>BOOL&nbsp;</td>
          <td class="mdname" nowrap> <em>fConnect</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d2/monitor_8c-source.html#l00167">167</a> of file <a class="el" href="../../d8/d2/monitor_8c-source.html">monitor.c</a>.
<p>
References <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00058">CheckDDECritIn</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00016">DDEMLAlloc</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00048">EnterDDECrit</a>, <a class="el" href="../../d9/d8/client_2ntstubs_8c-source.html#l00086">Event()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00218">tagCONV_INFO::hwndConv</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00217">tagCONV_INFO::hwndPartner</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00215">tagCONV_INFO::laService</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00216">tagCONV_INFO::laTopic</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00049">LeaveDDECrit</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00438">LocalToGlobalAtom()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00187">tagCL_INSTANCE_INFO::MonitorFlags</a>, <a class="el" href="../../d0/d5/gettickc_8c-source.html#l00026">NtGetTickCount()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00212">tagCONV_INFO::pcii</a>, <a class="el" href="../../d7/d3/monitor_8c.html#a2">pcs</a>, <a class="el" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a>, <a class="el" href="../../d1/d3/instance_8c-source.html#l00137">SetLastDDEMLError()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00219">tagCONV_INFO::state</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00194">tagCL_INSTANCE_INFO::tid</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, and <a class="el" href="../../d2/d7/hal_8h.html#a212">VOID()</a>.
<p>
<pre class="fragment"><div>00170 {
00171     <a class="code" href="../../d7/d4/structtagEVENT__PACKET.html">PEVENT_PACKET</a> <a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a>;
00172 
00173     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a8">CheckDDECritIn</a>;
00174 
00175     UserAssert(pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o1">pcii</a>-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o3">MonitorFlags</a> &amp; MF_CONV);
00176 
00177     <a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a> = (<a class="code" href="../../d7/d4/structtagEVENT__PACKET.html">PEVENT_PACKET</a>)<a class="code" href="../../d0/d4/ddemlcli_8h.html#a0">DDEMLAlloc</a>(<span class="keyword">sizeof</span>(<a class="code" href="../../d7/d4/structtagEVENT__PACKET.html">EVENT_PACKET</a>) - <span class="keyword">sizeof</span>(DWORD) +
00178             <span class="keyword">sizeof</span>(MONCONVSTRUCT));
00179     <span class="keywordflow">if</span> (<a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a> == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00180         <a class="code" href="../../d0/d4/instance_8c.html#a8">SetLastDDEMLError</a>(pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o1">pcii</a>, DMLERR_MEMORY_ERROR);
00181         <span class="keywordflow">return</span> ;
00182     }
00183 
00184     <a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a>-&gt;EventType =    MF_CONV;
00185     <a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a>-&gt;fSense =       <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00186     <a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a>-&gt;cbEventData =  <span class="keyword">sizeof</span>(MONCONVSTRUCT);
00187 
00188 <span class="preprocessor">#define pcs ((MONCONVSTRUCT *)&amp;pep-&gt;Data)</span>
00189 <span class="preprocessor"></span>    <a class="code" href="../../d7/d3/monitor_8c.html#a2">pcs</a>-&gt;cb =           <span class="keyword">sizeof</span>(MONCONVSTRUCT);
00190     <a class="code" href="../../d7/d3/monitor_8c.html#a2">pcs</a>-&gt;fConnect =     fConnect;
00191     <a class="code" href="../../d7/d3/monitor_8c.html#a2">pcs</a>-&gt;dwTime =       <a class="code" href="../../d9/d5/gettickc_8c.html#a0">NtGetTickCount</a>();
00192     <a class="code" href="../../d7/d3/monitor_8c.html#a2">pcs</a>-&gt;hTask =        (HANDLE)LongToHandle( pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o1">pcii</a>-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o10">tid</a> );
00193     <a class="code" href="../../d7/d3/monitor_8c.html#a2">pcs</a>-&gt;hszSvc =       (HSZ)<a class="code" href="../../d4/d2/hsz_8c.html#a12">LocalToGlobalAtom</a>(pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o4">laService</a>);
00194     <a class="code" href="../../d7/d3/monitor_8c.html#a2">pcs</a>-&gt;hszTopic =     (HSZ)<a class="code" href="../../d4/d2/hsz_8c.html#a12">LocalToGlobalAtom</a>(pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o5">laTopic</a>);
00195     <span class="keywordflow">if</span> (pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o8">state</a> &amp; ST_CLIENT) {
00196         <a class="code" href="../../d7/d3/monitor_8c.html#a2">pcs</a>-&gt;hConvClient =  (HCONV)pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o7">hwndConv</a>;
00197         <a class="code" href="../../d7/d3/monitor_8c.html#a2">pcs</a>-&gt;hConvServer =  (HCONV)pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o6">hwndPartner</a>;
00198     } <span class="keywordflow">else</span> {
00199         <a class="code" href="../../d7/d3/monitor_8c.html#a2">pcs</a>-&gt;hConvClient =  (HCONV)pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o6">hwndPartner</a>;
00200         <a class="code" href="../../d7/d3/monitor_8c.html#a2">pcs</a>-&gt;hConvServer =  (HCONV)pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o7">hwndConv</a>;
00201     }
00202 
00203     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a7">LeaveDDECrit</a>;
00204     <a class="code" href="../../d6/d0/usercli_8h.html#a410">Event</a>(pep);
00205     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a6">EnterDDECrit</a>;
00206 
00207     GlobalDeleteAtom((ATOM)(ULONG_PTR)<a class="code" href="../../d7/d3/monitor_8c.html#a2">pcs</a>-&gt;hszSvc);
00208     GlobalDeleteAtom((ATOM)(ULONG_PTR)<a class="code" href="../../d7/d3/monitor_8c.html#a2">pcs</a>-&gt;hszTopic);
00209 <span class="preprocessor">#undef pcs</span>
00210 <span class="preprocessor"></span>}
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a4" doxytag="monitor.c::MonitorLink" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID MonitorLink           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d2/d0/structtagCL__INSTANCE__INFO.html">PCL_INSTANCE_INFO</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pcii</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>BOOL&nbsp;</td>
          <td class="mdname" nowrap> <em>fEstablished</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>BOOL&nbsp;</td>
          <td class="mdname" nowrap> <em>fNoData</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d4/ddemlcli_8h.html#a51">LATOM</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>aService</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d4/ddemlcli_8h.html#a51">LATOM</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>aTopic</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d4/ddemlcli_8h.html#a52">GATOM</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>aItem</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>WORD&nbsp;</td>
          <td class="mdname" nowrap> <em>wFmt</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>BOOL&nbsp;</td>
          <td class="mdname" nowrap> <em>fServer</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HCONV&nbsp;</td>
          <td class="mdname" nowrap> <em>hConvServer</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HCONV&nbsp;</td>
          <td class="mdname" nowrap> <em>hConvClient</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d2/monitor_8c-source.html#l00090">90</a> of file <a class="el" href="../../d8/d2/monitor_8c-source.html">monitor.c</a>.
<p>
References <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00058">CheckDDECritIn</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00016">DDEMLAlloc</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00048">EnterDDECrit</a>, <a class="el" href="../../d9/d8/client_2ntstubs_8c-source.html#l00086">Event()</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00490">IncGlobalAtomCount()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00049">LeaveDDECrit</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00438">LocalToGlobalAtom()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00187">tagCL_INSTANCE_INFO::MonitorFlags</a>, <a class="el" href="../../d0/d5/gettickc_8c-source.html#l00026">NtGetTickCount()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a>, <a class="el" href="../../d7/d3/monitor_8c.html#a1">pls</a>, <a class="el" href="../../d1/d3/instance_8c-source.html#l00137">SetLastDDEMLError()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00194">tagCL_INSTANCE_INFO::tid</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, and <a class="el" href="../../d2/d7/hal_8h.html#a212">VOID()</a>.
<p>
<pre class="fragment"><div>00101 {
00102     <a class="code" href="../../d7/d4/structtagEVENT__PACKET.html">PEVENT_PACKET</a> <a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a>;
00103 
00104     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a8">CheckDDECritIn</a>;
00105 
00106     UserAssert(pcii-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o3">MonitorFlags</a> &amp; MF_LINKS);
00107 
00108     <a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a> = (<a class="code" href="../../d7/d4/structtagEVENT__PACKET.html">PEVENT_PACKET</a>)<a class="code" href="../../d0/d4/ddemlcli_8h.html#a0">DDEMLAlloc</a>(<span class="keyword">sizeof</span>(<a class="code" href="../../d7/d4/structtagEVENT__PACKET.html">EVENT_PACKET</a>) - <span class="keyword">sizeof</span>(DWORD) +
00109             <span class="keyword">sizeof</span>(MONLINKSTRUCT));
00110     <span class="keywordflow">if</span> (<a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a> == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00111         <a class="code" href="../../d0/d4/instance_8c.html#a8">SetLastDDEMLError</a>(pcii, DMLERR_MEMORY_ERROR);
00112         <span class="keywordflow">return</span> ;
00113     }
00114 
00115     <a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a>-&gt;EventType =    MF_LINKS;
00116     <a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a>-&gt;fSense =       <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00117     <a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a>-&gt;cbEventData =  <span class="keyword">sizeof</span>(MONLINKSTRUCT);
00118 
00119 <span class="preprocessor">#define pls ((MONLINKSTRUCT *)&amp;pep-&gt;Data)</span>
00120 <span class="preprocessor"></span>    <a class="code" href="../../d7/d3/monitor_8c.html#a1">pls</a>-&gt;cb =           <span class="keyword">sizeof</span>(MONLINKSTRUCT);
00121     <a class="code" href="../../d7/d3/monitor_8c.html#a1">pls</a>-&gt;dwTime =       <a class="code" href="../../d9/d5/gettickc_8c.html#a0">NtGetTickCount</a>();
00122     <a class="code" href="../../d7/d3/monitor_8c.html#a1">pls</a>-&gt;hTask =        (HANDLE)LongToHandle( pcii-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o10">tid</a> );
00123     <a class="code" href="../../d7/d3/monitor_8c.html#a1">pls</a>-&gt;fEstablished = fEstablished;
00124     <a class="code" href="../../d7/d3/monitor_8c.html#a1">pls</a>-&gt;fNoData =      fNoData;
00125 
00126     <span class="comment">// use global atoms here - these need to be changed to local atoms before</span>
00127     <span class="comment">// the callbacks to the ddespy apps.</span>
00128 
00129     <a class="code" href="../../d7/d3/monitor_8c.html#a1">pls</a>-&gt;hszSvc =       (HSZ)<a class="code" href="../../d4/d2/hsz_8c.html#a12">LocalToGlobalAtom</a>(aService);
00130     <a class="code" href="../../d7/d3/monitor_8c.html#a1">pls</a>-&gt;hszTopic =     (HSZ)<a class="code" href="../../d4/d2/hsz_8c.html#a12">LocalToGlobalAtom</a>(aTopic);
00131     <a class="code" href="../../d4/d2/hsz_8c.html#a14">IncGlobalAtomCount</a>(aItem);
00132     <a class="code" href="../../d7/d3/monitor_8c.html#a1">pls</a>-&gt;hszItem =      (HSZ)aItem;
00133 
00134     <a class="code" href="../../d7/d3/monitor_8c.html#a1">pls</a>-&gt;wFmt =         wFmt;
00135     <a class="code" href="../../d7/d3/monitor_8c.html#a1">pls</a>-&gt;fServer =      fServer;
00136     <a class="code" href="../../d7/d3/monitor_8c.html#a1">pls</a>-&gt;hConvServer =  hConvServer;
00137     <a class="code" href="../../d7/d3/monitor_8c.html#a1">pls</a>-&gt;hConvClient =  hConvClient;
00138 
00139     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a7">LeaveDDECrit</a>;
00140     <a class="code" href="../../d6/d0/usercli_8h.html#a410">Event</a>(pep);
00141     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a6">EnterDDECrit</a>;
00142 
00143     GlobalDeleteAtom((ATOM)(ULONG_PTR)<a class="code" href="../../d7/d3/monitor_8c.html#a1">pls</a>-&gt;hszSvc);
00144     GlobalDeleteAtom((ATOM)(ULONG_PTR)<a class="code" href="../../d7/d3/monitor_8c.html#a1">pls</a>-&gt;hszTopic);
00145     GlobalDeleteAtom(aItem);
00146 <span class="preprocessor">#undef pls</span>
00147 <span class="preprocessor"></span>}
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="monitor.c::MonitorStringHandle" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID MonitorStringHandle           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d2/d0/structtagCL__INSTANCE__INFO.html">PCL_INSTANCE_INFO</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pcii</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HSZ&nbsp;</td>
          <td class="mdname" nowrap> <em>hsz</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>fsAction</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d2/monitor_8c-source.html#l00031">31</a> of file <a class="el" href="../../d8/d2/monitor_8c-source.html">monitor.c</a>.
<p>
References <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00058">CheckDDECritIn</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00016">DDEMLAlloc</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00048">EnterDDECrit</a>, <a class="el" href="../../d9/d8/client_2ntstubs_8c-source.html#l00086">Event()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00069">LATOM_FROM_HSZ</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00049">LeaveDDECrit</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00187">tagCL_INSTANCE_INFO::MonitorFlags</a>, <a class="el" href="../../d0/d5/gettickc_8c-source.html#l00026">NtGetTickCount()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a>, <a class="el" href="../../d7/d3/monitor_8c.html#a0">phszs</a>, <a class="el" href="../../d1/d3/instance_8c-source.html#l00137">SetLastDDEMLError()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00194">tagCL_INSTANCE_INFO::tid</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, and <a class="el" href="../../d2/d7/hal_8h.html#a212">VOID()</a>.
<p>
<pre class="fragment"><div>00035 {
00036     WCHAR szT[256];
00037     <a class="code" href="../../d7/d4/structtagEVENT__PACKET.html">PEVENT_PACKET</a> <a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a>;
00038     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> cchString;
00039 
00040     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a8">CheckDDECritIn</a>;
00041 
00042     UserAssert(pcii-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o3">MonitorFlags</a> &amp; MF_HSZ_INFO);
00043 
00044     <span class="keywordflow">if</span> (!(cchString = GetAtomName(<a class="code" href="../../d0/d4/ddemlcli_8h.html#a13">LATOM_FROM_HSZ</a>(hsz), szT,
00045             <span class="keyword">sizeof</span>(szT) / <span class="keyword">sizeof</span>(WCHAR)))) {
00046         <a class="code" href="../../d0/d4/instance_8c.html#a8">SetLastDDEMLError</a>(pcii, DMLERR_INVALIDPARAMETER);
00047         <span class="keywordflow">return</span> ;
00048     }
00049     cchString++;
00050     <a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a> = (<a class="code" href="../../d7/d4/structtagEVENT__PACKET.html">PEVENT_PACKET</a>)<a class="code" href="../../d0/d4/ddemlcli_8h.html#a0">DDEMLAlloc</a>(<span class="keyword">sizeof</span>(<a class="code" href="../../d7/d4/structtagEVENT__PACKET.html">EVENT_PACKET</a>) - <span class="keyword">sizeof</span>(DWORD) +
00051             <span class="keyword">sizeof</span>(MONHSZSTRUCT) + cchString * <span class="keyword">sizeof</span>(WCHAR));
00052     <span class="keywordflow">if</span> (<a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a> == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00053         <a class="code" href="../../d0/d4/instance_8c.html#a8">SetLastDDEMLError</a>(pcii, DMLERR_MEMORY_ERROR);
00054         <span class="keywordflow">return</span> ;
00055     }
00056 
00057     <a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a>-&gt;EventType =    MF_HSZ_INFO;
00058     <a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a>-&gt;fSense =       <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00059     <a class="code" href="../../d1/d8/w32_2ntuser_2kernel_2event_8c.html#a2">pep</a>-&gt;cbEventData =  (WORD)(<span class="keyword">sizeof</span>(MONHSZSTRUCT) + cchString * <span class="keyword">sizeof</span>(WCHAR));
00060 
00061 <span class="preprocessor">#define phszs ((MONHSZSTRUCT *)&amp;pep-&gt;Data)</span>
00062 <span class="preprocessor"></span>    <a class="code" href="../../d7/d3/monitor_8c.html#a0">phszs</a>-&gt;cb =      <span class="keyword">sizeof</span>(MONHSZSTRUCT);
00063     <a class="code" href="../../d7/d3/monitor_8c.html#a0">phszs</a>-&gt;fsAction = fsAction;
00064     <a class="code" href="../../d7/d3/monitor_8c.html#a0">phszs</a>-&gt;dwTime =  <a class="code" href="../../d9/d5/gettickc_8c.html#a0">NtGetTickCount</a>();
00065     <a class="code" href="../../d7/d3/monitor_8c.html#a0">phszs</a>-&gt;hsz = hsz;
00066     <a class="code" href="../../d7/d3/monitor_8c.html#a0">phszs</a>-&gt;hTask = (HANDLE)LongToHandle( pcii-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o10">tid</a> );
00067     <span class="comment">// phszs-&gt;wReserved = 0; // zero init.</span>
00068     wcscpy(<a class="code" href="../../d7/d3/monitor_8c.html#a0">phszs</a>-&gt;str, szT);
00069 
00070     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a7">LeaveDDECrit</a>;
00071     <a class="code" href="../../d6/d0/usercli_8h.html#a410">Event</a>(pep);
00072     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a6">EnterDDECrit</a>;
00073 <span class="preprocessor">#undef phszs</span>
00074 <span class="preprocessor"></span>}
</div></pre>    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:44:48 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
