<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: kcodecnv.c Source File</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>kcodecnv.c</h1><a href="../../d6/d3/kcodecnv_8c.html">Go to the documentation of this file.</a><pre class="fragment"><div>00001 
00002 <span class="comment">/**************************************************************************\</span>
00003 <span class="comment">* Module Name: kcodecnv.c</span>
00004 <span class="comment">*</span>
00005 <span class="comment">* Copyright (c) 1985 - 1999, Microsoft Corporation</span>
00006 <span class="comment">*</span>
00007 <span class="comment">* This module contains all the code for the Korean code conversion functions.</span>
00008 <span class="comment">*</span>
00009 <span class="comment">* History:</span>
00010 <span class="comment">* 15-Jul-1995</span>
00011 <span class="comment">* 22-Feb-1996  bklee</span>
00012 <span class="comment">\**************************************************************************/</span>
00013 <span class="preprocessor">#include "<a class="code" href="../../d8/d3/w32_2ntuser_2imm_2precomp_8h.html">precomp.h</a>"</span>
00014 <span class="preprocessor">#pragma hdrstop</span>
00015 <span class="preprocessor"></span>
<a name="l00016"></a><a class="code" href="../../d6/d3/kcodecnv_8c.html#a0">00016</a> <span class="preprocessor">#define IDD_2BEOL    100</span>
<a name="l00017"></a><a class="code" href="../../d6/d3/kcodecnv_8c.html#a1">00017</a> <span class="preprocessor"></span><span class="preprocessor">#define IDD_3BEOL1   101</span>
<a name="l00018"></a><a class="code" href="../../d6/d3/kcodecnv_8c.html#a2">00018</a> <span class="preprocessor"></span><span class="preprocessor">#define IDD_3BEOL2   102</span>
00019 <span class="preprocessor"></span>
<a name="l00020"></a><a class="code" href="../../d6/d3/kcodecnv_8c.html#a3">00020</a> <span class="preprocessor">#define lpSource(lpks) (LPSTR)((LPSTR)lpks+lpks-&gt;dchSource)</span>
<a name="l00021"></a><a class="code" href="../../d6/d3/kcodecnv_8c.html#a4">00021</a> <span class="preprocessor"></span><span class="preprocessor">#define lpDest(lpks)   (LPSTR)((LPSTR)lpks+lpks-&gt;dchDest)</span>
00022 <span class="preprocessor"></span>
<a name="l00023"></a><a class="code" href="../../d6/d3/kcodecnv_8c.html#a5">00023</a> <span class="preprocessor">#define JOHAB_CP   1361</span>
<a name="l00024"></a><a class="code" href="../../d6/d3/kcodecnv_8c.html#a6">00024</a> <span class="preprocessor"></span><span class="preprocessor">#define WANSUNG_CP 949</span>
<a name="l00025"></a><a class="code" href="../../d6/d3/kcodecnv_8c.html#a7">00025</a> <span class="preprocessor"></span><span class="preprocessor">#define TWO_BYTE   2</span>
<a name="l00026"></a><a class="code" href="../../d6/d3/kcodecnv_8c.html#a8">00026</a> <span class="preprocessor"></span><span class="preprocessor">#define ONE_WORD   1</span>
00027 <span class="preprocessor"></span>
<a name="l00028"></a><a class="code" href="../../d4/d6/structtagHIGH__LOW.html">00028</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d4/d6/structtagHIGH__LOW.html">tagHIGH_LOW</a>              <span class="comment">// For high byte and low byte</span>
00029 {
<a name="l00030"></a><a class="code" href="../../d4/d6/structtagHIGH__LOW.html#o0">00030</a>     <a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a>    <a class="code" href="../../d4/d6/structtagHIGH__LOW.html#o0">low</a>, <a class="code" href="../../d4/d6/structtagHIGH__LOW.html#o1">high</a>;
00031 }   <a class="code" href="../../d4/d6/structtagHIGH__LOW.html">HIGH_LOW</a>;
00032 
<a name="l00033"></a><a class="code" href="../../d2/d9/uniontagWANSUNG.html">00033</a> <span class="keyword">typedef</span> <span class="keyword">union </span><a class="code" href="../../d2/d9/uniontagWANSUNG.html">tagWANSUNG</a>                <span class="comment">// For Wansung character code</span>
00034 {
<a name="l00035"></a><a class="code" href="../../d2/d9/uniontagWANSUNG.html#o0">00035</a>     <a class="code" href="../../d4/d6/structtagHIGH__LOW.html">HIGH_LOW</a>    <a class="code" href="../../d2/d9/uniontagWANSUNG.html#o0">e</a>;
<a name="l00036"></a><a class="code" href="../../d2/d9/uniontagWANSUNG.html#o1">00036</a>     WORD        <a class="code" href="../../d2/d9/uniontagWANSUNG.html#o1">w</a>;
00037 }   <a class="code" href="../../d2/d9/uniontagWANSUNG.html">WANSUNG</a>;
00038 
00039 <span class="comment">/* Hanguel Mnemonic Table for 2 BeolSik and 3 BeolSik */</span>
<a name="l00040"></a><a class="code" href="../../d6/d3/kcodecnv_8c.html#a11">00040</a> CONST WORD <a class="code" href="../../d6/d3/kcodecnv_8c.html#a11">HMNTable</a>[3][96] =
00041 {
00042 <span class="comment">// For 2 Beolsik.</span>
00043     {
00044     <span class="comment">/*  20  SP  */</span>  0xA1A1,
00045     <span class="comment">/*  21  !   */</span>  0xA3A1,
00046     <span class="comment">/*  22  "   */</span>  0xA1A8,
00047     <span class="comment">/*  23  #   */</span>  0xA3A3,
00048     <span class="comment">/*  24  $   */</span>  0xA3A4,
00049     <span class="comment">/*  25  %   */</span>  0xA3A5,
00050     <span class="comment">/*  26  &amp;   */</span>  0xA3A6,
00051     <span class="comment">/*  27  `   */</span>  0xA1AE,     <span class="comment">/* A1AE ? AiA2 */</span>
00052     <span class="comment">/*  28  (   */</span>  0xA3A8,
00053     <span class="comment">/*  29  )   */</span>  0xA3A9,
00054     <span class="comment">/*  2A  *   */</span>  0xA3AA,
00055     <span class="comment">/*  2B  +   */</span>  0xA3AB,
00056     <span class="comment">/*  2C  '   */</span>  0xA3A7,
00057     <span class="comment">/*  2D  -   */</span>  0xA3AD,
00058     <span class="comment">/*  2E  .   */</span>  0xA3AE,
00059     <span class="comment">/*  2F  /   */</span>  0xA3AF,
00060     <span class="comment">/*  30  0   */</span>  0xA3B0,
00061     <span class="comment">/*  31  1   */</span>  0xA3B1,
00062     <span class="comment">/*  32  2   */</span>  0xA3B2,
00063     <span class="comment">/*  33  3   */</span>  0xA3B3,
00064     <span class="comment">/*  34  4   */</span>  0xA3B4,
00065     <span class="comment">/*  35  5   */</span>  0xA3B5,
00066     <span class="comment">/*  36  6   */</span>  0xA3B6,
00067     <span class="comment">/*  37  7   */</span>  0xA3B7,
00068     <span class="comment">/*  38  8   */</span>  0xA3B8,
00069     <span class="comment">/*  39  9   */</span>  0xA3B9,
00070     <span class="comment">/*  3A  :   */</span>  0xA3BA,
00071     <span class="comment">/*  3B  ;   */</span>  0xA3BB,
00072     <span class="comment">/*  3C  &lt;   */</span>  0xA3BC,
00073     <span class="comment">/*  3D  =   */</span>  0xA3BD,
00074     <span class="comment">/*  3E  &gt;   */</span>  0xA3BE,
00075     <span class="comment">/*  3F  ?   */</span>  0xA3BF,
00076     <span class="comment">/*  40  @   */</span>  0xA3C0,
00077     <span class="comment">/*  41  A   */</span>  0xA4B1,
00078     <span class="comment">/*  42  B   */</span>  0xA4D0,
00079     <span class="comment">/*  43  C   */</span>  0xA4BA,
00080     <span class="comment">/*  44  D   */</span>  0xA4B7,
00081     <span class="comment">/*  45  E   */</span>  0xA4A8,
00082     <span class="comment">/*  46  F   */</span>  0xA4A9,
00083     <span class="comment">/*  47  G   */</span>  0xA4BE,
00084     <span class="comment">/*  48  H   */</span>  0xA4C7,
00085     <span class="comment">/*  49  I   */</span>  0xA4C1,
00086     <span class="comment">/*  4A  J   */</span>  0xA4C3,
00087     <span class="comment">/*  4B  K   */</span>  0xA4BF,
00088     <span class="comment">/*  4C  L   */</span>  0xA4D3,
00089     <span class="comment">/*  4D  M   */</span>  0xA4D1,
00090     <span class="comment">/*  4E  N   */</span>  0xA4CC,
00091     <span class="comment">/*  4F  O   */</span>  0xA4C2,
00092     <span class="comment">/*  50  P   */</span>  0xA4C6,
00093     <span class="comment">/*  51  Q   */</span>  0xA4B3,
00094     <span class="comment">/*  52  R   */</span>  0xA4A2,
00095     <span class="comment">/*  53  S   */</span>  0xA4A4,
00096     <span class="comment">/*  54  T   */</span>  0xA4B6,
00097     <span class="comment">/*  55  U   */</span>  0xA4C5,
00098     <span class="comment">/*  56  V   */</span>  0xA4BD,
00099     <span class="comment">/*  57  W   */</span>  0xA4B9,
00100     <span class="comment">/*  58  X   */</span>  0xA4BC,
00101     <span class="comment">/*  59  Y   */</span>  0xA4CB,
00102     <span class="comment">/*  5A  Z   */</span>  0xA4BB,
00103     <span class="comment">/*  5B  [   */</span>  0xA3DB,
00104     <span class="comment">/*  5C  \   */</span>  0xA1AC,
00105     <span class="comment">/*  5D  ]   */</span>  0xA3DD,
00106     <span class="comment">/*  5E  ^   */</span>  0xA3DE,
00107     <span class="comment">/*  5F  _   */</span>  0xA3DF,
00108     <span class="comment">/*  60  `   */</span>  0xA1A2,     <span class="comment">/* A1AE ? AiA2 */</span>
00109     <span class="comment">/*  61  a   */</span>  0xA4B1,
00110     <span class="comment">/*  62  b   */</span>  0xA4D0,
00111     <span class="comment">/*  63  c   */</span>  0xA4BA,
00112     <span class="comment">/*  64  d   */</span>  0xA4B7,
00113     <span class="comment">/*  65  e   */</span>  0xA4A7,
00114     <span class="comment">/*  66  f   */</span>  0xA4A9,
00115     <span class="comment">/*  67  g   */</span>  0xA4BE,
00116     <span class="comment">/*  68  h   */</span>  0xA4C7,
00117     <span class="comment">/*  69  i   */</span>  0xA4C1,
00118     <span class="comment">/*  6A  j   */</span>  0xA4C3,
00119     <span class="comment">/*  6B  k   */</span>  0xA4BF,
00120     <span class="comment">/*  6C  l   */</span>  0xA4D3,
00121     <span class="comment">/*  6D  m   */</span>  0xA4D1,
00122     <span class="comment">/*  6E  n   */</span>  0xA4CC,
00123     <span class="comment">/*  6F  o   */</span>  0xA4C0,
00124     <span class="comment">/*  70  p   */</span>  0xA4C4,
00125     <span class="comment">/*  71  q   */</span>  0xA4B2,
00126     <span class="comment">/*  72  r   */</span>  0xA4A1,
00127     <span class="comment">/*  73  s   */</span>  0xA4A4,
00128     <span class="comment">/*  74  t   */</span>  0xA4B5,
00129     <span class="comment">/*  75  u   */</span>  0xA4C5,
00130     <span class="comment">/*  76  v   */</span>  0xA4BD,
00131     <span class="comment">/*  77  w   */</span>  0xA4B8,
00132     <span class="comment">/*  78  x   */</span>  0xA4BC,
00133     <span class="comment">/*  79  y   */</span>  0xA4CB,
00134     <span class="comment">/*  7A  z   */</span>  0xA4BB,
00135     <span class="comment">/*  7B  {   */</span>  0xA3FB,
00136     <span class="comment">/*  7C  |   */</span>  0xA3FC,
00137     <span class="comment">/*  7D  }   */</span>  0xA3FD,
00138     <span class="comment">/*  7E  ~   */</span>  0xA1AD,
00139                     0x0000
00140     },
00141 <span class="comment">// For KT390.</span>
00142     {
00143     <span class="comment">/*  Hex Code    KSC Code */</span>
00144     <span class="comment">/*  20  SP  */</span>  0xA1A1,
00145     <span class="comment">/*  21  !   */</span>  0xA4B8,
00146     <span class="comment">/*  22  "   */</span>  0xA1A8,
00147     <span class="comment">/*  23  #   */</span>  0xA3A3,
00148     <span class="comment">/*  24  $   */</span>  0xA3A4,
00149     <span class="comment">/*  25  %   */</span>  0xA3A5,
00150     <span class="comment">/*  26  &amp;   */</span>  0xA3A6,
00151     <span class="comment">/*  27  `   */</span>  0xA1AE,
00152     <span class="comment">/*  28  (   */</span>  0xA3A8,
00153     <span class="comment">/*  29  )   */</span>  0xA3A9,
00154     <span class="comment">/*  2A  *   */</span>  0xA3AA,
00155     <span class="comment">/*  2B  +   */</span>  0xA3AB,
00156     <span class="comment">/*  2C  '   */</span>  0xA4BC,
00157     <span class="comment">/*  2D  -   */</span>  0xA3AD,
00158     <span class="comment">/*  2E  .   */</span>  0xA3AE,
00159     <span class="comment">/*  2F  /   */</span>  0xA4C7,
00160     <span class="comment">/*  30  0   */</span>  0xA4BB,
00161     <span class="comment">/*  31  1   */</span>  0xA4BE,
00162     <span class="comment">/*  32  2   */</span>  0xA4B6,
00163     <span class="comment">/*  33  3   */</span>  0xA4B2,
00164     <span class="comment">/*  34  4   */</span>  0xA4CB,
00165     <span class="comment">/*  35  5   */</span>  0xA4D0,
00166     <span class="comment">/*  36  6   */</span>  0xA4C1,
00167     <span class="comment">/*  37  7   */</span>  0xA4C6,
00168     <span class="comment">/*  38  8   */</span>  0xA4D2,
00169     <span class="comment">/*  39  9   */</span>  0xA4CC,
00170     <span class="comment">/*  3A  :   */</span>  0xA3BA,
00171     <span class="comment">/*  3B  ;   */</span>  0xA4B2,
00172     <span class="comment">/*  3C  &lt;   */</span>  0xA3B2,
00173     <span class="comment">/*  3D  =   */</span>  0xA3BD,
00174     <span class="comment">/*  3E  &gt;   */</span>  0xA3B3,
00175     <span class="comment">/*  3F  ?   */</span>  0xA3BF,
00176     <span class="comment">/*  40  @   */</span>  0xA3C0,
00177     <span class="comment">/*  41  A   */</span>  0xA4A7,
00178     <span class="comment">/*  42  B   */</span>  0xA3A1,
00179     <span class="comment">/*  43  C   */</span>  0xA4AB,
00180     <span class="comment">/*  44  D   */</span>  0xA4AA,
00181     <span class="comment">/*  45  E   */</span>  0xA4BB,
00182     <span class="comment">/*  46  F   */</span>  0xA4A2,
00183     <span class="comment">/*  47  G   */</span>  0xA3AF,
00184     <span class="comment">/*  48  H   */</span>  0xA1AF,
00185     <span class="comment">/*  49  I   */</span>  0xA3B8,
00186     <span class="comment">/*  4A  J   */</span>  0xA3B4,
00187     <span class="comment">/*  4B  K   */</span>  0xA3B5,
00188     <span class="comment">/*  4C  L   */</span>  0xA3B6,
00189     <span class="comment">/*  4D  M   */</span>  0xA3B1,
00190     <span class="comment">/*  4E  N   */</span>  0xA3B0,
00191     <span class="comment">/*  4F  O   */</span>  0xA3B9,
00192     <span class="comment">/*  50  P   */</span>  0xA3BE,
00193     <span class="comment">/*  51  Q   */</span>  0xA4BD,
00194     <span class="comment">/*  52  R   */</span>  0xA4C2,
00195     <span class="comment">/*  53  S   */</span>  0xA4A6,
00196     <span class="comment">/*  54  T   */</span>  0xA4C3,
00197     <span class="comment">/*  55  U   */</span>  0xA3B7,
00198     <span class="comment">/*  56  V   */</span>  0xA4B0,
00199     <span class="comment">/*  57  W   */</span>  0xA4BC,
00200     <span class="comment">/*  58  X   */</span>  0xA4B4,
00201     <span class="comment">/*  59  Y   */</span>  0xA3BC,
00202     <span class="comment">/*  5A  Z   */</span>  0xA4BA,
00203     <span class="comment">/*  5B  [   */</span>  0xA3DB,
00204     <span class="comment">/*  5C  \   */</span>  0xA3DC,
00205     <span class="comment">/*  5D  ]   */</span>  0xA3DD,
00206     <span class="comment">/*  5E  ^   */</span>  0xA3DE,
00207     <span class="comment">/*  5F  _   */</span>  0xA3DF,
00208     <span class="comment">/*  60  `   */</span>  0xA1AE,
00209     <span class="comment">/*  61  a   */</span>  0xA4B7,
00210     <span class="comment">/*  62  b   */</span>  0xA4CC,
00211     <span class="comment">/*  63  c   */</span>  0xA4C4,
00212     <span class="comment">/*  64  d   */</span>  0xA4D3,
00213     <span class="comment">/*  65  e   */</span>  0xA4C5,
00214     <span class="comment">/*  66  f   */</span>  0xA4BF,
00215     <span class="comment">/*  67  g   */</span>  0xA4D1,
00216     <span class="comment">/*  68  h   */</span>  0xA4A4,
00217     <span class="comment">/*  69  i   */</span>  0xA4B1,
00218     <span class="comment">/*  6A  j   */</span>  0xA4B7,
00219     <span class="comment">/*  6B  k   */</span>  0xA4A1,
00220     <span class="comment">/*  6C  l   */</span>  0xA4B8,
00221     <span class="comment">/*  6D  m   */</span>  0xA4BE,
00222     <span class="comment">/*  6E  n   */</span>  0xA4B5,
00223     <span class="comment">/*  6F  o   */</span>  0xA4BA,
00224     <span class="comment">/*  70  p   */</span>  0xA4BD,
00225     <span class="comment">/*  71  q   */</span>  0xA4B5,
00226     <span class="comment">/*  72  r   */</span>  0xA4C0,
00227     <span class="comment">/*  73  s   */</span>  0xA4A4,
00228     <span class="comment">/*  74  t   */</span>  0xA4C3,
00229     <span class="comment">/*  75  u   */</span>  0xA4A7,
00230     <span class="comment">/*  76  v   */</span>  0xA4C7,
00231     <span class="comment">/*  77  w   */</span>  0xA4A9,
00232     <span class="comment">/*  78  x   */</span>  0xA4A1,
00233     <span class="comment">/*  79  y   */</span>  0xA4A9,
00234     <span class="comment">/*  7A  z   */</span>  0xA4B1,
00235     <span class="comment">/*  7B  {   */</span>  0xA3FB,
00236     <span class="comment">/*  7C  |   */</span>  0xA3FC,
00237     <span class="comment">/*  7D  }   */</span>  0xA3FD,
00238     <span class="comment">/*  7E  ~   */</span>  0xA1AD,
00239                     0x0000
00240     },
00241 <span class="comment">// For 3 Beolsik Final.</span>
00242     {
00243     <span class="comment">/*  Hex Code    KSC Code */</span>
00244     <span class="comment">/*  20  SP  */</span>  0xA1A1,
00245     <span class="comment">/*  21  !   */</span>  0xA4A2,
00246     <span class="comment">/*  22  "   */</span>  0xA3AE,
00247     <span class="comment">/*  23  #   */</span>  0xA4B8,
00248     <span class="comment">/*  24  $   */</span>  0xA4AF,
00249     <span class="comment">/*  25  %   */</span>  0xA4AE,
00250     <span class="comment">/*  26  &amp;   */</span>  0xA1B0,
00251     <span class="comment">/*  27  `   */</span>  0xA3AA,
00252     <span class="comment">/*  28  (   */</span>  0xA1A2,
00253     <span class="comment">/*  29  )   */</span>  0xA1AD,
00254     <span class="comment">/*  2A  *   */</span>  0xA1B1,
00255     <span class="comment">/*  2B  +   */</span>  0xA3AB,
00256     <span class="comment">/*  2C  '   */</span>  0xA4BC,
00257     <span class="comment">/*  2D  -   */</span>  0xA3A9,
00258     <span class="comment">/*  2E  .   */</span>  0xA3AE,
00259     <span class="comment">/*  2F  /   */</span>  0xA4C7,
00260     <span class="comment">/*  30  0   */</span>  0xA4BB,
00261     <span class="comment">/*  31  1   */</span>  0xA4BE,
00262     <span class="comment">/*  32  2   */</span>  0xA4B6,
00263     <span class="comment">/*  33  3   */</span>  0xA4B2,
00264     <span class="comment">/*  34  4   */</span>  0xA4CB,
00265     <span class="comment">/*  35  5   */</span>  0xA4D0,
00266     <span class="comment">/*  36  6   */</span>  0xA4C1,
00267     <span class="comment">/*  37  7   */</span>  0xA4C6,
00268     <span class="comment">/*  38  8   */</span>  0xA4D2,
00269     <span class="comment">/*  39  9   */</span>  0xA4CC,  <span class="comment">//0x0000</span>
00270     <span class="comment">/*  3A  :   */</span>  0xA3B4,
00271     <span class="comment">/*  3B  ;   */</span>  0xA4B2,
00272     <span class="comment">/*  3C  &lt;   */</span>  0xA3A7,
00273     <span class="comment">/*  3D  =   */</span>  0xA1B5,
00274     <span class="comment">/*  3E  &gt;   */</span>  0xA3AE,
00275     <span class="comment">/*  3F  ?   */</span>  0xA3A1,
00276     <span class="comment">/*  40  @   */</span>  0xA4AA,
00277     <span class="comment">/*  41  A   */</span>  0xA4A7,
00278     <span class="comment">/*  42  B   */</span>  0xA3BF,
00279     <span class="comment">/*  43  C   */</span>  0xA4BC,
00280     <span class="comment">/*  44  D   */</span>  0xA4AC,
00281     <span class="comment">/*  45  E   */</span>  0xA4A5,
00282     <span class="comment">/*  46  F   */</span>  0xA4AB,
00283     <span class="comment">/*  47  G   */</span>  0xA4C2,
00284     <span class="comment">/*  48  H   */</span>  0xA3B0,
00285     <span class="comment">/*  49  I   */</span>  0xA3B7,
00286     <span class="comment">/*  4A  J   */</span>  0xA3B1,
00287     <span class="comment">/*  4B  K   */</span>  0xA3B2,
00288     <span class="comment">/*  4C  L   */</span>  0xA3B3,
00289     <span class="comment">/*  4D  M   */</span>  0xA1A8,
00290     <span class="comment">/*  4E  N   */</span>  0xA3AD,
00291     <span class="comment">/*  4F  O   */</span>  0xA3B8,
00292     <span class="comment">/*  50  P   */</span>  0xA3B9,
00293     <span class="comment">/*  51  Q   */</span>  0xA4BD,
00294     <span class="comment">/*  52  R   */</span>  0xA4B0,
00295     <span class="comment">/*  53  S   */</span>  0xA4A6,
00296     <span class="comment">/*  54  T   */</span>  0xA4AD,
00297     <span class="comment">/*  55  U   */</span>  0xA3B6,
00298     <span class="comment">/*  56  V   */</span>  0xA4A3,
00299     <span class="comment">/*  57  W   */</span>  0xA4BC,
00300     <span class="comment">/*  58  X   */</span>  0xA4B4,
00301     <span class="comment">/*  59  Y   */</span>  0xA3B5,
00302     <span class="comment">/*  5A  Z   */</span>  0xA4BA,
00303     <span class="comment">/*  5B  [   */</span>  0xA3A8,
00304     <span class="comment">/*  5C  \   */</span>  0xA3BA,
00305     <span class="comment">/*  5D  ]   */</span>  0xA1B4,
00306     <span class="comment">/*  5E  ^   */</span>  0xA3BD,
00307     <span class="comment">/*  5F  _   */</span>  0xA3BB,
00308     <span class="comment">/*  60  `   */</span>  0xA3AA,
00309     <span class="comment">/*  61  a   */</span>  0xA4B7,
00310     <span class="comment">/*  62  b   */</span>  0xA4CC,
00311     <span class="comment">/*  63  c   */</span>  0xA4C4,
00312     <span class="comment">/*  64  d   */</span>  0xA4D3,
00313     <span class="comment">/*  65  e   */</span>  0xA4C5,
00314     <span class="comment">/*  66  f   */</span>  0xA4BF,
00315     <span class="comment">/*  67  g   */</span>  0xA4D1,
00316     <span class="comment">/*  68  h   */</span>  0xA4A4,
00317     <span class="comment">/*  69  i   */</span>  0xA4B1,
00318     <span class="comment">/*  6A  j   */</span>  0xA4B7,
00319     <span class="comment">/*  6B  k   */</span>  0xA4A1,
00320     <span class="comment">/*  6C  l   */</span>  0xA4B8,
00321     <span class="comment">/*  6D  m   */</span>  0xA4BE,
00322     <span class="comment">/*  6E  n   */</span>  0xA4B5,
00323     <span class="comment">/*  6F  o   */</span>  0xA4BA,
00324     <span class="comment">/*  70  p   */</span>  0xA4BD,
00325     <span class="comment">/*  71  q   */</span>  0xA4B5,
00326     <span class="comment">/*  72  r   */</span>  0xA4C0,
00327     <span class="comment">/*  73  s   */</span>  0xA4A4,
00328     <span class="comment">/*  74  t   */</span>  0xA4C3,
00329     <span class="comment">/*  75  u   */</span>  0xA4A7,
00330     <span class="comment">/*  76  v   */</span>  0xA4C7,
00331     <span class="comment">/*  77  w   */</span>  0xA4A9,
00332     <span class="comment">/*  78  x   */</span>  0xA4A1,
00333     <span class="comment">/*  79  y   */</span>  0xA4B1,
00334     <span class="comment">/*  7A  z   */</span>  0xA4B1,
00335     <span class="comment">/*  7B  {   */</span>  0xA3A5,
00336     <span class="comment">/*  7C  |   */</span>  0xA3CC,
00337     <span class="comment">/*  7D  }   */</span>  0xA3AF,
00338     <span class="comment">/*  7E  ~   */</span>  0xA1AD,
00339                     0x0000
00340     }
00341 };
00342 
<a name="l00343"></a><a class="code" href="../../d6/d3/kcodecnv_8c.html#a12">00343</a> CONST WORD  <a class="code" href="../../d6/d3/kcodecnv_8c.html#a12">wKSCompCode</a>[51] =   <span class="comment">// from 'GiYuk' to 'Yi'.</span>
00344 {
00345     0x8841,0x8C41,0x8444,0x9041,0x8446,0x8447,0x9441,0x9841,0x9C41,0x844A,
00346     0x844B,0x844C,0x844D,0x844E,0x844F,0x8450,0xA041,0xA441,0xA841,0x8454,
00347     0xAC41,0xB041,0xB441,0xB841,0xBC41,0xC041,0xC441,0xC841,0xCC41,0xD041,
00348     0x8461,0x8481,0x84A1,0x84C1,0x84E1,0x8541,0x8561,0x8581,0x85A1,0x85C1,
00349     0x85E1,0x8641,0x8661,0x8681,0x86A1,0x86C1,0x86E1,0x8741,0x8761,0x8781,
00350     0x87A1
00351 };
00352 
<a name="l00353"></a><a class="code" href="../../d6/d3/kcodecnv_8c.html#a13">00353</a> CONST WORD  <a class="code" href="../../d6/d3/kcodecnv_8c.html#a13">wKSCompCode2</a>[30] =   <span class="comment">// from 'GiYuk' to 'HiEut'.</span>
00354 {
00355     0x8442,0x8443,0x8444,0x8445,0x8446,0x8447,0x8448,0x9841,0x8449,0x844A,
00356     0x844B,0x844C,0x844D,0x844E,0x844F,0x8450,0x8451,0x8453,0xA841,0x8454,
00357     0x8455,0x8456,0x8457,0x8458,0xBC41,0x8459,0x845A,0x845B,0x845C,0x845D
00358 };
00359 
00360 
00361 WORD
<a name="l00362"></a><a class="code" href="../../d6/d3/kcodecnv_8c.html#a14">00362</a> <a class="code" href="../../d6/d3/kcodecnv_8c.html#a14">JunjaToBanja</a>(
00363     LPSTR lpSrc,
00364     LPSTR lpDest
00365     )
00366 
00367 <span class="comment">/*++</span>
00368 <span class="comment"></span>
00369 <span class="comment">Routine Description:</span>
00370 <span class="comment"></span>
00371 <span class="comment">Arguments:</span>
00372 <span class="comment"></span>
00373 <span class="comment">Return Value:</span>
00374 <span class="comment"></span>
00375 <span class="comment">--*/</span>
00376 
00377 {
00378     <a class="code" href="../../d2/d9/uniontagWANSUNG.html">WANSUNG</a> wsCode;
00379     WORD    wCount = 0;
00380 
00381     <span class="keywordflow">while</span> (*lpSrc)
00382     {
00383         <span class="keywordflow">if</span> ((<a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a>)(*lpSrc) &lt; (<a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a>)0x80)
00384         {
00385             *<a class="code" href="../../d6/d3/kcodecnv_8c.html#a4">lpDest</a>++ = *lpSrc++;
00386             wCount++;
00387         }
00388         <span class="keywordflow">else</span>
00389         {
00390             wsCode.<a class="code" href="../../d2/d9/uniontagWANSUNG.html#o0">e</a>.<a class="code" href="../../d4/d6/structtagHIGH__LOW.html#o1">high</a> = *lpSrc++;
00391             wsCode.<a class="code" href="../../d2/d9/uniontagWANSUNG.html#o0">e</a>.<a class="code" href="../../d4/d6/structtagHIGH__LOW.html#o0">low</a> = *lpSrc++;
00392             <span class="keywordflow">if</span> (wsCode.<a class="code" href="../../d2/d9/uniontagWANSUNG.html#o1">w</a> == 0xA1A1)
00393             {
00394                 *<a class="code" href="../../d6/d3/kcodecnv_8c.html#a4">lpDest</a>++ = <span class="charliteral">' '</span>;
00395                 wCount++;
00396             }
00397             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (wsCode.<a class="code" href="../../d2/d9/uniontagWANSUNG.html#o1">w</a> &gt;= 0xA3A1 &amp;&amp; wsCode.<a class="code" href="../../d2/d9/uniontagWANSUNG.html#o1">w</a> &lt;= 0xA3FE)
00398             {
00399                 *<a class="code" href="../../d6/d3/kcodecnv_8c.html#a4">lpDest</a>++ = wsCode.<a class="code" href="../../d2/d9/uniontagWANSUNG.html#o0">e</a>.<a class="code" href="../../d4/d6/structtagHIGH__LOW.html#o0">low</a> - (<a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a>)0x80;
00400                 wCount++;
00401             }
00402             <span class="keywordflow">else</span>
00403             {
00404                 *<a class="code" href="../../d6/d3/kcodecnv_8c.html#a4">lpDest</a>++ = wsCode.<a class="code" href="../../d2/d9/uniontagWANSUNG.html#o0">e</a>.<a class="code" href="../../d4/d6/structtagHIGH__LOW.html#o1">high</a>;
00405                 *<a class="code" href="../../d6/d3/kcodecnv_8c.html#a4">lpDest</a>++ = wsCode.<a class="code" href="../../d2/d9/uniontagWANSUNG.html#o0">e</a>.<a class="code" href="../../d4/d6/structtagHIGH__LOW.html#o0">low</a>;
00406                 wCount += 2;
00407             }
00408         }
00409     }
00410     *<a class="code" href="../../d6/d3/kcodecnv_8c.html#a4">lpDest</a> = <span class="charliteral">'\0'</span>;
00411     <span class="keywordflow">return</span> (wCount);
00412 }
00413 
00414 WORD
<a name="l00415"></a><a class="code" href="../../d6/d3/kcodecnv_8c.html#a15">00415</a> <a class="code" href="../../d6/d3/kcodecnv_8c.html#a15">BanjaToJunja</a>(
00416     LPSTR lpSrc,
00417     LPSTR lpDest
00418     )
00419 
00420 <span class="comment">/*++</span>
00421 <span class="comment"></span>
00422 <span class="comment">Routine Description:</span>
00423 <span class="comment"></span>
00424 <span class="comment">Arguments:</span>
00425 <span class="comment"></span>
00426 <span class="comment">Return Value:</span>
00427 <span class="comment"></span>
00428 <span class="comment">--*/</span>
00429 
00430 {
00431     WORD    wCount = 0;
00432 
00433     <span class="keywordflow">while</span> (*lpSrc)
00434     {
00435         <span class="keywordflow">if</span> ((<a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a>)(*lpSrc) &lt; (<a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a>)0x80)
00436         {
00437             <span class="keywordflow">if</span> (*lpSrc++ == <span class="charliteral">' '</span>)
00438             {
00439                 *<a class="code" href="../../d6/d3/kcodecnv_8c.html#a4">lpDest</a>++ = (<a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a>)0xA1;
00440                 *<a class="code" href="../../d6/d3/kcodecnv_8c.html#a4">lpDest</a>++ = (<a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a>)0xA1;
00441                 wCount += 2;
00442             }
00443             <span class="keywordflow">else</span>
00444             {
00445                 *<a class="code" href="../../d6/d3/kcodecnv_8c.html#a4">lpDest</a>++ = (<a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a>)0xA3;
00446                 *<a class="code" href="../../d6/d3/kcodecnv_8c.html#a4">lpDest</a>++ = *(lpSrc - 1) + (<a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a>)0x80;
00447                 wCount += 2;
00448             }
00449         }
00450         <span class="keywordflow">else</span>
00451         {
00452             *<a class="code" href="../../d6/d3/kcodecnv_8c.html#a4">lpDest</a>++ = *lpSrc++;
00453             *<a class="code" href="../../d6/d3/kcodecnv_8c.html#a4">lpDest</a>++ = *lpSrc++;
00454             wCount += 2;
00455         }
00456     }
00457     *<a class="code" href="../../d6/d3/kcodecnv_8c.html#a4">lpDest</a> = <span class="charliteral">'\0'</span>;
00458     <span class="keywordflow">return</span> (wCount);
00459 }
00460 
00461 WORD
<a name="l00462"></a><a class="code" href="../../d6/d3/kcodecnv_8c.html#a16">00462</a> <a class="code" href="../../d6/d3/kcodecnv_8c.html#a16">JohabToKs</a>(
00463     LPSTR lpSrc,
00464     LPSTR lpDest
00465     )
00466 
00467 <span class="comment">/*++</span>
00468 <span class="comment"></span>
00469 <span class="comment">Routine Description:</span>
00470 <span class="comment"></span>
00471 <span class="comment">Arguments:</span>
00472 <span class="comment"></span>
00473 <span class="comment">Return Value:</span>
00474 <span class="comment"></span>
00475 <span class="comment">--*/</span>
00476 
00477 {
00478     WORD    wCount = 0;
00479 <span class="preprocessor">#if defined(OLD_CONV)</span>
00480 <span class="preprocessor"></span>    <a class="code" href="../../d2/d9/uniontagWANSUNG.html">WANSUNG</a> wsSCode, wsDCode;
00481     <span class="keywordtype">int</span>     iHead = 0, iTail = 2349, iMid;
00482     <a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a>    bCount;
00483 <span class="preprocessor">#endif</span>
00484 <span class="preprocessor"></span>
00485     <span class="keywordflow">while</span> (*lpSrc)
00486     {
00487         <span class="keywordflow">if</span> ((<a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a>)(*lpSrc) &lt; (<a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a>)0x80)
00488         {
00489             *<a class="code" href="../../d6/d3/kcodecnv_8c.html#a4">lpDest</a>++ = *lpSrc++;
00490             wCount++;
00491         }
00492         <span class="keywordflow">else</span>
00493 <span class="preprocessor">#if defined(OLD_CONV)</span>
00494 <span class="preprocessor"></span>        {
00495             wsSCode.<a class="code" href="../../d2/d9/uniontagWANSUNG.html#o0">e</a>.<a class="code" href="../../d4/d6/structtagHIGH__LOW.html#o1">high</a> = *lpSrc++;
00496             wsSCode.<a class="code" href="../../d2/d9/uniontagWANSUNG.html#o0">e</a>.<a class="code" href="../../d4/d6/structtagHIGH__LOW.html#o0">low</a> = *lpSrc++;
00497             <span class="keywordflow">for</span> (bCount = 0; bCount &lt; 51 &amp;&amp; <a class="code" href="../../d6/d3/kcodecnv_8c.html#a12">wKSCompCode</a>[bCount] != wsSCode.<a class="code" href="../../d2/d9/uniontagWANSUNG.html#o1">w</a>; bCount++)
00498                 ;
00499             wsDCode.<a class="code" href="../../d2/d9/uniontagWANSUNG.html#o1">w</a> = (bCount == 51)? 0: bCount + 0xA4A1;
00500             <span class="keywordflow">if</span> (wsDCode.<a class="code" href="../../d2/d9/uniontagWANSUNG.html#o1">w</a>)
00501             {
00502                 *<a class="code" href="../../d6/d3/kcodecnv_8c.html#a4">lpDest</a>++ = wsDCode.<a class="code" href="../../d2/d9/uniontagWANSUNG.html#o0">e</a>.<a class="code" href="../../d4/d6/structtagHIGH__LOW.html#o1">high</a>;
00503                 *<a class="code" href="../../d6/d3/kcodecnv_8c.html#a4">lpDest</a>++ = wsDCode.<a class="code" href="../../d2/d9/uniontagWANSUNG.html#o0">e</a>.<a class="code" href="../../d4/d6/structtagHIGH__LOW.html#o0">low</a>;
00504                 wCount += 2;
00505                 <span class="keywordflow">continue</span>;
00506             }
00507             <span class="keywordflow">for</span> (bCount = 0; bCount &lt; 30 &amp;&amp; <a class="code" href="../../d6/d3/kcodecnv_8c.html#a13">wKSCompCode2</a>[bCount] != wsSCode.<a class="code" href="../../d2/d9/uniontagWANSUNG.html#o1">w</a>; bCount++)
00508                 ;
00509             wsDCode.<a class="code" href="../../d2/d9/uniontagWANSUNG.html#o1">w</a> = (bCount == 30)? 0: bCount + 0xA4A1;
00510             <span class="keywordflow">if</span> (wsDCode.<a class="code" href="../../d2/d9/uniontagWANSUNG.html#o1">w</a>)
00511             {
00512                 *<a class="code" href="../../d6/d3/kcodecnv_8c.html#a4">lpDest</a>++ = wsDCode.<a class="code" href="../../d2/d9/uniontagWANSUNG.html#o0">e</a>.<a class="code" href="../../d4/d6/structtagHIGH__LOW.html#o1">high</a>;
00513                 *<a class="code" href="../../d6/d3/kcodecnv_8c.html#a4">lpDest</a>++ = wsDCode.<a class="code" href="../../d2/d9/uniontagWANSUNG.html#o0">e</a>.<a class="code" href="../../d4/d6/structtagHIGH__LOW.html#o0">low</a>;
00514                 wCount += 2;
00515                 <span class="keywordflow">continue</span>;
00516             }
00517             <span class="keywordflow">while</span> (iHead &lt;= iTail &amp;&amp; !wsDCode.<a class="code" href="../../d2/d9/uniontagWANSUNG.html#o1">w</a>)
00518             {
00519                 iMid = (iHead + iTail) / 2;
00520                 <span class="keywordflow">if</span> (wKSCharCode[iMid] &gt; wsSCode.<a class="code" href="../../d2/d9/uniontagWANSUNG.html#o1">w</a>)
00521                     iTail = iMid - 1;
00522                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> (wKSCharCode[iMid] &lt; wsSCode.<a class="code" href="../../d2/d9/uniontagWANSUNG.html#o1">w</a>)
00523                     iHead = iMid + 1;
00524                 <span class="keywordflow">else</span>
00525                     wsDCode.<a class="code" href="../../d2/d9/uniontagWANSUNG.html#o1">w</a> = ((iMid / 94 + 0xB0) &lt;&lt; 8) | (iMid % 94 + 0xA1);
00526             }
00527             <span class="keywordflow">if</span> (wsDCode.<a class="code" href="../../d2/d9/uniontagWANSUNG.html#o1">w</a>)
00528             {
00529                 *<a class="code" href="../../d6/d3/kcodecnv_8c.html#a4">lpDest</a>++ = wsDCode.<a class="code" href="../../d2/d9/uniontagWANSUNG.html#o0">e</a>.<a class="code" href="../../d4/d6/structtagHIGH__LOW.html#o1">high</a>;
00530                 *<a class="code" href="../../d6/d3/kcodecnv_8c.html#a4">lpDest</a>++ = wsDCode.<a class="code" href="../../d2/d9/uniontagWANSUNG.html#o0">e</a>.<a class="code" href="../../d4/d6/structtagHIGH__LOW.html#o0">low</a>;
00531                 wCount += 2;
00532             }
00533             <span class="keywordflow">else</span>
00534             {
00535                 *<a class="code" href="../../d6/d3/kcodecnv_8c.html#a4">lpDest</a>++ = wsSCode.<a class="code" href="../../d2/d9/uniontagWANSUNG.html#o0">e</a>.<a class="code" href="../../d4/d6/structtagHIGH__LOW.html#o1">high</a>;
00536                 *<a class="code" href="../../d6/d3/kcodecnv_8c.html#a4">lpDest</a>++ = wsSCode.<a class="code" href="../../d2/d9/uniontagWANSUNG.html#o0">e</a>.<a class="code" href="../../d4/d6/structtagHIGH__LOW.html#o0">low</a>;
00537                 wCount += 2;
00538             }
00539         }
00540 <span class="preprocessor">#else</span>
00541 <span class="preprocessor"></span>        {
00542                 <span class="comment">// for simple implementation, converting one character by character</span>
00543                 <span class="comment">// we have to change it string to string conversion.</span>
00544                 WCHAR wUni;
00545                 <a class="code" href="../../d1/d1/bench_8c.html#a16">CHAR</a>  chTmp[2];
00546 
00547                 chTmp[0] = *lpSrc++;
00548                 chTmp[1] = *lpSrc++;
00549 
00550                 MultiByteToWideChar(<a class="code" href="../../d6/d3/kcodecnv_8c.html#a5">JOHAB_CP</a>, MB_PRECOMPOSED, chTmp, <a class="code" href="../../d6/d3/kcodecnv_8c.html#a7">TWO_BYTE</a>, &amp;wUni, <a class="code" href="../../d6/d3/kcodecnv_8c.html#a8">ONE_WORD</a>);
00551 
00552                 WideCharToMultiByte(<a class="code" href="../../d6/d3/kcodecnv_8c.html#a6">WANSUNG_CP</a>, 0, &amp;wUni, <a class="code" href="../../d6/d3/kcodecnv_8c.html#a8">ONE_WORD</a>, chTmp, <a class="code" href="../../d6/d3/kcodecnv_8c.html#a7">TWO_BYTE</a>, <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>, <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>);
00553 
00554                 *<a class="code" href="../../d6/d3/kcodecnv_8c.html#a4">lpDest</a>++ = chTmp[0];
00555                 *<a class="code" href="../../d6/d3/kcodecnv_8c.html#a4">lpDest</a>++ = chTmp[1];
00556 
00557                 wCount += 2;
00558         }
00559 <span class="preprocessor">#endif</span>
00560 <span class="preprocessor"></span>    }
00561     *<a class="code" href="../../d6/d3/kcodecnv_8c.html#a4">lpDest</a> = <span class="charliteral">'\0'</span>;
00562     <span class="keywordflow">return</span> (wCount);
00563 }
00564 
00565 WORD
<a name="l00566"></a><a class="code" href="../../d6/d3/kcodecnv_8c.html#a17">00566</a> <a class="code" href="../../d6/d3/kcodecnv_8c.html#a17">KsToJohab</a>(
00567     LPSTR lpSrc,
00568     LPSTR lpDest
00569     )
00570 
00571 <span class="comment">/*++</span>
00572 <span class="comment"></span>
00573 <span class="comment">Routine Description:</span>
00574 <span class="comment"></span>
00575 <span class="comment">Arguments:</span>
00576 <span class="comment"></span>
00577 <span class="comment">Return Value:</span>
00578 <span class="comment"></span>
00579 <span class="comment">--*/</span>
00580 
00581 {
00582 <span class="preprocessor">#if defined(OLD_CONV)</span>
00583 <span class="preprocessor"></span>    <a class="code" href="../../d2/d9/uniontagWANSUNG.html">WANSUNG</a> wsSCode, wsDCode;
00584     WORD    wCount = 0, wLoc;
00585 <span class="preprocessor">#else</span>
00586 <span class="preprocessor"></span>    WORD    wCount = 0;
00587 <span class="preprocessor">#endif</span>
00588 <span class="preprocessor"></span>
00589     <span class="keywordflow">while</span> (*lpSrc)
00590     {
00591         <span class="keywordflow">if</span> ((<a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a>)(*lpSrc) &lt; (<a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a>)0x80)
00592         {
00593             *<a class="code" href="../../d6/d3/kcodecnv_8c.html#a4">lpDest</a>++ = *lpSrc++;
00594             wCount++;
00595         }
00596         <span class="keywordflow">else</span>
00597 <span class="preprocessor">#if defined(OLD_CONV)</span>
00598 <span class="preprocessor"></span>        {
00599             wsSCode.<a class="code" href="../../d2/d9/uniontagWANSUNG.html#o0">e</a>.<a class="code" href="../../d4/d6/structtagHIGH__LOW.html#o1">high</a> = *lpSrc++;
00600             wsSCode.<a class="code" href="../../d2/d9/uniontagWANSUNG.html#o0">e</a>.<a class="code" href="../../d4/d6/structtagHIGH__LOW.html#o0">low</a> = *lpSrc++;
00601             <span class="keywordflow">if</span> (wsSCode.<a class="code" href="../../d2/d9/uniontagWANSUNG.html#o1">w</a> &gt;= (WORD)0xA4A1 &amp;&amp; wsSCode.<a class="code" href="../../d2/d9/uniontagWANSUNG.html#o1">w</a> &lt;= (WORD)0xA4D3)
00602             {
00603                 wsDCode.<a class="code" href="../../d2/d9/uniontagWANSUNG.html#o1">w</a> = <a class="code" href="../../d6/d3/kcodecnv_8c.html#a12">wKSCompCode</a>[wsSCode.<a class="code" href="../../d2/d9/uniontagWANSUNG.html#o1">w</a> - 0xA4A1];
00604                 *<a class="code" href="../../d6/d3/kcodecnv_8c.html#a4">lpDest</a>++ = wsDCode.<a class="code" href="../../d2/d9/uniontagWANSUNG.html#o0">e</a>.<a class="code" href="../../d4/d6/structtagHIGH__LOW.html#o1">high</a>;
00605                 *<a class="code" href="../../d6/d3/kcodecnv_8c.html#a4">lpDest</a>++ = wsDCode.<a class="code" href="../../d2/d9/uniontagWANSUNG.html#o0">e</a>.<a class="code" href="../../d4/d6/structtagHIGH__LOW.html#o0">low</a>;
00606             }
00607             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (wsSCode.<a class="code" href="../../d2/d9/uniontagWANSUNG.html#o1">w</a> &gt;= (WORD)0xB0A1 &amp;&amp; wsSCode.<a class="code" href="../../d2/d9/uniontagWANSUNG.html#o1">w</a> &lt;= (WORD)0xC8FE
00608                     &amp;&amp; wsSCode.<a class="code" href="../../d2/d9/uniontagWANSUNG.html#o0">e</a>.<a class="code" href="../../d4/d6/structtagHIGH__LOW.html#o0">low</a> != (<a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a>)0xFF)
00609             {
00610                 wLoc = (wsSCode.<a class="code" href="../../d2/d9/uniontagWANSUNG.html#o0">e</a>.<a class="code" href="../../d4/d6/structtagHIGH__LOW.html#o1">high</a> - 176) * 94;
00611                 wLoc += wsSCode.<a class="code" href="../../d2/d9/uniontagWANSUNG.html#o0">e</a>.<a class="code" href="../../d4/d6/structtagHIGH__LOW.html#o0">low</a>  - 161;
00612                 wsDCode.<a class="code" href="../../d2/d9/uniontagWANSUNG.html#o1">w</a> = wKSCharCode[wLoc];
00613                 *<a class="code" href="../../d6/d3/kcodecnv_8c.html#a4">lpDest</a>++ = wsDCode.<a class="code" href="../../d2/d9/uniontagWANSUNG.html#o0">e</a>.<a class="code" href="../../d4/d6/structtagHIGH__LOW.html#o1">high</a>;
00614                 *<a class="code" href="../../d6/d3/kcodecnv_8c.html#a4">lpDest</a>++ = wsDCode.<a class="code" href="../../d2/d9/uniontagWANSUNG.html#o0">e</a>.<a class="code" href="../../d4/d6/structtagHIGH__LOW.html#o0">low</a>;
00615             }
00616             <span class="keywordflow">else</span>
00617             {
00618                 *<a class="code" href="../../d6/d3/kcodecnv_8c.html#a4">lpDest</a>++ = wsSCode.<a class="code" href="../../d2/d9/uniontagWANSUNG.html#o0">e</a>.<a class="code" href="../../d4/d6/structtagHIGH__LOW.html#o1">high</a>;
00619                 *<a class="code" href="../../d6/d3/kcodecnv_8c.html#a4">lpDest</a>++ = wsSCode.<a class="code" href="../../d2/d9/uniontagWANSUNG.html#o0">e</a>.<a class="code" href="../../d4/d6/structtagHIGH__LOW.html#o0">low</a>;
00620             }
00621             wCount += 2;
00622         }
00623 <span class="preprocessor">#else</span>
00624 <span class="preprocessor"></span>        {
00625             WCHAR wUni;
00626             <a class="code" href="../../d1/d1/bench_8c.html#a16">CHAR</a>  chTmp[2];
00627 
00628             chTmp[0] = *lpSrc++;
00629             chTmp[1] = *lpSrc++;
00630 
00631             MultiByteToWideChar(<a class="code" href="../../d6/d3/kcodecnv_8c.html#a6">WANSUNG_CP</a>, MB_PRECOMPOSED, chTmp, <a class="code" href="../../d6/d3/kcodecnv_8c.html#a7">TWO_BYTE</a>, &amp;wUni, <a class="code" href="../../d6/d3/kcodecnv_8c.html#a8">ONE_WORD</a>);
00632 
00633             WideCharToMultiByte(<a class="code" href="../../d6/d3/kcodecnv_8c.html#a5">JOHAB_CP</a>, 0, &amp;wUni, <a class="code" href="../../d6/d3/kcodecnv_8c.html#a8">ONE_WORD</a>, chTmp, <a class="code" href="../../d6/d3/kcodecnv_8c.html#a7">TWO_BYTE</a>, <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>, <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>);
00634 
00635             *<a class="code" href="../../d6/d3/kcodecnv_8c.html#a4">lpDest</a>++ = chTmp[0];
00636             *<a class="code" href="../../d6/d3/kcodecnv_8c.html#a4">lpDest</a>++ = chTmp[1];
00637 
00638             wCount += 2;
00639         }
00640 <span class="preprocessor">#endif</span>
00641 <span class="preprocessor"></span>    }
00642     *<a class="code" href="../../d6/d3/kcodecnv_8c.html#a4">lpDest</a> = <span class="charliteral">'\0'</span>;
00643     <span class="keywordflow">return</span> (wCount);
00644 }
00645 
00646 LRESULT
<a name="l00647"></a><a class="code" href="../../d6/d3/kcodecnv_8c.html#a18">00647</a> <a class="code" href="../../d6/d3/kcodecnv_8c.html#a18">TransCodeConvert</a>(
00648     HIMC hIMC,
00649     LPIMESTRUCT lpIme
00650     )
00651 
00652 <span class="comment">/*++</span>
00653 <span class="comment"></span>
00654 <span class="comment">Routine Description:</span>
00655 <span class="comment"></span>
00656 <span class="comment">Arguments:</span>
00657 <span class="comment"></span>
00658 <span class="comment">Return Value:</span>
00659 <span class="comment"></span>
00660 <span class="comment">--*/</span>
00661 
00662 {
00663     UNREFERENCED_PARAMETER(hIMC);
00664 
00665     <span class="keywordflow">switch</span> (lpIme-&gt;wParam)
00666     {
00667         <span class="keywordflow">case</span> IME_JUNJAtoBANJA:
00668             lpIme-&gt;wCount = <a class="code" href="../../d6/d3/kcodecnv_8c.html#a14">JunjaToBanja</a>(<a class="code" href="../../d6/d3/kcodecnv_8c.html#a3">lpSource</a>(lpIme), <a class="code" href="../../d6/d3/kcodecnv_8c.html#a4">lpDest</a>(lpIme));
00669             <span class="keywordflow">break</span>;
00670 
00671         <span class="keywordflow">case</span> IME_BANJAtoJUNJA:
00672             lpIme-&gt;wCount = <a class="code" href="../../d6/d3/kcodecnv_8c.html#a15">BanjaToJunja</a>(<a class="code" href="../../d6/d3/kcodecnv_8c.html#a3">lpSource</a>(lpIme), <a class="code" href="../../d6/d3/kcodecnv_8c.html#a4">lpDest</a>(lpIme));
00673             <span class="keywordflow">break</span>;
00674 
00675         <span class="keywordflow">case</span> IME_JOHABtoKS:
00676             lpIme-&gt;wCount = <a class="code" href="../../d6/d3/kcodecnv_8c.html#a16">JohabToKs</a>(<a class="code" href="../../d6/d3/kcodecnv_8c.html#a3">lpSource</a>(lpIme), <a class="code" href="../../d6/d3/kcodecnv_8c.html#a4">lpDest</a>(lpIme));
00677             <span class="keywordflow">break</span>;
00678 
00679         <span class="keywordflow">case</span> IME_KStoJOHAB:
00680             lpIme-&gt;wCount = <a class="code" href="../../d6/d3/kcodecnv_8c.html#a17">KsToJohab</a>(<a class="code" href="../../d6/d3/kcodecnv_8c.html#a3">lpSource</a>(lpIme), <a class="code" href="../../d6/d3/kcodecnv_8c.html#a4">lpDest</a>(lpIme));
00681             <span class="keywordflow">break</span>;
00682 
00683         <span class="keywordflow">default</span>:
00684             lpIme-&gt;wCount = 0;
00685     }
00686     <span class="keywordflow">return</span> (lpIme-&gt;wCount);
00687 }
00688 
<a name="l00689"></a><a class="code" href="../../d6/d3/kcodecnv_8c.html#a19">00689</a> LRESULT <a class="code" href="../../d6/d3/kcodecnv_8c.html#a19">TransConvertList</a>( HIMC hImc, LPIMESTRUCT lpIme)
00690 {
00691     LPSTR           lpSrc;
00692     LPSTR           lpDst;
00693     HGLOBAL         hCandList;
00694     LPCANDIDATELIST lpCandList;
00695     LPSTR           lpCandStr;
00696     <a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a>            i, uBufLen;
00697     LRESULT         lRet = 0;
00698 
00699     lpSrc = <a class="code" href="../../d6/d3/kcodecnv_8c.html#a3">lpSource</a>(lpIme);
00700     lpDst = <a class="code" href="../../d6/d3/kcodecnv_8c.html#a4">lpDest</a>(lpIme);
00701     uBufLen = <a class="code" href="../../d4/d1/ctxtinfo_8c.html#a37">ImmGetConversionListA</a>(<a class="code" href="../../d3/d8/client_8c.html#a154">GetKeyboardLayout</a>(0), hImc, (LPCSTR)lpSrc,
00702             <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>, 0, GCL_CONVERSION);
00703     <span class="keywordflow">if</span> (uBufLen)
00704     {
00705         hCandList = GlobalAlloc(GHND, uBufLen);
00706         lpCandList = (LPCANDIDATELIST)GlobalLock(hCandList);
00707         lRet = <a class="code" href="../../d4/d1/ctxtinfo_8c.html#a37">ImmGetConversionListA</a>(<a class="code" href="../../d3/d8/client_8c.html#a154">GetKeyboardLayout</a>(0), hImc, (LPCSTR)lpSrc,
00708                 lpCandList, uBufLen, GCL_CONVERSION);
00709         <span class="keywordflow">for</span> (i = 0; i &lt; lpCandList-&gt;dwCount; i++)
00710         {
00711             lpCandStr = (LPSTR)lpCandList + lpCandList-&gt;dwOffset[i];
00712             *lpDst++ = *lpCandStr++;
00713             *lpDst++ = *lpCandStr++;
00714         }
00715         *lpDst = <span class="charliteral">'\0'</span>;
00716         lpIme-&gt;wCount = (WORD)lpCandList-&gt;dwCount * 2;
00717         GlobalUnlock(hCandList);
00718         GlobalFree(hCandList);
00719     }
00720     <span class="keywordflow">return</span> (lRet);
00721 }
00722 
<a name="l00723"></a><a class="code" href="../../d6/d3/kcodecnv_8c.html#a20">00723</a> LRESULT <a class="code" href="../../d6/d3/kcodecnv_8c.html#a20">TransGetMNTable</a>( HIMC hImc, LPIMESTRUCT lpIme)
00724 {
00725     LPSTR   lpMnemonic;
00726     <span class="keywordtype">int</span>     iCount, iCIM;
00727 
00728     UNREFERENCED_PARAMETER(hImc);
00729 
00730     lpMnemonic = (LPSTR)(lpIme-&gt;lParam1);
00731 <span class="comment">// BUGBUG: Will be changed to use Registry instead of WIN.INI</span>
00732     iCIM = GetProfileInt(<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="stringliteral">"WANSUNG"</span>, <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="stringliteral">"InputMethod"</span>, <a class="code" href="../../d6/d3/kcodecnv_8c.html#a0">IDD_2BEOL</a>) - <a class="code" href="../../d6/d3/kcodecnv_8c.html#a0">IDD_2BEOL</a>;
00733     <span class="keywordflow">for</span> (iCount = 0; iCount &lt; 96; iCount++, lpMnemonic += 2)
00734         {
00735         *lpMnemonic = <a class="code" href="../../d5/d9/ntrtlp_8h.html#a4">LOBYTE</a>(<a class="code" href="../../d6/d3/kcodecnv_8c.html#a11">HMNTable</a>[iCIM][iCount]);
00736         *(lpMnemonic+1) = <a class="code" href="../../d5/d9/ntrtlp_8h.html#a5">HIBYTE</a>(<a class="code" href="../../d6/d3/kcodecnv_8c.html#a11">HMNTable</a>[iCIM][iCount]);
00737         }
00738     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00739 }
</div></pre><hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:40:33 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
