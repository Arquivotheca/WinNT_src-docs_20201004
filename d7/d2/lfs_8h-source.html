<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: lfs.h Source File</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>lfs.h</h1><a href="../../d6/d3/lfs_8h.html">Go to the documentation of this file.</a><pre class="fragment"><div>00001 <span class="comment">/*++ BUILD Version: 0000    // Increment this if a change has global effects</span>
00002 <span class="comment"></span>
00003 <span class="comment">Copyright (c) 1989  Microsoft Corporation</span>
00004 <span class="comment"></span>
00005 <span class="comment">Module Name:</span>
00006 <span class="comment"></span>
00007 <span class="comment">    Lfs.h</span>
00008 <span class="comment"></span>
00009 <span class="comment">Abstract:</span>
00010 <span class="comment"></span>
00011 <span class="comment">    This module contains the public data structures and procedure</span>
00012 <span class="comment">    prototypes for the Log File Service.</span>
00013 <span class="comment"></span>
00014 <span class="comment">Author:</span>
00015 <span class="comment">    Brian Andrew    [BrianAn]   20-June-1991</span>
00016 <span class="comment"></span>
00017 <span class="comment"></span>
00018 <span class="comment">Revision History:</span>
00019 <span class="comment"></span>
00020 <span class="comment">--*/</span>
00021 
00022 <span class="preprocessor">#ifndef _LFS_</span>
00023 <span class="preprocessor"></span><span class="preprocessor">#define _LFS_</span>
00024 <span class="preprocessor"></span>
00025 <span class="comment">//</span>
00026 <span class="comment">// The Multi-Sector Header and Update Sequence Array provide detection of</span>
00027 <span class="comment">// incomplete multi-sector transfers for devices which either have a</span>
00028 <span class="comment">// physical sector size equal to the Sequence Number Stride or greater, or</span>
00029 <span class="comment">// which do not transfer sectors out of order.  If a device exists which has</span>
00030 <span class="comment">// a sector size smaller than the Sequence Number Stride *and* it sometimes</span>
00031 <span class="comment">// transfers sectors out of order, then the Update Sequence Array will not</span>
00032 <span class="comment">// provide absolute detection of incomplete transfers.  The Sequence Number</span>
00033 <span class="comment">// Stride is set to a small enough number to provide absolute protection for</span>
00034 <span class="comment">// all known hard disks.  It is not set any smaller, in order to avoid</span>
00035 <span class="comment">// excessive run time and space overhead.</span>
00036 <span class="comment">//</span>
00037 <span class="comment">// The Multi-Sector Header contains space for a four-byte signature for the</span>
00038 <span class="comment">// convenience of its user.  It then provides the offset to and length of the</span>
00039 <span class="comment">// the Update Sequence Array.  The Update Sequence Array consists of an array</span>
00040 <span class="comment">// of n saved USHORTs, where n is the size of the structure being protected</span>
00041 <span class="comment">// divided by the sequence number stride.  (The size of structure being</span>
00042 <span class="comment">// protected must be a nonzero power of 2 times the Sequence Number Stride,</span>
00043 <span class="comment">// and less than or equal to the physical page size of the machine.)  The</span>
00044 <span class="comment">// first word of the Update Sequence Array contains the Update Sequence Number,</span>
00045 <span class="comment">// which is a cyclical counter (however 0 is not used) of the number of times</span>
00046 <span class="comment">// the containing structure has been written to disk.  Following the Update</span>
00047 <span class="comment">// Sequence Number are the n saved USHORTs which were overwritten by the</span>
00048 <span class="comment">// Update Sequence Number the last time the containing structure was</span>
00049 <span class="comment">// written to disk.</span>
00050 <span class="comment">//</span>
00051 <span class="comment">// In detail, just prior to each time the protected structure is written to</span>
00052 <span class="comment">// disk, the last word in each Sequence Number Stride is saved to its</span>
00053 <span class="comment">// respective position in the Sequence Number Array, and then it is overwritten</span>
00054 <span class="comment">// with the next Update Sequence Number.  Just after this write, or whenever</span>
00055 <span class="comment">// reading the structure, the saved word from the Sequence Number Array is</span>
00056 <span class="comment">// restored to its actual position in the structure.  Before restoring the</span>
00057 <span class="comment">// saved words on reads, all of the sequence numbers at the end of each</span>
00058 <span class="comment">// stride are compared with the actual sequence number at the start of the</span>
00059 <span class="comment">// array.  If any of these compares come up not equal, then a failed</span>
00060 <span class="comment">// multi-sector transfer has been detected.</span>
00061 <span class="comment">//</span>
00062 <span class="comment">// The size of the array is determined by the size of the containing structure.</span>
00063 <span class="comment">// As a C detail, the array is declared here with a size of 1, since its</span>
00064 <span class="comment">// actual size can only be determined at runtime.</span>
00065 <span class="comment">//</span>
00066 <span class="comment">// The Update Sequence Array should be included at the end of the header of</span>
00067 <span class="comment">// the structure it is protecting, since it is variable size.  Its user must</span>
00068 <span class="comment">// insure that the correct size is reserved for it, namely:</span>
00069 <span class="comment">//</span>
00070 <span class="comment">//      (sizeof-structure / SEQUENCE_NUMBER_STRIDE + 1) * sizeof(USHORT)</span>
00071 <span class="comment">//</span>
00072 
<a name="l00073"></a><a class="code" href="../../d6/d3/lfs_8h.html#a0">00073</a> <span class="preprocessor">#define SEQUENCE_NUMBER_STRIDE           (512)</span>
00074 <span class="preprocessor"></span>
<a name="l00075"></a><a class="code" href="../../d6/d3/lfs_8h.html#a2">00075</a> <span class="keyword">typedef</span> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a> <a class="code" href="../../d6/d3/lfs_8h.html#a2">UPDATE_SEQUENCE_NUMBER</a>, *<a class="code" href="../../d6/d3/lfs_8h.html#a3">PUPDATE_SEQUENCE_NUMBER</a>;
00076 
00077 <span class="comment">//</span>
00078 <span class="comment">// This structure must be allocated at the start of the structure being</span>
00079 <span class="comment">// protected.</span>
00080 <span class="comment">//</span>
00081 
00082 <span class="preprocessor">#if !defined( _AUTOCHECK_ )</span>
00083 <span class="preprocessor"></span>
<a name="l00084"></a><a class="code" href="../../d2/d1/struct__MULTI__SECTOR__HEADER.html">00084</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d2/d1/struct__MULTI__SECTOR__HEADER.html">_MULTI_SECTOR_HEADER</a> {
00085 
00086     <span class="comment">//</span>
00087     <span class="comment">// Space for a four-character signature</span>
00088     <span class="comment">//</span>
00089 
<a name="l00090"></a><a class="code" href="../../d2/d1/struct__MULTI__SECTOR__HEADER.html#o0">00090</a>     UCHAR <a class="code" href="../../d2/d1/struct__MULTI__SECTOR__HEADER.html#o0">Signature</a>[4];
00091 
00092     <span class="comment">//</span>
00093     <span class="comment">// Offset to Update Sequence Array, from start of structure.  The Update</span>
00094     <span class="comment">// Sequence Array must end before the last USHORT in the first "sector"</span>
00095     <span class="comment">// of size SEQUENCE_NUMBER_STRIDE.  (I.e., with the current constants,</span>
00096     <span class="comment">// the sum of the next two fields must be &lt;= 510.)</span>
00097     <span class="comment">//</span>
00098 
<a name="l00099"></a><a class="code" href="../../d2/d1/struct__MULTI__SECTOR__HEADER.html#o1">00099</a>     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a> <a class="code" href="../../d2/d1/struct__MULTI__SECTOR__HEADER.html#o1">UpdateSequenceArrayOffset</a>;
00100 
00101     <span class="comment">//</span>
00102     <span class="comment">// Size of Update Sequence Array (from above formula)</span>
00103     <span class="comment">//</span>
00104 
<a name="l00105"></a><a class="code" href="../../d2/d1/struct__MULTI__SECTOR__HEADER.html#o2">00105</a>     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a> <a class="code" href="../../d2/d1/struct__MULTI__SECTOR__HEADER.html#o2">UpdateSequenceArraySize</a>;
00106 
00107 } <a class="code" href="../../d2/d1/struct__MULTI__SECTOR__HEADER.html">MULTI_SECTOR_HEADER</a>, *<a class="code" href="../../d2/d1/struct__MULTI__SECTOR__HEADER.html">PMULTI_SECTOR_HEADER</a>;
00108 
00109 <span class="preprocessor">#endif</span>
00110 <span class="preprocessor"></span>
00111 <span class="comment">//</span>
00112 <span class="comment">// This array must be present at the offset described above.</span>
00113 <span class="comment">//</span>
00114 
<a name="l00115"></a><a class="code" href="../../d6/d3/lfs_8h.html#a6">00115</a> <span class="keyword">typedef</span> <a class="code" href="../../d6/d3/lfs_8h.html#a2">UPDATE_SEQUENCE_NUMBER</a> <a class="code" href="../../d6/d3/lfs_8h.html#a6">UPDATE_SEQUENCE_ARRAY</a>[1];
00116 
<a name="l00117"></a><a class="code" href="../../d6/d3/lfs_8h.html#a7">00117</a> <span class="keyword">typedef</span> <a class="code" href="../../d6/d3/lfs_8h.html#a6">UPDATE_SEQUENCE_ARRAY</a> *<a class="code" href="../../d6/d3/lfs_8h.html#a7">PUPDATE_SEQUENCE_ARRAY</a>;
00118 
00119 <span class="comment">//</span>
00120 <span class="comment">//  The following structure is allocated in the file system's Vcb and</span>
00121 <span class="comment">//  its address is passed to Lfs during log file initialization.  It</span>
00122 <span class="comment">//  contains the offset of the current write as well as the system</span>
00123 <span class="comment">//  page size being used by Lfs.</span>
00124 <span class="comment">//</span>
00125 
<a name="l00126"></a><a class="code" href="../../d5/d1/struct__LFS__WRITE__DATA.html">00126</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d5/d1/struct__LFS__WRITE__DATA.html">_LFS_WRITE_DATA</a> {
00127 
<a name="l00128"></a><a class="code" href="../../d5/d1/struct__LFS__WRITE__DATA.html#o0">00128</a>     LONGLONG <a class="code" href="../../d5/d1/struct__LFS__WRITE__DATA.html#o0">FileOffset</a>;
<a name="l00129"></a><a class="code" href="../../d5/d1/struct__LFS__WRITE__DATA.html#o1">00129</a>     ULONG <a class="code" href="../../d5/d1/struct__LFS__WRITE__DATA.html#o1">Length</a>;
<a name="l00130"></a><a class="code" href="../../d5/d1/struct__LFS__WRITE__DATA.html#o2">00130</a>     ULONG <a class="code" href="../../d5/d1/struct__LFS__WRITE__DATA.html#o2">LfsStructureSize</a>;
<a name="l00131"></a><a class="code" href="../../d5/d1/struct__LFS__WRITE__DATA.html#o3">00131</a>     PVOID <a class="code" href="../../d5/d1/struct__LFS__WRITE__DATA.html#o3">Lfcb</a>;
00132 
00133 } <a class="code" href="../../d5/d1/struct__LFS__WRITE__DATA.html">LFS_WRITE_DATA</a>, *<a class="code" href="../../d5/d1/struct__LFS__WRITE__DATA.html">PLFS_WRITE_DATA</a>;
00134 
00135 <span class="comment">//</span>
00136 <span class="comment">//  The following structure is used to identify a log record by a log</span>
00137 <span class="comment">//  sequence number.</span>
00138 <span class="comment">//</span>
00139 
<a name="l00140"></a><a class="code" href="../../d6/d3/lfs_8h.html#a11">00140</a> <span class="keyword">typedef</span> LARGE_INTEGER <a class="code" href="../../d6/d3/lfs_8h.html#a10">LSN</a>, *<a class="code" href="../../d6/d3/lfs_8h.html#a11">PLSN</a>;
00141 
00142 <span class="comment">//</span>
00143 <span class="comment">//  The following Lsn will never occur in a file, it is used to indicate</span>
00144 <span class="comment">//  a non-lsn.</span>
00145 <span class="comment">//</span>
00146 
<a name="l00147"></a><a class="code" href="../../d6/d3/lfs_8h.html#a12">00147</a> <span class="keyword">extern</span> <a class="code" href="../../d6/d3/lfs_8h.html#a10">LSN</a> <a class="code" href="../../d6/d3/lfs_8h.html#a12">LfsZeroLsn</a>;
00148 
00149 <span class="comment">//</span>
00150 <span class="comment">//  We set the default page size to 4K</span>
00151 <span class="comment">//</span>
00152 
<a name="l00153"></a><a class="code" href="../../d6/d3/lfs_8h.html#a1">00153</a> <span class="preprocessor">#define LFS_DEFAULT_LOG_PAGE_SIZE           (0x1000)</span>
00154 <span class="preprocessor"></span>
00155 <span class="comment">//</span>
00156 <span class="comment">//  The following type defines the different log record types.</span>
00157 <span class="comment">//</span>
00158 
<a name="l00159"></a><a class="code" href="../../d6/d3/lfs_8h.html#a62">00159</a> <span class="keyword">typedef</span> <span class="keyword">enum</span> <a class="code" href="../../d6/d3/lfs_8h.html#a62">_LFS_RECORD_TYPE</a> {
00160 
00161     <a class="code" href="../../d6/d3/lfs_8h.html#a62a31">LfsClientRecord</a> = 1,
00162     <a class="code" href="../../d6/d3/lfs_8h.html#a62a32">LfsClientRestart</a>
00163 
00164 } <a class="code" href="../../d6/d3/lfs_8h.html#a13">LFS_RECORD_TYPE</a>, *<a class="code" href="../../d6/d3/lfs_8h.html#a14">PLFS_RECORD_TYPE</a>;
00165 
00166 <span class="comment">//</span>
00167 <span class="comment">//  The following search modes are supported.</span>
00168 <span class="comment">//</span>
00169 
<a name="l00170"></a><a class="code" href="../../d6/d3/lfs_8h.html#a63">00170</a> <span class="keyword">typedef</span> <span class="keyword">enum</span> <a class="code" href="../../d6/d3/lfs_8h.html#a63">_LFS_CONTEXT_MODE</a> {
00171 
00172     <a class="code" href="../../d6/d3/lfs_8h.html#a63a33">LfsContextUndoNext</a> = 1,
00173     <a class="code" href="../../d6/d3/lfs_8h.html#a63a34">LfsContextPrevious</a>,
00174     <a class="code" href="../../d6/d3/lfs_8h.html#a63a35">LfsContextForward</a>
00175 
00176 } <a class="code" href="../../d6/d3/lfs_8h.html#a15">LFS_CONTEXT_MODE</a>, *<a class="code" href="../../d6/d3/lfs_8h.html#a16">PLFS_CONTEXT_MODE</a>;
00177 
<a name="l00178"></a><a class="code" href="../../d6/d3/lfs_8h.html#a17">00178</a> <span class="keyword">typedef</span> ULONG <a class="code" href="../../d6/d3/lfs_8h.html#a17">TRANSACTION_ID</a>, *<a class="code" href="../../d6/d3/lfs_8h.html#a18">PTRANSACTION_ID</a>;
00179 
<a name="l00180"></a><a class="code" href="../../d6/d3/lfs_8h.html#a64">00180</a> <span class="keyword">typedef</span> <span class="keyword">enum</span> <a class="code" href="../../d6/d3/lfs_8h.html#a64">_TRANSACTION_STATE</a> {
00181 
00182     <a class="code" href="../../d6/d3/lfs_8h.html#a64a36">TransactionUninitialized</a> = 0,
00183     <a class="code" href="../../d6/d3/lfs_8h.html#a64a37">TransactionActive</a>,
00184     <a class="code" href="../../d6/d3/lfs_8h.html#a64a38">TransactionPrepared</a>,
00185     <a class="code" href="../../d6/d3/lfs_8h.html#a64a39">TransactionCommitted</a>
00186 
00187 } <a class="code" href="../../d6/d3/lfs_8h.html#a19">TRANSACTION_STATE</a>, *<a class="code" href="../../d6/d3/lfs_8h.html#a20">PTRANSACTION_STATE</a>;
00188 
<a name="l00189"></a><a class="code" href="../../d6/d3/lfs_8h.html#a65">00189</a> <span class="keyword">typedef</span> <span class="keyword">enum</span> <a class="code" href="../../d6/d3/lfs_8h.html#a65">_LFS_INFO</a> {
00190 
00191     <a class="code" href="../../d6/d3/lfs_8h.html#a65a40">LfsUseUsa</a> = 1,
00192     <a class="code" href="../../d6/d3/lfs_8h.html#a65a41">LfsPackLog</a>,
00193     <a class="code" href="../../d6/d3/lfs_8h.html#a65a42">LfsFixedPageSize</a>
00194 
00195 } <a class="code" href="../../d6/d3/lfs_8h.html#a21">LFS_INFO</a>, *<a class="code" href="../../d6/d3/lfs_8h.html#a22">PLFS_INFO</a>;
00196 
<a name="l00197"></a><a class="code" href="../../d6/d3/lfs_8h.html#a24">00197</a> <span class="keyword">typedef</span> PVOID <a class="code" href="../../d6/d3/lfs_8h.html#a23">LFS_LOG_HANDLE</a>, *<a class="code" href="../../d6/d3/lfs_8h.html#a24">PLFS_LOG_HANDLE</a>;
00198 
<a name="l00199"></a><a class="code" href="../../d6/d3/lfs_8h.html#a26">00199</a> <span class="keyword">typedef</span> PVOID <a class="code" href="../../d6/d3/lfs_8h.html#a25">LFS_LOG_CONTEXT</a>, *<a class="code" href="../../d6/d3/lfs_8h.html#a26">PLFS_LOG_CONTEXT</a>;
00200 
00201 <span class="comment">//</span>
00202 <span class="comment">//  Write Entry for LfsWrite and LfsForceWrite.  The interface to these</span>
00203 <span class="comment">//  routines takes a pointer to a Write Entry along with a count of how</span>
00204 <span class="comment">//  many Write Entries to expect to describe pieces of the caller's buffer</span>
00205 <span class="comment">//  which are supposed to be copied in sequence to the log file.</span>
00206 <span class="comment">//</span>
00207 
<a name="l00208"></a><a class="code" href="../../d6/d1/struct__LFS__WRITE__ENTRY.html">00208</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d6/d1/struct__LFS__WRITE__ENTRY.html">_LFS_WRITE_ENTRY</a> {
00209 
<a name="l00210"></a><a class="code" href="../../d6/d1/struct__LFS__WRITE__ENTRY.html#o0">00210</a>     PVOID <a class="code" href="../../d6/d1/struct__LFS__WRITE__ENTRY.html#o0">Buffer</a>;
<a name="l00211"></a><a class="code" href="../../d6/d1/struct__LFS__WRITE__ENTRY.html#o1">00211</a>     ULONG <a class="code" href="../../d6/d1/struct__LFS__WRITE__ENTRY.html#o1">ByteLength</a>;
00212 
00213 } <a class="code" href="../../d6/d1/struct__LFS__WRITE__ENTRY.html">LFS_WRITE_ENTRY</a>, *<a class="code" href="../../d6/d1/struct__LFS__WRITE__ENTRY.html">PLFS_WRITE_ENTRY</a>;
00214 
00215 
00216 <span class="comment">//</span>
00217 <span class="comment">// Global Maintenance routines</span>
00218 <span class="comment">//</span>
00219 
00220 BOOLEAN
00221 <a class="code" href="../../d6/d3/lfs_8h.html#a43">LfsInitializeLogFileService</a> (
00222     );
00223 
00224 <span class="comment">//</span>
00225 <span class="comment">//  Log File Registration routines</span>
00226 <span class="comment">//</span>
00227 
<a name="l00228"></a><a class="code" href="../../d3/d3/struct__LOG__FILE__INFORMATION.html">00228</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d3/d3/struct__LOG__FILE__INFORMATION.html">_LOG_FILE_INFORMATION</a> {
00229 
00230     <span class="comment">//</span>
00231     <span class="comment">//  This is the total useable space in the log file after space for</span>
00232     <span class="comment">//  headers and Lfs Restart Areas.</span>
00233     <span class="comment">//</span>
00234 
<a name="l00235"></a><a class="code" href="../../d3/d3/struct__LOG__FILE__INFORMATION.html#o0">00235</a>     LONGLONG <a class="code" href="../../d3/d3/struct__LOG__FILE__INFORMATION.html#o0">TotalAvailable</a>;
00236 
00237     <span class="comment">//</span>
00238     <span class="comment">//  This is the useable space in the log file from the current position</span>
00239     <span class="comment">//  in the log file to the lowest BaseLsn.  This total as returned is not</span>
00240     <span class="comment">//  yet reduced for undo commitments, returned separately below.</span>
00241     <span class="comment">//</span>
00242 
<a name="l00243"></a><a class="code" href="../../d3/d3/struct__LOG__FILE__INFORMATION.html#o1">00243</a>     LONGLONG <a class="code" href="../../d3/d3/struct__LOG__FILE__INFORMATION.html#o1">CurrentAvailable</a>;
00244 
00245     <span class="comment">//</span>
00246     <span class="comment">//  This is the total undo commitment for all clients of the log file.</span>
00247     <span class="comment">//  LfsWrite requests are refused when the sum of the write size of the</span>
00248     <span class="comment">//  request plus the UndoRequirement for the request plus the TotalUndoCommitment</span>
00249     <span class="comment">//  are greater than the CurrentAvailable.</span>
00250     <span class="comment">//</span>
00251 
<a name="l00252"></a><a class="code" href="../../d3/d3/struct__LOG__FILE__INFORMATION.html#o2">00252</a>     LONGLONG <a class="code" href="../../d3/d3/struct__LOG__FILE__INFORMATION.html#o2">TotalUndoCommitment</a>;
00253 
00254     <span class="comment">//</span>
00255     <span class="comment">//  This is the total undo commitment for this client.</span>
00256     <span class="comment">//</span>
00257 
<a name="l00258"></a><a class="code" href="../../d3/d3/struct__LOG__FILE__INFORMATION.html#o3">00258</a>     LONGLONG <a class="code" href="../../d3/d3/struct__LOG__FILE__INFORMATION.html#o3">ClientUndoCommitment</a>;
00259 
00260     <span class="comment">//</span>
00261     <span class="comment">//  Current system Lsn's.  Includes the Oldest, LastFlushed and current</span>
00262     <span class="comment">//  Lsn.</span>
00263     <span class="comment">//</span>
00264 
<a name="l00265"></a><a class="code" href="../../d3/d3/struct__LOG__FILE__INFORMATION.html#o4">00265</a>     <a class="code" href="../../d6/d3/lfs_8h.html#a10">LSN</a> <a class="code" href="../../d3/d3/struct__LOG__FILE__INFORMATION.html#o4">OldestLsn</a>;
<a name="l00266"></a><a class="code" href="../../d3/d3/struct__LOG__FILE__INFORMATION.html#o5">00266</a>     <a class="code" href="../../d6/d3/lfs_8h.html#a10">LSN</a> <a class="code" href="../../d3/d3/struct__LOG__FILE__INFORMATION.html#o5">LastFlushedLsn</a>;
<a name="l00267"></a><a class="code" href="../../d3/d3/struct__LOG__FILE__INFORMATION.html#o6">00267</a>     <a class="code" href="../../d6/d3/lfs_8h.html#a10">LSN</a> <a class="code" href="../../d3/d3/struct__LOG__FILE__INFORMATION.html#o6">LastLsn</a>;
00268 
00269 } <a class="code" href="../../d3/d3/struct__LOG__FILE__INFORMATION.html">LOG_FILE_INFORMATION</a>, *<a class="code" href="../../d3/d3/struct__LOG__FILE__INFORMATION.html">PLOG_FILE_INFORMATION</a>;
00270 
00271 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00272 <a class="code" href="../../d0/d7/lfs_2registry_8c.html#a13">LfsInitializeLogFile</a> (
00273     IN <a class="code" href="../../d9/d1/struct__FILE__OBJECT.html">PFILE_OBJECT</a> LogFile,
00274     IN USHORT MaximumClients,
00275     IN ULONG LogPageSize OPTIONAL,
00276     IN LONGLONG FileSize,
00277     OUT PLFS_WRITE_DATA WriteData
00278     );
00279 
00280 ULONG
00281 <a class="code" href="../../d0/d7/lfs_2registry_8c.html#a14">LfsOpenLogFile</a> (
00282     IN <a class="code" href="../../d9/d1/struct__FILE__OBJECT.html">PFILE_OBJECT</a> LogFile,
00283     IN UNICODE_STRING ClientName,
00284     IN USHORT MaximumClients,
00285     IN ULONG LogPageSize OPTIONAL,
00286     IN LONGLONG FileSize,
00287     IN OUT PLFS_INFO LfsInfo,
00288     OUT PLFS_LOG_HANDLE LogHandle,
00289     OUT PLFS_WRITE_DATA WriteData
00290     );
00291 
00292 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00293 <a class="code" href="../../d0/d7/lfs_2registry_8c.html#a15">LfsCloseLogFile</a> (
00294     IN LFS_LOG_HANDLE LogHandle
00295     );
00296 
00297 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00298 <a class="code" href="../../d0/d7/lfs_2registry_8c.html#a16">LfsDeleteLogHandle</a> (
00299     IN LFS_LOG_HANDLE LogHandle
00300     );
00301 
00302 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00303 <a class="code" href="../../d0/d7/lfs_2registry_8c.html#a17">LfsReadLogFileInformation</a> (
00304     IN LFS_LOG_HANDLE LogHandle,
00305     IN PLOG_FILE_INFORMATION Buffer,
00306     IN OUT PULONG Length
00307     );
00308 
00309 BOOLEAN
00310 <a class="code" href="../../d0/d7/lfs_2registry_8c.html#a18">LfsVerifyLogFile</a> (
00311     IN LFS_LOG_HANDLE LogHandle,
00312     IN PVOID LogFileHeader,
00313     IN ULONG Length
00314     );
00315 
00316 <span class="comment">//</span>
00317 <span class="comment">//  Log File Client Restart routines</span>
00318 <span class="comment">//</span>
00319 
00320 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
00321 <a class="code" href="../../d5/d9/restart_8c.html#a2">LfsReadRestartArea</a> (
00322     IN LFS_LOG_HANDLE LogHandle,
00323     IN OUT PULONG BufferLength,
00324     IN PVOID Buffer,
00325     OUT PLSN Lsn
00326     );
00327 
00328 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00329 <a class="code" href="../../d5/d9/restart_8c.html#a3">LfsWriteRestartArea</a> (
00330     IN LFS_LOG_HANDLE LogHandle,
00331     IN ULONG BufferLength,
00332     IN PVOID Buffer,
00333     OUT PLSN Lsn
00334     );
00335 
00336 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00337 <a class="code" href="../../d5/d9/restart_8c.html#a4">LfsSetBaseLsn</a> (
00338     IN LFS_LOG_HANDLE LogHandle,
00339     IN LSN BaseLsn
00340     );
00341 
00342 <span class="comment">//</span>
00343 <span class="comment">//  If ResetTotal is positive, then NumberRecords and ResetTotal set the absolute</span>
00344 <span class="comment">//  values for the client.  If ResetTotal is negative, then they are adjustments</span>
00345 <span class="comment">//  to the totals for this client.</span>
00346 <span class="comment">//</span>
00347 
00348 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00349 <a class="code" href="../../d0/d7/lfs_2registry_8c.html#a19">LfsResetUndoTotal</a> (
00350     IN LFS_LOG_HANDLE LogHandle,
00351     IN ULONG NumberRecords,
00352     IN LONG ResetTotal
00353     );
00354 
00355 <span class="comment">//</span>
00356 <span class="comment">//  Log File Write routines</span>
00357 <span class="comment">//</span>
00358 
00359 BOOLEAN
00360 <a class="code" href="../../d1/d0/lfs_2write_8c.html#a1">LfsWrite</a> (
00361     IN LFS_LOG_HANDLE LogHandle,
00362     IN ULONG NumberOfWriteEntries,
00363     IN PLFS_WRITE_ENTRY WriteEntries,
00364     IN LFS_RECORD_TYPE RecordType,
00365     IN TRANSACTION_ID *TransactionId OPTIONAL,
00366     IN LSN UndoNextLsn,
00367     IN LSN PreviousLsn,
00368     IN LONG UndoRequirement,
00369     OUT PLSN Lsn
00370     );
00371 
00372 BOOLEAN
00373 <a class="code" href="../../d1/d0/lfs_2write_8c.html#a2">LfsForceWrite</a> (
00374     IN LFS_LOG_HANDLE LogHandle,
00375     IN ULONG NumberOfWriteEntries,
00376     IN PLFS_WRITE_ENTRY WriteEntries,
00377     IN LFS_RECORD_TYPE RecordType,
00378     IN TRANSACTION_ID *TransactionId OPTIONAL,
00379     IN LSN UndoNextLsn,
00380     IN LSN PreviousLsn,
00381     IN LONG UndoRequirement,
00382     OUT PLSN Lsn
00383     );
00384 
00385 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00386 <a class="code" href="../../d1/d0/lfs_2write_8c.html#a3">LfsFlushToLsn</a> (
00387     IN LFS_LOG_HANDLE LogHandle,
00388     IN LSN Lsn
00389     );
00390 
00391 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00392 <a class="code" href="../../d1/d0/lfs_2write_8c.html#a4">LfsCheckWriteRange</a> (
00393     IN PLFS_WRITE_DATA WriteData,
00394     IN OUT PLONGLONG FlushOffset,
00395     IN OUT PULONG FlushLength
00396     );
00397 
00398 <span class="comment">//</span>
00399 <span class="comment">//  Log File Query Record routines</span>
00400 <span class="comment">//</span>
00401 
00402 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00403 <a class="code" href="../../d3/d3/querylog_8c.html#a5">LfsReadLogRecord</a> (
00404     IN LFS_LOG_HANDLE LogHandle,
00405     IN LSN FirstLsn,
00406     IN LFS_CONTEXT_MODE ContextMode,
00407     OUT PLFS_LOG_CONTEXT Context,
00408     OUT PLFS_RECORD_TYPE RecordType,
00409     OUT TRANSACTION_ID *TransactionId,
00410     OUT PLSN UndoNextLsn,
00411     OUT PLSN PreviousLsn,
00412     OUT PULONG BufferLength,
00413     OUT PVOID *Buffer
00414     );
00415 
00416 BOOLEAN
00417 <a class="code" href="../../d3/d3/querylog_8c.html#a6">LfsReadNextLogRecord</a> (
00418     IN LFS_LOG_HANDLE LogHandle,
00419     IN OUT LFS_LOG_CONTEXT Context,
00420     OUT PLFS_RECORD_TYPE RecordType,
00421     OUT TRANSACTION_ID *TransactionId,
00422     OUT PLSN UndoNextLsn,
00423     OUT PLSN PreviousLsn,
00424     OUT PLSN Lsn,
00425     OUT PULONG BufferLength,
00426     OUT PVOID *Buffer
00427     );
00428 
00429 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00430 <a class="code" href="../../d3/d3/querylog_8c.html#a7">LfsTerminateLogQuery</a> (
00431     IN LFS_LOG_HANDLE LogHandle,
00432     IN LFS_LOG_CONTEXT Context
00433     );
00434 
00435 <a class="code" href="../../d6/d3/lfs_8h.html#a10">LSN</a>
00436 <a class="code" href="../../d3/d3/querylog_8c.html#a8">LfsQueryLastLsn</a> (
00437     IN LFS_LOG_HANDLE LogHandle
00438     );
00439 
00440 <span class="preprocessor">#endif  // LFS</span>
00441 <span class="preprocessor"></span>
</div></pre><hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:40:38 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
