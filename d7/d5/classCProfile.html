<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: CProfile class Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>CProfile Class Reference</h1><code>#include &lt;<a class="el" href="../../d4/d6/icmui_2profile_8h-source.html">profile.h</a>&gt;</code>
<p>
<a href="../../d4/d3/classCProfile-members.html">List of all members.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d5/classCProfile.html#a0">CProfile</a> (LPCTSTR lpstr)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d5/classCProfile.html#a1">~CProfile</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d1/d7/classCString.html">CString</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d5/classCProfile.html#a2">GetName</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d5/classCProfile.html#a3">GetType</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d5/classCProfile.html#a4">GetCMM</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d5/classCProfile.html#a5">GetColorSpace</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d5/classCProfile.html#a6">IsInstalled</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d5/classCProfile.html#a7">IsValid</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>unsigned&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d5/classCProfile.html#a8">DeviceCount</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>unsigned&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d5/classCProfile.html#a9">AssociationCount</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>LPCTSTR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d5/classCProfile.html#a10">DeviceName</a> (unsigned u)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>LPCTSTR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d5/classCProfile.html#a11">DisplayName</a> (unsigned u)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>unsigned&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d5/classCProfile.html#a12">Association</a> (unsigned u)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>LPCSTR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d5/classCProfile.html#a13">TagContents</a> (TAGTYPE tt, unsigned uOffset=0)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d5/classCProfile.html#a14">Install</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d5/classCProfile.html#a15">Uninstall</a> (BOOL bDelete)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d5/classCProfile.html#a16">Associate</a> (LPCTSTR lpstrNew)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d5/classCProfile.html#a17">Dissociate</a> (LPCTSTR lpstrNew)</td></tr>

<tr><td colspan=2><br><h2>Static Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d5/classCProfile.html#e0">Enumerate</a> (ENUMTYPE &amp;et, <a class="el" href="../../d2/d7/classCStringArray.html">CStringArray</a> &amp;csaList)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d5/classCProfile.html#e1">Enumerate</a> (ENUMTYPE &amp;et, <a class="el" href="../../d2/d7/classCStringArray.html">CStringArray</a> &amp;csaList, <a class="el" href="../../d2/d7/classCStringArray.html">CStringArray</a> &amp;csaDesc)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d5/classCProfile.html#e2">Enumerate</a> (ENUMTYPE &amp;et, class <a class="el" href="../../d8/d5/classCProfileArray.html">CProfileArray</a> &amp;cpaList)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>const <a class="el" href="../../d1/d7/classCString.html">CString</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d5/classCProfile.html#e3">ColorDirectory</a> ()</td></tr>

<tr><td colspan=2><br><h2>Private Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d5/classCProfile.html#d0">InstallCheck</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d5/classCProfile.html#d1">AssociationCheck</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d5/classCProfile.html#d2">DeviceCheck</a> ()</td></tr>

<tr><td colspan=2><br><h2>Private Attributes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>HPROFILE&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d5/classCProfile.html#r0">m_hprof</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>PROFILEHEADER&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d5/classCProfile.html#r1">m_phThis</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d1/d7/classCString.html">CString</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d5/classCProfile.html#r2">m_csName</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d5/classCProfile.html#r3">m_bIsInstalled</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d5/classCProfile.html#r4">m_bInstallChecked</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d5/classCProfile.html#r5">m_bAssociationsChecked</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d5/classCProfile.html#r6">m_bDevicesChecked</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d1/d2/classCDeviceList.html">CDeviceList</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d5/classCProfile.html#r7">m_pcdlClass</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d3/d7/classCUintArray.html">CUintArray</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d5/classCProfile.html#r8">m_cuaAssociation</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>char&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d5/classCProfile.html#r9">m_acTag</a> [MAX_PATH *2]</td></tr>

</table>
<hr><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" name="a0" doxytag="CProfile::CProfile" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> CProfile::CProfile           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">LPCTSTR&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>lpstr</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00617">617</a> of file <a class="el" href="../../d3/d6/profile_8cpp-source.html">profile.cpp</a>.
<p>
References <a class="el" href="../../d1/d6/w32_2ntgdi_2icm_2mscms_2profile_8c-source.html#l00271">CloseColorProfile()</a>, <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00617">CProfile()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d1/d6/w32_2ntgdi_2icm_2mscms_2profile_8c-source.html#l01577">GetColorProfileHeader()</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">LPVOID</a>, <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00161">m_bAssociationsChecked</a>, <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00161">m_bDevicesChecked</a>, <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00161">m_bInstallChecked</a>, <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00160">m_csName</a>, <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00158">m_hprof</a>, <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00163">m_pcdlClass</a>, <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00159">m_phThis</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, and <a class="el" href="../../d4/d8/ntfsexp_8h.html#a141a69">OPEN_EXISTING</a>.
<p>
Referenced by <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00617">CProfile()</a>.
<p>
<pre class="fragment"><div>00617                                       {
00618 
00619     _ASSERTE(lpstrTarget &amp;&amp; *lpstrTarget);
00620 
00621     <a class="code" href="../../d7/d5/classCProfile.html#r7">m_pcdlClass</a> = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00622 
00623     <span class="comment">//  First, let's make sure it's the real McCoy</span>
00624 
00625     PROFILE     prof = { PROFILE_FILENAME,
00626                          (<a class="code" href="../../d0/d5/perfuser_8c.html#a5">LPVOID</a>) lpstrTarget,
00627                          (1 + lstrlen(lpstrTarget)) * <span class="keyword">sizeof</span>(TCHAR)};
00628 
00629     <a class="code" href="../../d7/d5/classCProfile.html#r0">m_hprof</a> = OpenColorProfile(&amp;prof, PROFILE_READ,
00630                                       FILE_SHARE_READ|FILE_SHARE_WRITE,
00631                                       OPEN_EXISTING);
00632 
00633     <span class="keywordflow">if</span>  (!<a class="code" href="../../d7/d5/classCProfile.html#r0">m_hprof</a>)
00634         <span class="keywordflow">return</span>;
00635 
00636     <span class="keywordflow">if</span>  (!<a class="code" href="../../d0/d7/w32_2ntgdi_2icm_2mscms_2profile_8c.html#a25">GetColorProfileHeader</a>(m_hprof, &amp;m_phThis)) {
00637         <a class="code" href="../../d0/d7/w32_2ntgdi_2icm_2mscms_2profile_8c.html#a13">CloseColorProfile</a>(m_hprof);
00638         <a class="code" href="../../d7/d5/classCProfile.html#r0">m_hprof</a> = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00639         <span class="keywordflow">return</span>;
00640     }
00641 
00642     <a class="code" href="../../d7/d5/classCProfile.html#r2">m_csName</a> = lpstrTarget;
00643     <a class="code" href="../../d7/d5/classCProfile.html#r4">m_bInstallChecked</a> = <a class="code" href="../../d7/d5/classCProfile.html#r6">m_bDevicesChecked</a> = <a class="code" href="../../d7/d5/classCProfile.html#r5">m_bAssociationsChecked</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00644 
00645     <span class="comment">//  Init the DeviceList pointer, because it doesn't cost much...</span>
00646 
00647     <span class="keywordflow">switch</span>  (<a class="code" href="../../d7/d5/classCProfile.html#r1">m_phThis</a>.phClass) {
00648         <span class="keywordflow">case</span>    CLASS_PRINTER:
00649 
00650             <span class="comment">//  Our device list is a printer list</span>
00651 
00652             <a class="code" href="../../d7/d5/classCProfile.html#r7">m_pcdlClass</a> = <span class="keyword">new</span> <a class="code" href="../../d5/d5/classCPrinterList.html">CPrinterList</a>;
00653             <span class="keywordflow">break</span>;
00654 
00655         <span class="keywordflow">case</span>     CLASS_SCANNER:
00656 
00657             <span class="comment">//  Our device list is a scanner list</span>
00658 
00659             <a class="code" href="../../d7/d5/classCProfile.html#r7">m_pcdlClass</a> = <span class="keyword">new</span> <a class="code" href="../../d7/d6/classCScannerList.html">CScannerList</a>;
00660             <span class="keywordflow">break</span>;
00661 
00662 
00663         <span class="keywordflow">case</span>    CLASS_MONITOR:
00664 
00665             <span class="comment">//  Our device list is a monitor list</span>
00666 
00667 <span class="preprocessor">        #if 1 // ALLOW_MONITOR_PROFILE_TO_ANY_DEVICE</span>
00668 <span class="preprocessor"></span>            <a class="code" href="../../d7/d5/classCProfile.html#r7">m_pcdlClass</a> = <span class="keyword">new</span> <a class="code" href="../../d7/d1/classCAllDeviceList.html">CAllDeviceList</a>;
00669 <span class="preprocessor">        #else</span>
00670 <span class="preprocessor"></span>            <a class="code" href="../../d7/d5/classCProfile.html#r7">m_pcdlClass</a> = <span class="keyword">new</span> <a class="code" href="../../d2/d4/classCMonitorList.html">CMonitorList</a>;
00671 <span class="preprocessor">        #endif</span>
00672 <span class="preprocessor"></span>            <span class="keywordflow">break</span>;
00673 
00674         <span class="keywordflow">case</span>    CLASS_COLORSPACE:
00675 
00676             <span class="comment">//  List everything we can count</span>
00677 
00678             <a class="code" href="../../d7/d5/classCProfile.html#r7">m_pcdlClass</a> = <span class="keyword">new</span> CAllDeviceList;
00679             <span class="keywordflow">break</span>;
00680 
00681         <span class="keywordflow">default</span>:
00682             <span class="comment">//  Use the base device class (i.e., no devices of this type).</span>
00683             <a class="code" href="../../d7/d5/classCProfile.html#r7">m_pcdlClass</a> = <span class="keyword">new</span> <a class="code" href="../../d1/d2/classCDeviceList.html">CDeviceList</a>;
00684     }
00685 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="CProfile::~CProfile" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> CProfile::~<a class="el" href="../../d7/d5/classCProfile.html">CProfile</a>           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00689">689</a> of file <a class="el" href="../../d3/d6/profile_8cpp-source.html">profile.cpp</a>.
<p>
References <a class="el" href="../../d1/d6/w32_2ntgdi_2icm_2mscms_2profile_8c-source.html#l00271">CloseColorProfile()</a>, <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00158">m_hprof</a>, and <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00163">m_pcdlClass</a>.
<p>
<pre class="fragment"><div>00689                     {
00690     <span class="keywordflow">if</span>  (<a class="code" href="../../d7/d5/classCProfile.html#r0">m_hprof</a>)
00691         <a class="code" href="../../d0/d7/w32_2ntgdi_2icm_2mscms_2profile_8c.html#a13">CloseColorProfile</a>(m_hprof);
00692     <span class="keywordflow">if</span>  (<a class="code" href="../../d7/d5/classCProfile.html#r7">m_pcdlClass</a>)
00693         <span class="keyword">delete</span>  <a class="code" href="../../d7/d5/classCProfile.html#r7">m_pcdlClass</a>;
00694 }
</div></pre>    </td>
  </tr>
</table>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="a16" doxytag="CProfile::Associate" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void CProfile::Associate           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">LPCTSTR&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>lpstrNew</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00759">759</a> of file <a class="el" href="../../d3/d6/profile_8cpp-source.html">profile.cpp</a>.
<p>
References <a class="el" href="../../d3/d8/ntgdi_2icm_2icmui_2resource_8h-source.html#l00062">AssocFailedWithName</a>, <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00759">Associate()</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00712">Install()</a>, <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00189">IsInstalled()</a>, <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00160">m_csName</a>, <a class="el" href="../../d4/d6/stringar_8cpp-source.html#l00176">CString::NameAndExtension()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00759">Associate()</a>, <a class="el" href="../../d2/d7/profprop_8cpp-source.html#l00205">CProfilePropertySheet::OnCommand()</a>, and <a class="el" href="../../d7/d4/profassoc_8cpp-source.html#l00278">CProfileAssociationPage::OnNotify()</a>.
<p>
<pre class="fragment"><div>00759                                                {
00760 
00761     <span class="comment">// if the profile is not installed, install it first.</span>
00762 
00763     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> bInstalled = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00764 
00765     <span class="comment">// Install profile, if not installed, yet.</span>
00766     <span class="keywordflow">if</span>  (!<a class="code" href="../../d7/d5/classCProfile.html#a6">IsInstalled</a>()) {
00767         bInstalled = <a class="code" href="../../d7/d5/classCProfile.html#a14">Install</a>();
00768     } <span class="keywordflow">else</span>
00769         bInstalled = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00770 
00771     <span class="keywordflow">if</span>  (bInstalled) {
00772         <span class="keywordflow">if</span>  (!AssociateColorProfileWithDevice(NULL, <a class="code" href="../../d7/d5/classCProfile.html#r2">m_csName</a>.<a class="code" href="../../d1/d7/classCString.html#a15">NameAndExtension</a>(),
00773             lpstrDevice)) {
00774             <a class="code" href="../../d0/d3/classCGlobals.html#e7">CGlobals::ReportEx</a>(AssocFailedWithName,NULL,FALSE,1,
00775                                MB_OK|MB_ICONEXCLAMATION,<a class="code" href="../../d7/d5/classCProfile.html#r2">m_csName</a>.<a class="code" href="../../d1/d7/classCString.html#a15">NameAndExtension</a>());
00776         } <span class="keywordflow">else</span>
00777             _RPTF2(_CRT_WARN, <span class="stringliteral">"CProfile::Associate %s with %s succeeded\n"</span>,
00778                 lpstrDevice, (LPCTSTR) <a class="code" href="../../d7/d5/classCProfile.html#r2">m_csName</a>.<a class="code" href="../../d1/d7/classCString.html#a15">NameAndExtension</a>());
00779     }
00780 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a12" doxytag="CProfile::Association" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> unsigned CProfile::Association           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">unsigned&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>u</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [inline]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00239">239</a> of file <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html">icmui/profile.h</a>.
<p>
References <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00239">Association()</a>, <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00575">AssociationCheck()</a>, <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00161">m_bAssociationsChecked</a>, and <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00164">m_cuaAssociation</a>.
<p>
Referenced by <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00239">Association()</a>, <a class="el" href="../../d2/d7/profprop_8cpp-source.html#l00025">CProfilePropertySheet::ConstructAssociations()</a>, and <a class="el" href="../../d7/d4/profassoc_8cpp-source.html#l00107">CProfileAssociationPage::ConstructAssociations()</a>.
<p>
<pre class="fragment"><div>00239                                         {
00240         <span class="keywordflow">if</span>  (!<a class="code" href="../../d7/d5/classCProfile.html#r5">m_bAssociationsChecked</a>)
00241             <a class="code" href="../../d7/d5/classCProfile.html#d1">AssociationCheck</a>();
00242         <span class="keywordflow">return</span> <a class="code" href="../../d7/d5/classCProfile.html#r8">m_cuaAssociation</a>[u];
00243     }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="d1" doxytag="CProfile::AssociationCheck" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void CProfile::AssociationCheck           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [private]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00575">575</a> of file <a class="el" href="../../d3/d6/profile_8cpp-source.html">profile.cpp</a>.
<p>
References <a class="el" href="../../d4/d6/stringar_8cpp-source.html#l00424">CUintArray::Add()</a>, <a class="el" href="../../d5/d6/stringar_8h-source.html#l00103">CStringArray::Count()</a>, <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00203">DeviceCount()</a>, <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00219">DeviceName()</a>, <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00405">Enumerate()</a>, <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00189">IsInstalled()</a>, <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00161">m_bAssociationsChecked</a>, <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00160">m_csName</a>, <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00164">m_cuaAssociation</a>, <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00163">m_pcdlClass</a>, <a class="el" href="../../d4/d6/stringar_8cpp-source.html#l00165">CString::NameOnly()</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00239">Association()</a>, and <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00213">AssociationCount()</a>.
<p>
<pre class="fragment"><div>00575                                    {
00576 
00577     <a class="code" href="../../d7/d5/classCProfile.html#r5">m_bAssociationsChecked</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00578 
00579     <span class="comment">//  If the profile isn't installed, associations are moot...</span>
00580 
00581     <span class="keywordflow">if</span>  (!<a class="code" href="../../d7/d5/classCProfile.html#a6">IsInstalled</a>())
00582         <span class="keywordflow">return</span>;
00583 
00584     <span class="comment">//  The final step is to build a list of associations</span>
00585 
00586     ENUMTYPE        et = {<span class="keyword">sizeof</span> (ENUMTYPE), ENUM_TYPE_VERSION, ET_DEVICENAME};
00587     <a class="code" href="../../d2/d7/classCStringArray.html">CStringArray</a>    csaWork;
00588 
00589     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> u = 0; u &lt; <a class="code" href="../../d7/d5/classCProfile.html#a8">DeviceCount</a>(); u++) {
00590 
00591         et.pDeviceName = <a class="code" href="../../d7/d5/classCProfile.html#r7">m_pcdlClass</a> -&gt; <a class="code" href="../../d7/d5/classCProfile.html#a10">DeviceName</a>(u);
00592 
00593         <a class="code" href="../../d7/d5/classCProfile.html#e0">Enumerate</a>(et, csaWork);
00594 
00595         <span class="comment">//  We track associations by index into the total device list...</span>
00596 
00597         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> uProfile = 0; uProfile &lt; csaWork.<a class="code" href="../../d2/d7/classCStringArray.html#a2">Count</a>(); uProfile++)
00598             <span class="keywordflow">if</span>  (!lstrcmpi(csaWork[uProfile].NameOnly(), <a class="code" href="../../d7/d5/classCProfile.html#r2">m_csName</a>.<a class="code" href="../../d1/d7/classCString.html#a14">NameOnly</a>())){
00599                 <a class="code" href="../../d7/d5/classCProfile.html#r8">m_cuaAssociation</a>.<a class="code" href="../../d3/d7/classCUintArray.html#a3">Add</a>(u);    <span class="comment">//  Found one!</span>
00600                 <span class="keywordflow">break</span>;
00601             }
00602     }
00603 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a9" doxytag="CProfile::AssociationCount" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> unsigned CProfile::AssociationCount           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [inline]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00213">213</a> of file <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html">icmui/profile.h</a>.
<p>
References <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00575">AssociationCheck()</a>, <a class="el" href="../../d5/d6/stringar_8h-source.html#l00134">CUintArray::Count()</a>, <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00161">m_bAssociationsChecked</a>, and <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00164">m_cuaAssociation</a>.
<p>
Referenced by <a class="el" href="../../d2/d7/profprop_8cpp-source.html#l00025">CProfilePropertySheet::ConstructAssociations()</a>, <a class="el" href="../../d7/d4/profassoc_8cpp-source.html#l00107">CProfileAssociationPage::ConstructAssociations()</a>, <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00731">Uninstall()</a>, and <a class="el" href="../../d5/d7/propdlg_8cpp-source.html#l00084">CAdvancedPage::Update()</a>.
<p>
<pre class="fragment"><div>00213                                    {
00214         <span class="keywordflow">if</span>  (!<a class="code" href="../../d7/d5/classCProfile.html#r5">m_bAssociationsChecked</a>)
00215             <a class="code" href="../../d7/d5/classCProfile.html#d1">AssociationCheck</a>();
00216         <span class="keywordflow">return</span> <a class="code" href="../../d7/d5/classCProfile.html#r8">m_cuaAssociation</a>.<a class="code" href="../../d3/d7/classCUintArray.html#a2">Count</a>();
00217     }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="e3" doxytag="CProfile::ColorDirectory" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> const <a class="el" href="../../d1/d7/classCString.html">CString</a> CProfile::ColorDirectory           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00543">543</a> of file <a class="el" href="../../d3/d6/profile_8cpp-source.html">profile.cpp</a>.
<p>
References <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d4/d8/arcinst_8c-source.html#l00065">MAX_PATH</a>, and <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>.
<p>
<pre class="fragment"><div>00543                                          {
00544     TCHAR   acDirectory[<a class="code" href="../../d3/d9/arcinst_8c.html#a6">MAX_PATH</a>];
00545     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>   dwccDir = <a class="code" href="../../d3/d9/arcinst_8c.html#a6">MAX_PATH</a>;
00546 
00547     GetColorDirectory(NULL, acDirectory, &amp;dwccDir);
00548 
00549     <span class="keywordflow">return</span>  acDirectory;
00550 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="d2" doxytag="CProfile::DeviceCheck" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void CProfile::DeviceCheck           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [private]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00607">607</a> of file <a class="el" href="../../d3/d6/profile_8cpp-source.html">profile.cpp</a>.
<p>
References <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00405">Enumerate()</a>, <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00161">m_bDevicesChecked</a>, <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00163">m_pcdlClass</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00203">DeviceCount()</a>, <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00219">DeviceName()</a>, and <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00229">DisplayName()</a>.
<p>
<pre class="fragment"><div>00607                               {
00608 
00609     <span class="comment">//  Enumerate the available devices of this type in the csaDevice Array</span>
00610 
00611     <a class="code" href="../../d7/d5/classCProfile.html#r7">m_pcdlClass</a> -&gt; <a class="code" href="../../d7/d5/classCProfile.html#e0">Enumerate</a>();
00612     <a class="code" href="../../d7/d5/classCProfile.html#r6">m_bDevicesChecked</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00613 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a8" doxytag="CProfile::DeviceCount" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> unsigned CProfile::DeviceCount           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [inline]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00203">203</a> of file <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html">icmui/profile.h</a>.
<p>
References <a class="el" href="../../d7/d9/cmdat_8c-source.html#l00069">Count</a>, <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00607">DeviceCheck()</a>, <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00161">m_bDevicesChecked</a>, and <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00163">m_pcdlClass</a>.
<p>
Referenced by <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00575">AssociationCheck()</a>, <a class="el" href="../../d7/d4/profassoc_8cpp-source.html#l00389">CAddDeviceDialog::OnInit()</a>, and <a class="el" href="../../d5/d7/propdlg_8cpp-source.html#l00084">CAdvancedPage::Update()</a>.
<p>
<pre class="fragment"><div>00203                               {
00204         <span class="keywordflow">if</span> (<a class="code" href="../../d7/d5/classCProfile.html#r7">m_pcdlClass</a>) {
00205           <span class="keywordflow">if</span> (!<a class="code" href="../../d7/d5/classCProfile.html#r6">m_bDevicesChecked</a>)
00206               <a class="code" href="../../d7/d5/classCProfile.html#d2">DeviceCheck</a>();
00207           <span class="keywordflow">return</span> <a class="code" href="../../d7/d5/classCProfile.html#r7">m_pcdlClass</a> -&gt; <a class="code" href="../../d6/d0/cmdat_8c.html#a5">Count</a>();
00208         } <span class="keywordflow">else</span> {
00209           <span class="keywordflow">return</span> 0;                           <span class="comment">// low memory - m_pcdlClass allocation failed</span>
00210         }
00211     }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a10" doxytag="CProfile::DeviceName" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> LPCTSTR CProfile::DeviceName           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">unsigned&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>u</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [inline]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00219">219</a> of file <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html">icmui/profile.h</a>.
<p>
References <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00607">DeviceCheck()</a>, <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00219">DeviceName()</a>, <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00161">m_bDevicesChecked</a>, and <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00163">m_pcdlClass</a>.
<p>
Referenced by <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00575">AssociationCheck()</a>, <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00219">DeviceName()</a>, <a class="el" href="../../d7/d4/profassoc_8cpp-source.html#l00278">CProfileAssociationPage::OnNotify()</a>, and <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00731">Uninstall()</a>.
<p>
<pre class="fragment"><div>00219                                        {
00220         <span class="keywordflow">if</span> (<a class="code" href="../../d7/d5/classCProfile.html#r7">m_pcdlClass</a>) {
00221           <span class="keywordflow">if</span>  (!<a class="code" href="../../d7/d5/classCProfile.html#r6">m_bDevicesChecked</a>)
00222               <a class="code" href="../../d7/d5/classCProfile.html#d2">DeviceCheck</a>();
00223           <span class="keywordflow">return</span> <a class="code" href="../../d7/d5/classCProfile.html#r7">m_pcdlClass</a> -&gt; <a class="code" href="../../d7/d5/classCProfile.html#a10">DeviceName</a>(u);
00224         } <span class="keywordflow">else</span> {
00225           <span class="keywordflow">return</span> TEXT(<span class="stringliteral">""</span>);                    <span class="comment">// low memory - m_pcdlClass allocation failed</span>
00226         }
00227     }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a11" doxytag="CProfile::DisplayName" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> LPCTSTR CProfile::DisplayName           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">unsigned&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>u</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [inline]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00229">229</a> of file <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html">icmui/profile.h</a>.
<p>
References <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00607">DeviceCheck()</a>, <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00229">DisplayName()</a>, <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00161">m_bDevicesChecked</a>, and <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00163">m_pcdlClass</a>.
<p>
Referenced by <a class="el" href="../../d3/d7/profprop_8h-source.html#l00063">CProfilePropertySheet::DisplayName()</a>, <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00229">DisplayName()</a>, <a class="el" href="../../d8/d4/profassoc_8h-source.html#l00069">CProfileAssociationPage::DisplayName()</a>, and <a class="el" href="../../d7/d4/profassoc_8cpp-source.html#l00389">CAddDeviceDialog::OnInit()</a>.
<p>
<pre class="fragment"><div>00229                                         {
00230         <span class="keywordflow">if</span> (<a class="code" href="../../d7/d5/classCProfile.html#r7">m_pcdlClass</a>) {
00231           <span class="keywordflow">if</span>  (!<a class="code" href="../../d7/d5/classCProfile.html#r6">m_bDevicesChecked</a>)
00232               <a class="code" href="../../d7/d5/classCProfile.html#d2">DeviceCheck</a>();
00233           <span class="keywordflow">return</span> <a class="code" href="../../d7/d5/classCProfile.html#r7">m_pcdlClass</a> -&gt; <a class="code" href="../../d7/d5/classCProfile.html#a11">DisplayName</a>(u);
00234         } <span class="keywordflow">else</span> {
00235           <span class="keywordflow">return</span> TEXT(<span class="stringliteral">""</span>);                    <span class="comment">// low memory - m_pcdlClass allocation failed</span>
00236         }
00237     }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a17" doxytag="CProfile::Dissociate" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void CProfile::Dissociate           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">LPCTSTR&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>lpstrNew</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00784">784</a> of file <a class="el" href="../../d3/d6/profile_8cpp-source.html">profile.cpp</a>.
<p>
References <a class="el" href="../../d3/d8/ntgdi_2icm_2icmui_2resource_8h-source.html#l00063">DisassocFailedWithName</a>, <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00784">Dissociate()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00160">m_csName</a>, <a class="el" href="../../d4/d6/stringar_8cpp-source.html#l00176">CString::NameAndExtension()</a>, and <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>.
<p>
Referenced by <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00784">Dissociate()</a>, <a class="el" href="../../d2/d7/profprop_8cpp-source.html#l00205">CProfilePropertySheet::OnCommand()</a>, <a class="el" href="../../d7/d4/profassoc_8cpp-source.html#l00278">CProfileAssociationPage::OnNotify()</a>, and <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00731">Uninstall()</a>.
<p>
<pre class="fragment"><div>00784                                                 {
00785     <span class="keywordflow">if</span>  (!DisassociateColorProfileFromDevice(NULL, <a class="code" href="../../d7/d5/classCProfile.html#r2">m_csName</a>.<a class="code" href="../../d1/d7/classCString.html#a15">NameAndExtension</a>(),
00786         lpstrDevice)) {
00787         <a class="code" href="../../d0/d3/classCGlobals.html#e7">CGlobals::ReportEx</a>(DisassocFailedWithName,NULL,FALSE,1,
00788                            MB_OK|MB_ICONEXCLAMATION,<a class="code" href="../../d7/d5/classCProfile.html#r2">m_csName</a>.<a class="code" href="../../d1/d7/classCString.html#a15">NameAndExtension</a>());
00789     } <span class="keywordflow">else</span>
00790         _RPTF2(_CRT_WARN, <span class="stringliteral">"CProfile::Dissociate %s from %s succeeded\n"</span>,
00791             lpstrDevice, (LPCTSTR) <a class="code" href="../../d7/d5/classCProfile.html#r2">m_csName</a>.<a class="code" href="../../d1/d7/classCString.html#a15">NameAndExtension</a>());
00792 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="e2" doxytag="CProfile::Enumerate" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void CProfile::Enumerate           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">ENUMTYPE &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>et</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>class <a class="el" href="../../d8/d5/classCProfileArray.html">CProfileArray</a> &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>cpaList</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00499">499</a> of file <a class="el" href="../../d3/d6/profile_8cpp-source.html">profile.cpp</a>.
<p>
References <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00844">CProfileArray::Add()</a>, <a class="el" href="../../d0/d7/halvprnt_8c-source.html#l00031">BYTE</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00827">CProfileArray::Empty()</a>, <a class="el" href="../../d7/d6/jul98_2test_2icm_8h.html#a49">EnumColorProfiles()</a>, <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00405">Enumerate()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, and <a class="el" href="../../d0/d7/halvprnt_8c-source.html#l00031">PBYTE</a>.
<p>
<pre class="fragment"><div>00499                                                                 {
00500 
00501     <span class="comment">//  Enumerate the existing profiles</span>
00502 
00503     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>   dwBuffer = 0, dwcProfiles;
00504 
00505     cpaList.Empty();
00506 
00507     <a class="code" href="../../d7/d6/jul98_2test_2icm_8h.html#a49">EnumColorProfiles</a>(NULL, &amp;et, NULL, &amp;dwBuffer, &amp;dwcProfiles);
00508 
00509     <span class="keywordflow">if</span>  (!dwBuffer) {
00510         _RPTF2(_CRT_WARN,
00511             <span class="stringliteral">"CProfile::Enumerate(Profile)- empty list- dwBuffer %d Error %d\n"</span>,
00512             dwBuffer, GetLastError());
00513         <span class="keywordflow">return</span>;
00514     }
00515 
00516     <span class="keyword">union </span>{
00517         <a class="code" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a>   pbBuffer;
00518         PTSTR   pstrBuffer;
00519     };
00520 
00521     pbBuffer = <span class="keyword">new</span> <a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a>[dwBuffer];
00522 
00523     <span class="keywordflow">if</span> (pbBuffer) {
00524 
00525         <span class="keywordflow">if</span>  (<a class="code" href="../../d7/d6/jul98_2test_2icm_8h.html#a49">EnumColorProfiles</a>(NULL, &amp;et, pbBuffer, &amp;dwBuffer, &amp;dwcProfiles)) {
00526             <span class="keywordflow">for</span> (PTSTR pstrMe = pstrBuffer;
00527                  dwcProfiles--;
00528                  pstrMe += 1 + lstrlen(pstrMe)) {
00529                 _RPTF1(_CRT_WARN, <span class="stringliteral">"CProfile::Enumerate(Profile) %s added\n"</span>,
00530                     pstrMe);
00531                 cpaList.Add(pstrMe);
00532             }
00533         }
00534 
00535         <span class="keyword">delete</span>  pbBuffer;
00536     }
00537 
00538 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="e1" doxytag="CProfile::Enumerate" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void CProfile::Enumerate           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">ENUMTYPE &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>et</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d2/d7/classCStringArray.html">CStringArray</a> &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>csaList</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d2/d7/classCStringArray.html">CStringArray</a> &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>csaDesc</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00445">445</a> of file <a class="el" href="../../d3/d6/profile_8cpp-source.html">profile.cpp</a>.
<p>
References <a class="el" href="../../d4/d6/stringar_8cpp-source.html#l00320">CStringArray::Add()</a>, <a class="el" href="../../d0/d7/halvprnt_8c-source.html#l00031">BYTE</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d4/d6/stringar_8cpp-source.html#l00298">CStringArray::Empty()</a>, <a class="el" href="../../d7/d6/jul98_2test_2icm_8h.html#a49">EnumColorProfiles()</a>, <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00405">Enumerate()</a>, <a class="el" href="../../d5/d6/stringar_8h-source.html#l00063">CString::IsEmpty()</a>, <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00194">IsValid()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d0/d7/halvprnt_8c-source.html#l00031">PBYTE</a>, and <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00698">TagContents()</a>.
<p>
<pre class="fragment"><div>00445                                                                                       {
00446 
00447     <span class="comment">//  Enumerate the existing profiles</span>
00448 
00449     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>   dwBuffer =0, dwcProfiles;
00450 
00451     csaList.<a class="code" href="../../d2/d7/classCStringArray.html#a6">Empty</a>();
00452 
00453     <a class="code" href="../../d7/d6/jul98_2test_2icm_8h.html#a49">EnumColorProfiles</a>(NULL, &amp;et, NULL, &amp;dwBuffer, &amp;dwcProfiles);
00454 
00455     <span class="keywordflow">if</span>  (!dwBuffer) {
00456         _RPTF2(_CRT_WARN,
00457             <span class="stringliteral">"CProfile::Enumerate(String)- empty list- dwBuffer %d Error %d\n"</span>,
00458             dwBuffer, GetLastError());
00459         <span class="keywordflow">return</span>;
00460     }
00461 
00462     <span class="keyword">union </span>{
00463         <a class="code" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a>   pbBuffer;
00464         PTSTR   pstrBuffer;
00465     };
00466 
00467     pbBuffer = <span class="keyword">new</span> <a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a>[dwBuffer];
00468 
00469     <span class="keywordflow">if</span> (pbBuffer) {
00470 
00471         <span class="keywordflow">if</span>  (<a class="code" href="../../d7/d6/jul98_2test_2icm_8h.html#a49">EnumColorProfiles</a>(NULL, &amp;et, pbBuffer, &amp;dwBuffer, &amp;dwcProfiles)) {
00472             <span class="keywordflow">for</span> (PTSTR pstrMe = pstrBuffer;
00473                  dwcProfiles--;
00474                  pstrMe += 1 + lstrlen(pstrMe)) {
00475                 _RPTF1(_CRT_WARN, <span class="stringliteral">"CProfile::Enumerate(String) %s found\n"</span>,
00476                     pstrMe);
00477 
00478                 <a class="code" href="../../d7/d5/classCProfile.html">CProfile</a> cp(pstrMe);
00479 
00480                 <span class="keywordflow">if</span> (cp.<a class="code" href="../../d7/d5/classCProfile.html#a7">IsValid</a>()) {
00481 
00482                     <a class="code" href="../../d1/d7/classCString.html">CString</a> csDescription = cp.<a class="code" href="../../d7/d5/classCProfile.html#a13">TagContents</a>('desc', 4);
00483 
00484                     <span class="keywordflow">if</span> (csDescription.<a class="code" href="../../d1/d7/classCString.html#a5">IsEmpty</a>()) {
00485                         csaDesc.<a class="code" href="../../d2/d7/classCStringArray.html#a3">Add</a>(pstrMe);
00486                     } <span class="keywordflow">else</span> {
00487                         csaDesc.<a class="code" href="../../d2/d7/classCStringArray.html#a3">Add</a>((LPTSTR)csDescription);
00488                     }
00489 
00490                     csaList.<a class="code" href="../../d2/d7/classCStringArray.html#a3">Add</a>(pstrMe);
00491                 }
00492             }
00493         }
00494 
00495         <span class="keyword">delete</span>  pbBuffer;
00496     }
00497 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="e0" doxytag="CProfile::Enumerate" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void CProfile::Enumerate           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">ENUMTYPE &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>et</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d2/d7/classCStringArray.html">CStringArray</a> &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>csaList</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00405">405</a> of file <a class="el" href="../../d3/d6/profile_8cpp-source.html">profile.cpp</a>.
<p>
References <a class="el" href="../../d4/d6/stringar_8cpp-source.html#l00320">CStringArray::Add()</a>, <a class="el" href="../../d0/d7/halvprnt_8c-source.html#l00031">BYTE</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d4/d6/stringar_8cpp-source.html#l00298">CStringArray::Empty()</a>, <a class="el" href="../../d7/d6/jul98_2test_2icm_8h.html#a49">EnumColorProfiles()</a>, <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00405">Enumerate()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, and <a class="el" href="../../d0/d7/halvprnt_8c-source.html#l00031">PBYTE</a>.
<p>
Referenced by <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00575">AssociationCheck()</a>, <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00607">DeviceCheck()</a>, <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00405">Enumerate()</a>, and <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00554">InstallCheck()</a>.
<p>
<pre class="fragment"><div>00405                                                                {
00406 
00407     <span class="comment">//  Enumerate the existing profiles</span>
00408 
00409     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>   dwBuffer =0, dwcProfiles;
00410 
00411     csaList.<a class="code" href="../../d2/d7/classCStringArray.html#a6">Empty</a>();
00412 
00413     <a class="code" href="../../d7/d6/jul98_2test_2icm_8h.html#a49">EnumColorProfiles</a>(NULL, &amp;et, NULL, &amp;dwBuffer, &amp;dwcProfiles);
00414 
00415     <span class="keywordflow">if</span>  (!dwBuffer) {
00416         _RPTF2(_CRT_WARN,
00417             <span class="stringliteral">"CProfile::Enumerate(String)- empty list- dwBuffer %d Error %d\n"</span>,
00418             dwBuffer, GetLastError());
00419         <span class="keywordflow">return</span>;
00420     }
00421 
00422     <span class="keyword">union </span>{
00423         <a class="code" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a>   pbBuffer;
00424         PTSTR   pstrBuffer;
00425     };
00426 
00427     pbBuffer = <span class="keyword">new</span> <a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a>[dwBuffer];
00428 
00429     <span class="keywordflow">if</span> (pbBuffer) {
00430 
00431         <span class="keywordflow">if</span>  (<a class="code" href="../../d7/d6/jul98_2test_2icm_8h.html#a49">EnumColorProfiles</a>(NULL, &amp;et, pbBuffer, &amp;dwBuffer, &amp;dwcProfiles)) {
00432             <span class="keywordflow">for</span> (PTSTR pstrMe = pstrBuffer;
00433                  dwcProfiles--;
00434                  pstrMe += 1 + lstrlen(pstrMe)) {
00435                 _RPTF1(_CRT_WARN, <span class="stringliteral">"CProfile::Enumerate(String) %s found\n"</span>,
00436                     pstrMe);
00437                 csaList.<a class="code" href="../../d2/d7/classCStringArray.html#a3">Add</a>(pstrMe);
00438             }
00439         }
00440 
00441         <span class="keyword">delete</span>  pbBuffer;
00442     }
00443 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a4" doxytag="CProfile::GetCMM" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> CProfile::GetCMM           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [inline]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00184">184</a> of file <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html">icmui/profile.h</a>.
<p>
References <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00158">m_hprof</a>, and <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00159">m_phThis</a>.
<p>
Referenced by <a class="el" href="../../d8/d6/profinfo_8cpp-source.html#l00051">CProfileInformationPage::OnInit()</a>.
<p>
<pre class="fragment"><div>00184 { <span class="keywordflow">return</span> <a class="code" href="../../d7/d5/classCProfile.html#r0">m_hprof</a> ? <a class="code" href="../../d7/d5/classCProfile.html#r1">m_phThis</a>.phCMMType : 0; }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a5" doxytag="CProfile::GetColorSpace" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> CProfile::GetColorSpace           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [inline]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00187">187</a> of file <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html">icmui/profile.h</a>.
<p>
References <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00158">m_hprof</a>, and <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00159">m_phThis</a>.
<p>
Referenced by <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00360">CDeviceProfileManagement::OnCommand()</a>.
<p>
<pre class="fragment"><div>00187 {<span class="keywordflow">return</span> <a class="code" href="../../d7/d5/classCProfile.html#r0">m_hprof</a> ? <a class="code" href="../../d7/d5/classCProfile.html#r1">m_phThis</a>.phDataColorSpace : 0;}
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a2" doxytag="CProfile::GetName" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d1/d7/classCString.html">CString</a> CProfile::GetName           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [inline]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00182">182</a> of file <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html">icmui/profile.h</a>.
<p>
References <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00160">m_csName</a>, and <a class="el" href="../../d4/d6/stringar_8cpp-source.html#l00165">CString::NameOnly()</a>.
<p>
Referenced by <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00532">CICMUserInterface::InvokeCommand()</a>, <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00360">CDeviceProfileManagement::OnCommand()</a>, <a class="el" href="../../d5/d7/propdlg_8cpp-source.html#l00112">CAdvancedPage::OnInit()</a>, <a class="el" href="../../d5/d7/propdlg_8cpp-source.html#l00035">CInstallPage::OnInit()</a>, and <a class="el" href="../../d7/d4/profassoc_8cpp-source.html#l00057">CProfileAssociationPage::OnInit()</a>.
<p>
<pre class="fragment"><div>00182 { <span class="keywordflow">return</span> <a class="code" href="../../d7/d5/classCProfile.html#r2">m_csName</a>.<a class="code" href="../../d1/d7/classCString.html#a14">NameOnly</a>(); }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="CProfile::GetType" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> CProfile::GetType           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [inline]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00183">183</a> of file <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html">icmui/profile.h</a>.
<p>
References <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00158">m_hprof</a>, and <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00159">m_phThis</a>.
<p>
Referenced by <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00360">CDeviceProfileManagement::OnCommand()</a>.
<p>
<pre class="fragment"><div>00183 { <span class="keywordflow">return</span> <a class="code" href="../../d7/d5/classCProfile.html#r0">m_hprof</a> ? <a class="code" href="../../d7/d5/classCProfile.html#r1">m_phThis</a>.phClass : 0; }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a14" doxytag="CProfile::Install" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL CProfile::Install           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00712">712</a> of file <a class="el" href="../../d3/d6/profile_8cpp-source.html">profile.cpp</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d3/d8/ntgdi_2icm_2icmui_2resource_8h-source.html#l00060">InstFailedWithName</a>, <a class="el" href="../../d3/d8/icmui_8h-source.html#l00077">CGlobals::InvalidateList()</a>, <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00161">m_bIsInstalled</a>, <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00160">m_csName</a>, <a class="el" href="../../d4/d6/stringar_8cpp-source.html#l00176">CString::NameAndExtension()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00759">Associate()</a>, <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00532">CICMUserInterface::InvokeCommand()</a>, and <a class="el" href="../../d2/d7/profprop_8cpp-source.html#l00205">CProfilePropertySheet::OnCommand()</a>.
<p>
<pre class="fragment"><div>00712                           {
00713 
00714     <span class="keywordflow">if</span>  (!InstallColorProfile(NULL, m_csName)) {
00715         <a class="code" href="../../d0/d3/classCGlobals.html#e7">CGlobals::ReportEx</a>(InstFailedWithName,NULL,FALSE,
00716                            MB_OK|MB_ICONEXCLAMATION,1,<a class="code" href="../../d7/d5/classCProfile.html#r2">m_csName</a>.<a class="code" href="../../d1/d7/classCString.html#a15">NameAndExtension</a>());
00717         <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00718     } <span class="keywordflow">else</span> {
00719         <a class="code" href="../../d7/d5/classCProfile.html#r3">m_bIsInstalled</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00720         <a class="code" href="../../d0/d3/classCGlobals.html#e9">CGlobals::InvalidateList</a>();
00721         SHChangeNotify(SHCNE_UPDATEITEM, SHCNF_PATH, (LPCTSTR) m_csName, NULL);
00722 
00723         _RPTF1(_CRT_WARN, <span class="stringliteral">"CProfile::Install %s succeeded\n"</span>,
00724             (LPCSTR) m_csName);
00725         <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00726     }
00727 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="d0" doxytag="CProfile::InstallCheck" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void CProfile::InstallCheck           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [private]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00554">554</a> of file <a class="el" href="../../d3/d6/profile_8cpp-source.html">profile.cpp</a>.
<p>
References <a class="el" href="../../d5/d6/stringar_8h-source.html#l00103">CStringArray::Count()</a>, <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00405">Enumerate()</a>, <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00161">m_bInstallChecked</a>, <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00161">m_bIsInstalled</a>, <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00160">m_csName</a>, <a class="el" href="../../d4/d6/stringar_8cpp-source.html#l00165">CString::NameOnly()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00189">IsInstalled()</a>.
<p>
<pre class="fragment"><div>00554                                {
00555 
00556     <span class="comment">//  Enumerate the existing profiles, so we can see if this one's been</span>
00557     <span class="comment">//  installed, already.</span>
00558 
00559     ENUMTYPE    et = {<span class="keyword">sizeof</span> (ENUMTYPE), ENUM_TYPE_VERSION, 0, <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>};
00560 
00561     <a class="code" href="../../d2/d7/classCStringArray.html">CStringArray</a>    csaWork;
00562 
00563     <a class="code" href="../../d7/d5/classCProfile.html#e0">Enumerate</a>(et, csaWork);
00564 
00565     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> u = 0; u &lt; csaWork.<a class="code" href="../../d2/d7/classCStringArray.html#a2">Count</a>(); u++)
00566         <span class="keywordflow">if</span>  (!lstrcmpi(csaWork[u].NameOnly(), <a class="code" href="../../d7/d5/classCProfile.html#r2">m_csName</a>.<a class="code" href="../../d1/d7/classCString.html#a14">NameOnly</a>()))
00567             <span class="keywordflow">break</span>;
00568 
00569     <a class="code" href="../../d7/d5/classCProfile.html#r3">m_bIsInstalled</a> = u &lt; csaWork.<a class="code" href="../../d2/d7/classCStringArray.html#a2">Count</a>();
00570     <a class="code" href="../../d7/d5/classCProfile.html#r4">m_bInstallChecked</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00571 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a6" doxytag="CProfile::IsInstalled" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL CProfile::IsInstalled           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [inline]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00189">189</a> of file <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html">icmui/profile.h</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00554">InstallCheck()</a>, <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00161">m_bInstallChecked</a>, and <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00161">m_bIsInstalled</a>.
<p>
Referenced by <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00759">Associate()</a>, <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00575">AssociationCheck()</a>, <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00532">CICMUserInterface::InvokeCommand()</a>, <a class="el" href="../../d2/d7/profprop_8cpp-source.html#l00205">CProfilePropertySheet::OnCommand()</a>, <a class="el" href="../../d5/d7/propdlg_8cpp-source.html#l00035">CInstallPage::OnInit()</a>, <a class="el" href="../../d2/d7/profprop_8cpp-source.html#l00126">CProfilePropertySheet::OnInit()</a>, <a class="el" href="../../d7/d4/profassoc_8cpp-source.html#l00057">CProfileAssociationPage::OnInit()</a>, and <a class="el" href="../../d7/d4/profassoc_8cpp-source.html#l00278">CProfileAssociationPage::OnNotify()</a>.
<p>
<pre class="fragment"><div>00189                           {
00190         <span class="keywordflow">if</span>  (!<a class="code" href="../../d7/d5/classCProfile.html#r4">m_bInstallChecked</a>)
00191             <a class="code" href="../../d7/d5/classCProfile.html#d0">InstallCheck</a>();
00192         <span class="keywordflow">return</span> <a class="code" href="../../d7/d5/classCProfile.html#r3">m_bIsInstalled</a>;
00193     }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a7" doxytag="CProfile::IsValid" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL CProfile::IsValid           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [inline]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00194">194</a> of file <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html">icmui/profile.h</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d1/d6/w32_2ntgdi_2icm_2mscms_2profile_8c-source.html#l00375">IsColorProfileValid()</a>, and <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00158">m_hprof</a>.
<p>
Referenced by <a class="el" href="../../d2/d7/profprop_8cpp-source.html#l00055">CProfilePropertySheet::CProfilePropertySheet()</a>, <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00445">Enumerate()</a>, and <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00360">CDeviceProfileManagement::OnCommand()</a>.
<p>
<pre class="fragment"><div>00194                       {
00195         <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> bValid = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00196 
00197         <span class="keywordflow">if</span> (<a class="code" href="../../d7/d5/classCProfile.html#r0">m_hprof</a>)
00198             <a class="code" href="../../d0/d7/w32_2ntgdi_2icm_2mscms_2profile_8c.html#a15">IsColorProfileValid</a>(m_hprof, &amp;bValid);
00199 
00200         <span class="keywordflow">return</span>  bValid;
00201     }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a13" doxytag="CProfile::TagContents" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> LPCSTR CProfile::TagContents           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">TAGTYPE&nbsp;</td>
          <td class="mdname" nowrap> <em>tt</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>unsigned&nbsp;</td>
          <td class="mdname" nowrap> <em>uOffset</em> = <code>0</code></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00698">698</a> of file <a class="el" href="../../d3/d6/profile_8cpp-source.html">profile.cpp</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d1/d6/w32_2ntgdi_2icm_2mscms_2profile_8c-source.html#l00817">GetColorProfileElement()</a>, <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00165">m_acTag</a>, <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00158">m_hprof</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, and <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00698">TagContents()</a>.
<p>
Referenced by <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00445">Enumerate()</a>, <a class="el" href="../../d8/d6/profinfo_8cpp-source.html#l00051">CProfileInformationPage::OnInit()</a>, and <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00698">TagContents()</a>.
<p>
<pre class="fragment"><div>00698                                                           {
00699 
00700     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>   dwcNeeded = <span class="keyword">sizeof</span> <a class="code" href="../../d7/d5/classCProfile.html#r9">m_acTag</a>;
00701     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    bIgnore;
00702 
00703     <span class="keywordflow">if</span>  (!<a class="code" href="../../d0/d7/w32_2ntgdi_2icm_2mscms_2profile_8c.html#a21">GetColorProfileElement</a>(m_hprof, tt, 8 + uOffset, &amp;dwcNeeded, m_acTag,
00704          &amp;bIgnore))
00705         <span class="keywordflow">return</span>  <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;   <span class="comment">//  Nothing to copy!</span>
00706     <span class="keywordflow">else</span>
00707         <span class="keywordflow">return</span>  m_acTag;
00708 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a15" doxytag="CProfile::Uninstall" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void CProfile::Uninstall           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">BOOL&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>bDelete</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00731">731</a> of file <a class="el" href="../../d3/d6/profile_8cpp-source.html">profile.cpp</a>.
<p>
References <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00213">AssociationCount()</a>, <a class="el" href="../../d1/d6/w32_2ntgdi_2icm_2mscms_2profile_8c-source.html#l00271">CloseColorProfile()</a>, <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00219">DeviceName()</a>, <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00784">Dissociate()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d3/d8/icmui_8h-source.html#l00077">CGlobals::InvalidateList()</a>, <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00161">m_bIsInstalled</a>, <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00160">m_csName</a>, <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00164">m_cuaAssociation</a>, <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00158">m_hprof</a>, <a class="el" href="../../d4/d6/stringar_8cpp-source.html#l00176">CString::NameAndExtension()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d4/d6/stringar_8cpp-source.html#l00449">CUintArray::Remove()</a>, <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00731">Uninstall()</a>, and <a class="el" href="../../d3/d8/ntgdi_2icm_2icmui_2resource_8h-source.html#l00061">UninstFailedWithName</a>.
<p>
Referenced by <a class="el" href="../../d9/d7/shellext_8cpp-source.html#l00532">CICMUserInterface::InvokeCommand()</a>, <a class="el" href="../../d2/d7/profprop_8cpp-source.html#l00205">CProfilePropertySheet::OnCommand()</a>, and <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00731">Uninstall()</a>.
<p>
<pre class="fragment"><div>00731                                         {
00732 
00733     <span class="keywordflow">while</span>   (<a class="code" href="../../d7/d5/classCProfile.html#a9">AssociationCount</a>()) {    <span class="comment">// Dissociate all uses</span>
00734         <a class="code" href="../../d7/d5/classCProfile.html#a17">Dissociate</a>(<a class="code" href="../../d7/d5/classCProfile.html#a10">DeviceName</a>(m_cuaAssociation[0]));
00735         <a class="code" href="../../d7/d5/classCProfile.html#r8">m_cuaAssociation</a>.<a class="code" href="../../d3/d7/classCUintArray.html#a5">Remove</a>(0);
00736     }
00737 
00738     <span class="keywordflow">if</span>  (<a class="code" href="../../d7/d5/classCProfile.html#r0">m_hprof</a>)
00739     {
00740         <a class="code" href="../../d0/d7/w32_2ntgdi_2icm_2mscms_2profile_8c.html#a13">CloseColorProfile</a>(m_hprof);
00741         <a class="code" href="../../d7/d5/classCProfile.html#r0">m_hprof</a> = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00742     }
00743 
00744     <span class="keywordflow">if</span>  (!UninstallColorProfile(NULL, <a class="code" href="../../d7/d5/classCProfile.html#r2">m_csName</a>.<a class="code" href="../../d1/d7/classCString.html#a15">NameAndExtension</a>(), bDelete)) {
00745         <a class="code" href="../../d0/d3/classCGlobals.html#e7">CGlobals::ReportEx</a>(UninstFailedWithName,NULL,FALSE,
00746                            MB_OK|MB_ICONEXCLAMATION,1,<a class="code" href="../../d7/d5/classCProfile.html#r2">m_csName</a>.<a class="code" href="../../d1/d7/classCString.html#a15">NameAndExtension</a>());
00747     } <span class="keywordflow">else</span> {
00748         <a class="code" href="../../d7/d5/classCProfile.html#r3">m_bIsInstalled</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00749         <a class="code" href="../../d0/d3/classCGlobals.html#e9">CGlobals::InvalidateList</a>();
00750         SHChangeNotify(SHCNE_UPDATEITEM, SHCNF_PATH, (LPCTSTR) m_csName, NULL);
00751 
00752         _RPTF1(_CRT_WARN, <span class="stringliteral">"CProfile::Uninstall %s succeeded\n"</span>,
00753             (LPCSTR) m_csName);
00754     }
00755 }
</div></pre>    </td>
  </tr>
</table>
<hr><h2>Member Data Documentation</h2>
<a class="anchor" name="r9" doxytag="CProfile::m_acTag" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> char <a class="el" href="../../d7/d5/classCProfile.html#r9">CProfile::m_acTag</a>[MAX_PATH *2]<code> [private]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00165">165</a> of file <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html">icmui/profile.h</a>.
<p>
Referenced by <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00698">TagContents()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="r5" doxytag="CProfile::m_bAssociationsChecked" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL <a class="el" href="../../d7/d5/classCProfile.html#r5">CProfile::m_bAssociationsChecked</a><code> [private]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00161">161</a> of file <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html">icmui/profile.h</a>.
<p>
Referenced by <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00239">Association()</a>, <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00575">AssociationCheck()</a>, <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00213">AssociationCount()</a>, and <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00617">CProfile()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="r6" doxytag="CProfile::m_bDevicesChecked" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL <a class="el" href="../../d7/d5/classCProfile.html#r6">CProfile::m_bDevicesChecked</a><code> [private]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00161">161</a> of file <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html">icmui/profile.h</a>.
<p>
Referenced by <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00617">CProfile()</a>, <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00607">DeviceCheck()</a>, <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00203">DeviceCount()</a>, <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00219">DeviceName()</a>, and <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00229">DisplayName()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="r4" doxytag="CProfile::m_bInstallChecked" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL <a class="el" href="../../d7/d5/classCProfile.html#r4">CProfile::m_bInstallChecked</a><code> [private]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00161">161</a> of file <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html">icmui/profile.h</a>.
<p>
Referenced by <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00617">CProfile()</a>, <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00554">InstallCheck()</a>, and <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00189">IsInstalled()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="r3" doxytag="CProfile::m_bIsInstalled" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL <a class="el" href="../../d7/d5/classCProfile.html#r3">CProfile::m_bIsInstalled</a><code> [private]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00161">161</a> of file <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html">icmui/profile.h</a>.
<p>
Referenced by <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00712">Install()</a>, <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00554">InstallCheck()</a>, <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00189">IsInstalled()</a>, and <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00731">Uninstall()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="r2" doxytag="CProfile::m_csName" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d1/d7/classCString.html">CString</a> <a class="el" href="../../d7/d5/classCProfile.html#r2">CProfile::m_csName</a><code> [private]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00160">160</a> of file <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html">icmui/profile.h</a>.
<p>
Referenced by <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00759">Associate()</a>, <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00575">AssociationCheck()</a>, <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00617">CProfile()</a>, <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00784">Dissociate()</a>, <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00182">GetName()</a>, <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00712">Install()</a>, <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00554">InstallCheck()</a>, and <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00731">Uninstall()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="r8" doxytag="CProfile::m_cuaAssociation" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d3/d7/classCUintArray.html">CUintArray</a> <a class="el" href="../../d7/d5/classCProfile.html#r8">CProfile::m_cuaAssociation</a><code> [private]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00164">164</a> of file <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html">icmui/profile.h</a>.
<p>
Referenced by <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00239">Association()</a>, <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00575">AssociationCheck()</a>, <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00213">AssociationCount()</a>, and <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00731">Uninstall()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="r0" doxytag="CProfile::m_hprof" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HPROFILE <a class="el" href="../../d7/d5/classCProfile.html#r0">CProfile::m_hprof</a><code> [private]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00158">158</a> of file <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html">icmui/profile.h</a>.
<p>
Referenced by <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00617">CProfile()</a>, <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00184">GetCMM()</a>, <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00187">GetColorSpace()</a>, <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00183">GetType()</a>, <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00194">IsValid()</a>, <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00698">TagContents()</a>, <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00731">Uninstall()</a>, and <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00689">~CProfile()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="r7" doxytag="CProfile::m_pcdlClass" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d1/d2/classCDeviceList.html">CDeviceList</a>* <a class="el" href="../../d7/d5/classCProfile.html#r7">CProfile::m_pcdlClass</a><code> [private]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00163">163</a> of file <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html">icmui/profile.h</a>.
<p>
Referenced by <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00575">AssociationCheck()</a>, <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00617">CProfile()</a>, <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00607">DeviceCheck()</a>, <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00203">DeviceCount()</a>, <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00219">DeviceName()</a>, <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00229">DisplayName()</a>, and <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00689">~CProfile()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="r1" doxytag="CProfile::m_phThis" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PROFILEHEADER <a class="el" href="../../d7/d5/classCProfile.html#r1">CProfile::m_phThis</a><code> [private]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00159">159</a> of file <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html">icmui/profile.h</a>.
<p>
Referenced by <a class="el" href="../../d3/d6/profile_8cpp-source.html#l00617">CProfile()</a>, <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00184">GetCMM()</a>, <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00187">GetColorSpace()</a>, and <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00183">GetType()</a>.    </td>
  </tr>
</table>
<hr>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="../../d4/d6/icmui_2profile_8h-source.html">icmui/profile.h</a><li><a class="el" href="../../d3/d6/profile_8cpp-source.html">profile.cpp</a></ul>
<hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:46:27 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
