<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: profassoc.cpp Source File</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>profassoc.cpp</h1><a href="../../d6/d5/profassoc_8cpp.html">Go to the documentation of this file.</a><pre class="fragment"><div>00001 <span class="comment">/******************************************************************************</span>
00002 <span class="comment"></span>
00003 <span class="comment">  Source File:  Profile Association Page.CPP</span>
00004 <span class="comment"></span>
00005 <span class="comment">  Copyright (c) 1997 by Microsoft Corporation</span>
00006 <span class="comment"></span>
00007 <span class="comment">  Change History:</span>
00008 <span class="comment"></span>
00009 <span class="comment">  05-09-1997 hideyukn - Created</span>
00010 <span class="comment"></span>
00011 <span class="comment">******************************************************************************/</span>
00012 
00013 <span class="preprocessor">#include    "ICMUI.H"</span>
00014 
00015 <span class="preprocessor">#include    "Resource.H"</span>
00016 
00017 <span class="comment">//  It looks like the way to make the icon draw is to subclass the Icon control</span>
00018 <span class="comment">//  in the window.  So, here's a Window Procedure for the subclass</span>
00019 
<a name="l00020"></a><a class="code" href="../../d6/d5/profassoc_8cpp.html#a0">00020</a> CONST <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> <a class="code" href="../../d6/d5/profassoc_8cpp.html#a0">ProfileAssociationUIHelpIds</a>[] = {
00021     <a class="code" href="../../d2/d9/ntgdi_2icm_2icmui_2resource_8h.html#a57">AddButton</a>,             <a class="code" href="../../d3/d9/icmuihlp_8h.html#a2">IDH_ASSOCDEVICE_ADD</a>,
00022     <a class="code" href="../../d2/d9/ntgdi_2icm_2icmui_2resource_8h.html#a58">RemoveButton</a>,          <a class="code" href="../../d3/d9/icmuihlp_8h.html#a3">IDH_ASSOCDEVICE_REMOVE</a>,
00023 <span class="preprocessor">#if !defined(_WIN95_) // context-sentitive help</span>
00024 <span class="preprocessor"></span>    <a class="code" href="../../d2/d9/ntgdi_2icm_2icmui_2resource_8h.html#a74">ProfileFilename</a>,       <a class="code" href="../../d3/d9/icmuihlp_8h.html#a4">IDH_ASSOCDEVICE_NAME</a>,
00025     <a class="code" href="../../d2/d9/ntgdi_2icm_2icmui_2resource_8h.html#a62">DeviceListControl</a>,     <a class="code" href="../../d3/d9/icmuihlp_8h.html#a5">IDH_ASSOCDEVICE_LIST</a>,
00026     <a class="code" href="../../d2/d9/ntgdi_2icm_2icmui_2resource_8h.html#a63">DeviceListControlText</a>, <a class="code" href="../../d3/d9/icmuihlp_8h.html#a5">IDH_ASSOCDEVICE_LIST</a>,
00027     <a class="code" href="../../d2/d9/ntgdi_2icm_2icmui_2resource_8h.html#a77">StatusIcon</a>,            <a class="code" href="../../d3/d9/icmuihlp_8h.html#a1">IDH_DISABLED</a>,
00028 <span class="preprocessor">#endif</span>
00029 <span class="preprocessor"></span>    0, 0
00030 };
00031 
00032 <span class="comment">//  CProfileAssociationPage member functions</span>
00033 
00034 <span class="comment">//  Class Constructor</span>
00035 
<a name="l00036"></a><a class="code" href="../../d9/d5/classCProfileAssociationPage.html#a0">00036</a> <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#a0">CProfileAssociationPage::CProfileAssociationPage</a>(HINSTANCE hiWhere,
00037                                                  LPCTSTR lpstrTarget) {
00038     <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r1">m_pcpTarget</a> = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00039     <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r0">m_csProfile</a> = lpstrTarget;
00040     m_psp.dwSize = <span class="keyword">sizeof</span> m_psp;
00041     m_psp.dwFlags |= PSP_USETITLE;
00042     m_psp.hInstance = hiWhere;
00043     m_psp.pszTemplate = MAKEINTRESOURCE(<a class="code" href="../../d2/d9/ntgdi_2icm_2icmui_2resource_8h.html#a51">AssociateDevicePage</a>);
00044     m_psp.pszTitle = MAKEINTRESOURCE(<a class="code" href="../../d2/d9/ntgdi_2icm_2icmui_2resource_8h.html#a7">AssociatePropertyString</a>);
00045 }
00046 
00047 <span class="comment">//  Class destructor</span>
00048 
<a name="l00049"></a><a class="code" href="../../d9/d5/classCProfileAssociationPage.html#a1">00049</a> <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#a1">CProfileAssociationPage::~CProfileAssociationPage</a>() {
00050     <span class="keywordflow">if</span> (<a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r1">m_pcpTarget</a>) {
00051         <span class="keyword">delete</span> <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r1">m_pcpTarget</a>;
00052     }
00053 }
00054 
00055 <span class="comment">//  Dialog box (property sheet) initialization</span>
00056 
<a name="l00057"></a><a class="code" href="../../d9/d5/classCProfileAssociationPage.html#a4">00057</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#a4">CProfileAssociationPage::OnInit</a>() {
00058 
00059     <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r1">m_pcpTarget</a> = <span class="keyword">new</span> <a class="code" href="../../d7/d5/classCProfile.html">CProfile</a>(<a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r0">m_csProfile</a>);
00060 
00061     <span class="keywordflow">if</span> (<a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r1">m_pcpTarget</a>) {
00062 
00063         <span class="comment">// Set profile filename</span>
00064 
00065         <a class="code" href="../../d5/d9/cltxt_8h.html#a20">SetDlgItemText</a>(m_hwnd, <a class="code" href="../../d2/d9/ntgdi_2icm_2icmui_2resource_8h.html#a74">ProfileFilename</a>, <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r1">m_pcpTarget</a>-&gt;<a class="code" href="../../d7/d5/classCProfile.html#a2">GetName</a>());
00066 
00067         <span class="comment">// Update ICON to show installed/non-installed status.</span>
00068 
00069         HICON hIcon = LoadIcon(CGlobals::Instance(),
00070                                MAKEINTRESOURCE(<a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r1">m_pcpTarget</a>-&gt;<a class="code" href="../../d7/d5/classCProfile.html#a6">IsInstalled</a>() ? <a class="code" href="../../d2/d9/ntgdi_2icm_2icmui_2resource_8h.html#a44">DefaultIcon</a> : <a class="code" href="../../d2/d9/ntgdi_2icm_2icmui_2resource_8h.html#a45">UninstalledIcon</a>));
00071 
00072         <span class="keywordflow">if</span> (hIcon) {
00073             <a class="code" href="../../d5/d9/cltxt_8h.html#a18">SendDlgItemMessage</a>(m_hwnd, <a class="code" href="../../d2/d9/ntgdi_2icm_2icmui_2resource_8h.html#a77">StatusIcon</a>, STM_SETICON, (WPARAM) hIcon, 0);
00074         }
00075 
00076         <span class="comment">// Clean up add/delete list.</span>
00077 
00078         <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r2">m_cuaAdd</a>.<a class="code" href="../../d3/d7/classCUintArray.html#a6">Empty</a>();
00079         <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r3">m_cuaDelete</a>.<a class="code" href="../../d3/d7/classCUintArray.html#a6">Empty</a>();
00080 
00081         <span class="comment">// Build tentitive association list.</span>
00082 
00083         <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#a2">ConstructAssociations</a>();
00084 
00085         <span class="comment">// And then, fill up device listbox</span>
00086 
00087         <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#a3">UpdateDeviceListBox</a>();
00088 
00089         <span class="comment">// And set focus on AddButton.</span>
00090 
00091         <a class="code" href="../../d3/d0/user32_8def.html#a43">SetFocus</a>(<a class="code" href="../../d3/d9/client_2wow_8c.html#a6">GetDlgItem</a>(m_hwnd,<a class="code" href="../../d2/d9/ntgdi_2icm_2icmui_2resource_8h.html#a57">AddButton</a>));
00092 
00093         <a class="code" href="../../d2/d6/classCPropertyPage.html#a4">DisableApplyButton</a>();
00094         <a class="code" href="../../d2/d6/classCPropertyPage.html#a5">SettingChanged</a>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00095 
00096         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00097 
00098     } <span class="keywordflow">else</span> {
00099         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00100     }
00101 }
00102 
00103 <span class="comment">//  Private ConstructAssociations function- this constructs the list of</span>
00104 <span class="comment">//  tentative associations- this starts out as the true list from the profile</span>
00105 <span class="comment">//  object.</span>
00106 
<a name="l00107"></a><a class="code" href="../../d9/d5/classCProfileAssociationPage.html#a2">00107</a> <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>    <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#a2">CProfileAssociationPage::ConstructAssociations</a>() {
00108 
00109     <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r4">m_cuaAssociate</a>.<a class="code" href="../../d3/d7/classCUintArray.html#a6">Empty</a>(); <span class="comment">//  Clean it up!</span>
00110 
00111     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> u = 0; u &lt; <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r1">m_pcpTarget</a>-&gt;<a class="code" href="../../d7/d5/classCProfile.html#a9">AssociationCount</a>(); u++) {
00112 
00113         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> uDelete = 0;
00114              uDelete &lt; <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r3">m_cuaDelete</a>.<a class="code" href="../../d3/d7/classCUintArray.html#a2">Count</a>();
00115              uDelete++) {
00116             <span class="keywordflow">if</span>  (<a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r3">m_cuaDelete</a>[uDelete] == <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r1">m_pcpTarget</a>-&gt;<a class="code" href="../../d7/d5/classCProfile.html#a12">Association</a>(u))
00117                 <span class="keywordflow">break</span>;
00118         }
00119 
00120         <span class="keywordflow">if</span>  (uDelete == <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r3">m_cuaDelete</a>.<a class="code" href="../../d3/d7/classCUintArray.html#a2">Count</a>())    <span class="comment">//  Not yet deleted</span>
00121             <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r4">m_cuaAssociate</a>.<a class="code" href="../../d3/d7/classCUintArray.html#a3">Add</a>(<a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r1">m_pcpTarget</a>-&gt;<a class="code" href="../../d7/d5/classCProfile.html#a12">Association</a>(u));
00122     }
00123 
00124     <span class="comment">//  Now, add any added associations</span>
00125 
00126     <span class="keywordflow">for</span> (u = 0; u &lt; <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r2">m_cuaAdd</a>.<a class="code" href="../../d3/d7/classCUintArray.html#a2">Count</a>(); u++)
00127         <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r4">m_cuaAssociate</a>.<a class="code" href="../../d3/d7/classCUintArray.html#a3">Add</a>(<a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r2">m_cuaAdd</a>[u]);
00128 }
00129 
00130 <span class="comment">//  Public method for noting tentative associations to be added</span>
00131 
<a name="l00132"></a><a class="code" href="../../d9/d5/classCProfileAssociationPage.html#a12">00132</a> <span class="keywordtype">void</span>    <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#a12">CProfileAssociationPage::Associate</a>(<span class="keywordtype">unsigned</span> uAdd) {
00133 
00134     <span class="comment">//  First, see if it's on the delete list.  If it is, remove it from there</span>
00135     <span class="comment">//  Otherwise, add us to the add list, if it's a new association.</span>
00136 
00137     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> u = 0; u &lt; <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r3">m_cuaDelete</a>.<a class="code" href="../../d3/d7/classCUintArray.html#a2">Count</a>(); u++)
00138         <span class="keywordflow">if</span>  (uAdd == <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r3">m_cuaDelete</a>[u])
00139             <span class="keywordflow">break</span>;
00140 
00141     <span class="keywordflow">if</span>  (u &lt; m_cuaDelete.Count())
00142         m_cuaDelete.Remove(u);
00143     <span class="keywordflow">else</span> {
00144         <span class="keywordflow">for</span> (u = 0; u &lt; <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r4">m_cuaAssociate</a>.<a class="code" href="../../d3/d7/classCUintArray.html#a2">Count</a>(); u++)
00145             <span class="keywordflow">if</span>  (<a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r4">m_cuaAssociate</a>[u] == uAdd)
00146                 <span class="keywordflow">break</span>;
00147         <span class="keywordflow">if</span>  (u == <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r4">m_cuaAssociate</a>.<a class="code" href="../../d3/d7/classCUintArray.html#a2">Count</a>())
00148             <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r2">m_cuaAdd</a>.<a class="code" href="../../d3/d7/classCUintArray.html#a3">Add</a>(uAdd);
00149     }
00150 
00151     <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#a17">DeviceListChanged</a>();
00152 }
00153 
00154 <span class="comment">//  Public Method for removing tentative associations</span>
00155 
<a name="l00156"></a><a class="code" href="../../d9/d5/classCProfileAssociationPage.html#a13">00156</a> <span class="keywordtype">void</span>    <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#a13">CProfileAssociationPage::Dissociate</a>(<span class="keywordtype">unsigned</span> uRemove) {
00157 
00158     <span class="comment">//  First, see if it's on the add list.  If it is, remove it from there</span>
00159     <span class="comment">//  Otherwise, add us to the delete list.</span>
00160 
00161     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> u = 0; u &lt; <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r2">m_cuaAdd</a>.<a class="code" href="../../d3/d7/classCUintArray.html#a2">Count</a>(); u++)
00162         <span class="keywordflow">if</span>  (uRemove == <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r2">m_cuaAdd</a>[u])
00163             <span class="keywordflow">break</span>;
00164 
00165     <span class="keywordflow">if</span>  (u &lt; m_cuaAdd.Count())
00166         m_cuaAdd.Remove(u);
00167     <span class="keywordflow">else</span>
00168         <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r3">m_cuaDelete</a>.<a class="code" href="../../d3/d7/classCUintArray.html#a3">Add</a>(uRemove);
00169 
00170     <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#a17">DeviceListChanged</a>();
00171 }
00172 
<a name="l00173"></a><a class="code" href="../../d9/d5/classCProfileAssociationPage.html#a3">00173</a> <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>    <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#a3">CProfileAssociationPage::UpdateDeviceListBox</a>() {
00174 
00175     <span class="comment">//  Add the associations to the list</span>
00176 
00177     <a class="code" href="../../d5/d9/cltxt_8h.html#a18">SendDlgItemMessage</a>(m_hwnd, <a class="code" href="../../d2/d9/ntgdi_2icm_2icmui_2resource_8h.html#a62">DeviceListControl</a>, LB_RESETCONTENT, 0, 0);
00178 
00179     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> u = 0; u &lt; <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#a15">AssociationCount</a>(); u++ ) {
00180         LRESULT iItem = <a class="code" href="../../d5/d9/cltxt_8h.html#a18">SendDlgItemMessage</a>(m_hwnd, <a class="code" href="../../d2/d9/ntgdi_2icm_2icmui_2resource_8h.html#a62">DeviceListControl</a>, LB_ADDSTRING,
00181             0, (LPARAM) <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#a18">DisplayName</a>(u));
00182         <a class="code" href="../../d5/d9/cltxt_8h.html#a18">SendDlgItemMessage</a>(m_hwnd, <a class="code" href="../../d2/d9/ntgdi_2icm_2icmui_2resource_8h.html#a62">DeviceListControl</a>, LB_SETITEMDATA, iItem,
00183             (LPARAM) <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#a14">Association</a>(u));
00184     }
00185 
00186     <span class="comment">//  If there are no associations, disable the Remove Devices button</span>
00187 
00188     HWND hwndRemove = <a class="code" href="../../d3/d9/client_2wow_8c.html#a6">GetDlgItem</a>(m_hwnd,<a class="code" href="../../d2/d9/ntgdi_2icm_2icmui_2resource_8h.html#a58">RemoveButton</a>);
00189 
00190     <span class="comment">//  If there are no more devices, or all are associated, disable the Add</span>
00191     <span class="comment">//  Devices button.</span>
00192     <span class="comment">//</span>
00193     <span class="comment">//  !!! To get more performance !!!</span>
00194     <span class="comment">//</span>
00195     <span class="comment">//  EnableWindow(GetDlgItem(m_hwnd, AddButton),</span>
00196     <span class="comment">//     m_pcpTarget-&gt;DeviceCount() &amp;&amp; m_pcpTarget-&gt;DeviceCount() &gt; AssociationCount());</span>
00197     <span class="comment">//</span>
00198     <span class="comment">//  !!! AddButton NEVER DISABLED !!!</span>
00199     <span class="comment">//</span>
00200 
00201     <span class="comment">// If focus is on Remove, move it to Add button.</span>
00202 
00203     <span class="keywordflow">if</span> (<a class="code" href="../../d3/d8/winmgrc_8c.html#a11">GetFocus</a>() == hwndRemove) {
00204 
00205         HWND hwndAdd = <a class="code" href="../../d3/d9/client_2wow_8c.html#a6">GetDlgItem</a>(m_hwnd, <a class="code" href="../../d2/d9/ntgdi_2icm_2icmui_2resource_8h.html#a57">AddButton</a>);
00206 
00207         <a class="code" href="../../d3/d0/user32_8def.html#a43">SetFocus</a>(hwndAdd);
00208         <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(hwndRemove, BM_SETSTYLE, BS_PUSHBUTTON, MAKELPARAM(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>, 0));
00209         <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(hwndAdd, BM_SETSTYLE, BS_DEFPUSHBUTTON, MAKELPARAM(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>, 0));
00210     }
00211 
00212     <a class="code" href="../../d3/d8/client_8c.html#a98">EnableWindow</a>(hwndRemove, !!(<a class="code" href="../../d9/d5/classCProfileAssociationPage.html#a15">AssociationCount</a>()));
00213 
00214     <span class="comment">//  If there is any device, set focus to 1st entry.</span>
00215 
00216     <span class="keywordflow">if</span>  (<a class="code" href="../../d5/d9/cltxt_8h.html#a18">SendDlgItemMessage</a>(m_hwnd, <a class="code" href="../../d2/d9/ntgdi_2icm_2icmui_2resource_8h.html#a62">DeviceListControl</a>, LB_GETCOUNT, 0, 0))
00217         <a class="code" href="../../d5/d9/cltxt_8h.html#a18">SendDlgItemMessage</a>(m_hwnd, <a class="code" href="../../d2/d9/ntgdi_2icm_2icmui_2resource_8h.html#a62">DeviceListControl</a>, LB_SETCURSEL, 0, 0);
00218 }
00219 
<a name="l00220"></a><a class="code" href="../../d9/d5/classCProfileAssociationPage.html#a5">00220</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#a5">CProfileAssociationPage::OnCommand</a>(WORD wNotifyCode, WORD wid, HWND hwndControl) {
00221 
00222     <span class="keywordflow">switch</span> (wid) {
00223 
00224         <span class="keywordflow">case</span> <a class="code" href="../../d2/d9/ntgdi_2icm_2icmui_2resource_8h.html#a57">AddButton</a> :
00225             <span class="keywordflow">if</span>  (wNotifyCode == BN_CLICKED) {
00226                 <a class="code" href="../../d4/d1/classCAddDeviceDialog.html">CAddDeviceDialog</a> cadd(<span class="keyword">this</span>, m_hwnd);
00227                 <span class="keywordflow">if</span> (!cadd.<a class="code" href="../../d4/d1/classCAddDeviceDialog.html#a5">bCanceled</a>()) {
00228                     <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#a3">UpdateDeviceListBox</a>();
00229                     <a class="code" href="../../d2/d6/classCPropertyPage.html#a3">EnableApplyButton</a>();
00230                     <a class="code" href="../../d2/d6/classCPropertyPage.html#a5">SettingChanged</a>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00231                 }
00232                 <span class="keywordflow">return</span>  <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00233             }
00234             <span class="keywordflow">break</span>;
00235 
00236         <span class="keywordflow">case</span> <a class="code" href="../../d2/d9/ntgdi_2icm_2icmui_2resource_8h.html#a58">RemoveButton</a> :
00237             <span class="keywordflow">if</span>  (wNotifyCode == BN_CLICKED) {
00238                 LRESULT i = <a class="code" href="../../d5/d9/cltxt_8h.html#a18">SendDlgItemMessage</a>(m_hwnd, <a class="code" href="../../d2/d9/ntgdi_2icm_2icmui_2resource_8h.html#a62">DeviceListControl</a>,
00239                     LB_GETCURSEL, 0, 0);
00240 
00241                 <span class="keywordflow">if</span>  (i == -1)
00242                     <span class="keywordflow">return</span>  <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00243 
00244                 <span class="keywordtype">unsigned</span> uItem = (<span class="keywordtype">unsigned</span>)<a class="code" href="../../d5/d9/cltxt_8h.html#a18">SendDlgItemMessage</a>(m_hwnd, <a class="code" href="../../d2/d9/ntgdi_2icm_2icmui_2resource_8h.html#a62">DeviceListControl</a>,
00245                     LB_GETITEMDATA, i, 0);
00246                 <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#a13">Dissociate</a>(uItem);
00247                 <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#a3">UpdateDeviceListBox</a>();
00248                 <a class="code" href="../../d2/d6/classCPropertyPage.html#a3">EnableApplyButton</a>();
00249                 <a class="code" href="../../d2/d6/classCPropertyPage.html#a5">SettingChanged</a>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00250                 <span class="keywordflow">return</span>  <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00251             }
00252             <span class="keywordflow">break</span>;
00253 
00254         <span class="keywordflow">case</span> <a class="code" href="../../d2/d9/ntgdi_2icm_2icmui_2resource_8h.html#a62">DeviceListControl</a> :
00255             <span class="keywordflow">if</span> (wNotifyCode == LBN_SELCHANGE) {
00256                 <a class="code" href="../../d3/d8/client_8c.html#a98">EnableWindow</a>(<a class="code" href="../../d3/d9/client_2wow_8c.html#a6">GetDlgItem</a>(m_hwnd, <a class="code" href="../../d2/d9/ntgdi_2icm_2icmui_2resource_8h.html#a58">RemoveButton</a>),
00257                     -1 != <a class="code" href="../../d5/d9/cltxt_8h.html#a18">SendDlgItemMessage</a>(m_hwnd, <a class="code" href="../../d2/d9/ntgdi_2icm_2icmui_2resource_8h.html#a62">DeviceListControl</a>, LB_GETCURSEL, 0, 0));
00258                 <span class="keywordflow">return</span>  <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00259             }
00260             <span class="keywordflow">break</span>;
00261     }
00262 
00263     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00264 }
00265 
<a name="l00266"></a><a class="code" href="../../d9/d5/classCProfileAssociationPage.html#a7">00266</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#a7">CProfileAssociationPage::OnDestroy</a>() {
00267 
00268     <span class="keywordflow">if</span> (<a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r1">m_pcpTarget</a>) {
00269         <span class="keyword">delete</span> <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r1">m_pcpTarget</a>;
00270         <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r1">m_pcpTarget</a> = (<a class="code" href="../../d7/d5/classCProfile.html">CProfile</a> *) <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00271     }
00272 
00273     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;  <span class="comment">// still need to handle this message by def. proc.</span>
00274 }
00275 
00276 <span class="comment">//  Common control notification override</span>
00277 
<a name="l00278"></a><a class="code" href="../../d9/d5/classCProfileAssociationPage.html#a6">00278</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#a6">CProfileAssociationPage::OnNotify</a>(<span class="keywordtype">int</span> idCtrl, LPNMHDR pnmh) {
00279 
00280     <span class="keywordflow">switch</span>  (pnmh -&gt; code) {
00281 
00282         <span class="keywordflow">case</span> PSN_APPLY: {
00283 
00284             <span class="keywordflow">if</span> (<a class="code" href="../../d2/d6/classCPropertyPage.html#a5">SettingChanged</a>()) {
00285 
00286                 <span class="comment">//  Disable apply button, because current request are</span>
00287                 <span class="comment">//  going to be "Applied".</span>
00288 
00289                 <a class="code" href="../../d2/d6/classCPropertyPage.html#a4">DisableApplyButton</a>();
00290 
00291                 <span class="comment">//  We are going to update changed.</span>
00292 
00293                 <a class="code" href="../../d2/d6/classCPropertyPage.html#a5">SettingChanged</a>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00294 
00295                 <span class="comment">//  Remove any associations we're removing</span>
00296 
00297                 <span class="keywordflow">while</span>   (<a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r3">m_cuaDelete</a>.<a class="code" href="../../d3/d7/classCUintArray.html#a2">Count</a>()) {
00298                     <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r1">m_pcpTarget</a>-&gt;<a class="code" href="../../d7/d5/classCProfile.html#a17">Dissociate</a>(<a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r1">m_pcpTarget</a>-&gt;<a class="code" href="../../d7/d5/classCProfile.html#a10">DeviceName</a>(<a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r3">m_cuaDelete</a>[0]));
00299                     <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r3">m_cuaDelete</a>.<a class="code" href="../../d3/d7/classCUintArray.html#a5">Remove</a>(0);
00300                 }
00301 
00302                 <span class="comment">//  Add any associations we're adding</span>
00303 
00304                 <span class="keywordflow">while</span>   (<a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r2">m_cuaAdd</a>.<a class="code" href="../../d3/d7/classCUintArray.html#a2">Count</a>()) {
00305                     <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r1">m_pcpTarget</a>-&gt;<a class="code" href="../../d7/d5/classCProfile.html#a16">Associate</a>(<a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r1">m_pcpTarget</a>-&gt;<a class="code" href="../../d7/d5/classCProfile.html#a10">DeviceName</a>(<a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r2">m_cuaAdd</a>[0]));
00306                     <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r2">m_cuaAdd</a>.<a class="code" href="../../d3/d7/classCUintArray.html#a5">Remove</a>(0);
00307                 }
00308 
00309                 <span class="comment">//  Re-create CProfile object.</span>
00310                 <span class="comment">//</span>
00311                 <span class="comment">//  !!! Need to be done some performance work here.</span>
00312 
00313                 <span class="keyword">delete</span> <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r1">m_pcpTarget</a>;
00314                 <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r1">m_pcpTarget</a> = <span class="keyword">new</span> <a class="code" href="../../d7/d5/classCProfile.html">CProfile</a>(<a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r0">m_csProfile</a>);
00315 
00316                 <span class="keywordflow">if</span> (!<a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r1">m_pcpTarget</a>)
00317                 {
00318                     <span class="comment">// BUGBUG proper error should happen.</span>
00319 
00320                     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00321                 }
00322 
00323                 <span class="comment">//  Re-Build tentitive association list.</span>
00324 
00325                 <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#a2">ConstructAssociations</a>();
00326 
00327                 <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#a3">UpdateDeviceListBox</a>();
00328 
00329                 <span class="comment">//  check the install status to refect icon.</span>
00330 
00331                 HICON hIcon = LoadIcon(CGlobals::Instance(),
00332                                    MAKEINTRESOURCE(<a class="code" href="../../d9/d5/classCProfileAssociationPage.html#r1">m_pcpTarget</a>-&gt;<a class="code" href="../../d7/d5/classCProfile.html#a6">IsInstalled</a>() ? <a class="code" href="../../d2/d9/ntgdi_2icm_2icmui_2resource_8h.html#a44">DefaultIcon</a> : <a class="code" href="../../d2/d9/ntgdi_2icm_2icmui_2resource_8h.html#a45">UninstalledIcon</a>));
00333 
00334                 <span class="keywordflow">if</span> (hIcon) {
00335                     <a class="code" href="../../d5/d9/cltxt_8h.html#a18">SendDlgItemMessage</a>(m_hwnd, <a class="code" href="../../d2/d9/ntgdi_2icm_2icmui_2resource_8h.html#a77">StatusIcon</a>, STM_SETICON, (WPARAM) hIcon, 0);
00336                 }
00337             }
00338 
00339             <span class="keywordflow">break</span>;
00340         }
00341     }
00342 
00343     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00344 }
00345 
00346 <span class="comment">//  Context-sensitive help handler</span>
00347 
<a name="l00348"></a><a class="code" href="../../d9/d5/classCProfileAssociationPage.html#a8">00348</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#a8">CProfileAssociationPage::OnHelp</a>(LPHELPINFO pHelp) {
00349 
00350     <span class="keywordflow">if</span> (pHelp-&gt;iContextType == HELPINFO_WINDOW) {
00351         WinHelp((HWND) pHelp-&gt;hItemHandle, <a class="code" href="../../d3/d9/icmuihlp_8h.html#a0">WINDOWS_HELP_FILE</a>,
00352                 HELP_WM_HELP, (ULONG_PTR) (LPSTR) <a class="code" href="../../d6/d5/profassoc_8cpp.html#a0">ProfileAssociationUIHelpIds</a>);
00353     }
00354 
00355     <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00356 }
00357 
<a name="l00358"></a><a class="code" href="../../d9/d5/classCProfileAssociationPage.html#a9">00358</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    <a class="code" href="../../d9/d5/classCProfileAssociationPage.html#a9">CProfileAssociationPage::OnContextMenu</a>(HWND hwnd) {
00359 
00360     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> iCtrlID = <a class="code" href="../../d4/d9/nt6_2dlgmgr_8c.html#a11">GetDlgCtrlID</a>(hwnd);
00361 
00362     WinHelp(hwnd, <a class="code" href="../../d3/d9/icmuihlp_8h.html#a0">WINDOWS_HELP_FILE</a>,
00363             HELP_CONTEXTMENU, (ULONG_PTR) (LPSTR) <a class="code" href="../../d6/d5/profassoc_8cpp.html#a0">ProfileAssociationUIHelpIds</a>);
00364 
00365     <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00366 }
00367 
00368 <span class="comment">//  Context Help for AddDevice Dialog.</span>
00369 
<a name="l00370"></a><a class="code" href="../../d6/d5/profassoc_8cpp.html#a1">00370</a> CONST <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> <a class="code" href="../../d6/d5/profassoc_8cpp.html#a1">AddDeviceUIHelpIds</a>[] = {
00371     <a class="code" href="../../d2/d9/ntgdi_2icm_2icmui_2resource_8h.html#a55">AddDeviceButton</a>,       <a class="code" href="../../d3/d9/icmuihlp_8h.html#a29">IDH_ADDDEVICEUI_ADD</a>,
00372     <a class="code" href="../../d2/d9/ntgdi_2icm_2icmui_2resource_8h.html#a62">DeviceListControl</a>,     <a class="code" href="../../d3/d9/icmuihlp_8h.html#a31">IDH_ADDDEVICEUI_LIST</a>,
00373     <a class="code" href="../../d2/d9/ntgdi_2icm_2icmui_2resource_8h.html#a63">DeviceListControlText</a>, <a class="code" href="../../d3/d9/icmuihlp_8h.html#a31">IDH_ADDDEVICEUI_LIST</a>,
00374     0, 0
00375 };
00376 
00377 <span class="comment">//  CAddDeviceDialog class constructor</span>
00378 
<a name="l00379"></a><a class="code" href="../../d4/d1/classCAddDeviceDialog.html#a0">00379</a> <a class="code" href="../../d4/d1/classCAddDeviceDialog.html#a0">CAddDeviceDialog::CAddDeviceDialog</a>(<a class="code" href="../../d9/d5/classCProfileAssociationPage.html">CProfileAssociationPage</a> *pcpas,
00380                                    HWND hwndParent) :
00381     <a class="code" href="../../d3/d2/classCDialog.html">CDialog</a>(pcpas-&gt;Instance(), <a class="code" href="../../d2/d9/ntgdi_2icm_2icmui_2resource_8h.html#a49">AddDeviceDialog</a>, hwndParent) {
00382     <a class="code" href="../../d4/d1/classCAddDeviceDialog.html#r0">m_pcpasBoss</a> = pcpas;
00383     <a class="code" href="../../d4/d1/classCAddDeviceDialog.html#r3">m_bCanceled</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00384     <a class="code" href="../../d3/d2/classCDialog.html#a3">DoModal</a>();
00385 }
00386 
00387 <span class="comment">//  Dialog Initialization routine</span>
00388 
<a name="l00389"></a><a class="code" href="../../d4/d1/classCAddDeviceDialog.html#a1">00389</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    <a class="code" href="../../d4/d1/classCAddDeviceDialog.html#a1">CAddDeviceDialog::OnInit</a>() {
00390 
00391     <a class="code" href="../../d7/d5/classCProfile.html">CProfile</a> * pcpThis = <a class="code" href="../../d4/d1/classCAddDeviceDialog.html#r0">m_pcpasBoss</a>-&gt;<a class="code" href="../../d9/d5/classCProfileAssociationPage.html#a11">Profile</a>();
00392 
00393     <a class="code" href="../../d4/d1/classCAddDeviceDialog.html#r1">m_hwndList</a>   = <a class="code" href="../../d3/d9/client_2wow_8c.html#a6">GetDlgItem</a>(m_hwnd, <a class="code" href="../../d2/d9/ntgdi_2icm_2icmui_2resource_8h.html#a62">DeviceListControl</a>);
00394     <a class="code" href="../../d4/d1/classCAddDeviceDialog.html#r2">m_hwndButton</a> = <a class="code" href="../../d3/d9/client_2wow_8c.html#a6">GetDlgItem</a>(m_hwnd, <a class="code" href="../../d2/d9/ntgdi_2icm_2icmui_2resource_8h.html#a55">AddDeviceButton</a>);
00395 
00396     <span class="comment">//  This must not list associated (tentatively) devices, per the spec</span>
00397 
00398     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> uDevice = 0; uDevice &lt; pcpThis-&gt;<a class="code" href="../../d7/d5/classCProfile.html#a8">DeviceCount</a>(); uDevice++) {
00399         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> u = 0; u &lt; <a class="code" href="../../d4/d1/classCAddDeviceDialog.html#r0">m_pcpasBoss</a>-&gt;<a class="code" href="../../d9/d5/classCProfileAssociationPage.html#a15">AssociationCount</a>(); u++)
00400             <span class="keywordflow">if</span>  (uDevice == <a class="code" href="../../d4/d1/classCAddDeviceDialog.html#r0">m_pcpasBoss</a>-&gt;<a class="code" href="../../d9/d5/classCProfileAssociationPage.html#a14">Association</a>(u))
00401                 <span class="keywordflow">break</span>;
00402         <span class="keywordflow">if</span>  (u &lt; <a class="code" href="../../d4/d1/classCAddDeviceDialog.html#r0">m_pcpasBoss</a>-&gt;<a class="code" href="../../d9/d5/classCProfileAssociationPage.html#a15">AssociationCount</a>())
00403             <span class="keywordflow">continue</span>;   <span class="comment">//  Don't insert this one...</span>
00404 
00405         LRESULT idItem = <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(<a class="code" href="../../d4/d1/classCAddDeviceDialog.html#r1">m_hwndList</a>, LB_ADDSTRING, (WPARAM)0,
00406             (LPARAM) pcpThis-&gt;<a class="code" href="../../d7/d5/classCProfile.html#a11">DisplayName</a>(uDevice));
00407         <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(<a class="code" href="../../d4/d1/classCAddDeviceDialog.html#r1">m_hwndList</a>, LB_SETITEMDATA, idItem, (LPARAM) uDevice);
00408     }
00409 
00410     <span class="keywordflow">if</span>  (<a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(<a class="code" href="../../d4/d1/classCAddDeviceDialog.html#r1">m_hwndList</a>, LB_GETCOUNT, 0, 0))
00411         <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(<a class="code" href="../../d4/d1/classCAddDeviceDialog.html#r1">m_hwndList</a>, LB_SETCURSEL, 0, 0);
00412 
00413     <a class="code" href="../../d3/d8/client_8c.html#a98">EnableWindow</a>(<a class="code" href="../../d4/d1/classCAddDeviceDialog.html#r2">m_hwndButton</a>, -1 !=
00414         <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(<a class="code" href="../../d4/d1/classCAddDeviceDialog.html#r1">m_hwndList</a>, LB_GETCURSEL, 0, 0));
00415 
00416     <span class="keywordflow">return</span>  <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00417 }
00418 
00419 <span class="comment">//  Dialog notification handler</span>
00420 
<a name="l00421"></a><a class="code" href="../../d4/d1/classCAddDeviceDialog.html#a2">00421</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    <a class="code" href="../../d4/d1/classCAddDeviceDialog.html#a2">CAddDeviceDialog::OnCommand</a>(WORD wNotification, WORD wid,
00422                                     HWND hwndControl){
00423 
00424     <span class="keywordflow">switch</span>  (wNotification) {
00425 
00426         <span class="keywordflow">case</span>    LBN_SELCHANGE:
00427             <a class="code" href="../../d3/d8/client_8c.html#a98">EnableWindow</a>(<a class="code" href="../../d4/d1/classCAddDeviceDialog.html#r2">m_hwndButton</a>, -1 !=
00428                 <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(<a class="code" href="../../d4/d1/classCAddDeviceDialog.html#r1">m_hwndList</a>, LB_GETCURSEL, 0, 0));
00429             <span class="keywordflow">return</span>  <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00430 
00431         <span class="keywordflow">case</span>    BN_CLICKED:
00432             <span class="keywordflow">if</span>  (wid == <a class="code" href="../../d2/d9/ntgdi_2icm_2icmui_2resource_8h.html#a55">AddDeviceButton</a>) {
00433 
00434                 LRESULT i = <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(<a class="code" href="../../d4/d1/classCAddDeviceDialog.html#r1">m_hwndList</a>, LB_GETCURSEL, 0, 0);
00435 
00436                 <span class="keywordflow">if</span>  (i == -1)
00437                     <span class="keywordflow">return</span>  <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00438 
00439                 <span class="keywordtype">unsigned</span> uItem = (<span class="keywordtype">unsigned</span>) <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(<a class="code" href="../../d4/d1/classCAddDeviceDialog.html#r1">m_hwndList</a>,
00440                     LB_GETITEMDATA, i, 0);
00441 
00442                 <a class="code" href="../../d4/d1/classCAddDeviceDialog.html#r0">m_pcpasBoss</a>-&gt;<a class="code" href="../../d9/d5/classCProfileAssociationPage.html#a12">Associate</a>(uItem);
00443 
00444                 <span class="comment">// Selection has been made.</span>
00445 
00446                 <a class="code" href="../../d4/d1/classCAddDeviceDialog.html#r3">m_bCanceled</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00447             }
00448             <span class="keywordflow">break</span>;
00449 
00450         <span class="keywordflow">case</span>    LBN_DBLCLK:
00451             <span class="keywordflow">return</span>  <a class="code" href="../../d4/d1/classCAddDeviceDialog.html#a2">OnCommand</a>(BN_CLICKED, <a class="code" href="../../d2/d9/ntgdi_2icm_2icmui_2resource_8h.html#a55">AddDeviceButton</a>, <a class="code" href="../../d4/d1/classCAddDeviceDialog.html#r2">m_hwndButton</a>);
00452     }
00453 
00454     <span class="keywordflow">return</span>  CDialog::OnCommand(wNotification, wid, hwndControl);
00455 }
00456 
00457 <span class="comment">//  Context-sensitive help handler</span>
00458 
<a name="l00459"></a><a class="code" href="../../d4/d1/classCAddDeviceDialog.html#a3">00459</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    <a class="code" href="../../d4/d1/classCAddDeviceDialog.html#a3">CAddDeviceDialog::OnHelp</a>(LPHELPINFO pHelp) {
00460 
00461     <span class="keywordflow">if</span> (pHelp-&gt;iContextType == HELPINFO_WINDOW) {
00462         WinHelp((HWND) pHelp-&gt;hItemHandle, <a class="code" href="../../d3/d9/icmuihlp_8h.html#a0">WINDOWS_HELP_FILE</a>,
00463                 HELP_WM_HELP, (ULONG_PTR) (LPSTR) <a class="code" href="../../d6/d5/profassoc_8cpp.html#a1">AddDeviceUIHelpIds</a>);
00464     }
00465 
00466     <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00467 }
00468 
<a name="l00469"></a><a class="code" href="../../d4/d1/classCAddDeviceDialog.html#a4">00469</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    <a class="code" href="../../d4/d1/classCAddDeviceDialog.html#a4">CAddDeviceDialog::OnContextMenu</a>(HWND hwnd) {
00470 
00471     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> iCtrlID = <a class="code" href="../../d4/d9/nt6_2dlgmgr_8c.html#a11">GetDlgCtrlID</a>(hwnd);
00472 
00473     WinHelp(hwnd, <a class="code" href="../../d3/d9/icmuihlp_8h.html#a0">WINDOWS_HELP_FILE</a>,
00474             HELP_CONTEXTMENU, (ULONG_PTR) (LPSTR) <a class="code" href="../../d6/d5/profassoc_8cpp.html#a1">AddDeviceUIHelpIds</a>);
00475 
00476     <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00477 }
00478 
00479 
</div></pre><hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:41:27 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
