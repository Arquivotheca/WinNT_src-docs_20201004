<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: imminit.c File Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>imminit.c File Reference</h1><code>#include "<a class="el" href="../../d9/d2/w32_2ntuser_2imm_2precomp_8h-source.html">precomp.h</a>"</code><br>

<p>
<a href="../../d8/d9/imminit_8c-source.html">Go to the source code of this file.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d0/imminit_8c.html#a1">ImmInitializeGlobals</a> (HINSTANCE hmod)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d0/imminit_8c.html#a2">ImmRegisterClient</a> (IN <a class="el" href="../../d4/d6/structtagSHAREDINFO.html">PSHAREDINFO</a> psiClient, HINSTANCE hmod)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d0/imminit_8c.html#a3">ImmDllInitialize</a> (IN PVOID hmod, IN <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> Reason, IN PCONTEXT pctx OPTIONAL)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>PVOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d0/imminit_8c.html#a4">UserRtlAllocMem</a> (ULONG uBytes)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d0/imminit_8c.html#a5">UserRtlFreeMem</a> (PVOID pMem)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d0/imminit_8c.html#a6">UserRtlRaiseStatus</a> (NTSTATUS <a class="el" href="../../d2/d1/cttoken_8c.html#a18">Status</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d0/imminit_8c.html#a7">GetRipComponent</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d0/imminit_8c.html#a8">GetDbgTagFlags</a> (int tag)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d0/imminit_8c.html#a9">GetRipPID</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d0/imminit_8c.html#a10">GetRipFlags</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d0/imminit_8c.html#a11">NtUserSetRipFlags</a> (<a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d0/imminit_8c.html#a12">SetRipFlags</a> (<a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> dwRipFlags, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> dwRipPID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d0/imminit_8c.html#a13">SetDbgTag</a> (int tag, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> dwBitFlags)</td></tr>

<tr><td colspan=2><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG_PTR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d0/imminit_8c.html#a0">gHighestUserAddress</a></td></tr>

</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a8" doxytag="imminit.c::GetDbgTagFlags" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> GetDbgTagFlags           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>tag</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d9/imminit_8c-source.html#l00138">138</a> of file <a class="el" href="../../d8/d9/imminit_8c-source.html">imminit.c</a>.
<p>
References <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d2/d7/clglobal_8c-source.html#l00051">gpsi</a>, and <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>.
<p>
<pre class="fragment"><div>00139 {
00140 <span class="preprocessor">#if DEBUGTAGS</span>
00141 <span class="preprocessor"></span>    <span class="keywordflow">return</span> (<a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a> != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> ? <a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;adwDBGTAGFlags[tag] : 0);
00142 <span class="preprocessor">#else</span>
00143 <span class="preprocessor"></span>    <span class="keywordflow">return</span> 0;
00144     UNREFERENCED_PARAMETER(tag);
00145 <span class="preprocessor">#endif // DEBUGTAGS</span>
00146 <span class="preprocessor"></span>}
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a7" doxytag="imminit.c::GetRipComponent" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> GetRipComponent           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d9/imminit_8c-source.html#l00136">136</a> of file <a class="el" href="../../d8/d9/imminit_8c-source.html">imminit.c</a>.
<p>
References <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>.
<p>
<pre class="fragment"><div>00136 { <span class="keywordflow">return</span> RIP_IMM; }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a10" doxytag="imminit.c::GetRipFlags" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> GetRipFlags           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d9/imminit_8c-source.html#l00149">149</a> of file <a class="el" href="../../d8/d9/imminit_8c-source.html">imminit.c</a>.
<p>
References <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d2/d7/clglobal_8c-source.html#l00051">gpsi</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01166">RIPF_DEFAULT</a>, and <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l01265">tagSERVERINFO::wRIPFlags</a>.
<p>
<pre class="fragment"><div>00149 { <span class="keywordflow">return</span> (<a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a> != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> ? <a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;<a class="code" href="../../d2/d6/structtagSERVERINFO.html#o0">wRIPFlags</a> : <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a393">RIPF_DEFAULT</a>); }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a9" doxytag="imminit.c::GetRipPID" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> GetRipPID           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d9/imminit_8c-source.html#l00148">148</a> of file <a class="el" href="../../d8/d9/imminit_8c-source.html">imminit.c</a>.
<p>
References <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d2/d7/clglobal_8c-source.html#l00051">gpsi</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, and <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l01267">tagSERVERINFO::wRIPPID</a>.
<p>
<pre class="fragment"><div>00148 { <span class="keywordflow">return</span> (<a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a> != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> ? <a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;<a class="code" href="../../d2/d6/structtagSERVERINFO.html#o2">wRIPPID</a> : 0); }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="imminit.c::ImmDllInitialize" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL ImmDllInitialize           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>hmod</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Reason</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PCONTEXT pctx&nbsp;</td>
          <td class="mdname" nowrap> <em>OPTIONAL</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d9/imminit_8c-source.html#l00067">67</a> of file <a class="el" href="../../d8/d9/imminit_8c-source.html">imminit.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d6/d7/ntimm_8c-source.html#l00122">DestroyInputContext()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d3/d5/ntuser_2imm_2globals_8c-source.html#l00034">gcsImeDpi</a>, <a class="el" href="../../d4/d7/client_8c-source.html#l04502">GetKeyboardLayout()</a>, <a class="el" href="../../d3/d5/ntuser_2imm_2globals_8c-source.html#l00026">gfInitialized</a>, <a class="el" href="../../d3/d5/ntuser_2imm_2globals_8c-source.html#l00027">ghInst</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00594">IMM_MAGIC_CALLER_ID</a>, <a class="el" href="../../d8/d9/imminit_8c-source.html#l00019">ImmInitializeGlobals()</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00591">IS_IME_ENABLED</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l07799">NtUserGetThreadState()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d8/d7/dll_2resource_8c-source.html#l01474">RtlDeleteCriticalSection()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, and <a class="el" href="../../d3/d0/fareast_8c-source.html#l00344">User32InitializeImmEntryTable()</a>.
<p>
<pre class="fragment"><div>00071 {
00072     UNREFERENCED_PARAMETER(pctx);
00073 
00074     <span class="keywordflow">switch</span> ( Reason ) {
00075 
00076     <span class="keywordflow">case</span> DLL_PROCESS_ATTACH:
00077         UserAssert(!gfInitialized || hmod == ghInst);
00078 
00079         <span class="keywordflow">if</span> (!<a class="code" href="../../d7/d0/imminit_8c.html#a1">ImmInitializeGlobals</a>(hmod))
00080             <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00081 
00082         UserAssert(hmod != NULL);
00083 
00084         <span class="comment">// Initialize USER32.DLL in case if USER32 has not bound itself to IMM32</span>
00085         <span class="keywordflow">if</span> (!<a class="code" href="../../d1/d0/inc_2user_8h.html#a1135">User32InitializeImmEntryTable</a>(IMM_MAGIC_CALLER_ID))
00086             <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00087         <span class="keywordflow">break</span>;
00088 
00089     <span class="keywordflow">case</span> DLL_PROCESS_DETACH:
00090         <span class="keywordflow">if</span> (<a class="code" href="../../d2/d6/ntuser_2imm_2globals_8c.html#a1">gfInitialized</a>) {
00091             <a class="code" href="../../d7/d8/dll_2resource_8c.html#a29">RtlDeleteCriticalSection</a>(&amp;gcsImeDpi);
00092         }
00093         <span class="keywordflow">break</span>;
00094 
00095     <span class="keywordflow">case</span> DLL_THREAD_DETACH:
00096         <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a126">IS_IME_ENABLED</a>()) {
00097             <a class="code" href="../../d4/d1/userk_8h.html#a2031">DestroyInputContext</a>(
00098                 (HIMC)<a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a287">NtUserGetThreadState</a>(UserThreadStateDefaultInputContext),
00099                 <a class="code" href="../../d3/d8/client_8c.html#a154">GetKeyboardLayout</a>(0),
00100                 TRUE);
00101         }
00102         <span class="keywordflow">break</span>;
00103 
00104     <span class="keywordflow">default</span>:
00105         <span class="keywordflow">break</span>;
00106     }
00107 
00108     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00109 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="imminit.c::ImmInitializeGlobals" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL ImmInitializeGlobals           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HINSTANCE&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>hmod</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d9/imminit_8c-source.html#l00019">19</a> of file <a class="el" href="../../d8/d9/imminit_8c-source.html">imminit.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d3/d5/ntuser_2imm_2globals_8c-source.html#l00034">gcsImeDpi</a>, <a class="el" href="../../d3/d5/ntuser_2imm_2globals_8c-source.html#l00026">gfInitialized</a>, <a class="el" href="../../d2/d7/clglobal_8c-source.html#l00054">gHighestUserAddress</a>, <a class="el" href="../../d3/d5/ntuser_2imm_2globals_8c-source.html#l00027">ghInst</a>, <a class="el" href="../../d6/d5/stierr_8h-source.html#l00030">NT_SUCCESS</a>, <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l00941">NtQuerySystemInformation()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d8/d7/dll_2resource_8c-source.html#l01210">RtlInitializeCriticalSection()</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d8/d9/imminit_8c-source.html#l00067">ImmDllInitialize()</a>, and <a class="el" href="../../d8/d9/imminit_8c-source.html#l00051">ImmRegisterClient()</a>.
<p>
<pre class="fragment"><div>00020 {
00021     SYSTEM_BASIC_INFORMATION SystemInformation;
00022 
00023     <span class="keywordflow">if</span> (hmod) {
00024         <span class="comment">/*</span>
00025 <span class="comment">         * Remember IMM32.DLL's hmodule so we can grab resources from it later.</span>
00026 <span class="comment">         */</span>
00027         <a class="code" href="../../d2/d6/ntuser_2imm_2globals_8c.html#a2">ghInst</a> = hmod;
00028     }
00029     <span class="keywordflow">if</span> (<a class="code" href="../../d2/d6/ntuser_2imm_2globals_8c.html#a1">gfInitialized</a>) {
00030         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00031     }
00032     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(<a class="code" href="../../d7/d8/dll_2resource_8c.html#a24">RtlInitializeCriticalSection</a>(&amp;gcsImeDpi))) {
00033         RIPMSG0(RIP_WARNING, <span class="stringliteral">"ImmInitializeGlobals: failed to initialize critical section at startup. Just bail."</span>);
00034         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00035     }
00036     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(<a class="code" href="../../d6/d8/sysinfo_8c.html#a49">NtQuerySystemInformation</a>(SystemBasicInformation,
00037             &amp;SystemInformation,
00038             <span class="keyword">sizeof</span>(SystemInformation),
00039             NULL))) {
00040         RIPMSG0(RIP_WARNING, <span class="stringliteral">"ImmInitializeGlobals: failed to query system information. Just bail."</span>);
00041         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00042     }
00043     <a class="code" href="../../d1/d8/clglobal_8c.html#a7">gHighestUserAddress</a> = SystemInformation.MaximumUserModeAddress;
00044 
00045     <a class="code" href="../../d2/d6/ntuser_2imm_2globals_8c.html#a1">gfInitialized</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00046 
00047     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00048 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a2" doxytag="imminit.c::ImmRegisterClient" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL ImmRegisterClient           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d4/d6/structtagSHAREDINFO.html">PSHAREDINFO</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>psiClient</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HINSTANCE&nbsp;</td>
          <td class="mdname" nowrap> <em>hmod</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d9/imminit_8c-source.html#l00051">51</a> of file <a class="el" href="../../d8/d9/imminit_8c-source.html">imminit.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d2/d7/clglobal_8c-source.html#l00051">gpsi</a>, <a class="el" href="../../d2/d7/clglobal_8c-source.html#l00052">gSharedInfo</a>, <a class="el" href="../../d8/d9/imminit_8c-source.html#l00019">ImmInitializeGlobals()</a>, and <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01277">tagSHAREDINFO::psi</a>.
<p>
Referenced by <a class="el" href="../../d3/d0/fareast_8c-source.html#l00238">_InitializeImmEntryTable()</a>.
<p>
<pre class="fragment"><div>00053 {
00054     <a class="code" href="../../d1/d8/clglobal_8c.html#a5">gSharedInfo</a> = *psiClient;
00055     <a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a> = <a class="code" href="../../d1/d8/clglobal_8c.html#a5">gSharedInfo</a>.<a class="code" href="../../d4/d6/structtagSHAREDINFO.html#o0">psi</a>;
00056     <span class="comment">/* Raid #97316</span>
00057 <span class="comment">     * Dlls loaded earlier than imm32.dll could make</span>
00058 <span class="comment">     * user32 call which calls back imm routines.</span>
00059 <span class="comment">     * ImmRegisterClient() is called from User32's init routine,</span>
00060 <span class="comment">     * so we can expect to reach here early enough.</span>
00061 <span class="comment">     * We need to initialize globals as much as possible</span>
00062 <span class="comment">     * here.</span>
00063 <span class="comment">     */</span>
00064     <span class="keywordflow">return</span> <a class="code" href="../../d7/d0/imminit_8c.html#a1">ImmInitializeGlobals</a>(hmod);
00065 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a11" doxytag="imminit.c::NtUserSetRipFlags" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID NtUserSetRipFlags           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l04490">4490</a> of file <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html">kernel/ntstubs.c</a>.
<p>
<pre class="fragment"><div>04491 {
04492     <a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a12">BEGINRECV_VOID</a>();
04493 
04494     <a class="code" href="../../d4/d1/userk_8h.html#a1015">_SetRipFlags</a>(dwRipFlags, dwPID);
04495 
04496     <a class="code" href="../../d4/d1/userk_8h.html#a94">TRACEVOID</a>(<span class="stringliteral">"NtUserSetRipFlags"</span>);
04497     <a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a13">ENDRECV_VOID</a>();
04498 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a13" doxytag="imminit.c::SetDbgTag" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID SetDbgTag           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>tag</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>dwBitFlags</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d9/imminit_8c-source.html#l00158">158</a> of file <a class="el" href="../../d8/d9/imminit_8c-source.html">imminit.c</a>.
<p>
References <a class="el" href="../../d2/d7/hal_8h.html#a212">VOID()</a>.
<p>
<pre class="fragment"><div>00159 {
00160     RIPMSG0(RIP_ERROR, <span class="stringliteral">"SetDbgTag not available in imm32.dll"</span>);
00161     <span class="keywordflow">return</span>;
00162     UNREFERENCED_PARAMETER(tag);
00163     UNREFERENCED_PARAMETER(dwBitFlags);
00164 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a12" doxytag="imminit.c::SetRipFlags" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID SetRipFlags           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>dwRipFlags</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>dwRipPID</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d9/imminit_8c-source.html#l00153">153</a> of file <a class="el" href="../../d8/d9/imminit_8c-source.html">imminit.c</a>.
<p>
References <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l04490">NtUserSetRipFlags()</a>, and <a class="el" href="../../d2/d7/hal_8h.html#a212">VOID()</a>.
<p>
<pre class="fragment"><div>00154 {
00155     <a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a171">NtUserSetRipFlags</a>(dwRipFlags, dwRipPID);
00156 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a4" doxytag="imminit.c::UserRtlAllocMem" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PVOID UserRtlAllocMem           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">ULONG&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>uBytes</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d9/imminit_8c-source.html#l00118">118</a> of file <a class="el" href="../../d8/d9/imminit_8c-source.html">imminit.c</a>.
<p>
<pre class="fragment"><div>00120 {
00121     <span class="keywordflow">return</span> LocalAlloc(LPTR, uBytes);
00122 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a5" doxytag="imminit.c::UserRtlFreeMem" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID UserRtlFreeMem           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">PVOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>pMem</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d9/imminit_8c-source.html#l00124">124</a> of file <a class="el" href="../../d8/d9/imminit_8c-source.html">imminit.c</a>.
<p>
References <a class="el" href="../../d2/d7/hal_8h.html#a212">VOID()</a>.
<p>
<pre class="fragment"><div>00126 {
00127     LocalFree(pMem);
00128 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a6" doxytag="imminit.c::UserRtlRaiseStatus" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID UserRtlRaiseStatus           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">NTSTATUS&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Status</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d9/imminit_8c-source.html#l00130">130</a> of file <a class="el" href="../../d8/d9/imminit_8c-source.html">imminit.c</a>.
<p>
References <a class="el" href="../../d0/d9/ppc_2exdsptch_8c-source.html#l00563">RtlRaiseStatus()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00135">Status</a>, and <a class="el" href="../../d2/d7/hal_8h.html#a212">VOID()</a>.
<p>
<pre class="fragment"><div>00132 {
00133     <a class="code" href="../../d9/d9/ppc_2exdsptch_8c.html#a10">RtlRaiseStatus</a>(Status);
00134 }
</div></pre>    </td>
  </tr>
</table>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="a0" doxytag="imminit.c::gHighestUserAddress" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG_PTR <a class="el" href="../../d7/d0/imminit_8c.html#a0">gHighestUserAddress</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d9/imminit_8c-source.html#l00016">16</a> of file <a class="el" href="../../d8/d9/imminit_8c-source.html">imminit.c</a>.    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:44:10 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
