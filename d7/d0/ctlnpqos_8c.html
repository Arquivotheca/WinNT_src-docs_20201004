<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: ctlnpqos.c File Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>ctlnpqos.c File Reference</h1>
<p>
<a href="../../d8/d9/ctlnpqos_8c-source.html">Go to the source code of this file.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d0/ctlnpqos_8c.html#a0">DevPrint</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d0/ctlnpqos_8c.html#a1">Error</a>(N, S)&nbsp;&nbsp;&nbsp;{ DbgPrint(#N); DbgPrint(" Error %08lx\<a class="el" href="../../d7/d0/exts_8h.html#a0">n</a>", S); }</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d0/ctlnpqos_8c.html#a2">Delay</a>(SECONDS)</td></tr>

<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d0/ctlnpqos_8c.html#a20">SepClientTestStatic</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d0/ctlnpqos_8c.html#a21">SepClientTestDynamic</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d0/ctlnpqos_8c.html#a22">SepClientTestEffectiveOnly</a> (BOOLEAN StaticTest)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d0/ctlnpqos_8c.html#a23">SepClientTestNotEffectiveOnly</a> (BOOLEAN StaticTest)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d0/ctlnpqos_8c.html#a24">SepClientTestAnonymous</a> (BOOLEAN StaticTest, BOOLEAN EffectiveOnly)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d0/ctlnpqos_8c.html#a25">SepClientTestIdentification</a> (BOOLEAN StaticTest, BOOLEAN EffectiveOnly)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d0/ctlnpqos_8c.html#a26">SepClientTestImpersonation</a> (BOOLEAN StaticTest, BOOLEAN EffectiveOnly)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d0/ctlnpqos_8c.html#a27">SepClientConnect</a> (SECURITY_IMPERSONATION_LEVEL ImpersonationLevel, SECURITY_CONTEXT_TRACKING_MODE TrackingMode, BOOLEAN EffectiveOnly)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d0/ctlnpqos_8c.html#a28">SepClientMakeRemoteCall</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d0/ctlnpqos_8c.html#a29">SepClientDropConnection</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d0/ctlnpqos_8c.html#a30">SepClientTest</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d0/ctlnpqos_8c.html#a31">SepClientInitialize</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d0/ctlnpqos_8c.html#a32">SepServerTestStatic</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d0/ctlnpqos_8c.html#a33">SepServerTestDynamic</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d0/ctlnpqos_8c.html#a34">SepServerTestEffectiveOnly</a> (BOOLEAN StaticTest)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d0/ctlnpqos_8c.html#a35">SepServerTestNotEffectiveOnly</a> (BOOLEAN StaticTest)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d0/ctlnpqos_8c.html#a36">SepServerTestAnonymous</a> (BOOLEAN StaticTest, BOOLEAN EffectiveOnly)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d0/ctlnpqos_8c.html#a37">SepServerTestIdentification</a> (BOOLEAN StaticTest, BOOLEAN EffectiveOnly)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d0/ctlnpqos_8c.html#a38">SepServerTestImpersonation</a> (BOOLEAN StaticTest, BOOLEAN EffectiveOnly)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d0/ctlnpqos_8c.html#a39">SepServerWaitForNextConnect</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d0/ctlnpqos_8c.html#a40">SepServerGetNextMessage</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d0/ctlnpqos_8c.html#a41">SepServerCompleteMessage</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d0/ctlnpqos_8c.html#a42">SepServerDropConnection</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d0/ctlnpqos_8c.html#a43">SepServerTest</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d0/ctlnpqos_8c.html#a44">SepServerInitialize</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d0/ctlnpqos_8c.html#a45">SepServerSpawnClientProcess</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d0/ctlnpqos_8c.html#a46">SepWritePipe</a> (PSZ <a class="el" href="../../d0/d0/tdetach_8c.html#a0">String</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d0/ctlnpqos_8c.html#a47">SepReadPipe</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d0/ctlnpqos_8c.html#a48">SepTransceivePipe</a> (PSZ <a class="el" href="../../d0/d0/tdetach_8c.html#a0">String</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HANDLE&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d0/ctlnpqos_8c.html#a49">SepServerCreatePipe</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d0/ctlnpqos_8c.html#a50">SepServerListenPipe</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d0/ctlnpqos_8c.html#a51">SepServerImpersonatePipe</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d0/ctlnpqos_8c.html#a52">SepServerDisconnectPipe</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HANDLE&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d0/ctlnpqos_8c.html#a53">SepClientOpenPipe</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d0/ctlnpqos_8c.html#a54">CtLnpQos</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d0/ctlnpqos_8c.html#a55">SepServerImpersonateClient</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d0/ctlnpqos_8c.html#a56">SepServerRevertToSelf</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d0/ctlnpqos_8c.html#a57">SepReadPipe</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d0/ctlnpqos_8c.html#a58">SepServerListenPipe</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d0/ctlnpqos_8c.html#a59">SepServerImpersonatePipe</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d0/ctlnpqos_8c.html#a60">SepServerDisconnectPipe</a> ()</td></tr>

<tr><td colspan=2><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d0/ctlnpqos_8c.html#a3">Status</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>OBJECT_ATTRIBUTES&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d0/ctlnpqos_8c.html#a4">ObjectAttributes</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>STRING&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d0/ctlnpqos_8c.html#a5">EventName</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>UNICODE_STRING&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d0/ctlnpqos_8c.html#a6">UnicodeEventName</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HANDLE&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d0/ctlnpqos_8c.html#a7">EventHandle</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>STRING&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d0/ctlnpqos_8c.html#a8">PortName</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>UNICODE_STRING&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d0/ctlnpqos_8c.html#a9">UnicodePortName</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>STRING&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d0/ctlnpqos_8c.html#a10">RelativePortName</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>UNICODE_STRING&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d0/ctlnpqos_8c.html#a11">UnicodeRelativePortName</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HANDLE&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d0/ctlnpqos_8c.html#a12">EarPort</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HANDLE&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d0/ctlnpqos_8c.html#a13">TalkPort</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>SECURITY_QUALITY_OF_SERVICE&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d0/ctlnpqos_8c.html#a14">SecurityQos</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d0/ctlnpqos_8c.html#a15">RequestCount</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HANDLE&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d0/ctlnpqos_8c.html#a16">ClientToken</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>TOKEN_STATISTICS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d0/ctlnpqos_8c.html#a17">ClientTokenStatistics</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d0/ctlnpqos_8c.html#a18">IgnoreLength</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HANDLE&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d0/ctlnpqos_8c.html#a19">SepServerThread</a></td></tr>

</table>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="a2" doxytag="ctlnpqos.c::Delay" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define Delay          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">SECONDS&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div>{                                               \
    LARGE_INTEGER <a class="code" href="../../d6/d6/ttime_8c.html#a14">Time</a>;                                                \
    <a class="code" href="../../d6/d6/ttime_8c.html#a14">Time</a>.QuadPart = -10 * 1000 * 1000, ((LONGLONG)SECONDS);            \
    <a class="code" href="../../d7/d6/delay_8c.html#a0">NtDelayExecution</a>(TRUE,(PLARGE_INTEGER)&amp;Time);                               \
}
</div></pre>
<p>
Definition at line <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00013">13</a> of file <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html">ctlnpqos.c</a>.
<p>
Referenced by <a class="el" href="../../d0/d4/vdmints_8c-source.html#l01235">VdmpDelayInterrupt()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a0" doxytag="ctlnpqos.c::DevPrint" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define DevPrint          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00008">8</a> of file <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html">ctlnpqos.c</a>.
<p>
Referenced by <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00218">SepClientConnect()</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00238">SepClientMakeRemoteCall()</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l01258">SepReadPipe()</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00626">SepServerCompleteMessage()</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l01520">SepServerDisconnectPipe()</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00665">SepServerDropConnection()</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00611">SepServerGetNextMessage()</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00636">SepServerImpersonateClient()</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l01482">SepServerImpersonatePipe()</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l01443">SepServerListenPipe()</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00588">SepServerWaitForNextConnect()</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l01330">SepTransceivePipe()</a>, and <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l01293">SepWritePipe()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="ctlnpqos.c::Error" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define Error          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">N,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>S&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;{ DbgPrint(#N); DbgPrint(" Error %08lx\<a class="el" href="../../d7/d0/exts_8h.html#a0">n</a>", S); }</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00011">11</a> of file <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html">ctlnpqos.c</a>.
<p>
Referenced by <a class="el" href="../../d0/d6/almisc_8c-source.html#l00974">AlStatusMsg()</a>, <a class="el" href="../../d0/d6/almisc_8c-source.html#l00993">AlStatusMsgNoWait()</a>, <a class="el" href="../../d7/d1/cachesub_8c-source.html#l06458">CcLogError()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00607">ConnectConv()</a>, <a class="el" href="../../d0/d6/desktop_8c-source.html#l02696">CreateDesktopHeap()</a>, <a class="el" href="../../d2/d3/spb_8c-source.html#l00651">RestoreSpb()</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l01582">SepClientOpenPipe()</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l01258">SepReadPipe()</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l01377">SepServerCreatePipe()</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l01520">SepServerDisconnectPipe()</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l01482">SepServerImpersonatePipe()</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l01443">SepServerListenPipe()</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l01330">SepTransceivePipe()</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l01293">SepWritePipe()</a>, <a class="el" href="../../d2/d3/spb_8c-source.html#l00214">SpbCheckRect2()</a>, <a class="el" href="../../d8/d2/validate_8c-source.html#l00092">ValidateHdesk()</a>, <a class="el" href="../../d0/d6/almisc_8c-source.html#l00947">vAlStatusMsg()</a>, <a class="el" href="../../d5/d3/command_8c-source.html#l00035">Win32CommandChannelThread()</a>, <a class="el" href="../../d0/d6/desktop_8c-source.html#l01797">xxxCreateDesktop()</a>, <a class="el" href="../../d0/d6/desktop_8c-source.html#l01343">xxxCreateDesktop2()</a>, and <a class="el" href="../../d0/d6/desktop_8c-source.html#l03265">xxxOpenDesktop()</a>.    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a54" doxytag="ctlnpqos.c::CtLnpQos" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN CtLnpQos           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l01165">1165</a> of file <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html">ctlnpqos.c</a>.
<p>
References <a class="el" href="../../d7/d5/memprint_8h-source.html#l00079">DbgPrint</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00030">EventHandle</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00028">EventName</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d6/d5/stierr_8h-source.html#l00030">NT_SUCCESS</a>, <a class="el" href="../../d1/d7/ex_2event_8c-source.html#l00180">NtCreateEvent()</a>, <a class="el" href="../../d9/d9/psdelete_8c-source.html#l00461">NtTerminateThread()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00027">ObjectAttributes</a>, <a class="el" href="../../d4/d8/ulpc_8h-source.html#l00032">PortName</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00033">RelativePortName</a>, <a class="el" href="../../d7/d5/nls_8c-source.html#l00082">RtlAnsiStringToUnicodeString()</a>, <a class="el" href="../../d7/d5/nls_8c-source.html#l01215">RtlFreeUnicodeString()</a>, <a class="el" href="../../d3/d6/string_8c-source.html#l00056">RtlInitString()</a>, <a class="el" href="../../d3/d5/tsecomm_8c-source.html#l00043">SEASSERT_SUCCESS</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00553">SepClientInitialize()</a>, <a class="el" href="../../d8/d0/ctlpcqos_8c.html#a25">SepClientTest()</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l01028">SepServerInitialize()</a>, <a class="el" href="../../d8/d0/ctlpcqos_8c.html#a38">SepServerTest()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00135">Status</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00029">UnicodeEventName</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00032">UnicodePortName</a>, and <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00034">UnicodeRelativePortName</a>.
<p>
Referenced by <a class="el" href="../../d4/d1/utlnpqos_8c-source.html#l00061">Test()</a>.
<p>
<pre class="fragment"><div>01166 {
01167 
01168     BOOLEAN Result = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01169 
01170     <a class="code" href="../../d2/d7/string_8c.html#a5">RtlInitString</a>( &amp;PortName, <span class="stringliteral">"\\Device\\NamedPipe\\TestLnpQosServerPort"</span> );
01171     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d6/d6/nls_8c.html#a21">RtlAnsiStringToUnicodeString</a>(
01172                  &amp;UnicodePortName,
01173                  &amp;PortName,
01174                  TRUE );  <a class="code" href="../../d2/d6/tsecomm_8c.html#a0">SEASSERT_SUCCESS</a>( <a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status) );
01175 
01176     <a class="code" href="../../d2/d7/string_8c.html#a5">RtlInitString</a>( &amp;RelativePortName, <span class="stringliteral">"TestLnpQosServerPort"</span> );
01177     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d6/d6/nls_8c.html#a21">RtlAnsiStringToUnicodeString</a>(
01178                  &amp;UnicodeRelativePortName,
01179                  &amp;RelativePortName,
01180                  TRUE );  <a class="code" href="../../d2/d6/tsecomm_8c.html#a0">SEASSERT_SUCCESS</a>( <a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status) );
01181 
01182 
01183     <span class="comment">//</span>
01184     <span class="comment">// Determine whether we are the client or server side of the test.</span>
01185     <span class="comment">// This is done by creating or opening a named event object.  If the</span>
01186     <span class="comment">// event does not yet exist, then we are the client, and must create</span>
01187     <span class="comment">// the server process.  Otherwise, we are the server and the client</span>
01188     <span class="comment">// is waiting for us to signal the event.</span>
01189     <span class="comment">//</span>
01190 
01191     <a class="code" href="../../d2/d7/string_8c.html#a5">RtlInitString</a>( &amp;EventName, <span class="stringliteral">"\\TestLnpQosEvent"</span> );
01192     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d6/d6/nls_8c.html#a21">RtlAnsiStringToUnicodeString</a>(
01193                  &amp;UnicodeEventName,
01194                  &amp;EventName,
01195                  TRUE );  <a class="code" href="../../d2/d6/tsecomm_8c.html#a0">SEASSERT_SUCCESS</a>( <a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status) );
01196 
01197     InitializeObjectAttributes(
01198         &amp;ObjectAttributes,
01199         &amp;UnicodeEventName,
01200         OBJ_OPENIF,
01201         NULL,
01202         NULL
01203         );
01204     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d0/d8/ex_2event_8c.html#a5">NtCreateEvent</a>(
01205                  &amp;EventHandle,
01206                  EVENT_ALL_ACCESS,
01207                  &amp;ObjectAttributes,
01208                  SynchronizationEvent,
01209                  FALSE
01210                  );
01211     <a class="code" href="../../d6/d6/nls_8c.html#a34">RtlFreeUnicodeString</a>( &amp;UnicodeEventName );
01212 
01213     <span class="keywordflow">if</span> (<a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> == STATUS_OBJECT_NAME_EXISTS) {
01214 
01215         <span class="comment">//</span>
01216         <span class="comment">// Server is already running, therefore, this process gets to be</span>
01217         <span class="comment">// the client.</span>
01218         <span class="comment">//</span>
01219 
01220         <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d7/d0/ctlnpqos_8c.html#a31">SepClientInitialize</a>(); <a class="code" href="../../d2/d6/tsecomm_8c.html#a0">SEASSERT_SUCCESS</a>(Status);
01221         Result = <a class="code" href="../../d8/d0/ctlpcqos_8c.html#a25">SepClientTest</a>();
01222 
01223     } <span class="keywordflow">else</span> {
01224 
01225         <a class="code" href="../../d2/d6/tsecomm_8c.html#a0">SEASSERT_SUCCESS</a>(Status);
01226 
01227         <span class="comment">//</span>
01228         <span class="comment">// Event wasn't yet there, so we must be the server.</span>
01229         <span class="comment">//</span>
01230 
01231     <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"Se: Starting Local Named Pipe Impersonation Test.\n"</span>);
01232 
01233         <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d7/d0/ctlnpqos_8c.html#a44">SepServerInitialize</a>(); <a class="code" href="../../d2/d6/tsecomm_8c.html#a0">SEASSERT_SUCCESS</a>(Status);
01234         Result = <a class="code" href="../../d8/d0/ctlpcqos_8c.html#a38">SepServerTest</a>();
01235 
01236     <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"Se: End Test.\n"</span>);
01237 
01238         }
01239 
01240 
01241 
01242     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d8/d0/psdelete_8c.html#a6">NtTerminateThread</a>( NtCurrentThread(), STATUS_SUCCESS);
01243     <a class="code" href="../../d2/d6/tsecomm_8c.html#a0">SEASSERT_SUCCESS</a>(Status);
01244 
01245     <span class="keywordflow">return</span> Result;
01246 
01247 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a27" doxytag="ctlnpqos.c::SepClientConnect" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID SepClientConnect           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">SECURITY_IMPERSONATION_LEVEL&nbsp;</td>
          <td class="mdname" nowrap> <em>ImpersonationLevel</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>SECURITY_CONTEXT_TRACKING_MODE&nbsp;</td>
          <td class="mdname" nowrap> <em>TrackingMode</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>EffectiveOnly</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00218">218</a> of file <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html">ctlnpqos.c</a>.
<p>
References <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00008">DevPrint</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00037">SecurityQos</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l01582">SepClientOpenPipe()</a>, and <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00036">TalkPort</a>.
<p>
<pre class="fragment"><div>00224 {
00225 
00226     <a class="code" href="../../d7/d0/ctlnpqos_8c.html#a14">SecurityQos</a>.ImpersonationLevel = ImpersonationLevel;
00227     <a class="code" href="../../d7/d0/ctlnpqos_8c.html#a14">SecurityQos</a>.ContextTrackingMode = TrackingMode;
00228     <a class="code" href="../../d7/d0/ctlnpqos_8c.html#a14">SecurityQos</a>.EffectiveOnly = EffectiveOnly;
00229 
00230     <a class="code" href="../../d7/d0/ctlnpqos_8c.html#a0">DevPrint</a>(<span class="stringliteral">"\nClient: "</span>);
00231     <a class="code" href="../../d7/d0/ctlnpqos_8c.html#a13">TalkPort</a> = <a class="code" href="../../d7/d0/ctlnpqos_8c.html#a53">SepClientOpenPipe</a>();
00232 
00233     <span class="keywordflow">return</span>;
00234 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a29" doxytag="ctlnpqos.c::SepClientDropConnection" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID SepClientDropConnection           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00252">252</a> of file <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html">ctlnpqos.c</a>.
<p>
References <a class="el" href="../../d6/d9/obclose_8c-source.html#l00037">NtClose()</a>, <a class="el" href="../../d3/d5/tsecomm_8c-source.html#l00043">SEASSERT_SUCCESS</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00135">Status</a>, and <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00036">TalkPort</a>.
<p>
<pre class="fragment"><div>00254 {
00255 
00256     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d5/d0/obclose_8c.html#a1">NtClose</a>( TalkPort );  <a class="code" href="../../d2/d6/tsecomm_8c.html#a0">SEASSERT_SUCCESS</a>(Status);
00257 
00258     <span class="keywordflow">return</span>;
00259 
00260 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a31" doxytag="ctlnpqos.c::SepClientInitialize" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS SepClientInitialize           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00553">553</a> of file <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html">ctlnpqos.c</a>.
<p>
References <a class="el" href="../../d7/d5/memprint_8h-source.html#l00079">DbgPrint</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00030">EventHandle</a>, <a class="el" href="../../d6/d9/obclose_8c-source.html#l00037">NtClose()</a>, <a class="el" href="../../d1/d7/ex_2event_8c-source.html#l00748">NtSetEvent()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00038">RequestCount</a>, <a class="el" href="../../d3/d5/tsecomm_8c-source.html#l00043">SEASSERT_SUCCESS</a>, and <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00135">Status</a>.
<p>
Referenced by <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l01165">CtLnpQos()</a>, and <a class="el" href="../../d9/d9/ctlpcqos_8c-source.html#l01187">CtLpcQos()</a>.
<p>
<pre class="fragment"><div>00556 {
00557 
00558 
00559 
00560     <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"Se: Client Initializing ...\n"</span>);
00561 
00562 
00563     <a class="code" href="../../d7/d0/ctlnpqos_8c.html#a15">RequestCount</a> = 0;
00564 
00565 
00566     <span class="comment">//</span>
00567     <span class="comment">// Signal the named event to start the test</span>
00568     <span class="comment">//</span>
00569 
00570     <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"Se: Client Starting Test ...\n"</span>);
00571     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d0/d8/ex_2event_8c.html#a10">NtSetEvent</a>( EventHandle, NULL ); <a class="code" href="../../d2/d6/tsecomm_8c.html#a0">SEASSERT_SUCCESS</a>(Status);
00572 
00573     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d5/d0/obclose_8c.html#a1">NtClose</a>( EventHandle ); <a class="code" href="../../d2/d6/tsecomm_8c.html#a0">SEASSERT_SUCCESS</a>(Status);
00574 
00575 
00576     <span class="keywordflow">return</span> STATUS_SUCCESS;
00577 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a28" doxytag="ctlnpqos.c::SepClientMakeRemoteCall" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID SepClientMakeRemoteCall           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00238">238</a> of file <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html">ctlnpqos.c</a>.
<p>
References <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00008">DevPrint</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00038">RequestCount</a>, and <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l01330">SepTransceivePipe()</a>.
<p>
<pre class="fragment"><div>00240 {
00241 
00242     <a class="code" href="../../d7/d0/ctlnpqos_8c.html#a0">DevPrint</a>(<span class="stringliteral">"\nClient: "</span>);
00243     <a class="code" href="../../d7/d0/ctlnpqos_8c.html#a48">SepTransceivePipe</a>( <span class="stringliteral">"Make Client Call\n"</span> );
00244 
00245     <a class="code" href="../../d7/d0/ctlnpqos_8c.html#a15">RequestCount</a> += 1;
00246 
00247     <span class="keywordflow">return</span>;
00248 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a53" doxytag="ctlnpqos.c::SepClientOpenPipe" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HANDLE SepClientOpenPipe           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l01582">1582</a> of file <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html">ctlnpqos.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d7/d1/rtqkey_8c-source.html#l00042">Buffer</a>, <a class="el" href="../../d4/d1/utlnpqos_8c-source.html#l00040">COMPLETION_MODE</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00011">Error</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d9/d9/geninst_8c-source.html#l00154">Name</a>, <a class="el" href="../../d4/d1/utlnpqos_8c-source.html#l00043">NAMED_PIPE_CONFIGURATION</a>, <a class="el" href="../../d6/d5/stierr_8h-source.html#l00030">NT_SUCCESS</a>, <a class="el" href="../../d6/d9/obclose_8c-source.html#l00037">NtClose()</a>, <a class="el" href="../../d9/d6/io_2fsctrl_8c-source.html#l00034">NtFsControlFile()</a>, <a class="el" href="../../d5/d1/open_8c-source.html#l00034">NtOpenFile()</a>, <a class="el" href="../../d0/d2/qsinfo_8c-source.html#l00849">NtSetInformationFile()</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d2/d1/obwait_8c-source.html#l00282">NtWaitForSingleObject()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00027">ObjectAttributes</a>, <a class="el" href="../../d4/d1/utlnpqos_8c-source.html#l00037">READ_MODE</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00033">RelativePortName</a>, <a class="el" href="../../d4/d6/config_2utils_2regutil_8c-source.html#l00022">RtlAllocateHeap</a>, <a class="el" href="../../d7/d5/nls_8c-source.html#l00082">RtlAnsiStringToUnicodeString()</a>, <a class="el" href="../../d7/d5/nls_8c-source.html#l01215">RtlFreeUnicodeString()</a>, <a class="el" href="../../d3/d6/string_8c-source.html#l00056">RtlInitString()</a>, <a class="el" href="../../d3/d5/tsecomm_8c-source.html#l00043">SEASSERT_SUCCESS</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00037">SecurityQos</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00135">Status</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, and <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00032">UnicodePortName</a>.
<p>
Referenced by <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00218">SepClientConnect()</a>.
<p>
<pre class="fragment"><div>01585 {
01586     HANDLE PipeHandle, NpfsHandle;
01587     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
01588     IO_STATUS_BLOCK Iosb;
01589     ULONG Share;
01590     STRING Npfs;
01591     UNICODE_STRING UnicodeNpfs;
01592     PFILE_PIPE_WAIT_FOR_BUFFER WaitPipe;
01593     ULONG WaitPipeLength;
01594     <a class="code" href="../../d3/d2/utlnpqos_8c.html#a7">NAMED_PIPE_CONFIGURATION</a> Config = FILE_PIPE_FULL_DUPLEX;
01595     <a class="code" href="../../d3/d2/utlnpqos_8c.html#a3">READ_MODE</a> ReadMode              = FILE_PIPE_MESSAGE_MODE;
01596     <a class="code" href="../../d3/d2/utlnpqos_8c.html#a5">COMPLETION_MODE</a> CompletionMode  = FILE_PIPE_QUEUE_OPERATION;
01597 
01598 
01599 <span class="comment">//#ifdef NOT_YET_WORKING</span>
01600     <span class="comment">//</span>
01601     <span class="comment">// Wait for the server's pipe to reach a listen state...</span>
01602     <span class="comment">//</span>
01603 
01604     <a class="code" href="../../d2/d7/string_8c.html#a5">RtlInitString</a>( &amp;Npfs, <span class="stringliteral">"\\Device\\NamedPipe\\"</span>);
01605     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d6/d6/nls_8c.html#a21">RtlAnsiStringToUnicodeString</a>(
01606                  &amp;UnicodeNpfs,
01607                  &amp;Npfs,
01608                  TRUE );  <a class="code" href="../../d2/d6/tsecomm_8c.html#a0">SEASSERT_SUCCESS</a>( <a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status) );
01609 
01610     InitializeObjectAttributes(
01611         &amp;ObjectAttributes,
01612         &amp;UnicodeNpfs,
01613         OBJ_CASE_INSENSITIVE,
01614         NULL,
01615         NULL);
01616 
01617     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status = <a class="code" href="../../d4/d2/open_8c.html#a0">NtOpenFile</a>(
01618                                 &amp;NpfsHandle,
01619                                 GENERIC_READ | SYNCHRONIZE,
01620                                 &amp;ObjectAttributes,
01621                                 &amp;Iosb,
01622                                 FILE_SHARE_READ,
01623                                 0 ))) {
01624 
01625         <a class="code" href="../../d7/d0/ctlnpqos_8c.html#a1">Error</a>( OpenNpfs, Status );
01626     }
01627     <a class="code" href="../../d6/d6/nls_8c.html#a34">RtlFreeUnicodeString</a>( &amp;UnicodeNpfs );
01628 
01629     WaitPipeLength =
01630         FIELD_OFFSET(FILE_PIPE_WAIT_FOR_BUFFER, Name[0]) +
01631         <a class="code" href="../../d7/d0/ctlnpqos_8c.html#a10">RelativePortName</a>.MaximumLength;                 <span class="comment">//UNICODEFIX UnicodeRelativePortName.MaximumLength;</span>
01632     WaitPipe = <a class="code" href="../../d3/d7/config_2utils_2regutil_8c.html#a0">RtlAllocateHeap</a>(RtlProcessHeap(), 0, WaitPipeLength);
01633     WaitPipe-&gt;TimeoutSpecified = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01634 
01635     WaitPipe-&gt;NameLength = <a class="code" href="../../d7/d0/ctlnpqos_8c.html#a10">RelativePortName</a>.Length;     <span class="comment">//UNICODEFIX UnicodeRelativePortName.Length;</span>
01636     strcpy(WaitPipe-&gt;Name, <a class="code" href="../../d7/d0/ctlnpqos_8c.html#a10">RelativePortName</a>.Buffer);    <span class="comment">//UNICODEFIX UnicodePortName.Buffer;</span>
01637 
01638     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status = <a class="code" href="../../d8/d7/io_2fsctrl_8c.html#a0">NtFsControlFile</a>(
01639                                 NpfsHandle,
01640                                 NULL,        <span class="comment">// Event</span>
01641                                 NULL,        <span class="comment">// ApcRoutine</span>
01642                                 NULL,        <span class="comment">// ApcContext</span>
01643                                 &amp;Iosb,
01644                                 FSCTL_PIPE_WAIT,
01645                                 WaitPipe,       <span class="comment">// Buffer for data to the FS</span>
01646                                 WaitPipeLength,
01647                                 NULL,        <span class="comment">// OutputBuffer</span>
01648                                 0            <span class="comment">// OutputBufferLength</span>
01649                                 ))) {
01650 
01651         <a class="code" href="../../d7/d0/ctlnpqos_8c.html#a1">Error</a>( ClientWaitPipe, Status );
01652     }
01653     <span class="keywordflow">if</span> (<a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> == STATUS_PENDING) {
01654         <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status = <a class="code" href="../../d1/d2/obwait_8c.html#a4">NtWaitForSingleObject</a>( NpfsHandle, TRUE, NULL ))) {
01655 
01656             <a class="code" href="../../d7/d0/ctlnpqos_8c.html#a1">Error</a>( NtWaitForSingleObject, Status );
01657         }
01658     }
01659 
01660     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Iosb.Status)) {
01661 
01662         <a class="code" href="../../d7/d0/ctlnpqos_8c.html#a1">Error</a>( ClientWaitPipeFinalStatus, Iosb.Status );
01663     }
01664 
01665     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d5/d0/obclose_8c.html#a1">NtClose</a>( NpfsHandle );
01666     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status));
01667 <span class="comment">//#endif  // NOT_YET_WORKING</span>
01668 <span class="comment">//    Delay(1);</span>
01669 
01670 
01671     <span class="comment">//</span>
01672     <span class="comment">//  Initialize the attributes</span>
01673     <span class="comment">//</span>
01674 
01675     InitializeObjectAttributes(
01676         &amp;ObjectAttributes,
01677         &amp;UnicodePortName,
01678         OBJ_CASE_INSENSITIVE,
01679         NULL,
01680         NULL
01681         );
01682     <a class="code" href="../../d7/d0/ctlnpqos_8c.html#a4">ObjectAttributes</a>.SecurityQualityOfService = (PVOID)(&amp;<a class="code" href="../../d7/d0/ctlnpqos_8c.html#a14">SecurityQos</a>);
01683 
01684     <span class="comment">//</span>
01685     <span class="comment">//  Calculate the share access</span>
01686     <span class="comment">//</span>
01687 
01688     Share = (Config == FILE_PIPE_INBOUND  ? FILE_SHARE_WRITE :
01689             (Config == FILE_PIPE_OUTBOUND ? FILE_SHARE_READ :
01690                        FILE_SHARE_READ | FILE_SHARE_WRITE));
01691 
01692 
01693 
01694     <span class="comment">//</span>
01695     <span class="comment">// And now open it...</span>
01696     <span class="comment">//</span>
01697 
01698     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status = <a class="code" href="../../d4/d2/open_8c.html#a0">NtOpenFile</a>(
01699                                 &amp;PipeHandle,
01700                                 GENERIC_READ | GENERIC_WRITE | SYNCHRONIZE,
01701                                 &amp;ObjectAttributes,
01702                                 &amp;Iosb,
01703                                 Share,
01704                                 0 ))) {
01705 
01706         <a class="code" href="../../d7/d0/ctlnpqos_8c.html#a1">Error</a>( OpenPipe, Status );
01707     }
01708 
01709     <span class="keywordflow">if</span> ((ReadMode != FILE_PIPE_BYTE_STREAM_MODE) ||
01710         (CompletionMode != FILE_PIPE_QUEUE_OPERATION)) {
01711 
01712         FILE_PIPE_INFORMATION <a class="code" href="../../d6/d2/rtqkey_8c.html#a3">Buffer</a>;
01713 
01714         <a class="code" href="../../d6/d2/rtqkey_8c.html#a3">Buffer</a>.ReadMode = ReadMode;
01715         <a class="code" href="../../d6/d2/rtqkey_8c.html#a3">Buffer</a>.CompletionMode = CompletionMode;
01716 
01717         <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status = <a class="code" href="../../d9/d2/qsinfo_8c.html#a4">NtSetInformationFile</a>(
01718                                 PipeHandle,
01719                                 &amp;Iosb,
01720                                 &amp;Buffer,
01721                                 <span class="keyword">sizeof</span>(FILE_PIPE_INFORMATION),
01722                                 FilePipeInformation ))) {
01723 
01724             <a class="code" href="../../d7/d0/ctlnpqos_8c.html#a1">Error</a>( NtSetInformationFile, Status );
01725         }
01726     }
01727 
01728     <span class="keywordflow">return</span> PipeHandle;
01729 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a30" doxytag="ctlnpqos.c::SepClientTest" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN SepClientTest           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00502">502</a> of file <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html">ctlnpqos.c</a>.
<p>
References <a class="el" href="../../d7/d5/memprint_8h-source.html#l00079">DbgPrint</a>, <a class="el" href="../../d8/d0/ctlpcqos_8c.html#a16">SepClientTestDynamic()</a>, <a class="el" href="../../d8/d0/ctlpcqos_8c.html#a15">SepClientTestStatic()</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
<pre class="fragment"><div>00504         :
00505 <span class="comment">//</span>
00506 <span class="comment">//      Static Context Tracking Tests</span>
00507 <span class="comment">//          Effective Only</span>
00508 <span class="comment">//              Anonymous</span>
00509 <span class="comment">//              Identification</span>
00510 <span class="comment">//              Impersonation</span>
00511 <span class="comment">//          Not Effective Only</span>
00512 <span class="comment">//              Anonymous</span>
00513 <span class="comment">//              Identification</span>
00514 <span class="comment">//              Impersonation</span>
00515 <span class="comment">//</span>
00516 <span class="comment">//      Dynamic Context Tracking Tests</span>
00517 <span class="comment">//          Effective Only</span>
00518 <span class="comment">//              Identification</span>
00519 <span class="comment">//              Impersonation</span>
00520 <span class="comment">//          Not Effective Only</span>
00521 <span class="comment">//              Identification</span>
00522 <span class="comment">//              Impersonation</span>
00523 <span class="comment">//</span>
00524 {
00525 
00526     BOOLEAN CompletionStatus;
00527 
00528 
00529 
00530 
00531     <span class="comment">//</span>
00532     <span class="comment">// Run the static test suite...</span>
00533     <span class="comment">//</span>
00534 
00535     CompletionStatus = <a class="code" href="../../d8/d0/ctlpcqos_8c.html#a15">SepClientTestStatic</a>();
00536 
00537     <span class="comment">//</span>
00538     <span class="comment">// Run the dynamic test suite...</span>
00539     <span class="comment">//</span>
00540 
00541     <span class="keywordflow">if</span> (CompletionStatus == <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>) {
00542         CompletionStatus = <a class="code" href="../../d8/d0/ctlpcqos_8c.html#a16">SepClientTestDynamic</a>();
00543     }
00544 
00545     <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"Se: Client Test Complete.\n"</span>);
00546 
00547 
00548     <span class="keywordflow">return</span> CompletionStatus;
00549 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a24" doxytag="ctlnpqos.c::SepClientTestAnonymous" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN SepClientTestAnonymous           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>StaticTest</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>EffectiveOnly</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00363">363</a> of file <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html">ctlnpqos.c</a>.
<p>
References <a class="el" href="../../d8/d0/ctlpcqos_8c.html#a22">SepClientConnect()</a>, <a class="el" href="../../d8/d0/ctlpcqos_8c.html#a24">SepClientDropConnection()</a>, <a class="el" href="../../d8/d0/ctlpcqos_8c.html#a23">SepClientMakeRemoteCall()</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
<pre class="fragment"><div>00368 {
00369 
00371     <span class="comment">//                                                                      //</span>
00372     <span class="comment">//        Anonymous Use Test                                            //</span>
00373     <span class="comment">//                                                                      //</span>
00375 <span class="comment"></span>
00376     SECURITY_CONTEXT_TRACKING_MODE TrackingMode;
00377 
00378     <span class="keywordflow">if</span> (StaticTest) {
00379         TrackingMode = SECURITY_STATIC_TRACKING;
00380     } <span class="keywordflow">else</span> {
00381         TrackingMode = SECURITY_DYNAMIC_TRACKING;
00382     }
00383 
00384     <span class="keywordflow">if</span> (!StaticTest) {
00385         <span class="comment">//</span>
00386         <span class="comment">// No action for dynamic test</span>
00387         <span class="comment">//</span>
00388         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00389     }
00390 
00391     <span class="comment">//</span>
00392     <span class="comment">// Anonymous Use ... Test</span>
00393     <span class="comment">//</span>
00394 
00395 
00396     <a class="code" href="../../d8/d0/ctlpcqos_8c.html#a22">SepClientConnect</a>(
00397         SecurityAnonymous,
00398         TrackingMode,
00399         EffectiveOnly
00400         );
00401 
00402     <a class="code" href="../../d8/d0/ctlpcqos_8c.html#a23">SepClientMakeRemoteCall</a>();
00403 
00404     <a class="code" href="../../d8/d0/ctlpcqos_8c.html#a24">SepClientDropConnection</a>();
00405 
00406 
00407     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00408 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a21" doxytag="ctlnpqos.c::SepClientTestDynamic" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN SepClientTestDynamic           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00288">288</a> of file <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html">ctlnpqos.c</a>.
<p>
References <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d8/d0/ctlpcqos_8c.html#a17">SepClientTestEffectiveOnly()</a>, <a class="el" href="../../d8/d0/ctlpcqos_8c.html#a18">SepClientTestNotEffectiveOnly()</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
<pre class="fragment"><div>00290 {
00291     BOOLEAN CompletionStatus;
00292 
00293     <span class="comment">//</span>
00294     <span class="comment">// Dynamic Context Tracking ... Suite</span>
00295     <span class="comment">//</span>
00296 
00297     CompletionStatus = <a class="code" href="../../d8/d0/ctlpcqos_8c.html#a17">SepClientTestEffectiveOnly</a>( FALSE );
00298 
00299 
00300     <span class="keywordflow">if</span> (CompletionStatus == <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>) {
00301 
00302         CompletionStatus = <a class="code" href="../../d8/d0/ctlpcqos_8c.html#a18">SepClientTestNotEffectiveOnly</a>( FALSE );
00303     }
00304 
00305     <span class="keywordflow">return</span> CompletionStatus;
00306 
00307 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a22" doxytag="ctlnpqos.c::SepClientTestEffectiveOnly" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN SepClientTestEffectiveOnly           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">BOOLEAN&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>StaticTest</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00311">311</a> of file <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html">ctlnpqos.c</a>.
<p>
References <a class="el" href="../../d8/d0/ctlpcqos_8c.html#a19">SepClientTestAnonymous()</a>, <a class="el" href="../../d8/d0/ctlpcqos_8c.html#a20">SepClientTestIdentification()</a>, <a class="el" href="../../d8/d0/ctlpcqos_8c.html#a21">SepClientTestImpersonation()</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
<pre class="fragment"><div>00316 {
00317 
00318     BOOLEAN CompletionStatus;
00319 
00320     <span class="comment">//</span>
00321     <span class="comment">// Effective Only ... Test</span>
00322     <span class="comment">//</span>
00323 
00324     CompletionStatus = <a class="code" href="../../d8/d0/ctlpcqos_8c.html#a19">SepClientTestAnonymous</a>( StaticTest, TRUE );
00325     <span class="keywordflow">if</span> (CompletionStatus == <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>) {
00326         CompletionStatus = <a class="code" href="../../d8/d0/ctlpcqos_8c.html#a20">SepClientTestIdentification</a>( StaticTest, TRUE );
00327     }
00328     <span class="keywordflow">if</span> (CompletionStatus == <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>) {
00329         CompletionStatus = <a class="code" href="../../d8/d0/ctlpcqos_8c.html#a21">SepClientTestImpersonation</a>( StaticTest, TRUE );
00330     }
00331 
00332     <span class="keywordflow">return</span> CompletionStatus;
00333 
00334 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a25" doxytag="ctlnpqos.c::SepClientTestIdentification" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN SepClientTestIdentification           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>StaticTest</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>EffectiveOnly</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00412">412</a> of file <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html">ctlnpqos.c</a>.
<p>
References <a class="el" href="../../d8/d0/ctlpcqos_8c.html#a22">SepClientConnect()</a>, <a class="el" href="../../d8/d0/ctlpcqos_8c.html#a24">SepClientDropConnection()</a>, <a class="el" href="../../d8/d0/ctlpcqos_8c.html#a23">SepClientMakeRemoteCall()</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
<pre class="fragment"><div>00417 {
00418 
00420     <span class="comment">//                                                                      //</span>
00421     <span class="comment">//        Identification Use Test                                       //</span>
00422     <span class="comment">//                                                                      //</span>
00424 <span class="comment"></span>
00425     SECURITY_CONTEXT_TRACKING_MODE TrackingMode;
00426 
00427     <span class="keywordflow">if</span> (StaticTest) {
00428         TrackingMode = SECURITY_STATIC_TRACKING;
00429     } <span class="keywordflow">else</span> {
00430         TrackingMode = SECURITY_DYNAMIC_TRACKING;
00431     }
00432 
00433     <span class="comment">//</span>
00434     <span class="comment">// Identification Use ... Test</span>
00435     <span class="comment">//</span>
00436 
00437 
00438     <a class="code" href="../../d8/d0/ctlpcqos_8c.html#a22">SepClientConnect</a>(
00439         SecurityIdentification,
00440         TrackingMode,
00441         EffectiveOnly
00442         );
00443 
00444     <a class="code" href="../../d8/d0/ctlpcqos_8c.html#a23">SepClientMakeRemoteCall</a>();
00445 
00446     <a class="code" href="../../d8/d0/ctlpcqos_8c.html#a24">SepClientDropConnection</a>();
00447 
00448 
00449     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00450 
00451 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a26" doxytag="ctlnpqos.c::SepClientTestImpersonation" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN SepClientTestImpersonation           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>StaticTest</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>EffectiveOnly</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00455">455</a> of file <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html">ctlnpqos.c</a>.
<p>
References <a class="el" href="../../d8/d0/ctlpcqos_8c.html#a22">SepClientConnect()</a>, <a class="el" href="../../d8/d0/ctlpcqos_8c.html#a24">SepClientDropConnection()</a>, <a class="el" href="../../d8/d0/ctlpcqos_8c.html#a23">SepClientMakeRemoteCall()</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
<pre class="fragment"><div>00460 {
00461 
00463     <span class="comment">//                                                                      //</span>
00464     <span class="comment">//        Impersonation Use Test                                        //</span>
00465     <span class="comment">//                                                                      //</span>
00467 <span class="comment"></span>
00468     SECURITY_CONTEXT_TRACKING_MODE TrackingMode;
00469 
00470     <span class="keywordflow">if</span> (StaticTest) {
00471         TrackingMode = SECURITY_STATIC_TRACKING;
00472     } <span class="keywordflow">else</span> {
00473         TrackingMode = SECURITY_DYNAMIC_TRACKING;
00474     }
00475 
00476 
00477     <span class="comment">//</span>
00478     <span class="comment">// Impersonation Use ... Test</span>
00479     <span class="comment">//</span>
00480 
00481 
00482     <a class="code" href="../../d8/d0/ctlpcqos_8c.html#a22">SepClientConnect</a>(
00483         SecurityImpersonation,
00484         TrackingMode,
00485         EffectiveOnly
00486         );
00487 
00488     <a class="code" href="../../d8/d0/ctlpcqos_8c.html#a23">SepClientMakeRemoteCall</a>();
00489 
00490     <a class="code" href="../../d8/d0/ctlpcqos_8c.html#a24">SepClientDropConnection</a>();
00491 
00492 
00493 
00494     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00495 
00496 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a23" doxytag="ctlnpqos.c::SepClientTestNotEffectiveOnly" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN SepClientTestNotEffectiveOnly           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">BOOLEAN&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>StaticTest</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00338">338</a> of file <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html">ctlnpqos.c</a>.
<p>
References <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d8/d0/ctlpcqos_8c.html#a19">SepClientTestAnonymous()</a>, <a class="el" href="../../d8/d0/ctlpcqos_8c.html#a20">SepClientTestIdentification()</a>, <a class="el" href="../../d8/d0/ctlpcqos_8c.html#a21">SepClientTestImpersonation()</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
<pre class="fragment"><div>00342 {
00343     BOOLEAN CompletionStatus;
00344 
00345     <span class="comment">//</span>
00346     <span class="comment">// Not Effective Only ... Test</span>
00347     <span class="comment">//</span>
00348 
00349     CompletionStatus = <a class="code" href="../../d8/d0/ctlpcqos_8c.html#a19">SepClientTestAnonymous</a>( StaticTest, FALSE );
00350     <span class="keywordflow">if</span> (CompletionStatus == <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>) {
00351         CompletionStatus = <a class="code" href="../../d8/d0/ctlpcqos_8c.html#a20">SepClientTestIdentification</a>( StaticTest, FALSE );
00352     }
00353     <span class="keywordflow">if</span> (CompletionStatus == <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>) {
00354         CompletionStatus = <a class="code" href="../../d8/d0/ctlpcqos_8c.html#a21">SepClientTestImpersonation</a>( StaticTest, FALSE );
00355     }
00356 
00357     <span class="keywordflow">return</span> CompletionStatus;
00358 
00359 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a20" doxytag="ctlnpqos.c::SepClientTestStatic" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN SepClientTestStatic           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00264">264</a> of file <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html">ctlnpqos.c</a>.
<p>
References <a class="el" href="../../d8/d0/ctlpcqos_8c.html#a17">SepClientTestEffectiveOnly()</a>, <a class="el" href="../../d8/d0/ctlpcqos_8c.html#a18">SepClientTestNotEffectiveOnly()</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
<pre class="fragment"><div>00266 {
00267 
00268     BOOLEAN CompletionStatus;
00269 
00270     <span class="comment">//</span>
00271     <span class="comment">//  Static Context Tracking ... Suite</span>
00272     <span class="comment">//</span>
00273 
00274     CompletionStatus = <a class="code" href="../../d8/d0/ctlpcqos_8c.html#a17">SepClientTestEffectiveOnly</a>( TRUE );
00275 
00276 
00277     <span class="keywordflow">if</span> (CompletionStatus == <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>) {
00278 
00279         CompletionStatus = <a class="code" href="../../d8/d0/ctlpcqos_8c.html#a18">SepClientTestNotEffectiveOnly</a>( TRUE );
00280     }
00281 
00282     <span class="keywordflow">return</span> CompletionStatus;
00283 
00284 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a57" doxytag="ctlnpqos.c::SepReadPipe" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID SepReadPipe           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l01258">1258</a> of file <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html">ctlnpqos.c</a>.
<p>
References <a class="el" href="../../d7/d1/rtqkey_8c-source.html#l00042">Buffer</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00008">DevPrint</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00011">Error</a>, <a class="el" href="../../d6/d5/stierr_8h-source.html#l00030">NT_SUCCESS</a>, <a class="el" href="../../d7/d4/io_2read_8c-source.html#l00036">NtReadFile()</a>, <a class="el" href="../../d2/d1/obwait_8c-source.html#l00282">NtWaitForSingleObject()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00135">Status</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00036">TalkPort</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00611">SepServerGetNextMessage()</a>.
<p>
<pre class="fragment"><div>01260 {
01261     IO_STATUS_BLOCK Iosb;
01262     UCHAR <a class="code" href="../../d6/d2/rtqkey_8c.html#a3">Buffer</a>[512];
01263 
01264     <a class="code" href="../../d7/d0/ctlnpqos_8c.html#a0">DevPrint</a>(<span class="stringliteral">"ReadPipe...\n"</span>, 0);
01265 
01266     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status = <a class="code" href="../../d6/d5/io_2read_8c.html#a1">NtReadFile</a>( TalkPort,
01267                                       (HANDLE)NULL,
01268                                       (PIO_APC_ROUTINE)NULL,
01269                                       (PVOID)NULL,
01270                                       &amp;Iosb,
01271                                       Buffer,
01272                                       512,
01273                                       (PLARGE_INTEGER)NULL,
01274                                       (PULONG) NULL ))) {
01275         <a class="code" href="../../d7/d0/ctlnpqos_8c.html#a1">Error</a>( NtReadFile, Status );
01276     }
01277 
01278     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status = <a class="code" href="../../d1/d2/obwait_8c.html#a4">NtWaitForSingleObject</a>( TalkPort, TRUE, NULL ))) {
01279 
01280         <a class="code" href="../../d7/d0/ctlnpqos_8c.html#a1">Error</a>( NtWaitForSingleObject, Status );
01281     }
01282 
01283     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Iosb.Status)) {
01284 
01285         <a class="code" href="../../d7/d0/ctlnpqos_8c.html#a1">Error</a>( NtReadFileFinalStatus, Iosb.Status );
01286     }
01287 
01288     <span class="keywordflow">return</span>;
01289 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a47" doxytag="ctlnpqos.c::SepReadPipe" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID SepReadPipe           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a41" doxytag="ctlnpqos.c::SepServerCompleteMessage" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID SepServerCompleteMessage           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00626">626</a> of file <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html">ctlnpqos.c</a>.
<p>
References <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00008">DevPrint</a>, and <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l01293">SepWritePipe()</a>.
<p>
<pre class="fragment"><div>00628 {
00629 
00630     <a class="code" href="../../d7/d0/ctlnpqos_8c.html#a0">DevPrint</a>(<span class="stringliteral">"\nServer: "</span>);
00631     <a class="code" href="../../d7/d0/ctlnpqos_8c.html#a46">SepWritePipe</a>(<span class="stringliteral">"Return From Server\n"</span>);
00632     <span class="keywordflow">return</span>;
00633 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a49" doxytag="ctlnpqos.c::SepServerCreatePipe" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HANDLE SepServerCreatePipe           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l01377">1377</a> of file <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html">ctlnpqos.c</a>.
<p>
References <a class="el" href="../../d4/d1/utlnpqos_8c-source.html#l00040">COMPLETION_MODE</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00011">Error</a>, <a class="el" href="../../d4/d1/utlnpqos_8c-source.html#l00043">NAMED_PIPE_CONFIGURATION</a>, <a class="el" href="../../d4/d1/utlnpqos_8c-source.html#l00033">NAMED_PIPE_TYPE</a>, <a class="el" href="../../d6/d5/stierr_8h-source.html#l00030">NT_SUCCESS</a>, <a class="el" href="../../d2/d7/io_2create_8c-source.html#l00125">NtCreateNamedPipeFile()</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00027">ObjectAttributes</a>, <a class="el" href="../../d4/d1/utlnpqos_8c-source.html#l00037">READ_MODE</a>, <a class="el" href="../../d7/d5/nls_8c-source.html#l01215">RtlFreeUnicodeString()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00135">Status</a>, and <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00032">UnicodePortName</a>.
<p>
Referenced by <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l01028">SepServerInitialize()</a>.
<p>
<pre class="fragment"><div>01380 {
01381     HANDLE PipeHandle;
01382     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
01383     IO_STATUS_BLOCK Iosb;
01384     LARGE_INTEGER Timeout;
01385     <a class="code" href="../../d3/d2/utlnpqos_8c.html#a3">READ_MODE</a> Mode;
01386     ULONG Share;
01387     <a class="code" href="../../d3/d2/utlnpqos_8c.html#a7">NAMED_PIPE_CONFIGURATION</a> Config = FILE_PIPE_FULL_DUPLEX;
01388     <a class="code" href="../../d3/d2/utlnpqos_8c.html#a1">NAMED_PIPE_TYPE</a> PipeType        = FILE_PIPE_MESSAGE_TYPE;
01389     <a class="code" href="../../d3/d2/utlnpqos_8c.html#a5">COMPLETION_MODE</a> CompletionMode  = FILE_PIPE_QUEUE_OPERATION;
01390     ULONG MaximumInstances          = 4;
01391 
01392 
01393     <span class="comment">//</span>
01394     <span class="comment">//  Set the default timeout to 60 seconds, and initalize the attributes</span>
01395     <span class="comment">//</span>
01396 
01397     Timeout.QuadPart = -10 * 1000 * 1000 * 60;
01398 
01399     InitializeObjectAttributes(
01400         &amp;ObjectAttributes,
01401         &amp;UnicodePortName,
01402         OBJ_CASE_INSENSITIVE,
01403         NULL,
01404         NULL
01405         );
01406 
01407     <span class="comment">//</span>
01408     <span class="comment">//  Calculate the readmode and share access</span>
01409     <span class="comment">//</span>
01410 
01411     Mode = (PipeType == FILE_PIPE_MESSAGE_TYPE ? FILE_PIPE_MESSAGE_MODE :
01412                                                  FILE_PIPE_BYTE_STREAM_MODE);
01413 
01414     Share = (Config == FILE_PIPE_INBOUND  ? FILE_SHARE_WRITE :
01415             (Config == FILE_PIPE_OUTBOUND ? FILE_SHARE_READ :
01416                                             FILE_SHARE_READ | FILE_SHARE_WRITE));
01417 
01418     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status = <a class="code" href="../../d1/d8/io_2create_8c.html#a1">NtCreateNamedPipeFile</a>(
01419                                 &amp;PipeHandle,
01420                                 GENERIC_READ | GENERIC_WRITE | SYNCHRONIZE,
01421                                 &amp;ObjectAttributes,
01422                                 &amp;Iosb,
01423                                 Share,
01424                                 FILE_CREATE,
01425                                 0,
01426                                 PipeType,
01427                                 Mode,
01428                                 CompletionMode,
01429                                 MaximumInstances,
01430                                 1024,
01431                                 1024,
01432                                 (PLARGE_INTEGER)&amp;Timeout ))) {
01433 
01434         <a class="code" href="../../d7/d0/ctlnpqos_8c.html#a1">Error</a>( CreatePipe, Status );
01435     }
01436     <a class="code" href="../../d6/d6/nls_8c.html#a34">RtlFreeUnicodeString</a>( &amp;UnicodePortName );
01437 
01438     <span class="keywordflow">return</span> PipeHandle;
01439 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a60" doxytag="ctlnpqos.c::SepServerDisconnectPipe" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID SepServerDisconnectPipe           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l01520">1520</a> of file <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html">ctlnpqos.c</a>.
<p>
References <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00008">DevPrint</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00035">EarPort</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00011">Error</a>, <a class="el" href="../../d6/d5/stierr_8h-source.html#l00030">NT_SUCCESS</a>, <a class="el" href="../../d6/d9/obclose_8c-source.html#l00037">NtClose()</a>, <a class="el" href="../../d2/d9/io_2misc_8c-source.html#l00386">NtFlushBuffersFile()</a>, <a class="el" href="../../d9/d6/io_2fsctrl_8c-source.html#l00034">NtFsControlFile()</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d2/d1/obwait_8c-source.html#l00282">NtWaitForSingleObject()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d3/d5/tsecomm_8c-source.html#l00043">SEASSERT_SUCCESS</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00135">Status</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00036">TalkPort</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00665">SepServerDropConnection()</a>.
<p>
<pre class="fragment"><div>01522 {
01523     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
01524     IO_STATUS_BLOCK Iosb;
01525 
01526     <a class="code" href="../../d7/d0/ctlnpqos_8c.html#a0">DevPrint</a>(<span class="stringliteral">"DisconnectPipe...\n"</span>, 0);
01527     <a class="code" href="../../d7/d0/ctlnpqos_8c.html#a0">DevPrint</a>(<span class="stringliteral">"        (Flush)...\n"</span>, 0);
01528 
01529     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status = <a class="code" href="../../d1/d0/io_2misc_8c.html#a3">NtFlushBuffersFile</a>(
01530                                 TalkPort,
01531                                 &amp;Iosb
01532                                 ))) {
01533         <a class="code" href="../../d7/d0/ctlnpqos_8c.html#a1">Error</a>( DisconnectPipe, Status );
01534     }
01535 
01536     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Iosb.Status)) {
01537 
01538         <a class="code" href="../../d7/d0/ctlnpqos_8c.html#a1">Error</a>( FlushPipeFinalStatus, Iosb.Status );
01539     }
01540 
01541 
01542     <a class="code" href="../../d7/d0/ctlnpqos_8c.html#a0">DevPrint</a>(<span class="stringliteral">"        (Close Talk Port)...\n"</span>, 0);
01543     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d5/d0/obclose_8c.html#a1">NtClose</a>( TalkPort ); <a class="code" href="../../d2/d6/tsecomm_8c.html#a0">SEASSERT_SUCCESS</a>(Status);
01544 
01545     <a class="code" href="../../d7/d0/ctlnpqos_8c.html#a0">DevPrint</a>(<span class="stringliteral">"        (Disconnect)...\n"</span>, 0);
01546     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status = <a class="code" href="../../d8/d7/io_2fsctrl_8c.html#a0">NtFsControlFile</a>(
01547                                 EarPort,
01548                                 NULL,   <span class="comment">// Event</span>
01549                                 NULL,   <span class="comment">// ApcRoutine</span>
01550                                 NULL,   <span class="comment">// ApcContext</span>
01551                                 &amp;Iosb,
01552                                 FSCTL_PIPE_DISCONNECT,
01553                                 NULL,   <span class="comment">// InputBuffer</span>
01554                                 0,      <span class="comment">// InputBufferLength,</span>
01555                                 NULL,   <span class="comment">// OutputBuffer</span>
01556                                 0       <span class="comment">// OutputBufferLength</span>
01557                                 ))) {
01558 
01559         <a class="code" href="../../d7/d0/ctlnpqos_8c.html#a1">Error</a>( DisconnectPipe, Status );
01560     }
01561     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status = <a class="code" href="../../d1/d2/obwait_8c.html#a4">NtWaitForSingleObject</a>( EarPort, TRUE, NULL ))) {
01562 
01563         <a class="code" href="../../d7/d0/ctlnpqos_8c.html#a1">Error</a>( NtWaitForSingleObject, Status );
01564     }
01565 
01566     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Iosb.Status)) {
01567 
01568         <a class="code" href="../../d7/d0/ctlnpqos_8c.html#a1">Error</a>( DisconnectPipeFinalStatus, Iosb.Status );
01569     }
01570 
01571     <span class="keywordflow">return</span>;
01572 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a52" doxytag="ctlnpqos.c::SepServerDisconnectPipe" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID SepServerDisconnectPipe           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a42" doxytag="ctlnpqos.c::SepServerDropConnection" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID SepServerDropConnection           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00665">665</a> of file <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html">ctlnpqos.c</a>.
<p>
References <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00008">DevPrint</a>, and <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l01520">SepServerDisconnectPipe()</a>.
<p>
<pre class="fragment"><div>00667 {
00668     <a class="code" href="../../d7/d0/ctlnpqos_8c.html#a0">DevPrint</a>(<span class="stringliteral">"\nServer: "</span>);
00669     <a class="code" href="../../d7/d0/ctlnpqos_8c.html#a60">SepServerDisconnectPipe</a>();
00670 
00671     <span class="keywordflow">return</span>;
00672 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a40" doxytag="ctlnpqos.c::SepServerGetNextMessage" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID SepServerGetNextMessage           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00611">611</a> of file <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html">ctlnpqos.c</a>.
<p>
References <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00008">DevPrint</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00038">RequestCount</a>, and <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l01258">SepReadPipe()</a>.
<p>
<pre class="fragment"><div>00613 {
00614 
00615 
00616 
00617     <a class="code" href="../../d7/d0/ctlnpqos_8c.html#a0">DevPrint</a>(<span class="stringliteral">"\nServer: "</span>);
00618     <a class="code" href="../../d7/d0/ctlnpqos_8c.html#a57">SepReadPipe</a>();
00619 
00620     <a class="code" href="../../d7/d0/ctlnpqos_8c.html#a15">RequestCount</a> += 1;
00621 
00622     <span class="keywordflow">return</span>;
00623 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a55" doxytag="ctlnpqos.c::SepServerImpersonateClient" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID SepServerImpersonateClient           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00636">636</a> of file <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html">ctlnpqos.c</a>.
<p>
References <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00008">DevPrint</a>, and <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l01482">SepServerImpersonatePipe()</a>.
<p>
<pre class="fragment"><div>00638 {
00639 
00640     <a class="code" href="../../d7/d0/ctlnpqos_8c.html#a0">DevPrint</a>(<span class="stringliteral">"\nServer: "</span>);
00641     <a class="code" href="../../d7/d0/ctlnpqos_8c.html#a59">SepServerImpersonatePipe</a>( );
00642 
00643 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a59" doxytag="ctlnpqos.c::SepServerImpersonatePipe" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID SepServerImpersonatePipe           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l01482">1482</a> of file <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html">ctlnpqos.c</a>.
<p>
References <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00008">DevPrint</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00011">Error</a>, <a class="el" href="../../d6/d5/stierr_8h-source.html#l00030">NT_SUCCESS</a>, <a class="el" href="../../d9/d6/io_2fsctrl_8c-source.html#l00034">NtFsControlFile()</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d2/d1/obwait_8c-source.html#l00282">NtWaitForSingleObject()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00135">Status</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00036">TalkPort</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00636">SepServerImpersonateClient()</a>.
<p>
<pre class="fragment"><div>01484 {
01485     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
01486     IO_STATUS_BLOCK Iosb;
01487 
01488     <a class="code" href="../../d7/d0/ctlnpqos_8c.html#a0">DevPrint</a>(<span class="stringliteral">"ImpersonatePipe...\n"</span>, 0);
01489 
01490     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status = <a class="code" href="../../d8/d7/io_2fsctrl_8c.html#a0">NtFsControlFile</a>(
01491                                 TalkPort,
01492                                 NULL,   <span class="comment">// Event</span>
01493                                 NULL,   <span class="comment">// ApcRoutine</span>
01494                                 NULL,   <span class="comment">// ApcContext</span>
01495                                 &amp;Iosb,
01496                                 FSCTL_PIPE_IMPERSONATE,
01497                                 NULL,   <span class="comment">// InputBuffer</span>
01498                                 0,      <span class="comment">// InputBufferLength,</span>
01499                                 NULL,   <span class="comment">// OutputBuffer</span>
01500                                 0       <span class="comment">// OutputBufferLength</span>
01501                                 ))) {
01502 
01503         <a class="code" href="../../d7/d0/ctlnpqos_8c.html#a1">Error</a>( ImpersonatePipe, Status );
01504     }
01505     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status = <a class="code" href="../../d1/d2/obwait_8c.html#a4">NtWaitForSingleObject</a>( TalkPort, TRUE, NULL ))) {
01506 
01507         <a class="code" href="../../d7/d0/ctlnpqos_8c.html#a1">Error</a>( NtWaitForSingleObject, Status );
01508     }
01509 
01510     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Iosb.Status)) {
01511 
01512         <a class="code" href="../../d7/d0/ctlnpqos_8c.html#a1">Error</a>( ImpersonatePipeFinalStatus, Iosb.Status );
01513     }
01514 
01515     <span class="keywordflow">return</span>;
01516 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a51" doxytag="ctlnpqos.c::SepServerImpersonatePipe" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID SepServerImpersonatePipe           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a44" doxytag="ctlnpqos.c::SepServerInitialize" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS SepServerInitialize           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l01028">1028</a> of file <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html">ctlnpqos.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d7/d5/memprint_8h-source.html#l00079">DbgPrint</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00035">EarPort</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00030">EventHandle</a>, <a class="el" href="../../d6/d5/stierr_8h-source.html#l00030">NT_SUCCESS</a>, <a class="el" href="../../d6/d9/obclose_8c-source.html#l00037">NtClose()</a>, <a class="el" href="../../d8/d0/psopen_8c-source.html#l00280">NtOpenThread()</a>, <a class="el" href="../../d2/d1/obwait_8c-source.html#l00282">NtWaitForSingleObject()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00038">RequestCount</a>, <a class="el" href="../../d3/d5/tsecomm_8c-source.html#l00043">SEASSERT_SUCCESS</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l01377">SepServerCreatePipe()</a>, <a class="el" href="../../d8/d0/ctlpcqos_8c.html#a40">SepServerSpawnClientProcess()</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00043">SepServerThread</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00135">Status</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l01165">CtLnpQos()</a>, and <a class="el" href="../../d9/d9/ctlpcqos_8c-source.html#l01187">CtLpcQos()</a>.
<p>
<pre class="fragment"><div>01031 {
01032 
01033     OBJECT_ATTRIBUTES ThreadAttributes;
01034     PTEB CurrentTeb;
01035 
01036 
01037     <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"Se: Server Initializing ...\n"</span>);
01038 
01039     <span class="comment">//</span>
01040     <span class="comment">// Initialize global variables</span>
01041     <span class="comment">//</span>
01042 
01043     <a class="code" href="../../d7/d0/ctlnpqos_8c.html#a15">RequestCount</a> = 0;
01044 
01045     <span class="comment">//</span>
01046     <span class="comment">// Get a handle to our thread to so that we can access our thread</span>
01047     <span class="comment">// even when impersonating an anonymous client (which we can't do</span>
01048     <span class="comment">// using NtCurrentThread()).</span>
01049     <span class="comment">//</span>
01050 
01051     CurrentTeb = NtCurrentTeb();
01052     InitializeObjectAttributes(&amp;ThreadAttributes, NULL, 0, NULL, NULL);
01053     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d7/d1/psopen_8c.html#a1">NtOpenThread</a>(
01054                  &amp;SepServerThread,           <span class="comment">// TargetHandle</span>
01055                  THREAD_ALL_ACCESS,          <span class="comment">// DesiredAccess</span>
01056                  &amp;ThreadAttributes,          <span class="comment">// ObjectAttributes</span>
01057                  &amp;CurrentTeb-&gt;ClientId       <span class="comment">// ClientId</span>
01058                  );
01059     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>( <a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status) );
01060 
01061 
01062     <span class="comment">//</span>
01063     <span class="comment">// Create the server's port</span>
01064     <span class="comment">//</span>
01065 
01066     <a class="code" href="../../d7/d0/ctlnpqos_8c.html#a12">EarPort</a> = <a class="code" href="../../d7/d0/ctlnpqos_8c.html#a49">SepServerCreatePipe</a>();
01067 
01068 
01069 
01070     <span class="comment">//</span>
01071     <span class="comment">// Spawn a copy of ourselves...</span>
01072     <span class="comment">//</span>
01073 
01074     <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"Se: Server Spawning client process ...\n"</span>);
01075     <a class="code" href="../../d8/d0/ctlpcqos_8c.html#a40">SepServerSpawnClientProcess</a>();
01076 
01077 
01078     <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"Se: Server waiting for start of test signal ...\n"</span>);
01079 
01080     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d1/d2/obwait_8c.html#a4">NtWaitForSingleObject</a>(
01081                  EventHandle,
01082                  TRUE,
01083                  NULL
01084                  ); <a class="code" href="../../d2/d6/tsecomm_8c.html#a0">SEASSERT_SUCCESS</a>(Status);
01085 
01086     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d5/d0/obclose_8c.html#a1">NtClose</a>( EventHandle );  <a class="code" href="../../d2/d6/tsecomm_8c.html#a0">SEASSERT_SUCCESS</a>(Status);
01087 
01088 
01089     <span class="keywordflow">return</span> STATUS_SUCCESS;
01090 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a58" doxytag="ctlnpqos.c::SepServerListenPipe" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID SepServerListenPipe           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l01443">1443</a> of file <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html">ctlnpqos.c</a>.
<p>
References <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00008">DevPrint</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00035">EarPort</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00011">Error</a>, <a class="el" href="../../d6/d5/stierr_8h-source.html#l00030">NT_SUCCESS</a>, <a class="el" href="../../d9/d6/io_2fsctrl_8c-source.html#l00034">NtFsControlFile()</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d2/d1/obwait_8c-source.html#l00282">NtWaitForSingleObject()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00135">Status</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00588">SepServerWaitForNextConnect()</a>.
<p>
<pre class="fragment"><div>01445 {
01446     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
01447     IO_STATUS_BLOCK Iosb;
01448 
01449     <a class="code" href="../../d7/d0/ctlnpqos_8c.html#a0">DevPrint</a>(<span class="stringliteral">"ListenPipe...\n"</span>, 0);
01450 
01451     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status = <a class="code" href="../../d8/d7/io_2fsctrl_8c.html#a0">NtFsControlFile</a>(
01452                                 EarPort,
01453                                 NULL,   <span class="comment">// Event</span>
01454                                 NULL,   <span class="comment">// ApcRoutine</span>
01455                                 NULL,   <span class="comment">// ApcContext</span>
01456                                 &amp;Iosb,
01457                                 FSCTL_PIPE_LISTEN,
01458                                 NULL,   <span class="comment">// InputBuffer</span>
01459                                 0,      <span class="comment">// InputBufferLength,</span>
01460                                 NULL,   <span class="comment">// OutputBuffer</span>
01461                                 0       <span class="comment">// OutputBufferLength</span>
01462                                 ))) {
01463 
01464         <a class="code" href="../../d7/d0/ctlnpqos_8c.html#a1">Error</a>( ListenPipe, Status );
01465     }
01466     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status = <a class="code" href="../../d1/d2/obwait_8c.html#a4">NtWaitForSingleObject</a>( EarPort, TRUE, NULL ))) {
01467 
01468         <a class="code" href="../../d7/d0/ctlnpqos_8c.html#a1">Error</a>( NtWaitForSingleObject, Status );
01469     }
01470 
01471     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Iosb.Status)) {
01472 
01473         <a class="code" href="../../d7/d0/ctlnpqos_8c.html#a1">Error</a>( ListenPipeFinalStatus, Iosb.Status );
01474     }
01475 
01476 
01477     <span class="keywordflow">return</span>;
01478 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a50" doxytag="ctlnpqos.c::SepServerListenPipe" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID SepServerListenPipe           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a56" doxytag="ctlnpqos.c::SepServerRevertToSelf" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID SepServerRevertToSelf           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00647">647</a> of file <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html">ctlnpqos.c</a>.
<p>
References <a class="el" href="../../d0/d1/psquery_8c-source.html#l03103">NtSetInformationThread()</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d3/d5/tsecomm_8c-source.html#l00043">SEASSERT_SUCCESS</a>, and <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00043">SepServerThread</a>.
<p>
<pre class="fragment"><div>00649 {
00650     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> TmpStatus;
00651     HANDLE NullHandle;
00652 
00653     NullHandle = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00654     TmpStatus = <a class="code" href="../../d9/d1/psquery_8c.html#a21">NtSetInformationThread</a>(
00655                     SepServerThread,
00656                     ThreadImpersonationToken,
00657                     (PVOID)&amp;NullHandle,
00658                     (ULONG)<span class="keyword">sizeof</span>(HANDLE)
00659                     );   <a class="code" href="../../d2/d6/tsecomm_8c.html#a0">SEASSERT_SUCCESS</a>(TmpStatus);
00660 
00661 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a45" doxytag="ctlnpqos.c::SepServerSpawnClientProcess" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID SepServerSpawnClientProcess           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l01093">1093</a> of file <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html">ctlnpqos.c</a>.
<p>
References <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d6/d5/stierr_8h-source.html#l00030">NT_SUCCESS</a>, <a class="el" href="../../d2/d1/psspnd_8c-source.html#l00138">NtResumeThread()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d7/d5/nls_8c-source.html#l00082">RtlAnsiStringToUnicodeString()</a>, <a class="el" href="../../d1/d1/rtlexec_8c-source.html#l00110">RtlCreateProcessParameters()</a>, <a class="el" href="../../d1/d1/rtlexec_8c-source.html#l00813">RtlCreateUserProcess()</a>, <a class="el" href="../../d1/d1/rtlexec_8c-source.html#l00365">RtlDestroyProcessParameters()</a>, <a class="el" href="../../d7/d5/nls_8c-source.html#l01215">RtlFreeUnicodeString()</a>, <a class="el" href="../../d3/d6/string_8c-source.html#l00056">RtlInitString()</a>, <a class="el" href="../../d3/d5/tsecomm_8c-source.html#l00043">SEASSERT_SUCCESS</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00135">Status</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
<pre class="fragment"><div>01095 {
01096 
01097     RTL_USER_PROCESS_INFORMATION ProcessInformation;
01098     STRING ProgramName;
01099     UNICODE_STRING UnicodeProgramName;
01100     STRING ImagePathName;
01101     UNICODE_STRING UnicodeImagePathName;
01102     PRTL_USER_PROCESS_PARAMETERS ProcessParameters;
01103 
01104     <a class="code" href="../../d2/d7/string_8c.html#a5">RtlInitString</a>( &amp;ProgramName, <span class="stringliteral">"\\SystemRoot\\Bin\\utlnpqos.exe"</span> );
01105     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d6/d6/nls_8c.html#a21">RtlAnsiStringToUnicodeString</a>(
01106                  &amp;UnicodeProgramName,
01107                  &amp;ProgramName,
01108                  TRUE );  <a class="code" href="../../d2/d6/tsecomm_8c.html#a0">SEASSERT_SUCCESS</a>( <a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status) );
01109     <a class="code" href="../../d2/d7/string_8c.html#a5">RtlInitString</a>( &amp;ImagePathName, <span class="stringliteral">"utlnpqos.exe"</span>);
01110     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d6/d6/nls_8c.html#a21">RtlAnsiStringToUnicodeString</a>(
01111                  &amp;UnicodeImagePathName,
01112                  &amp;ImagePathName,
01113                  TRUE );  <a class="code" href="../../d2/d6/tsecomm_8c.html#a0">SEASSERT_SUCCESS</a>( <a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status) );
01114 
01115 
01116     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d0/d2/rtlexec_8c.html#a8">RtlCreateProcessParameters</a>(
01117                  &amp;ProcessParameters,
01118                  &amp;ImagePathName,        <span class="comment">// FIX, FIX &amp;UnicodeImagePathName, (when converted to unicode)</span>
01119                  NULL,
01120                  NULL,
01121                  NULL,
01122                  NULL,
01123                  NULL,
01124                  NULL,
01125                  NULL,
01126                  NULL
01127                  );
01128 
01129     <a class="code" href="../../d2/d6/tsecomm_8c.html#a0">SEASSERT_SUCCESS</a>(Status);
01130     <a class="code" href="../../d6/d6/nls_8c.html#a34">RtlFreeUnicodeString</a>( &amp;UnicodeImagePathName );
01131 
01132 
01133     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d0/d2/rtlexec_8c.html#a12">RtlCreateUserProcess</a>(
01134                  &amp;ProgramName,                   <span class="comment">// FIX, FIX &amp;UnicodeProgramName (when converted to unicode)</span>
01135                  ProcessParameters,              <span class="comment">// ProcessParameters</span>
01136                  NULL,                           <span class="comment">// ProcessSecurityDescriptor</span>
01137                  NULL,                           <span class="comment">// ThreadSecurityDescriptor</span>
01138                  NtCurrentProcess(),             <span class="comment">// ParentProcess</span>
01139                  FALSE,                          <span class="comment">// InheritHandles</span>
01140                  NULL,                           <span class="comment">// DebugPort</span>
01141                  NULL,                           <span class="comment">// ExceptionPort</span>
01142                  &amp;ProcessInformation             <span class="comment">// ProcessInformation</span>
01143                  ); <a class="code" href="../../d2/d6/tsecomm_8c.html#a0">SEASSERT_SUCCESS</a>(Status);
01144     <a class="code" href="../../d6/d6/nls_8c.html#a34">RtlFreeUnicodeString</a>( &amp;UnicodeProgramName );
01145 
01146     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d1/d2/psspnd_8c.html#a1">NtResumeThread</a>(
01147                   ProcessInformation.Thread,
01148                   NULL
01149                   ); <a class="code" href="../../d2/d6/tsecomm_8c.html#a0">SEASSERT_SUCCESS</a>(Status);
01150 
01151     <a class="code" href="../../d0/d2/rtlexec_8c.html#a9">RtlDestroyProcessParameters</a>( ProcessParameters );
01152 
01153 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a43" doxytag="ctlnpqos.c::SepServerTest" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN SepServerTest           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00960">960</a> of file <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html">ctlnpqos.c</a>.
<p>
References <a class="el" href="../../d7/d5/memprint_8h-source.html#l00079">DbgPrint</a>, <a class="el" href="../../d8/d0/ctlpcqos_8c.html#a28">SepServerTestDynamic()</a>, <a class="el" href="../../d8/d0/ctlpcqos_8c.html#a27">SepServerTestStatic()</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
<pre class="fragment"><div>00962         :
00963 <span class="comment">//</span>
00964 <span class="comment">//      Static Context Tracking Tests</span>
00965 <span class="comment">//          Effective Only</span>
00966 <span class="comment">//              Anonymous</span>
00967 <span class="comment">//              Identification</span>
00968 <span class="comment">//              Impersonation</span>
00969 <span class="comment">//          Not Effective Only</span>
00970 <span class="comment">//              Anonymous</span>
00971 <span class="comment">//              Identification</span>
00972 <span class="comment">//              Impersonation</span>
00973 <span class="comment">//</span>
00974 <span class="comment">//      Dynamic Context Tracking Tests</span>
00975 <span class="comment">//          Effective Only</span>
00976 <span class="comment">//              Identification</span>
00977 <span class="comment">//              Impersonation</span>
00978 <span class="comment">//          Not Effective Only</span>
00979 <span class="comment">//              Identification</span>
00980 <span class="comment">//              Impersonation</span>
00981 <span class="comment">//</span>
00982 {
00983 
00984     BOOLEAN CompletionStatus;
00985 
00986 
00987     <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"Se: Server Starting Test ...\n"</span>);
00988 
00989     <span class="comment">//</span>
00990     <span class="comment">// Run the static test suite...</span>
00991     <span class="comment">//</span>
00992 
00993     CompletionStatus = <a class="code" href="../../d8/d0/ctlpcqos_8c.html#a27">SepServerTestStatic</a>();
00994 
00995     <span class="comment">//</span>
00996     <span class="comment">// Run the dynamic test suite...</span>
00997     <span class="comment">//</span>
00998 
00999     <span class="keywordflow">if</span> (CompletionStatus == <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>) {
01000         CompletionStatus = <a class="code" href="../../d8/d0/ctlpcqos_8c.html#a28">SepServerTestDynamic</a>();
01001     }
01002 
01003     <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"Se: Server Test Complete.\n"</span>);
01004 
01005     <span class="comment">//</span>
01006     <span class="comment">// Print test results</span>
01007     <span class="comment">//</span>
01008 
01009     <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"\n"</span>);
01010     <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"\n"</span>);
01011     <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"**********************\n"</span>);
01012     <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"**                  **\n"</span>);
01013 
01014     <span class="keywordflow">if</span> (CompletionStatus == <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>) {
01015         <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"**  Test Succeeded  **\n"</span>);
01016     } <span class="keywordflow">else</span> {
01017         <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"**  Test Failed !!  **\n"</span>);
01018     }
01019 
01020     <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"**                  **\n"</span>);
01021     <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"**********************\n"</span>);
01022 
01023     <span class="keywordflow">return</span> CompletionStatus;
01024 
01025 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a36" doxytag="ctlnpqos.c::SepServerTestAnonymous" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN SepServerTestAnonymous           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>StaticTest</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>EffectiveOnly</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00765">765</a> of file <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html">ctlnpqos.c</a>.
<p>
References <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00039">ClientToken</a>, <a class="el" href="../../d7/d5/memprint_8h-source.html#l00079">DbgPrint</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d8/d2/tokenopn_8c-source.html#l00458">NtOpenThreadToken()</a>, <a class="el" href="../../d8/d0/ctlpcqos_8c.html#a36">SepServerCompleteMessage()</a>, <a class="el" href="../../d8/d0/ctlpcqos_8c.html#a37">SepServerDropConnection()</a>, <a class="el" href="../../d8/d0/ctlpcqos_8c.html#a35">SepServerGetNextMessage()</a>, <a class="el" href="../../d9/d9/ctlpcqos_8c-source.html#l00645">SepServerImpersonateClient()</a>, <a class="el" href="../../d9/d9/ctlpcqos_8c-source.html#l00658">SepServerRevertToSelf()</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00043">SepServerThread</a>, <a class="el" href="../../d8/d0/ctlpcqos_8c.html#a34">SepServerWaitForNextConnect()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00135">Status</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
<pre class="fragment"><div>00770 {
00771     BOOLEAN CompletionStatus = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00772 
00774     <span class="comment">//                                                                      //</span>
00775     <span class="comment">//        Anonymous Use Test                                            //</span>
00776     <span class="comment">//                                                                      //</span>
00778 <span class="comment"></span>
00779 
00780     <span class="keywordflow">if</span> (!StaticTest) {
00781         <span class="comment">//</span>
00782         <span class="comment">// No action for dynamic test</span>
00783         <span class="comment">//</span>
00784 
00785         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00786     }
00787 
00788     <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"Se:        Anonymous Use ...                                     "</span>);
00789 
00790     <a class="code" href="../../d8/d0/ctlpcqos_8c.html#a34">SepServerWaitForNextConnect</a>();
00791 
00792     <a class="code" href="../../d8/d0/ctlpcqos_8c.html#a35">SepServerGetNextMessage</a>();
00793 
00794 
00795     <a class="code" href="../../d8/d0/ctlpcqos_8c.html#a42">SepServerImpersonateClient</a>();
00796     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d7/d3/tokenopn_8c.html#a3">NtOpenThreadToken</a>(
00797                  SepServerThread,
00798                  TOKEN_ALL_ACCESS,
00799                  TRUE,
00800                  &amp;ClientToken
00801                  );
00802     <a class="code" href="../../d8/d0/ctlpcqos_8c.html#a43">SepServerRevertToSelf</a>();
00803     <span class="keywordflow">if</span> (<a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> == STATUS_CANT_OPEN_ANONYMOUS) {
00804 
00805         <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">" Succeeded\n"</span>);
00806 
00807     } <span class="keywordflow">else</span> {
00808         <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"* ! FAILED (srvr) ! *\n"</span>);
00809         <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"Status is: 0x%lx \n"</span>, Status );
00810         CompletionStatus = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00811     }
00812 
00813 
00814     <a class="code" href="../../d8/d0/ctlpcqos_8c.html#a36">SepServerCompleteMessage</a>();
00815 
00816     <a class="code" href="../../d8/d0/ctlpcqos_8c.html#a37">SepServerDropConnection</a>();
00817 
00818     <span class="comment">//</span>
00819     <span class="comment">// Appease the compiler Gods..</span>
00820     <span class="comment">//</span>
00821 
00822     <span class="keywordflow">if</span> (EffectiveOnly) {;}
00823 
00824 
00825     <span class="keywordflow">return</span> CompletionStatus;
00826 
00827 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a33" doxytag="ctlnpqos.c::SepServerTestDynamic" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN SepServerTestDynamic           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00696">696</a> of file <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html">ctlnpqos.c</a>.
<p>
References <a class="el" href="../../d7/d5/memprint_8h-source.html#l00079">DbgPrint</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d8/d0/ctlpcqos_8c.html#a29">SepServerTestEffectiveOnly()</a>, <a class="el" href="../../d8/d0/ctlpcqos_8c.html#a30">SepServerTestNotEffectiveOnly()</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
<pre class="fragment"><div>00698 {
00699     BOOLEAN CompletionStatus;
00700 
00701     <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"Se:    Dynamic Context Tracking ...                          Suite\n"</span>);
00702 
00703     CompletionStatus = <a class="code" href="../../d8/d0/ctlpcqos_8c.html#a29">SepServerTestEffectiveOnly</a>( FALSE );
00704 
00705 
00706     <span class="keywordflow">if</span> (CompletionStatus == <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>) {
00707 
00708         CompletionStatus = <a class="code" href="../../d8/d0/ctlpcqos_8c.html#a30">SepServerTestNotEffectiveOnly</a>( FALSE );
00709     }
00710 
00711     <span class="keywordflow">return</span> CompletionStatus;
00712 
00713 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a34" doxytag="ctlnpqos.c::SepServerTestEffectiveOnly" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN SepServerTestEffectiveOnly           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">BOOLEAN&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>StaticTest</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00717">717</a> of file <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html">ctlnpqos.c</a>.
<p>
References <a class="el" href="../../d7/d5/memprint_8h-source.html#l00079">DbgPrint</a>, <a class="el" href="../../d8/d0/ctlpcqos_8c.html#a31">SepServerTestAnonymous()</a>, <a class="el" href="../../d8/d0/ctlpcqos_8c.html#a32">SepServerTestIdentification()</a>, <a class="el" href="../../d8/d0/ctlpcqos_8c.html#a33">SepServerTestImpersonation()</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
<pre class="fragment"><div>00721 {
00722 
00723     BOOLEAN CompletionStatus;
00724 
00725     <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"Se:      Effective Only ...                                    Test\n"</span>);
00726 
00727     CompletionStatus = <a class="code" href="../../d8/d0/ctlpcqos_8c.html#a31">SepServerTestAnonymous</a>( StaticTest, TRUE );
00728     <span class="keywordflow">if</span> (CompletionStatus == <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>) {
00729         CompletionStatus = <a class="code" href="../../d8/d0/ctlpcqos_8c.html#a32">SepServerTestIdentification</a>( StaticTest, TRUE );
00730     }
00731     <span class="keywordflow">if</span> (CompletionStatus == <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>) {
00732         CompletionStatus = <a class="code" href="../../d8/d0/ctlpcqos_8c.html#a33">SepServerTestImpersonation</a>( StaticTest, TRUE );
00733     }
00734 
00735     <span class="keywordflow">return</span> CompletionStatus;
00736 
00737 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a37" doxytag="ctlnpqos.c::SepServerTestIdentification" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN SepServerTestIdentification           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>StaticTest</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>EffectiveOnly</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00831">831</a> of file <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html">ctlnpqos.c</a>.
<p>
References <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00039">ClientToken</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00040">ClientTokenStatistics</a>, <a class="el" href="../../d7/d5/memprint_8h-source.html#l00079">DbgPrint</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00041">IgnoreLength</a>, <a class="el" href="../../d8/d2/tokenopn_8c-source.html#l00458">NtOpenThreadToken()</a>, <a class="el" href="../../d0/d3/tokenqry_8c-source.html#l00034">NtQueryInformationToken()</a>, <a class="el" href="../../d3/d5/tsecomm_8c-source.html#l00043">SEASSERT_SUCCESS</a>, <a class="el" href="../../d8/d0/ctlpcqos_8c.html#a36">SepServerCompleteMessage()</a>, <a class="el" href="../../d8/d0/ctlpcqos_8c.html#a37">SepServerDropConnection()</a>, <a class="el" href="../../d8/d0/ctlpcqos_8c.html#a35">SepServerGetNextMessage()</a>, <a class="el" href="../../d9/d9/ctlpcqos_8c-source.html#l00645">SepServerImpersonateClient()</a>, <a class="el" href="../../d9/d9/ctlpcqos_8c-source.html#l00658">SepServerRevertToSelf()</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00043">SepServerThread</a>, <a class="el" href="../../d8/d0/ctlpcqos_8c.html#a34">SepServerWaitForNextConnect()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00135">Status</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
<pre class="fragment"><div>00836 {
00837 
00838     BOOLEAN CompletionStatus = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00840     <span class="comment">//                                                                      //</span>
00841     <span class="comment">//        Identification Use Test                                       //</span>
00842     <span class="comment">//                                                                      //</span>
00844 <span class="comment"></span>
00845     <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"Se:        Identification Use ...                                "</span>);
00846 
00847     <a class="code" href="../../d8/d0/ctlpcqos_8c.html#a34">SepServerWaitForNextConnect</a>();
00848 
00849     <a class="code" href="../../d8/d0/ctlpcqos_8c.html#a35">SepServerGetNextMessage</a>();
00850 
00851     <a class="code" href="../../d8/d0/ctlpcqos_8c.html#a42">SepServerImpersonateClient</a>();
00852     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d7/d3/tokenopn_8c.html#a3">NtOpenThreadToken</a>(
00853                  SepServerThread,
00854                  TOKEN_ALL_ACCESS,
00855                  TRUE,
00856                  &amp;ClientToken
00857                  );  <a class="code" href="../../d2/d6/tsecomm_8c.html#a0">SEASSERT_SUCCESS</a>(Status);
00858     <a class="code" href="../../d8/d0/ctlpcqos_8c.html#a43">SepServerRevertToSelf</a>();
00859     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d9/d3/tokenqry_8c.html#a0">NtQueryInformationToken</a>(
00860                  ClientToken,
00861                  TokenStatistics,
00862                  &amp;ClientTokenStatistics,
00863                  (ULONG)<span class="keyword">sizeof</span>(TOKEN_STATISTICS),
00864                  &amp;IgnoreLength
00865                  );  <a class="code" href="../../d2/d6/tsecomm_8c.html#a0">SEASSERT_SUCCESS</a>(Status);
00866 
00867     <span class="keywordflow">if</span> ( (<a class="code" href="../../d7/d0/ctlnpqos_8c.html#a17">ClientTokenStatistics</a>.TokenType == TokenImpersonation) &amp;&amp;
00868          (<a class="code" href="../../d7/d0/ctlnpqos_8c.html#a17">ClientTokenStatistics</a>.ImpersonationLevel == SecurityIdentification)
00869        ) {
00870         <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">" Succeeded\n"</span>);
00871 
00872     } <span class="keywordflow">else</span> {
00873         <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"* ! FAILED (srvr) ! *\n"</span>);
00874         CompletionStatus = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00875     }
00876 
00877 
00878     <a class="code" href="../../d8/d0/ctlpcqos_8c.html#a36">SepServerCompleteMessage</a>();
00879 
00880     <a class="code" href="../../d8/d0/ctlpcqos_8c.html#a37">SepServerDropConnection</a>();
00881 
00882     <span class="comment">//</span>
00883     <span class="comment">// Appease the compiler Gods..</span>
00884     <span class="comment">//</span>
00885     <span class="keywordflow">if</span> (StaticTest) {;}
00886     <span class="keywordflow">if</span> (EffectiveOnly) {;}
00887 
00888     <span class="keywordflow">return</span> CompletionStatus;
00889 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a38" doxytag="ctlnpqos.c::SepServerTestImpersonation" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN SepServerTestImpersonation           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>StaticTest</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>EffectiveOnly</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00893">893</a> of file <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html">ctlnpqos.c</a>.
<p>
References <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00039">ClientToken</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00040">ClientTokenStatistics</a>, <a class="el" href="../../d7/d5/memprint_8h-source.html#l00079">DbgPrint</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00041">IgnoreLength</a>, <a class="el" href="../../d8/d2/tokenopn_8c-source.html#l00458">NtOpenThreadToken()</a>, <a class="el" href="../../d0/d3/tokenqry_8c-source.html#l00034">NtQueryInformationToken()</a>, <a class="el" href="../../d3/d5/tsecomm_8c-source.html#l00043">SEASSERT_SUCCESS</a>, <a class="el" href="../../d8/d0/ctlpcqos_8c.html#a36">SepServerCompleteMessage()</a>, <a class="el" href="../../d8/d0/ctlpcqos_8c.html#a37">SepServerDropConnection()</a>, <a class="el" href="../../d8/d0/ctlpcqos_8c.html#a35">SepServerGetNextMessage()</a>, <a class="el" href="../../d9/d9/ctlpcqos_8c-source.html#l00645">SepServerImpersonateClient()</a>, <a class="el" href="../../d9/d9/ctlpcqos_8c-source.html#l00658">SepServerRevertToSelf()</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00043">SepServerThread</a>, <a class="el" href="../../d8/d0/ctlpcqos_8c.html#a34">SepServerWaitForNextConnect()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00135">Status</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
<pre class="fragment"><div>00898 {
00899     BOOLEAN CompletionStatus = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00900 
00902     <span class="comment">//                                                                      //</span>
00903     <span class="comment">//        Impersonation Use Test                                        //</span>
00904     <span class="comment">//                                                                      //</span>
00906 <span class="comment"></span>
00907     <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"Se:        Impersonation Use ...                                 "</span>);
00908 
00909 
00910     <a class="code" href="../../d8/d0/ctlpcqos_8c.html#a34">SepServerWaitForNextConnect</a>();
00911 
00912     <a class="code" href="../../d8/d0/ctlpcqos_8c.html#a35">SepServerGetNextMessage</a>();
00913 
00914 
00915 
00916     <a class="code" href="../../d8/d0/ctlpcqos_8c.html#a42">SepServerImpersonateClient</a>();
00917     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d7/d3/tokenopn_8c.html#a3">NtOpenThreadToken</a>(
00918                  SepServerThread,
00919                  TOKEN_ALL_ACCESS,
00920                  TRUE,
00921                  &amp;ClientToken
00922                  );  <a class="code" href="../../d2/d6/tsecomm_8c.html#a0">SEASSERT_SUCCESS</a>(Status);
00923     <a class="code" href="../../d8/d0/ctlpcqos_8c.html#a43">SepServerRevertToSelf</a>();
00924     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d9/d3/tokenqry_8c.html#a0">NtQueryInformationToken</a>(
00925                  ClientToken,
00926                  TokenStatistics,
00927                  &amp;ClientTokenStatistics,
00928                  (ULONG)<span class="keyword">sizeof</span>(TOKEN_STATISTICS),
00929                  &amp;IgnoreLength
00930                  );  <a class="code" href="../../d2/d6/tsecomm_8c.html#a0">SEASSERT_SUCCESS</a>(Status);
00931 
00932     <span class="keywordflow">if</span> ( (<a class="code" href="../../d7/d0/ctlnpqos_8c.html#a17">ClientTokenStatistics</a>.TokenType == TokenImpersonation) &amp;&amp;
00933          (<a class="code" href="../../d7/d0/ctlnpqos_8c.html#a17">ClientTokenStatistics</a>.ImpersonationLevel == SecurityImpersonation)
00934        ) {
00935         <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">" Succeeded\n"</span>);
00936 
00937     } <span class="keywordflow">else</span> {
00938         <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"* ! FAILED (srvr) ! *\n"</span>);
00939         CompletionStatus = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00940     }
00941 
00942 
00943 
00944 
00945     <a class="code" href="../../d8/d0/ctlpcqos_8c.html#a36">SepServerCompleteMessage</a>();
00946 
00947     <a class="code" href="../../d8/d0/ctlpcqos_8c.html#a37">SepServerDropConnection</a>();
00948 
00949     <span class="comment">//</span>
00950     <span class="comment">// Appease the compiler gods</span>
00951     <span class="comment">//</span>
00952     <span class="keywordflow">if</span> (StaticTest) {;}
00953     <span class="keywordflow">if</span> (EffectiveOnly) {;}
00954 
00955     <span class="keywordflow">return</span> CompletionStatus;
00956 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a35" doxytag="ctlnpqos.c::SepServerTestNotEffectiveOnly" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN SepServerTestNotEffectiveOnly           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">BOOLEAN&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>StaticTest</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00741">741</a> of file <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html">ctlnpqos.c</a>.
<p>
References <a class="el" href="../../d7/d5/memprint_8h-source.html#l00079">DbgPrint</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d8/d0/ctlpcqos_8c.html#a31">SepServerTestAnonymous()</a>, <a class="el" href="../../d8/d0/ctlpcqos_8c.html#a32">SepServerTestIdentification()</a>, <a class="el" href="../../d8/d0/ctlpcqos_8c.html#a33">SepServerTestImpersonation()</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
<pre class="fragment"><div>00745 {
00746 
00747     BOOLEAN CompletionStatus;
00748 
00749     <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"Se:      Not Effective Only ...                                Test\n"</span>);
00750 
00751     CompletionStatus = <a class="code" href="../../d8/d0/ctlpcqos_8c.html#a31">SepServerTestAnonymous</a>( StaticTest, FALSE );
00752     <span class="keywordflow">if</span> (CompletionStatus == <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>) {
00753         CompletionStatus = <a class="code" href="../../d8/d0/ctlpcqos_8c.html#a32">SepServerTestIdentification</a>( StaticTest, FALSE );
00754     }
00755     <span class="keywordflow">if</span> (CompletionStatus == <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>) {
00756         CompletionStatus = <a class="code" href="../../d8/d0/ctlpcqos_8c.html#a33">SepServerTestImpersonation</a>( StaticTest, FALSE );
00757     }
00758 
00759     <span class="keywordflow">return</span> CompletionStatus;
00760 
00761 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a32" doxytag="ctlnpqos.c::SepServerTestStatic" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN SepServerTestStatic           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00675">675</a> of file <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html">ctlnpqos.c</a>.
<p>
References <a class="el" href="../../d7/d5/memprint_8h-source.html#l00079">DbgPrint</a>, <a class="el" href="../../d8/d0/ctlpcqos_8c.html#a29">SepServerTestEffectiveOnly()</a>, <a class="el" href="../../d8/d0/ctlpcqos_8c.html#a30">SepServerTestNotEffectiveOnly()</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
<pre class="fragment"><div>00677 {
00678     BOOLEAN CompletionStatus;
00679 
00680     <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"Se:    Static Context Tracking ...                           Suite\n"</span>);
00681 
00682     CompletionStatus = <a class="code" href="../../d8/d0/ctlpcqos_8c.html#a29">SepServerTestEffectiveOnly</a>( TRUE );
00683 
00684 
00685     <span class="keywordflow">if</span> (CompletionStatus == <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>) {
00686 
00687         CompletionStatus = <a class="code" href="../../d8/d0/ctlpcqos_8c.html#a30">SepServerTestNotEffectiveOnly</a>( TRUE );
00688     }
00689 
00690     <span class="keywordflow">return</span> CompletionStatus;
00691 
00692 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a39" doxytag="ctlnpqos.c::SepServerWaitForNextConnect" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID SepServerWaitForNextConnect           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00588">588</a> of file <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html">ctlnpqos.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00008">DevPrint</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00035">EarPort</a>, <a class="el" href="../../d6/d5/stierr_8h-source.html#l00030">NT_SUCCESS</a>, <a class="el" href="../../d0/d0/obhandle_8c-source.html#l00163">NtDuplicateObject()</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l01443">SepServerListenPipe()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00135">Status</a>, and <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00036">TalkPort</a>.
<p>
<pre class="fragment"><div>00589 {
00590 
00591     <a class="code" href="../../d7/d0/ctlnpqos_8c.html#a0">DevPrint</a>(<span class="stringliteral">"\nServer: "</span>);
00592     <a class="code" href="../../d7/d0/ctlnpqos_8c.html#a58">SepServerListenPipe</a>();
00593 
00594     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d9/d0/obhandle_8c.html#a4">NtDuplicateObject</a>(
00595                  NtCurrentProcess(),     <span class="comment">// SourceProcessHandle</span>
00596                  EarPort,                <span class="comment">// SourceHandle</span>
00597                  NtCurrentProcess(),     <span class="comment">// TargetProcessHandle</span>
00598                  &amp;TalkPort,              <span class="comment">// TargetHandle</span>
00599                  0,                      <span class="comment">// DesiredAccess (over-ridden by option)</span>
00600                  0,                      <span class="comment">// HandleAttributes</span>
00601                  DUPLICATE_SAME_ACCESS   <span class="comment">// Options</span>
00602                  );
00603     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status));
00604 
00605 
00606     <span class="keywordflow">return</span>;
00607 
00608 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a48" doxytag="ctlnpqos.c::SepTransceivePipe" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID SepTransceivePipe           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">PSZ&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>String</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l01330">1330</a> of file <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html">ctlnpqos.c</a>.
<p>
References <a class="el" href="../../d7/d1/rtqkey_8c-source.html#l00042">Buffer</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00008">DevPrint</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00011">Error</a>, <a class="el" href="../../d6/d5/stierr_8h-source.html#l00030">NT_SUCCESS</a>, <a class="el" href="../../d9/d6/io_2fsctrl_8c-source.html#l00034">NtFsControlFile()</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d2/d1/obwait_8c-source.html#l00282">NtWaitForSingleObject()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00135">Status</a>, <a class="el" href="../../d5/d8/talloc_8c-source.html#l00027">String</a>, <a class="el" href="../../d2/d7/regtest_8c.html#a2">strlen()</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00036">TalkPort</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00238">SepClientMakeRemoteCall()</a>.
<p>
<pre class="fragment"><div>01333 {
01334     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
01335     IO_STATUS_BLOCK Iosb;
01336     UCHAR <a class="code" href="../../d6/d2/rtqkey_8c.html#a3">Buffer</a>[512];
01337 
01338 
01339     <a class="code" href="../../d7/d0/ctlnpqos_8c.html#a0">DevPrint</a>(<span class="stringliteral">"TransceivePipe...\n"</span>, 0);
01340 
01341     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status = <a class="code" href="../../d8/d7/io_2fsctrl_8c.html#a0">NtFsControlFile</a>(
01342                                 TalkPort,
01343                                 NULL,   <span class="comment">// Event</span>
01344                                 NULL,   <span class="comment">// ApcRoutine</span>
01345                                 NULL,   <span class="comment">// ApcContext</span>
01346                                 &amp;Iosb,
01347                                 FSCTL_PIPE_TRANSCEIVE,
01348                                 String,
01349                                 <a class="code" href="../../d2/d7/regtest_8c.html#a2">strlen</a>( String ),
01350                                 Buffer,
01351                                 511
01352                                 ))) {
01353         <a class="code" href="../../d7/d0/ctlnpqos_8c.html#a1">Error</a>( NtTransceiveFile, Status );
01354     }
01355 
01356     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status = <a class="code" href="../../d1/d2/obwait_8c.html#a4">NtWaitForSingleObject</a>( TalkPort, TRUE, NULL ))) {
01357 
01358         <a class="code" href="../../d7/d0/ctlnpqos_8c.html#a1">Error</a>( NtWaitForSingleObject, Status );
01359     }
01360 
01361     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Iosb.Status)) {
01362 
01363         <a class="code" href="../../d7/d0/ctlnpqos_8c.html#a1">Error</a>( NtTransceiveFileFinalStatus, Iosb.Status );
01364     }
01365 
01366     <span class="keywordflow">return</span>;
01367 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a46" doxytag="ctlnpqos.c::SepWritePipe" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID SepWritePipe           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">PSZ&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>String</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l01293">1293</a> of file <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html">ctlnpqos.c</a>.
<p>
References <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00008">DevPrint</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00011">Error</a>, <a class="el" href="../../d6/d5/stierr_8h-source.html#l00030">NT_SUCCESS</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d2/d1/obwait_8c-source.html#l00282">NtWaitForSingleObject()</a>, <a class="el" href="../../d1/d9/io_2write_8c-source.html#l00035">NtWriteFile()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00135">Status</a>, <a class="el" href="../../d5/d8/talloc_8c-source.html#l00027">String</a>, <a class="el" href="../../d2/d7/regtest_8c.html#a2">strlen()</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00036">TalkPort</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00626">SepServerCompleteMessage()</a>.
<p>
<pre class="fragment"><div>01296 {
01297     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
01298     IO_STATUS_BLOCK Iosb;
01299 
01300 
01301     <a class="code" href="../../d7/d0/ctlnpqos_8c.html#a0">DevPrint</a>(<span class="stringliteral">"WritePipe...\n"</span>, 0);
01302 
01303     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status = <a class="code" href="../../d0/d0/io_2write_8c.html#a0">NtWriteFile</a>( TalkPort,
01304                                        (HANDLE)NULL,
01305                                        (PIO_APC_ROUTINE)NULL,
01306                                        (PVOID)NULL,
01307                                        &amp;Iosb,
01308                                        String,
01309                                        <a class="code" href="../../d2/d7/regtest_8c.html#a2">strlen</a>( String ),
01310                                        (PLARGE_INTEGER)NULL,
01311                                        (PULONG)NULL ))) {
01312         <a class="code" href="../../d7/d0/ctlnpqos_8c.html#a1">Error</a>( NtWriteFile, Status );
01313     }
01314 
01315     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status = <a class="code" href="../../d1/d2/obwait_8c.html#a4">NtWaitForSingleObject</a>( TalkPort, TRUE, NULL ))) {
01316 
01317         <a class="code" href="../../d7/d0/ctlnpqos_8c.html#a1">Error</a>( NtWaitForSingleObject, Status );
01318     }
01319 
01320     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Iosb.Status)) {
01321 
01322         <a class="code" href="../../d7/d0/ctlnpqos_8c.html#a1">Error</a>( NtWriteFileFinalStatus, Iosb.Status );
01323     }
01324 
01325     <span class="keywordflow">return</span>;
01326 }
</div></pre>    </td>
  </tr>
</table>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="a16" doxytag="ctlnpqos.c::ClientToken" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HANDLE <a class="el" href="../../d8/d0/ctlpcqos_8c.html#a11">ClientToken</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00039">39</a> of file <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html">ctlnpqos.c</a>.
<p>
Referenced by <a class="el" href="../../d1/d3/accessck_8c-source.html#l02413">NtAccessCheck()</a>, <a class="el" href="../../d1/d3/accessck_8c-source.html#l02501">NtAccessCheckByType()</a>, <a class="el" href="../../d1/d3/accessck_8c-source.html#l02602">NtAccessCheckByTypeResultList()</a>, <a class="el" href="../../d4/d4/seaudit_8c-source.html#l02007">NtAccessCheckByTypeResultListAndAuditAlarmByHandle()</a>, <a class="el" href="../../d4/d4/seaudit_8c-source.html#l02072">NtOpenObjectAuditAlarm()</a>, <a class="el" href="../../d9/d3/privileg_8c-source.html#l00231">NtPrivilegeCheck()</a>, <a class="el" href="../../d4/d4/seaudit_8c-source.html#l00731">NtPrivilegedServiceAuditAlarm()</a>, <a class="el" href="../../d4/d4/seaudit_8c-source.html#l00406">NtPrivilegeObjectAuditAlarm()</a>, <a class="el" href="../../d9/d5/sertl_8c-source.html#l08795">RtlpGetDefaultsSubjectContext()</a>, <a class="el" href="../../d1/d3/accessck_8c-source.html#l02704">SeAccessCheckByType()</a>, <a class="el" href="../../d7/d2/tokendup_8c-source.html#l01227">SeCopyClientToken()</a>, <a class="el" href="../../d1/d3/accessck_8c-source.html#l01564">SepAccessCheck()</a>, <a class="el" href="../../d4/d4/seaudit_8c-source.html#l01050">SepAccessCheckAndAuditAlarm()</a>, <a class="el" href="../../d8/d5/sepaudit_8c-source.html#l01907">SepAdtObjectReferenceAuditAlarm()</a>, <a class="el" href="../../d8/d5/sepaudit_8c-source.html#l00571">SepAdtOpenObjectAuditAlarm()</a>, <a class="el" href="../../d8/d5/sepaudit_8c-source.html#l01003">SepAdtOpenObjectForDeleteAuditAlarm()</a>, <a class="el" href="../../d8/d5/sepaudit_8c-source.html#l00346">SepAdtPrivilegedServiceAuditAlarm()</a>, <a class="el" href="../../d8/d5/sepaudit_8c-source.html#l00125">SepAdtPrivilegeObjectAuditAlarm()</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00765">SepServerTestAnonymous()</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00831">SepServerTestIdentification()</a>, and <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00893">SepServerTestImpersonation()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a17" doxytag="ctlnpqos.c::ClientTokenStatistics" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> TOKEN_STATISTICS <a class="el" href="../../d8/d0/ctlpcqos_8c.html#a12">ClientTokenStatistics</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00040">40</a> of file <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html">ctlnpqos.c</a>.
<p>
Referenced by <a class="el" href="../../d5/d7/seurtl_8c-source.html#l00680">RtlNewInstanceSecurityObject()</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00831">SepServerTestIdentification()</a>, and <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00893">SepServerTestImpersonation()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a12" doxytag="ctlnpqos.c::EarPort" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HANDLE <a class="el" href="../../d8/d0/ctlpcqos_8c.html#a6">EarPort</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00035">35</a> of file <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html">ctlnpqos.c</a>.
<p>
Referenced by <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l01520">SepServerDisconnectPipe()</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l01028">SepServerInitialize()</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l01443">SepServerListenPipe()</a>, and <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00588">SepServerWaitForNextConnect()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a7" doxytag="ctlnpqos.c::EventHandle" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HANDLE <a class="el" href="../../d8/d0/ctlpcqos_8c.html#a4">EventHandle</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00030">30</a> of file <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html">ctlnpqos.c</a>.
<p>
Referenced by <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l01165">CtLnpQos()</a>, <a class="el" href="../../d9/d9/ctlpcqos_8c-source.html#l01187">CtLpcQos()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l05299">IoCreateNotificationEvent()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l05733">IoCreateSynchronizationEvent()</a>, <a class="el" href="../../d6/d1/rtnotify_8c-source.html#l00080">main()</a>, <a class="el" href="../../d1/d7/ex_2event_8c-source.html#l00126">NtClearEvent()</a>, <a class="el" href="../../d1/d7/ex_2event_8c-source.html#l00180">NtCreateEvent()</a>, <a class="el" href="../../d1/d7/ex_2event_8c-source.html#l00313">NtOpenEvent()</a>, <a class="el" href="../../d1/d7/ex_2event_8c-source.html#l00412">NtPulseEvent()</a>, <a class="el" href="../../d1/d7/ex_2event_8c-source.html#l00514">NtQueryEvent()</a>, <a class="el" href="../../d1/d7/ex_2event_8c-source.html#l00648">NtResetEvent()</a>, <a class="el" href="../../d1/d7/ex_2event_8c-source.html#l00748">NtSetEvent()</a>, <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l02264">NtSetSystemInformation()</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00553">SepClientInitialize()</a>, and <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l01028">SepServerInitialize()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a5" doxytag="ctlnpqos.c::EventName" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> STRING <a class="el" href="../../d8/d0/ctlpcqos_8c.html#a2">EventName</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00028">28</a> of file <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html">ctlnpqos.c</a>.
<p>
Referenced by <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l01165">CtLnpQos()</a>, <a class="el" href="../../d9/d9/ctlpcqos_8c-source.html#l01187">CtLpcQos()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l05299">IoCreateNotificationEvent()</a>, and <a class="el" href="../../d5/d5/iosubs_8c-source.html#l05733">IoCreateSynchronizationEvent()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a18" doxytag="ctlnpqos.c::IgnoreLength" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG <a class="el" href="../../d8/d0/ctlpcqos_8c.html#a13">IgnoreLength</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00041">41</a> of file <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html">ctlnpqos.c</a>.
<p>
Referenced by <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00831">SepServerTestIdentification()</a>, and <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00893">SepServerTestImpersonation()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a4" doxytag="ctlnpqos.c::ObjectAttributes" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> OBJECT_ATTRIBUTES <a class="el" href="../../d8/d0/ctlpcqos_8c.html#a1">ObjectAttributes</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00027">27</a> of file <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html">ctlnpqos.c</a>.
<p>
Referenced by <a class="el" href="../../d2/d2/cmsysini_8c-source.html#l02169">CmGetSystemDriverList()</a>, <a class="el" href="../../d2/d2/cmsysini_8c-source.html#l00293">CmInitSystem1()</a>, <a class="el" href="../../d7/d0/cmhvlist_8c-source.html#l00042">CmpAddToHiveFileList()</a>, <a class="el" href="../../d2/d2/cmsysini_8c-source.html#l04234">CmpCreatePredefined()</a>, <a class="el" href="../../d2/d2/cmsysini_8c-source.html#l01165">CmpCreateRegistryRoot()</a>, <a class="el" href="../../d5/d9/cmconfig_8c-source.html#l00087">CmpInitializeHardwareConfiguration()</a>, <a class="el" href="../../d5/d0/config_2alpha_2init_8c-source.html#l00037">CmpInitializeMachineDependentConfiguration()</a>, <a class="el" href="../../d5/d9/cmconfig_8c-source.html#l00458">CmpInitializeRegistryNode()</a>, <a class="el" href="../../d2/d2/cmsysini_8c-source.html#l01421">CmpLinkHiveToMaster()</a>, <a class="el" href="../../d9/d0/cminit_8c-source.html#l00046">CmpOpenHiveFiles()</a>, <a class="el" href="../../d7/d0/cmhvlist_8c-source.html#l00188">CmpRemoveFromHiveFileList()</a>, <a class="el" href="../../d2/d2/cmsysini_8c-source.html#l01545">CmpSetVersionData()</a>, <a class="el" href="../../d7/d2/rttrecpy_8c-source.html#l00114">Copy()</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l01165">CtLnpQos()</a>, <a class="el" href="../../d9/d9/ctlpcqos_8c-source.html#l01187">CtLpcQos()</a>, <a class="el" href="../../d1/d0/rtdeltre_8c-source.html#l00103">Delete()</a>, <a class="el" href="../../d5/d9/tex_8c-source.html#l01445">DoPartyTest()</a>, <a class="el" href="../../d3/d0/rtdmp_8c-source.html#l00126">Dump()</a>, <a class="el" href="../../d2/d0/hivedmp_8c-source.html#l00163">DumpKeys()</a>, <a class="el" href="../../d8/d8/uob_8c-source.html#l00039">DumpObjectDirs()</a>, <a class="el" href="../../d0/d4/edithive_8c-source.html#l00156">EhOpenHive()</a>, <a class="el" href="../../d3/d3/ex_2callback_8c-source.html#l00222">ExCreateCallback()</a>, <a class="el" href="../../d2/d8/worker_8c-source.html#l00971">ExpCreateWorkerThread()</a>, <a class="el" href="../../d2/d8/worker_8c-source.html#l00853">ExpDetectWorkerThreadDeadlock()</a>, <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l00666">ExpGetCurrentUserUILanguage()</a>, <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l00486">ExpGetUILanguagePolicy()</a>, <a class="el" href="../../d3/d3/ex_2callback_8c-source.html#l00101">ExpInitializeCallbacks()</a>, <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l00585">ExpSetCurrentUserUILanguage()</a>, <a class="el" href="../../d4/d2/uuid_8c-source.html#l00137">ExpUuidLoadSequenceNumber()</a>, <a class="el" href="../../d4/d2/uuid_8c-source.html#l00220">ExpUuidSaveSequenceNumber()</a>, <a class="el" href="../../d2/d8/worker_8c-source.html#l00220">ExpWorkerInitialization()</a>, <a class="el" href="../../d5/d7/fsrtlpc_8c-source.html#l00323">FsRtlGetCompatibilityModeValue()</a>, <a class="el" href="../../d2/d6/tunnel_8c-source.html#l01371">FsRtlGetTunnelParameterValue()</a>, <a class="el" href="../../d5/d4/stackovf_8c-source.html#l00099">FsRtlInitializeWorkerThread()</a>, <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l01417">InitCreateObjectDirectory()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l04502">IoCreateFile()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l06463">IoFastQueryNetworkAttributes()</a>, <a class="el" href="../../d3/d2/dumpctl_8c-source.html#l00384">IopGetDumpStack()</a>, <a class="el" href="../../d0/d5/ioinit_8c-source.html#l02272">IopInitializeAttributesAndCreateObject()</a>, <a class="el" href="../../d0/d3/ke_2i386_2vdm_8c-source.html#l01088">KeI386VdmInitialize()</a>, <a class="el" href="../../d7/d8/kernlini_8c-source.html#l02008">KeSetup80387OrEmulate()</a>, <a class="el" href="../../d7/d8/kernlini_8c-source.html#l02297">KiMoveRegTree()</a>, <a class="el" href="../../d2/d2/ldrrsrc_8c-source.html#l01563">LdrLoadAlternateResourceModule()</a>, <a class="el" href="../../d3/d2/ldrsnap_8c-source.html#l00832">LdrpCheckForLoadedDll()</a>, <a class="el" href="../../d3/d2/ldrsnap_8c-source.html#l02150">LdrpCreateDllSection()</a>, <a class="el" href="../../d9/d1/ldrinit_8c-source.html#l01796">LdrQueryImageFileExecutionOptions()</a>, <a class="el" href="../../d7/d5/lpccreat_8c-source.html#l00136">LpcpCreatePort()</a>, <a class="el" href="../../d9/d9/rtbatcr_8c-source.html#l00071">main()</a>, <a class="el" href="../../d7/d2/modwrite_8c-source.html#l01338">MiCrashDumpWorker()</a>, <a class="el" href="../../d9/d7/sysload_8c-source.html#l00443">MiLoadSystemImage()</a>, <a class="el" href="../../d7/d2/modwrite_8c-source.html#l02669">MiModifiedPageWriter()</a>, <a class="el" href="../../d6/d4/sectsup_8c-source.html#l00768">MiSectionInitialization()</a>, <a class="el" href="../../d1/d7/creasect_8c-source.html#l00390">MmCreateSection()</a>, <a class="el" href="../../d6/d0/mminit_8c-source.html#l00184">MmInitSystem()</a>, <a class="el" href="../../d8/d7/ntnap_8c-source.html#l00164">NapCreateDataSection()</a>, <a class="el" href="../../d5/d5/channel_8c-source.html#l00101">NtCreateChannel()</a>, <a class="el" href="../../d9/d9/obdir_8c-source.html#l00032">NtCreateDirectoryObject()</a>, <a class="el" href="../../d1/d7/ex_2event_8c-source.html#l00180">NtCreateEvent()</a>, <a class="el" href="../../d4/d7/eventpr_8c-source.html#l00131">NtCreateEventPair()</a>, <a class="el" href="../../d2/d7/io_2create_8c-source.html#l00037">NtCreateFile()</a>, <a class="el" href="../../d6/d3/complete_8c-source.html#l00051">NtCreateIoCompletion()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l00048">NtCreateJobObject()</a>, <a class="el" href="../../d8/d6/ntapi_8c-source.html#l00166">NtCreateKey()</a>, <a class="el" href="../../d2/d7/io_2create_8c-source.html#l00285">NtCreateMailslotFile()</a>, <a class="el" href="../../d3/d4/mutant_8c-source.html#l00156">NtCreateMutant()</a>, <a class="el" href="../../d2/d7/io_2create_8c-source.html#l00125">NtCreateNamedPipeFile()</a>, <a class="el" href="../../d7/d5/lpccreat_8c-source.html#l00045">NtCreatePort()</a>, <a class="el" href="../../d3/d7/ps_2create_8c-source.html#l00843">NtCreateProcess()</a>, <a class="el" href="../../d0/d6/ex_2profile_8c-source.html#l00199">NtCreateProfile()</a>, <a class="el" href="../../d1/d7/creasect_8c-source.html#l00134">NtCreateSection()</a>, <a class="el" href="../../d3/d5/semphore_8c-source.html#l00123">NtCreateSemaphore()</a>, <a class="el" href="../../d2/d7/super_8c-source.html#l00056">NtCreateSuperSection()</a>, <a class="el" href="../../d5/d0/oblink_8c-source.html#l00052">NtCreateSymbolicLinkObject()</a>, <a class="el" href="../../d3/d7/ps_2create_8c-source.html#l00067">NtCreateThread()</a>, <a class="el" href="../../d3/d1/timer_8c-source.html#l00444">NtCreateTimer()</a>, <a class="el" href="../../d5/d2/token_8c-source.html#l01690">NtCreateToken()</a>, <a class="el" href="../../d7/d5/lpccreat_8c-source.html#l00087">NtCreateWaitablePort()</a>, <a class="el" href="../../d2/d9/io_2misc_8c-source.html#l00298">NtDeleteFile()</a>, <a class="el" href="../../d7/d2/tokendup_8c-source.html#l00046">NtDuplicateToken()</a>, <a class="el" href="../../d5/d5/channel_8c-source.html#l00348">NtOpenChannel()</a>, <a class="el" href="../../d9/d9/obdir_8c-source.html#l00144">NtOpenDirectoryObject()</a>, <a class="el" href="../../d1/d7/ex_2event_8c-source.html#l00313">NtOpenEvent()</a>, <a class="el" href="../../d4/d7/eventpr_8c-source.html#l00251">NtOpenEventPair()</a>, <a class="el" href="../../d5/d1/open_8c-source.html#l00034">NtOpenFile()</a>, <a class="el" href="../../d6/d3/complete_8c-source.html#l00178">NtOpenIoCompletion()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l00188">NtOpenJobObject()</a>, <a class="el" href="../../d8/d6/ntapi_8c-source.html#l01870">NtOpenKey()</a>, <a class="el" href="../../d3/d4/mutant_8c-source.html#l00280">NtOpenMutant()</a>, <a class="el" href="../../d8/d0/psopen_8c-source.html#l00030">NtOpenProcess()</a>, <a class="el" href="../../d1/d7/creasect_8c-source.html#l04250">NtOpenSection()</a>, <a class="el" href="../../d3/d5/semphore_8c-source.html#l00260">NtOpenSemaphore()</a>, <a class="el" href="../../d2/d7/super_8c-source.html#l00237">NtOpenSuperSection()</a>, <a class="el" href="../../d5/d0/oblink_8c-source.html#l00247">NtOpenSymbolicLinkObject()</a>, <a class="el" href="../../d8/d0/psopen_8c-source.html#l00280">NtOpenThread()</a>, <a class="el" href="../../d8/d2/tokenopn_8c-source.html#l00458">NtOpenThreadToken()</a>, <a class="el" href="../../d3/d1/timer_8c-source.html#l00581">NtOpenTimer()</a>, <a class="el" href="../../d2/d9/io_2misc_8c-source.html#l00629">NtQueryAttributesFile()</a>, <a class="el" href="../../d2/d9/io_2misc_8c-source.html#l00745">NtQueryFullAttributesFile()</a>, <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l00258">NtSetDefaultLocale()</a>, <a class="el" href="../../d7/d9/obcreate_8c-source.html#l00055">ObCreateObject()</a>, <a class="el" href="../../d1/d0/obinit_8c-source.html#l00117">ObInitSystem()</a>, <a class="el" href="../../d8/d0/obref_8c-source.html#l00095">ObOpenObjectByName()</a>, <a class="el" href="../../d7/d9/obcreate_8c-source.html#l00248">ObpCaptureObjectCreateInformation()</a>, <a class="el" href="../../d1/d0/obinit_8c-source.html#l01349">ObpCreateDosDevicesDirectory()</a>, <a class="el" href="../../d6/d8/w32_2ntuser_2kernel_2pnp_8c-source.html#l00807">OpenDevice()</a>, <a class="el" href="../../d3/d7/ps_2create_8c-source.html#l00915">PsCreateSystemProcess()</a>, <a class="el" href="../../d3/d7/ps_2create_8c-source.html#l00175">PsCreateSystemThread()</a>, <a class="el" href="../../d1/d0/psinit_8c-source.html#l00525">PsLocateSystemDll()</a>, <a class="el" href="../../d3/d7/ps_2create_8c-source.html#l00969">PspCreateProcess()</a>, <a class="el" href="../../d3/d7/ps_2create_8c-source.html#l00262">PspCreateThread()</a>, <a class="el" href="../../d1/d0/psinit_8c-source.html#l00181">PspInitPhase0()</a>, <a class="el" href="../../d4/d6/config_2utils_2regutil_8c-source.html#l00259">RegLoadAsciiFileAsUnicode()</a>, <a class="el" href="../../d4/d6/config_2utils_2regutil_8c-source.html#l00158">RegReadBinaryFile()</a>, <a class="el" href="../../d5/d0/hiveini_8c-source.html#l00031">RiInitializeRegistryFromAsciiFile()</a>, <a class="el" href="../../d1/d1/rtlexec_8c-source.html#l00813">RtlCreateUserProcess()</a>, <a class="el" href="../../d1/d1/rtlexec_8c-source.html#l01241">RtlCreateUserThread()</a>, <a class="el" href="../../d6/d4/prodtype_8c-source.html#l00030">RtlGetNtProductType()</a>, <a class="el" href="../../d9/d5/sertl_8c-source.html#l03446">RtlImpersonateSelf()</a>, <a class="el" href="../../d2/d2/dll_2query_8c-source.html#l00099">RtlpChangeQueryDebugBufferTarget()</a>, <a class="el" href="../../d5/d6/rtl_2regutil_8c-source.html#l00092">RtlpGetRegistryHandle()</a>, <a class="el" href="../../d2/d6/rtl_2registry_8c-source.html#l00139">RtlpNtCreateKey()</a>, <a class="el" href="../../d2/d6/rtl_2registry_8c-source.html#l00070">RtlpNtOpenKey()</a>, <a class="el" href="../../d1/d1/rtlexec_8c-source.html#l00493">RtlpOpenImageFile()</a>, <a class="el" href="../../d5/d6/rtl_2regutil_8c-source.html#l00744">RtlQueryRegistryValues()</a>, <a class="el" href="../../d3/d4/se_2capture_8c-source.html#l00953">SeCaptureSecurityQos()</a>, <a class="el" href="../../d7/d2/tokendup_8c-source.html#l01227">SeCopyClientToken()</a>, <a class="el" href="../../d0/d4/adtinit_8c-source.html#l00117">SepAdtInitializeBounds()</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l01582">SepClientOpenPipe()</a>, <a class="el" href="../../d5/d2/token_8c-source.html#l02213">SepCreateToken()</a>, <a class="el" href="../../d7/d2/tokendup_8c-source.html#l00362">SepDuplicateToken()</a>, <a class="el" href="../../d0/d5/seinit_8c-source.html#l00184">SepInitializationPhase1()</a>, <a class="el" href="../../d1/d9/rmmain_8c-source.html#l00466">SepRmCommandServerThreadInit()</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l01377">SepServerCreatePipe()</a>, <a class="el" href="../../d1/d9/rmmain_8c-source.html#l00060">SeRmInitPhase1()</a>, <a class="el" href="../../d8/d8/uob_8c-source.html#l00624">TestChild()</a>, <a class="el" href="../../d8/d8/uob_8c-source.html#l00232">TestParent()</a>, <a class="el" href="../../d1/d0/base_8c-source.html#l00102">UserBeep()</a>, <a class="el" href="../../d8/d3/vdminit_8c-source.html#l00019">VdmpInitialize()</a>, <a class="el" href="../../d0/d6/desktop_8c-source.html#l01343">xxxCreateDesktop2()</a>, <a class="el" href="../../d9/d7/winsta_8c-source.html#l00243">xxxCreateWindowStation()</a>, <a class="el" href="../../d7/d8/restrfil_8c-source.html#l00418">ZwCreateFile()</a>, <a class="el" href="../../d7/d8/restrfil_8c-source.html#l00655">ZwDeleteFile()</a>, <a class="el" href="../../d7/d8/restrfil_8c-source.html#l00582">ZwOpenFile()</a>, and <a class="el" href="../../d7/d8/restrfil_8c-source.html#l00729">ZwQueryAttributesFile()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a8" doxytag="ctlnpqos.c::PortName" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> STRING <a class="el" href="../../d8/d0/ctlpcqos_8c.html#a5">PortName</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00031">31</a> of file <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html">ctlnpqos.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a10" doxytag="ctlnpqos.c::RelativePortName" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> STRING <a class="el" href="../../d7/d0/ctlnpqos_8c.html#a10">RelativePortName</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00033">33</a> of file <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html">ctlnpqos.c</a>.
<p>
Referenced by <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l01165">CtLnpQos()</a>, and <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l01582">SepClientOpenPipe()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a15" doxytag="ctlnpqos.c::RequestCount" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG <a class="el" href="../../d8/d0/ctlpcqos_8c.html#a10">RequestCount</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00038">38</a> of file <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html">ctlnpqos.c</a>.
<p>
Referenced by <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00553">SepClientInitialize()</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00238">SepClientMakeRemoteCall()</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00611">SepServerGetNextMessage()</a>, and <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l01028">SepServerInitialize()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a14" doxytag="ctlnpqos.c::SecurityQos" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> SECURITY_QUALITY_OF_SERVICE <a class="el" href="../../d8/d0/ctlpcqos_8c.html#a9">SecurityQos</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00037">37</a> of file <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html">ctlnpqos.c</a>.
<p>
Referenced by <a class="el" href="../../d5/d2/parse_8c-source.html#l00202">IopParseDevice()</a>, <a class="el" href="../../d5/d2/parse_8c-source.html#l01690">IopParseFile()</a>, <a class="el" href="../../d6/d5/lpcconn_8c-source.html#l00043">NtConnectPort()</a>, <a class="el" href="../../d7/d2/tokendup_8c-source.html#l00046">NtDuplicateToken()</a>, <a class="el" href="../../d0/d0/psimpers_8c-source.html#l00026">NtImpersonateThread()</a>, <a class="el" href="../../d6/d5/lpcconn_8c-source.html#l00084">NtSecureConnectPort()</a>, <a class="el" href="../../d7/d9/obcreate_8c-source.html#l00248">ObpCaptureObjectCreateInformation()</a>, <a class="el" href="../../d9/d9/obdir_8c-source.html#l01081">ObpLookupObjectName()</a>, <a class="el" href="../../d3/d4/se_2capture_8c-source.html#l00910">SeFreeCapturedSecurityQos()</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00218">SepClientConnect()</a>, and <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l01582">SepClientOpenPipe()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a19" doxytag="ctlnpqos.c::SepServerThread" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HANDLE <a class="el" href="../../d8/d0/ctlpcqos_8c.html#a14">SepServerThread</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00043">43</a> of file <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html">ctlnpqos.c</a>.
<p>
Referenced by <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l01028">SepServerInitialize()</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00647">SepServerRevertToSelf()</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00765">SepServerTestAnonymous()</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00831">SepServerTestIdentification()</a>, and <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00893">SepServerTestImpersonation()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="ctlnpqos.c::Status" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS <a class="el" href="../../d2/d1/cttoken_8c.html#a18">Status</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00026">26</a> of file <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html">ctlnpqos.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a13" doxytag="ctlnpqos.c::TalkPort" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HANDLE <a class="el" href="../../d8/d0/ctlpcqos_8c.html#a7">TalkPort</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00036">36</a> of file <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html">ctlnpqos.c</a>.
<p>
Referenced by <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00218">SepClientConnect()</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00252">SepClientDropConnection()</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l01258">SepReadPipe()</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l01520">SepServerDisconnectPipe()</a>, <a class="el" href="../../d9/d9/ctlpcqos_8c-source.html#l00645">SepServerImpersonateClient()</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l01482">SepServerImpersonatePipe()</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00588">SepServerWaitForNextConnect()</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l01330">SepTransceivePipe()</a>, and <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l01293">SepWritePipe()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a6" doxytag="ctlnpqos.c::UnicodeEventName" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> UNICODE_STRING <a class="el" href="../../d8/d0/ctlpcqos_8c.html#a3">UnicodeEventName</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00029">29</a> of file <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html">ctlnpqos.c</a>.
<p>
Referenced by <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l01165">CtLnpQos()</a>, and <a class="el" href="../../d9/d9/ctlpcqos_8c-source.html#l01187">CtLpcQos()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a9" doxytag="ctlnpqos.c::UnicodePortName" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> UNICODE_STRING <a class="el" href="../../d7/d0/ctlnpqos_8c.html#a9">UnicodePortName</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00032">32</a> of file <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html">ctlnpqos.c</a>.
<p>
Referenced by <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l01165">CtLnpQos()</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l01582">SepClientOpenPipe()</a>, and <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l01377">SepServerCreatePipe()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a11" doxytag="ctlnpqos.c::UnicodeRelativePortName" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> UNICODE_STRING <a class="el" href="../../d7/d0/ctlnpqos_8c.html#a11">UnicodeRelativePortName</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00034">34</a> of file <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html">ctlnpqos.c</a>.
<p>
Referenced by <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l01165">CtLnpQos()</a>.    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:43:21 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
