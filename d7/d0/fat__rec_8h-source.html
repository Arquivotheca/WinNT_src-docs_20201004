<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: fat_rec.h Source File</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>fat_rec.h</h1><a href="../../d6/d1/fat__rec_8h.html">Go to the documentation of this file.</a><pre class="fragment"><div>00001 <span class="comment">/*++</span>
00002 <span class="comment"></span>
00003 <span class="comment">Copyright (c) 1992  Microsoft Corporation</span>
00004 <span class="comment"></span>
00005 <span class="comment">Module Name:</span>
00006 <span class="comment"></span>
00007 <span class="comment">    fat_rec.h</span>
00008 <span class="comment"></span>
00009 <span class="comment">Abstract:</span>
00010 <span class="comment"></span>
00011 <span class="comment">    This module contains the mini-file system recognizer for FAT.</span>
00012 <span class="comment"></span>
00013 <span class="comment">Author:</span>
00014 <span class="comment"></span>
00015 <span class="comment">    Darryl E. Havens (darrylh) 8-dec-1992</span>
00016 <span class="comment"></span>
00017 <span class="comment">Environment:</span>
00018 <span class="comment"></span>
00019 <span class="comment">    Kernel mode, local to I/O system</span>
00020 <span class="comment"></span>
00021 <span class="comment">Revision History:</span>
00022 <span class="comment"></span>
00023 <span class="comment"></span>
00024 <span class="comment">--*/</span>
00025 
00026 <span class="comment">//</span>
00027 <span class="comment">//  The following types and macros are used to help unpack the packed and</span>
00028 <span class="comment">//  misaligned fields found in the Bios parameter block</span>
00029 <span class="comment">//</span>
00030 
<a name="l00031"></a><a class="code" href="../../d9/d2/union__UCHAR1.html">00031</a> <span class="keyword">typedef</span> <span class="keyword">union </span><a class="code" href="../../d9/d2/union__UCHAR1.html">_UCHAR1</a> {
00032     UCHAR  <a class="code" href="../../d9/d2/union__UCHAR1.html#o0">Uchar</a>[1];
00033     UCHAR  <a class="code" href="../../d9/d2/union__UCHAR1.html#o1">ForceAlignment</a>;
00034 } <a class="code" href="../../d9/d2/union__UCHAR1.html">UCHAR1</a>, *<a class="code" href="../../d9/d2/union__UCHAR1.html">PUCHAR1</a>;
00035 
<a name="l00036"></a><a class="code" href="../../d0/d3/union__UCHAR2.html">00036</a> <span class="keyword">typedef</span> <span class="keyword">union </span><a class="code" href="../../d0/d3/union__UCHAR2.html">_UCHAR2</a> {
00037     UCHAR  <a class="code" href="../../d0/d3/union__UCHAR2.html#o0">Uchar</a>[2];
00038     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a> <a class="code" href="../../d0/d3/union__UCHAR2.html#o1">ForceAlignment</a>;
00039 } <a class="code" href="../../d0/d3/union__UCHAR2.html">UCHAR2</a>, *<a class="code" href="../../d0/d3/union__UCHAR2.html">PUCHAR2</a>;
00040 
<a name="l00041"></a><a class="code" href="../../d1/d3/union__UCHAR4.html">00041</a> <span class="keyword">typedef</span> <span class="keyword">union </span><a class="code" href="../../d1/d3/union__UCHAR4.html">_UCHAR4</a> {
00042     UCHAR  <a class="code" href="../../d1/d3/union__UCHAR4.html#o0">Uchar</a>[4];
00043     ULONG  <a class="code" href="../../d1/d3/union__UCHAR4.html#o1">ForceAlignment</a>;
00044 } <a class="code" href="../../d1/d3/union__UCHAR4.html">UCHAR4</a>, *<a class="code" href="../../d1/d3/union__UCHAR4.html">PUCHAR4</a>;
00045 
00046 <span class="comment">//</span>
00047 <span class="comment">//  This macro copies an unaligned src byte to an aligned dst byte</span>
00048 <span class="comment">//</span>
00049 
<a name="l00050"></a><a class="code" href="../../d6/d1/fat__rec_8h.html#a0">00050</a> <span class="preprocessor">#define CopyUchar1(Dst,Src) {                                \</span>
00051 <span class="preprocessor">    *((UCHAR1 *)(Dst)) = *((UNALIGNED UCHAR1 *)(Src)); \</span>
00052 <span class="preprocessor">    }</span>
00053 <span class="preprocessor"></span>
00054 <span class="comment">//</span>
00055 <span class="comment">//  This macro copies an unaligned src word to an aligned dst word</span>
00056 <span class="comment">//</span>
00057 
<a name="l00058"></a><a class="code" href="../../d6/d1/fat__rec_8h.html#a1">00058</a> <span class="preprocessor">#define CopyUchar2(Dst,Src) {                                \</span>
00059 <span class="preprocessor">    *((UCHAR2 *)(Dst)) = *((UNALIGNED UCHAR2 *)(Src)); \</span>
00060 <span class="preprocessor">    }</span>
00061 <span class="preprocessor"></span>
00062 <span class="comment">//</span>
00063 <span class="comment">//  This macro copies an unaligned src longword to an aligned dsr longword</span>
00064 <span class="comment">//</span>
00065 
<a name="l00066"></a><a class="code" href="../../d6/d1/fat__rec_8h.html#a2">00066</a> <span class="preprocessor">#define CopyUchar4(Dst,Src) {                                \</span>
00067 <span class="preprocessor">    *((UCHAR4 *)(Dst)) = *((UNALIGNED UCHAR4 *)(Src)); \</span>
00068 <span class="preprocessor">    }</span>
00069 <span class="preprocessor"></span>
00070 <span class="comment">//</span>
00071 <span class="comment">//  Define the Packed and Unpacked BIOS Parameter Block</span>
00072 <span class="comment">//</span>
00073 
<a name="l00074"></a><a class="code" href="../../d8/d7/struct__PACKED__BIOS__PARAMETER__BLOCK.html">00074</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d8/d7/struct__PACKED__BIOS__PARAMETER__BLOCK.html">_PACKED_BIOS_PARAMETER_BLOCK</a> {
00075     UCHAR  <a class="code" href="../../d8/d7/struct__PACKED__BIOS__PARAMETER__BLOCK.html#o0">BytesPerSector</a>[2];                       <span class="comment">// offset = 0x000  0</span>
00076     UCHAR  <a class="code" href="../../d8/d7/struct__PACKED__BIOS__PARAMETER__BLOCK.html#o1">SectorsPerCluster</a>[1];                    <span class="comment">// offset = 0x002  2</span>
00077     UCHAR  <a class="code" href="../../d8/d7/struct__PACKED__BIOS__PARAMETER__BLOCK.html#o2">ReservedSectors</a>[2];                      <span class="comment">// offset = 0x003  3</span>
00078     UCHAR  <a class="code" href="../../d8/d7/struct__PACKED__BIOS__PARAMETER__BLOCK.html#o3">Fats</a>[1];                                 <span class="comment">// offset = 0x005  5</span>
00079     UCHAR  <a class="code" href="../../d8/d7/struct__PACKED__BIOS__PARAMETER__BLOCK.html#o4">RootEntries</a>[2];                          <span class="comment">// offset = 0x006  6</span>
00080     UCHAR  <a class="code" href="../../d8/d7/struct__PACKED__BIOS__PARAMETER__BLOCK.html#o5">Sectors</a>[2];                              <span class="comment">// offset = 0x008  8</span>
00081     UCHAR  <a class="code" href="../../d8/d7/struct__PACKED__BIOS__PARAMETER__BLOCK.html#o6">Media</a>[1];                                <span class="comment">// offset = 0x00A 10</span>
00082     UCHAR  <a class="code" href="../../d8/d7/struct__PACKED__BIOS__PARAMETER__BLOCK.html#o7">SectorsPerFat</a>[2];                        <span class="comment">// offset = 0x00B 11</span>
00083     UCHAR  <a class="code" href="../../d8/d7/struct__PACKED__BIOS__PARAMETER__BLOCK.html#o8">SectorsPerTrack</a>[2];                      <span class="comment">// offset = 0x00D 13</span>
00084     UCHAR  <a class="code" href="../../d8/d7/struct__PACKED__BIOS__PARAMETER__BLOCK.html#o9">Heads</a>[2];                                <span class="comment">// offset = 0x00F 15</span>
00085     UCHAR  <a class="code" href="../../d8/d7/struct__PACKED__BIOS__PARAMETER__BLOCK.html#o10">HiddenSectors</a>[4];                        <span class="comment">// offset = 0x011 17</span>
00086     UCHAR  <a class="code" href="../../d8/d7/struct__PACKED__BIOS__PARAMETER__BLOCK.html#o11">LargeSectors</a>[4];                         <span class="comment">// offset = 0x015 21</span>
00087 } <a class="code" href="../../d8/d7/struct__PACKED__BIOS__PARAMETER__BLOCK.html">PACKED_BIOS_PARAMETER_BLOCK</a>;                      <span class="comment">// sizeof = 0x019 25</span>
00088 
<a name="l00089"></a><a class="code" href="../../d6/d1/fat__rec_8h.html#a10">00089</a> <span class="keyword">typedef</span> <a class="code" href="../../d8/d7/struct__PACKED__BIOS__PARAMETER__BLOCK.html">PACKED_BIOS_PARAMETER_BLOCK</a> *<a class="code" href="../../d8/d7/struct__PACKED__BIOS__PARAMETER__BLOCK.html">PPACKED_BIOS_PARAMETER_BLOCK</a>;
00090 
<a name="l00091"></a><a class="code" href="../../d1/d1/structBIOS__PARAMETER__BLOCK.html">00091</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d1/d1/structBIOS__PARAMETER__BLOCK.html">BIOS_PARAMETER_BLOCK</a> {
<a name="l00092"></a><a class="code" href="../../d1/d1/structBIOS__PARAMETER__BLOCK.html#o0">00092</a>     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a> <a class="code" href="../../d1/d1/structBIOS__PARAMETER__BLOCK.html#o0">BytesPerSector</a>;
<a name="l00093"></a><a class="code" href="../../d1/d1/structBIOS__PARAMETER__BLOCK.html#o1">00093</a>     UCHAR  <a class="code" href="../../d1/d1/structBIOS__PARAMETER__BLOCK.html#o1">SectorsPerCluster</a>;
<a name="l00094"></a><a class="code" href="../../d1/d1/structBIOS__PARAMETER__BLOCK.html#o2">00094</a>     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a> <a class="code" href="../../d1/d1/structBIOS__PARAMETER__BLOCK.html#o2">ReservedSectors</a>;
<a name="l00095"></a><a class="code" href="../../d1/d1/structBIOS__PARAMETER__BLOCK.html#o3">00095</a>     UCHAR  <a class="code" href="../../d1/d1/structBIOS__PARAMETER__BLOCK.html#o3">Fats</a>;
<a name="l00096"></a><a class="code" href="../../d1/d1/structBIOS__PARAMETER__BLOCK.html#o4">00096</a>     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a> <a class="code" href="../../d1/d1/structBIOS__PARAMETER__BLOCK.html#o4">RootEntries</a>;
<a name="l00097"></a><a class="code" href="../../d1/d1/structBIOS__PARAMETER__BLOCK.html#o5">00097</a>     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a> <a class="code" href="../../d1/d1/structBIOS__PARAMETER__BLOCK.html#o5">Sectors</a>;
<a name="l00098"></a><a class="code" href="../../d1/d1/structBIOS__PARAMETER__BLOCK.html#o6">00098</a>     UCHAR  <a class="code" href="../../d1/d1/structBIOS__PARAMETER__BLOCK.html#o6">Media</a>;
<a name="l00099"></a><a class="code" href="../../d1/d1/structBIOS__PARAMETER__BLOCK.html#o7">00099</a>     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a> <a class="code" href="../../d1/d1/structBIOS__PARAMETER__BLOCK.html#o7">SectorsPerFat</a>;
<a name="l00100"></a><a class="code" href="../../d1/d1/structBIOS__PARAMETER__BLOCK.html#o8">00100</a>     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a> <a class="code" href="../../d1/d1/structBIOS__PARAMETER__BLOCK.html#o8">SectorsPerTrack</a>;
<a name="l00101"></a><a class="code" href="../../d1/d1/structBIOS__PARAMETER__BLOCK.html#o9">00101</a>     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a> <a class="code" href="../../d1/d1/structBIOS__PARAMETER__BLOCK.html#o9">Heads</a>;
<a name="l00102"></a><a class="code" href="../../d1/d1/structBIOS__PARAMETER__BLOCK.html#o10">00102</a>     ULONG  <a class="code" href="../../d1/d1/structBIOS__PARAMETER__BLOCK.html#o10">HiddenSectors</a>;
<a name="l00103"></a><a class="code" href="../../d1/d1/structBIOS__PARAMETER__BLOCK.html#o11">00103</a>     ULONG  <a class="code" href="../../d1/d1/structBIOS__PARAMETER__BLOCK.html#o11">LargeSectors</a>;
00104 } <a class="code" href="../../d1/d1/structBIOS__PARAMETER__BLOCK.html">BIOS_PARAMETER_BLOCK</a>, *<a class="code" href="../../d1/d1/structBIOS__PARAMETER__BLOCK.html">PBIOS_PARAMETER_BLOCK</a>;
00105 
00106 <span class="comment">//</span>
00107 <span class="comment">//  Define the boot sector</span>
00108 <span class="comment">//</span>
00109 
<a name="l00110"></a><a class="code" href="../../d9/d7/struct__PACKED__BOOT__SECTOR.html">00110</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d9/d7/struct__PACKED__BOOT__SECTOR.html">_PACKED_BOOT_SECTOR</a> {
00111     UCHAR <a class="code" href="../../d9/d7/struct__PACKED__BOOT__SECTOR.html#o0">Jump</a>[3];                                  <span class="comment">// offset = 0x000   0</span>
00112     UCHAR <a class="code" href="../../d9/d7/struct__PACKED__BOOT__SECTOR.html#o1">Oem</a>[8];                                   <span class="comment">// offset = 0x003   3</span>
00113     <a class="code" href="../../d8/d7/struct__PACKED__BIOS__PARAMETER__BLOCK.html">PACKED_BIOS_PARAMETER_BLOCK</a> <a class="code" href="../../d9/d7/struct__PACKED__BOOT__SECTOR.html#o2">PackedBpb</a>;          <span class="comment">// offset = 0x00B  11</span>
<a name="l00114"></a><a class="code" href="../../d9/d7/struct__PACKED__BOOT__SECTOR.html#o3">00114</a>     UCHAR <a class="code" href="../../d9/d7/struct__PACKED__BOOT__SECTOR.html#o3">PhysicalDriveNumber</a>;                      <span class="comment">// offset = 0x024  36</span>
<a name="l00115"></a><a class="code" href="../../d9/d7/struct__PACKED__BOOT__SECTOR.html#o4">00115</a>     UCHAR <a class="code" href="../../d9/d7/struct__PACKED__BOOT__SECTOR.html#o4">Reserved</a>;                                 <span class="comment">// offset = 0x025  37</span>
<a name="l00116"></a><a class="code" href="../../d9/d7/struct__PACKED__BOOT__SECTOR.html#o5">00116</a>     UCHAR <a class="code" href="../../d9/d7/struct__PACKED__BOOT__SECTOR.html#o5">Signature</a>;                                <span class="comment">// offset = 0x026  38</span>
<a name="l00117"></a><a class="code" href="../../d9/d7/struct__PACKED__BOOT__SECTOR.html#o6">00117</a>     UCHAR <a class="code" href="../../d9/d7/struct__PACKED__BOOT__SECTOR.html#o6">Id</a>[4];                                    <span class="comment">// offset = 0x027  39</span>
<a name="l00118"></a><a class="code" href="../../d9/d7/struct__PACKED__BOOT__SECTOR.html#o7">00118</a>     UCHAR <a class="code" href="../../d9/d7/struct__PACKED__BOOT__SECTOR.html#o7">VolumeLabel</a>[11];                          <span class="comment">// offset = 0x02B  43</span>
<a name="l00119"></a><a class="code" href="../../d9/d7/struct__PACKED__BOOT__SECTOR.html#o8">00119</a>     UCHAR <a class="code" href="../../d9/d7/struct__PACKED__BOOT__SECTOR.html#o8">SystemId</a>[8];                              <span class="comment">// offset = 0x036  54</span>
00120 } <a class="code" href="../../d9/d7/struct__PACKED__BOOT__SECTOR.html">PACKED_BOOT_SECTOR</a>;                               <span class="comment">// sizeof = 0x03E  62</span>
00121 
<a name="l00122"></a><a class="code" href="../../d6/d1/fat__rec_8h.html#a14">00122</a> <span class="keyword">typedef</span> <a class="code" href="../../d9/d7/struct__PACKED__BOOT__SECTOR.html">PACKED_BOOT_SECTOR</a> *<a class="code" href="../../d9/d7/struct__PACKED__BOOT__SECTOR.html">PPACKED_BOOT_SECTOR</a>;
00123 
00124 <span class="comment">//</span>
00125 <span class="comment">// Define the functions provided by this driver.</span>
00126 <span class="comment">//</span>
00127 
00128 BOOLEAN
00129 <a class="code" href="../../d6/d1/fat__rec_8h.html#a15">IsFatVolume</a>(
00130     IN PPACKED_BOOT_SECTOR Buffer
00131     );
00132 
00133 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00134 <a class="code" href="../../d6/d1/fat__rec_8h.html#a16">UnpackBiosParameterBlock</a>(
00135     IN PPACKED_BIOS_PARAMETER_BLOCK Bios,
00136     OUT PBIOS_PARAMETER_BLOCK UnpackedBios
00137     );
</div></pre><hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:39:58 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
