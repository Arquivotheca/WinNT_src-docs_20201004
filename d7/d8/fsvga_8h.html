<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: fsvga.h File Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>fsvga.h File Reference</h1><code>#include "ntddvdeo.h"</code><br>
<code>#include "fscrnctl.h"</code><br>
<code>#include "<a class="el" href="../../d2/d5/vga_8h-source.html">vga.h</a>"</code><br>

<p>
<a href="../../d8/d7/fsvga_8h-source.html">Go to the source code of this file.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Classes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d1/struct__FSVGA__CONFIGURATION__INFORMATION.html">_FSVGA_CONFIGURATION_INFORMATION</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d3/struct__EMULATE__BUFFER__INFORMATION.html">_EMULATE_BUFFER_INFORMATION</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d3/struct__DEVICE__EXTENSION.html">_DEVICE_EXTENSION</a></td></tr>

<tr><td colspan=2><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d8/fsvga_8h.html#a0">ENABLE_WORD_WRITE_VRAM</a>&nbsp;&nbsp;&nbsp;0x01</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d8/fsvga_8h.html#a1">NO_HARDWARE_CURSOR</a>&nbsp;&nbsp;&nbsp;0</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d8/fsvga_8h.html#a2">HARDWARE_CURSOR</a>&nbsp;&nbsp;&nbsp;0x01</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d8/fsvga_8h.html#a3">NO_HARDWARE_SCROLL</a>&nbsp;&nbsp;&nbsp;0</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d8/fsvga_8h.html#a4">HARDWARE_SCROLL</a>&nbsp;&nbsp;&nbsp;0x01</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d8/fsvga_8h.html#a5">USE_LINE_COMPARE</a>&nbsp;&nbsp;&nbsp;0x02</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d8/fsvga_8h.html#a6">OFFSET_128_TO_NEXT_SLICE</a>&nbsp;&nbsp;&nbsp;0x04</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d8/fsvga_8h.html#a7">LIMIT_64K</a>&nbsp;&nbsp;&nbsp;0x10000L</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d8/fsvga_8h.html#a8">FSVGA_ERROR_VALUE_BASE</a>&nbsp;&nbsp;&nbsp;1000</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d8/fsvga_8h.html#a9">FSVGA_HARDWARE_PRESENT</a>&nbsp;&nbsp;&nbsp;1</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d8/fsvga_8h.html#a10">FsVgaPrint</a>(x)</td></tr>

<tr><td colspan=2><br><h2>Typedefs</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>typedef enum <a class="el" href="../../d7/d8/fsvga_8h.html#a66">_VGA_IO_PORT_TYPE</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d8/fsvga_8h.html#a11">VGA_IO_PORT_TYPE</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d3/d1/struct__FSVGA__CONFIGURATION__INFORMATION.html">_FSVGA_CONFIGURATION_INFORMATION</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d8/fsvga_8h.html#a12">FSVGA_CONFIGURATION_INFORMATION</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d3/d1/struct__FSVGA__CONFIGURATION__INFORMATION.html">_FSVGA_CONFIGURATION_INFORMATION</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d8/fsvga_8h.html#a13">PFSVGA_CONFIGURATION_INFORMATION</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d1/d3/struct__EMULATE__BUFFER__INFORMATION.html">_EMULATE_BUFFER_INFORMATION</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d8/fsvga_8h.html#a14">EMULATE_BUFFER_INFORMATION</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d1/d3/struct__EMULATE__BUFFER__INFORMATION.html">_EMULATE_BUFFER_INFORMATION</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d8/fsvga_8h.html#a15">PEMULATE_BUFFER_INFORMATION</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d8/d3/struct__DEVICE__EXTENSION.html">_DEVICE_EXTENSION</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d8/fsvga_8h.html#a16">DEVICE_EXTENSION</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d8/d3/struct__DEVICE__EXTENSION.html">_DEVICE_EXTENSION</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d8/fsvga_8h.html#a17">PDEVICE_EXTENSION</a></td></tr>

<tr><td colspan=2><br><h2>Enumerations</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>enum &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d8/fsvga_8h.html#a66">_VGA_IO_PORT_TYPE</a> { <br>
&nbsp;&nbsp;<a class="el" href="../../d7/d8/fsvga_8h.html#a66a18">CRTCAddressPortColor</a> =  0, 
<a class="el" href="../../d7/d8/fsvga_8h.html#a66a19">CRTCDataPortColor</a>, 
<a class="el" href="../../d7/d8/fsvga_8h.html#a66a20">GRAPHAddressPort</a>, 
<a class="el" href="../../d7/d8/fsvga_8h.html#a66a21">SEQUAddressPort</a>, 
<br>
&nbsp;&nbsp;<a class="el" href="../../d7/d8/fsvga_8h.html#a66a22">MaximumPortCount</a>
<br>
 }</td></tr>

<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d8/fsvga_8h.html#a23">DriverEntry</a> (IN <a class="el" href="../../d4/d9/struct__DRIVER__OBJECT.html">PDRIVER_OBJECT</a> DriverObject, IN PUNICODE_STRING RegistryPath)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d8/fsvga_8h.html#a24">FsVgaConfiguration</a> (IN <a class="el" href="../../d8/d3/struct__DEVICE__EXTENSION.html">PDEVICE_EXTENSION</a> DeviceExtension, IN PUNICODE_STRING RegistryPath, IN PUNICODE_STRING KeyboardDeviceName)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d8/fsvga_8h.html#a25">FsVgaPeripheralCallout</a> (IN PVOID Context, IN PUNICODE_STRING PathName, IN INTERFACE_TYPE BusType, IN ULONG <a class="el" href="../../d2/d7/hal_8h.html#a75">BusNumber</a>, IN PKEY_VALUE_FULL_INFORMATION *BusInformation, IN <a class="el" href="../../d1/d9/arc_8h.html#a56">CONFIGURATION_TYPE</a> ControllerType, IN ULONG ControllerNumber, IN PKEY_VALUE_FULL_INFORMATION *ControllerInformation, IN <a class="el" href="../../d1/d9/arc_8h.html#a56">CONFIGURATION_TYPE</a> PeripheralType, IN ULONG PeripheralNumber, IN PKEY_VALUE_FULL_INFORMATION *PeripheralInformation)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d8/fsvga_8h.html#a26">FsVgaServiceParameters</a> (IN <a class="el" href="../../d8/d3/struct__DEVICE__EXTENSION.html">PDEVICE_EXTENSION</a> DeviceExtension, IN PUNICODE_STRING RegistryPath, IN PUNICODE_STRING FsVgaDeviceName)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d8/fsvga_8h.html#a27">FsVgaBuildResourceList</a> (IN <a class="el" href="../../d8/d3/struct__DEVICE__EXTENSION.html">PDEVICE_EXTENSION</a> DeviceExtension, OUT PCM_RESOURCE_LIST *ResourceList, OUT PULONG ResourceListSize)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d8/fsvga_8h.html#a28">FsVgaOpenCloseDispatch</a> (IN <a class="el" href="../../d8/d4/struct__DEVICE__OBJECT.html">PDEVICE_OBJECT</a> DeviceObject, IN <a class="el" href="../../d0/d2/struct__IRP.html">PIRP</a> <a class="el" href="../../d0/d6/iop_8h.html#a35">Irp</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d8/fsvga_8h.html#a29">FsVgaDeviceControl</a> (IN <a class="el" href="../../d8/d4/struct__DEVICE__OBJECT.html">PDEVICE_OBJECT</a> DeviceObject, IN <a class="el" href="../../d0/d2/struct__IRP.html">PIRP</a> <a class="el" href="../../d0/d6/iop_8h.html#a35">Irp</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d8/fsvga_8h.html#a30">FsVgaCopyFrameBuffer</a> (<a class="el" href="../../d8/d3/struct__DEVICE__EXTENSION.html">PDEVICE_EXTENSION</a> DeviceExtension, PFSVIDEO_COPY_FRAME_BUFFER CopyFrameBuffer, ULONG inputBufferLength)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d8/fsvga_8h.html#a31">FsVgaWriteToFrameBuffer</a> (<a class="el" href="../../d8/d3/struct__DEVICE__EXTENSION.html">PDEVICE_EXTENSION</a> DeviceExtension, PFSVIDEO_WRITE_TO_FRAME_BUFFER WriteFrameBuffer, ULONG inputBufferLength)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d8/fsvga_8h.html#a32">FsVgaReverseMousePointer</a> (<a class="el" href="../../d8/d3/struct__DEVICE__EXTENSION.html">PDEVICE_EXTENSION</a> DeviceExtension, PFSVIDEO_REVERSE_MOUSE_POINTER MouseBuffer, ULONG inputBufferLength)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d8/fsvga_8h.html#a33">FsVgaSetMode</a> (<a class="el" href="../../d8/d3/struct__DEVICE__EXTENSION.html">PDEVICE_EXTENSION</a> DeviceExtension, PFSVIDEO_MODE_INFORMATION ModeInformation, ULONG inputBufferLength)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d8/fsvga_8h.html#a34">FsVgaSetScreenInformation</a> (<a class="el" href="../../d8/d3/struct__DEVICE__EXTENSION.html">PDEVICE_EXTENSION</a> DeviceExtension, PFSVIDEO_SCREEN_INFORMATION ScreenInformation, ULONG inputBufferLength)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d8/fsvga_8h.html#a35">FsVgaSetCursorPosition</a> (<a class="el" href="../../d8/d3/struct__DEVICE__EXTENSION.html">PDEVICE_EXTENSION</a> DeviceExtension, PFSVIDEO_CURSOR_POSITION CursorPosition, ULONG inputBufferLength)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d8/fsvga_8h.html#a36">FsVgaSetCursorAttribute</a> (<a class="el" href="../../d8/d3/struct__DEVICE__EXTENSION.html">PDEVICE_EXTENSION</a> DeviceExtension, PVIDEO_CURSOR_ATTRIBUTES CursorAttributes, ULONG inputBufferLength)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d8/fsvga_8h.html#a37">FsVgaLogError</a> (IN <a class="el" href="../../d8/d4/struct__DEVICE__OBJECT.html">PDEVICE_OBJECT</a> DeviceObject, IN NTSTATUS ErrorCode, IN ULONG UniqueErrorValue, IN NTSTATUS FinalStatus, IN PULONG DumpData, IN ULONG DumpCount)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d8/fsvga_8h.html#a38">CalcGRAMSize</a> (IN COORD WindowSize, IN <a class="el" href="../../d8/d3/struct__DEVICE__EXTENSION.html">PDEVICE_EXTENSION</a> DeviceExtension)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>PUCHAR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d8/fsvga_8h.html#a39">CalcGRAMAddress</a> (IN COORD WindowSize, IN <a class="el" href="../../d8/d3/struct__DEVICE__EXTENSION.html">PDEVICE_EXTENSION</a> DeviceExtension)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d8/fsvga_8h.html#a40">IsGRAMRowOver</a> (PUCHAR BufPtr, BOOL fDbcs, <a class="el" href="../../d8/d3/struct__DEVICE__EXTENSION.html">PDEVICE_EXTENSION</a> DeviceExtension)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>PUCHAR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d8/fsvga_8h.html#a41">NextGRAMRow</a> (PUCHAR BufPtr, <a class="el" href="../../d8/d3/struct__DEVICE__EXTENSION.html">PDEVICE_EXTENSION</a> DeviceExtension)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d8/fsvga_8h.html#a42">memcpyGRAM</a> (IN PCHAR TargetPtr, IN PCHAR SourcePtr, IN ULONG Length)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d8/fsvga_8h.html#a43">memcpyGRAMOver</a> (IN PCHAR TargetPtr, IN PCHAR SourcePtr, IN ULONG Length, IN PUCHAR FrameBufPtr, IN <a class="el" href="../../d8/d3/struct__DEVICE__EXTENSION.html">PDEVICE_EXTENSION</a> DeviceExtension)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d8/fsvga_8h.html#a44">MoveGRAM</a> (IN PCHAR TargetPtr, IN PCHAR SourcePtr, IN ULONG Length, IN PUCHAR FrameBufPtr, IN <a class="el" href="../../d8/d3/struct__DEVICE__EXTENSION.html">PDEVICE_EXTENSION</a> DeviceExtension)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d8/fsvga_8h.html#a45">FsgVgaInitializeHWFlags</a> (<a class="el" href="../../d8/d3/struct__DEVICE__EXTENSION.html">PDEVICE_EXTENSION</a> DeviceExtension)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d8/fsvga_8h.html#a46">FsgCopyFrameBuffer</a> (<a class="el" href="../../d8/d3/struct__DEVICE__EXTENSION.html">PDEVICE_EXTENSION</a> DeviceExtension, PFSVIDEO_COPY_FRAME_BUFFER CopyFrameBuffer, ULONG inputBufferLength)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d8/fsvga_8h.html#a47">FsgWriteToFrameBuffer</a> (<a class="el" href="../../d8/d3/struct__DEVICE__EXTENSION.html">PDEVICE_EXTENSION</a> DeviceExtension, PFSVIDEO_WRITE_TO_FRAME_BUFFER WriteFrameBuffer, ULONG inputBufferLength)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d8/fsvga_8h.html#a48">FsgReverseMousePointer</a> (<a class="el" href="../../d8/d3/struct__DEVICE__EXTENSION.html">PDEVICE_EXTENSION</a> DeviceExtension, PFSVIDEO_REVERSE_MOUSE_POINTER MouseBuffer, ULONG inputBufferLength)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d8/fsvga_8h.html#a49">FsgInvertCursor</a> (<a class="el" href="../../d8/d3/struct__DEVICE__EXTENSION.html">PDEVICE_EXTENSION</a> DeviceExtension, BOOL Invert)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d8/fsvga_8h.html#a50">FsgWriteToScreen</a> (PUCHAR FrameBuffer, PUCHAR BitmapBuffer, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> cjBytes, BOOL fDbcs, WORD Attributes1, WORD Attributes2, <a class="el" href="../../d8/d3/struct__DEVICE__EXTENSION.html">PDEVICE_EXTENSION</a> DeviceExtension)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d8/fsvga_8h.html#a51">FsgWriteToScreenCommonLVB</a> (PUCHAR FrameBuffer, WORD Attributes, <a class="el" href="../../d8/d3/struct__DEVICE__EXTENSION.html">PDEVICE_EXTENSION</a> DeviceExtension)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>UCHAR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d8/fsvga_8h.html#a52">AccessGRAM_WR</a> (PUCHAR FrameBuffer, UCHAR write)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>UCHAR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d8/fsvga_8h.html#a53">AccessGRAM_RW</a> (PUCHAR FrameBuffer, UCHAR write)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>UCHAR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d8/fsvga_8h.html#a54">AccessGRAM_AND</a> (PUCHAR FrameBuffer, UCHAR write)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d8/fsvga_8h.html#a55">CalcBitmapBufferSize</a> (IN COORD FontSize, IN <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> dwAlign)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d8/fsvga_8h.html#a56">AlignCopyMemory</a> (OUT <a class="el" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a> pDestBits, IN <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> dwDestAlign, IN <a class="el" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a> pSrcBits, IN <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> dwSrcAlign, IN COORD FontSize)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>int&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d8/fsvga_8h.html#a57">ConvertOutputToOem</a> (IN LPWSTR Source, IN int SourceLength, OUT LPSTR Target, IN int TargetLength)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d8/fsvga_8h.html#a58">TranslateOutputToOem</a> (OUT PCHAR_IMAGE_INFO OutputBuffer, IN PCHAR_IMAGE_INFO InputBuffer, IN <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> Length)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d8/fsvga_8h.html#a59">GetHardwareScrollReg</a> (<a class="el" href="../../d8/d3/struct__DEVICE__EXTENSION.html">PDEVICE_EXTENSION</a> deviceExtension)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d8/fsvga_8h.html#a60">SetGRAMWriteMode</a> (<a class="el" href="../../d8/d3/struct__DEVICE__EXTENSION.html">PDEVICE_EXTENSION</a> deviceExtension)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d8/fsvga_8h.html#a61">SetGRAMCopyMode</a> (<a class="el" href="../../d8/d3/struct__DEVICE__EXTENSION.html">PDEVICE_EXTENSION</a> deviceExtension)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d8/fsvga_8h.html#a62">SetGRAMInvertMode</a> (<a class="el" href="../../d8/d3/struct__DEVICE__EXTENSION.html">PDEVICE_EXTENSION</a> deviceExtension)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d8/fsvga_8h.html#a63">set_opaque_bkgnd_proc</a> (<a class="el" href="../../d8/d3/struct__DEVICE__EXTENSION.html">PDEVICE_EXTENSION</a> deviceExtension, PUCHAR FrameBuffer, WORD Attributes)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d8/fsvga_8h.html#a64">ColorSetGridMask</a> (<a class="el" href="../../d8/d3/struct__DEVICE__EXTENSION.html">PDEVICE_EXTENSION</a> deviceExtension, <a class="el" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a> BitMask)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d8/fsvga_8h.html#a65">ColorSetDirect</a> (<a class="el" href="../../d8/d3/struct__DEVICE__EXTENSION.html">PDEVICE_EXTENSION</a> deviceExtension, PUCHAR FrameBuffer, <a class="el" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a> ColorFg, <a class="el" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a> ColorBg)</td></tr>

</table>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="a0" doxytag="fsvga.h::ENABLE_WORD_WRITE_VRAM" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ENABLE_WORD_WRITE_VRAM&nbsp;&nbsp;&nbsp;0x01          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00050">50</a> of file <a class="el" href="../../d8/d7/fsvga_8h-source.html">fsvga.h</a>.
<p>
Referenced by <a class="el" href="../../d3/d1/drawscrn_8c-source.html#l00813">FsgWriteToScreen()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a8" doxytag="fsvga.h::FSVGA_ERROR_VALUE_BASE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define FSVGA_ERROR_VALUE_BASE&nbsp;&nbsp;&nbsp;1000          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00168">168</a> of file <a class="el" href="../../d8/d7/fsvga_8h-source.html">fsvga.h</a>.
<p>
Referenced by <a class="el" href="../../d7/d7/fsvga_8c-source.html#l00053">DriverEntry()</a>, <a class="el" href="../../d7/d7/fsvga_8c-source.html#l01056">FsVgaBuildResourceList()</a>, and <a class="el" href="../../d7/d7/fsvga_8c-source.html#l01429">FsVgaWriteToFrameBuffer()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a9" doxytag="fsvga.h::FSVGA_HARDWARE_PRESENT" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define FSVGA_HARDWARE_PRESENT&nbsp;&nbsp;&nbsp;1          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00174">174</a> of file <a class="el" href="../../d8/d7/fsvga_8h-source.html">fsvga.h</a>.
<p>
Referenced by <a class="el" href="../../d7/d7/fsvga_8c-source.html#l00053">DriverEntry()</a>, <a class="el" href="../../d7/d7/fsvga_8c-source.html#l00649">FsVgaConfiguration()</a>, and <a class="el" href="../../d7/d7/fsvga_8c-source.html#l00722">FsVgaPeripheralCallout()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a10" doxytag="fsvga.h::FsVgaPrint" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define FsVgaPrint          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">x&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00310">310</a> of file <a class="el" href="../../d8/d7/fsvga_8h-source.html">fsvga.h</a>.
<p>
Referenced by <a class="el" href="../../d7/d7/fsvga_8c-source.html#l00053">DriverEntry()</a>, <a class="el" href="../../d7/d7/fsvga_8c-source.html#l01056">FsVgaBuildResourceList()</a>, <a class="el" href="../../d7/d7/fsvga_8c-source.html#l00649">FsVgaConfiguration()</a>, <a class="el" href="../../d7/d7/fsvga_8c-source.html#l01213">FsVgaDeviceControl()</a>, <a class="el" href="../../d7/d7/fsvga_8c-source.html#l01167">FsVgaOpenCloseDispatch()</a>, <a class="el" href="../../d7/d7/fsvga_8c-source.html#l00722">FsVgaPeripheralCallout()</a>, <a class="el" href="../../d7/d7/fsvga_8c-source.html#l00858">FsVgaServiceParameters()</a>, and <a class="el" href="../../d7/d7/fsvga_8c-source.html#l01429">FsVgaWriteToFrameBuffer()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a2" doxytag="fsvga.h::HARDWARE_CURSOR" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define HARDWARE_CURSOR&nbsp;&nbsp;&nbsp;0x01          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00054">54</a> of file <a class="el" href="../../d8/d7/fsvga_8h-source.html">fsvga.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a4" doxytag="fsvga.h::HARDWARE_SCROLL" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define HARDWARE_SCROLL&nbsp;&nbsp;&nbsp;0x01          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00058">58</a> of file <a class="el" href="../../d8/d7/fsvga_8h-source.html">fsvga.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a7" doxytag="fsvga.h::LIMIT_64K" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define LIMIT_64K&nbsp;&nbsp;&nbsp;0x10000L          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00096">96</a> of file <a class="el" href="../../d8/d7/fsvga_8h-source.html">fsvga.h</a>.
<p>
Referenced by <a class="el" href="../../d3/d1/drawscrn_8c-source.html#l00387">FsgVgaInitializeHWFlags()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="fsvga.h::NO_HARDWARE_CURSOR" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define NO_HARDWARE_CURSOR&nbsp;&nbsp;&nbsp;0          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00053">53</a> of file <a class="el" href="../../d8/d7/fsvga_8h-source.html">fsvga.h</a>.
<p>
Referenced by <a class="el" href="../../d7/d7/fsvga_8c-source.html#l00858">FsVgaServiceParameters()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="fsvga.h::NO_HARDWARE_SCROLL" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define NO_HARDWARE_SCROLL&nbsp;&nbsp;&nbsp;0          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00057">57</a> of file <a class="el" href="../../d8/d7/fsvga_8h-source.html">fsvga.h</a>.
<p>
Referenced by <a class="el" href="../../d7/d7/fsvga_8c-source.html#l00858">FsVgaServiceParameters()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a6" doxytag="fsvga.h::OFFSET_128_TO_NEXT_SLICE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define OFFSET_128_TO_NEXT_SLICE&nbsp;&nbsp;&nbsp;0x04          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00060">60</a> of file <a class="el" href="../../d8/d7/fsvga_8h-source.html">fsvga.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a5" doxytag="fsvga.h::USE_LINE_COMPARE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define USE_LINE_COMPARE&nbsp;&nbsp;&nbsp;0x02          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00059">59</a> of file <a class="el" href="../../d8/d7/fsvga_8h-source.html">fsvga.h</a>.
<p>
Referenced by <a class="el" href="../../d3/d1/drawscrn_8c-source.html#l00387">FsgVgaInitializeHWFlags()</a>.    </td>
  </tr>
</table>
<hr><h2>Typedef Documentation</h2>
<a class="anchor" name="a16" doxytag="fsvga.h::DEVICE_EXTENSION" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d8/d3/struct__DEVICE__EXTENSION.html">_DEVICE_EXTENSION</a>  <a class="el" href="../../d8/d3/struct__DEVICE__EXTENSION.html">DEVICE_EXTENSION</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a14" doxytag="fsvga.h::EMULATE_BUFFER_INFORMATION" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d1/d3/struct__EMULATE__BUFFER__INFORMATION.html">_EMULATE_BUFFER_INFORMATION</a>  <a class="el" href="../../d1/d3/struct__EMULATE__BUFFER__INFORMATION.html">EMULATE_BUFFER_INFORMATION</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a12" doxytag="fsvga.h::FSVGA_CONFIGURATION_INFORMATION" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d3/d1/struct__FSVGA__CONFIGURATION__INFORMATION.html">_FSVGA_CONFIGURATION_INFORMATION</a>  <a class="el" href="../../d3/d1/struct__FSVGA__CONFIGURATION__INFORMATION.html">FSVGA_CONFIGURATION_INFORMATION</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a17" doxytag="fsvga.h::PDEVICE_EXTENSION" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d8/d3/struct__DEVICE__EXTENSION.html">_DEVICE_EXTENSION</a> * <a class="el" href="../../d8/d3/struct__DEVICE__EXTENSION.html">PDEVICE_EXTENSION</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a15" doxytag="fsvga.h::PEMULATE_BUFFER_INFORMATION" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d1/d3/struct__EMULATE__BUFFER__INFORMATION.html">_EMULATE_BUFFER_INFORMATION</a> * <a class="el" href="../../d1/d3/struct__EMULATE__BUFFER__INFORMATION.html">PEMULATE_BUFFER_INFORMATION</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a13" doxytag="fsvga.h::PFSVGA_CONFIGURATION_INFORMATION" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d3/d1/struct__FSVGA__CONFIGURATION__INFORMATION.html">_FSVGA_CONFIGURATION_INFORMATION</a> * <a class="el" href="../../d3/d1/struct__FSVGA__CONFIGURATION__INFORMATION.html">PFSVGA_CONFIGURATION_INFORMATION</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d7/d7/fsvga_8c-source.html#l00649">FsVgaConfiguration()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a11" doxytag="fsvga.h::VGA_IO_PORT_TYPE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef enum <a class="el" href="../../d7/d8/fsvga_8h.html#a66">_VGA_IO_PORT_TYPE</a>  <a class="el" href="../../d7/d8/fsvga_8h.html#a11">VGA_IO_PORT_TYPE</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<hr><h2>Enumeration Type Documentation</h2>
<a class="anchor" name="a66" doxytag="fsvga.h::_VGA_IO_PORT_TYPE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> enum <a class="el" href="../../d7/d8/fsvga_8h.html#a66">_VGA_IO_PORT_TYPE</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<dl compact><dt><b>Enumeration values: </b></dt><dd>
<table border=0 cellspacing=2 cellpadding=0>
<tr><td valign=top><em><a class="anchor" name="a66a18" doxytag="CRTCAddressPortColor" ></a>CRTCAddressPortColor</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a66a19" doxytag="CRTCDataPortColor" ></a>CRTCDataPortColor</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a66a20" doxytag="GRAPHAddressPort" ></a>GRAPHAddressPort</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a66a21" doxytag="SEQUAddressPort" ></a>SEQUAddressPort</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a66a22" doxytag="MaximumPortCount" ></a>MaximumPortCount</em>&nbsp;</td><td>
</td></tr>
</table>
</dl>

<p>
Definition at line <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00035">35</a> of file <a class="el" href="../../d8/d7/fsvga_8h-source.html">fsvga.h</a>.
<p>
<pre class="fragment"><div>00035                                {
00036     <a class="code" href="../../d7/d8/fsvga_8h.html#a66a18">CRTCAddressPortColor</a> = 0,
00037     <a class="code" href="../../d7/d8/fsvga_8h.html#a66a19">CRTCDataPortColor</a>,
00038     <a class="code" href="../../d7/d8/fsvga_8h.html#a66a20">GRAPHAddressPort</a>,
00039     <a class="code" href="../../d7/d8/fsvga_8h.html#a66a21">SEQUAddressPort</a>,
00040     <a class="code" href="../../d7/d8/fsvga_8h.html#a66a22">MaximumPortCount</a>
00041 } <a class="code" href="../../d7/d8/fsvga_8h.html#a11">VGA_IO_PORT_TYPE</a>;
</div></pre>    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a54" doxytag="fsvga.h::AccessGRAM_AND" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> UCHAR AccessGRAM_AND           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">PUCHAR&nbsp;</td>
          <td class="mdname" nowrap> <em>FrameBuffer</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UCHAR&nbsp;</td>
          <td class="mdname" nowrap> <em>write</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d1/drawscrn_8c-source.html#l00998">998</a> of file <a class="el" href="../../d3/d1/drawscrn_8c-source.html">drawscrn.c</a>.
<p>
Referenced by <a class="el" href="../../d3/d1/drawscrn_8c-source.html#l00702">FsgInvertCursor()</a>, and <a class="el" href="../../d3/d1/drawscrn_8c-source.html#l00609">FsgReverseMousePointer()</a>.
<p>
<pre class="fragment"><div>01002 {
01003     <span class="keywordflow">return</span> *FrameBuffer &amp;= write;
01004 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a53" doxytag="fsvga.h::AccessGRAM_RW" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> UCHAR AccessGRAM_RW           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">PUCHAR&nbsp;</td>
          <td class="mdname" nowrap> <em>FrameBuffer</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UCHAR&nbsp;</td>
          <td class="mdname" nowrap> <em>write</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d1/drawscrn_8c-source.html#l00986">986</a> of file <a class="el" href="../../d3/d1/drawscrn_8c-source.html">drawscrn.c</a>.
<p>
Referenced by <a class="el" href="../../d3/d1/drawscrn_8c-source.html#l00915">FsgWriteToScreenCommonLVB()</a>.
<p>
<pre class="fragment"><div>00990 {
00991     UCHAR tmp;
00992     tmp = *FrameBuffer;
00993     *FrameBuffer = write;
00994     <span class="keywordflow">return</span> tmp;
00995 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a52" doxytag="fsvga.h::AccessGRAM_WR" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> UCHAR AccessGRAM_WR           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">PUCHAR&nbsp;</td>
          <td class="mdname" nowrap> <em>FrameBuffer</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UCHAR&nbsp;</td>
          <td class="mdname" nowrap> <em>write</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d1/drawscrn_8c-source.html#l00976">976</a> of file <a class="el" href="../../d3/d1/drawscrn_8c-source.html">drawscrn.c</a>.
<p>
Referenced by <a class="el" href="../../d7/d1/port_8c-source.html#l00257">ColorSetDirect()</a>.
<p>
<pre class="fragment"><div>00980 {
00981     *FrameBuffer = write;
00982     <span class="keywordflow">return</span> *FrameBuffer;
00983 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a56" doxytag="fsvga.h::AlignCopyMemory" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID AlignCopyMemory           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">OUT <a class="el" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pDestBits</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>dwDestAlign</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pSrcBits</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>dwSrcAlign</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN COORD&nbsp;</td>
          <td class="mdname" nowrap> <em>FontSize</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d5/fullscr_2vga_2foncache_8c-source.html#l00056">56</a> of file <a class="el" href="../../d5/d5/fullscr_2vga_2foncache_8c-source.html">fullscr/vga/foncache.c</a>.
<p>
References <a class="el" href="../../d7/d5/foncache_8h-source.html#l00059">BITMAP_BITS_BYTE_ALIGN</a>, <a class="el" href="../../d7/d5/foncache_8h-source.html#l00060">BITMAP_BITS_WORD_ALIGN</a>, <a class="el" href="../../d7/d5/foncache_8h-source.html#l00074">BYTE_ALIGN</a>, <a class="el" href="../../d5/d5/fullscr_2vga_2foncache_8c-source.html#l00035">CALC_BITMAP_BITS_FOR_X</a>, <a class="el" href="../../d5/d5/fullscr_2vga_2foncache_8c-source.html#l00041">CalcBitmapBufferSize()</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00055">EXCEPTION_EXECUTE_HANDLER</a>, and <a class="el" href="../../d7/d5/foncache_8h-source.html#l00075">WORD_ALIGN</a>.
<p>
Referenced by <a class="el" href="../../d3/d1/drawscrn_8c-source.html#l00489">FsgWriteToFrameBuffer()</a>.
<p>
<pre class="fragment"><div>00063 {
00064     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> dwDestBufferSize;
00065     COORD coord;
00066 
00067     <span class="keywordflow">try</span>
00068     {
00069 
00070         <span class="keywordflow">if</span> (dwDestAlign == dwSrcAlign) {
00071             dwDestBufferSize = <a class="code" href="../../d6/d6/foncache_8h.html#a29">CalcBitmapBufferSize</a>(FontSize, dwDestAlign);
00072             RtlCopyMemory(pDestBits, pSrcBits, dwDestBufferSize);
00073             <span class="keywordflow">return</span>;
00074         }
00075 
00076         <span class="keywordflow">switch</span> (dwDestAlign) {
00077             <span class="keywordflow">default</span>:
00078             <span class="keywordflow">case</span> <a class="code" href="../../d6/d6/foncache_8h.html#a10">WORD_ALIGN</a>:
00079                 <span class="keywordflow">switch</span> (dwSrcAlign) {
00080                     <span class="keywordflow">default</span>:
00081                     <span class="comment">//</span>
00082                     <span class="comment">// pDest = WORD, pSrc = WORD</span>
00083                     <span class="comment">//</span>
00084                     <span class="keywordflow">case</span> <a class="code" href="../../d6/d6/foncache_8h.html#a10">WORD_ALIGN</a>:
00085                         dwDestBufferSize = <a class="code" href="../../d6/d6/foncache_8h.html#a29">CalcBitmapBufferSize</a>(FontSize, dwDestAlign);
00086                         RtlCopyMemory(pDestBits, pSrcBits, dwDestBufferSize);
00087                         <span class="keywordflow">break</span>;
00088                     <span class="comment">//</span>
00089                     <span class="comment">// pDest = WORD, pSrc = BYTE</span>
00090                     <span class="comment">//</span>
00091                     <span class="keywordflow">case</span> <a class="code" href="../../d6/d6/foncache_8h.html#a9">BYTE_ALIGN</a>:
00092                         dwDestBufferSize = <a class="code" href="../../d6/d6/foncache_8h.html#a29">CalcBitmapBufferSize</a>(FontSize, dwDestAlign);
00093                         <span class="keywordflow">if</span> (((FontSize.X % <a class="code" href="../../d6/d6/foncache_8h.html#a4">BITMAP_BITS_BYTE_ALIGN</a>) == 0) &amp;&amp;
00094                             ((FontSize.X % <a class="code" href="../../d6/d6/foncache_8h.html#a5">BITMAP_BITS_WORD_ALIGN</a>) == 0)   ) {
00095                             RtlCopyMemory(pDestBits, pSrcBits, dwDestBufferSize);
00096                         }
00097                         <span class="keywordflow">else</span> {
00098                             RtlZeroMemory(pDestBits, dwDestBufferSize);
00099                             <span class="keywordflow">for</span> (coord.Y=0; coord.Y &lt; FontSize.Y; coord.Y++) {
00100                                 <span class="keywordflow">for</span> (coord.X=0;
00101                                      coord.X &lt; <a class="code" href="../../d4/d6/fullscr_2vga_2foncache_8c.html#a2">CALC_BITMAP_BITS_FOR_X</a>(FontSize.X, BITMAP_BITS_BYTE_ALIGN);
00102                                      coord.X++) {
00103                                     *pDestBits++ = *pSrcBits++;
00104                                 }
00105                                 <span class="keywordflow">if</span> (<a class="code" href="../../d4/d6/fullscr_2vga_2foncache_8c.html#a2">CALC_BITMAP_BITS_FOR_X</a>(FontSize.X, BITMAP_BITS_BYTE_ALIGN) &amp; 1)
00106                                     pDestBits++;
00107                             }
00108                         }
00109                         <span class="keywordflow">break</span>;
00110                 }
00111                 <span class="keywordflow">break</span>;
00112             <span class="keywordflow">case</span> <a class="code" href="../../d6/d6/foncache_8h.html#a9">BYTE_ALIGN</a>:
00113                 <span class="keywordflow">switch</span> (dwSrcAlign) {
00114                     <span class="comment">//</span>
00115                     <span class="comment">// pDest = BYTE, pSrc = BYTE</span>
00116                     <span class="comment">//</span>
00117                     <span class="keywordflow">case</span> <a class="code" href="../../d6/d6/foncache_8h.html#a9">BYTE_ALIGN</a>:
00118                         dwDestBufferSize = <a class="code" href="../../d6/d6/foncache_8h.html#a29">CalcBitmapBufferSize</a>(FontSize, dwDestAlign);
00119                         RtlCopyMemory(pDestBits, pSrcBits, dwDestBufferSize);
00120                         <span class="keywordflow">break</span>;
00121                     <span class="keywordflow">default</span>:
00122                     <span class="comment">//</span>
00123                     <span class="comment">// pDest = BYTE, pSrc = WORD</span>
00124                     <span class="comment">//</span>
00125                     <span class="keywordflow">case</span> <a class="code" href="../../d6/d6/foncache_8h.html#a10">WORD_ALIGN</a>:
00126                         dwDestBufferSize = <a class="code" href="../../d6/d6/foncache_8h.html#a29">CalcBitmapBufferSize</a>(FontSize, dwDestAlign);
00127                         <span class="keywordflow">if</span> (((FontSize.X % <a class="code" href="../../d6/d6/foncache_8h.html#a4">BITMAP_BITS_BYTE_ALIGN</a>) == 0) &amp;&amp;
00128                             ((FontSize.X % <a class="code" href="../../d6/d6/foncache_8h.html#a5">BITMAP_BITS_WORD_ALIGN</a>) == 0)   ) {
00129                             RtlCopyMemory(pDestBits, pSrcBits, dwDestBufferSize);
00130                         }
00131                         <span class="keywordflow">else</span> {
00132                             RtlZeroMemory(pDestBits, dwDestBufferSize);
00133                             <span class="keywordflow">for</span> (coord.Y=0; coord.Y &lt; FontSize.Y; coord.Y++) {
00134                                 <span class="keywordflow">for</span> (coord.X=0;
00135                                      coord.X &lt; <a class="code" href="../../d4/d6/fullscr_2vga_2foncache_8c.html#a2">CALC_BITMAP_BITS_FOR_X</a>(FontSize.X, BITMAP_BITS_BYTE_ALIGN);
00136                                      coord.X++) {
00137                                     *pDestBits++ = *pSrcBits++;
00138                                 }
00139                                 <span class="keywordflow">if</span> (<a class="code" href="../../d4/d6/fullscr_2vga_2foncache_8c.html#a2">CALC_BITMAP_BITS_FOR_X</a>(FontSize.X, BITMAP_BITS_BYTE_ALIGN) &amp; 1)
00140                                     pSrcBits++;
00141                             }
00142                         }
00143                         <span class="keywordflow">break</span>;
00144                 }
00145                 <span class="keywordflow">break</span>;
00146         }
00147 
00148     }
00149     except (EXCEPTION_EXECUTE_HANDLER)
00150     {
00151     }
00152 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a55" doxytag="fsvga.h::CalcBitmapBufferSize" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> CalcBitmapBufferSize           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN COORD&nbsp;</td>
          <td class="mdname" nowrap> <em>FontSize</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>dwAlign</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d5/fullscr_2vga_2foncache_8c-source.html#l00041">41</a> of file <a class="el" href="../../d5/d5/fullscr_2vga_2foncache_8c-source.html">fullscr/vga/foncache.c</a>.
<p>
<pre class="fragment"><div>00045 {
00046     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> uiCount;
00047 
00048     uiCount = <a class="code" href="../../d4/d6/fullscr_2vga_2foncache_8c.html#a2">CALC_BITMAP_BITS_FOR_X</a>(FontSize.X,
00049                                      (dwAlign==BYTE_ALIGN ? BITMAP_BITS_BYTE_ALIGN : BITMAP_BITS_WORD_ALIGN));
00050     uiCount = uiCount * <a class="code" href="../../d6/d6/foncache_8h.html#a7">BITMAP_PLANES</a> * FontSize.Y;
00051     <span class="keywordflow">return</span> uiCount;
00052 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a39" doxytag="fsvga.h::CalcGRAMAddress" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PUCHAR CalcGRAMAddress           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN COORD&nbsp;</td>
          <td class="mdname" nowrap> <em>WindowSize</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d8/d3/struct__DEVICE__EXTENSION.html">PDEVICE_EXTENSION</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>DeviceExtension</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d1/drawscrn_8c-source.html#l00116">116</a> of file <a class="el" href="../../d3/d1/drawscrn_8c-source.html">drawscrn.c</a>.
<p>
References <a class="el" href="../../d3/d1/drawscrn_8c-source.html#l00061">CalcGRAMOffs</a>, and <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>.
<p>
Referenced by <a class="el" href="../../d3/d1/drawscrn_8c-source.html#l00437">FsgCopyFrameBuffer()</a>, <a class="el" href="../../d3/d1/drawscrn_8c-source.html#l00702">FsgInvertCursor()</a>, <a class="el" href="../../d3/d1/drawscrn_8c-source.html#l00609">FsgReverseMousePointer()</a>, and <a class="el" href="../../d3/d1/drawscrn_8c-source.html#l00489">FsgWriteToFrameBuffer()</a>.
<p>
<pre class="fragment"><div>00123                    :
00124 
00125     This routine calcurate a graphics buffer address.
00126 
00127 Arguments:
00128 
00129     WindowSize - Coord of window size.
00130 
00131     DeviceExtension - Pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> miniport driver's device <a class="code" href="../../d7/d1/genuedef_8c.html#a6">extension</a>.
00132 
00133 Return Value:
00134 
00135     Returen to graphics buffer address.
00136 
00137 --*/
00138 {
00139     PUCHAR BufPtr = (PUCHAR)DeviceExtension-&gt;CurrentMode.VideoMemory.FrameBufferBase;
00140 
00141     BufPtr += <a class="code" href="../../d2/d2/drawscrn_8c.html#a2">CalcGRAMOffs</a>(WindowSize, DeviceExtension);
00142     <span class="keywordflow">if</span> ((<a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)(BufPtr -
00143                 (PUCHAR)DeviceExtension-&gt;CurrentMode.VideoMemory.FrameBufferBase)
00144            &gt;= DeviceExtension-&gt;EmulateInfo.LimitGRAM)
00145         <span class="keywordflow">return</span> (BufPtr - DeviceExtension-&gt;EmulateInfo.LimitGRAM);
00146     <span class="keywordflow">else</span>
00147         <span class="keywordflow">return</span> BufPtr;
00148 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a38" doxytag="fsvga.h::CalcGRAMSize" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG CalcGRAMSize           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN COORD&nbsp;</td>
          <td class="mdname" nowrap> <em>WindowSize</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d8/d3/struct__DEVICE__EXTENSION.html">PDEVICE_EXTENSION</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>DeviceExtension</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d1/drawscrn_8c-source.html#l00085">85</a> of file <a class="el" href="../../d3/d1/drawscrn_8c-source.html">drawscrn.c</a>.
<p>
References <a class="el" href="../../d3/d1/drawscrn_8c-source.html#l00047">CalcGRAMScanLine</a>.
<p>
<pre class="fragment"><div>00092                    :
00093 
00094     This Macro calcurate a graphics buffer size.
00095 
00096 Arguments:
00097 
00098     WindowSize - Coord of window size.
00099 
00100     DeviceExtension - Pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> miniport driver's device <a class="code" href="../../d7/d1/genuedef_8c.html#a6">extension</a>.
00101 
00102 Return Value:
00103 
00104     Returen to graphics buffer offset.
00105 
00106 --*/
00107 
00108 {
00109     <span class="keywordflow">return</span> WindowSize.X +
00110            <a class="code" href="../../d2/d2/drawscrn_8c.html#a1">CalcGRAMScanLine</a>(WindowSize.Y, DeviceExtension-&gt;ScreenAndFont.FontSize.Y) *
00111            DeviceExtension-&gt;EmulateInfo.BytePerLine;
00112 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a65" doxytag="fsvga.h::ColorSetDirect" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID ColorSetDirect           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d8/d3/struct__DEVICE__EXTENSION.html">PDEVICE_EXTENSION</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>deviceExtension</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>PUCHAR&nbsp;</td>
          <td class="mdname" nowrap> <em>FrameBuffer</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>ColorFg</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>ColorBg</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d1/port_8c-source.html#l00257">257</a> of file <a class="el" href="../../d7/d1/port_8c-source.html">port.c</a>.
<p>
References <a class="el" href="../../d3/d1/drawscrn_8c-source.html#l00976">AccessGRAM_WR()</a>, <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00132">_DEVICE_EXTENSION::DeviceRegisters</a>, <a class="el" href="../../d2/d5/vga_8h-source.html#l00178">DR_SET</a>, <a class="el" href="../../d2/d5/vga_8h-source.html#l00181">DR_XOR</a>, <a class="el" href="../../d2/d5/vga_8h-source.html#l00171">GRAPH_ADDR_MASK</a>, <a class="el" href="../../d7/d8/fsvga_8h.html#a66a20">GRAPHAddressPort</a>, <a class="el" href="../../d2/d5/vga_8h-source.html#l00125">IND_DATA_ROTATE</a>, <a class="el" href="../../d2/d5/vga_8h-source.html#l00140">IND_SET_RESET</a>, and <a class="el" href="../../d2/d5/vga_8h-source.html#l00124">IND_SET_RESET_ENABLE</a>.
<p>
Referenced by <a class="el" href="../../d3/d1/drawscrn_8c-source.html#l00915">FsgWriteToScreenCommonLVB()</a>, and <a class="el" href="../../d7/d1/port_8c-source.html#l00186">set_opaque_bkgnd_proc()</a>.
<p>
<pre class="fragment"><div>00275 {
00276     <span class="comment">//</span>
00277     <span class="comment">// Set up to write data without interacting with the latches.</span>
00278     <span class="comment">//</span>
00279     WRITE_PORT_USHORT(deviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o48">DeviceRegisters</a>[GRAPHAddressPort],
00280                       MAKEWORD(IND_DATA_ROTATE, DR_SET));
00281 
00282     <span class="comment">//</span>
00283     <span class="comment">// Put the background color in the Set/Reset register.</span>
00284     <span class="comment">//</span>
00285     WRITE_PORT_USHORT(deviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o48">DeviceRegisters</a>[GRAPHAddressPort],
00286                       MAKEWORD(IND_SET_RESET, ColorBg));
00287 
00288     <span class="comment">//</span>
00289     <span class="comment">// That color is used for all planes.</span>
00290     <span class="comment">//</span>
00291     WRITE_PORT_USHORT(deviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o48">DeviceRegisters</a>[GRAPHAddressPort],
00292                       MAKEWORD(IND_SET_RESET_ENABLE, GRAPH_ADDR_MASK));
00293 
00294     <span class="comment">//</span>
00295     <span class="comment">// This gets our background color into the latches.</span>
00296     <span class="comment">//</span>
00297     <a class="code" href="../../d7/d8/fsvga_8h.html#a52">AccessGRAM_WR</a>(FrameBuffer, GRAPH_ADDR_MASK);
00298 
00299     <span class="comment">//</span>
00300     <span class="comment">// Change the Set/Reset register to be all zeroes.</span>
00301     <span class="comment">//</span>
00302     WRITE_PORT_USHORT(deviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o48">DeviceRegisters</a>[GRAPHAddressPort],
00303                       MAKEWORD(IND_SET_RESET, 0));
00304 
00305     <span class="comment">//</span>
00306     <span class="comment">// The Set/Reset enable register now flags where the foreground/background colors are the same.</span>
00307     <span class="comment">//</span>
00308     ColorFg = ~(ColorFg ^ ColorBg);
00309     WRITE_PORT_USHORT(deviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o48">DeviceRegisters</a>[GRAPHAddressPort],
00310                       MAKEWORD(IND_SET_RESET_ENABLE, ColorFg));
00311 
00312     <span class="comment">//</span>
00313     <span class="comment">// Color differences will be xor'd with the latches.</span>
00314     <span class="comment">//</span>
00315     WRITE_PORT_USHORT(deviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o48">DeviceRegisters</a>[GRAPHAddressPort],
00316                       MAKEWORD(IND_DATA_ROTATE, DR_XOR));
00317 
00318 
00319 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a64" doxytag="fsvga.h::ColorSetGridMask" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID ColorSetGridMask           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d8/d3/struct__DEVICE__EXTENSION.html">PDEVICE_EXTENSION</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>deviceExtension</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>BitMask</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d1/port_8c-source.html#l00225">225</a> of file <a class="el" href="../../d7/d1/port_8c-source.html">port.c</a>.
<p>
References <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00132">_DEVICE_EXTENSION::DeviceRegisters</a>, <a class="el" href="../../d2/d5/vga_8h-source.html#l00178">DR_SET</a>, <a class="el" href="../../d2/d5/vga_8h-source.html#l00171">GRAPH_ADDR_MASK</a>, <a class="el" href="../../d7/d8/fsvga_8h.html#a66a20">GRAPHAddressPort</a>, <a class="el" href="../../d2/d5/vga_8h-source.html#l00129">IND_BIT_MASK</a>, <a class="el" href="../../d2/d5/vga_8h-source.html#l00125">IND_DATA_ROTATE</a>, <a class="el" href="../../d2/d5/vga_8h-source.html#l00140">IND_SET_RESET</a>, and <a class="el" href="../../d2/d5/vga_8h-source.html#l00124">IND_SET_RESET_ENABLE</a>.
<p>
Referenced by <a class="el" href="../../d3/d1/drawscrn_8c-source.html#l00915">FsgWriteToScreenCommonLVB()</a>.
<p>
<pre class="fragment"><div>00229 {
00230 
00231     <span class="comment">//</span>
00232     <span class="comment">// That color is used for all planes.</span>
00233     <span class="comment">//</span>
00234     WRITE_PORT_USHORT(deviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o48">DeviceRegisters</a>[GRAPHAddressPort],
00235                       MAKEWORD(IND_SET_RESET_ENABLE, GRAPH_ADDR_MASK));
00236 
00237     <span class="comment">//</span>
00238     <span class="comment">// Change the Set/Reset register to be all set.</span>
00239     <span class="comment">//</span>
00240     WRITE_PORT_USHORT(deviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o48">DeviceRegisters</a>[GRAPHAddressPort],
00241                       MAKEWORD(IND_SET_RESET, 0x07));
00242 
00243     <span class="comment">//</span>
00244     <span class="comment">// Use specified pixel positions.</span>
00245     <span class="comment">//</span>
00246     WRITE_PORT_USHORT(deviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o48">DeviceRegisters</a>[GRAPHAddressPort],
00247                       MAKEWORD(IND_BIT_MASK, BitMask));
00248 
00249     <span class="comment">//</span>
00250     <span class="comment">// Set up to write data without interacting with the latches.</span>
00251     <span class="comment">//</span>
00252     WRITE_PORT_USHORT(deviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o48">DeviceRegisters</a>[GRAPHAddressPort],
00253                       MAKEWORD(IND_DATA_ROTATE, DR_SET));
00254 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a57" doxytag="fsvga.h::ConvertOutputToOem" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int ConvertOutputToOem           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN LPWSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>Source</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN int&nbsp;</td>
          <td class="mdname" nowrap> <em>SourceLength</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT LPSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>Target</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN int&nbsp;</td>
          <td class="mdname" nowrap> <em>TargetLength</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d9/w32_2ntcon_2fullscr_2vga_2misc_8c-source.html#l00031">31</a> of file <a class="el" href="../../d4/d9/w32_2ntcon_2fullscr_2vga_2misc_8c-source.html">w32/ntcon/fullscr/vga/misc.c</a>.
<p>
<pre class="fragment"><div>00045 {
00046     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
00047     <span class="keywordtype">int</span> Length;
00048     UNICODE_STRING SourceUni;
00049     ANSI_STRING TargetAns;
00050     <a class="code" href="../../d1/d1/bench_8c.html#a16">CHAR</a> AnsBuf[256];
00051 
00052     SourceUni.MaximumLength =
00053     SourceUni.Length = SourceLength * <span class="keyword">sizeof</span>(WCHAR);
00054     SourceUni.Buffer = Source;
00055 
00056     TargetAns.Length = 0;
00057     TargetAns.MaximumLength = <span class="keyword">sizeof</span>(AnsBuf);
00058     TargetAns.Buffer = AnsBuf;
00059 
00060     <span class="comment">// Can do this in place</span>
00061     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d6/d6/nls_8c.html#a23">RtlUnicodeStringToAnsiString</a>(&amp;TargetAns,
00062                                           &amp;SourceUni,
00063                                           FALSE);
00064     <span class="keywordflow">if</span> (<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status)) {
00065         Length = <a class="code" href="../../d2/d7/regtest_8c.html#a2">strlen</a>(AnsBuf);
00066         <span class="keywordflow">if</span> (Length &lt;= TargetLength) {
00067             RtlMoveMemory(Target, AnsBuf, Length);
00068             <span class="keywordflow">return</span> Length;
00069         }
00070         <span class="keywordflow">else</span> {
00071             <span class="keywordflow">return</span> 0;
00072         }
00073     } <span class="keywordflow">else</span> {
00074         <span class="keywordflow">return</span> 0;
00075     }
00076 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a23" doxytag="fsvga.h::DriverEntry" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS DriverEntry           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d4/d9/struct__DRIVER__OBJECT.html">PDRIVER_OBJECT</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>DriverObject</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PUNICODE_STRING&nbsp;</td>
          <td class="mdname" nowrap> <em>RegistryPath</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d6/fs__rec_8c-source.html#l00067">67</a> of file <a class="el" href="../../d7/d6/fs__rec_8c-source.html">fs_rec.c</a>.
<p>
<pre class="fragment"><div>00074                    :
00075 
00076     This routine <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> invoked once when <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> driver <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> loaded to allow <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> driver
00077     to initialize itself.  The initialization <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> driver consists of simply
00078     creating a device object <span class="keywordflow">for</span> each <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> of <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a9">file</a> system recognized by <span class="keyword">this</span>
00079     driver, and then registering each as active <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a9">file</a> systems.
00080 
00081 Arguments:
00082 
00083     DriverObject - Pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> driver object <span class="keywordflow">for</span> <span class="keyword">this</span> driver.
00084 
00085     RegistryPath - Pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> registry service node <span class="keywordflow">for</span> <span class="keyword">this</span> driver.
00086 
00087 Return Value:
00088 
00089     The function value <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <span class="keyword">final</span> status of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> initialization <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> driver.
00090 
00091 --*/
00092 
00093 {
00094     <a class="code" href="../../d8/d4/struct__DEVICE__OBJECT.html">PDEVICE_OBJECT</a> UdfsMainRecognizerDeviceObject;
00095     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> status;
00096     ULONG count = 0;
00097 
00098     <a class="code" href="../../d0/d9/ntosdef_8h.html#a28">PAGED_CODE</a>();
00099 
00100     <span class="comment">//</span>
00101     <span class="comment">// Mark the entire driver as pagable.</span>
00102     <span class="comment">//</span>
00103 
00104     <a class="code" href="../../d8/d8/sysload_8c.html#a56">MmPageEntireDriver</a> ((PVOID)DriverEntry);
00105 
00106     <span class="comment">//</span>
00107     <span class="comment">// Begin by initializing the driver object so that it the driver is</span>
00108     <span class="comment">// prepared to provide services.</span>
00109     <span class="comment">//</span>
00110 
00111     DriverObject-&gt;MajorFunction[<a class="code" href="../../d0/d5/io_8h.html#a26">IRP_MJ_FILE_SYSTEM_CONTROL</a>] = <a class="code" href="../../d6/d7/fs__rec_8c.html#a7">FsRecFsControl</a>;
00112     DriverObject-&gt;MajorFunction[<a class="code" href="../../d0/d5/io_8h.html#a13">IRP_MJ_CREATE</a>] = <a class="code" href="../../d6/d7/fs__rec_8c.html#a5">FsRecCreate</a>;
00113     DriverObject-&gt;MajorFunction[<a class="code" href="../../d0/d5/io_8h.html#a31">IRP_MJ_CLEANUP</a>] = <a class="code" href="../../d6/d7/fs__rec_8c.html#a4">FsRecCleanupClose</a>;
00114     DriverObject-&gt;MajorFunction[<a class="code" href="../../d0/d5/io_8h.html#a15">IRP_MJ_CLOSE</a>] = <a class="code" href="../../d6/d7/fs__rec_8c.html#a4">FsRecCleanupClose</a>;
00115     DriverObject-&gt;DriverUnload = <a class="code" href="../../d6/d7/fs__rec_8c.html#a8">FsRecUnload</a>;
00116 
00117     <a class="code" href="../../d6/d7/fs__rec_8c.html#a2">FsRecLoadSync</a> = <a class="code" href="../../d5/d8/ex_8h.html#a4">ExAllocatePoolWithTag</a>( NonPagedPool, <span class="keyword">sizeof</span>(<a class="code" href="../../d2/d6/struct__KEVENT.html">KEVENT</a>), FSREC_POOL_TAG );
00118 
00119     <span class="keywordflow">if</span> (<a class="code" href="../../d6/d7/fs__rec_8c.html#a2">FsRecLoadSync</a> == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00120 
00121         <span class="keywordflow">return</span> STATUS_INSUFFICIENT_RESOURCES;
00122     }
00123 
00124     <a class="code" href="../../d4/d9/ke_8h.html#a20">KeInitializeEvent</a>( FsRecLoadSync, SynchronizationEvent, TRUE );
00125 
00126     <span class="comment">//</span>
00127     <span class="comment">// Create and initialize each of the file system driver type device</span>
00128     <span class="comment">// objects.</span>
00129     <span class="comment">//</span>
00130 
00131     status = <a class="code" href="../../d7/d7/fs__rec_8h.html#a26">FsRecCreateAndRegisterDO</a>( DriverObject,
00132                                        NULL,
00133                                        NULL,
00134                                        L<span class="stringliteral">"\\Cdfs"</span>,
00135                                        L<span class="stringliteral">"\\FileSystem\\CdfsRecognizer"</span>,
00136                                        CdfsFileSystem,
00137                                        FILE_DEVICE_CD_ROM_FILE_SYSTEM );
00138     <span class="keywordflow">if</span> (<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>( status )) {
00139         count++;
00140     }
00141 
00142     status = <a class="code" href="../../d7/d7/fs__rec_8h.html#a26">FsRecCreateAndRegisterDO</a>( DriverObject,
00143                                        NULL,
00144                                        &amp;UdfsMainRecognizerDeviceObject,
00145                                        L<span class="stringliteral">"\\UdfsCdRom"</span>,
00146                                        L<span class="stringliteral">"\\FileSystem\\UdfsCdRomRecognizer"</span>,
00147                                        UdfsFileSystem,
00148                                        FILE_DEVICE_CD_ROM_FILE_SYSTEM );
00149     <span class="keywordflow">if</span> (<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>( status )) {
00150         count++;
00151     }
00152 
00153     status = <a class="code" href="../../d7/d7/fs__rec_8h.html#a26">FsRecCreateAndRegisterDO</a>( DriverObject,
00154                                        UdfsMainRecognizerDeviceObject,
00155                                        NULL,
00156                                        L<span class="stringliteral">"\\UdfsDisk"</span>,
00157                                        L<span class="stringliteral">"\\FileSystem\\UdfsDiskRecognizer"</span>,
00158                                        UdfsFileSystem,
00159                                        FILE_DEVICE_DISK_FILE_SYSTEM );
00160     <span class="keywordflow">if</span> (<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>( status )) {
00161         count++;
00162     }
00163 
00164     status = <a class="code" href="../../d7/d7/fs__rec_8h.html#a26">FsRecCreateAndRegisterDO</a>( DriverObject,
00165                                        NULL,
00166                                        NULL,
00167                                        L<span class="stringliteral">"\\Fat"</span>,
00168                                        L<span class="stringliteral">"\\FileSystem\\FatRecognizer"</span>,
00169                                        FatFileSystem,
00170                                        FILE_DEVICE_DISK_FILE_SYSTEM );
00171     <span class="keywordflow">if</span> (<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>( status )) {
00172         count++;
00173     }
00174 
00175     status = <a class="code" href="../../d7/d7/fs__rec_8h.html#a26">FsRecCreateAndRegisterDO</a>( DriverObject,
00176                                        NULL,
00177                                        NULL,
00178                                        L<span class="stringliteral">"\\Ntfs"</span>,
00179                                        L<span class="stringliteral">"\\FileSystem\\NtfsRecognizer"</span>,
00180                                        NtfsFileSystem,
00181                                        FILE_DEVICE_DISK_FILE_SYSTEM );
00182     <span class="keywordflow">if</span> (<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>( status )) {
00183         count++;
00184     }
00185 
00186     <span class="keywordflow">if</span> (count) {
00187         <span class="keywordflow">return</span> STATUS_SUCCESS;
00188     } <span class="keywordflow">else</span> {
00189         <span class="keywordflow">return</span> STATUS_IMAGE_ALREADY_LOADED;
00190     }
00191 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a46" doxytag="fsvga.h::FsgCopyFrameBuffer" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS FsgCopyFrameBuffer           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d8/d3/struct__DEVICE__EXTENSION.html">PDEVICE_EXTENSION</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>DeviceExtension</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>PFSVIDEO_COPY_FRAME_BUFFER&nbsp;</td>
          <td class="mdname" nowrap> <em>CopyFrameBuffer</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>inputBufferLength</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d1/drawscrn_8c-source.html#l00437">437</a> of file <a class="el" href="../../d3/d1/drawscrn_8c-source.html">drawscrn.c</a>.
<p>
References <a class="el" href="../../d3/d1/drawscrn_8c-source.html#l00116">CalcGRAMAddress()</a>, <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00143">_DEVICE_EXTENSION::CurrentMode</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d3/d1/drawscrn_8c-source.html#l00702">FsgInvertCursor()</a>, <a class="el" href="../../d3/d1/drawscrn_8c-source.html#l00314">MoveGRAM()</a>, <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00148">_DEVICE_EXTENSION::ScreenAndFont</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d7/d7/fsvga_8c-source.html#l01349">FsVgaCopyFrameBuffer()</a>.
<p>
<pre class="fragment"><div>00445                    :
00446 
00447     This routine copy <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> frame buffer.
00448 
00449 Arguments:
00450 
00451     DeviceExtension - Pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> miniport driver's device <a class="code" href="../../d7/d1/genuedef_8c.html#a6">extension</a>.
00452 
00453     CopyFrameBuffer - Pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> structure containing <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> information about <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> copy frame buffer.
00454 
00455     inputBufferLength - Length of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> input buffer supplied by <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> user.
00456 
00457 Return Value:
00458 
00459     STATUS_INSUFFICIENT_BUFFER <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> input buffer was not large enough
00460         <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> input data.
00461 
00462     STATUS_SUCCESS <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> operation completed successfully.
00463 
00464 --*/
00465 
00466 {
00467     PUCHAR SourcePtr, TargetPtr;
00468 
00469     <a class="code" href="../../d7/d8/fsvga_8h.html#a49">FsgInvertCursor</a>(DeviceExtension,FALSE);
00470 
00471     SourcePtr = <a class="code" href="../../d7/d8/fsvga_8h.html#a39">CalcGRAMAddress</a> (CopyFrameBuffer-&gt;SrcScreen.Position,
00472                                  DeviceExtension);
00473     TargetPtr = <a class="code" href="../../d7/d8/fsvga_8h.html#a39">CalcGRAMAddress</a> (CopyFrameBuffer-&gt;DestScreen.Position,
00474                                  DeviceExtension);
00475     <a class="code" href="../../d7/d8/fsvga_8h.html#a44">MoveGRAM</a> (TargetPtr,
00476               SourcePtr,
00477               CopyFrameBuffer-&gt;SrcScreen.nNumberOfChars *
00478                   DeviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o51">ScreenAndFont</a>.FontSize.Y,
00479               DeviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o50">CurrentMode</a>.VideoMemory.FrameBufferBase,
00480               DeviceExtension
00481              );
00482 
00483     <a class="code" href="../../d7/d8/fsvga_8h.html#a49">FsgInvertCursor</a>(DeviceExtension,TRUE);
00484 
00485     <span class="keywordflow">return</span> STATUS_SUCCESS;
00486 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a49" doxytag="fsvga.h::FsgInvertCursor" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS FsgInvertCursor           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d8/d3/struct__DEVICE__EXTENSION.html">PDEVICE_EXTENSION</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>DeviceExtension</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>BOOL&nbsp;</td>
          <td class="mdname" nowrap> <em>Invert</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d1/drawscrn_8c-source.html#l00702">702</a> of file <a class="el" href="../../d3/d1/drawscrn_8c-source.html">drawscrn.c</a>.
<p>
References <a class="el" href="../../d3/d1/drawscrn_8c-source.html#l00998">AccessGRAM_AND()</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d0/d7/halvprnt_8c-source.html#l00031">BYTE</a>, <a class="el" href="../../d3/d1/drawscrn_8c-source.html#l00116">CalcGRAMAddress()</a>, <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00105">_EMULATE_BUFFER_INFORMATION::CursorAttributes</a>, <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00106">_EMULATE_BUFFER_INFORMATION::CursorPosition</a>, <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00153">_DEVICE_EXTENSION::EmulateInfo</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d3/d1/drawscrn_8c-source.html#l00200">NextGRAMRow()</a>, <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00148">_DEVICE_EXTENSION::ScreenAndFont</a>, <a class="el" href="../../d7/d1/port_8c-source.html#l00152">SetGRAMInvertMode()</a>, <a class="el" href="../../d7/d1/port_8c-source.html#l00081">SetGRAMWriteMode()</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00062">SHORT</a>, <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00107">_EMULATE_BUFFER_INFORMATION::ShowCursor</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d3/d1/drawscrn_8c-source.html#l00437">FsgCopyFrameBuffer()</a>, <a class="el" href="../../d3/d1/drawscrn_8c-source.html#l00609">FsgReverseMousePointer()</a>, <a class="el" href="../../d3/d1/drawscrn_8c-source.html#l00489">FsgWriteToFrameBuffer()</a>, <a class="el" href="../../d7/d7/fsvga_8c-source.html#l01777">FsVgaSetCursorAttribute()</a>, and <a class="el" href="../../d7/d7/fsvga_8c-source.html#l01710">FsVgaSetCursorPosition()</a>.
<p>
<pre class="fragment"><div>00709                    :
00710 
00711     This routine inverts <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> cursor.
00712 
00713 Arguments:
00714 
00715     DeviceExtension - Pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> miniport driver's device <a class="code" href="../../d7/d1/genuedef_8c.html#a6">extension</a>.
00716 
00717     Invert - 
00718 
00719 Return Value:
00720 
00721     STATUS_INSUFFICIENT_BUFFER <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> input buffer was not large enough
00722         <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> input data.
00723 
00724     STATUS_SUCCESS <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> operation completed successfully.
00725 
00726 --*/
00727 
00728 {
00729     PUCHAR CurFrameBufPtr;
00730     COORD  CursorPosition;
00731     COORD  FontSize;
00732     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a>  i;
00733     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a>  TopScanLine;
00734     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>   fOneMore = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00735 
00736     <span class="keywordflow">if</span> (DeviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o52">EmulateInfo</a>.<a class="code" href="../../d1/d3/struct__EMULATE__BUFFER__INFORMATION.html#o11">ShowCursor</a> == Invert)
00737         <span class="keywordflow">return</span> STATUS_SUCCESS;
00738 
00739     DeviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o52">EmulateInfo</a>.<a class="code" href="../../d1/d3/struct__EMULATE__BUFFER__INFORMATION.html#o11">ShowCursor</a> = Invert;
00740 
00741     <span class="keywordflow">if</span> (!(DeviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o52">EmulateInfo</a>.<a class="code" href="../../d1/d3/struct__EMULATE__BUFFER__INFORMATION.html#o9">CursorAttributes</a>.Enable))
00742         <span class="keywordflow">return</span> STATUS_SUCCESS;
00743 
00744     FontSize = DeviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o51">ScreenAndFont</a>.FontSize;
00745     <span class="keywordflow">if</span> (DeviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o51">ScreenAndFont</a>.ScreenSize.Y &gt; 25)
00746     {
00747         TopScanLine = ((DeviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o52">EmulateInfo</a>.<a class="code" href="../../d1/d3/struct__EMULATE__BUFFER__INFORMATION.html#o9">CursorAttributes</a>.Height + 8) * 100 / 8) - 100;
00748     }
00749     <span class="keywordflow">else</span>
00750     {
00751         TopScanLine = ((DeviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o52">EmulateInfo</a>.<a class="code" href="../../d1/d3/struct__EMULATE__BUFFER__INFORMATION.html#o9">CursorAttributes</a>.Height + 16) * 100 / 16) - 100;
00752     }
00753     TopScanLine = (FontSize.Y * TopScanLine) / 100;
00754 
00755     CursorPosition.X = DeviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o52">EmulateInfo</a>.<a class="code" href="../../d1/d3/struct__EMULATE__BUFFER__INFORMATION.html#o10">CursorPosition</a>.Coord.Column;
00756     CursorPosition.Y = DeviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o52">EmulateInfo</a>.<a class="code" href="../../d1/d3/struct__EMULATE__BUFFER__INFORMATION.html#o10">CursorPosition</a>.Coord.Row;
00757     <span class="keywordflow">if</span> ( (0 &lt;= CursorPosition.X &amp;&amp;
00758                CursorPosition.X &lt; DeviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o51">ScreenAndFont</a>.ScreenSize.X) &amp;&amp;
00759          (0 &lt;= CursorPosition.Y &amp;&amp;
00760                CursorPosition.Y &lt; DeviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o51">ScreenAndFont</a>.ScreenSize.Y)    )
00761     {
00762         <span class="keywordflow">switch</span> (DeviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o52">EmulateInfo</a>.<a class="code" href="../../d1/d3/struct__EMULATE__BUFFER__INFORMATION.html#o10">CursorPosition</a>.dwType)
00763         {
00764             <span class="keywordflow">case</span> CHAR_TYPE_LEADING:
00765                 <span class="keywordflow">if</span> (CursorPosition.X != DeviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o51">ScreenAndFont</a>.ScreenSize.X-1)
00766                 {
00767                     fOneMore = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00768                 }
00769                 <span class="keywordflow">break</span>;
00770             <span class="keywordflow">case</span> CHAR_TYPE_TRAILING:
00771                 <span class="keywordflow">if</span> (CursorPosition.X != 0)
00772                 {
00773                     fOneMore = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00774                     CursorPosition.X--;
00775                 }
00776                 <span class="keywordflow">break</span>;
00777         }
00778 
00779         CurFrameBufPtr = <a class="code" href="../../d7/d8/fsvga_8h.html#a39">CalcGRAMAddress</a> (CursorPosition,
00780                                           DeviceExtension);
00781 
00782         <span class="comment">/*</span>
00783 <span class="comment">         * CursorAttributes.Height is top scan lines.</span>
00784 <span class="comment">         */</span>
00785         <span class="keywordflow">for</span> (i = 0; i &lt; TopScanLine; i++)
00786         {
00787             CurFrameBufPtr = <a class="code" href="../../d7/d8/fsvga_8h.html#a41">NextGRAMRow</a>(CurFrameBufPtr,DeviceExtension);
00788         }
00789 
00790         <span class="comment">//</span>
00791         <span class="comment">// Set invert mode of graphics register</span>
00792         <span class="comment">//</span>
00793         <a class="code" href="../../d6/d2/port_8c.html#a3">SetGRAMInvertMode</a>(DeviceExtension);
00794 
00795         <span class="comment">/*</span>
00796 <span class="comment">         * CursorAttributes.Width is bottom scan lines.</span>
00797 <span class="comment">         */</span>
00798         <span class="keywordflow">for</span> ( ; i &lt; FontSize.Y; i++)
00799         {
00800             <a class="code" href="../../d7/d8/fsvga_8h.html#a54">AccessGRAM_AND</a>(CurFrameBufPtr, (BYTE)-1);
00801             <span class="keywordflow">if</span> (fOneMore)
00802                 <a class="code" href="../../d7/d8/fsvga_8h.html#a54">AccessGRAM_AND</a>(CurFrameBufPtr+1, (BYTE)-1);
00803             CurFrameBufPtr = <a class="code" href="../../d7/d8/fsvga_8h.html#a41">NextGRAMRow</a>(CurFrameBufPtr,DeviceExtension);
00804         }
00805 
00806         <a class="code" href="../../d6/d2/port_8c.html#a1">SetGRAMWriteMode</a>(DeviceExtension);
00807     }
00808 
00809     <span class="keywordflow">return</span> STATUS_SUCCESS;
00810 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a48" doxytag="fsvga.h::FsgReverseMousePointer" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS FsgReverseMousePointer           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d8/d3/struct__DEVICE__EXTENSION.html">PDEVICE_EXTENSION</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>DeviceExtension</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>PFSVIDEO_REVERSE_MOUSE_POINTER&nbsp;</td>
          <td class="mdname" nowrap> <em>MouseBuffer</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>inputBufferLength</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d1/drawscrn_8c-source.html#l00609">609</a> of file <a class="el" href="../../d3/d1/drawscrn_8c-source.html">drawscrn.c</a>.
<p>
References <a class="el" href="../../d3/d1/drawscrn_8c-source.html#l00998">AccessGRAM_AND()</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d0/d7/halvprnt_8c-source.html#l00031">BYTE</a>, <a class="el" href="../../d3/d1/drawscrn_8c-source.html#l00116">CalcGRAMAddress()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d3/d1/drawscrn_8c-source.html#l00702">FsgInvertCursor()</a>, <a class="el" href="../../d3/d1/drawscrn_8c-source.html#l00200">NextGRAMRow()</a>, <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00148">_DEVICE_EXTENSION::ScreenAndFont</a>, <a class="el" href="../../d7/d1/port_8c-source.html#l00152">SetGRAMInvertMode()</a>, <a class="el" href="../../d7/d1/port_8c-source.html#l00081">SetGRAMWriteMode()</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00062">SHORT</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d7/d7/fsvga_8c-source.html#l01546">FsVgaReverseMousePointer()</a>.
<p>
<pre class="fragment"><div>00617                    :
00618 
00619     This routine reverse <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> frame buffer <span class="keywordflow">for</span> mouse pointer.
00620 
00621 Arguments:
00622 
00623     DeviceExtension - Pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> miniport driver's device <a class="code" href="../../d7/d1/genuedef_8c.html#a6">extension</a>.
00624 
00625     MouseBuffer - Pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> structure containing <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> information about <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> mouse frame buffer.
00626 
00627     inputBufferLength - Length of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> input buffer supplied by <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> user.
00628 
00629 Return Value:
00630 
00631     STATUS_INSUFFICIENT_BUFFER <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> input buffer was not large enough
00632         <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> input data.
00633 
00634     STATUS_SUCCESS <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> operation completed successfully.
00635 
00636 --*/
00637 
00638 {
00639 
00640     PUCHAR CurFrameBufPtr;
00641     COORD  CursorPosition;
00642     COORD  FontSize;
00643     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a>  i;
00644     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>   fOneMore = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00645 
00646     <a class="code" href="../../d7/d8/fsvga_8h.html#a49">FsgInvertCursor</a>(DeviceExtension,FALSE);
00647 
00648     FontSize = DeviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o51">ScreenAndFont</a>.FontSize;
00649 
00650     CursorPosition.X = MouseBuffer-&gt;Screen.Position.X;
00651     CursorPosition.Y = MouseBuffer-&gt;Screen.Position.Y;
00652     <span class="keywordflow">if</span> ( (0 &lt;= CursorPosition.X &amp;&amp;
00653                CursorPosition.X &lt; MouseBuffer-&gt;Screen.ScreenSize.X) &amp;&amp;
00654          (0 &lt;= CursorPosition.Y &amp;&amp;
00655                CursorPosition.Y &lt; MouseBuffer-&gt;Screen.ScreenSize.Y)    )
00656     {
00657         <span class="keywordflow">switch</span> (MouseBuffer-&gt;dwType)
00658         {
00659             <span class="keywordflow">case</span> CHAR_TYPE_LEADING:
00660                 <span class="keywordflow">if</span> (CursorPosition.X != MouseBuffer-&gt;Screen.ScreenSize.X-1)
00661                 {
00662                     fOneMore = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00663                 }
00664                 <span class="keywordflow">break</span>;
00665             <span class="keywordflow">case</span> CHAR_TYPE_TRAILING:
00666                 <span class="keywordflow">if</span> (CursorPosition.X != 0)
00667                 {
00668                     fOneMore = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00669                     CursorPosition.X--;
00670                 }
00671                 <span class="keywordflow">break</span>;
00672         }
00673 
00674         CurFrameBufPtr = <a class="code" href="../../d7/d8/fsvga_8h.html#a39">CalcGRAMAddress</a> (CursorPosition,
00675                                           DeviceExtension);
00676 
00677         <span class="comment">//</span>
00678         <span class="comment">// Set invert mode of graphics register</span>
00679         <span class="comment">//</span>
00680         <a class="code" href="../../d6/d2/port_8c.html#a3">SetGRAMInvertMode</a>(DeviceExtension);
00681 
00682         <span class="comment">/*</span>
00683 <span class="comment">         * CursorAttributes.Width is bottom scan lines.</span>
00684 <span class="comment">         */</span>
00685         <span class="keywordflow">for</span> (i=0 ; i &lt; FontSize.Y; i++)
00686         {
00687             <a class="code" href="../../d7/d8/fsvga_8h.html#a54">AccessGRAM_AND</a>(CurFrameBufPtr, (BYTE)-1);
00688             <span class="keywordflow">if</span> (fOneMore)
00689                 <a class="code" href="../../d7/d8/fsvga_8h.html#a54">AccessGRAM_AND</a>(CurFrameBufPtr+1, (BYTE)-1);
00690             CurFrameBufPtr = <a class="code" href="../../d7/d8/fsvga_8h.html#a41">NextGRAMRow</a>(CurFrameBufPtr,DeviceExtension);
00691         }
00692 
00693         <a class="code" href="../../d6/d2/port_8c.html#a1">SetGRAMWriteMode</a>(DeviceExtension);
00694     }
00695 
00696     <a class="code" href="../../d7/d8/fsvga_8h.html#a49">FsgInvertCursor</a>(DeviceExtension,TRUE);
00697 
00698     <span class="keywordflow">return</span> STATUS_SUCCESS;
00699 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a45" doxytag="fsvga.h::FsgVgaInitializeHWFlags" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS FsgVgaInitializeHWFlags           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d8/d3/struct__DEVICE__EXTENSION.html">PDEVICE_EXTENSION</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>DeviceExtension</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d1/drawscrn_8c-source.html#l00387">387</a> of file <a class="el" href="../../d3/d1/drawscrn_8c-source.html">drawscrn.c</a>.
<p>
References <a class="el" href="../../d0/d7/halvprnt_8c-source.html#l00031">BYTE</a>, <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00093">_EMULATE_BUFFER_INFORMATION::BytePerLine</a>, <a class="el" href="../../d3/d1/drawscrn_8c-source.html#l00047">CalcGRAMScanLine</a>, <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00102">_EMULATE_BUFFER_INFORMATION::ColorBg</a>, <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00101">_EMULATE_BUFFER_INFORMATION::ColorFg</a>, <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00138">_DEVICE_EXTENSION::Configuration</a>, <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00105">_EMULATE_BUFFER_INFORMATION::CursorAttributes</a>, <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00097">_EMULATE_BUFFER_INFORMATION::DeltaNextFontRow</a>, <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00153">_DEVICE_EXTENSION::EmulateInfo</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d3/d1/drawscrn_8c-source.html#l00076">GetBytePerLine</a>, <a class="el" href="../../d7/d1/port_8c-source.html#l00031">GetHardwareScrollReg()</a>, <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00056">_FSVGA_CONFIGURATION_INFORMATION::HardwareScroll</a>, <a class="el" href="../../d2/d9/cmchek_8c-source.html#l00095">Index</a>, <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00096">LIMIT_64K</a>, <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00095">_EMULATE_BUFFER_INFORMATION::LimitGRAM</a>, <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00094">_EMULATE_BUFFER_INFORMATION::MaxScanLine</a>, <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00148">_DEVICE_EXTENSION::ScreenAndFont</a>, <a class="el" href="../../d7/d1/port_8c-source.html#l00081">SetGRAMWriteMode()</a>, <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00107">_EMULATE_BUFFER_INFORMATION::ShowCursor</a>, and <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00059">USE_LINE_COMPARE</a>.
<p>
Referenced by <a class="el" href="../../d7/d7/fsvga_8c-source.html#l01663">FsVgaSetScreenInformation()</a>.
<p>
<pre class="fragment"><div>00393                    :
00394 
00395     This routine initialize <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> hardware scrolls flag and any values.
00396 
00397 Arguments:
00398 
00399     EmulateInfo - Pointer to screen emulate information structure.
00400 
00401 Return Value:
00402 
00403 --*/
00404 
00405 {
00406     ULONG <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>;
00407 
00408     <a class="code" href="../../d6/d2/port_8c.html#a0">GetHardwareScrollReg</a>(DeviceExtension);
00409     DeviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o52">EmulateInfo</a>.<a class="code" href="../../d1/d3/struct__EMULATE__BUFFER__INFORMATION.html#o3">BytePerLine</a> =
00410         (WORD)<a class="code" href="../../d2/d2/drawscrn_8c.html#a3">GetBytePerLine</a>(DeviceExtension);
00411     DeviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o52">EmulateInfo</a>.<a class="code" href="../../d1/d3/struct__EMULATE__BUFFER__INFORMATION.html#o4">MaxScanLine</a> =
00412         (WORD)<a class="code" href="../../d2/d2/drawscrn_8c.html#a1">CalcGRAMScanLine</a>(DeviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o51">ScreenAndFont</a>.ScreenSize.Y,
00413                                DeviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o51">ScreenAndFont</a>.FontSize.Y);
00414     DeviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o52">EmulateInfo</a>.<a class="code" href="../../d1/d3/struct__EMULATE__BUFFER__INFORMATION.html#o6">DeltaNextFontRow</a> =
00415         DeviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o52">EmulateInfo</a>.<a class="code" href="../../d1/d3/struct__EMULATE__BUFFER__INFORMATION.html#o3">BytePerLine</a> * DeviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o51">ScreenAndFont</a>.FontSize.Y;
00416 
00417     <span class="keywordflow">if</span> (DeviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o49">Configuration</a>.<a class="code" href="../../d3/d1/struct__FSVGA__CONFIGURATION__INFORMATION.html#o2">HardwareScroll</a> &amp; <a class="code" href="../../d7/d8/fsvga_8h.html#a5">USE_LINE_COMPARE</a>) {
00418         DeviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o52">EmulateInfo</a>.<a class="code" href="../../d1/d3/struct__EMULATE__BUFFER__INFORMATION.html#o5">LimitGRAM</a> =
00419             DeviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o52">EmulateInfo</a>.<a class="code" href="../../d1/d3/struct__EMULATE__BUFFER__INFORMATION.html#o4">MaxScanLine</a> * DeviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o52">EmulateInfo</a>.<a class="code" href="../../d1/d3/struct__EMULATE__BUFFER__INFORMATION.html#o3">BytePerLine</a>;
00420     }
00421     <span class="keywordflow">else</span> {
00422         DeviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o52">EmulateInfo</a>.<a class="code" href="../../d1/d3/struct__EMULATE__BUFFER__INFORMATION.html#o5">LimitGRAM</a> = <a class="code" href="../../d7/d8/fsvga_8h.html#a7">LIMIT_64K</a>;
00423     }
00424 
00425     DeviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o52">EmulateInfo</a>.<a class="code" href="../../d1/d3/struct__EMULATE__BUFFER__INFORMATION.html#o7">ColorFg</a> = (<a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a>)-1;
00426     DeviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o52">EmulateInfo</a>.<a class="code" href="../../d1/d3/struct__EMULATE__BUFFER__INFORMATION.html#o8">ColorBg</a> = (<a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a>)-1;
00427 
00428     DeviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o52">EmulateInfo</a>.<a class="code" href="../../d1/d3/struct__EMULATE__BUFFER__INFORMATION.html#o9">CursorAttributes</a>.Enable = 0;
00429     DeviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o52">EmulateInfo</a>.<a class="code" href="../../d1/d3/struct__EMULATE__BUFFER__INFORMATION.html#o11">ShowCursor</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00430 
00431     <a class="code" href="../../d6/d2/port_8c.html#a1">SetGRAMWriteMode</a>(DeviceExtension);
00432 
00433     <span class="keywordflow">return</span> STATUS_SUCCESS;
00434 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a47" doxytag="fsvga.h::FsgWriteToFrameBuffer" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS FsgWriteToFrameBuffer           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d8/d3/struct__DEVICE__EXTENSION.html">PDEVICE_EXTENSION</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>DeviceExtension</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>PFSVIDEO_WRITE_TO_FRAME_BUFFER&nbsp;</td>
          <td class="mdname" nowrap> <em>WriteFrameBuffer</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>inputBufferLength</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d1/drawscrn_8c-source.html#l00489">489</a> of file <a class="el" href="../../d3/d1/drawscrn_8c-source.html">drawscrn.c</a>.
<p>
References <a class="el" href="../../d5/d5/fullscr_2vga_2foncache_8c-source.html#l00056">AlignCopyMemory()</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d0/d7/halvprnt_8c-source.html#l00031">BYTE</a>, <a class="el" href="../../d7/d5/foncache_8h-source.html#l00074">BYTE_ALIGN</a>, <a class="el" href="../../d5/d5/fullscr_2vga_2foncache_8c-source.html#l00041">CalcBitmapBufferSize()</a>, <a class="el" href="../../d3/d1/drawscrn_8c-source.html#l00116">CalcGRAMAddress()</a>, <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00102">_EMULATE_BUFFER_INFORMATION::ColorBg</a>, <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00101">_EMULATE_BUFFER_INFORMATION::ColorFg</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00153">_DEVICE_EXTENSION::EmulateInfo</a>, <a class="el" href="../../d6/d4/cc_8h-source.html#l00126">ExAllocatePool</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00055">EXCEPTION_EXECUTE_HANDLER</a>, <a class="el" href="../../d7/d2/cmwraper_8c-source.html#l00304">ExFreePool()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d3/d1/drawscrn_8c-source.html#l00702">FsgInvertCursor()</a>, <a class="el" href="../../d3/d1/drawscrn_8c-source.html#l00813">FsgWriteToScreen()</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d5/d8/ex_8h.html#a329a174">PagedPool</a>, <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00148">_DEVICE_EXTENSION::ScreenAndFont</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00135">Status</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, and <a class="el" href="../../d7/d5/foncache_8h-source.html#l00075">WORD_ALIGN</a>.
<p>
Referenced by <a class="el" href="../../d7/d7/fsvga_8c-source.html#l01429">FsVgaWriteToFrameBuffer()</a>.
<p>
<pre class="fragment"><div>00497                    :
00498 
00499     This routine write <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> frame buffer.
00500 
00501 Arguments:
00502 
00503     DeviceExtension - Pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> miniport driver's device <a class="code" href="../../d7/d1/genuedef_8c.html#a6">extension</a>.
00504 
00505     WriteFrameBuffer - Pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> structure containing <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> information about <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> write frame buffer.
00506 
00507     inputBufferLength - Length of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> input buffer supplied by <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> user.
00508 
00509 Return Value:
00510 
00511     STATUS_INSUFFICIENT_BUFFER <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> input buffer was not large enough
00512         <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> input data.
00513 
00514     STATUS_SUCCESS <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> operation completed successfully.
00515 
00516 --*/
00517 
00518 {
00519     PCHAR_IMAGE_INFO pCharInfoUni = WriteFrameBuffer-&gt;SrcBuffer;
00520     PUCHAR TargetPtr;
00521     COORD Position = WriteFrameBuffer-&gt;DestScreen.Position;
00522     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> Length = WriteFrameBuffer-&gt;DestScreen.nNumberOfChars;
00523     COORD FontSize1 = DeviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o51">ScreenAndFont</a>.FontSize;
00524     COORD FontSize2;
00525     PVOID pCapBuffer = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00526     ULONG cCapBuffer = 0;
00527     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>  fDbcs;
00528     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
00529 
00530     <a class="code" href="../../d7/d8/fsvga_8h.html#a49">FsgInvertCursor</a>(DeviceExtension,FALSE);
00531 
00532     DeviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o52">EmulateInfo</a>.<a class="code" href="../../d1/d3/struct__EMULATE__BUFFER__INFORMATION.html#o7">ColorFg</a> = (<a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a>)-1;
00533     DeviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o52">EmulateInfo</a>.<a class="code" href="../../d1/d3/struct__EMULATE__BUFFER__INFORMATION.html#o8">ColorBg</a> = (<a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a>)-1;
00534 
00535     FontSize2 = FontSize1;
00536     FontSize2.X *= 2;
00537     cCapBuffer = <a class="code" href="../../d6/d6/foncache_8h.html#a29">CalcBitmapBufferSize</a>(FontSize2,BYTE_ALIGN);
00538     pCapBuffer = <a class="code" href="../../d5/d5/cc_8h.html#a10">ExAllocatePool</a>(PagedPool, cCapBuffer);
00539 
00540     <span class="keywordflow">while</span> (Length--)
00541     {
00542         <span class="keywordflow">if</span> (pCharInfoUni-&gt;FontImageInfo.ImageBits != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00543         {
00544             <span class="keywordflow">try</span>
00545             {
00546                 fDbcs = pCharInfoUni-&gt;CharInfo.Attributes &amp; COMMON_LVB_SBCSDBCS;
00547                 <a class="code" href="../../d7/d8/fsvga_8h.html#a56">AlignCopyMemory</a>((PVOID)pCapBuffer,                    <span class="comment">// pDestBits</span>
00548                                 BYTE_ALIGN,                           <span class="comment">// dwDestAlign</span>
00549                                 pCharInfoUni-&gt;FontImageInfo.ImageBits,<span class="comment">// pSrcBits</span>
00550                                 WORD_ALIGN,                           <span class="comment">// dwSrcAlign</span>
00551                                 fDbcs ? FontSize2 : FontSize1);
00552 
00553                 TargetPtr = <a class="code" href="../../d7/d8/fsvga_8h.html#a39">CalcGRAMAddress</a> (Position,
00554                                              DeviceExtension);
00555                 <span class="keywordflow">if</span> (fDbcs)
00556                 {
00557                     <span class="keywordflow">if</span> (Length)
00558                     {
00559                         <a class="code" href="../../d7/d8/fsvga_8h.html#a50">FsgWriteToScreen</a>(TargetPtr, pCapBuffer, 2, fDbcs,
00560                                          pCharInfoUni-&gt;CharInfo.Attributes,
00561                                          (pCharInfoUni+1)-&gt;CharInfo.Attributes,
00562                                          DeviceExtension);
00563                     }
00564                     <span class="keywordflow">else</span>
00565                     {
00566                         <a class="code" href="../../d7/d8/fsvga_8h.html#a50">FsgWriteToScreen</a>(TargetPtr, pCapBuffer, 2, FALSE,
00567                                          pCharInfoUni-&gt;CharInfo.Attributes,
00568                                          (WORD)-1,
00569                                          DeviceExtension);
00570                     }
00571                 }
00572                 <span class="keywordflow">else</span>
00573                 {
00574                     <a class="code" href="../../d7/d8/fsvga_8h.html#a50">FsgWriteToScreen</a>(TargetPtr, pCapBuffer, 1, fDbcs,
00575                                      pCharInfoUni-&gt;CharInfo.Attributes,
00576                                      (WORD)-1,
00577                                      DeviceExtension);
00578                 }
00579 
00580             }
00581             except (EXCEPTION_EXECUTE_HANDLER)
00582             {
00583             }
00584 
00585         }
00586 
00587         <span class="keywordflow">if</span> (fDbcs &amp;&amp; Length)
00588         {
00589             Length--;
00590             Position.X += 2;
00591             pCharInfoUni += 2;
00592         }
00593         <span class="keywordflow">else</span>
00594         {
00595             Position.X++;
00596             pCharInfoUni++;
00597         }
00598     }
00599 
00600     <a class="code" href="../../d7/d8/fsvga_8h.html#a49">FsgInvertCursor</a>(DeviceExtension,TRUE);
00601 
00602     <span class="keywordflow">if</span> (pCapBuffer != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00603         <a class="code" href="../../d5/d8/ex_8h.html#a224">ExFreePool</a>(pCapBuffer);
00604 
00605     <span class="keywordflow">return</span> STATUS_SUCCESS;
00606 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a50" doxytag="fsvga.h::FsgWriteToScreen" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS FsgWriteToScreen           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">PUCHAR&nbsp;</td>
          <td class="mdname" nowrap> <em>FrameBuffer</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>PUCHAR&nbsp;</td>
          <td class="mdname" nowrap> <em>BitmapBuffer</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>cjBytes</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>BOOL&nbsp;</td>
          <td class="mdname" nowrap> <em>fDbcs</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>WORD&nbsp;</td>
          <td class="mdname" nowrap> <em>Attributes1</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>WORD&nbsp;</td>
          <td class="mdname" nowrap> <em>Attributes2</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d8/d3/struct__DEVICE__EXTENSION.html">PDEVICE_EXTENSION</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>DeviceExtension</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d1/drawscrn_8c-source.html#l00813">813</a> of file <a class="el" href="../../d3/d1/drawscrn_8c-source.html">drawscrn.c</a>.
<p>
References <a class="el" href="../../d3/d1/drawscrn_8c-source.html#l00029">COMMON_LVB_MASK</a>, <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00138">_DEVICE_EXTENSION::Configuration</a>, <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00049">_FSVGA_CONFIGURATION_INFORMATION::EmulationMode</a>, <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00050">ENABLE_WORD_WRITE_VRAM</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00055">EXCEPTION_EXECUTE_HANDLER</a>, <a class="el" href="../../d3/d1/drawscrn_8c-source.html#l00915">FsgWriteToScreenCommonLVB()</a>, <a class="el" href="../../d2/d9/cmchek_8c-source.html#l00095">Index</a>, <a class="el" href="../../d3/d1/drawscrn_8c-source.html#l00152">IsGRAMRowOver()</a>, <a class="el" href="../../d3/d1/drawscrn_8c-source.html#l00200">NextGRAMRow()</a>, <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00148">_DEVICE_EXTENSION::ScreenAndFont</a>, and <a class="el" href="../../d7/d1/port_8c-source.html#l00186">set_opaque_bkgnd_proc()</a>.
<p>
Referenced by <a class="el" href="../../d3/d1/drawscrn_8c-source.html#l00489">FsgWriteToFrameBuffer()</a>.
<p>
<pre class="fragment"><div>00822 {
00823     WORD  <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>;
00824     PCHAR CurFrameBufPtrTmp;
00825     PCHAR CurFrameBufPtr2nd;
00826     PWORD CurFrameBufPtrWord;
00827     PUCHAR BitmapBufferTmp;
00828 
00829 <span class="preprocessor">#ifdef LATER_HIGH_SPPED_VRAM_ACCESS  // kazum</span>
00830 <span class="preprocessor"></span>    <span class="keywordflow">if</span> (! <a class="code" href="../../d7/d8/fsvga_8h.html#a40">IsGRAMRowOver</a>(FrameBuffer,fDBCS,DeviceExtension)) {
00831         <span class="keywordflow">if</span> (!fDbcs) {
00832             <span class="keywordflow">if</span> (cjBytes == 2)
00833                 BitmapBuffer++;
00834             (*WriteGramInfo-&gt;pfnWriteFontToByteGRAM)(WriteGramInfo);
00835         }
00836         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (cjBytes == 2 &amp;&amp; fDBCS) {
00837             <span class="keywordflow">if</span> (DeviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o49">Configuration</a>.<a class="code" href="../../d3/d1/struct__FSVGA__CONFIGURATION__INFORMATION.html#o0">EmulationMode</a> &amp; <a class="code" href="../../d7/d8/fsvga_8h.html#a0">ENABLE_WORD_WRITE_VRAM</a>) {
00838                 (*WriteGramInfo-&gt;pfnWriteFontToFirstWordGRAM)(WriteGramInfo);
00839             }
00840             <span class="keywordflow">else</span> {
00841                (*WriteGramInfo-&gt;pfnWriteFontToWordGRAM)(WriteGramInfo);
00842             }
00843         }
00844     }
00845     <span class="keywordflow">else</span>
00846 <span class="preprocessor">#endif // LATER_HIGH_SPPED_VRAM_ACCESS  // kazum</span>
00847 <span class="preprocessor"></span>    <span class="keywordflow">try</span>
00848     {
00849         <a class="code" href="../../d6/d2/port_8c.html#a4">set_opaque_bkgnd_proc</a>(DeviceExtension,FrameBuffer,Attributes1);
00850 
00851         <span class="keywordflow">if</span> (!fDbcs) {
00852             CurFrameBufPtrTmp = FrameBuffer;
00853             <span class="keywordflow">if</span> (cjBytes == 2)
00854                 BitmapBuffer++;
00855             <span class="keywordflow">for</span> (<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>=0; <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> &lt; DeviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o51">ScreenAndFont</a>.FontSize.Y; <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>++) {
00856                 *CurFrameBufPtrTmp = *BitmapBuffer;
00857                 BitmapBuffer += cjBytes;
00858                 CurFrameBufPtrTmp=<a class="code" href="../../d7/d8/fsvga_8h.html#a41">NextGRAMRow</a>(CurFrameBufPtrTmp,DeviceExtension);
00859             }
00860         }
00861         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (cjBytes == 2 &amp;&amp; fDbcs) {
00862             <span class="keywordflow">if</span> ((DeviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o49">Configuration</a>.<a class="code" href="../../d3/d1/struct__FSVGA__CONFIGURATION__INFORMATION.html#o0">EmulationMode</a> &amp; <a class="code" href="../../d7/d8/fsvga_8h.html#a0">ENABLE_WORD_WRITE_VRAM</a>) &amp;&amp;
00863                 !((ULONG)FrameBuffer &amp; 1) &amp;&amp;
00864                 (Attributes2 != -1) &amp;&amp;
00865                 (Attributes1 == Attributes2)
00866                ) {
00867                 CurFrameBufPtrWord = (PWORD)FrameBuffer;
00868                 <span class="keywordflow">for</span> (<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>=0; <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> &lt; DeviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o51">ScreenAndFont</a>.FontSize.Y; <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>++) {
00869                     *CurFrameBufPtrWord = *((PWORD)BitmapBuffer);
00870                     BitmapBuffer += cjBytes;
00871                     CurFrameBufPtrWord=(PWORD)<a class="code" href="../../d7/d8/fsvga_8h.html#a41">NextGRAMRow</a>((PCHAR)CurFrameBufPtrWord,DeviceExtension);
00872                 }
00873             }
00874             <span class="keywordflow">else</span> {
00875                 CurFrameBufPtrTmp = FrameBuffer;
00876                 CurFrameBufPtr2nd = FrameBuffer + 1;
00877                 BitmapBufferTmp = BitmapBuffer + 1;
00878                 <span class="keywordflow">for</span> (<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>=0; <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> &lt; DeviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o51">ScreenAndFont</a>.FontSize.Y; <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>++) {
00879                     *CurFrameBufPtrTmp = *BitmapBuffer;
00880                     BitmapBuffer += cjBytes;
00881                     CurFrameBufPtrTmp=<a class="code" href="../../d7/d8/fsvga_8h.html#a41">NextGRAMRow</a>(CurFrameBufPtrTmp,DeviceExtension);
00882                 }
00883                 <span class="keywordflow">if</span> (Attributes2 != -1 &amp;&amp;
00884                     Attributes1 != Attributes2)
00885                     <a class="code" href="../../d6/d2/port_8c.html#a4">set_opaque_bkgnd_proc</a>(DeviceExtension,FrameBuffer,Attributes2);
00886                 <span class="keywordflow">for</span> (<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>=0; <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> &lt; DeviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o51">ScreenAndFont</a>.FontSize.Y; <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>++) {
00887                     *CurFrameBufPtr2nd = *BitmapBufferTmp;
00888                     BitmapBufferTmp += cjBytes;
00889                     CurFrameBufPtr2nd=<a class="code" href="../../d7/d8/fsvga_8h.html#a41">NextGRAMRow</a>(CurFrameBufPtr2nd,DeviceExtension);
00890                 }
00891             }
00892         }
00893     }
00894     except (EXCEPTION_EXECUTE_HANDLER)
00895     {
00896     }
00897 
00898     <span class="keywordflow">if</span> (Attributes1 &amp; <a class="code" href="../../d2/d2/drawscrn_8c.html#a0">COMMON_LVB_MASK</a>)
00899     {
00900         <a class="code" href="../../d7/d8/fsvga_8h.html#a51">FsgWriteToScreenCommonLVB</a>(FrameBuffer,
00901                                   Attributes1,
00902                                   DeviceExtension);
00903     }
00904     <span class="keywordflow">if</span> ((Attributes2 != (WORD)-1) &amp;&amp; (Attributes2 &amp; <a class="code" href="../../d2/d2/drawscrn_8c.html#a0">COMMON_LVB_MASK</a>))
00905     {
00906         <a class="code" href="../../d7/d8/fsvga_8h.html#a51">FsgWriteToScreenCommonLVB</a>(FrameBuffer+1,
00907                                   Attributes2,
00908                                   DeviceExtension);
00909     }
00910 
00911     <span class="keywordflow">return</span> STATUS_SUCCESS;
00912 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a51" doxytag="fsvga.h::FsgWriteToScreenCommonLVB" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS FsgWriteToScreenCommonLVB           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">PUCHAR&nbsp;</td>
          <td class="mdname" nowrap> <em>FrameBuffer</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>WORD&nbsp;</td>
          <td class="mdname" nowrap> <em>Attributes</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d8/d3/struct__DEVICE__EXTENSION.html">PDEVICE_EXTENSION</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>DeviceExtension</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d1/drawscrn_8c-source.html#l00915">915</a> of file <a class="el" href="../../d3/d1/drawscrn_8c-source.html">drawscrn.c</a>.
<p>
References <a class="el" href="../../d3/d1/drawscrn_8c-source.html#l00986">AccessGRAM_RW()</a>, <a class="el" href="../../d0/d7/halvprnt_8c-source.html#l00031">BYTE</a>, <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00102">_EMULATE_BUFFER_INFORMATION::ColorBg</a>, <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00101">_EMULATE_BUFFER_INFORMATION::ColorFg</a>, <a class="el" href="../../d7/d1/port_8c-source.html#l00257">ColorSetDirect()</a>, <a class="el" href="../../d7/d1/port_8c-source.html#l00225">ColorSetGridMask()</a>, <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00153">_DEVICE_EXTENSION::EmulateInfo</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00055">EXCEPTION_EXECUTE_HANDLER</a>, <a class="el" href="../../d2/d9/cmchek_8c-source.html#l00095">Index</a>, <a class="el" href="../../d3/d1/drawscrn_8c-source.html#l00200">NextGRAMRow()</a>, <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00148">_DEVICE_EXTENSION::ScreenAndFont</a>, <a class="el" href="../../d7/d1/port_8c-source.html#l00186">set_opaque_bkgnd_proc()</a>, and <a class="el" href="../../d7/d1/port_8c-source.html#l00081">SetGRAMWriteMode()</a>.
<p>
Referenced by <a class="el" href="../../d3/d1/drawscrn_8c-source.html#l00813">FsgWriteToScreen()</a>.
<p>
<pre class="fragment"><div>00920 {
00921     WORD  <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>;
00922     PUCHAR CurFrameBufPtrTmp;
00923 
00924     <span class="keywordflow">try</span>
00925     {
00926         <span class="keywordflow">if</span> (Attributes &amp; COMMON_LVB_UNDERSCORE)
00927         {
00928             <a class="code" href="../../d6/d2/port_8c.html#a4">set_opaque_bkgnd_proc</a>(DeviceExtension,FrameBuffer,Attributes);
00929             CurFrameBufPtrTmp = FrameBuffer;
00930             <span class="keywordflow">for</span> (<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>=0; <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> &lt; DeviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o51">ScreenAndFont</a>.FontSize.Y - 1; <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>++)
00931                 CurFrameBufPtrTmp=<a class="code" href="../../d7/d8/fsvga_8h.html#a41">NextGRAMRow</a>(CurFrameBufPtrTmp,DeviceExtension);
00932             *CurFrameBufPtrTmp = 0xff;
00933         }
00934 
00935         <span class="keywordflow">if</span> (Attributes &amp; COMMON_LVB_GRID_HORIZONTAL)
00936         {
00937             <a class="code" href="../../d6/d2/port_8c.html#a6">ColorSetDirect</a>(DeviceExtension, FrameBuffer,
00938                            FOREGROUND_BLUE | FOREGROUND_GREEN | FOREGROUND_RED,
00939                            0);
00940             *FrameBuffer = 0xff;
00941         }
00942 
00943         <span class="keywordflow">if</span> ( (Attributes &amp; COMMON_LVB_GRID_LVERTICAL) ||
00944              (Attributes &amp; COMMON_LVB_GRID_RVERTICAL)   )
00945         {
00946             <a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a> mask = ((Attributes &amp; COMMON_LVB_GRID_LVERTICAL) ? 0x80 : 0) +
00947                         ((Attributes &amp; COMMON_LVB_GRID_RVERTICAL) ? 0x01 : 0);
00948             <a class="code" href="../../d6/d2/port_8c.html#a5">ColorSetGridMask</a>(DeviceExtension,
00949                              mask
00950                             );
00951             CurFrameBufPtrTmp = FrameBuffer;
00952             <span class="keywordflow">for</span> (<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>=0; <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> &lt; DeviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o51">ScreenAndFont</a>.FontSize.Y; <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>++) {
00953                 <a class="code" href="../../d7/d8/fsvga_8h.html#a53">AccessGRAM_RW</a>(CurFrameBufPtrTmp, mask);
00954                 CurFrameBufPtrTmp=<a class="code" href="../../d7/d8/fsvga_8h.html#a41">NextGRAMRow</a>(CurFrameBufPtrTmp,DeviceExtension);
00955             }
00956 
00957             <a class="code" href="../../d6/d2/port_8c.html#a1">SetGRAMWriteMode</a>(DeviceExtension);
00958         }
00959 
00960         DeviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o52">EmulateInfo</a>.<a class="code" href="../../d1/d3/struct__EMULATE__BUFFER__INFORMATION.html#o7">ColorFg</a> = (<a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a>)-1;
00961         DeviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o52">EmulateInfo</a>.<a class="code" href="../../d1/d3/struct__EMULATE__BUFFER__INFORMATION.html#o8">ColorBg</a> = (<a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a>)-1;
00962 
00963     }
00964     except (EXCEPTION_EXECUTE_HANDLER)
00965     {
00966     }
00967 
00968     <span class="keywordflow">return</span> STATUS_SUCCESS;
00969 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a27" doxytag="fsvga.h::FsVgaBuildResourceList" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID FsVgaBuildResourceList           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d8/d3/struct__DEVICE__EXTENSION.html">PDEVICE_EXTENSION</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>DeviceExtension</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT PCM_RESOURCE_LIST *&nbsp;</td>
          <td class="mdname" nowrap> <em>ResourceList</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT PULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>ResourceListSize</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d7/fsvga_8c-source.html#l01056">1056</a> of file <a class="el" href="../../d7/d7/fsvga_8c-source.html">fsvga.c</a>.
<p>
References <a class="el" href="../../d6/d8/fsvga_8c.html#a1">DUMP_COUNT</a>, <a class="el" href="../../d6/d4/cc_8h-source.html#l00126">ExAllocatePool</a>, <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00168">FSVGA_ERROR_VALUE_BASE</a>, <a class="el" href="../../d7/d7/fsvga_8c-source.html#l01844">FsVgaLogError()</a>, <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00310">FsVgaPrint</a>, and <a class="el" href="../../d5/d8/ex_8h.html#a329a174">PagedPool</a>.
<p>
Referenced by <a class="el" href="../../d7/d7/fsvga_8c-source.html#l00053">DriverEntry()</a>.
<p>
<pre class="fragment"><div>01064                    :
01065 
01066     Creates a resource list that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> used to query or report resource usage.
01067 
01068 Arguments:
01069 
01070     DeviceExtension - Pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> port's device <a class="code" href="../../d7/d1/genuedef_8c.html#a6">extension</a>.
01071 
01072     ResourceList - Pointer to a pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> resource list to be allocated
01073         and filled.
01074 
01075     ResourceListSize - Pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> returned size of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> resource
01076         list (in bytes).
01077 
01078 Return Value:
01079 
01080     None.  If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> call succeeded, *ResourceList points to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> built
01081     resource list and *ResourceListSize <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> set to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> size (in bytes)
01082     of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> resource list; otherwise, *ResourceList <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>.
01083 
01084 Note:
01085 
01086     Memory may be allocated here <span class="keywordflow">for</span> *ResourceList. It must be
01087     freed up by <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> caller, by calling <a class="code" href="../../d5/d8/ex_8h.html#a224">ExFreePool</a>();
01088 
01089 --*/
01090 
01091 {
01092     ULONG count = 0;
01093     ULONG i = 0;
01094     ULONG j = 0;
01095 <span class="preprocessor">#define DUMP_COUNT 4</span>
01096 <span class="preprocessor"></span>    ULONG dumpData[<a class="code" href="../../d6/d8/fsvga_8c.html#a1">DUMP_COUNT</a>];
01097 
01098     count += DeviceExtension-&gt;Configuration.PortListCount;
01099 
01100     *ResourceListSize = <span class="keyword">sizeof</span>(CM_RESOURCE_LIST) +
01101                        ((count - 1) * <span class="keyword">sizeof</span>(CM_PARTIAL_RESOURCE_DESCRIPTOR));
01102 
01103     *ResourceList = (PCM_RESOURCE_LIST) <a class="code" href="../../d5/d5/cc_8h.html#a10">ExAllocatePool</a>(PagedPool,
01104                                                        *ResourceListSize);
01105 
01106     <span class="comment">//</span>
01107     <span class="comment">// Return NULL if the structure could not be allocated.</span>
01108     <span class="comment">// Otherwise, fill in the resource list.</span>
01109     <span class="comment">//</span>
01110 
01111     <span class="keywordflow">if</span> (!*ResourceList) {
01112 
01113         <span class="comment">//</span>
01114         <span class="comment">// Could not allocate memory for the resource list.</span>
01115         <span class="comment">//</span>
01116 
01117         <a class="code" href="../../d7/d8/fsvga_8h.html#a10">FsVgaPrint</a>((1,
01118                     <span class="stringliteral">"FSVGA-FsVgaBuildResourceList: Could not allocate resource list\n"</span>));
01119 
01120         <span class="comment">//</span>
01121         <span class="comment">// Log an error.</span>
01122         <span class="comment">//</span>
01123 
01124         dumpData[0] = *ResourceListSize;
01125         *ResourceListSize = 0;
01126 
01127         <a class="code" href="../../d7/d8/fsvga_8h.html#a37">FsVgaLogError</a>(DeviceExtension-&gt;DeviceObject,
01128                       FSVGA_INSUFFICIENT_RESOURCES,
01129                       FSVGA_ERROR_VALUE_BASE + 110,
01130                       STATUS_INSUFFICIENT_RESOURCES,
01131                       dumpData,
01132                       1
01133                      );
01134 
01135         <span class="keywordflow">return</span>;
01136     }
01137 
01138     RtlZeroMemory(*ResourceList,
01139                   *ResourceListSize);
01140 
01141     <span class="comment">//</span>
01142     <span class="comment">// Concoct one full resource descriptor.</span>
01143     <span class="comment">//</span>
01144 
01145     (*ResourceList)-&gt;Count = 1;
01146 
01147     (*ResourceList)-&gt;List[0].InterfaceType =
01148         DeviceExtension-&gt;Configuration.InterfaceType;
01149     (*ResourceList)-&gt;List[0].BusNumber =
01150         DeviceExtension-&gt;Configuration.BusNumber;
01151 
01152     <span class="comment">//</span>
01153     <span class="comment">// Build the partial resource descriptors for port</span>
01154     <span class="comment">// resources from the saved values.</span>
01155     <span class="comment">//</span>
01156 
01157     (*ResourceList)-&gt;List[0].PartialResourceList.Count = count;
01158 
01159     <span class="keywordflow">for</span> (j = 0; j &lt; DeviceExtension-&gt;Configuration.PortListCount; j++) {
01160         (*ResourceList)-&gt;List[0].PartialResourceList.PartialDescriptors[i++] =
01161             DeviceExtension-&gt;Configuration.PortList[j];
01162     }
01163 
01164 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a24" doxytag="fsvga.h::FsVgaConfiguration" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID FsVgaConfiguration           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d8/d3/struct__DEVICE__EXTENSION.html">PDEVICE_EXTENSION</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>DeviceExtension</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PUNICODE_STRING&nbsp;</td>
          <td class="mdname" nowrap> <em>RegistryPath</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PUNICODE_STRING&nbsp;</td>
          <td class="mdname" nowrap> <em>KeyboardDeviceName</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d7/fsvga_8c-source.html#l00649">649</a> of file <a class="el" href="../../d7/d7/fsvga_8c-source.html">fsvga.c</a>.
<p>
References <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00174">FSVGA_HARDWARE_PRESENT</a>, <a class="el" href="../../d7/d7/fsvga_8c-source.html#l00722">FsVgaPeripheralCallout()</a>, <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00310">FsVgaPrint</a>, <a class="el" href="../../d7/d7/fsvga_8c-source.html#l00858">FsVgaServiceParameters()</a>, <a class="el" href="../../d3/d2/io_2query_8c-source.html#l00070">IoQueryDeviceDescription()</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, and <a class="el" href="../../d7/d8/fsvga_8h.html#a13">PFSVGA_CONFIGURATION_INFORMATION</a>.
<p>
Referenced by <a class="el" href="../../d7/d7/fsvga_8c-source.html#l00053">DriverEntry()</a>.
<p>
<pre class="fragment"><div>00657                    :
00658 
00659     This routine retrieves <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> configuration information <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> keyboard.
00660 
00661 Arguments:
00662 
00663     DeviceExtension - Pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> device <a class="code" href="../../d7/d1/genuedef_8c.html#a6">extension</a>.
00664 
00665     RegistryPath - Pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> null-terminated <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a96">Unicode</a> name of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00666         registry <a class="code" href="../../d3/d3/dumpuser_8c.html#a14">path</a> <span class="keywordflow">for</span> <span class="keyword">this</span> driver.
00667 
00668     FsVgaDeviceName - Pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a96">Unicode</a> string that will receive
00669         <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> Full Screen Video port device name.
00670 
00671 Return Value:
00672 
00673     None.  As a side-effect, may set DeviceExtension-&gt;HardwarePresent.
00674 
00675 --*/
00676 {
00677     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> status = STATUS_SUCCESS;
00678     <a class="code" href="../../d3/d1/struct__FSVGA__CONFIGURATION__INFORMATION.html">PFSVGA_CONFIGURATION_INFORMATION</a> configuration;
00679     INTERFACE_TYPE interfaceType;
00680     ULONG i;
00681 
00682     <span class="keywordflow">for</span> (i = 0; i &lt; MaximumInterfaceType; i++)
00683     {
00684 
00685         <span class="comment">//</span>
00686         <span class="comment">// Get the registry information for this device.</span>
00687         <span class="comment">//</span>
00688 
00689         interfaceType = i;
00690         status = <a class="code" href="../../d2/d3/io_2query_8c.html#a6">IoQueryDeviceDescription</a>(&amp;interfaceType,
00691                                           NULL,
00692                                           NULL,
00693                                           NULL,
00694                                           NULL,
00695                                           NULL,
00696                                           FsVgaPeripheralCallout,
00697                                           (PVOID) DeviceExtension);
00698 
00699         <span class="keywordflow">if</span> (DeviceExtension-&gt;HardwarePresent &amp; <a class="code" href="../../d7/d8/fsvga_8h.html#a9">FSVGA_HARDWARE_PRESENT</a>)
00700         {
00701             <span class="comment">//</span>
00702             <span class="comment">// Get the service parameters (e.g., user-configurable number</span>
00703             <span class="comment">// of resends, polling iterations, etc.).</span>
00704             <span class="comment">//</span>
00705 
00706             <a class="code" href="../../d7/d8/fsvga_8h.html#a26">FsVgaServiceParameters</a>(DeviceExtension,
00707                                    RegistryPath,
00708                                    FsVgaDeviceName);
00709 
00710             <span class="keywordflow">break</span>;
00711         }
00712         <span class="keywordflow">else</span>
00713         {
00714             <a class="code" href="../../d7/d8/fsvga_8h.html#a10">FsVgaPrint</a>((1,
00715                         <span class="stringliteral">"FSVGA-FsVgaConfiguration: IoQueryDeviceDescription for bus type %d failed\n"</span>,
00716                         interfaceType));
00717         }
00718     }
00719 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a30" doxytag="fsvga.h::FsVgaCopyFrameBuffer" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS FsVgaCopyFrameBuffer           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d8/d3/struct__DEVICE__EXTENSION.html">PDEVICE_EXTENSION</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>DeviceExtension</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>PFSVIDEO_COPY_FRAME_BUFFER&nbsp;</td>
          <td class="mdname" nowrap> <em>CopyFrameBuffer</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>inputBufferLength</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d7/fsvga_8c-source.html#l01349">1349</a> of file <a class="el" href="../../d7/d7/fsvga_8c-source.html">fsvga.c</a>.
<p>
References <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00143">_DEVICE_EXTENSION::CurrentMode</a>, <a class="el" href="../../d3/d1/drawscrn_8c-source.html#l00437">FsgCopyFrameBuffer()</a>, and <a class="el" href="../../d3/d6/iostubs_8c.html#a0">SCREEN_BUFFER_POINTER</a>.
<p>
Referenced by <a class="el" href="../../d7/d7/fsvga_8c-source.html#l01213">FsVgaDeviceControl()</a>.
<p>
<pre class="fragment"><div>01357                    :
01358 
01359     This routine copy <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> frame buffer.
01360 
01361 Arguments:
01362 
01363     DeviceExtension - Pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> miniport driver's device <a class="code" href="../../d7/d1/genuedef_8c.html#a6">extension</a>.
01364 
01365     CopyFrameBuffer - Pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> structure containing <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> information about <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> copy frame buffer.
01366 
01367     inputBufferLength - Length of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> input buffer supplied by <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> user.
01368 
01369 Return Value:
01370 
01371     STATUS_INSUFFICIENT_BUFFER <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> input buffer was not large enough
01372         <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> input data.
01373 
01374     STATUS_SUCCESS <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> operation completed successfully.
01375 
01376 --*/
01377 
01378 {
01379     <span class="comment">//</span>
01380     <span class="comment">// Check if the size of the data in the input buffer is large enough.</span>
01381     <span class="comment">//</span>
01382 
01383     <span class="keywordflow">if</span> (inputBufferLength &lt; <span class="keyword">sizeof</span>(FSVIDEO_COPY_FRAME_BUFFER)) {
01384         <span class="keywordflow">return</span> STATUS_INVALID_BUFFER_SIZE;
01385     }
01386 
01387     <span class="keywordflow">if</span> (CopyFrameBuffer-&gt;SrcScreen.nNumberOfChars != CopyFrameBuffer-&gt;DestScreen.nNumberOfChars) {
01388         <span class="keywordflow">return</span> STATUS_INVALID_PARAMETER;
01389     }
01390 
01391     <span class="keywordflow">if</span> (! (DeviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o50">CurrentMode</a>.VideoMode.AttributeFlags &amp; VIDEO_MODE_GRAPHICS))
01392     {
01393         <span class="comment">/*</span>
01394 <span class="comment">         * This is the TEXT frame buffer.</span>
01395 <span class="comment">         */</span>
01396 
01397         ULONG OffsSrc;
01398         ULONG OffsDest;
01399         PUCHAR pFrameBuf = DeviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o50">CurrentMode</a>.VideoMemory.FrameBufferBase;
01400 
01401         OffsSrc = <a class="code" href="../../d3/d6/iostubs_8c.html#a0">SCREEN_BUFFER_POINTER</a>(CopyFrameBuffer-&gt;SrcScreen.Position.X,
01402                                         CopyFrameBuffer-&gt;SrcScreen.Position.Y,
01403                                         CopyFrameBuffer-&gt;SrcScreen.ScreenSize.X,
01404                                         <span class="keyword">sizeof</span>(VGA_CHAR));
01405 
01406         OffsDest = <a class="code" href="../../d3/d6/iostubs_8c.html#a0">SCREEN_BUFFER_POINTER</a>(CopyFrameBuffer-&gt;DestScreen.Position.X,
01407                                          CopyFrameBuffer-&gt;DestScreen.Position.Y,
01408                                          CopyFrameBuffer-&gt;DestScreen.ScreenSize.X,
01409                                          <span class="keyword">sizeof</span>(VGA_CHAR));
01410 
01411         RtlMoveMemory(pFrameBuf + OffsDest,
01412                       pFrameBuf + OffsSrc,
01413                       CopyFrameBuffer-&gt;SrcScreen.nNumberOfChars * <span class="keyword">sizeof</span>(VGA_CHAR));
01414     }
01415     <span class="keywordflow">else</span>
01416     {
01417         <span class="comment">/*</span>
01418 <span class="comment">         * This is the GRAPHICS frame buffer.</span>
01419 <span class="comment">         */</span>
01420         <span class="keywordflow">return</span> <a class="code" href="../../d7/d8/fsvga_8h.html#a46">FsgCopyFrameBuffer</a>(DeviceExtension,
01421                                   CopyFrameBuffer,
01422                                   inputBufferLength);
01423     }
01424 
01425     <span class="keywordflow">return</span> STATUS_SUCCESS;
01426 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a29" doxytag="fsvga.h::FsVgaDeviceControl" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS FsVgaDeviceControl           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d8/d4/struct__DEVICE__OBJECT.html">PDEVICE_OBJECT</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>DeviceObject</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d0/d2/struct__IRP.html">PIRP</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Irp</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d7/fsvga_8c-source.html#l01213">1213</a> of file <a class="el" href="../../d7/d7/fsvga_8c-source.html">fsvga.c</a>.
<p>
References <a class="el" href="../../d0/d2/struct__IRP.html#o7">_IRP::AssociatedIrp</a>, <a class="el" href="../../d7/d7/fsvga_8c-source.html#l01349">FsVgaCopyFrameBuffer()</a>, <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00310">FsVgaPrint</a>, <a class="el" href="../../d7/d7/fsvga_8c-source.html#l01546">FsVgaReverseMousePointer()</a>, <a class="el" href="../../d7/d7/fsvga_8c-source.html#l01777">FsVgaSetCursorAttribute()</a>, <a class="el" href="../../d7/d7/fsvga_8c-source.html#l01710">FsVgaSetCursorPosition()</a>, <a class="el" href="../../d7/d7/fsvga_8c-source.html#l01618">FsVgaSetMode()</a>, <a class="el" href="../../d7/d7/fsvga_8c-source.html#l01663">FsVgaSetScreenInformation()</a>, <a class="el" href="../../d7/d7/fsvga_8c-source.html#l01429">FsVgaWriteToFrameBuffer()</a>, <a class="el" href="../../d8/d7/exboosts_8h-source.html#l00056">IO_NO_INCREMENT</a>, <a class="el" href="../../d1/d4/io_8h-source.html#l02960">IoCompleteRequest</a>, <a class="el" href="../../d1/d4/io_8h-source.html#l03252">IoGetCurrentIrpStackLocation</a>, <a class="el" href="../../d1/d4/io_8h-source.html#l01635">_IRP::IoStatus</a>, <a class="el" href="../../d1/d5/iop_8h-source.html#l00130">Irp</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d1/d8/ntosdef_8h-source.html#l00462">PAGED_CODE</a>, and <a class="el" href="../../d1/d4/io_8h-source.html#l02069">_IO_STACK_LOCATION::Parameters</a>.
<p>
Referenced by <a class="el" href="../../d7/d7/fsvga_8c-source.html#l00053">DriverEntry()</a>.
<p>
<pre class="fragment"><div>01220                    :
01221 
01222     This routine <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> dispatch routine <span class="keywordflow">for</span> device <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a58">control</a> requests.
01223 
01224 Arguments:
01225 
01226     DeviceObject - Pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> device object.
01227 
01228     <a class="code" href="../../d0/d6/iop_8h.html#a35">Irp</a> - Pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> request packet.
01229 
01230 Return Value:
01231 
01232     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned.
01233 
01234 --*/
01235 
01236 {
01237     <a class="code" href="../../d2/d5/struct__IO__STACK__LOCATION.html">PIO_STACK_LOCATION</a> irpSp;
01238     PVOID ioBuffer;
01239     ULONG inputBufferLength;
01240     ULONG outputBufferLength;
01241     <a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html">PDEVICE_EXTENSION</a> deviceExtension;
01242     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> status = STATUS_SUCCESS;
01243 
01244     <a class="code" href="../../d7/d8/fsvga_8h.html#a10">FsVgaPrint</a>((2,<span class="stringliteral">"FSVGA-FsVgaDeviceControl: enter\n"</span>));
01245 
01246     <a class="code" href="../../d0/d9/ntosdef_8h.html#a28">PAGED_CODE</a>();
01247 
01248     <span class="comment">//</span>
01249     <span class="comment">// Get a pointer to the device extension.</span>
01250     <span class="comment">//</span>
01251 
01252     deviceExtension = DeviceObject-&gt;DeviceExtension;
01253 
01254     <span class="comment">//</span>
01255     <span class="comment">// Initialize the returned Information field.</span>
01256     <span class="comment">//</span>
01257 
01258     <a class="code" href="../../d0/d6/iop_8h.html#a35">Irp</a>-&gt;<a class="code" href="../../d0/d2/struct__IRP.html#o9">IoStatus</a>.Information = 0;
01259 
01260     <span class="comment">//</span>
01261     <span class="comment">// Get a pointer to the current parameters for this request.  The</span>
01262     <span class="comment">// information is contained in the current stack location.</span>
01263     <span class="comment">//</span>
01264 
01265     irpSp = <a class="code" href="../../d0/d5/io_8h.html#a228">IoGetCurrentIrpStackLocation</a>(Irp);
01266 
01267     <span class="comment">//</span>
01268     <span class="comment">// Get the pointer to the input/output buffer and it's length</span>
01269     <span class="comment">//</span>
01270 
01271     ioBuffer = <a class="code" href="../../d0/d6/iop_8h.html#a35">Irp</a>-&gt;<a class="code" href="../../d0/d2/struct__IRP.html#o7">AssociatedIrp</a>.SystemBuffer;
01272     inputBufferLength = irpSp-&gt;<a class="code" href="../../d2/d5/struct__IO__STACK__LOCATION.html#o11">Parameters</a>.DeviceIoControl.InputBufferLength;
01273     outputBufferLength = irpSp-&gt;<a class="code" href="../../d2/d5/struct__IO__STACK__LOCATION.html#o11">Parameters</a>.DeviceIoControl.OutputBufferLength;
01274 
01275     <span class="comment">//</span>
01276     <span class="comment">// Case on the device control subfunction that is being performed by the</span>
01277     <span class="comment">// requestor.</span>
01278     <span class="comment">//</span>
01279 
01280     <span class="keywordflow">switch</span> (irpSp-&gt;<a class="code" href="../../d2/d5/struct__IO__STACK__LOCATION.html#o11">Parameters</a>.DeviceIoControl.IoControlCode)
01281     {
01282         <span class="keywordflow">case</span> IOCTL_FSVIDEO_COPY_FRAME_BUFFER:
01283             <a class="code" href="../../d7/d8/fsvga_8h.html#a10">FsVgaPrint</a>((2, <span class="stringliteral">"FsVgaDeviceControl - CopyFrameBuffer\n"</span>));
01284             status = <a class="code" href="../../d7/d8/fsvga_8h.html#a30">FsVgaCopyFrameBuffer</a>(deviceExtension,
01285                                           (PFSVIDEO_COPY_FRAME_BUFFER) ioBuffer,
01286                                           inputBufferLength);
01287             <span class="keywordflow">break</span>;
01288 
01289         <span class="keywordflow">case</span> IOCTL_FSVIDEO_WRITE_TO_FRAME_BUFFER:
01290             <a class="code" href="../../d7/d8/fsvga_8h.html#a10">FsVgaPrint</a>((2, <span class="stringliteral">"FsVgaDeviceControl - WriteToFrameBuffer\n"</span>));
01291             status = <a class="code" href="../../d7/d8/fsvga_8h.html#a31">FsVgaWriteToFrameBuffer</a>(deviceExtension,
01292                                              (PFSVIDEO_WRITE_TO_FRAME_BUFFER) ioBuffer,
01293                                              inputBufferLength);
01294             <span class="keywordflow">break</span>;
01295 
01296         <span class="keywordflow">case</span> IOCTL_FSVIDEO_REVERSE_MOUSE_POINTER:
01297             <a class="code" href="../../d7/d8/fsvga_8h.html#a10">FsVgaPrint</a>((2, <span class="stringliteral">"FsVgaDeviceControl - ReverseMousePointer\n"</span>));
01298             status = <a class="code" href="../../d7/d8/fsvga_8h.html#a32">FsVgaReverseMousePointer</a>(deviceExtension,
01299                                               (PFSVIDEO_REVERSE_MOUSE_POINTER) ioBuffer,
01300                                               inputBufferLength);
01301             <span class="keywordflow">break</span>;
01302 
01303         <span class="keywordflow">case</span> IOCTL_FSVIDEO_SET_CURRENT_MODE:
01304             <a class="code" href="../../d7/d8/fsvga_8h.html#a10">FsVgaPrint</a>((2, <span class="stringliteral">"FsVgaDeviceControl - SetCurrentModes\n"</span>));
01305             status = <a class="code" href="../../d7/d8/fsvga_8h.html#a33">FsVgaSetMode</a>(deviceExtension,
01306                                   (PFSVIDEO_MODE_INFORMATION) ioBuffer,
01307                                   inputBufferLength);
01308             <span class="keywordflow">break</span>;
01309 
01310         <span class="keywordflow">case</span> IOCTL_FSVIDEO_SET_SCREEN_INFORMATION:
01311             <a class="code" href="../../d7/d8/fsvga_8h.html#a10">FsVgaPrint</a>((2, <span class="stringliteral">"FsVgaDeviceControl - SetScreenInformation\n"</span>));
01312             status = <a class="code" href="../../d7/d8/fsvga_8h.html#a34">FsVgaSetScreenInformation</a>(deviceExtension,
01313                                                (PFSVIDEO_SCREEN_INFORMATION) ioBuffer,
01314                                                inputBufferLength);
01315             <span class="keywordflow">break</span>;
01316 
01317         <span class="keywordflow">case</span> IOCTL_FSVIDEO_SET_CURSOR_POSITION:
01318             <a class="code" href="../../d7/d8/fsvga_8h.html#a10">FsVgaPrint</a>((2, <span class="stringliteral">"FsVgaDeviceControl - SetCursorPosition\n"</span>));
01319             status = <a class="code" href="../../d7/d8/fsvga_8h.html#a35">FsVgaSetCursorPosition</a>(deviceExtension,
01320                                             (PFSVIDEO_CURSOR_POSITION) ioBuffer,
01321                                             inputBufferLength);
01322             <span class="keywordflow">break</span>;
01323 
01324         <span class="keywordflow">case</span> IOCTL_VIDEO_SET_CURSOR_ATTR:
01325             <a class="code" href="../../d7/d8/fsvga_8h.html#a10">FsVgaPrint</a>((2, <span class="stringliteral">"FsVgaDeviceControl - SetCursorAttribute\n"</span>));
01326             status = <a class="code" href="../../d7/d8/fsvga_8h.html#a36">FsVgaSetCursorAttribute</a>(deviceExtension,
01327                                              (PVIDEO_CURSOR_ATTRIBUTES) ioBuffer,
01328                                              inputBufferLength);
01329             <span class="keywordflow">break</span>;
01330 
01331         <span class="keywordflow">default</span>:
01332             <a class="code" href="../../d7/d8/fsvga_8h.html#a10">FsVgaPrint</a>((1,
01333                         <span class="stringliteral">"FSVGA-FsVgaDeviceControl: INVALID REQUEST (0x%x)\n"</span>,
01334                         irpSp-&gt;<a class="code" href="../../d2/d5/struct__IO__STACK__LOCATION.html#o11">Parameters</a>.DeviceIoControl.IoControlCode));
01335 
01336             status = STATUS_INVALID_DEVICE_REQUEST;
01337             <span class="keywordflow">break</span>;
01338     }
01339 
01340     <a class="code" href="../../d0/d6/iop_8h.html#a35">Irp</a>-&gt;<a class="code" href="../../d0/d2/struct__IRP.html#o9">IoStatus</a>.Status = status;
01341     <a class="code" href="../../d0/d5/io_8h.html#a224">IoCompleteRequest</a>(Irp, IO_NO_INCREMENT);
01342 
01343     <a class="code" href="../../d7/d8/fsvga_8h.html#a10">FsVgaPrint</a>((2,<span class="stringliteral">"FSVGA-FsVgaDeviceControl: exit\n"</span>));
01344 
01345     <span class="keywordflow">return</span>(status);
01346 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a37" doxytag="fsvga.h::FsVgaLogError" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID FsVgaLogError           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d8/d4/struct__DEVICE__OBJECT.html">PDEVICE_OBJECT</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>DeviceObject</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN NTSTATUS&nbsp;</td>
          <td class="mdname" nowrap> <em>ErrorCode</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>UniqueErrorValue</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN NTSTATUS&nbsp;</td>
          <td class="mdname" nowrap> <em>FinalStatus</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>DumpData</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>DumpCount</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d7/fsvga_8c-source.html#l01844">1844</a> of file <a class="el" href="../../d7/d7/fsvga_8c-source.html">fsvga.c</a>.
<p>
References <a class="el" href="../../d5/d5/iosubs_8c-source.html#l00428">IoAllocateErrorLogEntry()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l11556">IoWriteErrorLogEntry()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, and <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00064">USHORT</a>.
<p>
Referenced by <a class="el" href="../../d7/d7/fsvga_8c-source.html#l01056">FsVgaBuildResourceList()</a>, and <a class="el" href="../../d7/d7/fsvga_8c-source.html#l01429">FsVgaWriteToFrameBuffer()</a>.
<p>
<pre class="fragment"><div>01855                    :
01856 
01857     This routine contains common code to write an error log entry.  It <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a>
01858     called from other <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a24">routines</a>, especially FsVgaInitialize, to avoid
01859     duplication of code.  Note that some <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a24">routines</a> <span class="keywordflow">continue</span> to have their
01860     own error logging code (especially in the <span class="keywordflow">case</span> where the error logging
01861     can be localized and/or the routine has more data because there is
01862     and <a class="code" href="../../d0/d2/struct__IRP.html">IRP</a>).
01863 
01864 Arguments:
01865 
01866     DeviceObject - Pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> device object.
01867 
01868     ErrorCode - The error code <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> error log packet.
01869 
01870     UniqueErrorValue - The unique error value <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> error log packet.
01871 
01872     FinalStatus - The <span class="keyword">final</span> status of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> operation <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> error log packet.
01873 
01874     DumpData - Pointer to an array of dump data <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> error log packet.
01875 
01876     DumpCount - The number of entries in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> dump data array.
01877 
01878 
01879 Return Value:
01880 
01881     None.
01882 
01883 --*/
01884 
01885 {
01886     PIO_ERROR_LOG_PACKET errorLogEntry;
01887     ULONG i;
01888 
01889     errorLogEntry = (PIO_ERROR_LOG_PACKET) <a class="code" href="../../d4/d6/iosubs_8c.html#a14">IoAllocateErrorLogEntry</a>(
01890                                                DeviceObject,
01891                                                (UCHAR)
01892                                                (<span class="keyword">sizeof</span>(IO_ERROR_LOG_PACKET)
01893                                                + (DumpCount * <span class="keyword">sizeof</span>(ULONG)))
01894                                                );
01895 
01896     <span class="keywordflow">if</span> (errorLogEntry != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01897 
01898         errorLogEntry-&gt;ErrorCode = ErrorCode;
01899         errorLogEntry-&gt;DumpDataSize = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>) (DumpCount * <span class="keyword">sizeof</span>(ULONG));
01900         errorLogEntry-&gt;SequenceNumber = 0;
01901         errorLogEntry-&gt;MajorFunctionCode = 0;
01902         errorLogEntry-&gt;IoControlCode = 0;
01903         errorLogEntry-&gt;RetryCount = 0;
01904         errorLogEntry-&gt;UniqueErrorValue = UniqueErrorValue;
01905         errorLogEntry-&gt;FinalStatus = FinalStatus;
01906         <span class="keywordflow">for</span> (i = 0; i &lt; DumpCount; i++)
01907             errorLogEntry-&gt;DumpData[i] = DumpData[i];
01908 
01909         <a class="code" href="../../d4/d6/iosubs_8c.html#a123">IoWriteErrorLogEntry</a>(errorLogEntry);
01910     }
01911 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a28" doxytag="fsvga.h::FsVgaOpenCloseDispatch" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS FsVgaOpenCloseDispatch           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d8/d4/struct__DEVICE__OBJECT.html">PDEVICE_OBJECT</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>DeviceObject</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d0/d2/struct__IRP.html">PIRP</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Irp</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d7/fsvga_8c-source.html#l01167">1167</a> of file <a class="el" href="../../d7/d7/fsvga_8c-source.html">fsvga.c</a>.
<p>
References <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00310">FsVgaPrint</a>, <a class="el" href="../../d8/d7/exboosts_8h-source.html#l00056">IO_NO_INCREMENT</a>, <a class="el" href="../../d1/d4/io_8h-source.html#l02960">IoCompleteRequest</a>, <a class="el" href="../../d1/d4/io_8h-source.html#l01635">_IRP::IoStatus</a>, <a class="el" href="../../d1/d5/iop_8h-source.html#l00130">Irp</a>, and <a class="el" href="../../d1/d8/ntosdef_8h-source.html#l00462">PAGED_CODE</a>.
<p>
Referenced by <a class="el" href="../../d7/d7/fsvga_8c-source.html#l00053">DriverEntry()</a>.
<p>
<pre class="fragment"><div>01174                    :
01175 
01176     This <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> dispatch routine <span class="keywordflow">for</span> create/open and close requests.
01177     These requests complete successfully.
01178 
01179 Arguments:
01180 
01181     DeviceObject - Pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> device object.
01182 
01183     <a class="code" href="../../d0/d6/iop_8h.html#a35">Irp</a> - Pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> request packet.
01184 
01185 Return Value:
01186 
01187     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned.
01188 
01189 --*/
01190 
01191 {
01192     UNREFERENCED_PARAMETER(DeviceObject);
01193 
01194     <a class="code" href="../../d7/d8/fsvga_8h.html#a10">FsVgaPrint</a>((3,<span class="stringliteral">"FSVGA-FsVgaOpenCloseDispatch: enter\n"</span>));
01195 
01196     <a class="code" href="../../d0/d9/ntosdef_8h.html#a28">PAGED_CODE</a>();
01197 
01198     <span class="comment">//</span>
01199     <span class="comment">// Complete the request with successful status.</span>
01200     <span class="comment">//</span>
01201 
01202     <a class="code" href="../../d0/d6/iop_8h.html#a35">Irp</a>-&gt;<a class="code" href="../../d0/d2/struct__IRP.html#o9">IoStatus</a>.Status = STATUS_SUCCESS;
01203     <a class="code" href="../../d0/d6/iop_8h.html#a35">Irp</a>-&gt;<a class="code" href="../../d0/d2/struct__IRP.html#o9">IoStatus</a>.Information = 0;
01204     <a class="code" href="../../d0/d5/io_8h.html#a224">IoCompleteRequest</a>(Irp, IO_NO_INCREMENT);
01205 
01206     <a class="code" href="../../d7/d8/fsvga_8h.html#a10">FsVgaPrint</a>((3,<span class="stringliteral">"FSVGA-FsVgaOpenCloseDispatch: exit\n"</span>));
01207 
01208     <span class="keywordflow">return</span>(STATUS_SUCCESS);
01209 
01210 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a25" doxytag="fsvga.h::FsVgaPeripheralCallout" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS FsVgaPeripheralCallout           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>Context</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PUNICODE_STRING&nbsp;</td>
          <td class="mdname" nowrap> <em>PathName</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN INTERFACE_TYPE&nbsp;</td>
          <td class="mdname" nowrap> <em>BusType</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>BusNumber</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PKEY_VALUE_FULL_INFORMATION *&nbsp;</td>
          <td class="mdname" nowrap> <em>BusInformation</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d1/d9/arc_8h.html#a56">CONFIGURATION_TYPE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>ControllerType</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>ControllerNumber</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PKEY_VALUE_FULL_INFORMATION *&nbsp;</td>
          <td class="mdname" nowrap> <em>ControllerInformation</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d1/d9/arc_8h.html#a56">CONFIGURATION_TYPE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>PeripheralType</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>PeripheralNumber</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PKEY_VALUE_FULL_INFORMATION *&nbsp;</td>
          <td class="mdname" nowrap> <em>PeripheralInformation</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d7/fsvga_8c-source.html#l00722">722</a> of file <a class="el" href="../../d7/d7/fsvga_8c-source.html">fsvga.c</a>.
<p>
References <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00072">_FSVGA_CONFIGURATION_INFORMATION::BusNumber</a>, <a class="el" href="../../d3/d6/hal_8h-source.html#l01170">BusNumber</a>, <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00138">_DEVICE_EXTENSION::Configuration</a>, <a class="el" href="../../d4/d9/arcinst_8h.html#a174a65">ControllerType</a>, <a class="el" href="../../d2/d5/vga_8h-source.html#l00101">CRTC_ADDRESS_PORT_COLOR</a>, <a class="el" href="../../d2/d5/vga_8h-source.html#l00102">CRTC_DATA_PORT_COLOR</a>, <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00174">FSVGA_HARDWARE_PRESENT</a>, <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00310">FsVgaPrint</a>, <a class="el" href="../../d2/d5/vga_8h-source.html#l00098">GRAPH_ADDRESS_PORT</a>, <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00120">_DEVICE_EXTENSION::HardwarePresent</a>, <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00066">_FSVGA_CONFIGURATION_INFORMATION::InterfaceType</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d4/d9/arcinst_8h.html#a174a66">PeripheralType</a>, <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00078">_FSVGA_CONFIGURATION_INFORMATION::PortList</a>, <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00079">_FSVGA_CONFIGURATION_INFORMATION::PortListCount</a>, <a class="el" href="../../d2/d5/vga_8h-source.html#l00086">SEQ_ADDRESS_PORT</a>, and <a class="el" href="../../d2/d5/vga_8h-source.html#l00055">VGA_BASE_IO_PORT</a>.
<p>
Referenced by <a class="el" href="../../d7/d7/fsvga_8c-source.html#l00649">FsVgaConfiguration()</a>.
<p>
<pre class="fragment"><div>00738                    :
00739 
00740     This <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> callout routine sent as a parameter to
00741     <a class="code" href="../../d0/d5/io_8h.html#a525">IoQueryDeviceDescription</a>.  It grabs <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> Display controller
00742     configuration information.
00743 
00744 Arguments:
00745 
00746     Context - Context parameter that was passed in by <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> routine
00747         that called <a class="code" href="../../d0/d5/io_8h.html#a525">IoQueryDeviceDescription</a>.
00748 
00749     PathName - The full pathname <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> registry key.
00750 
00751     BusType - Bus interface <a class="code" href="../../d4/d4/iafptrap_8c.html#a9">type</a> (Isa, Eisa, Mca, etc.).
00752 
00753     BusNumber - The bus sub-key (0, 1, etc.).
00754 
00755     BusInformation - Pointer to the array of pointers to the full value
00756         information <span class="keywordflow">for</span> the bus.
00757 
00758     ControllerType - The controller <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> (should be DisplayController).
00759 
00760     ControllerNumber - The controller sub-key (0, 1, etc.).
00761 
00762     ControllerInformation - Pointer to the array of pointers to the full
00763         value information <span class="keywordflow">for</span> the controller key.
00764 
00765     PeripheralType - The peripheral <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> (should be MonitorPeripheral).
00766 
00767     PeripheralNumber - The peripheral sub-key.
00768 
00769     PeripheralInformation - Pointer to the array of pointers to the full
00770         value information <span class="keywordflow">for</span> the peripheral key.
00771 
00772 
00773 Return Value:
00774 
00775     None.  If successful, will have the following side-effects:
00776 
00777         - Sets DeviceObject-&gt;DeviceExtension-&gt;HardwarePresent.
00778         - Sets configuration fields in
00779           DeviceObject-&gt;DeviceExtension-&gt;Configuration.
00780 
00781 --*/
00782 
00783 {
00784     <a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html">PDEVICE_EXTENSION</a> deviceExtension;
00785     <a class="code" href="../../d3/d1/struct__FSVGA__CONFIGURATION__INFORMATION.html">PFSVGA_CONFIGURATION_INFORMATION</a> configuration;
00786     NTSTATUS status = STATUS_SUCCESS;
00787     CM_PARTIAL_RESOURCE_DESCRIPTOR ResourceDescriptor;
00788 
00789     <a class="code" href="../../d7/d8/fsvga_8h.html#a10">FsVgaPrint</a>((1,
00790                 <span class="stringliteral">"FSVGA-FsVgaPeripheralCallout: Path @ 0x%x, Bus Type 0x%x, Bus Number 0x%x\n"</span>,
00791                 PathName, BusType, BusNumber));
00792     <a class="code" href="../../d7/d8/fsvga_8h.html#a10">FsVgaPrint</a>((1,
00793                 <span class="stringliteral">"    Controller Type 0x%x, Controller Number 0x%x, Controller info @ 0x%x\n"</span>,
00794                 ControllerType, ControllerNumber, ControllerInformation));
00795     <a class="code" href="../../d7/d8/fsvga_8h.html#a10">FsVgaPrint</a>((1,
00796                 <span class="stringliteral">"    Peripheral Type 0x%x, Peripheral Number 0x%x, Peripheral info @ 0x%x\n"</span>,
00797                 PeripheralType, PeripheralNumber, PeripheralInformation));
00798 
00799     <span class="comment">//</span>
00800     <span class="comment">// If we already have the configuration information for the</span>
00801     <span class="comment">// keyboard peripheral, or if the peripheral identifier is missing,</span>
00802     <span class="comment">// just return.</span>
00803     <span class="comment">//</span>
00804 
00805     deviceExtension = (<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html">PDEVICE_EXTENSION</a>) Context;
00806     <span class="keywordflow">if</span> (deviceExtension-&gt;HardwarePresent &amp; FSVGA_HARDWARE_PRESENT)
00807     {
00808         return (status);
00809     }
00810 
00811     configuration = &amp;deviceExtension-&gt;Configuration;
00812 
00813     deviceExtension-&gt;HardwarePresent |= FSVGA_HARDWARE_PRESENT;
00814 
00815     <span class="comment">//</span>
00816     <span class="comment">// Get the bus information.</span>
00817     <span class="comment">//</span>
00818 
00819     configuration-&gt;InterfaceType = BusType;
00820     configuration-&gt;BusNumber = BusNumber;
00821 
00822     <span class="comment">//</span>
00823     <span class="comment">// Get logical IO port addresses.</span>
00824     <span class="comment">//</span>
00825     ResourceDescriptor.Type = CmResourceTypePort;
00826     ResourceDescriptor.ShareDisposition = CmResourceShareShared;
00827     ResourceDescriptor.Flags = CM_RESOURCE_PORT_IO;
00828 
00829     ResourceDescriptor.u.Port.Start.LowPart = VGA_BASE_IO_PORT+CRTC_ADDRESS_PORT_COLOR;
00830     ResourceDescriptor.u.Port.Start.HighPart = 0;
00831     ResourceDescriptor.u.Port.Length = 1;
00832     configuration-&gt;PortList[configuration-&gt;PortListCount] = ResourceDescriptor;
00833     configuration-&gt;PortListCount += 1;
00834 
00835     ResourceDescriptor.u.Port.Start.LowPart = VGA_BASE_IO_PORT+CRTC_DATA_PORT_COLOR;
00836     ResourceDescriptor.u.Port.Start.HighPart = 0;
00837     ResourceDescriptor.u.Port.Length = 1;
00838     configuration-&gt;PortList[configuration-&gt;PortListCount] = ResourceDescriptor;
00839     configuration-&gt;PortListCount += 1;
00840 
00841     ResourceDescriptor.u.Port.Start.LowPart = VGA_BASE_IO_PORT+GRAPH_ADDRESS_PORT;
00842     ResourceDescriptor.u.Port.Start.HighPart = 0;
00843     ResourceDescriptor.u.Port.Length = 2;
00844     configuration-&gt;PortList[configuration-&gt;PortListCount] = ResourceDescriptor;
00845     configuration-&gt;PortListCount += 1;
00846 
00847     ResourceDescriptor.u.Port.Start.LowPart = VGA_BASE_IO_PORT+SEQ_ADDRESS_PORT;
00848     ResourceDescriptor.u.Port.Start.HighPart = 0;
00849     ResourceDescriptor.u.Port.Length = 2;
00850     configuration-&gt;PortList[configuration-&gt;PortListCount] = ResourceDescriptor;
00851     configuration-&gt;PortListCount += 1;
00852 
00853     <span class="keywordflow">return</span>(status);
00854 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a32" doxytag="fsvga.h::FsVgaReverseMousePointer" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS FsVgaReverseMousePointer           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d8/d3/struct__DEVICE__EXTENSION.html">PDEVICE_EXTENSION</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>DeviceExtension</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>PFSVIDEO_REVERSE_MOUSE_POINTER&nbsp;</td>
          <td class="mdname" nowrap> <em>MouseBuffer</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>inputBufferLength</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d7/fsvga_8c-source.html#l01546">1546</a> of file <a class="el" href="../../d7/d7/fsvga_8c-source.html">fsvga.c</a>.
<p>
References <a class="el" href="../../d0/d7/halvprnt_8c-source.html#l00031">BYTE</a>, <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00143">_DEVICE_EXTENSION::CurrentMode</a>, <a class="el" href="../../d3/d1/drawscrn_8c-source.html#l00609">FsgReverseMousePointer()</a>, and <a class="el" href="../../d3/d6/iostubs_8c.html#a0">SCREEN_BUFFER_POINTER</a>.
<p>
Referenced by <a class="el" href="../../d7/d7/fsvga_8c-source.html#l01213">FsVgaDeviceControl()</a>.
<p>
<pre class="fragment"><div>01554                    :
01555 
01556     This routine reverse <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> frame buffer <span class="keywordflow">for</span> mouse pointer.
01557 
01558 Arguments:
01559 
01560     DeviceExtension - Pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> miniport driver's device <a class="code" href="../../d7/d1/genuedef_8c.html#a6">extension</a>.
01561 
01562     MouseBuffer - Pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> structure containing <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> information about <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> mouse frame buffer.
01563 
01564     inputBufferLength - Length of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> input buffer supplied by <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> user.
01565 
01566 Return Value:
01567 
01568     STATUS_INSUFFICIENT_BUFFER <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> input buffer was not large enough
01569         <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> input data.
01570 
01571     STATUS_SUCCESS <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> operation completed successfully.
01572 
01573 --*/
01574 
01575 {
01576     <span class="comment">//</span>
01577     <span class="comment">// Check if the size of the data in the input buffer is large enough.</span>
01578     <span class="comment">//</span>
01579 
01580     <span class="keywordflow">if</span> (inputBufferLength &lt; <span class="keyword">sizeof</span>(FSVIDEO_REVERSE_MOUSE_POINTER)) {
01581         <span class="keywordflow">return</span> STATUS_INVALID_BUFFER_SIZE;
01582     }
01583 
01584     <span class="keywordflow">if</span> (! (DeviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o50">CurrentMode</a>.VideoMode.AttributeFlags &amp; VIDEO_MODE_GRAPHICS))
01585     {
01586         <span class="comment">/*</span>
01587 <span class="comment">         * This is the TEXT frame buffer.</span>
01588 <span class="comment">         */</span>
01589 
01590         ULONG Offs;
01591         PUCHAR pFrameBuf = DeviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o50">CurrentMode</a>.VideoMemory.FrameBufferBase;
01592         <a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a> Attribute;
01593 
01594         Offs = <a class="code" href="../../d3/d6/iostubs_8c.html#a0">SCREEN_BUFFER_POINTER</a>(MouseBuffer-&gt;Screen.Position.X,
01595                                      MouseBuffer-&gt;Screen.Position.Y,
01596                                      MouseBuffer-&gt;Screen.ScreenSize.X,
01597                                      <span class="keyword">sizeof</span>(VGA_CHAR));
01598         pFrameBuf += Offs;
01599 
01600         Attribute =  (*(pFrameBuf + 1) &amp; 0xF0) &gt;&gt; 4;
01601         Attribute |= (*(pFrameBuf + 1) &amp; 0x0F) &lt;&lt; 4;
01602         *(pFrameBuf + 1) = Attribute;
01603     }
01604     <span class="keywordflow">else</span>
01605     {
01606         <span class="comment">/*</span>
01607 <span class="comment">         * This is the GRAPHICS frame buffer.</span>
01608 <span class="comment">         */</span>
01609         <span class="keywordflow">return</span> <a class="code" href="../../d7/d8/fsvga_8h.html#a48">FsgReverseMousePointer</a>(DeviceExtension,
01610                                       MouseBuffer,
01611                                       inputBufferLength);
01612     }
01613 
01614     <span class="keywordflow">return</span> STATUS_SUCCESS;
01615 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a26" doxytag="fsvga.h::FsVgaServiceParameters" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID FsVgaServiceParameters           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d8/d3/struct__DEVICE__EXTENSION.html">PDEVICE_EXTENSION</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>DeviceExtension</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PUNICODE_STRING&nbsp;</td>
          <td class="mdname" nowrap> <em>RegistryPath</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PUNICODE_STRING&nbsp;</td>
          <td class="mdname" nowrap> <em>FsVgaDeviceName</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d7/fsvga_8c-source.html#l00858">858</a> of file <a class="el" href="../../d7/d7/fsvga_8c-source.html">fsvga.c</a>.
<p>
References <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00049">_FSVGA_CONFIGURATION_INFORMATION::EmulationMode</a>, <a class="el" href="../../d6/d4/cc_8h-source.html#l00126">ExAllocatePool</a>, <a class="el" href="../../d7/d2/cmwraper_8c-source.html#l00304">ExFreePool()</a>, <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00310">FsVgaPrint</a>, <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00052">_FSVGA_CONFIGURATION_INFORMATION::HardwareCursor</a>, <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00056">_FSVGA_CONFIGURATION_INFORMATION::HardwareScroll</a>, <a class="el" href="../../d3/d9/aw_8h-source.html#l00031">L</a>, <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00053">NO_HARDWARE_CURSOR</a>, <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00057">NO_HARDWARE_SCROLL</a>, <a class="el" href="../../d6/d5/stierr_8h-source.html#l00030">NT_SUCCESS</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d5/d8/ex_8h.html#a329a174">PagedPool</a>, <a class="el" href="../../d4/d2/dumpuser_8c-source.html#l00045">path</a>, <a class="el" href="../../d7/d5/nls_8c-source.html#l01821">RtlAppendUnicodeToString()</a>, <a class="el" href="../../d7/d5/nls_8c-source.html#l01763">RtlCopyUnicodeString()</a>, <a class="el" href="../../d3/d6/string_8c-source.html#l00148">RtlInitUnicodeString()</a>, <a class="el" href="../../d5/d6/rtl_2regutil_8c-source.html#l00744">RtlQueryRegistryValues()</a>, and <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00064">USHORT</a>.
<p>
Referenced by <a class="el" href="../../d7/d7/fsvga_8c-source.html#l00649">FsVgaConfiguration()</a>.
<p>
<pre class="fragment"><div>00866                    :
00867 
00868     This routine retrieves <span class="keyword">this</span> driver's service parameters information
00869     from <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> registry.
00870 
00871 Arguments:
00872 
00873     DeviceExtension - Pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> device <a class="code" href="../../d7/d1/genuedef_8c.html#a6">extension</a>.
00874 
00875     RegistryPath - Pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> null-terminated <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a96">Unicode</a> name of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00876         registry <a class="code" href="../../d3/d3/dumpuser_8c.html#a14">path</a> <span class="keywordflow">for</span> <span class="keyword">this</span> driver.
00877 
00878     FsVgaDeviceName - Pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a96">Unicode</a> string that will receive
00879         <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> Full Screen Video port device name.
00880 
00881 Return Value:
00882 
00883     None.  As a side-effect, sets fields in DeviceExtension-&gt;Configuration.
00884 
00885 --*/
00886 
00887 {
00888     <a class="code" href="../../d3/d1/struct__FSVGA__CONFIGURATION__INFORMATION.html">PFSVGA_CONFIGURATION_INFORMATION</a> configuration;
00889     UNICODE_STRING parametersPath;
00890     PWSTR <a class="code" href="../../d3/d3/dumpuser_8c.html#a14">path</a>;
00891     PRTL_QUERY_REGISTRY_TABLE parameters = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00892     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a> queriesPlusOne = 4;
00893     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> status = STATUS_SUCCESS;
00894 <span class="preprocessor">#define PARAMETER_MAX 256</span>
00895 <span class="preprocessor"></span>    ULONG EmulationMode;
00896     ULONG HardwareCursor;
00897     ULONG HardwareScroll;
00898     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a> defaultEmulationMode = 0;
00899     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a> defaultHardwareCursor = <a class="code" href="../../d7/d8/fsvga_8h.html#a1">NO_HARDWARE_CURSOR</a>;
00900     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a> defaultHardwareScroll = <a class="code" href="../../d7/d8/fsvga_8h.html#a3">NO_HARDWARE_SCROLL</a>;
00901     UNICODE_STRING defaultFsVgaName;
00902 
00903     configuration = &amp;DeviceExtension-&gt;Configuration;
00904     parametersPath.Buffer = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00905 
00906     <span class="comment">//</span>
00907     <span class="comment">// Registry path is already null-terminated, so just use it.</span>
00908     <span class="comment">//</span>
00909 
00910     <a class="code" href="../../d3/d3/dumpuser_8c.html#a14">path</a> = RegistryPath-&gt;Buffer;
00911 
00912     <span class="comment">//</span>
00913     <span class="comment">// Allocate the Rtl query table.</span>
00914     <span class="comment">//</span>
00915 
00916     parameters = <a class="code" href="../../d5/d5/cc_8h.html#a10">ExAllocatePool</a>(PagedPool,
00917                                 <span class="keyword">sizeof</span>(RTL_QUERY_REGISTRY_TABLE) * queriesPlusOne);
00918     <span class="keywordflow">if</span> (!parameters)
00919     {
00920         <a class="code" href="../../d7/d8/fsvga_8h.html#a10">FsVgaPrint</a>((1,
00921                     <span class="stringliteral">"FSVGA-FsVgaServiceParameters: Couldn't allocate table for Rtl query to parameters for %ws\n"</span>,
00922                     path));
00923         status = STATUS_UNSUCCESSFUL;
00924     }
00925     <span class="keywordflow">else</span>
00926     {
00927         RtlZeroMemory(parameters,
00928                       <span class="keyword">sizeof</span>(RTL_QUERY_REGISTRY_TABLE) * queriesPlusOne);
00929 
00930         <span class="comment">//</span>
00931         <span class="comment">// Form a path to this driver's Parameters subkey.</span>
00932         <span class="comment">//</span>
00933 
00934         <a class="code" href="../../d2/d7/string_8c.html#a7">RtlInitUnicodeString</a>(&amp;parametersPath,
00935                              NULL);
00936 
00937         parametersPath.MaximumLength = RegistryPath-&gt;Length +
00938                                        <span class="keyword">sizeof</span>(<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="stringliteral">"\\Parameters"</span>);
00939         parametersPath.Buffer = <a class="code" href="../../d5/d5/cc_8h.html#a10">ExAllocatePool</a>(PagedPool,
00940                                                parametersPath.MaximumLength);
00941         <span class="keywordflow">if</span> (!parametersPath.Buffer)
00942         {
00943             <a class="code" href="../../d7/d8/fsvga_8h.html#a10">FsVgaPrint</a>((1,
00944                         <span class="stringliteral">"FSVGA-FsVgaServiceParameters: Couldn't allocate string for path to parameters for %ws\n"</span>,
00945                         path));
00946             status = STATUS_UNSUCCESSFUL;
00947         }
00948     }
00949 
00950     <span class="keywordflow">if</span> (<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(status))
00951     {
00952         <span class="comment">//</span>
00953         <span class="comment">// Form the parameters path.</span>
00954         <span class="comment">//</span>
00955         RtlZeroMemory(parametersPath.Buffer,
00956                       parametersPath.MaximumLength);
00957         <a class="code" href="../../d6/d6/nls_8c.html#a45">RtlAppendUnicodeToString</a>(&amp;parametersPath,
00958                                  path);
00959         <a class="code" href="../../d6/d6/nls_8c.html#a45">RtlAppendUnicodeToString</a>(&amp;parametersPath,
00960                                  L<span class="stringliteral">"\\Parameters"</span>);
00961 
00962         <a class="code" href="../../d7/d8/fsvga_8h.html#a10">FsVgaPrint</a>((1,
00963                     <span class="stringliteral">"FsVga-FsVgaServiceParameters: parameters path is %ws\n"</span>,
00964                     parametersPath.Buffer));
00965 
00966         <span class="comment">//</span>
00967         <span class="comment">// Gather all of the "user specified" information from</span>
00968         <span class="comment">// the registry.</span>
00969         <span class="comment">//</span>
00970         parameters[0].Flags = RTL_QUERY_REGISTRY_DIRECT;
00971         parameters[0].Name = <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="stringliteral">"ConsoleFullScreen.EmulationMode"</span>;
00972         parameters[0].EntryContext = &amp;EmulationMode;
00973         parameters[0].DefaultType = REG_DWORD;
00974         parameters[0].DefaultData = &amp;defaultEmulationMode;
00975         parameters[0].DefaultLength = <span class="keyword">sizeof</span>(<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>);
00976 
00977         parameters[1].Flags = RTL_QUERY_REGISTRY_DIRECT;
00978         parameters[1].Name = <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="stringliteral">"ConsoleFullScreen.HardwareCursor"</span>;
00979         parameters[1].EntryContext = &amp;HardwareCursor;
00980         parameters[1].DefaultType = REG_DWORD;
00981         parameters[1].DefaultData = &amp;defaultHardwareCursor;
00982         parameters[1].DefaultLength = <span class="keyword">sizeof</span>(<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>);
00983 
00984         parameters[2].Flags = RTL_QUERY_REGISTRY_DIRECT;
00985         parameters[2].Name = <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="stringliteral">"ConsoleFullScreen.HardwareScroll"</span>;
00986         parameters[2].EntryContext = &amp;HardwareScroll;
00987         parameters[2].DefaultType = REG_DWORD;
00988         parameters[2].DefaultData = &amp;defaultHardwareScroll;
00989         parameters[2].DefaultLength = <span class="keyword">sizeof</span>(<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>);
00990 
00991         status = <a class="code" href="../../d4/d7/rtl_2regutil_8c.html#a19">RtlQueryRegistryValues</a>(RTL_REGISTRY_ABSOLUTE | RTL_REGISTRY_OPTIONAL,
00992                                         parametersPath.Buffer,
00993                                         parameters,
00994                                         NULL,
00995                                         NULL);
00996         <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(status))
00997         {
00998             <a class="code" href="../../d7/d8/fsvga_8h.html#a10">FsVgaPrint</a>((1,
00999                         <span class="stringliteral">"FsVga-FsVgaServiceParameters: RtlQueryRegistryValues failed with 0x%x\n"</span>,
01000                         status));
01001         }
01002     }
01003 
01004     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(status))
01005     {
01006         <span class="comment">//</span>
01007         <span class="comment">// Go ahead and assign driver defaults.</span>
01008         <span class="comment">//</span>
01009         configuration-&gt;<a class="code" href="../../d3/d1/struct__FSVGA__CONFIGURATION__INFORMATION.html#o0">EmulationMode</a> = defaultEmulationMode;
01010         configuration-&gt;<a class="code" href="../../d3/d1/struct__FSVGA__CONFIGURATION__INFORMATION.html#o1">HardwareCursor</a> = defaultHardwareCursor;
01011         configuration-&gt;<a class="code" href="../../d3/d1/struct__FSVGA__CONFIGURATION__INFORMATION.html#o2">HardwareScroll</a> = defaultHardwareScroll;
01012     }
01013     <span class="keywordflow">else</span>
01014     {
01015         configuration-&gt;<a class="code" href="../../d3/d1/struct__FSVGA__CONFIGURATION__INFORMATION.html#o0">EmulationMode</a> = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)EmulationMode;
01016         configuration-&gt;<a class="code" href="../../d3/d1/struct__FSVGA__CONFIGURATION__INFORMATION.html#o1">HardwareCursor</a> = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)HardwareCursor;
01017         configuration-&gt;<a class="code" href="../../d3/d1/struct__FSVGA__CONFIGURATION__INFORMATION.html#o2">HardwareScroll</a> = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)HardwareScroll;
01018     }
01019 
01020     <span class="comment">//</span>
01021     <span class="comment">// Form the default port device names, in case they are not</span>
01022     <span class="comment">// specified in the registry.</span>
01023     <span class="comment">//</span>
01024 
01025     <a class="code" href="../../d2/d7/string_8c.html#a7">RtlInitUnicodeString</a>(&amp;defaultFsVgaName,
01026                          DD_FULLSCREEN_PORT_BASE_NAME_U);
01027     <a class="code" href="../../d6/d6/nls_8c.html#a44">RtlCopyUnicodeString</a>(FsVgaDeviceName, &amp;defaultFsVgaName);
01028 
01029     <a class="code" href="../../d7/d8/fsvga_8h.html#a10">FsVgaPrint</a>((1,
01030                 <span class="stringliteral">"FsVga-FsVgaServiceParameters: Full Screen Video port base name = %ws\n"</span>,
01031                 FsVgaDeviceName-&gt;Buffer));
01032 
01033     <a class="code" href="../../d7/d8/fsvga_8h.html#a10">FsVgaPrint</a>((1,
01034                 <span class="stringliteral">"FsVga-FsVgaServiceParameters: Emulation Mode = %d\n"</span>,
01035                 configuration-&gt;<a class="code" href="../../d3/d1/struct__FSVGA__CONFIGURATION__INFORMATION.html#o0">EmulationMode</a>));
01036 
01037     <a class="code" href="../../d7/d8/fsvga_8h.html#a10">FsVgaPrint</a>((1,
01038                 <span class="stringliteral">"FsVga-FsVgaServiceParameters: Hardware Cursor = %d\n"</span>,
01039                 configuration-&gt;<a class="code" href="../../d3/d1/struct__FSVGA__CONFIGURATION__INFORMATION.html#o1">HardwareCursor</a>));
01040 
01041     <a class="code" href="../../d7/d8/fsvga_8h.html#a10">FsVgaPrint</a>((1,
01042                 <span class="stringliteral">"FsVga-FsVgaServiceParameters: Hardware Scroll = %d\n"</span>,
01043                 configuration-&gt;<a class="code" href="../../d3/d1/struct__FSVGA__CONFIGURATION__INFORMATION.html#o2">HardwareScroll</a>));
01044 
01045     <span class="comment">//</span>
01046     <span class="comment">// Free the allocated memory before returning.</span>
01047     <span class="comment">//</span>
01048 
01049     <span class="keywordflow">if</span> (parametersPath.Buffer)
01050         <a class="code" href="../../d5/d8/ex_8h.html#a224">ExFreePool</a>(parametersPath.Buffer);
01051     <span class="keywordflow">if</span> (parameters)
01052         <a class="code" href="../../d5/d8/ex_8h.html#a224">ExFreePool</a>(parameters);
01053 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a36" doxytag="fsvga.h::FsVgaSetCursorAttribute" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS FsVgaSetCursorAttribute           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d8/d3/struct__DEVICE__EXTENSION.html">PDEVICE_EXTENSION</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>DeviceExtension</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>PVIDEO_CURSOR_ATTRIBUTES&nbsp;</td>
          <td class="mdname" nowrap> <em>CursorAttributes</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>inputBufferLength</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d7/fsvga_8c-source.html#l01777">1777</a> of file <a class="el" href="../../d7/d7/fsvga_8c-source.html">fsvga.c</a>.
<p>
References <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00143">_DEVICE_EXTENSION::CurrentMode</a>, <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00105">_EMULATE_BUFFER_INFORMATION::CursorAttributes</a>, <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00153">_DEVICE_EXTENSION::EmulateInfo</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d3/d1/drawscrn_8c-source.html#l00702">FsgInvertCursor()</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d7/d7/fsvga_8c-source.html#l01213">FsVgaDeviceControl()</a>.
<p>
<pre class="fragment"><div>01785                    :
01786 
01787     This routine sets <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> cursor attributes.
01788 
01789 Arguments:
01790 
01791     DeviceExtension - Pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> miniport driver's device <a class="code" href="../../d7/d1/genuedef_8c.html#a6">extension</a>.
01792 
01793     CursorAttributes - Pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> structure containing <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> information about <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
01794                        cursor attributes.
01795 
01796     inputBufferLength - Length of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> input buffer supplied by <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> user.
01797 
01798 Return Value:
01799 
01800     STATUS_INSUFFICIENT_BUFFER <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> input buffer was not large enough
01801         <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> input data.
01802 
01803     STATUS_SUCCESS <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> operation completed successfully.
01804 
01805 --*/
01806 
01807 {
01808     <span class="comment">//</span>
01809     <span class="comment">// Check if the size of the data in the input buffer is large enough.</span>
01810     <span class="comment">//</span>
01811 
01812     <span class="keywordflow">if</span> (inputBufferLength &lt; <span class="keyword">sizeof</span>(VIDEO_CURSOR_ATTRIBUTES)) {
01813         <span class="keywordflow">return</span> STATUS_INVALID_BUFFER_SIZE;
01814     }
01815 
01816     <span class="keywordflow">if</span> (DeviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o50">CurrentMode</a>.VideoMode.AttributeFlags &amp; VIDEO_MODE_GRAPHICS)
01817     {
01818         <a class="code" href="../../d7/d8/fsvga_8h.html#a49">FsgInvertCursor</a>(DeviceExtension,FALSE);
01819     }
01820 
01821     DeviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o52">EmulateInfo</a>.<a class="code" href="../../d1/d3/struct__EMULATE__BUFFER__INFORMATION.html#o9">CursorAttributes</a> = *CursorAttributes;
01822 
01823     <span class="keywordflow">if</span> (DeviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o50">CurrentMode</a>.VideoMode.AttributeFlags &amp; VIDEO_MODE_GRAPHICS)
01824     {
01825         <a class="code" href="../../d7/d8/fsvga_8h.html#a49">FsgInvertCursor</a>(DeviceExtension,TRUE);
01826         <span class="keywordflow">return</span> STATUS_SUCCESS;
01827     }
01828     <span class="keywordflow">else</span>
01829     {
01830         <span class="comment">/*</span>
01831 <span class="comment">         * If current video mode is a TEXT MODE.</span>
01832 <span class="comment">         * FSVGA.SYS didn't handling hardware cursor</span>
01833 <span class="comment">         * because I don't know device of VGA.SYS or others.</span>
01834 <span class="comment">         *</span>
01835 <span class="comment">         * In this case, by returns STATUS_UNSUCCESSFUL, caller </span>
01836 <span class="comment">         * do DeviceIoControl to VGA miniport driver.</span>
01837 <span class="comment">         */</span>
01838         <span class="keywordflow">return</span> STATUS_UNSUCCESSFUL;
01839     }
01840 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a35" doxytag="fsvga.h::FsVgaSetCursorPosition" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS FsVgaSetCursorPosition           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d8/d3/struct__DEVICE__EXTENSION.html">PDEVICE_EXTENSION</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>DeviceExtension</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>PFSVIDEO_CURSOR_POSITION&nbsp;</td>
          <td class="mdname" nowrap> <em>CursorPosition</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>inputBufferLength</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d7/fsvga_8c-source.html#l01710">1710</a> of file <a class="el" href="../../d7/d7/fsvga_8c-source.html">fsvga.c</a>.
<p>
References <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00143">_DEVICE_EXTENSION::CurrentMode</a>, <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00106">_EMULATE_BUFFER_INFORMATION::CursorPosition</a>, <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00153">_DEVICE_EXTENSION::EmulateInfo</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d3/d1/drawscrn_8c-source.html#l00702">FsgInvertCursor()</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d7/d7/fsvga_8c-source.html#l01213">FsVgaDeviceControl()</a>.
<p>
<pre class="fragment"><div>01718                    :
01719 
01720     This routine sets <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> cursor position.
01721 
01722 Arguments:
01723 
01724     DeviceExtension - Pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> miniport driver's device <a class="code" href="../../d7/d1/genuedef_8c.html#a6">extension</a>.
01725 
01726     CursorPosition - Pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> structure containing <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> information about <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
01727                      cursor position.
01728 
01729     inputBufferLength - Length of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> input buffer supplied by <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> user.
01730 
01731 Return Value:
01732 
01733     STATUS_INSUFFICIENT_BUFFER <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> input buffer was not large enough
01734         <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> input data.
01735 
01736     STATUS_SUCCESS <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> operation completed successfully.
01737 
01738 --*/
01739 
01740 {
01741     <span class="comment">//</span>
01742     <span class="comment">// Check if the size of the data in the input buffer is large enough.</span>
01743     <span class="comment">//</span>
01744 
01745     <span class="keywordflow">if</span> (inputBufferLength &lt; <span class="keyword">sizeof</span>(VIDEO_CURSOR_POSITION)) {
01746         <span class="keywordflow">return</span> STATUS_INVALID_BUFFER_SIZE;
01747     }
01748 
01749     <span class="keywordflow">if</span> (DeviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o50">CurrentMode</a>.VideoMode.AttributeFlags &amp; VIDEO_MODE_GRAPHICS)
01750     {
01751         <a class="code" href="../../d7/d8/fsvga_8h.html#a49">FsgInvertCursor</a>(DeviceExtension,FALSE);
01752     }
01753 
01754     DeviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o52">EmulateInfo</a>.<a class="code" href="../../d1/d3/struct__EMULATE__BUFFER__INFORMATION.html#o10">CursorPosition</a> = *CursorPosition;
01755 
01756     <span class="keywordflow">if</span> (DeviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o50">CurrentMode</a>.VideoMode.AttributeFlags &amp; VIDEO_MODE_GRAPHICS)
01757     {
01758         <a class="code" href="../../d7/d8/fsvga_8h.html#a49">FsgInvertCursor</a>(DeviceExtension,TRUE);
01759         <span class="keywordflow">return</span> STATUS_SUCCESS;
01760     }
01761     <span class="keywordflow">else</span>
01762     {
01763         <span class="comment">/*</span>
01764 <span class="comment">         * If current video mode is a TEXT MODE.</span>
01765 <span class="comment">         * FSVGA.SYS didn't handling hardware cursor</span>
01766 <span class="comment">         * because I don't know device of VGA.SYS or others.</span>
01767 <span class="comment">         *</span>
01768 <span class="comment">         * In this case, by returns STATUS_UNSUCCESSFUL, caller </span>
01769 <span class="comment">         * do DeviceIoControl to VGA miniport driver.</span>
01770 <span class="comment">         */</span>
01771         <span class="keywordflow">return</span> STATUS_UNSUCCESSFUL;
01772     }
01773 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a33" doxytag="fsvga.h::FsVgaSetMode" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS FsVgaSetMode           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d8/d3/struct__DEVICE__EXTENSION.html">PDEVICE_EXTENSION</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>DeviceExtension</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>PFSVIDEO_MODE_INFORMATION&nbsp;</td>
          <td class="mdname" nowrap> <em>ModeInformation</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>inputBufferLength</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d7/fsvga_8c-source.html#l01618">1618</a> of file <a class="el" href="../../d7/d7/fsvga_8c-source.html">fsvga.c</a>.
<p>
References <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00143">_DEVICE_EXTENSION::CurrentMode</a>.
<p>
Referenced by <a class="el" href="../../d7/d7/fsvga_8c-source.html#l01213">FsVgaDeviceControl()</a>.
<p>
<pre class="fragment"><div>01626                    :
01627 
01628     This routine sets <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> current video information.
01629 
01630 Arguments:
01631 
01632     DeviceExtension - Pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> miniport driver's device <a class="code" href="../../d7/d1/genuedef_8c.html#a6">extension</a>.
01633 
01634     ModeInformation - Pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> structure containing <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> information about <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
01635                       full screen video.
01636 
01637     inputBufferLength - Length of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> input buffer supplied by <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> user.
01638 
01639 Return Value:
01640 
01641     STATUS_INSUFFICIENT_BUFFER <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> input buffer was not large enough
01642         <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> input data.
01643 
01644     STATUS_SUCCESS <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> operation completed successfully.
01645 
01646 --*/
01647 
01648 {
01649     <span class="comment">//</span>
01650     <span class="comment">// Check if the size of the data in the input buffer is large enough.</span>
01651     <span class="comment">//</span>
01652 
01653     <span class="keywordflow">if</span> (inputBufferLength &lt; <span class="keyword">sizeof</span>(FSVIDEO_MODE_INFORMATION)) {
01654         <span class="keywordflow">return</span> STATUS_INVALID_BUFFER_SIZE;
01655     }
01656 
01657     DeviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o50">CurrentMode</a> = *ModeInformation;
01658 
01659     <span class="keywordflow">return</span> STATUS_SUCCESS;
01660 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a34" doxytag="fsvga.h::FsVgaSetScreenInformation" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS FsVgaSetScreenInformation           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d8/d3/struct__DEVICE__EXTENSION.html">PDEVICE_EXTENSION</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>DeviceExtension</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>PFSVIDEO_SCREEN_INFORMATION&nbsp;</td>
          <td class="mdname" nowrap> <em>ScreenInformation</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>inputBufferLength</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d7/fsvga_8c-source.html#l01663">1663</a> of file <a class="el" href="../../d7/d7/fsvga_8c-source.html">fsvga.c</a>.
<p>
References <a class="el" href="../../d3/d1/drawscrn_8c-source.html#l00387">FsgVgaInitializeHWFlags()</a>, and <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00148">_DEVICE_EXTENSION::ScreenAndFont</a>.
<p>
Referenced by <a class="el" href="../../d7/d7/fsvga_8c-source.html#l01213">FsVgaDeviceControl()</a>.
<p>
<pre class="fragment"><div>01671                    :
01672 
01673     This routine sets <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> screen and font information.
01674 
01675 Arguments:
01676 
01677     DeviceExtension - Pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> miniport driver's device <a class="code" href="../../d7/d1/genuedef_8c.html#a6">extension</a>.
01678 
01679     ScreenInformation - Pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> structure containing <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> information about <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
01680                         screen anf font.
01681 
01682     inputBufferLength - Length of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> input buffer supplied by <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> user.
01683 
01684 Return Value:
01685 
01686     STATUS_INSUFFICIENT_BUFFER <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> input buffer was not large enough
01687         <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> input data.
01688 
01689     STATUS_SUCCESS <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> operation completed successfully.
01690 
01691 --*/
01692 
01693 {
01694     <span class="comment">//</span>
01695     <span class="comment">// Check if the size of the data in the input buffer is large enough.</span>
01696     <span class="comment">//</span>
01697 
01698     <span class="keywordflow">if</span> (inputBufferLength &lt; <span class="keyword">sizeof</span>(FSVIDEO_SCREEN_INFORMATION)) {
01699         <span class="keywordflow">return</span> STATUS_INVALID_BUFFER_SIZE;
01700     }
01701 
01702     DeviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o51">ScreenAndFont</a> = *ScreenInformation;
01703 
01704     <a class="code" href="../../d7/d8/fsvga_8h.html#a45">FsgVgaInitializeHWFlags</a>(DeviceExtension);
01705 
01706     <span class="keywordflow">return</span> STATUS_SUCCESS;
01707 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a31" doxytag="fsvga.h::FsVgaWriteToFrameBuffer" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS FsVgaWriteToFrameBuffer           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d8/d3/struct__DEVICE__EXTENSION.html">PDEVICE_EXTENSION</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>DeviceExtension</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>PFSVIDEO_WRITE_TO_FRAME_BUFFER&nbsp;</td>
          <td class="mdname" nowrap> <em>WriteFrameBuffer</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>inputBufferLength</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d7/fsvga_8c-source.html#l01429">1429</a> of file <a class="el" href="../../d7/d7/fsvga_8c-source.html">fsvga.c</a>.
<p>
References <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00143">_DEVICE_EXTENSION::CurrentMode</a>, <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00126">_DEVICE_EXTENSION::DeviceObject</a>, <a class="el" href="../../d6/d8/fsvga_8c.html#a1">DUMP_COUNT</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d6/d4/cc_8h-source.html#l00126">ExAllocatePool</a>, <a class="el" href="../../d7/d2/cmwraper_8c-source.html#l00304">ExFreePool()</a>, <a class="el" href="../../d3/d1/drawscrn_8c-source.html#l00489">FsgWriteToFrameBuffer()</a>, <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00168">FSVGA_ERROR_VALUE_BASE</a>, <a class="el" href="../../d7/d7/fsvga_8c-source.html#l01844">FsVgaLogError()</a>, <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00310">FsVgaPrint</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d5/d8/ex_8h.html#a329a174">PagedPool</a>, <a class="el" href="../../d3/d6/iostubs_8c.html#a0">SCREEN_BUFFER_POINTER</a>, <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00148">_DEVICE_EXTENSION::ScreenAndFont</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00062">SHORT</a>, and <a class="el" href="../../d4/d9/w32_2ntcon_2fullscr_2vga_2misc_8c-source.html#l00086">TranslateOutputToOem()</a>.
<p>
Referenced by <a class="el" href="../../d7/d7/fsvga_8c-source.html#l01213">FsVgaDeviceControl()</a>.
<p>
<pre class="fragment"><div>01437                    :
01438 
01439     This routine write <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> frame buffer.
01440 
01441 Arguments:
01442 
01443     DeviceExtension - Pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> miniport driver's device <a class="code" href="../../d7/d1/genuedef_8c.html#a6">extension</a>.
01444 
01445     WriteFrameBuffer - Pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> structure containing <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> information about <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> write frame buffer.
01446 
01447     inputBufferLength - Length of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> input buffer supplied by <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> user.
01448 
01449 Return Value:
01450 
01451     STATUS_INSUFFICIENT_BUFFER <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> input buffer was not large enough
01452         <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> input data.
01453 
01454     STATUS_SUCCESS <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> operation completed successfully.
01455 
01456 --*/
01457 
01458 {
01459     <span class="comment">//</span>
01460     <span class="comment">// Check if the size of the data in the input buffer is large enough.</span>
01461     <span class="comment">//</span>
01462 
01463     <span class="keywordflow">if</span> (inputBufferLength &lt; <span class="keyword">sizeof</span>(FSVIDEO_WRITE_TO_FRAME_BUFFER)) {
01464         <span class="keywordflow">return</span> STATUS_INVALID_BUFFER_SIZE;
01465     }
01466 
01467     <span class="keywordflow">if</span> (WriteFrameBuffer-&gt;DestScreen.Position.X &lt; 0 ||
01468         WriteFrameBuffer-&gt;DestScreen.Position.X &gt; DeviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o51">ScreenAndFont</a>.ScreenSize.X ||
01469         (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a>)(WriteFrameBuffer-&gt;DestScreen.Position.X +
01470                 WriteFrameBuffer-&gt;DestScreen.nNumberOfChars)
01471                                                 &gt; DeviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o51">ScreenAndFont</a>.ScreenSize.X ||
01472         WriteFrameBuffer-&gt;DestScreen.Position.Y &lt; 0 ||
01473         WriteFrameBuffer-&gt;DestScreen.Position.Y &gt; DeviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o51">ScreenAndFont</a>.ScreenSize.Y) {
01474         <span class="keywordflow">return</span> STATUS_INVALID_BUFFER_SIZE;
01475     }
01476 
01477     <span class="keywordflow">if</span> (! (DeviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o50">CurrentMode</a>.VideoMode.AttributeFlags &amp; VIDEO_MODE_GRAPHICS))
01478     {
01479         <span class="comment">/*</span>
01480 <span class="comment">         * This is the TEXT frame buffer.</span>
01481 <span class="comment">         */</span>
01482 
01483         ULONG Offs;
01484         PUCHAR pFrameBuf = DeviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o50">CurrentMode</a>.VideoMemory.FrameBufferBase;
01485         PCHAR_IMAGE_INFO pCharInfoUni = WriteFrameBuffer-&gt;SrcBuffer;
01486         PCHAR_IMAGE_INFO pCharInfoAsc;
01487         <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> Length = WriteFrameBuffer-&gt;DestScreen.nNumberOfChars;
01488         PVOID pCapBuffer = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01489         ULONG cCapBuffer = 0;
01490 
01491         Offs = <a class="code" href="../../d3/d6/iostubs_8c.html#a0">SCREEN_BUFFER_POINTER</a>(WriteFrameBuffer-&gt;DestScreen.Position.X,
01492                                      WriteFrameBuffer-&gt;DestScreen.Position.Y,
01493                                      WriteFrameBuffer-&gt;DestScreen.ScreenSize.X,
01494                                      <span class="keyword">sizeof</span>(VGA_CHAR));
01495 
01496         cCapBuffer = Length * <span class="keyword">sizeof</span>(CHAR_IMAGE_INFO);
01497         pCapBuffer = <a class="code" href="../../d5/d5/cc_8h.html#a10">ExAllocatePool</a>(PagedPool, cCapBuffer);
01498 
01499         <span class="keywordflow">if</span> (!pCapBuffer) {
01500 <span class="preprocessor">            #define DUMP_COUNT 4</span>
01501 <span class="preprocessor"></span>            ULONG dumpData[<a class="code" href="../../d6/d8/fsvga_8c.html#a1">DUMP_COUNT</a>];
01502 
01503             <a class="code" href="../../d7/d8/fsvga_8h.html#a10">FsVgaPrint</a>((1,
01504                         <span class="stringliteral">"FSVGA-FsVgaWriteToFrameBuffer: Could not allocate resource list\n"</span>));
01505             <span class="comment">//</span>
01506             <span class="comment">// Log an error.</span>
01507             <span class="comment">//</span>
01508             dumpData[0] = cCapBuffer;
01509             <a class="code" href="../../d7/d8/fsvga_8h.html#a37">FsVgaLogError</a>(DeviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o3">DeviceObject</a>,
01510                           FSVGA_INSUFFICIENT_RESOURCES,
01511                           FSVGA_ERROR_VALUE_BASE + 200,
01512                           STATUS_INSUFFICIENT_RESOURCES,
01513                           dumpData,
01514                           1
01515                          );
01516             <span class="keywordflow">return</span> STATUS_UNSUCCESSFUL;
01517         }
01518 
01519         <a class="code" href="../../d3/d0/w32_2ntcon_2fullscr_2vga_2misc_8c.html#a1">TranslateOutputToOem</a>(pCapBuffer, pCharInfoUni, Length);
01520 
01521         pCharInfoAsc = pCapBuffer;
01522         pFrameBuf += Offs;
01523         <span class="keywordflow">while</span> (Length--)
01524         {
01525             *pFrameBuf++ = pCharInfoAsc-&gt;CharInfo.Char.AsciiChar;
01526             *pFrameBuf++ = (UCHAR) (pCharInfoAsc-&gt;CharInfo.Attributes);
01527             pCharInfoAsc++;
01528         }
01529 
01530         <a class="code" href="../../d5/d8/ex_8h.html#a224">ExFreePool</a>(pCapBuffer);
01531     }
01532     <span class="keywordflow">else</span>
01533     {
01534         <span class="comment">/*</span>
01535 <span class="comment">         * This is the GRAPHICS frame buffer.</span>
01536 <span class="comment">         */</span>
01537         <span class="keywordflow">return</span> <a class="code" href="../../d7/d8/fsvga_8h.html#a47">FsgWriteToFrameBuffer</a>(DeviceExtension,
01538                                      WriteFrameBuffer,
01539                                      inputBufferLength);
01540     }
01541 
01542     <span class="keywordflow">return</span> STATUS_SUCCESS;
01543 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a59" doxytag="fsvga.h::GetHardwareScrollReg" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID GetHardwareScrollReg           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d8/d3/struct__DEVICE__EXTENSION.html">PDEVICE_EXTENSION</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>deviceExtension</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d1/port_8c-source.html#l00031">31</a> of file <a class="el" href="../../d7/d1/port_8c-source.html">port.c</a>.
<p>
References <a class="el" href="../../d7/d8/fsvga_8h.html#a66a18">CRTCAddressPortColor</a>, <a class="el" href="../../d7/d8/fsvga_8h.html#a66a19">CRTCDataPortColor</a>, <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00132">_DEVICE_EXTENSION::DeviceRegisters</a>, <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00153">_DEVICE_EXTENSION::EmulateInfo</a>, <a class="el" href="../../d2/d3/fetypes_8h.html#a457a417">high</a>, <a class="el" href="../../d2/d5/vga_8h-source.html#l00137">IND_LINE_COMPARE</a>, <a class="el" href="../../d2/d5/vga_8h-source.html#l00138">IND_LINE_COMPARE8</a>, <a class="el" href="../../d2/d5/vga_8h-source.html#l00139">IND_LINE_COMPARE9</a>, <a class="el" href="../../d2/d5/vga_8h-source.html#l00135">IND_START_ADRS_H</a>, <a class="el" href="../../d2/d5/vga_8h-source.html#l00136">IND_START_ADRS_L</a>, <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00091">_EMULATE_BUFFER_INFORMATION::LineCompare</a>, <a class="el" href="../../d2/d3/fetypes_8h.html#a457a418">low</a>, and <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00090">_EMULATE_BUFFER_INFORMATION::StartAddress</a>.
<p>
Referenced by <a class="el" href="../../d3/d1/drawscrn_8c-source.html#l00387">FsgVgaInitializeHWFlags()</a>.
<p>
<pre class="fragment"><div>00037                    :
00038 
00039     This routine gets <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> hardware scrolls <span class="keyword">register</span> value.
00040 
00041 Arguments:
00042 
00043 Return Value:
00044 
00045 --*/
00046 
00047 {
00048     UCHAR <a class="code" href="../../d2/d3/fetypes_8h.html#a457a418">low</a>;
00049     UCHAR <a class="code" href="../../d2/d3/fetypes_8h.html#a457a417">high</a>;
00050     UCHAR mid;
00051 
00052     WRITE_PORT_UCHAR(deviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o48">DeviceRegisters</a>[CRTCAddressPortColor],
00053                       IND_START_ADRS_L);
00054     <a class="code" href="../../d2/d3/fetypes_8h.html#a457a418">low</a> = READ_PORT_UCHAR(deviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o48">DeviceRegisters</a>[CRTCDataPortColor]);
00055 
00056     WRITE_PORT_UCHAR(deviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o48">DeviceRegisters</a>[CRTCAddressPortColor],
00057                       IND_START_ADRS_H);
00058     <a class="code" href="../../d2/d3/fetypes_8h.html#a457a417">high</a> = READ_PORT_UCHAR(deviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o48">DeviceRegisters</a>[CRTCDataPortColor]);
00059 
00060     deviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o52">EmulateInfo</a>.<a class="code" href="../../d1/d3/struct__EMULATE__BUFFER__INFORMATION.html#o0">StartAddress</a> = MAKEWORD(low, high);
00061 
00062     WRITE_PORT_UCHAR(deviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o48">DeviceRegisters</a>[CRTCAddressPortColor],
00063                       IND_LINE_COMPARE);
00064     <a class="code" href="../../d2/d3/fetypes_8h.html#a457a418">low</a> = READ_PORT_UCHAR(deviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o48">DeviceRegisters</a>[CRTCDataPortColor]);
00065 
00066     WRITE_PORT_UCHAR(deviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o48">DeviceRegisters</a>[CRTCAddressPortColor],
00067                       IND_LINE_COMPARE8);
00068     mid = READ_PORT_UCHAR(deviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o48">DeviceRegisters</a>[CRTCDataPortColor]);
00069     mid = (mid &gt;&gt; 4) &amp; 1;
00070 
00071     WRITE_PORT_UCHAR(deviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o48">DeviceRegisters</a>[CRTCAddressPortColor],
00072                       IND_LINE_COMPARE9);
00073     <a class="code" href="../../d2/d3/fetypes_8h.html#a457a417">high</a> = READ_PORT_UCHAR(deviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o48">DeviceRegisters</a>[CRTCDataPortColor]);
00074     <a class="code" href="../../d2/d3/fetypes_8h.html#a457a417">high</a> = (<a class="code" href="../../d2/d3/fetypes_8h.html#a457a417">high</a> &gt;&gt; 5) &amp; 2;
00075 
00076     <a class="code" href="../../d2/d3/fetypes_8h.html#a457a417">high</a> |= mid;
00077     deviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o52">EmulateInfo</a>.<a class="code" href="../../d1/d3/struct__EMULATE__BUFFER__INFORMATION.html#o1">LineCompare</a> = MAKEWORD(low, high);
00078 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a40" doxytag="fsvga.h::IsGRAMRowOver" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL IsGRAMRowOver           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">PUCHAR&nbsp;</td>
          <td class="mdname" nowrap> <em>BufPtr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>BOOL&nbsp;</td>
          <td class="mdname" nowrap> <em>fDbcs</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d8/d3/struct__DEVICE__EXTENSION.html">PDEVICE_EXTENSION</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>DeviceExtension</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d1/drawscrn_8c-source.html#l00152">152</a> of file <a class="el" href="../../d3/d1/drawscrn_8c-source.html">drawscrn.c</a>.
<p>
References <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00143">_DEVICE_EXTENSION::CurrentMode</a>, <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00097">_EMULATE_BUFFER_INFORMATION::DeltaNextFontRow</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00153">_DEVICE_EXTENSION::EmulateInfo</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00095">_EMULATE_BUFFER_INFORMATION::LimitGRAM</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d3/d1/drawscrn_8c-source.html#l00813">FsgWriteToScreen()</a>.
<p>
<pre class="fragment"><div>00160                    :
00161 
00162     This Routine check <a class="code" href="../../d9/d4/struct__ROW.html">ROW</a> overflow as GRAM limit line.
00163 
00164 Arguments:
00165 
00166     BufPtr - Pointer to graphics buffer.
00167 
00168     fDbcs - Flag of DBCS(<span class="keyword">true</span>) or SBCS(false).
00169 
00170 Return Value:
00171     TRUE:  if font box is overflow as GRAMlimit line.
00172     FALSE: not overflow.
00173 
00174 --*/
00175 
00176 {
00177     <span class="keywordflow">if</span> (fDbcs)
00178     {
00179         <span class="keywordflow">if</span> ((<a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)(BufPtr + 1 +
00180                     DeviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o52">EmulateInfo</a>.<a class="code" href="../../d1/d3/struct__EMULATE__BUFFER__INFORMATION.html#o6">DeltaNextFontRow</a> -
00181                     (PUCHAR)DeviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o50">CurrentMode</a>.VideoMemory.FrameBufferBase)
00182              &gt;= DeviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o52">EmulateInfo</a>.<a class="code" href="../../d1/d3/struct__EMULATE__BUFFER__INFORMATION.html#o5">LimitGRAM</a>)
00183             <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00184         <span class="keywordflow">else</span>
00185             <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00186     }
00187     <span class="keywordflow">else</span>
00188     {
00189         <span class="keywordflow">if</span> ((<a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)(BufPtr +
00190                     DeviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o52">EmulateInfo</a>.<a class="code" href="../../d1/d3/struct__EMULATE__BUFFER__INFORMATION.html#o6">DeltaNextFontRow</a> -
00191                     (PUCHAR)DeviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o50">CurrentMode</a>.VideoMemory.FrameBufferBase)
00192              &gt;= DeviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o52">EmulateInfo</a>.<a class="code" href="../../d1/d3/struct__EMULATE__BUFFER__INFORMATION.html#o5">LimitGRAM</a>)
00193             <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00194         <span class="keywordflow">else</span>
00195             <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00196     }
00197 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a42" doxytag="fsvga.h::memcpyGRAM" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID memcpyGRAM           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PCHAR&nbsp;</td>
          <td class="mdname" nowrap> <em>TargetPtr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PCHAR&nbsp;</td>
          <td class="mdname" nowrap> <em>SourcePtr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Length</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d1/drawscrn_8c-source.html#l00233">233</a> of file <a class="el" href="../../d3/d1/drawscrn_8c-source.html">drawscrn.c</a>.
<p>
Referenced by <a class="el" href="../../d3/d1/drawscrn_8c-source.html#l00263">memcpyGRAMOver()</a>, and <a class="el" href="../../d3/d1/drawscrn_8c-source.html#l00314">MoveGRAM()</a>.
<p>
<pre class="fragment"><div>00241                    :
00242 
00243     This routine <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> a memory copy <span class="keywordflow">for</span> byte order.
00244 
00245 Arguments:
00246 
00247     TargetPtr - Pointer to target graphics buffer.
00248 
00249     SourcePtr - Pointer to source graphics buffer.
00250 
00251     Length - Fill length.
00252 
00253 Return Value:
00254 
00255 --*/
00256 
00257 {
00258     <span class="keywordflow">while</span> (Length--)
00259         *TargetPtr++ = *SourcePtr++;
00260 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a43" doxytag="fsvga.h::memcpyGRAMOver" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID memcpyGRAMOver           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PCHAR&nbsp;</td>
          <td class="mdname" nowrap> <em>TargetPtr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PCHAR&nbsp;</td>
          <td class="mdname" nowrap> <em>SourcePtr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Length</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PUCHAR&nbsp;</td>
          <td class="mdname" nowrap> <em>FrameBufPtr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d8/d3/struct__DEVICE__EXTENSION.html">PDEVICE_EXTENSION</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>DeviceExtension</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d1/drawscrn_8c-source.html#l00263">263</a> of file <a class="el" href="../../d3/d1/drawscrn_8c-source.html">drawscrn.c</a>.
<p>
References <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, and <a class="el" href="../../d3/d1/drawscrn_8c-source.html#l00233">memcpyGRAM()</a>.
<p>
Referenced by <a class="el" href="../../d3/d1/drawscrn_8c-source.html#l00314">MoveGRAM()</a>.
<p>
<pre class="fragment"><div>00273                    :
00274 
00275     This routine <a class="code" href="../../d7/d4/conexts_8c.html#a1">move</a> a graphics buffer.
00276 
00277 Arguments:
00278 
00279     TargetPtr - Pointer to target graphics buffer.
00280 
00281     SourcePtr - Pointer to source graphics buffer.
00282 
00283     Length - Fill length.
00284 
00285 Return Value:
00286 
00287 --*/
00288 
00289 {
00290     ULONG tmpLen;
00291 
00292     <span class="keywordflow">if</span> ((<a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)(SourcePtr + Length - FrameBufPtr) &gt;= DeviceExtension-&gt;EmulateInfo.LimitGRAM) {
00293         tmpLen = DeviceExtension-&gt;EmulateInfo.LimitGRAM - (SourcePtr - FrameBufPtr);
00294         <a class="code" href="../../d7/d8/fsvga_8h.html#a42">memcpyGRAM</a>(TargetPtr, SourcePtr, tmpLen);
00295         TargetPtr += tmpLen;
00296         Length -= tmpLen;
00297         SourcePtr = FrameBufPtr;
00298     }
00299 
00300     <span class="keywordflow">if</span> ((<a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)(TargetPtr + Length - FrameBufPtr) &gt;= DeviceExtension-&gt;EmulateInfo.LimitGRAM) {
00301         tmpLen = DeviceExtension-&gt;EmulateInfo.LimitGRAM - (TargetPtr - FrameBufPtr);
00302         <a class="code" href="../../d7/d8/fsvga_8h.html#a42">memcpyGRAM</a>(TargetPtr, SourcePtr, tmpLen);
00303         SourcePtr += tmpLen;
00304         Length -= tmpLen;
00305         TargetPtr = FrameBufPtr;
00306     }
00307 
00308     <span class="keywordflow">if</span> (Length) {
00309         <a class="code" href="../../d7/d8/fsvga_8h.html#a42">memcpyGRAM</a>(TargetPtr, SourcePtr, Length);
00310     }
00311 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a44" doxytag="fsvga.h::MoveGRAM" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID MoveGRAM           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PCHAR&nbsp;</td>
          <td class="mdname" nowrap> <em>TargetPtr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PCHAR&nbsp;</td>
          <td class="mdname" nowrap> <em>SourcePtr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Length</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PUCHAR&nbsp;</td>
          <td class="mdname" nowrap> <em>FrameBufPtr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d8/d3/struct__DEVICE__EXTENSION.html">PDEVICE_EXTENSION</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>DeviceExtension</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d1/drawscrn_8c-source.html#l00314">314</a> of file <a class="el" href="../../d3/d1/drawscrn_8c-source.html">drawscrn.c</a>.
<p>
References <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d3/d1/drawscrn_8c-source.html#l00233">memcpyGRAM()</a>, <a class="el" href="../../d3/d1/drawscrn_8c-source.html#l00263">memcpyGRAMOver()</a>, <a class="el" href="../../d7/d1/port_8c-source.html#l00121">SetGRAMCopyMode()</a>, and <a class="el" href="../../d7/d1/port_8c-source.html#l00081">SetGRAMWriteMode()</a>.
<p>
Referenced by <a class="el" href="../../d3/d1/drawscrn_8c-source.html#l00437">FsgCopyFrameBuffer()</a>.
<p>
<pre class="fragment"><div>00324                    :
00325 
00326     This routine <a class="code" href="../../d7/d4/conexts_8c.html#a1">move</a> a graphics buffer.
00327 
00328 Arguments:
00329 
00330     TargetPtr - Pointer to target graphics buffer.
00331 
00332     SourcePtr - Pointer to source graphics buffer.
00333 
00334     Length - Fill length.
00335 
00336 Return Value:
00337 
00338     none.
00339 
00340 --*/
00341 {
00342     PCHAR tmpSrc;
00343     PCHAR tmpTrg;
00344     ULONG tmpLen;
00345 
00346     <span class="comment">//</span>
00347     <span class="comment">// Set copy mode of graphics register</span>
00348     <span class="comment">//</span>
00349 
00350     <a class="code" href="../../d6/d2/port_8c.html#a2">SetGRAMCopyMode</a>(DeviceExtension);
00351 
00352     <span class="keywordflow">if</span> ((<a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)(SourcePtr + Length - FrameBufPtr) &gt;= DeviceExtension-&gt;EmulateInfo.LimitGRAM ||
00353         (<a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)(TargetPtr + Length - FrameBufPtr) &gt;= DeviceExtension-&gt;EmulateInfo.LimitGRAM    ) {
00354         <span class="keywordflow">if</span> (SourcePtr &gt; TargetPtr) {
00355             <a class="code" href="../../d7/d8/fsvga_8h.html#a43">memcpyGRAMOver</a>(TargetPtr,SourcePtr,Length,FrameBufPtr,DeviceExtension);
00356         }
00357         <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((ULONG)(TargetPtr - SourcePtr) &gt;= Length) {
00358             <a class="code" href="../../d7/d8/fsvga_8h.html#a43">memcpyGRAMOver</a>(TargetPtr,SourcePtr,Length,FrameBufPtr,DeviceExtension);
00359         }
00360         <span class="keywordflow">else</span> {
00361             <span class="keywordflow">if</span> ((<a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)(SourcePtr + Length - FrameBufPtr) &gt;= DeviceExtension-&gt;EmulateInfo.LimitGRAM) {
00362                 tmpLen = SourcePtr + Length - FrameBufPtr - DeviceExtension-&gt;EmulateInfo.LimitGRAM;
00363                 tmpTrg = TargetPtr + Length - tmpLen - DeviceExtension-&gt;EmulateInfo.LimitGRAM;
00364                 <a class="code" href="../../d7/d8/fsvga_8h.html#a42">memcpyGRAM</a>(tmpTrg, FrameBufPtr, tmpLen);
00365                 Length -= tmpLen;
00366             }
00367             <span class="keywordflow">if</span> ((<a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)(TargetPtr + Length - FrameBufPtr) &gt;= DeviceExtension-&gt;EmulateInfo.LimitGRAM) {
00368                 tmpLen = TargetPtr + Length - FrameBufPtr - DeviceExtension-&gt;EmulateInfo.LimitGRAM;
00369                 tmpSrc = SourcePtr + Length - tmpLen;
00370                 <a class="code" href="../../d7/d8/fsvga_8h.html#a42">memcpyGRAM</a>(FrameBufPtr, tmpSrc, tmpLen);
00371                 Length -= tmpLen;
00372             }
00373             <span class="keywordflow">if</span> (Length) {
00374                 <a class="code" href="../../d7/d8/fsvga_8h.html#a42">memcpyGRAM</a>(TargetPtr, SourcePtr, Length);
00375             }
00376         }
00377     }
00378     <span class="keywordflow">else</span> {
00379         <a class="code" href="../../d7/d8/fsvga_8h.html#a42">memcpyGRAM</a>(TargetPtr, SourcePtr, Length);
00380     }
00381 
00382     <a class="code" href="../../d6/d2/port_8c.html#a1">SetGRAMWriteMode</a>(DeviceExtension);
00383 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a41" doxytag="fsvga.h::NextGRAMRow" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PUCHAR NextGRAMRow           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">PUCHAR&nbsp;</td>
          <td class="mdname" nowrap> <em>BufPtr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d8/d3/struct__DEVICE__EXTENSION.html">PDEVICE_EXTENSION</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>DeviceExtension</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d1/drawscrn_8c-source.html#l00200">200</a> of file <a class="el" href="../../d3/d1/drawscrn_8c-source.html">drawscrn.c</a>.
<p>
References <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00093">_EMULATE_BUFFER_INFORMATION::BytePerLine</a>, <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00143">_DEVICE_EXTENSION::CurrentMode</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00153">_DEVICE_EXTENSION::EmulateInfo</a>, and <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00095">_EMULATE_BUFFER_INFORMATION::LimitGRAM</a>.
<p>
Referenced by <a class="el" href="../../d3/d1/drawscrn_8c-source.html#l00702">FsgInvertCursor()</a>, <a class="el" href="../../d3/d1/drawscrn_8c-source.html#l00609">FsgReverseMousePointer()</a>, <a class="el" href="../../d3/d1/drawscrn_8c-source.html#l00813">FsgWriteToScreen()</a>, and <a class="el" href="../../d3/d1/drawscrn_8c-source.html#l00915">FsgWriteToScreenCommonLVB()</a>.
<p>
<pre class="fragment"><div>00207                    :
00208     This Routine add next row a graphics buffer address.
00209 
00210 Arguments:
00211 
00212     BufPtr - Pointer to graphics buffer.
00213 
00214 Return Value:
00215 
00216     Returen to graphics buffer address.
00217 
00218 --*/
00219 
00220 {
00221     <span class="keywordflow">if</span> ((<a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)(BufPtr +
00222                 DeviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o52">EmulateInfo</a>.<a class="code" href="../../d1/d3/struct__EMULATE__BUFFER__INFORMATION.html#o3">BytePerLine</a> -
00223                 (PUCHAR)DeviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o50">CurrentMode</a>.VideoMemory.FrameBufferBase)
00224            &gt;= DeviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o52">EmulateInfo</a>.<a class="code" href="../../d1/d3/struct__EMULATE__BUFFER__INFORMATION.html#o5">LimitGRAM</a>)
00225         <span class="keywordflow">return</span> (BufPtr +
00226                 DeviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o52">EmulateInfo</a>.<a class="code" href="../../d1/d3/struct__EMULATE__BUFFER__INFORMATION.html#o3">BytePerLine</a> -
00227                 DeviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o52">EmulateInfo</a>.<a class="code" href="../../d1/d3/struct__EMULATE__BUFFER__INFORMATION.html#o5">LimitGRAM</a>);
00228     <span class="keywordflow">else</span>
00229         <span class="keywordflow">return</span> (BufPtr + DeviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o52">EmulateInfo</a>.<a class="code" href="../../d1/d3/struct__EMULATE__BUFFER__INFORMATION.html#o3">BytePerLine</a>);
00230 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a63" doxytag="fsvga.h::set_opaque_bkgnd_proc" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID set_opaque_bkgnd_proc           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d8/d3/struct__DEVICE__EXTENSION.html">PDEVICE_EXTENSION</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>deviceExtension</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>PUCHAR&nbsp;</td>
          <td class="mdname" nowrap> <em>FrameBuffer</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>WORD&nbsp;</td>
          <td class="mdname" nowrap> <em>Attributes</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d1/port_8c-source.html#l00186">186</a> of file <a class="el" href="../../d7/d1/port_8c-source.html">port.c</a>.
<p>
References <a class="el" href="../../d0/d7/halvprnt_8c-source.html#l00031">BYTE</a>, <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00102">_EMULATE_BUFFER_INFORMATION::ColorBg</a>, <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00101">_EMULATE_BUFFER_INFORMATION::ColorFg</a>, <a class="el" href="../../d7/d1/port_8c-source.html#l00257">ColorSetDirect()</a>, <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00153">_DEVICE_EXTENSION::EmulateInfo</a>, and <a class="el" href="../../d6/d8/ntrtlp_8h-source.html#l00183">LOBYTE</a>.
<p>
Referenced by <a class="el" href="../../d3/d1/drawscrn_8c-source.html#l00813">FsgWriteToScreen()</a>, and <a class="el" href="../../d3/d1/drawscrn_8c-source.html#l00915">FsgWriteToScreenCommonLVB()</a>.
<p>
<pre class="fragment"><div>00203 {
00204     <a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a> ColorFg = <a class="code" href="../../d5/d9/ntrtlp_8h.html#a4">LOBYTE</a>(Attributes) &amp; 0x0f;
00205     <a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a> ColorBg = (<a class="code" href="../../d5/d9/ntrtlp_8h.html#a4">LOBYTE</a>(Attributes) &amp; 0xf0) &gt;&gt; 4;
00206 
00207     <span class="keywordflow">if</span> (Attributes &amp; COMMON_LVB_REVERSE_VIDEO)
00208     {
00209         Attributes = ColorBg;
00210         ColorBg = ColorFg;
00211         ColorFg = (<a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a>)Attributes;
00212     }
00213 
00214     <span class="keywordflow">if</span> (deviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o52">EmulateInfo</a>.<a class="code" href="../../d1/d3/struct__EMULATE__BUFFER__INFORMATION.html#o7">ColorFg</a> == ColorFg &amp;&amp;
00215         deviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o52">EmulateInfo</a>.<a class="code" href="../../d1/d3/struct__EMULATE__BUFFER__INFORMATION.html#o8">ColorBg</a> == ColorBg)
00216         <span class="keywordflow">return</span>;
00217 
00218     deviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o52">EmulateInfo</a>.<a class="code" href="../../d1/d3/struct__EMULATE__BUFFER__INFORMATION.html#o7">ColorFg</a> = ColorFg;
00219     deviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o52">EmulateInfo</a>.<a class="code" href="../../d1/d3/struct__EMULATE__BUFFER__INFORMATION.html#o8">ColorBg</a> = ColorBg;
00220 
00221     <a class="code" href="../../d6/d2/port_8c.html#a6">ColorSetDirect</a>(deviceExtension, FrameBuffer, ColorFg, ColorBg);
00222 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a61" doxytag="fsvga.h::SetGRAMCopyMode" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID SetGRAMCopyMode           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d8/d3/struct__DEVICE__EXTENSION.html">PDEVICE_EXTENSION</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>deviceExtension</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d1/port_8c-source.html#l00121">121</a> of file <a class="el" href="../../d7/d1/port_8c-source.html">port.c</a>.
<p>
References <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00132">_DEVICE_EXTENSION::DeviceRegisters</a>, <a class="el" href="../../d2/d5/vga_8h-source.html#l00178">DR_SET</a>, <a class="el" href="../../d7/d8/fsvga_8h.html#a66a20">GRAPHAddressPort</a>, <a class="el" href="../../d2/d5/vga_8h-source.html#l00141">IND_COLOR_DONT_CARE</a>, <a class="el" href="../../d2/d5/vga_8h-source.html#l00125">IND_DATA_ROTATE</a>, <a class="el" href="../../d2/d5/vga_8h-source.html#l00127">IND_GRAPH_MODE</a>, <a class="el" href="../../d2/d5/vga_8h-source.html#l00191">M_COLOR_READ</a>, and <a class="el" href="../../d2/d5/vga_8h-source.html#l00187">M_LATCH_WRITE</a>.
<p>
Referenced by <a class="el" href="../../d3/d1/drawscrn_8c-source.html#l00314">MoveGRAM()</a>.
<p>
<pre class="fragment"><div>00127                    :
00128 
00129     This routine sets <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> copy mode of graphics <span class="keyword">register</span>.
00130 
00131 Arguments:
00132 
00133 Return Value:
00134 
00135 --*/
00136 
00137 {
00138     WRITE_PORT_USHORT(deviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o48">DeviceRegisters</a>[GRAPHAddressPort],
00139                       MAKEWORD(IND_GRAPH_MODE, M_LATCH_WRITE+M_COLOR_READ));
00140 
00141     <span class="comment">//</span>
00142     <span class="comment">// Set up to write data without interacting with the latches.</span>
00143     <span class="comment">//</span>
00144     WRITE_PORT_USHORT(deviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o48">DeviceRegisters</a>[GRAPHAddressPort],
00145                       MAKEWORD(IND_DATA_ROTATE, DR_SET));
00146 
00147     WRITE_PORT_USHORT(deviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o48">DeviceRegisters</a>[GRAPHAddressPort],
00148                       MAKEWORD(IND_COLOR_DONT_CARE, 0));
00149 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a62" doxytag="fsvga.h::SetGRAMInvertMode" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID SetGRAMInvertMode           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d8/d3/struct__DEVICE__EXTENSION.html">PDEVICE_EXTENSION</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>deviceExtension</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d1/port_8c-source.html#l00152">152</a> of file <a class="el" href="../../d7/d1/port_8c-source.html">port.c</a>.
<p>
References <a class="el" href="../../d2/d5/vga_8h-source.html#l00205">BIT_MASK_DEFAULT</a>, <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00132">_DEVICE_EXTENSION::DeviceRegisters</a>, <a class="el" href="../../d2/d5/vga_8h-source.html#l00181">DR_XOR</a>, <a class="el" href="../../d7/d8/fsvga_8h.html#a66a20">GRAPHAddressPort</a>, <a class="el" href="../../d2/d5/vga_8h-source.html#l00129">IND_BIT_MASK</a>, <a class="el" href="../../d2/d5/vga_8h-source.html#l00141">IND_COLOR_DONT_CARE</a>, <a class="el" href="../../d2/d5/vga_8h-source.html#l00125">IND_DATA_ROTATE</a>, <a class="el" href="../../d2/d5/vga_8h-source.html#l00127">IND_GRAPH_MODE</a>, <a class="el" href="../../d2/d5/vga_8h-source.html#l00140">IND_SET_RESET</a>, <a class="el" href="../../d2/d5/vga_8h-source.html#l00189">M_AND_WRITE</a>, and <a class="el" href="../../d2/d5/vga_8h-source.html#l00191">M_COLOR_READ</a>.
<p>
Referenced by <a class="el" href="../../d3/d1/drawscrn_8c-source.html#l00702">FsgInvertCursor()</a>, and <a class="el" href="../../d3/d1/drawscrn_8c-source.html#l00609">FsgReverseMousePointer()</a>.
<p>
<pre class="fragment"><div>00158                    :
00159 
00160     This routine sets <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> invert mode of graphics <span class="keyword">register</span>.
00161 
00162 Arguments:
00163 
00164 Return Value:
00165 
00166 --*/
00167 
00168 {
00169     WRITE_PORT_USHORT(deviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o48">DeviceRegisters</a>[GRAPHAddressPort],
00170                       MAKEWORD(IND_GRAPH_MODE, M_AND_WRITE+M_COLOR_READ));
00171 
00172     WRITE_PORT_USHORT(deviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o48">DeviceRegisters</a>[GRAPHAddressPort],
00173                       MAKEWORD(IND_DATA_ROTATE, DR_XOR));
00174 
00175     WRITE_PORT_USHORT(deviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o48">DeviceRegisters</a>[GRAPHAddressPort],
00176                       MAKEWORD(IND_BIT_MASK, BIT_MASK_DEFAULT));
00177 
00178     WRITE_PORT_USHORT(deviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o48">DeviceRegisters</a>[GRAPHAddressPort],
00179                       MAKEWORD(IND_COLOR_DONT_CARE, 0));
00180 
00181     WRITE_PORT_USHORT(deviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o48">DeviceRegisters</a>[GRAPHAddressPort],
00182                       MAKEWORD(IND_SET_RESET, 0xff));
00183 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a60" doxytag="fsvga.h::SetGRAMWriteMode" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID SetGRAMWriteMode           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d8/d3/struct__DEVICE__EXTENSION.html">PDEVICE_EXTENSION</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>deviceExtension</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d1/port_8c-source.html#l00081">81</a> of file <a class="el" href="../../d7/d1/port_8c-source.html">port.c</a>.
<p>
References <a class="el" href="../../d2/d5/vga_8h-source.html#l00205">BIT_MASK_DEFAULT</a>, <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00132">_DEVICE_EXTENSION::DeviceRegisters</a>, <a class="el" href="../../d2/d5/vga_8h-source.html#l00178">DR_SET</a>, <a class="el" href="../../d2/d5/vga_8h-source.html#l00171">GRAPH_ADDR_MASK</a>, <a class="el" href="../../d7/d8/fsvga_8h.html#a66a20">GRAPHAddressPort</a>, <a class="el" href="../../d2/d5/vga_8h-source.html#l00129">IND_BIT_MASK</a>, <a class="el" href="../../d2/d5/vga_8h-source.html#l00125">IND_DATA_ROTATE</a>, <a class="el" href="../../d2/d5/vga_8h-source.html#l00127">IND_GRAPH_MODE</a>, <a class="el" href="../../d2/d5/vga_8h-source.html#l00131">IND_MAP_MASK</a>, <a class="el" href="../../d2/d5/vga_8h-source.html#l00190">M_DATA_READ</a>, <a class="el" href="../../d2/d5/vga_8h-source.html#l00186">M_PROC_WRITE</a>, and <a class="el" href="../../d7/d8/fsvga_8h.html#a66a21">SEQUAddressPort</a>.
<p>
Referenced by <a class="el" href="../../d3/d1/drawscrn_8c-source.html#l00702">FsgInvertCursor()</a>, <a class="el" href="../../d3/d1/drawscrn_8c-source.html#l00609">FsgReverseMousePointer()</a>, <a class="el" href="../../d3/d1/drawscrn_8c-source.html#l00387">FsgVgaInitializeHWFlags()</a>, <a class="el" href="../../d3/d1/drawscrn_8c-source.html#l00915">FsgWriteToScreenCommonLVB()</a>, and <a class="el" href="../../d3/d1/drawscrn_8c-source.html#l00314">MoveGRAM()</a>.
<p>
<pre class="fragment"><div>00087                    :
00088 
00089     This routine sets <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> write mode of graphics <span class="keyword">register</span>.
00090 
00091 Arguments:
00092 
00093 Return Value:
00094 
00095 --*/
00096 
00097 {
00098     WRITE_PORT_USHORT(deviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o48">DeviceRegisters</a>[GRAPHAddressPort],
00099                       MAKEWORD(IND_GRAPH_MODE, M_PROC_WRITE+M_DATA_READ));
00100 
00101     <span class="comment">//</span>
00102     <span class="comment">// Set up to write data without interacting with the latches.</span>
00103     <span class="comment">//</span>
00104     WRITE_PORT_USHORT(deviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o48">DeviceRegisters</a>[GRAPHAddressPort],
00105                       MAKEWORD(IND_DATA_ROTATE, DR_SET));
00106 
00107     <span class="comment">//</span>
00108     <span class="comment">// Enable all the available EGA planes.</span>
00109     <span class="comment">//</span>
00110     WRITE_PORT_USHORT(deviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o48">DeviceRegisters</a>[SEQUAddressPort],
00111                       MAKEWORD(IND_MAP_MASK, GRAPH_ADDR_MASK));
00112     <span class="comment">//</span>
00113     <span class="comment">// Use all pixel positions.</span>
00114     <span class="comment">//</span>
00115     WRITE_PORT_USHORT(deviceExtension-&gt;<a class="code" href="../../d8/d3/struct__DEVICE__EXTENSION.html#o48">DeviceRegisters</a>[GRAPHAddressPort],
00116                       MAKEWORD(IND_BIT_MASK, BIT_MASK_DEFAULT));
00117 
00118 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a58" doxytag="fsvga.h::TranslateOutputToOem" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS TranslateOutputToOem           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">OUT PCHAR_IMAGE_INFO&nbsp;</td>
          <td class="mdname" nowrap> <em>OutputBuffer</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PCHAR_IMAGE_INFO&nbsp;</td>
          <td class="mdname" nowrap> <em>InputBuffer</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Length</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d9/w32_2ntcon_2fullscr_2vga_2misc_8c-source.html#l00086">86</a> of file <a class="el" href="../../d4/d9/w32_2ntcon_2fullscr_2vga_2misc_8c-source.html">w32/ntcon/fullscr/vga/misc.c</a>.
<p>
References <a class="el" href="../../d2/d0/bench_8c-source.html#l00050">CHAR</a>, and <a class="el" href="../../d5/d9/w32_2ntcon_2server_2misc_8c-source.html#l01508">ConvertOutputToOem()</a>.
<p>
Referenced by <a class="el" href="../../d7/d7/fsvga_8c-source.html#l01429">FsVgaWriteToFrameBuffer()</a>, and <a class="el" href="../../d3/d7/directio_8c-source.html#l01207">SrvReadConsoleOutput()</a>.
<p>
<pre class="fragment"><div>00091 {
00092     <a class="code" href="../../d1/d1/bench_8c.html#a16">CHAR</a> AsciiDbcs[2];
00093     ULONG NumBytes;
00094 
00095     <span class="keywordflow">while</span> (Length--)
00096     {
00097         <span class="keywordflow">if</span> (InputBuffer-&gt;CharInfo.Attributes &amp; COMMON_LVB_LEADING_BYTE)
00098         {
00099             <span class="keywordflow">if</span> (Length &gt;= 2)    <span class="comment">// Safe DBCS in buffer ?</span>
00100             {
00101                 Length--;
00102                 NumBytes = <span class="keyword">sizeof</span>(AsciiDbcs);
00103                 NumBytes = <a class="code" href="../../d4/d0/w32_2ntcon_2server_2misc_8c.html#a41">ConvertOutputToOem</a>(&amp;InputBuffer-&gt;CharInfo.Char.UnicodeChar,
00104                                               1,
00105                                               &amp;AsciiDbcs[0],
00106                                               NumBytes);
00107                 OutputBuffer-&gt;CharInfo.Char.AsciiChar = AsciiDbcs[0];
00108                 OutputBuffer-&gt;CharInfo.Attributes = InputBuffer-&gt;CharInfo.Attributes;
00109                 OutputBuffer++;
00110                 InputBuffer++;
00111                 OutputBuffer-&gt;CharInfo.Char.AsciiChar = AsciiDbcs[1];
00112                 OutputBuffer-&gt;CharInfo.Attributes = InputBuffer-&gt;CharInfo.Attributes;
00113                 OutputBuffer++;
00114                 InputBuffer++;
00115             }
00116             <span class="keywordflow">else</span>
00117             {
00118                 OutputBuffer-&gt;CharInfo.Char.AsciiChar = <span class="charliteral">' '</span>;
00119                 OutputBuffer-&gt;CharInfo.Attributes = InputBuffer-&gt;CharInfo.Attributes &amp; ~COMMON_LVB_SBCSDBCS;
00120                 OutputBuffer++;
00121                 InputBuffer++;
00122             }
00123         }
00124         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (! (InputBuffer-&gt;CharInfo.Attributes &amp; COMMON_LVB_SBCSDBCS))
00125         {
00126             <a class="code" href="../../d4/d0/w32_2ntcon_2server_2misc_8c.html#a41">ConvertOutputToOem</a>(&amp;InputBuffer-&gt;CharInfo.Char.UnicodeChar,
00127                                1,
00128                                &amp;OutputBuffer-&gt;CharInfo.Char.AsciiChar,
00129                                1);
00130             OutputBuffer-&gt;CharInfo.Attributes = InputBuffer-&gt;CharInfo.Attributes;
00131             OutputBuffer++;
00132             InputBuffer++;
00133         }
00134     }
00135 
00136     <span class="keywordflow">return</span> STATUS_SUCCESS;
00137 }
</div></pre>    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:43:48 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
