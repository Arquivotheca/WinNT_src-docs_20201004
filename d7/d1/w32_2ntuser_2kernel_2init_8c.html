<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: w32/ntuser/kernel/init.c File Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>init.c File Reference</h1><code>#include "<a class="el" href="../../d1/d3/w32_2ntuser_2kernel_2precomp_8h-source.html">precomp.h</a>"</code><br>

<p>
<a href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html">Go to the source code of this file.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a0">OEMRESOURCE</a>&nbsp;&nbsp;&nbsp;1</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a1">GRAY_STRLEN</a>&nbsp;&nbsp;&nbsp;40</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a2">MAX_TIME_OUT</a>&nbsp;&nbsp;&nbsp;(10*60*4)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a3">CCLASSES</a>&nbsp;&nbsp;&nbsp;8</td></tr>

<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a21">Win32kNtUserCleanup</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a22">DriverEntry</a> (IN <a class="el" href="../../d4/d9/struct__DRIVER__OBJECT.html">PDRIVER_OBJECT</a> DriverObject, IN PUNICODE_STRING RegistryPath)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a23">Win32UserInitialize</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a24">FreeSMS</a> (<a class="el" href="../../d4/d1/userk_8h.html#a871">PSMS</a> psms)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a25">FreeImeHotKeys</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a26">Win32kNtUserCleanup</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a27">DestroyRegion</a> (HRGN *prgn)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a28">DestroyBrush</a> (HBRUSH *pbr)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a29">DestroyBitmap</a> (HBITMAP *pbm)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a30">DestroyDC</a> (HDC *phdc)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a31">DestroyFont</a> (HFONT *pfnt)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a32">CleanupGDI</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a33">DestroyHandleTableObjects</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a34">Win32KDriverUnload</a> (IN <a class="el" href="../../d4/d9/struct__DRIVER__OBJECT.html">PDRIVER_OBJECT</a> DriverObject)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>int&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a35">xxxAddFontResourceW</a> (LPWSTR lpFile, FLONG flags, DESIGNVECTOR *pdv)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a36">LW_DriversInit</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a37">LoadCPUserPreferences</a> (PUNICODE_STRING pProfileUserName)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a38">LW_LoadProfileInitData</a> (PUNICODE_STRING pProfileUserName)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a39">LW_LoadResources</a> (PUNICODE_STRING pProfileUserName)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a40">xxxInitWindowStation</a> (<a class="el" href="../../d4/d9/structtagWINDOWSTATION.html">PWINDOWSTATION</a> pwinsta)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a41">CreateTerminalInput</a> (<a class="el" href="../../d1/d8/structtagTERMINAL.html">PTERMINAL</a> pTerm)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a42">LW_LoadSomeStrings</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a43">CI_GetClrVal</a> (LPWSTR p)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a44">xxxODI_ColorInit</a> (PUNICODE_STRING pProfileUserName)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a45">_LoadCursorsAndIcons</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a46">UnloadCursorsAndIcons</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a47">xxxUpdateSystemCursorsFromRegistry</a> (PUNICODE_STRING pProfileUserName)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a48">xxxUpdateSystemIconsFromRegistry</a> (PUNICODE_STRING pProfileUserName)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a49">LW_BrushInit</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a50">LW_RegisterWindows</a> (BOOL fSystem)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a51">vCheckMMInstance</a> (LPWSTR pchSrch, DESIGNVECTOR *pdv)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a52">bEnumerateRegistryFonts</a> (BOOL bPermanent)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a53">CloseFNTCache</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a54">xxxLW_LoadFonts</a> (BOOL bRemote)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a55">FinalUserInit</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a56">InitializeClientPfnArrays</a> (CONST <a class="el" href="../../d0/d5/struct__PFNCLIENT.html">PFNCLIENT</a> *ppfnClientA, CONST <a class="el" href="../../d0/d5/struct__PFNCLIENT.html">PFNCLIENT</a> *ppfnClientW, CONST <a class="el" href="../../d1/d5/struct__PFNCLIENTWORKER.html">PFNCLIENTWORKER</a> *ppfnClientWorker, HANDLE hModUser)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a57">GetKbdLangSwitch</a> (PUNICODE_STRING pProfileUserName)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a58">xxxUpdatePerUserSystemParameters</a> (HANDLE hToken, BOOL bUserLoggedOn)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a59">InitAnsiOem</a> (PCHAR pOemToAnsi, PCHAR pAnsiToOem)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a60">RegisterLPK</a> (<a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> dwLpkEntryPoints)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a61">EnforceColorDependentSettings</a> (void)</td></tr>

<tr><td colspan=2><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>PVOID *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a4">apObjects</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d4/d8/struct__KWAIT__BLOCK.html">PKWAIT_BLOCK</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a5">gWaitBlockArray</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>PVOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a6">UserAtomTableHandle</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d3/d8/struct__KTIMER.html">PKTIMER</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a7">gptmrWD</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>UNICODE_STRING *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a8">gpastrSetupExe</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>WCHAR *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a9">glpSetupPrograms</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d4/d4/struct__HANDLEPAGE.html">PHANDLEPAGE</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a10">gpHandlePages</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d4/d9/structtagBWL.html">PBWL</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a11">pbwlCache</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a12">bPermanentFontsLoaded</a> = FALSE</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>int&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a13">LastFontLoaded</a> = -1</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a14">W32ProcessSize</a> = sizeof(<a class="el" href="../../d7/d3/structtagPROCESSINFO.html">PROCESSINFO</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a15">W32ProcessTag</a> = TAG_PROCESSINFO</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a16">W32ThreadSize</a> = sizeof(<a class="el" href="../../d2/d8/structtagTHREADINFO.html">THREADINFO</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a17">W32ThreadTag</a> = TAG_THREADINFO</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d6/d9/struct__FAST__MUTEX.html">PFAST_MUTEX</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a18">gpW32FastMutex</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d1/d8/struct__PAGED__LOOKASIDE__LIST.html">PPAGED_LOOKASIDE_LIST</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a19">SMSLookaside</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d1/d8/struct__PAGED__LOOKASIDE__LIST.html">PPAGED_LOOKASIDE_LIST</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a20">QEntryLookaside</a></td></tr>

</table>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="a3" doxytag="w32/ntuser/kernel/init.c::CCLASSES" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define CCLASSES&nbsp;&nbsp;&nbsp;8          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l01863">LW_RegisterWindows()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="w32/ntuser/kernel/init.c::GRAY_STRLEN" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define GRAY_STRLEN&nbsp;&nbsp;&nbsp;40          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l00051">51</a> of file <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html">w32/ntuser/kernel/init.c</a>.
<p>
Referenced by <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l02254">FinalUserInit()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a2" doxytag="w32/ntuser/kernel/init.c::MAX_TIME_OUT" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define MAX_TIME_OUT&nbsp;&nbsp;&nbsp;(10*60*4)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l00095">95</a> of file <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html">w32/ntuser/kernel/init.c</a>.
<p>
Referenced by <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l02184">xxxLW_LoadFonts()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a0" doxytag="w32/ntuser/kernel/init.c::OEMRESOURCE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define OEMRESOURCE&nbsp;&nbsp;&nbsp;1          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l00014">14</a> of file <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html">w32/ntuser/kernel/init.c</a>.    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a45" doxytag="w32/ntuser/kernel/init.c::_LoadCursorsAndIcons" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID _LoadCursorsAndIcons           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l01568">1568</a> of file <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html">w32/ntuser/kernel/init.c</a>.
<p>
References <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02175">CURSORF_LRSHARED</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00392">gasyscur</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00411">gasysico</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00390">gpcurFirst</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00794">gpepCSRSS</a>, <a class="el" href="../../d2/d7/clglobal_8c-source.html#l00051">gpsi</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l07397">HH_LOADCURSORS</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l07404">HYDRA_HINT</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l02767">tagSYSCFGICO::Id</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00410">IS_PTR</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00367">Lock</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d2/d8/ps_8h-source.html#l00643">PsGetCurrentProcess</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01512">PtoH</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00411">PTR_TO_ID</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l02772">SYSICO</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00202">SYSMET</a>, and <a class="el" href="../../d2/d7/hal_8h.html#a212">VOID()</a>.
<p>
<pre class="fragment"><div>01569 {
01570     <a class="code" href="../../d6/d1/structtagCURSOR.html">PCURSOR</a> pcur;
01571     <span class="keywordtype">int</span>     i;
01572 
01573     pcur = <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a155">gpcurFirst</a>;
01574 
01575     <span class="comment">/*</span>
01576 <span class="comment">     * Only CSR can call this (and only once).</span>
01577 <span class="comment">     */</span>
01578     <span class="keywordflow">if</span> (<a class="code" href="../../d1/d9/ps_8h.html#a19">PsGetCurrentProcess</a>() != <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a299">gpepCSRSS</a>) {
01579         <span class="keywordflow">return</span>;
01580     }
01581 
01582     <a class="code" href="../../d4/d1/userk_8h.html#a773">HYDRA_HINT</a>(HH_LOADCURSORS);
01583 
01584     <span class="keywordflow">while</span> (pcur) {
01585 
01586         UserAssert(!<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a98">IS_PTR</a>(pcur-&gt;strName.Buffer));
01587 
01588         <span class="keywordflow">switch</span> (pcur-&gt;rt) {
01589         <span class="keywordflow">case</span> RT_ICON:
01590             UserAssert((LONG_PTR)pcur-&gt;strName.Buffer &gt;= OIC_FIRST_DEFAULT);
01591 
01592             UserAssert((LONG_PTR)pcur-&gt;strName.Buffer &lt;
01593                     OIC_FIRST_DEFAULT + COIC_CONFIGURABLE);
01594 
01595             i = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a99">PTR_TO_ID</a>(pcur-&gt;strName.Buffer) - OIC_FIRST_DEFAULT;
01596             pcur-&gt;strName.Buffer = (LPWSTR)<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a157">gasysico</a>[i].<a class="code" href="../../d9/d7/structtagSYSCFGICO.html#o0">Id</a>;
01597 
01598             <span class="keywordflow">if</span> (pcur-&gt;CURSORF_flags &amp; <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a536">CURSORF_LRSHARED</a>) {
01599                 UserAssert(gasysico[i].spcur == NULL);
01600                 <a class="code" href="../../d6/d0/usercli_8h.html#a41">Lock</a>(&amp;gasysico[i].spcur, pcur);
01601             } <span class="keywordflow">else</span> {
01602                 UserAssert(<a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;hIconSmWindows == NULL);
01603                 UserAssert((<span class="keywordtype">int</span>)pcur-&gt;cx == <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(CXSMICON));
01604                 <span class="comment">/*</span>
01605 <span class="comment">                 * The special small winlogo icon is not shared.</span>
01606 <span class="comment">                 */</span>
01607                 <a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;hIconSmWindows = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a448">PtoH</a>(pcur);
01608             }
01609             <span class="keywordflow">break</span>;
01610 
01611         <span class="keywordflow">case</span> RT_CURSOR:
01612             UserAssert((LONG_PTR)pcur-&gt;strName.Buffer &gt;= OCR_FIRST_DEFAULT);
01613 
01614             UserAssert((LONG_PTR)pcur-&gt;strName.Buffer &lt;
01615                     OCR_FIRST_DEFAULT + COCR_CONFIGURABLE);
01616 
01617             i = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a99">PTR_TO_ID</a>(pcur-&gt;strName.Buffer) - OCR_FIRST_DEFAULT;
01618             pcur-&gt;strName.Buffer = (LPWSTR)<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a156">gasyscur</a>[i].<a class="code" href="../../d9/d7/structtagSYSCFGICO.html#o0">Id</a>;
01619             <a class="code" href="../../d6/d0/usercli_8h.html#a41">Lock</a>(&amp;gasyscur[i].spcur ,pcur);
01620             <span class="keywordflow">break</span>;
01621 
01622         <span class="keywordflow">default</span>:
01623             UserAssert(FALSE);  <span class="comment">// should be nothing in the cache but these!</span>
01624         }
01625 
01626         pcur = pcur-&gt;pcurNext;
01627     }
01628 
01629     <span class="comment">/*</span>
01630 <span class="comment">     * copy special icon handles to global spots for later use.</span>
01631 <span class="comment">     */</span>
01632     <a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;hIcoWindows = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a448">PtoH</a>(<a class="code" href="../../d4/d1/userk_8h.html#a320">SYSICO</a>(WINLOGO));
01633 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a52" doxytag="w32/ntuser/kernel/init.c::bEnumerateRegistryFonts" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL bEnumerateRegistryFonts           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">BOOL&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>bPermanent</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l02036">2036</a> of file <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html">w32/ntuser/kernel/init.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l00056">bPermanentFontsLoaded</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d2/d6/w32_2ntuser_2kernel_2profile_8c-source.html#l00642">FastGetProfileKeysW()</a>, <a class="el" href="../../d2/d6/w32_2ntuser_2kernel_2profile_8c-source.html#l00806">FastGetProfileStringW()</a>, <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l00057">LastFontLoaded</a>, <a class="el" href="../../d4/d8/arcinst_8c-source.html#l00065">MAX_PATH</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l06845">PMAP_FONTS</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l06866">PMAP_WINLOGON</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l00058">PtiCurrent</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l06592">PUDF_FONTSARELOADED</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l06610">SET_PUDF</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l01704">ThreadLockPool</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l01710">ThreadUnlockAndFreePool</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l02001">vCheckMMInstance()</a>, and <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l01119">xxxAddFontResourceW()</a>.
<p>
Referenced by <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l02184">xxxLW_LoadFonts()</a>.
<p>
<pre class="fragment"><div>02038 {
02039     LPWSTR pchKeys;
02040     LPWSTR pchSrch;
02041     LPWSTR lpchT;
02042     <span class="keywordtype">int</span>    cchReal;
02043     <span class="keywordtype">int</span>    cFont;
02044     WCHAR  szFontFile[<a class="code" href="../../d3/d9/arcinst_8c.html#a6">MAX_PATH</a>];
02045     FLONG  flAFRW;
02046     <a class="code" href="../../d5/d1/struct__TL.html">TL</a>     tlPool;
02047     DESIGNVECTOR  dv;
02048 
02049     WCHAR  szPreloadFontFile[<a class="code" href="../../d3/d9/arcinst_8c.html#a6">MAX_PATH</a>];
02050 
02051     <span class="comment">/*</span>
02052 <span class="comment">     * if we are not just checking whether this is a registry font</span>
02053 <span class="comment">     */</span>
02054     flAFRW = (bPermanent ? AFRW_ADD_LOCAL_FONT : AFRW_ADD_REMOTE_FONT);
02055 
02056     cchReal = (<span class="keywordtype">int</span>)<a class="code" href="../../d4/d1/userk_8h.html#a2005">FastGetProfileKeysW</a>(NULL,
02057             PMAP_FONTS,
02058             TEXT(<span class="stringliteral">"vgasys.fnt"</span>),
02059             &amp;pchKeys
02060             );
02061 
02062 <span class="preprocessor">#if DBG</span>
02063 <span class="preprocessor"></span>    <span class="keywordflow">if</span> (cchReal == 0) {
02064         RIPMSG0(RIP_WARNING, <span class="stringliteral">"bEnumerateRegistryFonts: cchReal is 0"</span>);
02065     }
02066 <span class="preprocessor">#endif</span>
02067 <span class="preprocessor"></span>
02068     <span class="keywordflow">if</span> (!pchKeys)
02069         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
02070 
02071     <a class="code" href="../../d4/d1/userk_8h.html#a137">ThreadLockPool</a>(<a class="code" href="../../d4/d1/userk_8h.html#a9">PtiCurrent</a>(), pchKeys, &amp;tlPool);
02072 
02073     <span class="comment">/*</span>
02074 <span class="comment">     * If we got here first, we load the fonts until this preload font.</span>
02075 <span class="comment">     * Preload fonts will be used by Winlogon UI, then we need to make sure</span>
02076 <span class="comment">     * the font is available when Winlogon UI comes up.</span>
02077 <span class="comment">     */</span>
02078     <span class="keywordflow">if</span> (<a class="code" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a13">LastFontLoaded</a> == -1) {
02079         <a class="code" href="../../d4/d1/userk_8h.html#a2007">FastGetProfileStringW</a>(NULL, PMAP_WINLOGON,
02080                               TEXT(<span class="stringliteral">"PreloadFontFile"</span>),
02081                               TEXT(<span class="stringliteral">"Micross.ttf"</span>),
02082                               szPreloadFontFile,
02083                               MAX_PATH
02084                               );
02085         RIPMSG1(RIP_VERBOSE, <span class="stringliteral">"Winlogon preload font = %ws\n"</span>,szPreloadFontFile);
02086     }
02087 
02088     <span class="comment">/*</span>
02089 <span class="comment">     * Now we have all the key names in pchKeys.</span>
02090 <span class="comment">     */</span>
02091     <span class="keywordflow">if</span> (cchReal != 0) {
02092 
02093         cFont   = 0;
02094         pchSrch = pchKeys;
02095 
02096         <span class="keywordflow">do</span> {
02097             <span class="comment">// check to see whether this is MM(OpenType) instance</span>
02098             <a class="code" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a51">vCheckMMInstance</a>(pchSrch, &amp;dv);
02099 
02100             <span class="keywordflow">if</span> (<a class="code" href="../../d4/d1/userk_8h.html#a2007">FastGetProfileStringW</a>(NULL,
02101                                       PMAP_FONTS,
02102                                       pchSrch,
02103                                       TEXT(<span class="stringliteral">"vgasys.fon"</span>),
02104                                       szFontFile,
02105                                       (MAX_PATH - 5)
02106                                       )) {
02107 
02108                 <span class="comment">/*</span>
02109 <span class="comment">                 * If no extension, append ".FON"</span>
02110 <span class="comment">                 */</span>
02111                 <span class="keywordflow">for</span> (lpchT = szFontFile; *lpchT != TEXT(<span class="charliteral">'.'</span>); lpchT++) {
02112 
02113                     <span class="keywordflow">if</span> (*lpchT == 0) {
02114                         wcscat(szFontFile, TEXT(<span class="stringliteral">".FON"</span>));
02115                         <span class="keywordflow">break</span>;
02116                     }
02117                 }
02118 
02119                 <span class="keywordflow">if</span> ((cFont &gt; <a class="code" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a13">LastFontLoaded</a>) &amp;&amp; bPermanent) {
02120 
02121                     <span class="comment">/*</span>
02122 <span class="comment">                     * skip if we've already loaded this local font.</span>
02123 <span class="comment">                     */</span>
02124                     <a class="code" href="../../d4/d1/userk_8h.html#a1851">xxxAddFontResourceW</a>(szFontFile, flAFRW, dv.dvNumAxes ? &amp;dv : NULL);
02125                 }
02126 
02127                 <span class="keywordflow">if</span> (!bPermanent)
02128                     <a class="code" href="../../d4/d1/userk_8h.html#a1851">xxxAddFontResourceW</a>(szFontFile, flAFRW, dv.dvNumAxes ? &amp;dv : NULL);
02129 
02130                 <span class="keywordflow">if</span> ((<a class="code" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a13">LastFontLoaded</a> == -1) &amp;&amp;
02131                     <span class="comment">/*</span>
02132 <span class="comment">                     * Compare with the font file name from Registry.</span>
02133 <span class="comment">                     */</span>
02134                     (!_wcsnicmp(szFontFile, szPreloadFontFile, wcslen(szPreloadFontFile))) &amp;&amp;
02135                     (bPermanent)) {
02136 
02137                     <span class="comment">/*</span>
02138 <span class="comment">                     * On the first time through only load up until</span>
02139 <span class="comment">                     * ms sans serif for winlogon to use.       Later we</span>
02140 <span class="comment">                     * will spawn off a thread which loads the remaining</span>
02141 <span class="comment">                     * fonts in the background.</span>
02142 <span class="comment">                     */</span>
02143                     <a class="code" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a13">LastFontLoaded</a> = cFont;
02144 
02145                     <a class="code" href="../../d4/d1/userk_8h.html#a139">ThreadUnlockAndFreePool</a>(<a class="code" href="../../d4/d1/userk_8h.html#a9">PtiCurrent</a>(), &amp;tlPool);
02146                     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
02147                 }
02148             }
02149 
02150             <span class="comment">/*</span>
02151 <span class="comment">             * Skip to the next key.</span>
02152 <span class="comment">             */</span>
02153             <span class="keywordflow">while</span> (*pchSrch++);
02154 
02155             cFont += 1;
02156 
02157         } <span class="keywordflow">while</span> (pchSrch &lt; ((LPWSTR)pchKeys + cchReal));
02158     }
02159 
02160     <span class="comment">/*</span>
02161 <span class="comment">     * signal that all the permanent fonts have been loaded</span>
02162 <span class="comment">     */</span>
02163     <a class="code" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a12">bPermanentFontsLoaded</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
02164 
02165     <a class="code" href="../../d4/d1/userk_8h.html#a139">ThreadUnlockAndFreePool</a>(<a class="code" href="../../d4/d1/userk_8h.html#a9">PtiCurrent</a>(), &amp;tlPool);
02166 
02167     <span class="keywordflow">if</span> (!bPermanent)
02168         <a class="code" href="../../d4/d1/userk_8h.html#a659">SET_PUDF</a>(PUDF_FONTSARELOADED);
02169 
02170     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
02171 
02172 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a43" doxytag="w32/ntuser/kernel/init.c::CI_GetClrVal" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> CI_GetClrVal           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">LPWSTR&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>p</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l01456">1456</a> of file <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html">w32/ntuser/kernel/init.c</a>.
<p>
References <a class="el" href="../../d0/d7/halvprnt_8c-source.html#l00031">BYTE</a>, and <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>.
<p>
Referenced by <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l01508">xxxODI_ColorInit()</a>.
<p>
<pre class="fragment"><div>01458 {
01459     LPBYTE pl;
01460     <a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a>   val;
01461     <span class="keywordtype">int</span>    i;
01462     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>  clrval;
01463 
01464     <span class="comment">/*</span>
01465 <span class="comment">     * Initialize the pointer to the LONG return value.  Set to MSB.</span>
01466 <span class="comment">     */</span>
01467     pl = (LPBYTE)&amp;clrval;
01468 
01469     <span class="comment">/*</span>
01470 <span class="comment">     * Get three goups of numbers seprated by non-numeric characters.</span>
01471 <span class="comment">     */</span>
01472     <span class="keywordflow">for</span> (i = 0; i &lt; 3; i++) {
01473 
01474         <span class="comment">/*</span>
01475 <span class="comment">         * Skip over any non-numeric characters.</span>
01476 <span class="comment">         */</span>
01477         <span class="keywordflow">while</span> (!(*p &gt;= TEXT(<span class="charliteral">'0'</span>) &amp;&amp; *p &lt;= TEXT(<span class="charliteral">'9'</span>)))
01478             p++;
01479 
01480         <span class="comment">/*</span>
01481 <span class="comment">         * Get the next series of digits.</span>
01482 <span class="comment">         */</span>
01483         val = 0;
01484         <span class="keywordflow">while</span> (*p &gt;= TEXT(<span class="charliteral">'0'</span>) &amp;&amp; *p &lt;= TEXT(<span class="charliteral">'9'</span>))
01485             val = (<a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a>)((<span class="keywordtype">int</span>)val*10 + (<span class="keywordtype">int</span>)*p++ - <span class="charliteral">'0'</span>);
01486 
01487         <span class="comment">/*</span>
01488 <span class="comment">         * HACK! Store the group in the LONG return value.</span>
01489 <span class="comment">         */</span>
01490         *pl++ = val;
01491     }
01492 
01493     <span class="comment">/*</span>
01494 <span class="comment">     * Force the MSB to zero for GDI.</span>
01495 <span class="comment">     */</span>
01496     *pl = 0;
01497 
01498     <span class="keywordflow">return</span> clrval;
01499 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a32" doxytag="w32/ntuser/kernel/init.c::CleanupGDI" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID CleanupGDI           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l00565">565</a> of file <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html">w32/ntuser/kernel/init.c</a>.
<p>
References <a class="el" href="../../d9/d2/dc_8c-source.html#l01596">DelayedDestroyCacheDC()</a>, <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l00528">DestroyBitmap()</a>, <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l00518">DestroyBrush()</a>, <a class="el" href="../../d5/d7/createw_8c-source.html#l02923">DestroyCacheDCEntries()</a>, <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l00538">DestroyDC()</a>, <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l00548">DestroyFont()</a>, <a class="el" href="../../d2/d4/multimon_8c-source.html#l00249">DestroyMonitor()</a>, <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l00508">DestroyRegion()</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00119">gfade</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00298">ghbmBits</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00299">ghbmCaption</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00025">ghbmWallpaper</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l03362">ghbrBlack</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00296">ghbrHungApp</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l03361">ghbrWhite</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00493">ghdcMem</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00494">ghdcMem2</a>, <a class="el" href="../../d2/d7/clglobal_8c-source.html#l00103">ghFontSys</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00327">ghIconFont</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00307">ghMenuFont</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00308">ghMenuFontDef</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00026">ghpalWallpaper</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00499">ghrgnGDC</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00489">ghrgnInv0</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00490">ghrgnInv1</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00491">ghrgnInv2</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00487">ghrgnInvalid</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00482">ghrgnInvalidSum</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00504">ghrgnSCR</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00512">ghrgnScrl1</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00513">ghrgnScrl2</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00516">ghrgnScrlDst</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00515">ghrgnScrlSrc</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00517">ghrgnScrlValid</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00514">ghrgnScrlVis</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00505">ghrgnSPB1</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00506">ghrgnSPB2</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00511">ghrgnSW</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00484">ghrgnSWP1</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00485">ghrgnValid</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00486">ghrgnValidSum</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00483">ghrgnVisNew</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00303">ghSmCaptionFont</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00326">ghStatusFont</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00464">gpDispInfo</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00066">gpMonitorCached</a>, <a class="el" href="../../d2/d7/clglobal_8c-source.html#l00051">gpsi</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02104">tagDISPLAYINFO::hbmGray</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l06644">tagFADE::hdc</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02100">tagDISPLAYINFO::hdcBits</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02103">tagDISPLAYINFO::hdcGray</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02099">tagDISPLAYINFO::hdcScreen</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02094">tagDISPLAYINFO::hDev</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02119">tagDISPLAYINFO::hrgnScreen</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l02197">tagDISPLAYINFO::pdceFirst</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02095">tagDISPLAYINFO::pmdev</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l02203">tagDISPLAYINFO::pMonitorFirst</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02067">tagMONITOR::pMonitorNext</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l00058">PtiCurrent</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l00236">SYSHBRUSH</a>, and <a class="el" href="../../d2/d7/hal_8h.html#a212">VOID()</a>.
<p>
Referenced by <a class="el" href="../../d7/d7/ntinput_8c-source.html#l02087">CleanupResources()</a>.
<p>
<pre class="fragment"><div>00567 {
00568     <span class="keywordtype">int</span> i;
00569 
00570     <span class="comment">/*</span>
00571 <span class="comment">     * Free gpDispInfo stuff</span>
00572 <span class="comment">     */</span>
00573     <a class="code" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a30">DestroyDC</a>(&amp;<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a179">gpDispInfo</a>-&gt;<a class="code" href="../../d9/d3/structtagDISPLAYINFO.html#o3">hdcScreen</a>);
00574     <a class="code" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a30">DestroyDC</a>(&amp;<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a179">gpDispInfo</a>-&gt;<a class="code" href="../../d9/d3/structtagDISPLAYINFO.html#o4">hdcBits</a>);
00575     <a class="code" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a30">DestroyDC</a>(&amp;<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a179">gpDispInfo</a>-&gt;<a class="code" href="../../d9/d3/structtagDISPLAYINFO.html#o5">hdcGray</a>);
00576     <a class="code" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a30">DestroyDC</a>(&amp;ghdcMem);
00577     <a class="code" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a30">DestroyDC</a>(&amp;ghdcMem2);
00578     <a class="code" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a30">DestroyDC</a>(&amp;<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a40">gfade</a>.<a class="code" href="../../d0/d5/structtagFADE.html#o1">hdc</a>);
00579 
00580     <span class="comment">/*</span>
00581 <span class="comment">     * Free the cache DC stuff before the GRE cleanup.</span>
00582 <span class="comment">     * Also notice that we call DelayedDestroyCacheDC which</span>
00583 <span class="comment">     * we usualy call from DestroyProcessInfo. We do it</span>
00584 <span class="comment">     * here because this is the last WIN32 thread.</span>
00585 <span class="comment">     */</span>
00586     <a class="code" href="../../d4/d1/userk_8h.html#a1553">DestroyCacheDCEntries</a>(<a class="code" href="../../d4/d1/userk_8h.html#a9">PtiCurrent</a>());
00587     <a class="code" href="../../d4/d1/userk_8h.html#a1553">DestroyCacheDCEntries</a>(NULL);
00588     <a class="code" href="../../d4/d1/userk_8h.html#a1705">DelayedDestroyCacheDC</a>();
00589 
00590     UserAssert(<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a179">gpDispInfo</a>-&gt;<a class="code" href="../../d9/d3/structtagDISPLAYINFO.html#o9">pdceFirst</a> == NULL);
00591 
00592     <span class="comment">/*</span>
00593 <span class="comment">     * Free bitmaps</span>
00594 <span class="comment">     */</span>
00595     <a class="code" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a29">DestroyBitmap</a>(&amp;<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a179">gpDispInfo</a>-&gt;<a class="code" href="../../d9/d3/structtagDISPLAYINFO.html#o6">hbmGray</a>);
00596     <a class="code" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a29">DestroyBitmap</a>(&amp;ghbmBits);
00597     <a class="code" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a29">DestroyBitmap</a>(&amp;ghbmCaption);
00598 
00599     <span class="comment">/*</span>
00600 <span class="comment">     * Cleanup brushes</span>
00601 <span class="comment">     */</span>
00602     <a class="code" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a28">DestroyBrush</a>(&amp;ghbrHungApp);
00603     <a class="code" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a28">DestroyBrush</a>(&amp;<a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;hbrGray);
00604     <a class="code" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a28">DestroyBrush</a>(&amp;ghbrWhite);
00605     <a class="code" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a28">DestroyBrush</a>(&amp;ghbrBlack);
00606 
00607     <span class="keywordflow">for</span> (i = 0; i &lt; COLOR_MAX; i++) {
00608         <a class="code" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a28">DestroyBrush</a>(&amp;(<a class="code" href="../../d1/d0/inc_2user_8h.html#a15">SYSHBRUSH</a>(i)));
00609     }
00610 
00611     <span class="comment">/*</span>
00612 <span class="comment">     * Cleanup regions</span>
00613 <span class="comment">     */</span>
00614     <a class="code" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a27">DestroyRegion</a>(&amp;<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a179">gpDispInfo</a>-&gt;<a class="code" href="../../d9/d3/structtagDISPLAYINFO.html#o15">hrgnScreen</a>);
00615     <a class="code" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a27">DestroyRegion</a>(&amp;ghrgnInvalidSum);
00616     <a class="code" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a27">DestroyRegion</a>(&amp;ghrgnVisNew);
00617     <a class="code" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a27">DestroyRegion</a>(&amp;ghrgnSWP1);
00618     <a class="code" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a27">DestroyRegion</a>(&amp;ghrgnValid);
00619     <a class="code" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a27">DestroyRegion</a>(&amp;ghrgnValidSum);
00620     <a class="code" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a27">DestroyRegion</a>(&amp;ghrgnInvalid);
00621     <a class="code" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a27">DestroyRegion</a>(&amp;ghrgnInv0);
00622     <a class="code" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a27">DestroyRegion</a>(&amp;ghrgnInv1);
00623     <a class="code" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a27">DestroyRegion</a>(&amp;ghrgnInv2);
00624     <a class="code" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a27">DestroyRegion</a>(&amp;ghrgnGDC);
00625     <a class="code" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a27">DestroyRegion</a>(&amp;ghrgnSCR);
00626     <a class="code" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a27">DestroyRegion</a>(&amp;ghrgnSPB1);
00627     <a class="code" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a27">DestroyRegion</a>(&amp;ghrgnSPB2);
00628     <a class="code" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a27">DestroyRegion</a>(&amp;ghrgnSW);
00629     <a class="code" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a27">DestroyRegion</a>(&amp;ghrgnScrl1);
00630     <a class="code" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a27">DestroyRegion</a>(&amp;ghrgnScrl2);
00631     <a class="code" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a27">DestroyRegion</a>(&amp;ghrgnScrlVis);
00632     <a class="code" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a27">DestroyRegion</a>(&amp;ghrgnScrlSrc);
00633     <a class="code" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a27">DestroyRegion</a>(&amp;ghrgnScrlDst);
00634     <a class="code" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a27">DestroyRegion</a>(&amp;ghrgnScrlValid);
00635 
00636     <span class="comment">/*</span>
00637 <span class="comment">     * Cleanup fonts</span>
00638 <span class="comment">     */</span>
00639     <a class="code" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a31">DestroyFont</a>(&amp;ghSmCaptionFont);
00640     <a class="code" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a31">DestroyFont</a>(&amp;ghMenuFont);
00641     <a class="code" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a31">DestroyFont</a>(&amp;ghMenuFontDef);
00642     <a class="code" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a31">DestroyFont</a>(&amp;ghStatusFont);
00643     <a class="code" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a31">DestroyFont</a>(&amp;ghIconFont);
00644     <a class="code" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a31">DestroyFont</a>(&amp;ghFontSys);
00645 
00646     <span class="comment">/*</span>
00647 <span class="comment">     * wallpaper stuff.</span>
00648 <span class="comment">     */</span>
00649     <span class="keywordflow">if</span> (<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a2">ghpalWallpaper</a> != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00650         GreSetPaletteOwner(ghpalWallpaper, OBJECT_OWNER_CURRENT);
00651         GreDeleteObject(ghpalWallpaper);
00652         <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a2">ghpalWallpaper</a> = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00653     }
00654     <a class="code" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a29">DestroyBitmap</a>(&amp;ghbmWallpaper);
00655 
00656     <span class="comment">/*</span>
00657 <span class="comment">     * Unload the video driver</span>
00658 <span class="comment">     */</span>
00659     <span class="keywordflow">if</span> (<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a179">gpDispInfo</a>-&gt;<a class="code" href="../../d9/d3/structtagDISPLAYINFO.html#o1">pmdev</a>) {
00660         DrvDestroyMDEV(<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a179">gpDispInfo</a>-&gt;<a class="code" href="../../d9/d3/structtagDISPLAYINFO.html#o1">pmdev</a>);
00661         GreFreePool(<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a179">gpDispInfo</a>-&gt;<a class="code" href="../../d9/d3/structtagDISPLAYINFO.html#o1">pmdev</a>);
00662         <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a179">gpDispInfo</a>-&gt;<a class="code" href="../../d9/d3/structtagDISPLAYINFO.html#o1">pmdev</a> = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00663         <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a179">gpDispInfo</a>-&gt;<a class="code" href="../../d9/d3/structtagDISPLAYINFO.html#o0">hDev</a> = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00664     }
00665 
00666     <span class="comment">/*</span>
00667 <span class="comment">     * Free the monitor stuff</span>
00668 <span class="comment">     */</span>
00669     {
00670         <a class="code" href="../../d0/d2/structtagMONITOR.html">PMONITOR</a> pMonitor;
00671         <a class="code" href="../../d0/d2/structtagMONITOR.html">PMONITOR</a> pMonitorNext;
00672 
00673         pMonitor = <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a179">gpDispInfo</a>-&gt;<a class="code" href="../../d9/d3/structtagDISPLAYINFO.html#o13">pMonitorFirst</a>;
00674 
00675         <span class="keywordflow">while</span> (pMonitor != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00676             pMonitorNext = pMonitor-&gt;<a class="code" href="../../d0/d2/structtagMONITOR.html#o1">pMonitorNext</a>;
00677             <a class="code" href="../../d4/d1/userk_8h.html#a2079">DestroyMonitor</a>(pMonitor);
00678             pMonitor = pMonitorNext;
00679         }
00680 
00681         UserAssert(<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a179">gpDispInfo</a>-&gt;<a class="code" href="../../d9/d3/structtagDISPLAYINFO.html#o13">pMonitorFirst</a> == NULL);
00682 
00683         <span class="keywordflow">if</span> (<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a16">gpMonitorCached</a> != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00684             <a class="code" href="../../d4/d1/userk_8h.html#a2079">DestroyMonitor</a>(gpMonitorCached);
00685         }
00686     }
00687 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a53" doxytag="w32/ntuser/kernel/init.c::CloseFNTCache" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID CloseFNTCache           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l02184">xxxLW_LoadFonts()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a41" doxytag="w32/ntuser/kernel/init.c::CreateTerminalInput" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL CreateTerminalInput           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d1/d8/structtagTERMINAL.html">PTERMINAL</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>pTerm</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l01376">1376</a> of file <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html">w32/ntuser/kernel/init.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d4/d1/userk_8h.html#a1011">ClientFontSweep()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d7/d7/ntinput_8c-source.html#l00140">xxxInitInput()</a>, and <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l02184">xxxLW_LoadFonts()</a>.
<p>
Referenced by <a class="el" href="../../d9/d7/winsta_8c-source.html#l00026">xxxInitTerminal()</a>.
<p>
<pre class="fragment"><div>01378 {
01379     UserAssert(pTerm != NULL);
01380 
01381     <span class="comment">/*</span>
01382 <span class="comment">     * call to the client side to clean up the [Fonts] section</span>
01383 <span class="comment">     * of the registry. This will only take significant chunk of time</span>
01384 <span class="comment">     * if the [Fonts] key changed during since the last boot and if</span>
01385 <span class="comment">     * there are lots of fonts loaded</span>
01386 <span class="comment">     */</span>
01387     <a class="code" href="../../d4/d1/userk_8h.html#a1011">ClientFontSweep</a>();
01388 
01389     <span class="comment">/*</span>
01390 <span class="comment">     * Load the standard fonts before we create any DCs.</span>
01391 <span class="comment">     * At this time we can only add the fonts that do not</span>
01392 <span class="comment">     * reside on the net. They may be needed by winlogon.</span>
01393 <span class="comment">     * Our winlogon needs only ms sans serif, but private</span>
01394 <span class="comment">     * winlogon's may need some other fonts as well.</span>
01395 <span class="comment">     * The fonts on the net will be added later, right</span>
01396 <span class="comment">     * after all the net connections have been restored.</span>
01397 <span class="comment">     */</span>
01398     <span class="comment">/*</span>
01399 <span class="comment">     * This call should be made in UserInitialize.</span>
01400 <span class="comment">     */</span>
01401     <a class="code" href="../../d4/d1/userk_8h.html#a1845">xxxLW_LoadFonts</a>(FALSE);
01402 
01403     <span class="comment">/*</span>
01404 <span class="comment">     * Initialize the input system.</span>
01405 <span class="comment">     */</span>
01406     <span class="keywordflow">if</span> (!<a class="code" href="../../d4/d1/userk_8h.html#a1168">xxxInitInput</a>(pTerm))
01407         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01408 
01409     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01410 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a29" doxytag="w32/ntuser/kernel/init.c::DestroyBitmap" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID DestroyBitmap           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HBITMAP *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>pbm</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l00528">528</a> of file <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html">w32/ntuser/kernel/init.c</a>.
<p>
References <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, and <a class="el" href="../../d2/d7/hal_8h.html#a212">VOID()</a>.
<p>
Referenced by <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l00565">CleanupGDI()</a>.
<p>
<pre class="fragment"><div>00530 {
00531     <span class="keywordflow">if</span> (*pbm != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00532         GreSetBitmapOwner(*pbm, OBJECT_OWNER_CURRENT);
00533         GreDeleteObject(*pbm);
00534         *pbm = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00535     }
00536 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a28" doxytag="w32/ntuser/kernel/init.c::DestroyBrush" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID DestroyBrush           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HBRUSH *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>pbr</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l00518">518</a> of file <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html">w32/ntuser/kernel/init.c</a>.
<p>
References <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, and <a class="el" href="../../d2/d7/hal_8h.html#a212">VOID()</a>.
<p>
Referenced by <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l00565">CleanupGDI()</a>.
<p>
<pre class="fragment"><div>00520 {
00521     <span class="keywordflow">if</span> (*pbr != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00522         <span class="comment">//GreSetBrushOwner(*pbr, OBJECT_OWNER_CURRENT);</span>
00523         GreDeleteObject(*pbr);
00524         *pbr = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00525     }
00526 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a30" doxytag="w32/ntuser/kernel/init.c::DestroyDC" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID DestroyDC           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HDC *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>phdc</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l00538">538</a> of file <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html">w32/ntuser/kernel/init.c</a>.
<p>
References <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, and <a class="el" href="../../d2/d7/hal_8h.html#a212">VOID()</a>.
<p>
Referenced by <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l00565">CleanupGDI()</a>.
<p>
<pre class="fragment"><div>00540 {
00541     <span class="keywordflow">if</span> (*phdc != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00542         GreSetDCOwner(*phdc, OBJECT_OWNER_CURRENT);
00543         GreDeleteDC(*phdc);
00544         *phdc = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00545     }
00546 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a31" doxytag="w32/ntuser/kernel/init.c::DestroyFont" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID DestroyFont           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HFONT *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>pfnt</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l00548">548</a> of file <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html">w32/ntuser/kernel/init.c</a>.
<p>
References <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, and <a class="el" href="../../d2/d7/hal_8h.html#a212">VOID()</a>.
<p>
Referenced by <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l00565">CleanupGDI()</a>.
<p>
<pre class="fragment"><div>00550 {
00551     <span class="keywordflow">if</span> (*pfnt != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00552         GreDeleteObject(*pfnt);
00553         *pfnt = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00554     }
00555 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a33" doxytag="w32/ntuser/kernel/init.c::DestroyHandleTableObjects" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID DestroyHandleTableObjects           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l00696">696</a> of file <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html">w32/ntuser/kernel/init.c</a>.
<p>
References <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01278">tagSHAREDINFO::aheList</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l01515">_HANDLEENTRY::bFlags</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l01514">_HANDLEENTRY::bType</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l01448">_HEAD::cLockObj</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d0/d6/ntuser_2kernel_2globals_8h-source.html#l00496">gahti</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00849">giheLast</a>, <a class="el" href="../../d2/d7/clglobal_8c-source.html#l00052">gSharedInfo</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01429">HANDLEF_DESTROY</a>, <a class="el" href="../../d4/d1/userk_8h.html#a977">HMDestroyUnlockedObject()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01344">OCF_PROCESSOWNED</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01343">OCF_THREADOWNED</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l01512">_HANDLEENTRY::phead</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00905">TYPE_FREE</a>, and <a class="el" href="../../d2/d7/hal_8h.html#a212">VOID()</a>.
<p>
Referenced by <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l00773">Win32KDriverUnload()</a>.
<p>
<pre class="fragment"><div>00697 {
00698     <a class="code" href="../../d2/d4/struct__HANDLEENTRY.html">HANDLEENTRY</a> <span class="keyword">volatile</span> * (*pphe);
00699     <a class="code" href="../../d2/d4/struct__HANDLEENTRY.html">PHE</a>         pheT;
00700     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>       i;
00701 
00702     <span class="comment">/*</span>
00703 <span class="comment">     * Make sure the handle table was created !</span>
00704 <span class="comment">     */</span>
00705     <span class="keywordflow">if</span> (<a class="code" href="../../d1/d8/clglobal_8c.html#a5">gSharedInfo</a>.<a class="code" href="../../d4/d6/structtagSHAREDINFO.html#o1">aheList</a> == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00706         <span class="keywordflow">return</span>;
00707     }
00708 
00709     <span class="comment">/*</span>
00710 <span class="comment">     * Loop through the table destroying all remaining objects.</span>
00711 <span class="comment">     */</span>
00712     pphe = &amp;<a class="code" href="../../d1/d8/clglobal_8c.html#a5">gSharedInfo</a>.<a class="code" href="../../d4/d6/structtagSHAREDINFO.html#o1">aheList</a>;
00713 
00714     <span class="keywordflow">for</span> (i = 0; i &lt;= <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a308">giheLast</a>; i++) {
00715 
00716         pheT = (<a class="code" href="../../d2/d4/struct__HANDLEENTRY.html">PHE</a>)((*pphe) + i);
00717 
00718         <span class="keywordflow">if</span> (pheT-&gt;<a class="code" href="../../d2/d4/struct__HANDLEENTRY.html#o2">bType</a> == <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a236">TYPE_FREE</a>)
00719             <span class="keywordflow">continue</span>;
00720 
00721         UserAssert(!(gahti[pheT-&gt;<a class="code" href="../../d2/d4/struct__HANDLEENTRY.html#o2">bType</a>].bObjectCreateFlags &amp; OCF_PROCESSOWNED) &amp;&amp;
00722                    !(gahti[pheT-&gt;<a class="code" href="../../d2/d4/struct__HANDLEENTRY.html#o2">bType</a>].bObjectCreateFlags &amp; OCF_THREADOWNED));
00723 
00724         UserAssert(!(pheT-&gt;<a class="code" href="../../d2/d4/struct__HANDLEENTRY.html#o3">bFlags</a> &amp; HANDLEF_DESTROY));
00725 
00726         <span class="comment">/*</span>
00727 <span class="comment">         * Destroy the object.</span>
00728 <span class="comment">         */</span>
00729         <span class="keywordflow">if</span> (pheT-&gt;<a class="code" href="../../d2/d4/struct__HANDLEENTRY.html#o0">phead</a>-&gt;<a class="code" href="../../d4/d5/struct__HEAD.html#o1">cLockObj</a> &gt; 0) {
00730 
00731             RIPMSG1(RIP_ERROR, <span class="stringliteral">"pheT %#p still locked !"</span>, pheT);
00732 
00733             <span class="comment">/*</span>
00734 <span class="comment">             * We're going to die, why bothered by the lock count?</span>
00735 <span class="comment">             * We're forcing the lockcount to 0, and call the destroy routine.</span>
00736 <span class="comment">             */</span>
00737             pheT-&gt;<a class="code" href="../../d2/d4/struct__HANDLEENTRY.html#o0">phead</a>-&gt;<a class="code" href="../../d4/d5/struct__HEAD.html#o1">cLockObj</a> = 0;
00738         }
00739         <a class="code" href="../../d4/d1/userk_8h.html#a977">HMDestroyUnlockedObject</a>(pheT);
00740         UserAssert(pheT-&gt;<a class="code" href="../../d2/d4/struct__HANDLEENTRY.html#o2">bType</a> == TYPE_FREE);
00741     }
00742 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a27" doxytag="w32/ntuser/kernel/init.c::DestroyRegion" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID DestroyRegion           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HRGN *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>prgn</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l00508">508</a> of file <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html">w32/ntuser/kernel/init.c</a>.
<p>
References <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, and <a class="el" href="../../d2/d7/hal_8h.html#a212">VOID()</a>.
<p>
Referenced by <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l00565">CleanupGDI()</a>.
<p>
<pre class="fragment"><div>00510 {
00511     <span class="keywordflow">if</span> (*prgn != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00512         GreSetRegionOwner(*prgn, OBJECT_OWNER_CURRENT);
00513         GreDeleteObject(*prgn);
00514         *prgn = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00515     }
00516 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a22" doxytag="w32/ntuser/kernel/init.c::DriverEntry" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS DriverEntry           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d4/d9/struct__DRIVER__OBJECT.html">PDRIVER_OBJECT</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>DriverObject</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PUNICODE_STRING&nbsp;</td>
          <td class="mdname" nowrap> <em>RegistryPath</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d6/fs__rec_8c-source.html#l00067">67</a> of file <a class="el" href="../../d7/d6/fs__rec_8c-source.html">fs_rec.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00072">_FSVGA_CONFIGURATION_INFORMATION::BusNumber</a>, <a class="el" href="../../d7/d7/fs__rec_8h.html#a38a15">CdfsFileSystem</a>, <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00138">_DEVICE_EXTENSION::Configuration</a>, <a class="el" href="../../d7/d7/fs__rec_8h.html#a13">DEVICE_EXTENSION</a>, <a class="el" href="../../d1/d4/io_8h-source.html#l01187">_DEVICE_OBJECT::DeviceExtension</a>, <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00126">_DEVICE_EXTENSION::DeviceObject</a>, <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00132">_DEVICE_EXTENSION::DeviceRegisters</a>, <a class="el" href="../../d7/d6/fs__rec_8c-source.html#l00067">DriverEntry()</a>, <a class="el" href="../../d6/d8/fsvga_8c.html#a1">DUMP_COUNT</a>, <a class="el" href="../../d6/d4/cc_8h-source.html#l00126">ExAllocatePool</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l00253">ExAllocatePoolWithTag</a>, <a class="el" href="../../d7/d2/cmwraper_8c-source.html#l00304">ExFreePool()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d7/d7/fs__rec_8h.html#a38a16">FatFileSystem</a>, <a class="el" href="../../d8/d6/fs__rec_8h-source.html#l00041">FSREC_POOL_TAG</a>, <a class="el" href="../../d7/d6/fs__rec_8c-source.html#l00195">FsRecCleanupClose()</a>, <a class="el" href="../../d7/d6/fs__rec_8c-source.html#l00233">FsRecCreate()</a>, <a class="el" href="../../d7/d6/fs__rec_8c-source.html#l00282">FsRecCreateAndRegisterDO()</a>, <a class="el" href="../../d7/d6/fs__rec_8c-source.html#l00446">FsRecFsControl()</a>, <a class="el" href="../../d7/d6/fs__rec_8c-source.html#l00063">FsRecLoadSync</a>, <a class="el" href="../../d7/d6/fs__rec_8c-source.html#l00539">FsRecUnload()</a>, <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00168">FSVGA_ERROR_VALUE_BASE</a>, <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00174">FSVGA_HARDWARE_PRESENT</a>, <a class="el" href="../../d7/d7/fsvga_8c-source.html#l01056">FsVgaBuildResourceList()</a>, <a class="el" href="../../d7/d7/fsvga_8c-source.html#l00649">FsVgaConfiguration()</a>, <a class="el" href="../../d7/d7/fsvga_8c-source.html#l01213">FsVgaDeviceControl()</a>, <a class="el" href="../../d7/d7/fsvga_8c-source.html#l01167">FsVgaOpenCloseDispatch()</a>, <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00310">FsVgaPrint</a>, <a class="el" href="../../d2/d7/hal_8h.html#a184">HalTranslateBusAddress()</a>, <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00120">_DEVICE_EXTENSION::HardwarePresent</a>, <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00066">_FSVGA_CONFIGURATION_INFORMATION::InterfaceType</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l00428">IoAllocateErrorLogEntry()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l04073">IoCreateDevice()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l05951">IoDeleteDevice()</a>, <a class="el" href="../../d2/d7/report_8c-source.html#l00379">IoReportResourceUsage()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l11556">IoWriteErrorLogEntry()</a>, <a class="el" href="../../d1/d4/io_8h-source.html#l00073">IRP_MJ_CLEANUP</a>, <a class="el" href="../../d1/d4/io_8h-source.html#l00057">IRP_MJ_CLOSE</a>, <a class="el" href="../../d1/d4/io_8h-source.html#l00055">IRP_MJ_CREATE</a>, <a class="el" href="../../d1/d4/io_8h-source.html#l00069">IRP_MJ_DEVICE_CONTROL</a>, <a class="el" href="../../d1/d4/io_8h-source.html#l00068">IRP_MJ_FILE_SYSTEM_CONTROL</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l01066">KeInitializeEvent</a>, <a class="el" href="../../d3/d9/aw_8h-source.html#l00031">L</a>, <a class="el" href="../../d6/d5/iosup_8c-source.html#l03415">MmMapIoSpace()</a>, <a class="el" href="../../d9/d7/sysload_8c-source.html#l02472">MmPageEntireDriver()</a>, <a class="el" href="../../d6/d5/iosup_8c-source.html#l03678">MmUnmapIoSpace()</a>, <a class="el" href="../../d6/d8/fsvga_8c.html#a0">NAME_MAX</a>, <a class="el" href="../../d5/d8/ex_8h.html#a329a173">NonPagedPool</a>, <a class="el" href="../../d6/d5/stierr_8h-source.html#l00030">NT_SUCCESS</a>, <a class="el" href="../../d7/d7/fs__rec_8h.html#a38a18">NtfsFileSystem</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d1/d8/ntosdef_8h-source.html#l00462">PAGED_CODE</a>, <a class="el" href="../../d5/d8/ex_8h.html#a329a174">PagedPool</a>, <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00078">_FSVGA_CONFIGURATION_INFORMATION::PortList</a>, <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00079">_FSVGA_CONFIGURATION_INFORMATION::PortListCount</a>, <a class="el" href="../../d7/d5/nls_8c-source.html#l01883">RtlAppendUnicodeStringToString()</a>, <a class="el" href="../../d7/d5/nls_8c-source.html#l01821">RtlAppendUnicodeToString()</a>, <a class="el" href="../../d3/d6/string_8c-source.html#l00148">RtlInitUnicodeString()</a>, <a class="el" href="../../d0/d3/cnvint_8c-source.html#l00433">RtlIntegerToUnicodeString()</a>, <a class="el" href="../../d5/d6/rtl_2regutil_8c-source.html#l01220">RtlWriteRegistryValue()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d7/d7/fs__rec_8h.html#a38a19">UdfsFileSystem</a>, <a class="el" href="../../d8/d7/fsvga_8h-source.html#l00160">_DEVICE_EXTENSION::UnmapRegistersRequired</a>, and <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00064">USHORT</a>.
<p>
<pre class="fragment"><div>00074                    :
00075 
00076     This routine <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> invoked once when <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> driver <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> loaded to allow <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> driver
00077     to initialize itself.  The initialization <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> driver consists of simply
00078     creating a device object <span class="keywordflow">for</span> each <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> of <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a9">file</a> system recognized by <span class="keyword">this</span>
00079     driver, and then registering each as active <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a9">file</a> systems.
00080 
00081 Arguments:
00082 
00083     DriverObject - Pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> driver object <span class="keywordflow">for</span> <span class="keyword">this</span> driver.
00084 
00085     RegistryPath - Pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> registry service node <span class="keywordflow">for</span> <span class="keyword">this</span> driver.
00086 
00087 Return Value:
00088 
00089     The function value <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <span class="keyword">final</span> status of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> initialization <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> driver.
00090 
00091 --*/
00092 
00093 {
00094     <a class="code" href="../../d8/d4/struct__DEVICE__OBJECT.html">PDEVICE_OBJECT</a> UdfsMainRecognizerDeviceObject;
00095     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> status;
00096     ULONG count = 0;
00097 
00098     <a class="code" href="../../d0/d9/ntosdef_8h.html#a28">PAGED_CODE</a>();
00099 
00100     <span class="comment">//</span>
00101     <span class="comment">// Mark the entire driver as pagable.</span>
00102     <span class="comment">//</span>
00103 
00104     <a class="code" href="../../d8/d8/sysload_8c.html#a56">MmPageEntireDriver</a> ((PVOID)DriverEntry);
00105 
00106     <span class="comment">//</span>
00107     <span class="comment">// Begin by initializing the driver object so that it the driver is</span>
00108     <span class="comment">// prepared to provide services.</span>
00109     <span class="comment">//</span>
00110 
00111     DriverObject-&gt;MajorFunction[<a class="code" href="../../d0/d5/io_8h.html#a26">IRP_MJ_FILE_SYSTEM_CONTROL</a>] = <a class="code" href="../../d6/d7/fs__rec_8c.html#a7">FsRecFsControl</a>;
00112     DriverObject-&gt;MajorFunction[<a class="code" href="../../d0/d5/io_8h.html#a13">IRP_MJ_CREATE</a>] = <a class="code" href="../../d6/d7/fs__rec_8c.html#a5">FsRecCreate</a>;
00113     DriverObject-&gt;MajorFunction[<a class="code" href="../../d0/d5/io_8h.html#a31">IRP_MJ_CLEANUP</a>] = <a class="code" href="../../d6/d7/fs__rec_8c.html#a4">FsRecCleanupClose</a>;
00114     DriverObject-&gt;MajorFunction[<a class="code" href="../../d0/d5/io_8h.html#a15">IRP_MJ_CLOSE</a>] = <a class="code" href="../../d6/d7/fs__rec_8c.html#a4">FsRecCleanupClose</a>;
00115     DriverObject-&gt;DriverUnload = <a class="code" href="../../d6/d7/fs__rec_8c.html#a8">FsRecUnload</a>;
00116 
00117     <a class="code" href="../../d6/d7/fs__rec_8c.html#a2">FsRecLoadSync</a> = <a class="code" href="../../d5/d8/ex_8h.html#a4">ExAllocatePoolWithTag</a>( NonPagedPool, <span class="keyword">sizeof</span>(<a class="code" href="../../d2/d6/struct__KEVENT.html">KEVENT</a>), FSREC_POOL_TAG );
00118 
00119     <span class="keywordflow">if</span> (<a class="code" href="../../d6/d7/fs__rec_8c.html#a2">FsRecLoadSync</a> == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00120 
00121         <span class="keywordflow">return</span> STATUS_INSUFFICIENT_RESOURCES;
00122     }
00123 
00124     <a class="code" href="../../d4/d9/ke_8h.html#a20">KeInitializeEvent</a>( FsRecLoadSync, SynchronizationEvent, TRUE );
00125 
00126     <span class="comment">//</span>
00127     <span class="comment">// Create and initialize each of the file system driver type device</span>
00128     <span class="comment">// objects.</span>
00129     <span class="comment">//</span>
00130 
00131     status = <a class="code" href="../../d7/d7/fs__rec_8h.html#a26">FsRecCreateAndRegisterDO</a>( DriverObject,
00132                                        NULL,
00133                                        NULL,
00134                                        L<span class="stringliteral">"\\Cdfs"</span>,
00135                                        L<span class="stringliteral">"\\FileSystem\\CdfsRecognizer"</span>,
00136                                        CdfsFileSystem,
00137                                        FILE_DEVICE_CD_ROM_FILE_SYSTEM );
00138     <span class="keywordflow">if</span> (<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>( status )) {
00139         count++;
00140     }
00141 
00142     status = <a class="code" href="../../d7/d7/fs__rec_8h.html#a26">FsRecCreateAndRegisterDO</a>( DriverObject,
00143                                        NULL,
00144                                        &amp;UdfsMainRecognizerDeviceObject,
00145                                        L<span class="stringliteral">"\\UdfsCdRom"</span>,
00146                                        L<span class="stringliteral">"\\FileSystem\\UdfsCdRomRecognizer"</span>,
00147                                        UdfsFileSystem,
00148                                        FILE_DEVICE_CD_ROM_FILE_SYSTEM );
00149     <span class="keywordflow">if</span> (<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>( status )) {
00150         count++;
00151     }
00152 
00153     status = <a class="code" href="../../d7/d7/fs__rec_8h.html#a26">FsRecCreateAndRegisterDO</a>( DriverObject,
00154                                        UdfsMainRecognizerDeviceObject,
00155                                        NULL,
00156                                        L<span class="stringliteral">"\\UdfsDisk"</span>,
00157                                        L<span class="stringliteral">"\\FileSystem\\UdfsDiskRecognizer"</span>,
00158                                        UdfsFileSystem,
00159                                        FILE_DEVICE_DISK_FILE_SYSTEM );
00160     <span class="keywordflow">if</span> (<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>( status )) {
00161         count++;
00162     }
00163 
00164     status = <a class="code" href="../../d7/d7/fs__rec_8h.html#a26">FsRecCreateAndRegisterDO</a>( DriverObject,
00165                                        NULL,
00166                                        NULL,
00167                                        L<span class="stringliteral">"\\Fat"</span>,
00168                                        L<span class="stringliteral">"\\FileSystem\\FatRecognizer"</span>,
00169                                        FatFileSystem,
00170                                        FILE_DEVICE_DISK_FILE_SYSTEM );
00171     <span class="keywordflow">if</span> (<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>( status )) {
00172         count++;
00173     }
00174 
00175     status = <a class="code" href="../../d7/d7/fs__rec_8h.html#a26">FsRecCreateAndRegisterDO</a>( DriverObject,
00176                                        NULL,
00177                                        NULL,
00178                                        L<span class="stringliteral">"\\Ntfs"</span>,
00179                                        L<span class="stringliteral">"\\FileSystem\\NtfsRecognizer"</span>,
00180                                        NtfsFileSystem,
00181                                        FILE_DEVICE_DISK_FILE_SYSTEM );
00182     <span class="keywordflow">if</span> (<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>( status )) {
00183         count++;
00184     }
00185 
00186     <span class="keywordflow">if</span> (count) {
00187         <span class="keywordflow">return</span> STATUS_SUCCESS;
00188     } <span class="keywordflow">else</span> {
00189         <span class="keywordflow">return</span> STATUS_IMAGE_ALREADY_LOADED;
00190     }
00191 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a61" doxytag="w32/ntuser/kernel/init.c::EnforceColorDependentSettings" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void EnforceColorDependentSettings           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">void&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l02782">2782</a> of file <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html">w32/ntuser/kernel/init.c</a>.
<p>
References <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l02212">tagDISPLAYINFO::fAnyPalette</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00671">gbDisableAlpha</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00464">gpDispInfo</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02099">tagDISPLAYINFO::hdcScreen</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l01173">LoadCPUserPreferences()</a>, and <a class="el" href="../../d9/d7/fullscr_8c-source.html#l00564">UpdateUserScreen()</a>.
<p>
<pre class="fragment"><div>02783 {
02784     <span class="keywordflow">if</span> (<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a179">gpDispInfo</a>-&gt;<a class="code" href="../../d9/d3/structtagDISPLAYINFO.html#o19">fAnyPalette</a>) {
02785         <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a252">gbDisableAlpha</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
02786     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (GreGetDeviceCaps(<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a179">gpDispInfo</a>-&gt;<a class="code" href="../../d9/d3/structtagDISPLAYINFO.html#o3">hdcScreen</a>, NUMCOLORS) == -1) {
02787         <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a252">gbDisableAlpha</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
02788     } <span class="keywordflow">else</span> {
02789         <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a252">gbDisableAlpha</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
02790     }
02791 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a55" doxytag="w32/ntuser/kernel/init.c::FinalUserInit" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL FinalUserInit           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l02254">2254</a> of file <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html">w32/ntuser/kernel/init.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l02193">tagDISPLAYINFO::cxGray</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l02194">tagDISPLAYINFO::cyGray</a>, <a class="el" href="../../d3/d6/class_8c-source.html#l01207">DestroyClass()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d2/d7/clglobal_8c-source.html#l00103">ghFontSys</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00324">gMenuState</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00464">gpDispInfo</a>, <a class="el" href="../../d2/d7/clglobal_8c-source.html#l00051">gpsi</a>, <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l00051">GRAY_STRLEN</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02104">tagDISPLAYINFO::hbmGray</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02103">tagDISPLAYINFO::hdcGray</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02099">tagDISPLAYINFO::hdcScreen</a>, <a class="el" href="../../d3/d9/aw_8h-source.html#l00031">L</a>, <a class="el" href="../../d5/d2/mnstate_8c-source.html#l00425">MNSetupAnimationDC()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l00084">PpiCurrent</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
<pre class="fragment"><div>02255 {
02256     HBITMAP hbm;
02257     <a class="code" href="../../d7/d0/structtagCLS.html">PPCLS</a>   ppcls;
02258 
02259     <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a179">gpDispInfo</a>-&gt;<a class="code" href="../../d9/d3/structtagDISPLAYINFO.html#o5">hdcGray</a> = GreCreateCompatibleDC(<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a179">gpDispInfo</a>-&gt;<a class="code" href="../../d9/d3/structtagDISPLAYINFO.html#o3">hdcScreen</a>);
02260 
02261     <span class="keywordflow">if</span> (<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a179">gpDispInfo</a>-&gt;<a class="code" href="../../d9/d3/structtagDISPLAYINFO.html#o5">hdcGray</a> == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
02262         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
02263     }
02264 
02265     GreSelectFont(<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a179">gpDispInfo</a>-&gt;<a class="code" href="../../d9/d3/structtagDISPLAYINFO.html#o5">hdcGray</a>, ghFontSys);
02266     GreSetDCOwner(<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a179">gpDispInfo</a>-&gt;<a class="code" href="../../d9/d3/structtagDISPLAYINFO.html#o5">hdcGray</a>, OBJECT_OWNER_PUBLIC);
02267 
02268     <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a179">gpDispInfo</a>-&gt;<a class="code" href="../../d9/d3/structtagDISPLAYINFO.html#o7">cxGray</a> = <a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;cxSysFontChar * <a class="code" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a1">GRAY_STRLEN</a>;
02269     <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a179">gpDispInfo</a>-&gt;<a class="code" href="../../d9/d3/structtagDISPLAYINFO.html#o8">cyGray</a> = <a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;cySysFontChar + 2;
02270     <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a179">gpDispInfo</a>-&gt;<a class="code" href="../../d9/d3/structtagDISPLAYINFO.html#o6">hbmGray</a> = GreCreateBitmap(<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a179">gpDispInfo</a>-&gt;<a class="code" href="../../d9/d3/structtagDISPLAYINFO.html#o7">cxGray</a>, <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a179">gpDispInfo</a>-&gt;<a class="code" href="../../d9/d3/structtagDISPLAYINFO.html#o8">cyGray</a>, 1, 1, 0L);
02271 
02272     <span class="keywordflow">if</span> (<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a179">gpDispInfo</a>-&gt;<a class="code" href="../../d9/d3/structtagDISPLAYINFO.html#o6">hbmGray</a> == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
02273         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
02274     }
02275 
02276     GreSetBitmapOwner(<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a179">gpDispInfo</a>-&gt;<a class="code" href="../../d9/d3/structtagDISPLAYINFO.html#o6">hbmGray</a>, OBJECT_OWNER_PUBLIC);
02277 
02278     hbm = GreSelectBitmap(<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a179">gpDispInfo</a>-&gt;<a class="code" href="../../d9/d3/structtagDISPLAYINFO.html#o5">hdcGray</a>, <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a179">gpDispInfo</a>-&gt;<a class="code" href="../../d9/d3/structtagDISPLAYINFO.html#o6">hbmGray</a>);
02279     GreSetTextColor(<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a179">gpDispInfo</a>-&gt;<a class="code" href="../../d9/d3/structtagDISPLAYINFO.html#o5">hdcGray</a>, 0x00000000L);
02280     GreSelectBrush(<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a179">gpDispInfo</a>-&gt;<a class="code" href="../../d9/d3/structtagDISPLAYINFO.html#o5">hdcGray</a>, <a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;hbrGray);
02281     GreSetBkMode(<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a179">gpDispInfo</a>-&gt;<a class="code" href="../../d9/d3/structtagDISPLAYINFO.html#o5">hdcGray</a>, OPAQUE);
02282     GreSetBkColor(<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a179">gpDispInfo</a>-&gt;<a class="code" href="../../d9/d3/structtagDISPLAYINFO.html#o5">hdcGray</a>, 0x00FFFFFFL);
02283 
02284     <span class="comment">/*</span>
02285 <span class="comment">     * Setup menu animation dc for global menu state</span>
02286 <span class="comment">     */</span>
02287     <span class="keywordflow">if</span> (<a class="code" href="../../d4/d1/userk_8h.html#a1347">MNSetupAnimationDC</a>(&amp;gMenuState)) {
02288         GreSetDCOwner(<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a146">gMenuState</a>.hdcAni, OBJECT_OWNER_PUBLIC);
02289     } <span class="keywordflow">else</span> {
02290         RIPMSG0(RIP_WARNING, <span class="stringliteral">"FinalUserInit: MNSetupAnimationDC failed"</span>);
02291     }
02292 
02293     <span class="comment">/*</span>
02294 <span class="comment">     * Creation of the queue registers some bogus classes.  Get rid</span>
02295 <span class="comment">     * of them and register the real ones.</span>
02296 <span class="comment">     */</span>
02297     ppcls = &amp;<a class="code" href="../../d4/d1/userk_8h.html#a16">PpiCurrent</a>()-&gt;pclsPublicList;
02298     <span class="keywordflow">while</span> ((*ppcls != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) &amp;&amp; !((*ppcls)-&gt;style &amp; CS_GLOBALCLASS))
02299         <a class="code" href="../../d4/d1/userk_8h.html#a1551">DestroyClass</a>(ppcls);
02300 
02301     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
02302 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a25" doxytag="w32/ntuser/kernel/init.c::FreeImeHotKeys" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID FreeImeHotKeys           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d9/imehotky_8c-source.html#l00252">252</a> of file <a class="el" href="../../d2/d9/imehotky_8c-source.html">imehotky.c</a>.
<p>
References <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00275">gpImeHotKeyListHeader</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d9/d9/immstruc_8h-source.html#l00091">_tagIMEHOTKEYOBJ::pNext</a>, and <a class="el" href="../../d2/d7/hal_8h.html#a212">VOID()</a>.
<p>
Referenced by <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l00097">Win32kNtUserCleanup()</a>.
<p>
<pre class="fragment"><div>00253 {
00254     <a class="code" href="../../d8/d8/struct__tagIMEHOTKEYOBJ.html">PIMEHOTKEYOBJ</a> phk;
00255 
00256     <span class="keywordflow">while</span> (<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a119">gpImeHotKeyListHeader</a> != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00257         phk = <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a119">gpImeHotKeyListHeader</a>-&gt;<a class="code" href="../../d8/d8/struct__tagIMEHOTKEYOBJ.html#o0">pNext</a>;
00258         UserFreePool(gpImeHotKeyListHeader);
00259         <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a119">gpImeHotKeyListHeader</a> = phk;
00260     }
00261 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a24" doxytag="w32/ntuser/kernel/init.c::FreeSMS" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void FreeSMS           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d4/d1/userk_8h.html#a871">PSMS</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>psms</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d5/kernel_2sendmsg_8c-source.html#l00178">178</a> of file <a class="el" href="../../d4/d5/kernel_2sendmsg_8c-source.html">kernel/sendmsg.c</a>.
<p>
References <a class="el" href="../../d6/d7/ex_8h-source.html#l00947">ExFreeToPagedLookasideList()</a>, and <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l00091">SMSLookaside</a>.
<p>
Referenced by <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l00097">Win32kNtUserCleanup()</a>, and <a class="el" href="../../d4/d5/kernel_2sendmsg_8c-source.html#l01296">xxxInterSendMsgEx()</a>.
<p>
<pre class="fragment"><div>00180 {
00181     <a class="code" href="../../d5/d8/ex_8h.html#a253">ExFreeToPagedLookasideList</a>(SMSLookaside, psms);
00182 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a57" doxytag="w32/ntuser/kernel/init.c::GetKbdLangSwitch" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL GetKbdLangSwitch           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">PUNICODE_STRING&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>pProfileUserName</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l02393">2393</a> of file <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html">w32/ntuser/kernel/init.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l02529">tagKBDLANGTOGGLE::bScan</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l02528">tagKBDLANGTOGGLE::bVkey</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d2/d6/w32_2ntuser_2kernel_2profile_8c-source.html#l00945">FastGetProfileIntW()</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00184">gbGraveKeyToggle</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00168">gLangToggle</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l06865">PMAP_UKBDLAYOUTTOGGLE</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d5/d4/rare_8c-source.html#l01497">xxxSystemParametersInfo()</a>, and <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l02445">xxxUpdatePerUserSystemParameters()</a>.
<p>
<pre class="fragment"><div>02394 {
02395     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> dwToggle;
02396     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>  bStatus = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
02397     LCID  lcid;
02398 
02399     dwToggle = <a class="code" href="../../d4/d1/userk_8h.html#a2008">FastGetProfileIntW</a>(pProfileUserName,
02400                                   PMAP_UKBDLAYOUTTOGGLE,
02401                                   TEXT(<span class="stringliteral">"Hotkey"</span>),
02402                                   1);
02403 
02404     <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a69">gbGraveKeyToggle</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
02405 
02406     <span class="keywordflow">switch</span> (dwToggle) {
02407     <span class="keywordflow">case</span> 4:
02408         <span class="comment">/*</span>
02409 <span class="comment">         * Grave accent keyboard switch for thai locales</span>
02410 <span class="comment">         */</span>
02411         ZwQueryDefaultLocale(FALSE, &amp;lcid);
02412         <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a69">gbGraveKeyToggle</a> = (PRIMARYLANGID(lcid) == LANG_THAI) ? <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> : <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
02413         <span class="comment">/*</span>
02414 <span class="comment">         * fall through (intentional) and disable the ctrl/alt toggle mechanism</span>
02415 <span class="comment">         */</span>
02416     <span class="keywordflow">case</span> 3:
02417         <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a65">gLangToggle</a>[0].<a class="code" href="../../d2/d9/structtagKBDLANGTOGGLE.html#o0">bVkey</a> = 0;
02418         <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a65">gLangToggle</a>[0].<a class="code" href="../../d2/d9/structtagKBDLANGTOGGLE.html#o1">bScan</a> = 0;
02419         <span class="keywordflow">break</span>;
02420 
02421     <span class="keywordflow">case</span> 2:
02422         <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a65">gLangToggle</a>[0].<a class="code" href="../../d2/d9/structtagKBDLANGTOGGLE.html#o0">bVkey</a> = VK_CONTROL;
02423         <span class="keywordflow">break</span>;
02424 
02425     <span class="keywordflow">default</span>:
02426         <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a65">gLangToggle</a>[0].<a class="code" href="../../d2/d9/structtagKBDLANGTOGGLE.html#o0">bVkey</a> = VK_MENU;
02427         <span class="keywordflow">break</span>;
02428     }
02429 
02430     <span class="keywordflow">return</span> bStatus;
02431 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a59" doxytag="w32/ntuser/kernel/init.c::InitAnsiOem" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void InitAnsiOem           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">PCHAR&nbsp;</td>
          <td class="mdname" nowrap> <em>pOemToAnsi</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>PCHAR&nbsp;</td>
          <td class="mdname" nowrap> <em>pAnsiToOem</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l02743">2743</a> of file <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html">w32/ntuser/kernel/init.c</a>.
<p>
References <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l01317">tagSERVERINFO::acAnsiToOem</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l01316">tagSERVERINFO::acOemToAnsi</a>, <a class="el" href="../../d0/d7/halvprnt_8c-source.html#l00031">BYTE</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d2/d7/clglobal_8c-source.html#l00051">gpsi</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01061">NCHARS</a>, and <a class="el" href="../../d6/d7/ex_8h-source.html#l01209">ProbeForRead</a>.
<p>
<pre class="fragment"><div>02743                                                      {
02744 
02745     UserAssert(gpsi);
02746     UserAssert(pOemToAnsi);
02747     UserAssert(pAnsiToOem);
02748 
02749     <span class="keywordflow">try</span> {
02750         <a class="code" href="../../d5/d8/ex_8h.html#a11">ProbeForRead</a>(pOemToAnsi, NCHARS, <span class="keyword">sizeof</span>(BYTE));
02751         <a class="code" href="../../d5/d8/ex_8h.html#a11">ProbeForRead</a>(pAnsiToOem, NCHARS, <span class="keyword">sizeof</span>(BYTE));
02752 
02753         RtlCopyMemory(<a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;<a class="code" href="../../d2/d6/structtagSERVERINFO.html#o31">acOemToAnsi</a>, pOemToAnsi, NCHARS);
02754         RtlCopyMemory(<a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;<a class="code" href="../../d2/d6/structtagSERVERINFO.html#o32">acAnsiToOem</a>, pAnsiToOem, NCHARS);
02755 
02756 
02757     } except (W32ExceptionHandler(FALSE, RIP_WARNING)) {
02758     }
02759 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a56" doxytag="w32/ntuser/kernel/init.c::InitializeClientPfnArrays" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS InitializeClientPfnArrays           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">CONST <a class="el" href="../../d0/d5/struct__PFNCLIENT.html">PFNCLIENT</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>ppfnClientA</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>CONST <a class="el" href="../../d0/d5/struct__PFNCLIENT.html">PFNCLIENT</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>ppfnClientW</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>CONST <a class="el" href="../../d1/d5/struct__PFNCLIENTWORKER.html">PFNCLIENTWORKER</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>ppfnClientWorker</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HANDLE&nbsp;</td>
          <td class="mdname" nowrap> <em>hModUser</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l02313">2313</a> of file <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html">w32/ntuser/kernel/init.c</a>.
<p>
References <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01207">tagSERVERINFO::apfnClientA</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01208">tagSERVERINFO::apfnClientW</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01209">tagSERVERINFO::apfnClientWorker</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00760">gpfnwp</a>, <a class="el" href="../../d2/d7/clglobal_8c-source.html#l00051">gpsi</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00735">hModClient</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00339">ICLS_BUTTON</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00344">ICLS_COMBOBOX</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00354">ICLS_COMBOLISTBOX</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00357">ICLS_DDEML16BIT</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00358">ICLS_DDEMLCLIENTA</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00359">ICLS_DDEMLCLIENTW</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00355">ICLS_DDEMLEVENT</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00356">ICLS_DDEMLMOTHER</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00360">ICLS_DDEMLSERVERA</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00361">ICLS_DDEMLSERVERW</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00348">ICLS_DESKTOP</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00349">ICLS_DIALOG</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00340">ICLS_EDIT</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00352">ICLS_ICONTITLE</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00362">ICLS_IME</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00342">ICLS_LISTBOX</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00364">ICLS_MAX</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00353">ICLS_MDICLIENT</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00350">ICLS_MENU</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00343">ICLS_SCROLLBAR</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00341">ICLS_STATIC</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00351">ICLS_SWITCH</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00363">ICLS_TOOLTIP</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l00095">ISCSRSS</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00863">_PFNCLIENT::pfnButtonWndProc</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00864">_PFNCLIENT::pfnComboBoxWndProc</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00865">_PFNCLIENT::pfnComboListBoxProc</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00859">_PFNCLIENT::pfnDefWindowProc</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00866">_PFNCLIENT::pfnDialogWndProc</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00868">_PFNCLIENT::pfnListBoxWndProc</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00869">_PFNCLIENT::pfnMDIClientWndProc</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00870">_PFNCLIENT::pfnStaticWndProc</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00856">_PFNCLIENT::pfnTitleWndProc</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d0/d6/desktop_8c-source.html#l00883">xxxDesktopWndProc()</a>, <a class="el" href="../../d3/d6/ntuser_2kernel_2menu_8c-source.html#l04022">xxxMenuWindowProc()</a>, <a class="el" href="../../d9/d3/sbctl_8c-source.html#l02582">xxxSBWndProc()</a>, <a class="el" href="../../d2/d2/tmswitch_8c-source.html#l01564">xxxSwitchWndProc()</a>, and <a class="el" href="../../d2/d3/tooltips_8c-source.html#l00570">xxxTooltipWndProc()</a>.
<p>
Referenced by <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l01508">NtUserInitializeClientPfnArrays()</a>.
<p>
<pre class="fragment"><div>02318 {
02319     <span class="keyword">static</span> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> fHaveClientPfns = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
02320     <span class="comment">/*</span>
02321 <span class="comment">     * Remember client side addresses in this global structure.  These are</span>
02322 <span class="comment">     * always constant, so this is ok.  Note that if either of the</span>
02323 <span class="comment">     * pointers are invalid, the exception will be handled in</span>
02324 <span class="comment">     * the thunk and fHaveClientPfns will not be set.</span>
02325 <span class="comment">     */</span>
02326     <span class="keywordflow">if</span> (!fHaveClientPfns &amp;&amp; ppfnClientA != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
02327         <span class="keywordflow">if</span> (!<a class="code" href="../../d4/d1/userk_8h.html#a20">ISCSRSS</a>()) {
02328             RIPMSG0(RIP_WARNING, <span class="stringliteral">"InitializeClientPfnArrays failed !csrss"</span>);
02329             <span class="keywordflow">return</span> STATUS_UNSUCCESSFUL;
02330         }
02331         <a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;<a class="code" href="../../d2/d6/structtagSERVERINFO.html#o8">apfnClientA</a> = *ppfnClientA;
02332         <a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;<a class="code" href="../../d2/d6/structtagSERVERINFO.html#o9">apfnClientW</a> = *ppfnClientW;
02333         <a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;<a class="code" href="../../d2/d6/structtagSERVERINFO.html#o10">apfnClientWorker</a> = *ppfnClientWorker;
02334 
02335         <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a280">gpfnwp</a>[<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a68">ICLS_BUTTON</a>]  = <a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;<a class="code" href="../../d2/d6/structtagSERVERINFO.html#o9">apfnClientW</a>.<a class="code" href="../../d0/d5/struct__PFNCLIENT.html#o5">pfnButtonWndProc</a>;
02336         <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a280">gpfnwp</a>[<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a69">ICLS_EDIT</a>]  = <a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;<a class="code" href="../../d2/d6/structtagSERVERINFO.html#o9">apfnClientW</a>.<a class="code" href="../../d0/d5/struct__PFNCLIENT.html#o4">pfnDefWindowProc</a>;
02337         <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a280">gpfnwp</a>[<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a70">ICLS_STATIC</a>]  = <a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;<a class="code" href="../../d2/d6/structtagSERVERINFO.html#o9">apfnClientW</a>.<a class="code" href="../../d0/d5/struct__PFNCLIENT.html#o12">pfnStaticWndProc</a>;
02338         <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a280">gpfnwp</a>[<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a71">ICLS_LISTBOX</a>]  = <a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;<a class="code" href="../../d2/d6/structtagSERVERINFO.html#o9">apfnClientW</a>.<a class="code" href="../../d0/d5/struct__PFNCLIENT.html#o10">pfnListBoxWndProc</a>;
02339         <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a280">gpfnwp</a>[<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a72">ICLS_SCROLLBAR</a>]  = (PROC)<a class="code" href="../../d8/d4/sbctl_8c.html#a47">xxxSBWndProc</a>;
02340         <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a280">gpfnwp</a>[<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a73">ICLS_COMBOBOX</a>]  = <a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;<a class="code" href="../../d2/d6/structtagSERVERINFO.html#o9">apfnClientW</a>.<a class="code" href="../../d0/d5/struct__PFNCLIENT.html#o6">pfnComboBoxWndProc</a>;
02341         <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a280">gpfnwp</a>[<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a75">ICLS_DESKTOP</a>]  = (PROC)<a class="code" href="../../d9/d6/desktop_8c.html#a10">xxxDesktopWndProc</a>;
02342         <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a280">gpfnwp</a>[<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a76">ICLS_DIALOG</a>]  = <a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;<a class="code" href="../../d2/d6/structtagSERVERINFO.html#o9">apfnClientW</a>.<a class="code" href="../../d0/d5/struct__PFNCLIENT.html#o8">pfnDialogWndProc</a>;
02343         <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a280">gpfnwp</a>[<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a77">ICLS_MENU</a>]  = (PROC)<a class="code" href="../../d2/d7/ntuser_2kernel_2menu_8c.html#a43">xxxMenuWindowProc</a>;
02344         <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a280">gpfnwp</a>[<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a78">ICLS_SWITCH</a>]  = (PROC)<a class="code" href="../../d1/d3/tmswitch_8c.html#a28">xxxSwitchWndProc</a>;
02345         <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a280">gpfnwp</a>[<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a79">ICLS_ICONTITLE</a>] = <a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;<a class="code" href="../../d2/d6/structtagSERVERINFO.html#o9">apfnClientW</a>.<a class="code" href="../../d0/d5/struct__PFNCLIENT.html#o1">pfnTitleWndProc</a>;
02346         <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a280">gpfnwp</a>[<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a80">ICLS_MDICLIENT</a>] = <a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;<a class="code" href="../../d2/d6/structtagSERVERINFO.html#o9">apfnClientW</a>.<a class="code" href="../../d0/d5/struct__PFNCLIENT.html#o11">pfnMDIClientWndProc</a>;
02347         <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a280">gpfnwp</a>[<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a81">ICLS_COMBOLISTBOX</a>] = <a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;<a class="code" href="../../d2/d6/structtagSERVERINFO.html#o9">apfnClientW</a>.<a class="code" href="../../d0/d5/struct__PFNCLIENT.html#o7">pfnComboListBoxProc</a>;
02348         <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a280">gpfnwp</a>[<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a82">ICLS_DDEMLEVENT</a>] = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
02349         <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a280">gpfnwp</a>[<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a83">ICLS_DDEMLMOTHER</a>] = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
02350         <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a280">gpfnwp</a>[<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a84">ICLS_DDEML16BIT</a>] = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
02351         <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a280">gpfnwp</a>[<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a85">ICLS_DDEMLCLIENTA</a>] = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
02352         <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a280">gpfnwp</a>[<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a86">ICLS_DDEMLCLIENTW</a>] = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
02353         <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a280">gpfnwp</a>[<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a87">ICLS_DDEMLSERVERA</a>] = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
02354         <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a280">gpfnwp</a>[<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a88">ICLS_DDEMLSERVERW</a>] = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
02355         <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a280">gpfnwp</a>[<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a89">ICLS_IME</a>] = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
02356         <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a280">gpfnwp</a>[<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a90">ICLS_TOOLTIP</a>] = (PROC)<a class="code" href="../../d1/d4/tooltips_8c.html#a31">xxxTooltipWndProc</a>;
02357 
02358         <span class="comment">/*</span>
02359 <span class="comment">         * Change this assert when new classes are added.</span>
02360 <span class="comment">         */</span>
02361         UserAssert(ICLS_MAX == ICLS_TOOLTIP+1);
02362 
02363         <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a274">hModClient</a> = hModUser;
02364         fHaveClientPfns = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
02365     }
02366 <span class="preprocessor">#if DBG</span>
02367 <span class="preprocessor"></span>    <span class="comment">/*</span>
02368 <span class="comment">     * BradG - Verify that user32.dll on the client side has loaded</span>
02369 <span class="comment">     *   at the correct address.  If not, do an RIPMSG.</span>
02370 <span class="comment">     */</span>
02371 
02372     <span class="keywordflow">if</span>((ppfnClientA != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) &amp;&amp;
02373        (<a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;<a class="code" href="../../d2/d6/structtagSERVERINFO.html#o8">apfnClientA</a>.<a class="code" href="../../d0/d5/struct__PFNCLIENT.html#o5">pfnButtonWndProc</a> != ppfnClientA-&gt;pfnButtonWndProc))
02374         RIPMSG0(RIP_ERROR, <span class="stringliteral">"Client side user32.dll not loaded at same address."</span>);
02375 <span class="preprocessor">#endif</span>
02376 <span class="preprocessor"></span>
02377     <span class="keywordflow">return</span> STATUS_SUCCESS;
02378 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a37" doxytag="w32/ntuser/kernel/init.c::LoadCPUserPreferences" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL LoadCPUserPreferences           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">PUNICODE_STRING&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>pProfileUserName</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l01173">1173</a> of file <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html">w32/ntuser/kernel/init.c</a>.
<p>
References <a class="el" href="../../d5/d0/userk_8h-source.html#l06586">ACCF_KEYBOARDPREF</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l02782">EnforceColorDependentSettings()</a>, <a class="el" href="../../d2/d6/w32_2ntuser_2kernel_2profile_8c-source.html#l01173">FastGetProfileValue()</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00932">gbRemoteSession</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00348">gpdwCPUserPreferencesMask</a>, <a class="el" href="../../d2/d7/clglobal_8c-source.html#l00051">gpsi</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00370">gpviCPUserPreferences</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d4/d1/userk_8h.html#a918">PPROFILEVALUEINFO</a>, <a class="el" href="../../d4/d5/rare_8c.html#a6">ppvi</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l05286">PropagetUPBOOLTogpsi</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l06602">TEST_BOOL_ACCF</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, and <a class="el" href="../../d5/d0/userk_8h-source.html#l07066">UP</a>.
<p>
Referenced by <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l02445">xxxUpdatePerUserSystemParameters()</a>.
<p>
<pre class="fragment"><div>01174 {
01175     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> pdwValue [SPI_BOOLMASKDWORDSIZE];
01176     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> dw;
01177     <a class="code" href="../../d9/d3/structtagPROFILEVALUEINFO.html">PPROFILEVALUEINFO</a> <a class="code" href="../../d4/d5/rare_8c.html#a6">ppvi</a> = <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a151">gpviCPUserPreferences</a>;
01178 
01179     UserAssert(1 + SPI_DWORDRANGECOUNT == <span class="keyword">sizeof</span>(gpviCPUserPreferences) / <span class="keyword">sizeof</span>(*gpviCPUserPreferences));
01180 
01181     <span class="comment">/*</span>
01182 <span class="comment">     * The first value in gpviCPUserPreferences corresponds to the bit mask</span>
01183 <span class="comment">     */</span>
01184     dw =  <a class="code" href="../../d4/d1/userk_8h.html#a2013">FastGetProfileValue</a>(pProfileUserName,
01185             <a class="code" href="../../d4/d5/rare_8c.html#a6">ppvi</a>-&gt;uSection,
01186             <a class="code" href="../../d4/d5/rare_8c.html#a6">ppvi</a>-&gt;pwszKeyName,
01187             NULL,
01188             (LPBYTE)pdwValue,
01189             <span class="keyword">sizeof</span>(*pdwValue)
01190             );
01191 
01192     <span class="comment">/*</span>
01193 <span class="comment">     * Copy only the amount of data read and no more than what we expect</span>
01194 <span class="comment">     */</span>
01195     <span class="keywordflow">if</span> (dw != 0) {
01196         <span class="keywordflow">if</span> (dw &gt; <span class="keyword">sizeof</span>(<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a150">gpdwCPUserPreferencesMask</a>)) {
01197             dw = <span class="keyword">sizeof</span>(<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a150">gpdwCPUserPreferencesMask</a>);
01198         }
01199         RtlCopyMemory(gpdwCPUserPreferencesMask, pdwValue, dw);
01200     }
01201 
01202     <a class="code" href="../../d4/d5/rare_8c.html#a6">ppvi</a>++;
01203 
01204     <span class="comment">/*</span>
01205 <span class="comment">     * DWORD values</span>
01206 <span class="comment">     */</span>
01207     <span class="keywordflow">for</span> (dw = 1; dw &lt; 1 + SPI_DWORDRANGECOUNT; dw++, <a class="code" href="../../d4/d5/rare_8c.html#a6">ppvi</a>++) {
01208         <span class="keywordflow">if</span> (<a class="code" href="../../d4/d1/userk_8h.html#a2013">FastGetProfileValue</a>(pProfileUserName,
01209                 <a class="code" href="../../d4/d5/rare_8c.html#a6">ppvi</a>-&gt;uSection,
01210                 <a class="code" href="../../d4/d5/rare_8c.html#a6">ppvi</a>-&gt;pwszKeyName,
01211                 NULL,
01212                 (LPBYTE)pdwValue,
01213                 <span class="keyword">sizeof</span>(DWORD)
01214                 )) {
01215 
01216             <a class="code" href="../../d4/d5/rare_8c.html#a6">ppvi</a>-&gt;dwValue = *pdwValue;
01217         }
01218     }
01219 
01220     <span class="keywordflow">if</span> (<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a328">gbRemoteSession</a>) {
01221 
01222         <span class="comment">/*</span>
01223 <span class="comment">         * Default is w/o UIEFFECTS for remote connections</span>
01224 <span class="comment">         */</span>
01225         <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a150">gpdwCPUserPreferencesMask</a>[0] &amp;= ~0x80000000;
01226     }
01227 
01228     <span class="comment">/*</span>
01229 <span class="comment">     * Propagate gpsi flags</span>
01230 <span class="comment">     */</span>
01231     <a class="code" href="../../d4/d1/userk_8h.html#a569">PropagetUPBOOLTogpsi</a>(COMBOBOXANIMATION);
01232     <a class="code" href="../../d4/d1/userk_8h.html#a569">PropagetUPBOOLTogpsi</a>(LISTBOXSMOOTHSCROLLING);
01233     <a class="code" href="../../d4/d1/userk_8h.html#a569">PropagetUPBOOLTogpsi</a>(KEYBOARDCUES);
01234     <a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;bKeyboardPref = <a class="code" href="../../d4/d1/userk_8h.html#a652">TEST_BOOL_ACCF</a>(ACCF_KEYBOARDPREF);
01235 
01236     <a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;uCaretWidth = <a class="code" href="../../d4/d1/userk_8h.html#a743">UP</a>(CARETWIDTH);
01237 
01238     <a class="code" href="../../d4/d1/userk_8h.html#a569">PropagetUPBOOLTogpsi</a>(UIEFFECTS);
01239 
01240     <a class="code" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a61">EnforceColorDependentSettings</a>();
01241 
01242     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01243 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a49" doxytag="w32/ntuser/kernel/init.c::LW_BrushInit" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL LW_BrushInit           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l01820">1820</a> of file <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html">w32/ntuser/kernel/init.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l03362">ghbrBlack</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00296">ghbrHungApp</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l03361">ghbrWhite</a>, <a class="el" href="../../d2/d7/clglobal_8c-source.html#l00051">gpsi</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d7/d9/w32_2ntuser_2kernel_2misc_8c-source.html#l00020">RemoteConnect()</a>, and <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l02004">UserInitialize()</a>.
<p>
<pre class="fragment"><div>01821 {
01822     HBITMAP hbmGray;
01823     CONST <span class="keyword">static</span> WORD patGray[8] = {0x55, 0xaa, 0x55, 0xaa, 0x55, 0xaa, 0x55, 0xaa};
01824 
01825     <span class="comment">/*</span>
01826 <span class="comment">     * Create a gray brush to be used with GrayString</span>
01827 <span class="comment">     */</span>
01828     hbmGray   = GreCreateBitmap(8, 8, 1, 1, (LPBYTE)patGray);
01829 
01830     <span class="keywordflow">if</span> (hbmGray == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01831         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01832     }
01833 
01834     <a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;hbrGray  = GreCreatePatternBrush(hbmGray);
01835     <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a1134">ghbrWhite</a> = GreGetStockObject(WHITE_BRUSH);
01836     <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a1135">ghbrBlack</a> = GreGetStockObject(BLACK_BRUSH);
01837 
01838     UserAssert(ghbrWhite != NULL &amp;&amp; ghbrBlack != NULL);
01839 
01840     <span class="keywordflow">if</span> (<a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;hbrGray == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01841         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01842     }
01843 
01844     GreDeleteObject(hbmGray);
01845     GreSetBrushOwnerPublic(<a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;hbrGray);
01846     <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a129">ghbrHungApp</a> = GreCreateSolidBrush(0);
01847 
01848     <span class="keywordflow">if</span> (<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a129">ghbrHungApp</a> == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01849         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01850     }
01851 
01852     GreSetBrushOwnerPublic(ghbrHungApp);
01853 
01854     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01855 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a36" doxytag="w32/ntuser/kernel/init.c::LW_DriversInit" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID LW_DriversInit           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l01142">1142</a> of file <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html">w32/ntuser/kernel/init.c</a>.
<p>
References <a class="el" href="../../d8/d7/kbd_8c-source.html#l00157">gapulCvt_VK</a>, <a class="el" href="../../d8/d7/kbd_8c-source.html#l00146">gapulCvt_VK_84</a>, <a class="el" href="../../d8/d7/kbd_8c-source.html#l00152">gapulCvt_VK_IBM02</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00543">gKeyboardInfo</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00228">gnKeyboardSpeed</a>, <a class="el" href="../../d5/d1/fekbd_8c-source.html#l01092">NlsKbdInitializePerSystem()</a>, <a class="el" href="../../d7/d7/ntinput_8c-source.html#l02932">SetKeyboardRate()</a>, <a class="el" href="../../d0/d5/ndismain_8h-source.html#l00026">UINT</a>, and <a class="el" href="../../d2/d7/hal_8h.html#a212">VOID()</a>.
<p>
Referenced by <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l01319">xxxInitWindowStation()</a>.
<p>
<pre class="fragment"><div>01143 {
01144     <span class="comment">/*</span>
01145 <span class="comment">     * Initialize the keyboard typematic rate.</span>
01146 <span class="comment">     */</span>
01147     <a class="code" href="../../d4/d1/userk_8h.html#a1176">SetKeyboardRate</a>((UINT)gnKeyboardSpeed);
01148 
01149     <span class="comment">/*</span>
01150 <span class="comment">     * Adjust VK modification table if not default (type 4) kbd.</span>
01151 <span class="comment">     */</span>
01152     <span class="keywordflow">if</span> (<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a214">gKeyboardInfo</a>.KeyboardIdentifier.Type == 3)
01153         <a class="code" href="../../d7/d8/kbd_8c.html#a13">gapulCvt_VK</a> = <a class="code" href="../../d7/d8/kbd_8c.html#a11">gapulCvt_VK_84</a>;
01154 
01155     <span class="comment">/*</span>
01156 <span class="comment">     * Adjust VK modification table for IBM 5576 002/003 keyboard.</span>
01157 <span class="comment">     */</span>
01158     <span class="keywordflow">if</span> (JAPANESE_KEYBOARD(<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a214">gKeyboardInfo</a>.KeyboardIdentifier) &amp;&amp;
01159         (<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a214">gKeyboardInfo</a>.KeyboardIdentifier.Subtype == 3))
01160         <a class="code" href="../../d7/d8/kbd_8c.html#a13">gapulCvt_VK</a> = <a class="code" href="../../d7/d8/kbd_8c.html#a12">gapulCvt_VK_IBM02</a>;
01161 
01162     <span class="comment">/*</span>
01163 <span class="comment">     * Initialize NLS keyboard globals.</span>
01164 <span class="comment">     */</span>
01165     <a class="code" href="../../d4/d2/fekbd_8c.html#a46">NlsKbdInitializePerSystem</a>();
01166 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a38" doxytag="w32/ntuser/kernel/init.c::LW_LoadProfileInitData" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID LW_LoadProfileInitData           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">PUNICODE_STRING&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>pProfileUserName</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l01253">1253</a> of file <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html">w32/ntuser/kernel/init.c</a>.
<p>
References <a class="el" href="../../d2/d6/w32_2ntuser_2kernel_2profile_8c-source.html#l01031">FastGetProfileIntFromID()</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00283">guDdeSendTimeout</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l06841">PMAP_WINDOWSM</a>, and <a class="el" href="../../d2/d7/hal_8h.html#a212">VOID()</a>.
<p>
<pre class="fragment"><div>01254 {
01255     <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a125">guDdeSendTimeout</a> = <a class="code" href="../../d4/d1/userk_8h.html#a2010">FastGetProfileIntFromID</a>(pProfileUserName,
01256                                                PMAP_WINDOWSM,
01257                                                STR_DDESENDTIMEOUT,
01258                                                0);
01259 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a39" doxytag="w32/ntuser/kernel/init.c::LW_LoadResources" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID LW_LoadResources           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">PUNICODE_STRING&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>pProfileUserName</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l01268">1268</a> of file <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html">w32/ntuser/kernel/init.c</a>.
<p>
References <a class="el" href="../../d2/d6/w32_2ntuser_2kernel_2profile_8c-source.html#l01086">FastGetProfileStringFromIDW()</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l06851">PMAP_BEEP</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l06852">PMAP_MOUSE</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l06588">PUDF_BEEP</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l06589">PUDF_EXTENDEDSOUNDS</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l06612">SET_OR_CLEAR_PUDF</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00202">SYSMET</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00719">szN</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00718">szy</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00717">szY</a>, and <a class="el" href="../../d2/d7/hal_8h.html#a212">VOID()</a>.
<p>
Referenced by <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l02445">xxxUpdatePerUserSystemParameters()</a>.
<p>
<pre class="fragment"><div>01269 {
01270     WCHAR rgch[4];
01271 
01272     <span class="comment">/*</span>
01273 <span class="comment">     * See if the Mouse buttons need swapping.</span>
01274 <span class="comment">     */</span>
01275     <a class="code" href="../../d4/d1/userk_8h.html#a2011">FastGetProfileStringFromIDW</a>(pProfileUserName,
01276                                 PMAP_MOUSE,
01277                                 STR_SWAPBUTTONS,
01278                                 szN,
01279                                 rgch,
01280                                 <span class="keyword">sizeof</span>(rgch) / <span class="keyword">sizeof</span>(WCHAR));
01281     <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(SWAPBUTTON) = (*rgch == <span class="charliteral">'1'</span> || *rgch == *<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a267">szY</a> || *rgch == *<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a268">szy</a>);
01282 
01283     <span class="comment">/*</span>
01284 <span class="comment">     * See if we should beep.</span>
01285 <span class="comment">     */</span>
01286     <a class="code" href="../../d4/d1/userk_8h.html#a2011">FastGetProfileStringFromIDW</a>(pProfileUserName,
01287                                 PMAP_BEEP,
01288                                 STR_BEEP,
01289                                 szY,
01290                                 rgch,
01291                                 <span class="keyword">sizeof</span>(rgch) / <span class="keyword">sizeof</span>(WCHAR)
01292                                 );
01293 
01294     <a class="code" href="../../d4/d1/userk_8h.html#a661">SET_OR_CLEAR_PUDF</a>(PUDF_BEEP, (rgch[0] == *szY) || (rgch[0] == *szy));
01295 
01296     <span class="comment">/*</span>
01297 <span class="comment">     * See if we should have extended sounds.</span>
01298 <span class="comment">     */</span>
01299     <a class="code" href="../../d4/d1/userk_8h.html#a2011">FastGetProfileStringFromIDW</a>(pProfileUserName,
01300                                 PMAP_BEEP,
01301                                 STR_EXTENDEDSOUNDS,
01302                                 szN,
01303                                 rgch,
01304                                 <span class="keyword">sizeof</span>(rgch) / <span class="keyword">sizeof</span>(WCHAR)
01305                                 );
01306 
01307     <a class="code" href="../../d4/d1/userk_8h.html#a661">SET_OR_CLEAR_PUDF</a>(PUDF_EXTENDEDSOUNDS, (rgch[0] == *szY || rgch[0] == *szy));
01308 
01309 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a42" doxytag="w32/ntuser/kernel/init.c::LW_LoadSomeStrings" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID LW_LoadSomeStrings           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l01422">1422</a> of file <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html">w32/ntuser/kernel/init.c</a>.
<p>
References <a class="el" href="../../d2/d7/clglobal_8c-source.html#l00051">gpsi</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00905">gszMAX</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00904">gszMIN</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00907">gszRESDOWN</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00906">gszRESUP</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00911">gszSCLOSE</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00734">hModuleWin</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00237">MAX_MB_STRINGS</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l01306">tagSERVERINFO::MBStrings</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l02272">ServerLoadString</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l00177">tagMBSTRING::szName</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l00178">tagMBSTRING::uID</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l00179">tagMBSTRING::uStr</a>, and <a class="el" href="../../d2/d7/hal_8h.html#a212">VOID()</a>.
<p>
Referenced by <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l02249">Win32UserInitialize()</a>.
<p>
<pre class="fragment"><div>01423 {
01424    <span class="keywordtype">int</span> i, str, <span class="keywordtype">id</span>;
01425 
01426    <span class="comment">/*</span>
01427 <span class="comment">    * MessageBox strings</span>
01428 <span class="comment">    */</span>
01429    <span class="keywordflow">for</span> (i = 0, str = STR_OK, <span class="keywordtype">id</span> = IDOK; i&lt;<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a32">MAX_MB_STRINGS</a>; i++, str++, <span class="keywordtype">id</span>++) {
01430        <a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;<a class="code" href="../../d2/d6/structtagSERVERINFO.html#o38">MBStrings</a>[i].<a class="code" href="../../d7/d0/structtagMBSTRING.html#o2">uStr</a> = str;
01431        <a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;<a class="code" href="../../d2/d6/structtagSERVERINFO.html#o38">MBStrings</a>[i].<a class="code" href="../../d7/d0/structtagMBSTRING.html#o1">uID</a> = <span class="keywordtype">id</span>;
01432        <a class="code" href="../../d4/d1/userk_8h.html#a248">ServerLoadString</a>(hModuleWin, str, <a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;<a class="code" href="../../d2/d6/structtagSERVERINFO.html#o38">MBStrings</a>[i].<a class="code" href="../../d7/d0/structtagMBSTRING.html#o0">szName</a>, <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;<a class="code" href="../../d2/d6/structtagSERVERINFO.html#o38">MBStrings</a>[i].<a class="code" href="../../d7/d0/structtagMBSTRING.html#o0">szName</a>) / <span class="keyword">sizeof</span>(WCHAR));
01433    }
01434 
01435    <span class="comment">/*</span>
01436 <span class="comment">    * Tooltips strings</span>
01437 <span class="comment">    */</span>
01438    <a class="code" href="../../d4/d1/userk_8h.html#a248">ServerLoadString</a>(hModuleWin, STR_MIN,    gszMIN,    <span class="keyword">sizeof</span>(gszMIN)    / <span class="keyword">sizeof</span>(WCHAR));
01439    <a class="code" href="../../d4/d1/userk_8h.html#a248">ServerLoadString</a>(hModuleWin, STR_MAX,    gszMAX,    <span class="keyword">sizeof</span>(gszMAX)    / <span class="keyword">sizeof</span>(WCHAR));
01440    <a class="code" href="../../d4/d1/userk_8h.html#a248">ServerLoadString</a>(hModuleWin, STR_RESUP,  gszRESUP,  <span class="keyword">sizeof</span>(gszRESUP)  / <span class="keyword">sizeof</span>(WCHAR));
01441    <a class="code" href="../../d4/d1/userk_8h.html#a248">ServerLoadString</a>(hModuleWin, STR_RESDOWN,gszRESDOWN,<span class="keyword">sizeof</span>(gszRESDOWN)/ <span class="keyword">sizeof</span>(WCHAR));
01442    <span class="comment">/* Commented out due to TandyT ...</span>
01443 <span class="comment">    * ServerLoadString(hModuleWin, STR_SMENU,  gszSMENU,  sizeof(gszSMENU)  / sizeof(WCHAR));</span>
01444 <span class="comment">    */</span>
01445    <a class="code" href="../../d4/d1/userk_8h.html#a248">ServerLoadString</a>(hModuleWin, STR_SCLOSE, gszSCLOSE, <span class="keyword">sizeof</span>(gszSCLOSE) / <span class="keyword">sizeof</span>(WCHAR));
01446 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a50" doxytag="w32/ntuser/kernel/init.c::LW_RegisterWindows" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL LW_RegisterWindows           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">BOOL&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>fSystem</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l01863">1863</a> of file <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html">w32/ntuser/kernel/init.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a3">CCLASSES</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01685">CSF_SERVERSIDEPROC</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01688">CSF_SYSTEMCLASS</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l01771">CSF_WIN40COMPAT</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00289">DESKTOPCLASS</a>, <a class="el" href="../../d4/d1/userk_8h.html#a836">DESKWND</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00787">FNID_DESKTOP</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00785">FNID_ICONTITLE</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00786">FNID_MENU</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00784">FNID_SCROLLBAR</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00817">FNID_SWITCH</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00818">FNID_TOOLTIP</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00734">hModuleWin</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00292">ICONTITLECLASS</a>, <a class="el" href="../../d3/d6/class_8c-source.html#l00244">InternalRegisterClassEx()</a>, <a class="el" href="../../d3/d9/aw_8h-source.html#l00031">L</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00295">MENUCLASS</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01512">PtoH</a>, <a class="el" href="../../d0/d0/client_2nt6_2user_8h.html#a1092">SBWND</a>, <a class="el" href="../../d4/d1/userk_8h.html#a947">SWITCHWND</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00291">SWITCHWNDCLASS</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l02773">SYSCUR</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00294">TOOLTIPCLASS</a>, <a class="el" href="../../d4/d1/userk_8h.html#a956">TOOLTIPWND</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d0/d5/ndismain_8h-source.html#l00026">UINT</a>, <a class="el" href="../../d9/d2/dwp_8c-source.html#l01264">xxxDefWindowProc()</a>, <a class="el" href="../../d0/d6/desktop_8c-source.html#l00883">xxxDesktopWndProc()</a>, <a class="el" href="../../d2/d7/w32_2ntuser_2kernel_2event_8c-source.html#l00224">xxxEventWndProc()</a>, <a class="el" href="../../d3/d6/ntuser_2kernel_2menu_8c-source.html#l04022">xxxMenuWindowProc()</a>, <a class="el" href="../../d9/d3/sbctl_8c-source.html#l02582">xxxSBWndProc()</a>, <a class="el" href="../../d2/d2/tmswitch_8c-source.html#l01564">xxxSwitchWndProc()</a>, and <a class="el" href="../../d2/d3/tooltips_8c-source.html#l00570">xxxTooltipWndProc()</a>.
<p>
Referenced by <a class="el" href="../../d7/d2/queue_8c-source.html#l01501">xxxCreateThreadInfo()</a>.
<p>
<pre class="fragment"><div>01865 {
01866 <span class="preprocessor">#ifdef HUNGAPP_GHOSTING</span>
01867 <span class="preprocessor"></span><span class="preprocessor">#define CCLASSES 9</span>
01868 <span class="preprocessor"></span><span class="preprocessor">#else // HUNGAPP_GHOSTING</span>
01869 <span class="preprocessor"></span><span class="preprocessor">#define CCLASSES 8</span>
01870 <span class="preprocessor"></span><span class="preprocessor">#endif // HUNGAPP_GHOSTING</span>
01871 <span class="preprocessor"></span>
01872     <span class="keywordtype">int</span>        i;
01873     WNDCLASSEX wndcls;
01874 
01875     CONST <span class="keyword">static</span> <span class="keyword">struct </span>{
01876         BOOLEAN     fSystem;
01877         BOOLEAN     fGlobalClass;
01878         WORD        fnid;
01879         <a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a>        style;
01880         WNDPROC     lpfnWndProc;
01881         <span class="keywordtype">int</span>         cbWndExtra;
01882         <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>        fNormalCursor : 1;
01883         HBRUSH      hbrBackground;
01884         LPCTSTR     lpszClassName;
01885     } rc[<a class="code" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a3">CCLASSES</a>] = {
01886         { <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>, <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>, <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a196">FNID_DESKTOP</a>,
01887             CS_DBLCLKS,
01888             (WNDPROC)<a class="code" href="../../d9/d6/desktop_8c.html#a10">xxxDesktopWndProc</a>,
01889             <span class="keyword">sizeof</span>(<a class="code" href="../../d3/d3/structtagDESKWND.html">DESKWND</a>) - <span class="keyword">sizeof</span>(<a class="code" href="../../d6/d9/structtagWND.html">WND</a>),
01890             <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>,
01891             (HBRUSH)(COLOR_BACKGROUND + 1),
01892             <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a39">DESKTOPCLASS</a>},
01893         { <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>, <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>, <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a221">FNID_SWITCH</a>,
01894             CS_VREDRAW | CS_HREDRAW | CS_SAVEBITS,
01895             (WNDPROC)<a class="code" href="../../d1/d3/tmswitch_8c.html#a28">xxxSwitchWndProc</a>,
01896             <span class="keyword">sizeof</span>(<a class="code" href="../../d7/d7/structtagSWITCHWND.html">SWITCHWND</a>) - <span class="keyword">sizeof</span>(<a class="code" href="../../d6/d9/structtagWND.html">WND</a>),
01897             <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>,
01898             <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>,
01899             <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a41">SWITCHWNDCLASS</a>},
01900         { <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>, <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>, <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a195">FNID_MENU</a>,
01901             CS_DBLCLKS | CS_SAVEBITS,
01902             (WNDPROC)<a class="code" href="../../d2/d7/ntuser_2kernel_2menu_8c.html#a43">xxxMenuWindowProc</a>,
01903             <span class="keyword">sizeof</span>(<a class="code" href="../../d4/d3/structtagPOPUPMENU.html">PPOPUPMENU</a>),
01904             <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>,
01905             (HBRUSH)(COLOR_MENU + 1),
01906             <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a45">MENUCLASS</a>},
01907         { <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>, <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>, <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a193">FNID_SCROLLBAR</a>,
01908             CS_VREDRAW | CS_HREDRAW | CS_DBLCLKS | CS_PARENTDC,
01909             (WNDPROC)<a class="code" href="../../d8/d4/sbctl_8c.html#a47">xxxSBWndProc</a>,
01910             <span class="keyword">sizeof</span>(<a class="code" href="../../d7/d5/structtagSBWND.html">SBWND</a>) - <span class="keyword">sizeof</span>(<a class="code" href="../../d6/d9/structtagWND.html">WND</a>),
01911             <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>,
01912             <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>,
01913             <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="stringliteral">"ScrollBar"</span>},
01914         { <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>, <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>, <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a222">FNID_TOOLTIP</a>,
01915             CS_DBLCLKS | CS_SAVEBITS,
01916             (WNDPROC)<a class="code" href="../../d1/d4/tooltips_8c.html#a31">xxxTooltipWndProc</a>,
01917             <span class="keyword">sizeof</span>(<a class="code" href="../../d8/d8/structtagTOOLTIPWND.html">TOOLTIPWND</a>) - <span class="keyword">sizeof</span>(<a class="code" href="../../d6/d9/structtagWND.html">WND</a>),
01918             <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>,
01919             <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>,
01920             <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a44">TOOLTIPCLASS</a>},
01921         { <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>, <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>, <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a194">FNID_ICONTITLE</a>,
01922             0,
01923             (WNDPROC)<a class="code" href="../../d8/d3/dwp_8c.html#a17">xxxDefWindowProc</a>,
01924             0,
01925             <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>,
01926             <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>,
01927             <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a42">ICONTITLECLASS</a>},
01928         { <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>, <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>, 0,
01929             0,
01930             (WNDPROC)<a class="code" href="../../d2/d4/ddemlsvr_8h.html#a5">xxxEventWndProc</a>,
01931             <span class="keyword">sizeof</span>(<a class="code" href="../../d6/d7/structtagSVR__INSTANCE__INFO.html">PSVR_INSTANCE_INFO</a>),
01932             <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>,
01933             <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>,
01934             <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="stringliteral">"DDEMLEvent"</span>},
01935 <span class="preprocessor">#ifdef HUNGAPP_GHOSTING</span>
01936 <span class="preprocessor"></span>        { <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>, <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>, 0,
01937             0,
01938             (WNDPROC)xxxGhostWndProc,
01939             0,
01940             <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>,
01941             <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>,
01942             <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="stringliteral">"Ghost"</span>},
01943 <span class="preprocessor">#endif // HUNGAPP_GHOSTING</span>
01944 <span class="preprocessor"></span>        { <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>, <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>, 0,
01945             0,
01946             (WNDPROC)<a class="code" href="../../d8/d3/dwp_8c.html#a17">xxxDefWindowProc</a>,
01947             4,
01948             <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>,
01949             <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>,
01950             <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="stringliteral">"Message"</span>}
01951     };
01952 
01953 
01954     <span class="comment">/*</span>
01955 <span class="comment">     * All other classes are registered via the table.</span>
01956 <span class="comment">     */</span>
01957     wndcls.cbClsExtra   = 0;
01958     wndcls.hInstance    = <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a273">hModuleWin</a>;
01959     wndcls.hIcon        = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01960     wndcls.hIconSm      = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01961     wndcls.lpszMenuName = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01962 
01963     <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a3">CCLASSES</a>; i++) {
01964         <span class="keywordflow">if</span> (fSystem &amp;&amp; !rc[i].fSystem) {
01965             <span class="keywordflow">continue</span>;
01966         }
01967         wndcls.style        = rc[i].style;
01968         wndcls.lpfnWndProc  = rc[i].lpfnWndProc;
01969         wndcls.cbWndExtra   = rc[i].cbWndExtra;
01970         wndcls.hCursor      = rc[i].fNormalCursor ? <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a448">PtoH</a>(<a class="code" href="../../d4/d1/userk_8h.html#a321">SYSCUR</a>(ARROW)) : <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01971         wndcls.hbrBackground= rc[i].hbrBackground;
01972         wndcls.lpszClassName= rc[i].lpszClassName;
01973 
01974         <span class="keywordflow">if</span> (<a class="code" href="../../d4/d1/userk_8h.html#a1569">InternalRegisterClassEx</a>(&amp;wndcls,
01975                                     rc[i].fnid,
01976                                     CSF_SERVERSIDEPROC | CSF_WIN40COMPAT) == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01977             RIPMSG0(RIP_WARNING, <span class="stringliteral">"LW_RegisterWindows: InternalRegisterClassEx failed"</span>);
01978             <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01979         }
01980 
01981         <span class="keywordflow">if</span> (fSystem &amp;&amp; rc[i].fGlobalClass) {
01982             <span class="keywordflow">if</span> (<a class="code" href="../../d4/d1/userk_8h.html#a1569">InternalRegisterClassEx</a>(&amp;wndcls,
01983                                     rc[i].fnid,
01984                                     CSF_SERVERSIDEPROC | CSF_SYSTEMCLASS | CSF_WIN40COMPAT) == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01985 
01986                 RIPMSG0(RIP_WARNING, <span class="stringliteral">"LW_RegisterWindows: InternalRegisterClassEx failed"</span>);
01987                 <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01988             }
01989         }
01990     }
01991     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01992 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a60" doxytag="w32/ntuser/kernel/init.c::RegisterLPK" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID RegisterLPK           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>dwLpkEntryPoints</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l02769">2769</a> of file <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html">w32/ntuser/kernel/init.c</a>.
<p>
References <a class="el" href="../../d5/d0/userk_8h-source.html#l00084">PpiCurrent</a>, and <a class="el" href="../../d2/d7/hal_8h.html#a212">VOID()</a>.
<p>
<pre class="fragment"><div>02771 {
02772     <a class="code" href="../../d4/d1/userk_8h.html#a16">PpiCurrent</a>()-&gt;dwLpkEntryPoints = dwLpkEntryPoints;
02773 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a46" doxytag="w32/ntuser/kernel/init.c::UnloadCursorsAndIcons" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID UnloadCursorsAndIcons           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l01642">1642</a> of file <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html">w32/ntuser/kernel/init.c</a>.
<p>
References <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00392">gasyscur</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00411">gasysico</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l00084">PpiCurrent</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l02769">tagSYSCFGICO::spcur</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l07427">TRACE_HYDAPI</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00368">Unlock</a>, and <a class="el" href="../../d2/d7/hal_8h.html#a212">VOID()</a>.
<p>
Referenced by <a class="el" href="../../d7/d7/ntinput_8c-source.html#l02087">CleanupResources()</a>.
<p>
<pre class="fragment"><div>01644 {
01645     <a class="code" href="../../d6/d1/structtagCURSOR.html">PCURSOR</a> pcur;
01646     <span class="keywordtype">int</span>     ind;
01647 
01648     <a class="code" href="../../d4/d1/userk_8h.html#a777">TRACE_HYDAPI</a>((<span class="stringliteral">"UnloadCursorsAndIcons\n"</span>));
01649 
01650     <span class="comment">/*</span>
01651 <span class="comment">     * unlock the icons</span>
01652 <span class="comment">     */</span>
01653     <span class="keywordflow">for</span> (ind = 0; ind &lt; COIC_CONFIGURABLE; ind++) {
01654         pcur = <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a157">gasysico</a>[ind].<a class="code" href="../../d9/d7/structtagSYSCFGICO.html#o2">spcur</a>;
01655 
01656         <span class="keywordflow">if</span> (pcur == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
01657             <span class="keywordflow">continue</span>;
01658 
01659         pcur-&gt;head.ppi = <a class="code" href="../../d4/d1/userk_8h.html#a16">PpiCurrent</a>();
01660         <a class="code" href="../../d6/d0/usercli_8h.html#a42">Unlock</a>(&amp;gasysico[ind].spcur);
01661     }
01662 
01663     <span class="comment">/*</span>
01664 <span class="comment">     * unlock the cursors</span>
01665 <span class="comment">     */</span>
01666     <span class="keywordflow">for</span> (ind = 0; ind &lt; COCR_CONFIGURABLE; ind++) {
01667         pcur = <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a156">gasyscur</a>[ind].<a class="code" href="../../d9/d7/structtagSYSCFGICO.html#o2">spcur</a>;
01668 
01669         <span class="keywordflow">if</span> (pcur == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
01670             <span class="keywordflow">continue</span>;
01671 
01672         pcur-&gt;head.ppi = <a class="code" href="../../d4/d1/userk_8h.html#a16">PpiCurrent</a>();
01673         <a class="code" href="../../d6/d0/usercli_8h.html#a42">Unlock</a>(&amp;gasyscur[ind].spcur);
01674     }
01675 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a51" doxytag="w32/ntuser/kernel/init.c::vCheckMMInstance" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID vCheckMMInstance           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">LPWSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>pchSrch</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>DESIGNVECTOR *&nbsp;</td>
          <td class="mdname" nowrap> <em>pdv</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l02001">2001</a> of file <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html">w32/ntuser/kernel/init.c</a>.
<p>
References <a class="el" href="../../d3/d9/aw_8h-source.html#l00031">L</a>, <a class="el" href="../../d4/d8/arcinst_8c-source.html#l00065">MAX_PATH</a>, <a class="el" href="../../d5/d8/icmupg_8c-source.html#l00087">szName</a>, and <a class="el" href="../../d2/d7/hal_8h.html#a212">VOID()</a>.
<p>
Referenced by <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l02036">bEnumerateRegistryFonts()</a>.
<p>
<pre class="fragment"><div>02004 {
02005     LPWSTR  pKeyName;
02006     WCHAR   <a class="code" href="../../d4/d9/icmupg_8c.html#a20">szName</a>[<a class="code" href="../../d3/d9/arcinst_8c.html#a6">MAX_PATH</a>], *pszName = <a class="code" href="../../d4/d9/icmupg_8c.html#a20">szName</a>;
02007     WCHAR   szCannonicalName[<a class="code" href="../../d3/d9/arcinst_8c.html#a6">MAX_PATH</a>];
02008     ULONG   NumAxes;
02009 
02010     pdv-&gt;dvNumAxes = 0;
02011     pKeyName = pchSrch;
02012     <span class="keywordflow">while</span> (*pKeyName &amp;&amp; (*pKeyName++ != TEXT(<span class="charliteral">'('</span>)))
02013         ;
02014 
02015     <span class="keywordflow">if</span> (*pKeyName){
02016         <span class="keywordflow">if</span> (!_wcsicmp(pKeyName, L<span class="stringliteral">"OpenType)"</span>))
02017         {
02018             pKeyName = pchSrch;
02019             <span class="keywordflow">while</span>(*pKeyName != TEXT(<span class="charliteral">'('</span>))
02020                 *pszName++ = *pKeyName++;
02021             *pszName = 0;
02022 
02023             GreGetCannonicalName(szName, szCannonicalName, &amp;NumAxes, pdv);
02024         }
02025     }
02026 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a34" doxytag="w32/ntuser/kernel/init.c::Win32KDriverUnload" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID Win32KDriverUnload           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d4/d9/struct__DRIVER__OBJECT.html">PDRIVER_OBJECT</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>DriverObject</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l00773">773</a> of file <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html">w32/ntuser/kernel/init.c</a>.
<p>
References <a class="el" href="../../d5/d0/userk_8h-source.html#l02120">CleanupPoolAllocations</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l02122">CleanUpPoolLimitations</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l02128">CleanUpSections</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00655">CsrApiPort</a>, <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l00696">DestroyHandleTableObjects()</a>, <a class="el" href="../../d7/d2/cmwraper_8c-source.html#l00304">ExFreePool()</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00918">ghSectionShared</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00464">gpDispInfo</a>, <a class="el" href="../../d5/d7/handtabl_8c-source.html#l00209">gpHandlePages</a>, <a class="el" href="../../d2/d7/clglobal_8c-source.html#l00051">gpsi</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00921">gpvSharedAlloc</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00919">gpvSharedBase</a>, <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l00066">gpW32FastMutex</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l07390">HH_DRIVERUNLOAD</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l07391">HH_GRECLEANUP</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l07392">HH_USERKCLEANUP</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l07404">HYDRA_HINT</a>, <a class="el" href="../../d6/d5/stierr_8h-source.html#l00030">NT_SUCCESS</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d5/d9/ob_8h-source.html#l00494">ObDereferenceObject</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l02197">tagDISPLAYINFO::pdceFirst</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l03585">tagDCE::pdceNext</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00135">Status</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l07427">TRACE_HYDAPI</a>, <a class="el" href="../../d2/d7/hal_8h.html#a212">VOID()</a>, and <a class="el" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a21">Win32kNtUserCleanup()</a>.
<p>
<pre class="fragment"><div>00775 {
00776     <a class="code" href="../../d4/d1/userk_8h.html#a777">TRACE_HYDAPI</a>((<span class="stringliteral">"Win32KDriverUnload\n"</span>));
00777 
00778 <span class="preprocessor">#if DBG</span>
00779 <span class="preprocessor"></span>    <span class="comment">/*</span>
00780 <span class="comment">     * Have a try/except around the driver unload code to catch</span>
00781 <span class="comment">     * bugs. We need to do this because NtSetSystemInformation which</span>
00782 <span class="comment">     * smss calls has a try/except when calling the driver entry and</span>
00783 <span class="comment">     * the driver unload routines which does nothing but returns the</span>
00784 <span class="comment">     * status code to the caller and doesn't break in the debugger!</span>
00785 <span class="comment">     * So w/o this try/except here we wouldn't even know we hit</span>
00786 <span class="comment">     * an AV !!!</span>
00787 <span class="comment">     */</span>
00788     <span class="keywordflow">try</span> {
00789 <span class="preprocessor">#endif // DBG</span>
00790 <span class="preprocessor"></span>
00791     <a class="code" href="../../d4/d1/userk_8h.html#a773">HYDRA_HINT</a>(HH_DRIVERUNLOAD);
00792 
00793     <span class="comment">/*</span>
00794 <span class="comment">     * Cleanup all resources in GRE</span>
00795 <span class="comment">     */</span>
00796     MultiUserNtGreCleanup();
00797 
00798     <a class="code" href="../../d4/d1/userk_8h.html#a773">HYDRA_HINT</a>(HH_GRECLEANUP);
00799 
00800     <span class="comment">/*</span>
00801 <span class="comment">     * BUG 305965. There might be cases when we end up with DCEs still</span>
00802 <span class="comment">     * in the list. Go ahead and clean it up here.</span>
00803 <span class="comment">     */</span>
00804     <span class="keywordflow">if</span> (<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a179">gpDispInfo</a> != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> &amp;&amp; <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a179">gpDispInfo</a>-&gt;<a class="code" href="../../d9/d3/structtagDISPLAYINFO.html#o9">pdceFirst</a> != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00805 
00806         <a class="code" href="../../d3/d2/structtagDCE.html">PDCE</a> pdce;
00807         <a class="code" href="../../d3/d2/structtagDCE.html">PDCE</a> pdceNext;
00808 
00809         RIPMSG0(RIP_ERROR, <span class="stringliteral">"Win32KDriverUnload: the DCE list is not empty !"</span>);
00810 
00811         pdce = <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a179">gpDispInfo</a>-&gt;<a class="code" href="../../d9/d3/structtagDISPLAYINFO.html#o9">pdceFirst</a>;
00812 
00813         <span class="keywordflow">while</span> (pdce != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00814             pdceNext = pdce-&gt;<a class="code" href="../../d3/d2/structtagDCE.html#o0">pdceNext</a>;
00815 
00816             UserFreePool(pdce);
00817 
00818             pdce = pdceNext;
00819         }
00820         <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a179">gpDispInfo</a>-&gt;<a class="code" href="../../d9/d3/structtagDISPLAYINFO.html#o9">pdceFirst</a> = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00821     }
00822 
00823     <span class="comment">/*</span>
00824 <span class="comment">     * Cleanup all resources in ntuser</span>
00825 <span class="comment">     */</span>
00826     <a class="code" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a21">Win32kNtUserCleanup</a>();
00827 
00828     <span class="comment">/*</span>
00829 <span class="comment">     * Cleanup the handle table for any object that is neither process</span>
00830 <span class="comment">     * owned nor thread owned</span>
00831 <span class="comment">     */</span>
00832     <a class="code" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a33">DestroyHandleTableObjects</a>();
00833 
00834 
00835     <a class="code" href="../../d4/d1/userk_8h.html#a773">HYDRA_HINT</a>(HH_USERKCLEANUP);
00836 
00837 <span class="preprocessor">#if DBG</span>
00838 <span class="preprocessor"></span>    HMCleanUpHandleTable();
00839 <span class="preprocessor">#endif</span>
00840 <span class="preprocessor"></span>
00841     <span class="comment">/*</span>
00842 <span class="comment">     * Free the handle page array</span>
00843 <span class="comment">     */</span>
00844 
00845     <span class="keywordflow">if</span> (<a class="code" href="../../d4/d8/handtabl_8c.html#a8">gpHandlePages</a> != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00846         UserFreePool(gpHandlePages);
00847         <a class="code" href="../../d4/d8/handtabl_8c.html#a8">gpHandlePages</a> = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00848     }
00849 
00850     <span class="keywordflow">if</span> (<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a243">CsrApiPort</a> != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00851         <a class="code" href="../../d4/d0/ob_8h.html#a14">ObDereferenceObject</a>(CsrApiPort);
00852         <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a243">CsrApiPort</a> = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00853     }
00854 
00855     <span class="comment">/*</span>
00856 <span class="comment">     * destroy the shared memory</span>
00857 <span class="comment">     */</span>
00858     <span class="keywordflow">if</span> (<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a320">ghSectionShared</a> != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00859 
00860         <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
00861 
00862         <span class="comment">/*</span>
00863 <span class="comment">         * Set gpsi to NULL</span>
00864 <span class="comment">         */</span>
00865         <a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a> = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00866 
00867         <span class="keywordflow">if</span> (<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a321">gpvSharedBase</a> != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00868             Win32HeapDestroy(gpvSharedAlloc);
00869             <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = Win32UnmapViewInSessionSpace(gpvSharedBase);
00870             UserAssert(<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status));
00871         }
00872         Win32DestroySection(ghSectionShared);
00873     }
00874 
00875     CleanupWin32HeapStubs();
00876 
00877 <span class="preprocessor">#ifdef TRACE_MAP_VIEWS</span>
00878 <span class="preprocessor"></span><span class="preprocessor">#if DBG</span>
00879 <span class="preprocessor"></span>    UserAssert(gpSections == NULL);
00880 <span class="preprocessor">#else</span>
00881 <span class="preprocessor"></span>    <span class="keywordflow">if</span> (gpSections != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00882         DbgBreakPoint();
00883     }
00884 <span class="preprocessor">#endif // DBG</span>
00885 <span class="preprocessor"></span><span class="preprocessor">#endif // TRACE_MAP_VIEWS</span>
00886 <span class="preprocessor"></span>
00887     <span class="comment">/*</span>
00888 <span class="comment">     * Cleanup all the user pool allocations by hand</span>
00889 <span class="comment">     */</span>
00890     <a class="code" href="../../d4/d1/userk_8h.html#a218">CleanupPoolAllocations</a>();
00891 
00892     <a class="code" href="../../d4/d1/userk_8h.html#a220">CleanUpPoolLimitations</a>();
00893     <a class="code" href="../../d4/d1/userk_8h.html#a222">CleanUpSections</a>();
00894 
00895     <span class="comment">/*</span>
00896 <span class="comment">     * Cleanup W32 structures.</span>
00897 <span class="comment">     */</span>
00898     <span class="keywordflow">if</span> (<a class="code" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a18">gpW32FastMutex</a> != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00899         <a class="code" href="../../d5/d8/ex_8h.html#a224">ExFreePool</a>(gpW32FastMutex);
00900         <a class="code" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a18">gpW32FastMutex</a> = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00901     }
00902 
00903 <span class="preprocessor">#if DBG</span>
00904 <span class="preprocessor"></span>    } except (DriverUnloadExceptionHandler(GetExceptionInformation())) {
00905         DbgBreakPoint();
00906     }
00907 <span class="preprocessor">#endif // DBG</span>
00908 <span class="preprocessor"></span>
00909     <span class="keywordflow">return</span>;
00910     UNREFERENCED_PARAMETER(DriverObject);
00911 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a26" doxytag="w32/ntuser/kernel/init.c::Win32kNtUserCleanup" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL Win32kNtUserCleanup           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l00097">97</a> of file <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html">w32/ntuser/kernel/init.c</a>.
<p>
References <a class="el" href="../../d5/d0/userk_8h-source.html#l02442">tagSMWP::acvr</a>, <a class="el" href="../../d6/d8/w32_2ntuser_2kernel_2pnp_8c-source.html#l00017">aDeviceTemplate</a>, <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l00026">apObjects</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l07417">DbgDumpTrackedDesktops</a>, <a class="el" href="../../d8/d1/power_8c-source.html#l00250">DeletePowerRequestList()</a>, <a class="el" href="../../d7/d1/kbdlyout_8c-source.html#l01688">DestroyKL()</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l01896">DEVICE_TYPE_MAX</a>, <a class="el" href="../../d8/d0/usersrv_8h-source.html#l00201">EnterCrit</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l07254">EnterDeviceInfoListCrit()</a>, <a class="el" href="../../d0/d5/ex_2lookasid_8c-source.html#l00629">ExDeletePagedLookasideList()</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02478">ExDeleteResource</a>, <a class="el" href="../../d7/d2/cmwraper_8c-source.html#l00304">ExFreePool()</a>, <a class="el" href="../../d7/d2/queue_8c-source.html#l02193">FreeCachedQueues()</a>, <a class="el" href="../../d7/d7/ntinput_8c-source.html#l00313">FreeDeviceInfo()</a>, <a class="el" href="../../d2/d9/imehotky_8c-source.html#l00252">FreeImeHotKeys()</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l00126">FreeKernelEvent()</a>, <a class="el" href="../../d7/d2/queue_8c-source.html#l02168">FreeQueue()</a>, <a class="el" href="../../d4/d5/kernel_2sendmsg_8c-source.html#l00178">FreeSMS()</a>, <a class="el" href="../../d5/d1/timers_8c-source.html#l00112">FreeTimer()</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l01906">GDIAF_PNPWAITING</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l01912">GDIF_READING</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00597">gHardErrorHandler</a>, <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l00032">glpSetupPrograms</a>, <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l00031">gpastrSetupExe</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00231">gpbwlList</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00522">gpDeviceInfoList</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00077">gpEventDiconnectDesktop</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00958">gpevtDesktopDestroyed</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00758">gpHandleFlagsMutex</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00458">gpkeMouseData</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00658">gpkfList</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00943">gpRemoteBeepDevice</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00523">gpresDeviceInfoList</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00537">gpresMouseEventQueue</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00757">gpresUser</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00445">gpScancodeMap</a>, <a class="el" href="../../d2/d9/kernel_2exitwin_8c-source.html#l00026">gpsdInitWinSta</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00643">gpsmsList</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00030">gpszWall</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00455">gptiRit</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00666">gptmrFirst</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00667">gptmrMaster</a>, <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l00029">gptmrWD</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00477">gpvwplHungRedraw</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00690">gpWinEventHooks</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00093">gpwtiFirst</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00332">gSMWP</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00164">gspklBaseLayout</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00970">gThinwireFileObject</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00969">gVideoFileObject</a>, <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l00027">gWaitBlockArray</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l07398">HH_KBDLYOUTGLOBALCLEANUP</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01477">HMIsMarkDestroy</a>, <a class="el" href="../../d5/d7/handtabl_8c-source.html#l01237">HMMarkObjectDestroy()</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l07404">HYDRA_HINT</a>, <a class="el" href="../../d4/d1/timerobj_8c-source.html#l00157">KeCancelTimer()</a>, <a class="el" href="../../d8/d0/usersrv_8h-source.html#l00202">LeaveCrit</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l07258">LeaveDeviceInfoListCrit()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d5/d9/ob_8h-source.html#l00494">ObDereferenceObject</a>, <a class="el" href="../../d5/d6/enumwin_8c-source.html#l00017">pbwlCache</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l01950">tagDEVICE_TEMPLATE::pkeHidChange</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l02505">tagKL::pklNext</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l01987">tagHARDERRORHANDLER::pqAttach</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l03297">PSMS</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l03157">tagWOWTHREADINFO::pwtiNext</a>, <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l00092">QEntryLookaside</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l03129">tagQ::QF_flags</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l03019">QF_INDESTROY</a>, <a class="el" href="../../d1/d9/rtl_2atom_8c-source.html#l00304">RtlDestroyAtomTable()</a>, <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l00091">SMSLookaside</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l07427">TRACE_HYDAPI</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00368">Unlock</a>, and <a class="el" href="../../d2/d9/w32_2ntuser_2kernel_2atom_8c-source.html#l00015">UserAtomTableHandle</a>.
<p>
<pre class="fragment"><div>00099 {
00100     <span class="keywordtype">int</span> i;
00101 
00102     <a class="code" href="../../d4/d1/userk_8h.html#a777">TRACE_HYDAPI</a>((<span class="stringliteral">"Win32kNtUserCleanup: Cleanup Resources\n"</span>));
00103 
00104     <a class="code" href="../../d7/d1/usersrv_8h.html#a36">EnterCrit</a>();
00105 
00106     <a class="code" href="../../d4/d1/userk_8h.html#a776">DbgDumpTrackedDesktops</a>(TRUE);
00107 
00108     <span class="comment">/*</span>
00109 <span class="comment">     * Anything in this list must be cleaned up when threads go away.</span>
00110 <span class="comment">     */</span>
00111     UserAssert(gpbwlList == NULL);
00112 
00113     UserAssert(gpWinEventHooks == NULL);
00114 
00115     UserAssert(gpScancodeMap == NULL);
00116 
00117     <span class="comment">/*</span>
00118 <span class="comment">     * Free IME hotkeys</span>
00119 <span class="comment">     */</span>
00120     <a class="code" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a25">FreeImeHotKeys</a>();
00121 
00122     <span class="comment">/*</span>
00123 <span class="comment">     * Free the wallpaper name string</span>
00124 <span class="comment">     */</span>
00125     <span class="keywordflow">if</span> (<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a6">gpszWall</a> != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00126         UserFreePool(gpszWall);
00127         <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a6">gpszWall</a> = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00128     }
00129     <span class="comment">/*</span>
00130 <span class="comment">     * Free the hung redraw stuff</span>
00131 <span class="comment">     */</span>
00132     <span class="keywordflow">if</span> (<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a182">gpvwplHungRedraw</a> != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00133         UserFreePool(gpvwplHungRedraw);
00134         <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a182">gpvwplHungRedraw</a> = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00135     }
00136 
00137     <span class="comment">/*</span>
00138 <span class="comment">     * Free the arrary of setup app names</span>
00139 <span class="comment">     */</span>
00140     <span class="keywordflow">if</span> (<a class="code" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a8">gpastrSetupExe</a>) {
00141         UserFreePool(gpastrSetupExe);
00142         <a class="code" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a8">gpastrSetupExe</a> = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00143     }
00144 
00145     <span class="keywordflow">if</span> (<a class="code" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a9">glpSetupPrograms</a>) {
00146         UserFreePool(glpSetupPrograms);
00147         <a class="code" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a9">glpSetupPrograms</a> = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00148     }
00149 
00150     <span class="comment">/*</span>
00151 <span class="comment">     * Free the cached window list</span>
00152 <span class="comment">     */</span>
00153     <span class="keywordflow">if</span> (<a class="code" href="../../d4/d7/enumwin_8c.html#a2">pbwlCache</a> != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00154         UserFreePool(pbwlCache);
00155         <a class="code" href="../../d4/d7/enumwin_8c.html#a2">pbwlCache</a> = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00156     }
00157 
00158     <span class="comment">/*</span>
00159 <span class="comment">     * Free outstanding timers</span>
00160 <span class="comment">     */</span>
00161     <span class="keywordflow">while</span> (<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a247">gptmrFirst</a> != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00162         <a class="code" href="../../d4/d1/userk_8h.html#a1045">FreeTimer</a>(gptmrFirst);
00163     }
00164 
00165     <span class="keywordflow">if</span> (<a class="code" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a7">gptmrWD</a>) {
00166         <a class="code" href="../../d3/d2/timerobj_8c.html#a4">KeCancelTimer</a>(gptmrWD);
00167         UserFreePool(gptmrWD);
00168         <a class="code" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a7">gptmrWD</a> = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00169     }
00170 
00171     <span class="keywordflow">if</span> (<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a248">gptmrMaster</a>) {
00172         <a class="code" href="../../d3/d2/timerobj_8c.html#a4">KeCancelTimer</a>(gptmrMaster);
00173         UserFreePool(gptmrMaster);
00174         <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a248">gptmrMaster</a> = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00175     }
00176 
00177     <span class="comment">/*</span>
00178 <span class="comment">     * Cleanup mouse &amp; kbd change events</span>
00179 <span class="comment">     */</span>
00180     <span class="keywordflow">for</span> (i = 0; i &lt;= <a class="code" href="../../d4/d1/userk_8h.html#a177">DEVICE_TYPE_MAX</a>; i++) {
00181         UserAssert(gptiRit == NULL);
00182         <span class="keywordflow">if</span> (<a class="code" href="../../d5/d9/w32_2ntuser_2kernel_2pnp_8c.html#a2">aDeviceTemplate</a>[i].<a class="code" href="../../d4/d3/structtagDEVICE__TEMPLATE.html#o12">pkeHidChange</a>) {
00183             <a class="code" href="../../d4/d1/userk_8h.html#a967">FreeKernelEvent</a>(&amp;aDeviceTemplate[i].pkeHidChange);
00184         }
00185     }
00186 
00187     <a class="code" href="../../d4/d1/userk_8h.html#a2065">EnterDeviceInfoListCrit</a>();
00188     <span class="keywordflow">while</span> (<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a205">gpDeviceInfoList</a>) {
00189         <span class="comment">/*</span>
00190 <span class="comment">         * Assert that there is no outstanding read or PnP thread waiting</span>
00191 <span class="comment">         * in RequestDeviceChanges() for this device.</span>
00192 <span class="comment">         * Clear these flags anyway, to force the free.</span>
00193 <span class="comment">         */</span>
00194         UserAssert((<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a205">gpDeviceInfoList</a>-&gt;bFlags &amp; GDIF_READING) == 0);
00195         UserAssert((<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a205">gpDeviceInfoList</a>-&gt;usActions &amp; GDIAF_PNPWAITING) == 0);
00196         <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a205">gpDeviceInfoList</a>-&gt;bFlags &amp;= ~<a class="code" href="../../d4/d1/userk_8h.html#a189">GDIF_READING</a>;
00197         <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a205">gpDeviceInfoList</a>-&gt;usActions &amp;= ~<a class="code" href="../../d4/d1/userk_8h.html#a185">GDIAF_PNPWAITING</a>;
00198         <a class="code" href="../../d4/d1/userk_8h.html#a1032">FreeDeviceInfo</a>(gpDeviceInfoList);
00199     }
00200     <a class="code" href="../../d4/d1/userk_8h.html#a2066">LeaveDeviceInfoListCrit</a>();
00201 
00202     <span class="comment">/*</span>
00203 <span class="comment">     * Cleanup object references</span>
00204 <span class="comment">     */</span>
00205     <span class="keywordflow">if</span> (<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a353">gThinwireFileObject</a>)
00206         <a class="code" href="../../d4/d0/ob_8h.html#a14">ObDereferenceObject</a>(gThinwireFileObject);
00207 
00208     <span class="keywordflow">if</span> (<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a352">gVideoFileObject</a>)
00209         <a class="code" href="../../d4/d0/ob_8h.html#a14">ObDereferenceObject</a>(gVideoFileObject);
00210 
00211     <span class="keywordflow">if</span> (<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a336">gpRemoteBeepDevice</a>)
00212         <a class="code" href="../../d4/d0/ob_8h.html#a14">ObDereferenceObject</a>(gpRemoteBeepDevice);
00213 
00214     <span class="comment">/*</span>
00215 <span class="comment">     * Cleanup our resources. There should be no threads in here</span>
00216 <span class="comment">     * when we get called.</span>
00217 <span class="comment">     */</span>
00218     <span class="keywordflow">if</span> (<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a212">gpresMouseEventQueue</a>) {
00219         <a class="code" href="../../d5/d8/ex_8h.html#a73">ExDeleteResource</a>(gpresMouseEventQueue);
00220         <a class="code" href="../../d5/d8/ex_8h.html#a224">ExFreePool</a>(gpresMouseEventQueue);
00221         <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a212">gpresMouseEventQueue</a> = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00222     }
00223 
00224     <span class="keywordflow">if</span> (<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a206">gpresDeviceInfoList</a>) {
00225         <a class="code" href="../../d5/d8/ex_8h.html#a73">ExDeleteResource</a>(gpresDeviceInfoList);
00226         <a class="code" href="../../d5/d8/ex_8h.html#a224">ExFreePool</a>(gpresDeviceInfoList);
00227         <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a206">gpresDeviceInfoList</a> = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00228     }
00229 
00230     <span class="keywordflow">if</span> (<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a177">gpkeMouseData</a> != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00231         <a class="code" href="../../d4/d1/userk_8h.html#a967">FreeKernelEvent</a>(&amp;gpkeMouseData);
00232     }
00233 
00234     <span class="keywordflow">if</span> (<a class="code" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a4">apObjects</a>) {
00235         UserFreePool(apObjects);
00236         <a class="code" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a4">apObjects</a> = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00237     }
00238 
00239     <span class="keywordflow">if</span> (<a class="code" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a5">gWaitBlockArray</a>) {
00240         UserFreePool(gWaitBlockArray);
00241         <a class="code" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a5">gWaitBlockArray</a> = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00242     }
00243 
00244     <span class="keywordflow">if</span> (<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a19">gpEventDiconnectDesktop</a> != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00245         <a class="code" href="../../d4/d1/userk_8h.html#a967">FreeKernelEvent</a>(&amp;gpEventDiconnectDesktop);
00246     }
00247 
00248     <span class="keywordflow">if</span> (<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a346">gpevtDesktopDestroyed</a> != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00249         <a class="code" href="../../d4/d1/userk_8h.html#a967">FreeKernelEvent</a>(&amp;gpevtDesktopDestroyed);
00250     }
00251 
00252     <span class="keywordflow">if</span> (<a class="code" href="../../d1/d0/w32_2ntuser_2kernel_2atom_8c.html#a0">UserAtomTableHandle</a> != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00253         <a class="code" href="../../d0/d0/rtl_2atom_8c.html#a14">RtlDestroyAtomTable</a>(UserAtomTableHandle);
00254         <a class="code" href="../../d1/d0/w32_2ntuser_2kernel_2atom_8c.html#a0">UserAtomTableHandle</a> = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00255     }
00256 
00257     <span class="comment">/*</span>
00258 <span class="comment">     * cleanup the SMS lookaside buffer</span>
00259 <span class="comment">     */</span>
00260     {
00261         <a class="code" href="../../d4/d1/userk_8h.html#a871">PSMS</a> psmsNext;
00262 
00263         <span class="keywordflow">while</span> (<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a238">gpsmsList</a> != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00264             psmsNext = <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a238">gpsmsList</a>-&gt;psmsNext;
00265             UserAssert(<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a238">gpsmsList</a>-&gt;spwnd == NULL);
00266             <a class="code" href="../../d3/d6/kernel_2sendmsg_8c.html#a16">FreeSMS</a>(gpsmsList);
00267             <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a238">gpsmsList</a> = psmsNext;
00268         }
00269 
00270         <span class="keywordflow">if</span> (<a class="code" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a19">SMSLookaside</a> != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00271             <a class="code" href="../../d5/d8/ex_8h.html#a251">ExDeletePagedLookasideList</a>(SMSLookaside);
00272             UserFreePool(SMSLookaside);
00273             <a class="code" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a19">SMSLookaside</a> = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00274         }
00275     }
00276 
00277     <span class="comment">/*</span>
00278 <span class="comment">     * Let go of the attached queue for hard error handling.</span>
00279 <span class="comment">     * Do this before we free the Qlookaside !</span>
00280 <span class="comment">     */</span>
00281     <span class="keywordflow">if</span> (<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a227">gHardErrorHandler</a>.<a class="code" href="../../d2/d6/structtagHARDERRORHANDLER.html#o1">pqAttach</a> != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00282 
00283         UserAssert(<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a227">gHardErrorHandler</a>.<a class="code" href="../../d2/d6/structtagHARDERRORHANDLER.html#o1">pqAttach</a> &gt; 0);
00284         UserAssert(<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a227">gHardErrorHandler</a>.<a class="code" href="../../d2/d6/structtagHARDERRORHANDLER.html#o1">pqAttach</a>-&gt;<a class="code" href="../../d7/d4/structtagQ.html#o21">QF_flags</a> &amp; QF_INDESTROY);
00285 
00286         <a class="code" href="../../d4/d1/userk_8h.html#a1205">FreeQueue</a>(<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a227">gHardErrorHandler</a>.<a class="code" href="../../d2/d6/structtagHARDERRORHANDLER.html#o1">pqAttach</a>);
00287         <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a227">gHardErrorHandler</a>.<a class="code" href="../../d2/d6/structtagHARDERRORHANDLER.html#o1">pqAttach</a> = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00288     }
00289 
00290     <span class="comment">/*</span>
00291 <span class="comment">     * Free the cached array of queues</span>
00292 <span class="comment">     */</span>
00293     <a class="code" href="../../d4/d1/userk_8h.html#a1206">FreeCachedQueues</a>();
00294 
00295     <span class="comment">/*</span>
00296 <span class="comment">     * cleanup the QEntry lookaside buffer</span>
00297 <span class="comment">     */</span>
00298     <span class="keywordflow">if</span> (<a class="code" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a20">QEntryLookaside</a> != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00299         <a class="code" href="../../d5/d8/ex_8h.html#a251">ExDeletePagedLookasideList</a>(QEntryLookaside);
00300         UserFreePool(QEntryLookaside);
00301         <a class="code" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a20">QEntryLookaside</a> = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00302     }
00303 
00304     <span class="comment">/*</span>
00305 <span class="comment">     * Unlock the keyboard layouts</span>
00306 <span class="comment">     */</span>
00307     <span class="keywordflow">if</span> (<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a62">gspklBaseLayout</a> != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00308 
00309         <a class="code" href="../../d4/d9/structtagKL.html">PKL</a> pkl;
00310         <a class="code" href="../../d4/d9/structtagKL.html">PKL</a> pklNext;
00311 
00312         pkl = <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a62">gspklBaseLayout</a>-&gt;<a class="code" href="../../d4/d9/structtagKL.html#o1">pklNext</a>;
00313 
00314         <span class="keywordflow">while</span> (pkl-&gt;<a class="code" href="../../d4/d9/structtagKL.html#o1">pklNext</a> != pkl) {
00315             pklNext = pkl-&gt;<a class="code" href="../../d4/d9/structtagKL.html#o1">pklNext</a>;
00316 
00317             <a class="code" href="../../d4/d1/userk_8h.html#a1184">DestroyKL</a>(pkl);
00318 
00319             pkl = pklNext;
00320         }
00321 
00322         UserAssert(pkl == gspklBaseLayout);
00323 
00324         <span class="keywordflow">if</span> (!<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a438">HMIsMarkDestroy</a>(gspklBaseLayout)) {
00325             <a class="code" href="../../d4/d1/userk_8h.html#a971">HMMarkObjectDestroy</a>(gspklBaseLayout);
00326         }
00327 
00328         <a class="code" href="../../d4/d1/userk_8h.html#a773">HYDRA_HINT</a>(HH_KBDLYOUTGLOBALCLEANUP);
00329 
00330         <span class="keywordflow">if</span> (<a class="code" href="../../d6/d0/usercli_8h.html#a42">Unlock</a>(&amp;gspklBaseLayout)) {
00331             <a class="code" href="../../d4/d1/userk_8h.html#a1184">DestroyKL</a>(pkl);
00332         }
00333     }
00334 
00335     UserAssert(gpkfList == NULL);
00336 
00337     {
00338         <a class="code" href="../../d8/d9/structtagWOWTHREADINFO.html">PWOWTHREADINFO</a> pwti;
00339 
00340         <span class="comment">/*</span>
00341 <span class="comment">         * Cleanup gpwtiFirst list. This list is supposed to be empty</span>
00342 <span class="comment">         * at this point. In one case during stress we hit the case where</span>
00343 <span class="comment">         * it was not empty. The assert is to catch that case in</span>
00344 <span class="comment">         * checked builds.</span>
00345 <span class="comment">         */</span>
00346 
00347         <span class="keywordflow">while</span> (<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a27">gpwtiFirst</a> != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00348             pwti = <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a27">gpwtiFirst</a>;
00349             <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a27">gpwtiFirst</a> = pwti-&gt;<a class="code" href="../../d8/d9/structtagWOWTHREADINFO.html#o0">pwtiNext</a>;
00350             UserFreePool(pwti);
00351         }
00352     }
00353 
00354     <span class="comment">/*</span>
00355 <span class="comment">     * Cleanup cached SMWP array</span>
00356 <span class="comment">     */</span>
00357     <span class="keywordflow">if</span> (<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a149">gSMWP</a>.<a class="code" href="../../d8/d6/structtagSMWP.html#o5">acvr</a> != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00358         UserFreePool(<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a149">gSMWP</a>.<a class="code" href="../../d8/d6/structtagSMWP.html#o5">acvr</a>);
00359     }
00360 
00361     <span class="comment">/*</span>
00362 <span class="comment">     * Free gpsdInitWinSta. This is != NULL only if the session didn't</span>
00363 <span class="comment">     * make it to UserInitialize.</span>
00364 <span class="comment">     */</span>
00365     <span class="keywordflow">if</span> (<a class="code" href="../../d1/d0/kernel_2exitwin_8c.html#a5">gpsdInitWinSta</a> != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00366         UserFreePool(gpsdInitWinSta);
00367         <a class="code" href="../../d1/d0/kernel_2exitwin_8c.html#a5">gpsdInitWinSta</a> = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00368     }
00369 
00370     <span class="keywordflow">if</span> (<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a279">gpHandleFlagsMutex</a> != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00371         <a class="code" href="../../d5/d8/ex_8h.html#a224">ExFreePool</a>(gpHandleFlagsMutex);
00372         <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a279">gpHandleFlagsMutex</a> = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00373     }
00374 
00375     <span class="comment">/*</span>
00376 <span class="comment">     * Delete the power request structures.</span>
00377 <span class="comment">     */</span>
00378     <a class="code" href="../../d4/d1/userk_8h.html#a1968">DeletePowerRequestList</a>();
00379 
00380     <a class="code" href="../../d7/d1/usersrv_8h.html#a37">LeaveCrit</a>();
00381 
00382     <span class="keywordflow">if</span> (<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a278">gpresUser</a> != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00383         <a class="code" href="../../d5/d8/ex_8h.html#a73">ExDeleteResource</a>(gpresUser);
00384         <a class="code" href="../../d5/d8/ex_8h.html#a224">ExFreePool</a>(gpresUser);
00385         <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a278">gpresUser</a> = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00386     }
00387 <span class="preprocessor">#if DBG</span>
00388 <span class="preprocessor"></span>    <span class="comment">/*</span>
00389 <span class="comment">     * Cleanup the global thread lock structures</span>
00390 <span class="comment">     */</span>
00391     <span class="keywordflow">for</span> (i = 0; i &lt; gcThreadLocksArraysAllocated; i++) {
00392         UserFreePool(gpaThreadLocksArrays[i]);
00393         gpaThreadLocksArrays[i] = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00394     }
00395 <span class="preprocessor">#endif // DBG</span>
00396 <span class="preprocessor"></span>
00397     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00398 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a21" doxytag="w32/ntuser/kernel/init.c::Win32kNtUserCleanup" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL Win32kNtUserCleanup           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l00773">Win32KDriverUnload()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a23" doxytag="w32/ntuser/kernel/init.c::Win32UserInitialize" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS Win32UserInitialize           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l02249">2249</a> of file <a class="el" href="../../d0/d6/kernel_2server_8c-source.html">kernel/server.c</a>.
<p>
References <a class="el" href="../../d3/d7/swp_8c-source.html#l00203">AllocateCvr()</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00791">atomUSER32</a>, <a class="el" href="../../d5/d9/ob_8h-source.html#l00178">_OBJECT_TYPE_INITIALIZER::CloseProcedure</a>, <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l01559">CreateSetupNameArray()</a>, <a class="el" href="../../d5/d9/ob_8h-source.html#l00175">_OBJECT_TYPE_INITIALIZER::DefaultNonPagedPoolCharge</a>, <a class="el" href="../../d5/d9/ob_8h-source.html#l00174">_OBJECT_TYPE_INITIALIZER::DefaultPagedPoolCharge</a>, <a class="el" href="../../d5/d9/ob_8h-source.html#l00179">_OBJECT_TYPE_INITIALIZER::DeleteProcedure</a>, <a class="el" href="../../d4/d1/userk_8h.html#a835">DESKTOP</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00823">DesktopMapping</a>, <a class="el" href="../../d4/d1/userk_8h.html#a1285">DestroyWindowStation()</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l01300">tagSERVERINFO::dwDefaultHeapSize</a>, <a class="el" href="../../d8/d0/usersrv_8h-source.html#l00201">EnterCrit</a>, <a class="el" href="../../d2/d6/w32_2ntuser_2kernel_2profile_8c-source.html#l00575">FastGetProfileDwordW()</a>, <a class="el" href="../../d0/d6/desktop_8c-source.html#l02535">FreeDesktop()</a>, <a class="el" href="../../d4/d1/userk_8h.html#a1286">FreeWindowStation()</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00768">gatomFirstPinned</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00938">gbSecureDesktop</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00038">gDrawVersionAlways</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00851">gdwDesktopSectionSize</a>, <a class="el" href="../../d5/d9/ob_8h-source.html#l00168">_OBJECT_TYPE_INITIALIZER::GenericMapping</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00044">gfUnsignedDrivers</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00464">gpDispInfo</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00795">gpepInit</a>, <a class="el" href="../../d2/d7/clglobal_8c-source.html#l00051">gpsi</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00919">gpvSharedBase</a>, <a class="el" href="../../d2/d7/clglobal_8c-source.html#l00052">gSharedInfo</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00332">gSMWP</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00685">gUserPostMessageLimit</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00678">gUserProcessHandleQuota</a>, <a class="el" href="../../d5/d7/handtabl_8c-source.html#l00575">HMInitHandleTable()</a>, <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l01229">InitCreateSharedSection()</a>, <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l01471">InitCreateUserSubsystem()</a>, <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l00975">InitFunctionTables()</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l06830">INITIAL_USER_HANDLE_QUOTA</a>, <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l01049">InitMessageTables()</a>, <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l01087">InitOLEFormats()</a>, <a class="el" href="../../d7/d2/queue_8c-source.html#l03169">InitQEntryLookaside()</a>, <a class="el" href="../../d8/d4/w32_2ntuser_2kernel_2security_8c-source.html#l00152">InitSecurity()</a>, <a class="el" href="../../d4/d5/kernel_2sendmsg_8c-source.html#l00137">InitSMSLookaside()</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00590">IS_DBCS_ENABLED</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00591">IS_IME_ENABLED</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00598">IS_MIDEAST_ENABLED</a>, <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l02118">IsDBCSEnabledSystem()</a>, <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l02125">IsIMMEnabledSystem()</a>, <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l02135">IsMidEastEnabledSystem()</a>, <a class="el" href="../../d3/d9/aw_8h-source.html#l00031">L</a>, <a class="el" href="../../d8/d0/usersrv_8h-source.html#l00202">LeaveCrit</a>, <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l01422">LW_LoadSomeStrings()</a>, <a class="el" href="../../d5/d9/ob_8h-source.html#l00171">_OBJECT_TYPE_INITIALIZER::MaintainHandleCount</a>, <a class="el" href="../../d0/d6/desktop_8c-source.html#l02836">MapDesktop()</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l06834">MINIMUM_POSTMESSAGE_LIMIT</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l06831">MINIMUM_USER_HANDLE_QUOTA</a>, <a class="el" href="../../d6/d5/stierr_8h-source.html#l00030">NT_SUCCESS</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d0/d6/desktop_8c-source.html#l03089">OkayToCloseDesktop()</a>, <a class="el" href="../../d5/d9/ob_8h-source.html#l00183">_OBJECT_TYPE_INITIALIZER::OkayToCloseProcedure</a>, <a class="el" href="../../d4/d1/userk_8h.html#a1288">OkayToCloseWindowStation()</a>, <a class="el" href="../../d5/d9/ob_8h-source.html#l00177">_OBJECT_TYPE_INITIALIZER::OpenProcedure</a>, <a class="el" href="../../d5/d9/ob_8h-source.html#l00180">_OBJECT_TYPE_INITIALIZER::ParseProcedure</a>, <a class="el" href="../../d4/d1/userk_8h.html#a1287">ParseWindowStation()</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01279">tagSHAREDINFO::pDispInfo</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l06841">PMAP_WINDOWSM</a>, <a class="el" href="../../d2/d8/ps_8h-source.html#l00643">PsGetCurrentProcess</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01277">tagSHAREDINFO::psi</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01166">RIPF_DEFAULT</a>, <a class="el" href="../../d5/d6/rtl_2regutil_8c-source.html#l01257">RtlCheckRegistryKey()</a>, <a class="el" href="../../d0/d0/client_2nt6_2user_8h.html#a999">SERVERINFO</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00155">SET_FLAG</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01154">SET_OR_CLEAR_SRVIF</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01152">SET_SRVIF</a>, <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l02151">SetupClassAtoms()</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l02137">SharedAlloc()</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01144">SRVIF_CHECKED</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01146">SRVIF_DBCS</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01147">SRVIF_IME</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01148">SRVIF_MIDEAST</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00135">Status</a>, <a class="el" href="../../d2/d7/clglobal_8c-source.html#l00063">szUSER32</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l01116">TRACE_INIT</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d0/d6/desktop_8c-source.html#l03017">UnmapDesktop()</a>, <a class="el" href="../../d2/d9/w32_2ntuser_2kernel_2atom_8c-source.html#l00035">UserAddAtom()</a>, <a class="el" href="../../d4/d1/userk_8h.html#a1296">UserRtlCreateAtomTable()</a>, <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l00052">USRINIT_ATOMBUCKET_SIZE</a>, <a class="el" href="../../d5/d9/ob_8h-source.html#l00169">_OBJECT_TYPE_INITIALIZER::ValidAccessMask</a>, <a class="el" href="../../d9/d6/kernel_2server_8c.html#a57">VerifySyncOnlyMessages()</a>, <a class="el" href="../../d4/d1/userk_8h.html#a838">WINDOWSTATION</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00805">WinStaMapping</a>, and <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l01265">tagSERVERINFO::wRIPFlags</a>.
<p>
<pre class="fragment"><div>02250 {
02251     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>                 <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
02252     <a class="code" href="../../d5/d6/struct__OBJECT__TYPE__INITIALIZER.html">POBJECT_TYPE_INITIALIZER</a> pTypeInfo;
02253     LONG                     lTemp;
02254 
02255     <a class="code" href="../../d4/d1/userk_8h.html#a91">TRACE_INIT</a>((<span class="stringliteral">"Entering Win32UserInitialize\n"</span>));
02256 
02257     <span class="comment">/*</span>
02258 <span class="comment">     * Create the shared section.</span>
02259 <span class="comment">     */</span>
02260     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d9/d6/kernel_2server_8c.html#a51">InitCreateSharedSection</a>();
02261     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status)) {
02262         RIPMSG0(RIP_WARNING, <span class="stringliteral">"InitCreateSharedSection failed"</span>);
02263         <span class="keywordflow">return</span> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
02264     }
02265 
02266     <a class="code" href="../../d7/d1/usersrv_8h.html#a36">EnterCrit</a>();
02267 
02268     <span class="comment">/*</span>
02269 <span class="comment">     * Initialize security stuff.</span>
02270 <span class="comment">     */</span>
02271     <span class="keywordflow">if</span> (!<a class="code" href="../../d4/d1/userk_8h.html#a1272">InitSecurity</a>()) {
02272         RIPMSG0(RIP_WARNING, <span class="stringliteral">"InitSecurity failed"</span>);
02273         <span class="keywordflow">goto</span> ExitWin32UserInitialize;
02274     }
02275 
02276     <span class="comment">/*</span>
02277 <span class="comment">     * Fill in windowstation and desktop object types</span>
02278 <span class="comment">     */</span>
02279     pTypeInfo = &amp;(*ExWindowStationObjectType)-&gt;TypeInfo;
02280     pTypeInfo-&gt;<a class="code" href="../../d5/d6/struct__OBJECT__TYPE__INITIALIZER.html#o11">DefaultNonPagedPoolCharge</a> = <span class="keyword">sizeof</span>(<a class="code" href="../../d4/d9/structtagWINDOWSTATION.html">WINDOWSTATION</a>) + <span class="keyword">sizeof</span>(<a class="code" href="../../d2/d6/struct__KEVENT.html">KEVENT</a>);
02281     pTypeInfo-&gt;<a class="code" href="../../d5/d6/struct__OBJECT__TYPE__INITIALIZER.html#o10">DefaultPagedPoolCharge</a>    = 0;
02282     pTypeInfo-&gt;<a class="code" href="../../d5/d6/struct__OBJECT__TYPE__INITIALIZER.html#o7">MaintainHandleCount</a>       = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
02283     pTypeInfo-&gt;<a class="code" href="../../d5/d6/struct__OBJECT__TYPE__INITIALIZER.html#o14">CloseProcedure</a>            = <a class="code" href="../../d4/d1/userk_8h.html#a1285">DestroyWindowStation</a>;
02284     pTypeInfo-&gt;<a class="code" href="../../d5/d6/struct__OBJECT__TYPE__INITIALIZER.html#o15">DeleteProcedure</a>           = <a class="code" href="../../d4/d1/userk_8h.html#a1286">FreeWindowStation</a>;
02285     pTypeInfo-&gt;<a class="code" href="../../d5/d6/struct__OBJECT__TYPE__INITIALIZER.html#o16">ParseProcedure</a>            = <a class="code" href="../../d4/d1/userk_8h.html#a1287">ParseWindowStation</a>;
02286     pTypeInfo-&gt;<a class="code" href="../../d5/d6/struct__OBJECT__TYPE__INITIALIZER.html#o19">OkayToCloseProcedure</a>      = <a class="code" href="../../d4/d1/userk_8h.html#a1288">OkayToCloseWindowStation</a>;
02287     pTypeInfo-&gt;<a class="code" href="../../d5/d6/struct__OBJECT__TYPE__INITIALIZER.html#o5">ValidAccessMask</a>           = <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a304">WinStaMapping</a>.GenericAll;
02288     pTypeInfo-&gt;<a class="code" href="../../d5/d6/struct__OBJECT__TYPE__INITIALIZER.html#o4">GenericMapping</a>            = <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a304">WinStaMapping</a>;
02289 
02290     pTypeInfo = &amp;(*ExDesktopObjectType)-&gt;TypeInfo;
02291     pTypeInfo-&gt;<a class="code" href="../../d5/d6/struct__OBJECT__TYPE__INITIALIZER.html#o11">DefaultNonPagedPoolCharge</a> = <span class="keyword">sizeof</span>(<a class="code" href="../../d0/d3/structtagDESKTOP.html">DESKTOP</a>);
02292     pTypeInfo-&gt;<a class="code" href="../../d5/d6/struct__OBJECT__TYPE__INITIALIZER.html#o10">DefaultPagedPoolCharge</a>    = 0;
02293     pTypeInfo-&gt;<a class="code" href="../../d5/d6/struct__OBJECT__TYPE__INITIALIZER.html#o7">MaintainHandleCount</a>       = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
02294     pTypeInfo-&gt;<a class="code" href="../../d5/d6/struct__OBJECT__TYPE__INITIALIZER.html#o14">CloseProcedure</a>            = <a class="code" href="../../d9/d6/desktop_8c.html#a24">UnmapDesktop</a>;
02295     pTypeInfo-&gt;<a class="code" href="../../d5/d6/struct__OBJECT__TYPE__INITIALIZER.html#o13">OpenProcedure</a>             = <a class="code" href="../../d9/d6/desktop_8c.html#a23">MapDesktop</a>;
02296     pTypeInfo-&gt;<a class="code" href="../../d5/d6/struct__OBJECT__TYPE__INITIALIZER.html#o15">DeleteProcedure</a>           = <a class="code" href="../../d9/d6/desktop_8c.html#a19">FreeDesktop</a>;
02297     pTypeInfo-&gt;<a class="code" href="../../d5/d6/struct__OBJECT__TYPE__INITIALIZER.html#o19">OkayToCloseProcedure</a>      = <a class="code" href="../../d9/d6/desktop_8c.html#a25">OkayToCloseDesktop</a>;
02298     pTypeInfo-&gt;<a class="code" href="../../d5/d6/struct__OBJECT__TYPE__INITIALIZER.html#o5">ValidAccessMask</a>           = <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a305">DesktopMapping</a>.GenericAll;
02299     pTypeInfo-&gt;<a class="code" href="../../d5/d6/struct__OBJECT__TYPE__INITIALIZER.html#o4">GenericMapping</a>            = <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a305">DesktopMapping</a>;
02300 
02301     <span class="comment">/*</span>
02302 <span class="comment">     * Get this process so we can use the profiles.</span>
02303 <span class="comment">     */</span>
02304     <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a300">gpepInit</a> = <a class="code" href="../../d1/d9/ps_8h.html#a19">PsGetCurrentProcess</a>();
02305 
02306     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>  = <a class="code" href="../../d6/d3/queue_8c.html#a55">InitQEntryLookaside</a>();
02307     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> |= <a class="code" href="../../d3/d6/kernel_2sendmsg_8c.html#a14">InitSMSLookaside</a>();
02308     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> |= <a class="code" href="../../d4/d1/userk_8h.html#a1296">UserRtlCreateAtomTable</a>(USRINIT_ATOMBUCKET_SIZE);
02309 
02310     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status)) {
02311         RIPMSG0(RIP_WARNING, <span class="stringliteral">"Initialization failure"</span>);
02312         <span class="keywordflow">goto</span> ExitWin32UserInitialize;
02313     }
02314 
02315     <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a297">atomUSER32</a> = <a class="code" href="../../d4/d1/userk_8h.html#a1297">UserAddAtom</a>(szUSER32, TRUE);
02316 
02317     <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a282">gatomFirstPinned</a> = <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a297">atomUSER32</a>;
02318 
02319     <span class="keywordflow">if</span> (<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a282">gatomFirstPinned</a> == 0) {
02320         RIPMSG0(RIP_WARNING, <span class="stringliteral">"Could not create atomUSER32"</span>);
02321         <span class="keywordflow">goto</span> ExitWin32UserInitialize;
02322     }
02323 
02324     <span class="comment">/*</span>
02325 <span class="comment">     * Initialize the user subsystem information.</span>
02326 <span class="comment">     */</span>
02327     <span class="keywordflow">if</span> (!<a class="code" href="../../d9/d6/kernel_2server_8c.html#a68">InitCreateUserSubsystem</a>()) {
02328         RIPMSG0(RIP_WARNING, <span class="stringliteral">"InitCreateUserSubsystem failed"</span>);
02329         <span class="keywordflow">goto</span> ExitWin32UserInitialize;
02330     }
02331 
02332     <span class="comment">/*</span>
02333 <span class="comment">     * Don't bail out if CreateSetupNameArray fails</span>
02334 <span class="comment">     * MCostea #326652</span>
02335 <span class="comment">     */</span>
02336     <a class="code" href="../../d9/d6/kernel_2server_8c.html#a69">CreateSetupNameArray</a>();
02337 
02338     <span class="comment">/*</span>
02339 <span class="comment">     * Allocated shared SERVERINFO structure.</span>
02340 <span class="comment">     */</span>
02341     <span class="keywordflow">if</span> ((<a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a> = (<a class="code" href="../../d2/d6/structtagSERVERINFO.html">PSERVERINFO</a>)<a class="code" href="../../d4/d1/userk_8h.html#a1000">SharedAlloc</a>(<span class="keyword">sizeof</span>(<a class="code" href="../../d2/d6/structtagSERVERINFO.html">SERVERINFO</a>))) == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
02342         RIPMSG0(RIP_WARNING, <span class="stringliteral">"Could not allocate SERVERINFO"</span>);
02343         <span class="keywordflow">goto</span> ExitWin32UserInitialize;
02344     }
02345 
02346     <span class="comment">/*</span>
02347 <span class="comment">     * Set the default rip-flags to rip on just about</span>
02348 <span class="comment">     * everything.  We'll truly set this in the InitGlobalRIPFlags()</span>
02349 <span class="comment">     * routine.  These are needed so that we can do appropriate ripping</span>
02350 <span class="comment">     * during the rest of the init-calls.</span>
02351 <span class="comment">     */</span>
02352 
02353     <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a11">SET_FLAG</a>(<a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;<a class="code" href="../../d2/d6/structtagSERVERINFO.html#o0">wRIPFlags</a>, RIPF_DEFAULT);
02354 
02355     <span class="comment">/*</span>
02356 <span class="comment">     * Make sure we will not get a division by zero if the initialization</span>
02357 <span class="comment">     * will not complete correctly. Set these to their normal values.</span>
02358 <span class="comment">     */</span>
02359     <a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;cxMsgFontChar = 6;
02360     <a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;cyMsgFontChar = 13;
02361     <a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;cxSysFontChar = 8;
02362     <a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;cySysFontChar = 16;
02363 
02364     <span class="comment">/*</span>
02365 <span class="comment">     * Initialize the DISPLAYINFO structure.</span>
02366 <span class="comment">     */</span>
02367     <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a179">gpDispInfo</a> = <a class="code" href="../../d4/d1/userk_8h.html#a1000">SharedAlloc</a>(<span class="keyword">sizeof</span>(*gpDispInfo));
02368     <span class="keywordflow">if</span> (!<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a179">gpDispInfo</a>) {
02369         RIPMSG0(RIP_WARNING, <span class="stringliteral">"Could not allocate gpDispInfo"</span>);
02370         <span class="keywordflow">goto</span> ExitWin32UserInitialize;
02371     }
02372 
02373     InitDbgTags();
02374 
02375     <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a383">SET_OR_CLEAR_SRVIF</a>(SRVIF_DBCS, <a class="code" href="../../d9/d6/kernel_2server_8c.html#a76">IsDBCSEnabledSystem</a>());
02376     <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a383">SET_OR_CLEAR_SRVIF</a>(SRVIF_IME, <a class="code" href="../../d9/d6/kernel_2server_8c.html#a77">IsIMMEnabledSystem</a>());
02377 
02378     <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a383">SET_OR_CLEAR_SRVIF</a>(SRVIF_MIDEAST, <a class="code" href="../../d9/d6/kernel_2server_8c.html#a78">IsMidEastEnabledSystem</a>());
02379 
02380 <span class="preprocessor">#if DBG</span>
02381 <span class="preprocessor"></span>    <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a381">SET_SRVIF</a>(SRVIF_CHECKED);
02382 
02383     RIPMSG3(RIP_WARNING, <span class="stringliteral">"*** win32k: DBCS:[%d] IME:[%d] MiddleEast:[%d]"</span>,
02384             <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a125">IS_DBCS_ENABLED</a>(),
02385             <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a126">IS_IME_ENABLED</a>(),
02386             <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a128">IS_MIDEAST_ENABLED</a>());
02387 <span class="preprocessor">#endif</span>
02388 <span class="preprocessor"></span>
02389     <a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;<a class="code" href="../../d2/d6/structtagSERVERINFO.html#o14">dwDefaultHeapSize</a> = <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a309">gdwDesktopSectionSize</a> * 1024;
02390 
02391     <span class="comment">/*</span>
02392 <span class="comment">     * Initialize procedures and message tables.</span>
02393 <span class="comment">     * Initialize the class structures for Get/SetClassWord/Long.</span>
02394 <span class="comment">     * Initialize message-box strings.</span>
02395 <span class="comment">     * Initialize OLE-Formats (performance-hack).</span>
02396 <span class="comment">     */</span>
02397     <a class="code" href="../../d9/d6/kernel_2server_8c.html#a54">InitFunctionTables</a>();
02398     <a class="code" href="../../d9/d6/kernel_2server_8c.html#a55">InitMessageTables</a>();
02399 <span class="preprocessor">#if DBG</span>
02400 <span class="preprocessor"></span>    <a class="code" href="../../d9/d6/kernel_2server_8c.html#a57">VerifySyncOnlyMessages</a>();
02401 <span class="preprocessor">#endif</span>
02402 <span class="preprocessor"></span>    <span class="keywordflow">if</span> (!<a class="code" href="../../d9/d6/kernel_2server_8c.html#a58">InitOLEFormats</a>()) {
02403         RIPMSG0(RIP_WARNING, <span class="stringliteral">"InitOLEFormats failed"</span>);
02404         <span class="keywordflow">goto</span> ExitWin32UserInitialize;
02405     }
02406 
02407     <span class="comment">/*</span>
02408 <span class="comment">     * Set up class atoms</span>
02409 <span class="comment">     */</span>
02410     <span class="keywordflow">if</span> (!<a class="code" href="../../d9/d6/kernel_2server_8c.html#a79">SetupClassAtoms</a>()) {
02411         RIPMSG0(RIP_WARNING, <span class="stringliteral">"SetupClassAtoms failed to register atoms"</span>);
02412         <span class="keywordflow">goto</span> ExitWin32UserInitialize;
02413     }
02414 
02415     <a class="code" href="../../d4/d1/userk_8h.html#a1836">LW_LoadSomeStrings</a>();
02416 
02417     <span class="comment">/*</span>
02418 <span class="comment">     * Initialize the handle manager.</span>
02419 <span class="comment">     */</span>
02420     <span class="keywordflow">if</span> (!<a class="code" href="../../d4/d1/userk_8h.html#a968">HMInitHandleTable</a>(gpvSharedBase)) {
02421         RIPMSG0(RIP_WARNING, <span class="stringliteral">"HMInitHandleTable failed"</span>);
02422         <span class="keywordflow">goto</span> ExitWin32UserInitialize;
02423     }
02424 
02425     <span class="comment">/*</span>
02426 <span class="comment">     * Setup shared info block.</span>
02427 <span class="comment">     */</span>
02428     <a class="code" href="../../d1/d8/clglobal_8c.html#a5">gSharedInfo</a>.<a class="code" href="../../d4/d6/structtagSHAREDINFO.html#o0">psi</a> = <a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>;
02429     <a class="code" href="../../d1/d8/clglobal_8c.html#a5">gSharedInfo</a>.<a class="code" href="../../d4/d6/structtagSHAREDINFO.html#o2">pDispInfo</a> = <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a179">gpDispInfo</a>;
02430 
02431     <span class="comment">/*</span>
02432 <span class="comment">     * Determine if we have unsigned drivers installed</span>
02433 <span class="comment">     * Use      2BD63D28D7BCD0E251195AEB519243C13142EBC3 as current key to check.</span>
02434 <span class="comment">     * Old key: 300B971A74F97E098B67A4FCEBBBF6B9AE2F404C</span>
02435 <span class="comment">     */</span>
02436     <span class="keywordflow">if</span> (<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(<a class="code" href="../../d4/d7/rtl_2regutil_8c.html#a21">RtlCheckRegistryKey</a>(RTL_REGISTRY_ABSOLUTE,
02437             L<span class="stringliteral">"\\Registry\\Machine\\SOFTWARE\\Microsoft\\SystemCertificates\\Root\\Certificates\\2BD63D28D7BCD0E251195AEB519243C13142EBC3"</span>))
02438              ||
02439             <a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(<a class="code" href="../../d4/d7/rtl_2regutil_8c.html#a21">RtlCheckRegistryKey</a>(RTL_REGISTRY_ABSOLUTE,
02440             L<span class="stringliteral">"\\Registry\\Machine\\SOFTWARE\\Policies\\Microsoft\\SystemCertificates\\Root\\Certificates\\2BD63D28D7BCD0E251195AEB519243C13142EBC3"</span>))) {
02441 
02442         <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a8">gfUnsignedDrivers</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
02443     }
02444 
02445     <span class="comment">/*</span>
02446 <span class="comment">     * Set up a desktop info structure that is visible in all</span>
02447 <span class="comment">     * clients.</span>
02448 <span class="comment">     */</span>
02449     lTemp = <a class="code" href="../../d4/d1/userk_8h.html#a2006">FastGetProfileDwordW</a>(NULL,
02450                                  PMAP_WINDOWSM,
02451                                  L<span class="stringliteral">"USERProcessHandleQuota"</span>,
02452                                  gUserProcessHandleQuota);
02453 
02454     <span class="keywordflow">if</span> ((lTemp &gt; <a class="code" href="../../d4/d1/userk_8h.html#a691">MINIMUM_USER_HANDLE_QUOTA</a>) &amp;&amp; (lTemp &lt;= <a class="code" href="../../d4/d1/userk_8h.html#a690">INITIAL_USER_HANDLE_QUOTA</a>)) {
02455         <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a253">gUserProcessHandleQuota</a> = lTemp;
02456     }
02457 
02458     <span class="comment">/*</span>
02459 <span class="comment">     * The maximum number of posted message for a thread.</span>
02460 <span class="comment">     */</span>
02461     lTemp = <a class="code" href="../../d4/d1/userk_8h.html#a2006">FastGetProfileDwordW</a>(NULL,
02462                                  PMAP_WINDOWSM,
02463                                  L<span class="stringliteral">"USERPostMessageLimit"</span>,
02464                                  gUserPostMessageLimit);
02465     <span class="keywordflow">if</span> (lTemp &gt; <a class="code" href="../../d4/d1/userk_8h.html#a693">MINIMUM_POSTMESSAGE_LIMIT</a>) {
02466         <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a254">gUserPostMessageLimit</a> = lTemp;
02467     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (lTemp == 0) {
02468         <span class="comment">/*</span>
02469 <span class="comment">         * 0 means (virtually) No Limit.</span>
02470 <span class="comment">         */</span>
02471         <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a254">gUserPostMessageLimit</a> = ~0;
02472     } <span class="keywordflow">else</span> {
02473         RIPMSG1(RIP_WARNING, <span class="stringliteral">"Win32UserInitialize: USERPostMessageLimit value (%d) is too low."</span>, lTemp);
02474     }
02475 
02476     <span class="keywordflow">if</span> (!<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a7">gDrawVersionAlways</a>) {
02477         <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a7">gDrawVersionAlways</a> = <a class="code" href="../../d4/d1/userk_8h.html#a2006">FastGetProfileDwordW</a>(NULL,
02478                                                   PMAP_WINDOWSM,
02479                                                   L<span class="stringliteral">"DisplayVersion"</span>,
02480                                                   0);
02481     }
02482 
02483     <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a332">gbSecureDesktop</a> = <a class="code" href="../../d4/d1/userk_8h.html#a2006">FastGetProfileDwordW</a>(NULL,
02484                                            PMAP_WINDOWSM,
02485                                            L<span class="stringliteral">"SecureDesktop"</span>,
02486                                            TRUE);
02487 
02488     <span class="comment">/*</span>
02489 <span class="comment">     * Initialize SMWP structure</span>
02490 <span class="comment">     */</span>
02491     <span class="keywordflow">if</span> (!<a class="code" href="../../d4/d1/userk_8h.html#a1617">AllocateCvr</a>(&amp;gSMWP, 4)) {
02492         RIPMSG0(RIP_WARNING, <span class="stringliteral">"AllocateCvr failed"</span>);
02493         <span class="keywordflow">goto</span> ExitWin32UserInitialize;
02494     }
02495     <a class="code" href="../../d7/d1/usersrv_8h.html#a37">LeaveCrit</a>();
02496 
02497     UserAssert(<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status));
02498     <span class="keywordflow">return</span> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
02499 
02500 ExitWin32UserInitialize:
02501     <a class="code" href="../../d7/d1/usersrv_8h.html#a37">LeaveCrit</a>();
02502 
02503     <span class="keywordflow">if</span> (<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status)) {
02504         <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = STATUS_NO_MEMORY;
02505     }
02506 
02507     RIPMSG1(RIP_WARNING, <span class="stringliteral">"UserInitialize failed with Status = %x"</span>, Status);
02508     <span class="keywordflow">return</span> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
02509 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a35" doxytag="w32/ntuser/kernel/init.c::xxxAddFontResourceW" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int xxxAddFontResourceW           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">LPWSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>lpFile</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>FLONG&nbsp;</td>
          <td class="mdname" nowrap> <em>flags</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>DESIGNVECTOR *&nbsp;</td>
          <td class="mdname" nowrap> <em>pdv</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l01119">1119</a> of file <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html">w32/ntuser/kernel/init.c</a>.
<p>
References <a class="el" href="../../d3/d6/string_8c-source.html#l00148">RtlInitUnicodeString()</a>, and <a class="el" href="../../d4/d1/userk_8h.html#a1010">xxxClientAddFontResourceW()</a>.
<p>
Referenced by <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l02036">bEnumerateRegistryFonts()</a>, and <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l02184">xxxLW_LoadFonts()</a>.
<p>
<pre class="fragment"><div>01123 {
01124     UNICODE_STRING strFile;
01125 
01126     <a class="code" href="../../d2/d7/string_8c.html#a7">RtlInitUnicodeString</a>(&amp;strFile, lpFile);
01127 
01128     <span class="comment">/*</span>
01129 <span class="comment">     * Callbacks leave the critsec, so make sure that we're in it.</span>
01130 <span class="comment">     */</span>
01131 
01132     <span class="keywordflow">return</span> <a class="code" href="../../d4/d1/userk_8h.html#a1010">xxxClientAddFontResourceW</a>(&amp;strFile, flags, pdv);
01133 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a40" doxytag="w32/ntuser/kernel/init.c::xxxInitWindowStation" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL xxxInitWindowStation           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d4/d9/structtagWINDOWSTATION.html">PWINDOWSTATION</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>pwinsta</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l01319">1319</a> of file <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html">w32/ntuser/kernel/init.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d2/d6/w32_2ntuser_2kernel_2profile_8c-source.html#l00151">CreateProfileUserName()</a>, <a class="el" href="../../d4/d1/userk_8h.html#a1491">FinalUserInit()</a>, <a class="el" href="../../d2/d6/w32_2ntuser_2kernel_2profile_8c-source.html#l00174">FreeProfileUserName()</a>, <a class="el" href="../../d2/d7/clglobal_8c-source.html#l00051">gpsi</a>, <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l01142">LW_DriversInit()</a>, <a class="el" href="../../d4/d1/userk_8h.html#a1837">LW_LoadProfileInitData()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d2/d0/inctlpan_8c-source.html#l01213">SetIconMetrics()</a>, <a class="el" href="../../d2/d0/inctlpan_8c-source.html#l01170">SetMinMetrics()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, and <a class="el" href="../../d2/d0/inctlpan_8c-source.html#l01080">xxxSetWindowNCMetrics()</a>.
<p>
Referenced by <a class="el" href="../../d9/d7/winsta_8c-source.html#l00243">xxxCreateWindowStation()</a>.
<p>
<pre class="fragment"><div>01321 {
01322     <a class="code" href="../../d5/d1/struct__TL.html">TL</a> tlName;
01323     PUNICODE_STRING pProfileUserName = <a class="code" href="../../d4/d1/userk_8h.html#a2000">CreateProfileUserName</a>(&amp;tlName);
01324     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> fRet;
01325 
01326     <span class="comment">/*</span>
01327 <span class="comment">     * Load all profile data first</span>
01328 <span class="comment">     */</span>
01329     <a class="code" href="../../d4/d1/userk_8h.html#a1837">LW_LoadProfileInitData</a>(pProfileUserName);
01330 
01331     <span class="comment">/*</span>
01332 <span class="comment">     * Initialize User in a specific order.</span>
01333 <span class="comment">     */</span>
01334     <a class="code" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a36">LW_DriversInit</a>();
01335 
01336     <span class="comment">/*</span>
01337 <span class="comment">     * This is the initialization from Chicago</span>
01338 <span class="comment">     */</span>
01339     <span class="keywordflow">if</span> (!(fRet = <a class="code" href="../../d4/d1/userk_8h.html#a1857">xxxSetWindowNCMetrics</a>(pProfileUserName, NULL, TRUE, -1))) {
01340         RIPMSG0(RIP_WARNING, <span class="stringliteral">"xxxInitWindowStation failed in xxxSetWindowNCMetrics"</span>);
01341         <span class="keywordflow">goto</span> Exit;
01342     }
01343 
01344     <a class="code" href="../../d4/d1/userk_8h.html#a1856">SetMinMetrics</a>(pProfileUserName, NULL);
01345 
01346     <span class="keywordflow">if</span> (!(fRet = <a class="code" href="../../d4/d1/userk_8h.html#a1858">SetIconMetrics</a>(pProfileUserName, NULL))) {
01347         RIPMSG0(RIP_WARNING, <span class="stringliteral">"xxxInitWindowStation failed in SetIconMetrics"</span>);
01348         <span class="keywordflow">goto</span> Exit;
01349     }
01350 
01351     <span class="keywordflow">if</span> (!(fRet = <a class="code" href="../../d4/d1/userk_8h.html#a1491">FinalUserInit</a>())) {
01352         RIPMSG0(RIP_WARNING, <span class="stringliteral">"xxxInitWindowStation failed in FinalUserInit"</span>);
01353         <span class="keywordflow">goto</span> Exit;
01354     }
01355 
01356     <span class="comment">/*</span>
01357 <span class="comment">     * Initialize the key cache index.</span>
01358 <span class="comment">     */</span>
01359     <a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;dwKeyCache = 1;
01360 
01361 Exit:
01362     <a class="code" href="../../d4/d1/userk_8h.html#a2001">FreeProfileUserName</a>(pProfileUserName, &amp;tlName);
01363 
01364     <span class="keywordflow">return</span> fRet;
01365     UNREFERENCED_PARAMETER(pwinsta);
01366 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a54" doxytag="w32/ntuser/kernel/init.c::xxxLW_LoadFonts" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID xxxLW_LoadFonts           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">BOOL&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>bRemote</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l02184">2184</a> of file <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html">w32/ntuser/kernel/init.c</a>.
<p>
References <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l02036">bEnumerateRegistryFonts()</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l00056">bPermanentFontsLoaded</a>, <a class="el" href="../../d4/d1/userk_8h.html#a1012">ClientLoadLocalT1Fonts()</a>, <a class="el" href="../../d4/d1/userk_8h.html#a1013">ClientLoadRemoteT1Fonts()</a>, <a class="el" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a53">CloseFNTCache()</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l03505">CMSSLEEP</a>, <a class="el" href="../../d8/d0/usersrv_8h-source.html#l00201">EnterCrit</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00932">gbRemoteSession</a>, <a class="el" href="../../d2/d6/wait_8c-source.html#l00140">KeDelayExecutionThread()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00624">KernelMode</a>, <a class="el" href="../../d3/d9/aw_8h-source.html#l00031">L</a>, <a class="el" href="../../d8/d0/usersrv_8h-source.html#l00202">LeaveCrit</a>, <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l00095">MAX_TIME_OUT</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d2/d7/hal_8h.html#a212">VOID()</a>, and <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l01119">xxxAddFontResourceW()</a>.
<p>
Referenced by <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l01376">CreateTerminalInput()</a>.
<p>
<pre class="fragment"><div>02186 {
02187     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    bTimeOut = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
02188 
02189     <span class="keywordflow">if</span>(bRemote) {
02190 
02191         LARGE_INTEGER li;
02192         ULONG         ulWaitCount = 0;
02193 
02194         <span class="comment">/*</span>
02195 <span class="comment">         * Before we can proceed we must make sure that all the permanent</span>
02196 <span class="comment">         * fonts  have been loaded.</span>
02197 <span class="comment">         */</span>
02198 
02199         <span class="keywordflow">while</span> (!<a class="code" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a12">bPermanentFontsLoaded</a>) {
02200 
02201             <span class="keywordflow">if</span> (!<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a328">gbRemoteSession</a> || (ulWaitCount &lt; <a class="code" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a2">MAX_TIME_OUT</a>))
02202             {
02203                 <a class="code" href="../../d7/d1/usersrv_8h.html#a37">LeaveCrit</a>();
02204                 li.QuadPart = (LONGLONG)-10000 * <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a911">CMSSLEEP</a>;
02205                 <a class="code" href="../../d1/d7/wait_8c.html#a2">KeDelayExecutionThread</a>(KernelMode, FALSE, &amp;li);
02206                 <a class="code" href="../../d7/d1/usersrv_8h.html#a36">EnterCrit</a>();
02207             }
02208             <span class="keywordflow">else</span>
02209             {
02210                 bTimeOut = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
02211                 <span class="keywordflow">break</span>;
02212             }
02213 
02214             ulWaitCount++;
02215         }
02216 
02217         <span class="keywordflow">if</span> (!bTimeOut)
02218         {
02219             <span class="keywordflow">if</span> (!<a class="code" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a52">bEnumerateRegistryFonts</a>(FALSE))
02220                 <span class="keywordflow">return</span>; <span class="comment">// nothing you can do</span>
02221 
02222         <span class="comment">// add  remote type 1 fonts.</span>
02223 
02224             <a class="code" href="../../d4/d1/userk_8h.html#a1013">ClientLoadRemoteT1Fonts</a>();
02225         }
02226 
02227     } <span class="keywordflow">else</span> {
02228 
02229         <a class="code" href="../../d4/d1/userk_8h.html#a1851">xxxAddFontResourceW</a>(L<span class="stringliteral">"marlett.ttf"</span>, AFRW_ADD_LOCAL_FONT,NULL);
02230         <span class="keywordflow">if</span> (!<a class="code" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a52">bEnumerateRegistryFonts</a>(TRUE))
02231             <span class="keywordflow">return</span>; <span class="comment">// nothing you can do</span>
02232 
02233     <span class="comment">// add local type 1 fonts.</span>
02234 
02235     <span class="comment">// only want to be called once, the second time after ms sans serif was installed</span>
02236 
02237         <span class="keywordflow">if</span> (<a class="code" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a12">bPermanentFontsLoaded</a>)
02238         {
02239             <a class="code" href="../../d4/d1/userk_8h.html#a1012">ClientLoadLocalT1Fonts</a>();
02240 
02241     <span class="comment">// All the fonts loaded, we can close the FNTCache</span>
02242 
02243             <a class="code" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a53">CloseFNTCache</a>();
02244         }
02245 
02246     }
02247 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a44" doxytag="w32/ntuser/kernel/init.c::xxxODI_ColorInit" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID xxxODI_ColorInit           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">PUNICODE_STRING&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>pProfileUserName</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l01508">1508</a> of file <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html">w32/ntuser/kernel/init.c</a>.
<p>
References <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l01456">CI_GetClrVal()</a>, <a class="el" href="../../d2/d6/w32_2ntuser_2kernel_2profile_8c-source.html#l01086">FastGetProfileStringFromIDW()</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00869">gargbInitial</a>, <a class="el" href="../../d2/d7/clglobal_8c-source.html#l00051">gpsi</a>, <a class="el" href="../../d0/d5/ndismain_8h-source.html#l00025">INT</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l06839">PMAP_COLORS</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01311">SSCF_FORCESOLIDCOLOR</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01312">SSCF_SETMAGICCOLORS</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l06737">STR_COLOREND</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l06736">STR_COLORSTART</a>, <a class="el" href="../../d2/d7/clglobal_8c-source.html#l00064">szNull</a>, <a class="el" href="../../d2/d7/hal_8h.html#a212">VOID()</a>, and <a class="el" href="../../d4/d1/userk_8h.html#a1774">xxxSetSysColors()</a>.
<p>
Referenced by <a class="el" href="../../d9/d7/fullscr_8c-source.html#l00775">InitUserScreen()</a>, and <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l02445">xxxUpdatePerUserSystemParameters()</a>.
<p>
<pre class="fragment"><div>01509 {
01510     <span class="keywordtype">int</span>      i;
01511     COLORREF colorVals[<a class="code" href="../../d4/d1/userk_8h.html#a683">STR_COLOREND</a> - <a class="code" href="../../d4/d1/userk_8h.html#a682">STR_COLORSTART</a> + 1];
01512     <a class="code" href="../../d9/d5/ndismain_8h.html#a263">INT</a>      colorIndex[<a class="code" href="../../d4/d1/userk_8h.html#a683">STR_COLOREND</a> - <a class="code" href="../../d4/d1/userk_8h.html#a682">STR_COLORSTART</a> + 1];
01513     WCHAR    rgchValue[25];
01514 
01515 <span class="preprocessor">#if COLOR_MAX - (STR_COLOREND - STR_COLORSTART + 1)</span>
01516 <span class="preprocessor"></span><span class="preprocessor">#error "COLOR_MAX value conflicts with STR_COLOREND - STR_COLORSTART"</span>
01517 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
01518 <span class="preprocessor"></span>
01519     <span class="comment">/*</span>
01520 <span class="comment">     * Now set up default color values.</span>
01521 <span class="comment">     * These are not in display drivers anymore since we just want default.</span>
01522 <span class="comment">     * The real values are stored in the profile.</span>
01523 <span class="comment">     */</span>
01524     RtlCopyMemory(<a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;argbSystem, gargbInitial, <span class="keyword">sizeof</span>(COLORREF) * COLOR_MAX);
01525 
01526     <span class="keywordflow">for</span> (i = 0; i &lt; COLOR_MAX; i++) {
01527 
01528         <span class="comment">/*</span>
01529 <span class="comment">         * Try to find a WIN.INI entry for this object.</span>
01530 <span class="comment">         */</span>
01531         *rgchValue = 0;
01532         <a class="code" href="../../d4/d1/userk_8h.html#a2011">FastGetProfileStringFromIDW</a>(pProfileUserName,
01533                                     PMAP_COLORS,
01534                                     STR_COLORSTART + i,
01535                                     szNull,
01536                                     rgchValue,
01537                                     <span class="keyword">sizeof</span>(rgchValue) / <span class="keyword">sizeof</span>(WCHAR)
01538                                     );
01539 
01540         <span class="comment">/*</span>
01541 <span class="comment">         * Convert the string into an RGB value and store.  Use the</span>
01542 <span class="comment">         * default RGB value if the profile value is missing.</span>
01543 <span class="comment">         */</span>
01544         colorVals[i]  = *rgchValue ? <a class="code" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a43">CI_GetClrVal</a>(rgchValue) : <a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;argbSystem[i];
01545         colorIndex[i] = i;
01546     }
01547 
01548     <a class="code" href="../../d4/d1/userk_8h.html#a1774">xxxSetSysColors</a>(pProfileUserName,
01549                     i,
01550                     colorIndex,
01551                     colorVals,
01552                     SSCF_FORCESOLIDCOLOR | SSCF_SETMAGICCOLORS);
01553 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a58" doxytag="w32/ntuser/kernel/init.c::xxxUpdatePerUserSystemParameters" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL xxxUpdatePerUserSystemParameters           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HANDLE&nbsp;</td>
          <td class="mdname" nowrap> <em>hToken</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>BOOL&nbsp;</td>
          <td class="mdname" nowrap> <em>bUserLoggedOn</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l02445">2445</a> of file <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html">w32/ntuser/kernel/init.c</a>.
<p>
References <a class="el" href="../../d8/d1/mndstry_8c-source.html#l00027">_DestroyMenu()</a>, <a class="el" href="../../d5/d4/caret_8c-source.html#l00513">_SetCaretBlinkTime()</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00075">ARRAY_SIZE</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d5/d4/rare_8c-source.html#l01247">CalculateMouseSensitivity()</a>, <a class="el" href="../../d2/d6/w32_2ntuser_2kernel_2profile_8c-source.html#l00499">CheckDesktopPolicyChange()</a>, <a class="el" href="../../d2/d6/w32_2ntuser_2kernel_2profile_8c-source.html#l00151">CreateProfileUserName()</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l02718">tagWINDOWSTATION::dwWSF_Flags</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d2/d6/w32_2ntuser_2kernel_2profile_8c-source.html#l00575">FastGetProfileDwordW()</a>, <a class="el" href="../../d2/d6/w32_2ntuser_2kernel_2profile_8c-source.html#l01031">FastGetProfileIntFromID()</a>, <a class="el" href="../../d2/d6/w32_2ntuser_2kernel_2profile_8c-source.html#l01290">FastGetProfileIntsW()</a>, <a class="el" href="../../d2/d6/w32_2ntuser_2kernel_2profile_8c-source.html#l00945">FastGetProfileIntW()</a>, <a class="el" href="../../d2/d6/w32_2ntuser_2kernel_2profile_8c-source.html#l01173">FastGetProfileValue()</a>, <a class="el" href="../../d2/d6/w32_2ntuser_2kernel_2profile_8c-source.html#l00988">FastWriteProfileStringW()</a>, <a class="el" href="../../d2/d6/w32_2ntuser_2kernel_2profile_8c-source.html#l00174">FreeProfileUserName()</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00240">gcxMouseHover</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00241">gcyMouseHover</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00224">gdtMNDropDown</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00242">gdtMouseHover</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00979">gdwCanPaintDesktop</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00192">gdwKeyboardAttributes</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l00092">GetCurrentProcessId</a>, <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l02393">GetKbdLangSwitch()</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00179">gfEnableHexNumpad</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00614">gfIMEShowStatus</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00044">gfUnsignedDrivers</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00281">gMouseSensitivity</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00280">gMouseSensitivityFactor</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00277">gMouseSpeed</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00278">gMouseThresh1</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00279">gMouseThresh2</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00292">gnFastAltTabColumns</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00291">gnFastAltTabRows</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00698">gnllHooksTimeout</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00464">gpDispInfo</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00793">gpidLogon</a>, <a class="el" href="../../d2/d7/clglobal_8c-source.html#l00051">gpsi</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00648">grpWinStaList</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02099">tagDISPLAYINFO::hdcScreen</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00734">hModuleWin</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l07072">IMESHOWSTATUS_NOTINITIALIZED</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l06472">IsWinEventNotifyDeferredOK</a>, <a class="el" href="../../d3/d9/aw_8h-source.html#l00031">L</a>, <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l01173">LoadCPUserPreferences()</a>, <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l01268">LW_LoadResources()</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l03956">MOUSE_SENSITIVITY_DEFAULT</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l03957">MOUSE_SENSITIVITY_MAX</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d4/d1/userk_8h.html#a2002">OpenCacheKeyEx()</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l06843">PMAP_DESKTOP</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l06875">PMAP_INPUTMETHOD</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l06853">PMAP_KEYBOARD</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l06863">PMAP_METRICS</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l06852">PMAP_MOUSE</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l06862">PMAP_NETWORK</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l06846">PMAP_TRUETYPE</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l06864">PMAP_UKBDLAYOUT</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l06842">PMAP_WINDOWSU</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l06584">PUDF_ANIMATE</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l06590">PUDF_DRAGFULLWINDOWS</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l02712">tagWINDOWSTATION::rpdeskList</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l02647">tagDESKTOP::rpdeskNext</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l02272">ServerLoadString</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l06612">SET_OR_CLEAR_PUDF</a>, <a class="el" href="../../d2/d0/inctlpan_8c-source.html#l01213">SetIconMetrics()</a>, <a class="el" href="../../d2/d0/inctlpan_8c-source.html#l01170">SetMinMetrics()</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l02655">tagDESKTOP::spmenuDialogSys</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l02654">tagDESKTOP::spmenuSys</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00202">SYSMET</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l06609">TEST_BOOL_PUDF</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d0/d5/ndismain_8h-source.html#l00026">UINT</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l05479">UnlockDesktopSysMenu()</a>, <a class="el" href="../../d8/d8/keyboard_8c-source.html#l00256">UpdatePerUserKeyboardIndicators()</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l02704">WSF_NOIO</a>, <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l01508">xxxODI_ColorInit()</a>, <a class="el" href="../../d2/d0/inctlpan_8c-source.html#l01080">xxxSetWindowNCMetrics()</a>, <a class="el" href="../../d4/d1/userk_8h.html#a1493">xxxSystemParametersInfo()</a>, <a class="el" href="../../d9/d2/ntuser_2kernel_2access_8c-source.html#l02314">xxxUpdatePerUserAccessPackSettings()</a>, and <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l01685">xxxUpdateSystemCursorsFromRegistry()</a>.
<p>
Referenced by <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l02876">NtUserUpdatePerUserSystemParameters()</a>.
<p>
<pre class="fragment"><div>02448 {
02449     <span class="keywordtype">int</span>            i;
02450     HANDLE         hKey;
02451     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>          dwFontSmoothing;
02452     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>           fDragFullWindows;
02453     <a class="code" href="../../d5/d1/struct__TL.html">TL</a> tlName;
02454     PUNICODE_STRING pProfileUserName = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
02455 
02456 
02457     <span class="keyword">static</span> <span class="keyword">struct </span>{
02458         <a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a> idSection;
02459         <a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a> <span class="keywordtype">id</span>;
02460         <a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a> idRes;
02461         <a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a> def;
02462     } spi[] = {
02463         { <a class="code" href="../../d4/d1/userk_8h.html#a698">PMAP_DESKTOP</a>,  SPI_SETSCREENSAVETIMEOUT, STR_SCREENSAVETIMEOUT, 0 },
02464         { <a class="code" href="../../d4/d1/userk_8h.html#a698">PMAP_DESKTOP</a>,  SPI_SETSCREENSAVEACTIVE,  STR_SCREENSAVEACTIVE,  0 },
02465         { <a class="code" href="../../d4/d1/userk_8h.html#a698">PMAP_DESKTOP</a>,  SPI_SETDRAGHEIGHT,        STR_DRAGHEIGHT,        4 },
02466         { <a class="code" href="../../d4/d1/userk_8h.html#a698">PMAP_DESKTOP</a>,  SPI_SETDRAGWIDTH,         STR_DRAGWIDTH,         4 },
02467         { <a class="code" href="../../d4/d1/userk_8h.html#a698">PMAP_DESKTOP</a>,  SPI_SETWHEELSCROLLLINES,  STR_WHEELSCROLLLINES,  3 },
02468         { <a class="code" href="../../d4/d1/userk_8h.html#a708">PMAP_KEYBOARD</a>, SPI_SETKEYBOARDDELAY,     STR_KEYDELAY,          0 },
02469         { <a class="code" href="../../d4/d1/userk_8h.html#a708">PMAP_KEYBOARD</a>, SPI_SETKEYBOARDSPEED,     STR_KEYSPEED,         15 },
02470         { <a class="code" href="../../d4/d1/userk_8h.html#a707">PMAP_MOUSE</a>,    SPI_SETDOUBLECLICKTIME,   STR_DBLCLKSPEED,     500 },
02471         { <a class="code" href="../../d4/d1/userk_8h.html#a707">PMAP_MOUSE</a>,    SPI_SETDOUBLECLKWIDTH,    STR_DOUBLECLICKWIDTH,  4 },
02472         { <a class="code" href="../../d4/d1/userk_8h.html#a707">PMAP_MOUSE</a>,    SPI_SETDOUBLECLKHEIGHT,   STR_DOUBLECLICKHEIGHT, 4 },
02473         { <a class="code" href="../../d4/d1/userk_8h.html#a707">PMAP_MOUSE</a>,    SPI_SETSNAPTODEFBUTTON,   STR_SNAPTO,            0 },
02474         { <a class="code" href="../../d4/d1/userk_8h.html#a697">PMAP_WINDOWSU</a>, SPI_SETMENUDROPALIGNMENT, STR_MENUDROPALIGNMENT, 0 },
02475         { <a class="code" href="../../d4/d1/userk_8h.html#a730">PMAP_INPUTMETHOD</a>, SPI_SETSHOWIMEUI,      STR_SHOWIMESTATUS,     1 },
02476     };
02477 
02478     <a class="code" href="../../d0/d4/structtagPROFINTINFO.html">PROFINTINFO</a> apii[] = {
02479         { <a class="code" href="../../d4/d1/userk_8h.html#a707">PMAP_MOUSE</a>,    (LPWSTR)STR_MOUSETHRESH1,          6, &amp;<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a121">gMouseThresh1</a> },
02480         { <a class="code" href="../../d4/d1/userk_8h.html#a707">PMAP_MOUSE</a>,    (LPWSTR)STR_MOUSETHRESH2,         10, &amp;<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a122">gMouseThresh2</a> },
02481         { <a class="code" href="../../d4/d1/userk_8h.html#a707">PMAP_MOUSE</a>,    (LPWSTR)STR_MOUSESPEED,            1, &amp;<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a120">gMouseSpeed</a> },
02482         { <a class="code" href="../../d4/d1/userk_8h.html#a698">PMAP_DESKTOP</a>,  (LPWSTR)STR_MENUSHOWDELAY,       400, &amp;<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a94">gdtMNDropDown</a> },
02483         { <a class="code" href="../../d4/d1/userk_8h.html#a698">PMAP_DESKTOP</a>,  (LPWSTR)STR_DRAGFULLWINDOWS,       2, &amp;fDragFullWindows },
02484         { <a class="code" href="../../d4/d1/userk_8h.html#a698">PMAP_DESKTOP</a>,  (LPWSTR)STR_FASTALTTABROWS,        3, &amp;<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a126">gnFastAltTabRows</a> },
02485         { <a class="code" href="../../d4/d1/userk_8h.html#a698">PMAP_DESKTOP</a>,  (LPWSTR)STR_FASTALTTABCOLUMNS,     7, &amp;<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a127">gnFastAltTabColumns</a> },
02486         { <a class="code" href="../../d4/d1/userk_8h.html#a698">PMAP_DESKTOP</a>,  (LPWSTR)STR_MAXLEFTOVERLAPCHARS,   3, &amp;(<a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;wMaxLeftOverlapChars) },
02487         { <a class="code" href="../../d4/d1/userk_8h.html#a698">PMAP_DESKTOP</a>,  (LPWSTR)STR_MAXRIGHTOVERLAPCHARS,  3, &amp;(<a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;wMaxRightOverlapChars) },
02488         { <a class="code" href="../../d4/d1/userk_8h.html#a698">PMAP_DESKTOP</a>,  (LPWSTR)STR_FONTSMOOTHING,         0, &amp;dwFontSmoothing },
02489         { <a class="code" href="../../d4/d1/userk_8h.html#a730">PMAP_INPUTMETHOD</a>, (LPWSTR)STR_HEXNUMPAD,          0, &amp;<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a68">gfEnableHexNumpad</a> },
02490         { 0, <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>, 0, <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> }
02491     };
02492 
02493     UserAssert(<a class="code" href="../../d4/d1/userk_8h.html#a616">IsWinEventNotifyDeferredOK</a>());
02494 
02495     UNREFERENCED_PARAMETER(hToken);
02496 
02497     <span class="comment">/*</span>
02498 <span class="comment">     * Make sure the caller is the logon process</span>
02499 <span class="comment">     */</span>
02500     <span class="keywordflow">if</span> (<a class="code" href="../../d4/d1/userk_8h.html#a19">GetCurrentProcessId</a>() != <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a298">gpidLogon</a>) {
02501         RIPMSG0(RIP_WARNING, <span class="stringliteral">"Access denied in xxxUpdatePerUserSystemParameters"</span>);
02502         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
02503     }
02504 
02505     pProfileUserName = <a class="code" href="../../d4/d1/userk_8h.html#a2000">CreateProfileUserName</a>(&amp;tlName);
02506 
02507     <span class="comment">/*</span>
02508 <span class="comment">     * Check for new policy.</span>
02509 <span class="comment">     */</span>
02510     <a class="code" href="../../d4/d1/userk_8h.html#a2004">CheckDesktopPolicyChange</a>(pProfileUserName);
02511 
02512     <span class="comment">/*</span>
02513 <span class="comment">     * Get the timeout for low level hooks from the registry</span>
02514 <span class="comment">     */</span>
02515     <a class="code" href="../../d4/d1/userk_8h.html#a2013">FastGetProfileValue</a>(pProfileUserName,
02516             PMAP_DESKTOP,
02517             (LPWSTR)STR_LLHOOKSTIMEOUT,
02518             NULL,
02519             (LPBYTE)&amp;gnllHooksTimeout,
02520             <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>)
02521             );
02522 
02523     <span class="comment">/*</span>
02524 <span class="comment">     * Control Panel User Preferences</span>
02525 <span class="comment">     */</span>
02526     <a class="code" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a37">LoadCPUserPreferences</a>(pProfileUserName);
02527 
02528     <span class="comment">/*</span>
02529 <span class="comment">     * Set syscolors from registry.</span>
02530 <span class="comment">     */</span>
02531 
02532     <a class="code" href="../../d4/d1/userk_8h.html#a1838">xxxODI_ColorInit</a>(pProfileUserName);
02533 
02534     <a class="code" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a39">LW_LoadResources</a>(pProfileUserName);
02535 
02536     <span class="comment">/*</span>
02537 <span class="comment">     * This is the initialization from Chicago</span>
02538 <span class="comment">     */</span>
02539     <a class="code" href="../../d4/d1/userk_8h.html#a1857">xxxSetWindowNCMetrics</a>(pProfileUserName, NULL, TRUE, -1); <span class="comment">// Colors must be set first</span>
02540     <a class="code" href="../../d4/d1/userk_8h.html#a1856">SetMinMetrics</a>(pProfileUserName, NULL);
02541     <a class="code" href="../../d4/d1/userk_8h.html#a1858">SetIconMetrics</a>(pProfileUserName, NULL);
02542 
02543     <span class="comment">/*</span>
02544 <span class="comment">     * Read the keyboard layout switching hot key</span>
02545 <span class="comment">     */</span>
02546     <a class="code" href="../../d4/d1/userk_8h.html#a1305">GetKbdLangSwitch</a>(pProfileUserName);
02547 
02548     <span class="comment">/*</span>
02549 <span class="comment">     * Set the default thread locale for the system based on the value</span>
02550 <span class="comment">     * in the current user's registry profile.</span>
02551 <span class="comment">     */</span>
02552     ZwSetDefaultLocale( TRUE, 0 );
02553 
02554     <span class="comment">/*</span>
02555 <span class="comment">     * Set the default UI language based on the value in the current</span>
02556 <span class="comment">     * user's registry profile.</span>
02557 <span class="comment">     */</span>
02558     ZwSetDefaultUILanguage(0);
02559 
02560     <span class="comment">/*</span>
02561 <span class="comment">     * And then Get it.</span>
02562 <span class="comment">     */</span>
02563     ZwQueryDefaultUILanguage(&amp;(<a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;UILangID));
02564 
02565 
02566     <span class="comment">/*</span>
02567 <span class="comment">     * Destroy the desktop system menus, so that they're recreated with</span>
02568 <span class="comment">     * the correct UI language if the current user's UI language is different</span>
02569 <span class="comment">     * from the previous one. This is done by finding the interactive</span>
02570 <span class="comment">     * window station and destroying all its desktops's system menus.</span>
02571 <span class="comment">     */</span>
02572     <span class="keywordflow">if</span> (<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a241">grpWinStaList</a> != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
02573         <a class="code" href="../../d0/d3/structtagDESKTOP.html">PDESKTOP</a>        pdesk;
02574         <a class="code" href="../../d1/d1/structtagMENU.html">PMENU</a>           pmenu;
02575 
02576         UserAssert(!(<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a241">grpWinStaList</a>-&gt;<a class="code" href="../../d4/d9/structtagWINDOWSTATION.html#o3">dwWSF_Flags</a> &amp; WSF_NOIO));
02577         <span class="keywordflow">for</span> (pdesk = <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a241">grpWinStaList</a>-&gt;<a class="code" href="../../d4/d9/structtagWINDOWSTATION.html#o1">rpdeskList</a>; pdesk != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>; pdesk = pdesk-&gt;<a class="code" href="../../d0/d3/structtagDESKTOP.html#o2">rpdeskNext</a>) {
02578             <span class="keywordflow">if</span> (pdesk-&gt;<a class="code" href="../../d0/d3/structtagDESKTOP.html#o7">spmenuSys</a> != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
02579                 pmenu = pdesk-&gt;<a class="code" href="../../d0/d3/structtagDESKTOP.html#o7">spmenuSys</a>;
02580                 <span class="keywordflow">if</span> (<a class="code" href="../../d4/d1/userk_8h.html#a1606">UnlockDesktopSysMenu</a>(&amp;pdesk-&gt;<a class="code" href="../../d0/d3/structtagDESKTOP.html#o7">spmenuSys</a>))
02581                     <a class="code" href="../../d4/d1/userk_8h.html#a1887">_DestroyMenu</a>(pmenu);
02582             }
02583             <span class="keywordflow">if</span> (pdesk-&gt;<a class="code" href="../../d0/d3/structtagDESKTOP.html#o8">spmenuDialogSys</a> != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
02584                 pmenu = pdesk-&gt;<a class="code" href="../../d0/d3/structtagDESKTOP.html#o8">spmenuDialogSys</a>;
02585                 <span class="keywordflow">if</span> (<a class="code" href="../../d4/d1/userk_8h.html#a1606">UnlockDesktopSysMenu</a>(&amp;pdesk-&gt;<a class="code" href="../../d0/d3/structtagDESKTOP.html#o8">spmenuDialogSys</a>))
02586                     <a class="code" href="../../d4/d1/userk_8h.html#a1887">_DestroyMenu</a>(pmenu);
02587             }
02588         }
02589     }
02590 
02591     <a class="code" href="../../d4/d1/userk_8h.html#a1840">xxxUpdateSystemCursorsFromRegistry</a>(pProfileUserName);
02592 
02593     <span class="comment">/*</span>
02594 <span class="comment">     * desktop Pattern now.  Note no parameters.  It just goes off</span>
02595 <span class="comment">     * and reads win.ini and sets the desktop pattern.</span>
02596 <span class="comment">     */</span>
02597     <a class="code" href="../../d4/d1/userk_8h.html#a1493">xxxSystemParametersInfo</a>(SPI_SETDESKPATTERN, (UINT)-1, 0L, 0); <span class="comment">// 265 version</span>
02598 
02599     <span class="comment">/*</span>
02600 <span class="comment">     * Initialize IME show status</span>
02601 <span class="comment">     */</span>
02602     <span class="keywordflow">if</span> (bUserLoggedOn) {
02603         <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a234">gfIMEShowStatus</a> = <a class="code" href="../../d4/d1/userk_8h.html#a744">IMESHOWSTATUS_NOTINITIALIZED</a>;
02604     }
02605 
02606     <span class="comment">/*</span>
02607 <span class="comment">     * now go set a bunch of random values from the win.ini file.</span>
02608 <span class="comment">     */</span>
02609     <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a2">ARRAY_SIZE</a>(spi); i++) {
02610 
02611         <a class="code" href="../../d4/d1/userk_8h.html#a1493">xxxSystemParametersInfo</a>(
02612                 spi[i].<span class="keywordtype">id</span>,
02613                 <a class="code" href="../../d4/d1/userk_8h.html#a2010">FastGetProfileIntFromID</a>(pProfileUserName,
02614                                          spi[i].idSection,
02615                                          spi[i].idRes,
02616                                          spi[i].def
02617                                          ),
02618                 0L,
02619                 0
02620                 );
02621     }
02622 
02623     <span class="comment">/*</span>
02624 <span class="comment">     * read profile integers and do any fixups</span>
02625 <span class="comment">     */</span>
02626     <a class="code" href="../../d4/d1/userk_8h.html#a2014">FastGetProfileIntsW</a>(pProfileUserName, apii);
02627 
02628     <span class="keywordflow">if</span> (<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a127">gnFastAltTabColumns</a> &lt; 2)
02629         <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a127">gnFastAltTabColumns</a> = 7;
02630 
02631     <span class="keywordflow">if</span> (<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a126">gnFastAltTabRows</a> &lt; 1)
02632         <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a126">gnFastAltTabRows</a> = 3;
02633 
02634     <span class="comment">/*</span>
02635 <span class="comment">     * If this is the first time the user logs on, set the DragFullWindows</span>
02636 <span class="comment">     * to the default. If we have an accelerated device, enable full drag.</span>
02637 <span class="comment">     */</span>
02638     <span class="keywordflow">if</span> (fDragFullWindows == 2) {
02639 
02640         LPWSTR pwszd = <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="stringliteral">"%d"</span>;
02641         WCHAR  szTemp[40];
02642         WCHAR  szDragFullWindows[40];
02643 
02644         <a class="code" href="../../d4/d1/userk_8h.html#a661">SET_OR_CLEAR_PUDF</a>(
02645                 PUDF_DRAGFULLWINDOWS,
02646                 GreGetDeviceCaps(<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a179">gpDispInfo</a>-&gt;<a class="code" href="../../d9/d3/structtagDISPLAYINFO.html#o3">hdcScreen</a>, BLTALIGNMENT) == 0);
02647 
02648         <span class="keywordflow">if</span> (bUserLoggedOn) {
02649             swprintf(szTemp, pwszd, <a class="code" href="../../d4/d1/userk_8h.html#a658">TEST_BOOL_PUDF</a>(PUDF_DRAGFULLWINDOWS));
02650 
02651             <a class="code" href="../../d4/d1/userk_8h.html#a248">ServerLoadString</a>(hModuleWin,
02652                              STR_DRAGFULLWINDOWS,
02653                              szDragFullWindows,
02654                              <span class="keyword">sizeof</span>(szDragFullWindows) / <span class="keyword">sizeof</span>(WCHAR));
02655 
02656             <a class="code" href="../../d4/d1/userk_8h.html#a2009">FastWriteProfileStringW</a>(pProfileUserName,
02657                                     PMAP_DESKTOP,
02658                                     szDragFullWindows,
02659                                     szTemp);
02660         }
02661     } <span class="keywordflow">else</span> {
02662         <a class="code" href="../../d4/d1/userk_8h.html#a661">SET_OR_CLEAR_PUDF</a>(PUDF_DRAGFULLWINDOWS, fDragFullWindows);
02663     }
02664 
02665     <span class="comment">/*</span>
02666 <span class="comment">     * !!!LATER!!! (adams) See if the following profile retrievals can't</span>
02667 <span class="comment">     * be done in the "spi" array above (e.g. SPI_SETSNAPTO).</span>
02668 <span class="comment">     */</span>
02669 
02670     <span class="comment">/*</span>
02671 <span class="comment">     * Set mouse settings</span>
02672 <span class="comment">     */</span>
02673     <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a124">gMouseSensitivity</a> = <a class="code" href="../../d4/d1/userk_8h.html#a2010">FastGetProfileIntFromID</a>(pProfileUserName,PMAP_MOUSE, STR_MOUSESENSITIVITY, MOUSE_SENSITIVITY_DEFAULT);
02674     <span class="keywordflow">if</span> ((gMouseSensitivity &lt; MOUSE_SENSITIVITY_MIN) || (gMouseSensitivity &gt; <a class="code" href="../../d4/d1/userk_8h.html#a485">MOUSE_SENSITIVITY_MAX</a>)) {
02675         <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a124">gMouseSensitivity</a> = <a class="code" href="../../d4/d1/userk_8h.html#a484">MOUSE_SENSITIVITY_DEFAULT</a> ;
02676     }
02677     <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a123">gMouseSensitivityFactor</a> = <a class="code" href="../../d4/d1/userk_8h.html#a1031">CalculateMouseSensitivity</a>(gMouseSensitivity) ;
02678 
02679     <a class="code" href="../../d4/d1/userk_8h.html#a1727">_SetCaretBlinkTime</a>(<a class="code" href="../../d4/d1/userk_8h.html#a2010">FastGetProfileIntFromID</a>(pProfileUserName,PMAP_DESKTOP, STR_BLINK, 500));
02680 
02681     <span class="comment">/*</span>
02682 <span class="comment">     * Font Information</span>
02683 <span class="comment">     */</span>
02684     GreSetFontEnumeration( <a class="code" href="../../d4/d1/userk_8h.html#a2008">FastGetProfileIntW</a>(pProfileUserName,PMAP_TRUETYPE, TEXT(<span class="stringliteral">"TTOnly"</span>), FALSE));
02685 
02686     <span class="comment">/*</span>
02687 <span class="comment">     * Mouse tracking variables</span>
02688 <span class="comment">     */</span>
02689     <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a102">gcxMouseHover</a> = <a class="code" href="../../d4/d1/userk_8h.html#a2010">FastGetProfileIntFromID</a>(pProfileUserName,PMAP_MOUSE, STR_MOUSEHOVERWIDTH, <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(CXDOUBLECLK));
02690     <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a103">gcyMouseHover</a> = <a class="code" href="../../d4/d1/userk_8h.html#a2010">FastGetProfileIntFromID</a>(pProfileUserName,PMAP_MOUSE, STR_MOUSEHOVERHEIGHT, <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(CYDOUBLECLK));
02691     <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a104">gdtMouseHover</a> = <a class="code" href="../../d4/d1/userk_8h.html#a2010">FastGetProfileIntFromID</a>(pProfileUserName,PMAP_MOUSE, STR_MOUSEHOVERTIME, gdtMNDropDown);
02692 
02693     <span class="comment">/*</span>
02694 <span class="comment">     * Window animation</span>
02695 <span class="comment">     */</span>
02696     <a class="code" href="../../d4/d1/userk_8h.html#a661">SET_OR_CLEAR_PUDF</a>(PUDF_ANIMATE,
02697                       <a class="code" href="../../d4/d1/userk_8h.html#a2010">FastGetProfileIntFromID</a>(pProfileUserName,PMAP_METRICS, STR_MINANIMATE, TRUE));
02698 
02699     <span class="comment">/*</span>
02700 <span class="comment">     * Initial Keyboard state:  ScrollLock, NumLock and CapsLock state;</span>
02701 <span class="comment">     * global (per-user) kbd layout attributes (such as ShiftLock/CapsLock)</span>
02702 <span class="comment">     */</span>
02703     <a class="code" href="../../d4/d1/userk_8h.html#a1718">UpdatePerUserKeyboardIndicators</a>(pProfileUserName);
02704 
02705     <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a73">gdwKeyboardAttributes</a> = KLL_GLOBAL_ATTR_FROM_KLF(<a class="code" href="../../d4/d1/userk_8h.html#a2006">FastGetProfileDwordW</a>(pProfileUserName,PMAP_UKBDLAYOUT, L<span class="stringliteral">"Attributes"</span>, 0));
02706 
02707     <a class="code" href="../../d4/d1/userk_8h.html#a1853">xxxUpdatePerUserAccessPackSettings</a>(pProfileUserName);
02708 
02709     <span class="comment">/*</span>
02710 <span class="comment">     * If we successfully opened this, we assume we have a network.</span>
02711 <span class="comment">     */</span>
02712     <span class="keywordflow">if</span> (hKey = <a class="code" href="../../d4/d1/userk_8h.html#a2002">OpenCacheKeyEx</a>(NULL, PMAP_NETWORK, KEY_READ, NULL)) {
02713         RIPMSG0(RIP_WARNING | RIP_NONAME, <span class="stringliteral">""</span>);
02714         <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(NETWORK) = RNC_NETWORKS;
02715 
02716         ZwClose(hKey);
02717     }
02718 
02719     <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(NETWORK) |= RNC_LOGON;
02720 
02721     <span class="comment">/*</span>
02722 <span class="comment">     * Font smoothing</span>
02723 <span class="comment">     */</span>
02724     UserAssert ((dwFontSmoothing == 0) || (dwFontSmoothing == FE_AA_ON));
02725     GreSetFontEnumeration( dwFontSmoothing | FE_SET_AA );
02726 
02727     <span class="comment">/*</span>
02728 <span class="comment">     * Desktop Build Number Painting</span>
02729 <span class="comment">     */</span>
02730     <span class="keywordflow">if</span> (USER_SHARED_DATA-&gt;SystemExpirationDate.QuadPart || <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a8">gfUnsignedDrivers</a>) {
02731         <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a358">gdwCanPaintDesktop</a> = 1;
02732     } <span class="keywordflow">else</span> {
02733         <a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a358">gdwCanPaintDesktop</a> = <a class="code" href="../../d4/d1/userk_8h.html#a2006">FastGetProfileDwordW</a>(pProfileUserName, PMAP_DESKTOP, L<span class="stringliteral">"PaintDesktopVersion"</span>, 0);
02734     }
02735 
02736     <a class="code" href="../../d4/d1/userk_8h.html#a2001">FreeProfileUserName</a>(pProfileUserName, &amp;tlName);
02737     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
02738 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a47" doxytag="w32/ntuser/kernel/init.c::xxxUpdateSystemCursorsFromRegistry" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID xxxUpdateSystemCursorsFromRegistry           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">PUNICODE_STRING&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>pProfileUserName</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l01685">1685</a> of file <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html">w32/ntuser/kernel/init.c</a>.
<p>
References <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d2/d6/w32_2ntuser_2kernel_2profile_8c-source.html#l01086">FastGetProfileStringFromIDW()</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00392">gasyscur</a>, <a class="el" href="../../d4/d8/arcinst_8c-source.html#l00065">MAX_PATH</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l06840">PMAP_CURSORS</a>, <a class="el" href="../../d3/d6/string_8c-source.html#l00148">RtlInitUnicodeString()</a>, <a class="el" href="../../d1/d0/base_8c-source.html#l00204">RtlInitUnicodeStringOrId()</a>, <a class="el" href="../../d0/d5/ndismain_8h-source.html#l00026">UINT</a>, <a class="el" href="../../d2/d7/hal_8h.html#a212">VOID()</a>, <a class="el" href="../../d4/d1/userk_8h.html#a1007">xxxClientLoadImage()</a>, and <a class="el" href="../../d5/d3/kernel_2acons_8c-source.html#l00069">zzzSetSystemImage()</a>.
<p>
Referenced by <a class="el" href="../../d5/d4/rare_8c-source.html#l01497">xxxSystemParametersInfo()</a>, and <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l02445">xxxUpdatePerUserSystemParameters()</a>.
<p>
<pre class="fragment"><div>01686 {
01687     <span class="keywordtype">int</span>            i;
01688     UNICODE_STRING strName;
01689     TCHAR          szFilename[<a class="code" href="../../d3/d9/arcinst_8c.html#a6">MAX_PATH</a>];
01690     <a class="code" href="../../d6/d1/structtagCURSOR.html">PCURSOR</a>        pCursor;
01691     <a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a>           LR_flags;
01692 
01693     <span class="keywordflow">for</span> (i = 0; i &lt; COCR_CONFIGURABLE; i++) {
01694 
01695         <a class="code" href="../../d4/d1/userk_8h.html#a2011">FastGetProfileStringFromIDW</a>(pProfileUserName,
01696                                     PMAP_CURSORS,
01697                                     gasyscur[i].StrId,
01698                                     TEXT(<span class="stringliteral">""</span>),
01699                                     szFilename,
01700                                     <span class="keyword">sizeof</span>(szFilename) / <span class="keyword">sizeof</span>(TCHAR));
01701 
01702         <span class="keywordflow">if</span> (*szFilename) {
01703             <a class="code" href="../../d2/d7/string_8c.html#a7">RtlInitUnicodeString</a>(&amp;strName, szFilename);
01704             LR_flags = LR_LOADFROMFILE | LR_ENVSUBST;
01705         } <span class="keywordflow">else</span> {
01706             <a class="code" href="../../d4/d1/userk_8h.html#a1005">RtlInitUnicodeStringOrId</a>(&amp;strName,
01707                                      MAKEINTRESOURCE(i + OCR_FIRST_DEFAULT));
01708             LR_flags = LR_ENVSUBST;
01709         }
01710 
01711         pCursor = <a class="code" href="../../d4/d1/userk_8h.html#a1007">xxxClientLoadImage</a>(&amp;strName,
01712                                      0,
01713                                      IMAGE_CURSOR,
01714                                      0,
01715                                      0,
01716                                      LR_flags,
01717                                      FALSE);
01718 
01719         <span class="keywordflow">if</span> (pCursor) {
01720             <a class="code" href="../../d4/d1/userk_8h.html#a1111">zzzSetSystemImage</a>(pCursor, gasyscur[i].spcur);
01721         } <span class="keywordflow">else</span> {
01722             RIPMSG1(RIP_WARNING, <span class="stringliteral">"Unable to update cursor. id=%x."</span>, i + OCR_FIRST_DEFAULT);
01723 
01724         }
01725     }
01726 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a48" doxytag="w32/ntuser/kernel/init.c::xxxUpdateSystemIconsFromRegistry" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID xxxUpdateSystemIconsFromRegistry           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">PUNICODE_STRING&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>pProfileUserName</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l01735">1735</a> of file <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html">w32/ntuser/kernel/init.c</a>.
<p>
References <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d2/d6/w32_2ntuser_2kernel_2profile_8c-source.html#l01086">FastGetProfileStringFromIDW()</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00411">gasysico</a>, <a class="el" href="../../d2/d7/clglobal_8c-source.html#l00051">gpsi</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l01170">HtoP</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00410">IS_PTR</a>, <a class="el" href="../../d4/d8/arcinst_8c-source.html#l00065">MAX_PATH</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l06844">PMAP_ICONS</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l01512">PtoH</a>, <a class="el" href="../../d3/d6/string_8c-source.html#l00148">RtlInitUnicodeString()</a>, <a class="el" href="../../d1/d0/base_8c-source.html#l00204">RtlInitUnicodeStringOrId()</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00202">SYSMET</a>, <a class="el" href="../../d0/d5/ndismain_8h-source.html#l00026">UINT</a>, <a class="el" href="../../d2/d7/hal_8h.html#a212">VOID()</a>, <a class="el" href="../../d4/d1/userk_8h.html#a1007">xxxClientLoadImage()</a>, and <a class="el" href="../../d5/d3/kernel_2acons_8c-source.html#l00069">zzzSetSystemImage()</a>.
<p>
Referenced by <a class="el" href="../../d5/d4/rare_8c-source.html#l01497">xxxSystemParametersInfo()</a>.
<p>
<pre class="fragment"><div>01736 {
01737     <span class="keywordtype">int</span>            i;
01738     UNICODE_STRING strName;
01739     TCHAR          szFilename[<a class="code" href="../../d3/d9/arcinst_8c.html#a6">MAX_PATH</a>];
01740     <a class="code" href="../../d6/d1/structtagCURSOR.html">PCURSOR</a>        pCursor;
01741     <a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a>           LR_flags;
01742 
01743     <span class="keywordflow">for</span> (i = 0; i &lt; COIC_CONFIGURABLE; i++) {
01744 
01745         <a class="code" href="../../d4/d1/userk_8h.html#a2011">FastGetProfileStringFromIDW</a>(pProfileUserName,
01746                                     PMAP_ICONS,
01747                                     gasysico[i].StrId,
01748                                     TEXT(<span class="stringliteral">""</span>),
01749                                     szFilename,
01750                                     <span class="keyword">sizeof</span>(szFilename) / <span class="keyword">sizeof</span>(TCHAR));
01751 
01752         <span class="keywordflow">if</span> (*szFilename) {
01753             <a class="code" href="../../d2/d7/string_8c.html#a7">RtlInitUnicodeString</a>(&amp;strName, szFilename);
01754             LR_flags = LR_LOADFROMFILE | LR_ENVSUBST;
01755         } <span class="keywordflow">else</span> {
01756             <a class="code" href="../../d4/d1/userk_8h.html#a1005">RtlInitUnicodeStringOrId</a>(&amp;strName,
01757                                      MAKEINTRESOURCE(i + OIC_FIRST_DEFAULT));
01758             LR_flags = LR_ENVSUBST;
01759         }
01760 
01761         pCursor = <a class="code" href="../../d4/d1/userk_8h.html#a1007">xxxClientLoadImage</a>(&amp;strName,
01762                                      0,
01763                                      IMAGE_ICON,
01764                                      0,
01765                                      0,
01766                                      LR_flags,
01767                                      FALSE);
01768 
01769         RIPMSG3(RIP_VERBOSE,
01770                 (!<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a98">IS_PTR</a>(strName.Buffer)) ?
01771                         <span class="stringliteral">"%#.8lx = Loaded id %ld"</span> :
01772                         <span class="stringliteral">"%#.8lx = Loaded file %ws for id %ld"</span>,
01773                 <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a448">PtoH</a>(pCursor),
01774                 strName.Buffer,
01775                 i + OIC_FIRST_DEFAULT);
01776 
01777         <span class="keywordflow">if</span> (pCursor) {
01778             <a class="code" href="../../d4/d1/userk_8h.html#a1111">zzzSetSystemImage</a>(pCursor, gasysico[i].spcur);
01779         } <span class="keywordflow">else</span> {
01780             RIPMSG1(RIP_WARNING, <span class="stringliteral">"Unable to update icon. id=%ld"</span>, i + OIC_FIRST_DEFAULT);
01781         }
01782 
01783         <span class="comment">/*</span>
01784 <span class="comment">         * update the small winlogo icon which is referenced by gpsi.</span>
01785 <span class="comment">         * Seems like we should load the small version for all configurable</span>
01786 <span class="comment">         * icons anyway.  What is needed is for CopyImage to support</span>
01787 <span class="comment">         * copying of images loaded from files with LR_COPYFROMRESOURCE</span>
01788 <span class="comment">         * allowing a reaload of the bits. (SAS)</span>
01789 <span class="comment">         */</span>
01790         <span class="keywordflow">if</span> (i == OIC_WINLOGO_DEFAULT - OIC_FIRST_DEFAULT) {
01791 
01792             <a class="code" href="../../d6/d1/structtagCURSOR.html">PCURSOR</a> pCurSys = <a class="code" href="../../d4/d1/userk_8h.html#a102">HtoP</a>(<a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;hIconSmWindows);
01793 
01794             <span class="keywordflow">if</span> (pCurSys != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01795                 pCursor = <a class="code" href="../../d4/d1/userk_8h.html#a1007">xxxClientLoadImage</a>(&amp;strName,
01796                                              0,
01797                                              IMAGE_ICON,
01798                                              <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(CXSMICON),
01799                                              <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(CYSMICON),
01800                                              LR_flags,
01801                                              FALSE);
01802 
01803                 <span class="keywordflow">if</span> (pCursor) {
01804                     <a class="code" href="../../d4/d1/userk_8h.html#a1111">zzzSetSystemImage</a>(pCursor, pCurSys);
01805                 } <span class="keywordflow">else</span> {
01806                     RIPMSG0(RIP_WARNING, <span class="stringliteral">"Unable to update small winlogo icon."</span>);
01807                 }
01808             }
01809         }
01810     }
01811 }
</div></pre>    </td>
  </tr>
</table>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="a4" doxytag="w32/ntuser/kernel/init.c::apObjects" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PVOID* <a class="el" href="../../d6/d8/ntinput_8c.html#a26">apObjects</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l00026">26</a> of file <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html">w32/ntuser/kernel/init.c</a>.
<p>
Referenced by <a class="el" href="../../d7/d7/ntinput_8c-source.html#l03858">RawInputThread()</a>, <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l00097">Win32kNtUserCleanup()</a>, and <a class="el" href="../../d7/d2/queue_8c-source.html#l04271">xxxMsgWaitForMultipleObjects()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a12" doxytag="w32/ntuser/kernel/init.c::bPermanentFontsLoaded" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL <a class="el" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a12">bPermanentFontsLoaded</a> = FALSE          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l00056">56</a> of file <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html">w32/ntuser/kernel/init.c</a>.
<p>
Referenced by <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l02036">bEnumerateRegistryFonts()</a>, and <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l02184">xxxLW_LoadFonts()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a9" doxytag="w32/ntuser/kernel/init.c::glpSetupPrograms" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> WCHAR* <a class="el" href="../../d9/d6/kernel_2server_8c.html#a48">glpSetupPrograms</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l00032">32</a> of file <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html">w32/ntuser/kernel/init.c</a>.
<p>
Referenced by <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l01559">CreateSetupNameArray()</a>, and <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l00097">Win32kNtUserCleanup()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a8" doxytag="w32/ntuser/kernel/init.c::gpastrSetupExe" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> UNICODE_STRING* <a class="el" href="../../d9/d6/kernel_2server_8c.html#a46">gpastrSetupExe</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l00031">31</a> of file <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html">w32/ntuser/kernel/init.c</a>.
<p>
Referenced by <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l01559">CreateSetupNameArray()</a>, <a class="el" href="../../d7/d2/queue_8c-source.html#l00702">SetAppImeCompatFlags()</a>, and <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l00097">Win32kNtUserCleanup()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a10" doxytag="w32/ntuser/kernel/init.c::gpHandlePages" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d4/d4/struct__HANDLEPAGE.html">PHANDLEPAGE</a> <a class="el" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a10">gpHandlePages</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l00034">34</a> of file <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html">w32/ntuser/kernel/init.c</a>.
<p>
Referenced by <a class="el" href="../../d5/d7/handtabl_8c-source.html#l00828">HMAllocObject()</a>, <a class="el" href="../../d5/d7/handtabl_8c-source.html#l01069">HMFreeObject()</a>, <a class="el" href="../../d5/d7/handtabl_8c-source.html#l00704">HMGrowHandleTable()</a>, <a class="el" href="../../d5/d7/handtabl_8c-source.html#l00575">HMInitHandleTable()</a>, and <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l00773">Win32KDriverUnload()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a7" doxytag="w32/ntuser/kernel/init.c::gptmrWD" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d3/d8/struct__KTIMER.html">PKTIMER</a> <a class="el" href="../../d6/d8/ntinput_8c.html#a25">gptmrWD</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l00029">29</a> of file <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html">w32/ntuser/kernel/init.c</a>.
<p>
Referenced by <a class="el" href="../../d7/d7/ntinput_8c-source.html#l03858">RawInputThread()</a>, and <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l00097">Win32kNtUserCleanup()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a18" doxytag="w32/ntuser/kernel/init.c::gpW32FastMutex" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d6/d9/struct__FAST__MUTEX.html">PFAST_MUTEX</a> <a class="el" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a18">gpW32FastMutex</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l00066">66</a> of file <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html">w32/ntuser/kernel/init.c</a>.
<p>
Referenced by <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l00773">Win32KDriverUnload()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a5" doxytag="w32/ntuser/kernel/init.c::gWaitBlockArray" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d4/d8/struct__KWAIT__BLOCK.html">PKWAIT_BLOCK</a> <a class="el" href="../../d6/d8/ntinput_8c.html#a17">gWaitBlockArray</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l00027">27</a> of file <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html">w32/ntuser/kernel/init.c</a>.
<p>
Referenced by <a class="el" href="../../d7/d7/ntinput_8c-source.html#l03858">RawInputThread()</a>, and <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l00097">Win32kNtUserCleanup()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a13" doxytag="w32/ntuser/kernel/init.c::LastFontLoaded" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int <a class="el" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a13">LastFontLoaded</a> = -1          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l00057">57</a> of file <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html">w32/ntuser/kernel/init.c</a>.
<p>
Referenced by <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l02036">bEnumerateRegistryFonts()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a11" doxytag="w32/ntuser/kernel/init.c::pbwlCache" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d4/d9/structtagBWL.html">PBWL</a> <a class="el" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a11">pbwlCache</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l00036">36</a> of file <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html">w32/ntuser/kernel/init.c</a>.
<p>
Referenced by <a class="el" href="../../d5/d6/enumwin_8c-source.html#l00091">BuildHwndList()</a>, <a class="el" href="../../d5/d6/enumwin_8c-source.html#l00417">FreeHwndList()</a>, and <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l00097">Win32kNtUserCleanup()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a20" doxytag="w32/ntuser/kernel/init.c::QEntryLookaside" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d1/d8/struct__PAGED__LOOKASIDE__LIST.html">PPAGED_LOOKASIDE_LIST</a> <a class="el" href="../../d6/d3/queue_8c.html#a12">QEntryLookaside</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l00092">92</a> of file <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html">w32/ntuser/kernel/init.c</a>.
<p>
Referenced by <a class="el" href="../../d7/d2/queue_8c-source.html#l03208">AllocQEntry()</a>, <a class="el" href="../../d7/d2/queue_8c-source.html#l03253">DelQEntry()</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l04397">FreeQEntry()</a>, <a class="el" href="../../d7/d2/queue_8c-source.html#l03169">InitQEntryLookaside()</a>, and <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l00097">Win32kNtUserCleanup()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a19" doxytag="w32/ntuser/kernel/init.c::SMSLookaside" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d1/d8/struct__PAGED__LOOKASIDE__LIST.html">PPAGED_LOOKASIDE_LIST</a> <a class="el" href="../../d3/d6/kernel_2sendmsg_8c.html#a7">SMSLookaside</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l00091">91</a> of file <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html">w32/ntuser/kernel/init.c</a>.
<p>
Referenced by <a class="el" href="../../d4/d5/kernel_2sendmsg_8c-source.html#l00164">AllocSMS()</a>, <a class="el" href="../../d4/d5/kernel_2sendmsg_8c-source.html#l00178">FreeSMS()</a>, <a class="el" href="../../d4/d5/kernel_2sendmsg_8c-source.html#l00137">InitSMSLookaside()</a>, and <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l00097">Win32kNtUserCleanup()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a6" doxytag="w32/ntuser/kernel/init.c::UserAtomTableHandle" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PVOID <a class="el" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a6">UserAtomTableHandle</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l00028">28</a> of file <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html">w32/ntuser/kernel/init.c</a>.
<p>
Referenced by <a class="el" href="../../d2/d9/w32_2ntuser_2kernel_2atom_8c-source.html#l00035">UserAddAtom()</a>, <a class="el" href="../../d2/d9/w32_2ntuser_2kernel_2atom_8c-source.html#l00084">UserDeleteAtom()</a>, <a class="el" href="../../d2/d9/w32_2ntuser_2kernel_2atom_8c-source.html#l00062">UserFindAtom()</a>, <a class="el" href="../../d2/d9/w32_2ntuser_2kernel_2atom_8c-source.html#l00101">UserGetAtomName()</a>, <a class="el" href="../../d2/d9/w32_2ntuser_2kernel_2atom_8c-source.html#l00018">UserRtlCreateAtomTable()</a>, and <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l00097">Win32kNtUserCleanup()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a14" doxytag="w32/ntuser/kernel/init.c::W32ProcessSize" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG <a class="el" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a14">W32ProcessSize</a> = sizeof(<a class="el" href="../../d7/d3/structtagPROCESSINFO.html">PROCESSINFO</a>)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l00062">62</a> of file <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html">w32/ntuser/kernel/init.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a15" doxytag="w32/ntuser/kernel/init.c::W32ProcessTag" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG <a class="el" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a15">W32ProcessTag</a> = TAG_PROCESSINFO          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l00063">63</a> of file <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html">w32/ntuser/kernel/init.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a16" doxytag="w32/ntuser/kernel/init.c::W32ThreadSize" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG <a class="el" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a16">W32ThreadSize</a> = sizeof(<a class="el" href="../../d2/d8/structtagTHREADINFO.html">THREADINFO</a>)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l00064">64</a> of file <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html">w32/ntuser/kernel/init.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a17" doxytag="w32/ntuser/kernel/init.c::W32ThreadTag" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG <a class="el" href="../../d7/d1/w32_2ntuser_2kernel_2init_8c.html#a17">W32ThreadTag</a> = TAG_THREADINFO          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l00065">65</a> of file <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html">w32/ntuser/kernel/init.c</a>.    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:44:11 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
