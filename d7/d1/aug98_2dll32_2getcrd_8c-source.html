<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: getcrd.c Source File</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>getcrd.c</h1><a href="../../d6/d2/aug98_2dll32_2getcrd_8c.html">Go to the documentation of this file.</a><pre class="fragment"><div>00001 <span class="preprocessor">#include "<a class="code" href="../../d8/d9/aug98_2dll32_2generic_8h.html">generic.h</a>"</span>
00002 <span class="preprocessor">#include "stdio.h"</span>
00003 <span class="preprocessor">#pragma code_seg(_ICMSEG)</span>
00004 <span class="preprocessor"></span>
<a name="l00005"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a2">00005</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a2">BeginString</a>[]       = <span class="stringliteral">"&lt;"</span>;
<a name="l00006"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a3">00006</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a3">EndString</a>[]         = <span class="stringliteral">"&gt;"</span>;
<a name="l00007"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a4">00007</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a4">BeginArray</a>[]        = <span class="stringliteral">"["</span>;
<a name="l00008"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a5">00008</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a5">EndArray</a>[]          = <span class="stringliteral">"]"</span>;
<a name="l00009"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a6">00009</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a6">BeginFunction</a>[]     = <span class="stringliteral">"{"</span>;
<a name="l00010"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a7">00010</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a7">EndFunction</a>[]       = <span class="stringliteral">"}bind "</span>;
<a name="l00011"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a8">00011</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a8">BeginDict</a>[]         = <span class="stringliteral">"&lt;&lt;"</span> ;
<a name="l00012"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a9">00012</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a9">EndDict</a>[]           = <span class="stringliteral">"&gt;&gt;"</span> ;
<a name="l00013"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a10">00013</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a10">BlackPoint</a>[]        = <span class="stringliteral">"[0 0 0]"</span> ;
<a name="l00014"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a11">00014</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a11">DictType</a>[]          = <span class="stringliteral">"/ColorRenderingType 1 "</span>;
<a name="l00015"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a12">00015</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a12">IntentType</a>[]        = <span class="stringliteral">"/RenderingIntent "</span>;
<a name="l00016"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a13">00016</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a13">IntentPer</a>[]         = <span class="stringliteral">"/Perceptual"</span>;
<a name="l00017"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a14">00017</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a14">IntentSat</a>[]         = <span class="stringliteral">"/Saturation"</span>;
<a name="l00018"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a15">00018</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a15">IntentACol</a>[]        = <span class="stringliteral">"/AbsoluteColorimetric"</span>;
<a name="l00019"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a16">00019</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a16">IntentRCol</a>[]        = <span class="stringliteral">"/RelativeColorimetric"</span>;
00020 
<a name="l00021"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a17">00021</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a17">WhitePointTag</a>[]     = <span class="stringliteral">"/WhitePoint "</span> ;
<a name="l00022"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a18">00022</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a18">BlackPointTag</a>[]     = <span class="stringliteral">"/BlackPoint "</span> ;
<a name="l00023"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a19">00023</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a19">RangePQRTag</a>[]       = <span class="stringliteral">"/RangePQR "</span> ;
<a name="l00024"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a20">00024</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a20">TransformPQRTag</a>[]   = <span class="stringliteral">"/TransformPQR "</span> ;
<a name="l00025"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a21">00025</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a21">MatrixPQRTag</a>[]      = <span class="stringliteral">"/MatrixPQR "</span> ;
00026 
<a name="l00027"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a22">00027</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a22">RangeABCTag</a>[]       = <span class="stringliteral">"/RangeABC "</span> ;
<a name="l00028"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a23">00028</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a23">MatrixATag</a>[]        = <span class="stringliteral">"/MatrixA "</span>;
<a name="l00029"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a24">00029</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a24">MatrixABCTag</a>[]      = <span class="stringliteral">"/MatrixABC "</span>;
<a name="l00030"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a25">00030</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a25">EncodeABCTag</a>[]      = <span class="stringliteral">"/EncodeABC "</span> ;
<a name="l00031"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a26">00031</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a26">RangeLMNTag</a>[]       = <span class="stringliteral">"/RangeLMN "</span> ;
<a name="l00032"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a27">00032</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a27">MatrixLMNTag</a>[]      = <span class="stringliteral">"/MatrixLMN "</span> ;
<a name="l00033"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a28">00033</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a28">EncodeLMNTag</a>[]      = <span class="stringliteral">"/EncodeLMN "</span> ;
<a name="l00034"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a29">00034</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a29">RenderTableTag</a>[]    = <span class="stringliteral">"/RenderTable "</span> ;
<a name="l00035"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a30">00035</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a30">CIEBasedATag</a>[]      = <span class="stringliteral">"/CIEBasedA "</span> ;
<a name="l00036"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a31">00036</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a31">CIEBasedABCTag</a>[]    = <span class="stringliteral">"/CIEBasedABC "</span> ;
<a name="l00037"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a32">00037</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a32">CIEBasedDEFGTag</a>[]   = <span class="stringliteral">"/CIEBasedDEFG "</span> ;
<a name="l00038"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a33">00038</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a33">CIEBasedDEFTag</a>[]    = <span class="stringliteral">"/CIEBasedDEF "</span> ;
<a name="l00039"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a34">00039</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a34">DecodeATag</a>[]        = <span class="stringliteral">"/DecodeA "</span> ;
<a name="l00040"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a35">00040</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a35">DecodeABCTag</a>[]      = <span class="stringliteral">"/DecodeABC "</span> ;
<a name="l00041"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a36">00041</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a36">DecodeLMNTag</a>[]      = <span class="stringliteral">"/DecodeLMN "</span> ;
<a name="l00042"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a37">00042</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a37">DeviceRGBTag</a>[]      = <span class="stringliteral">"/DeviceRGB "</span> ;
<a name="l00043"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a38">00043</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a38">DeviceCMYKTag</a>[]     = <span class="stringliteral">"/DeviceCMYK "</span> ;
<a name="l00044"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a39">00044</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a39">DeviceGrayTag</a>[]     = <span class="stringliteral">"/DeviceGray "</span> ;
<a name="l00045"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a40">00045</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a40">TableTag</a>[]          = <span class="stringliteral">"/Table "</span> ;
<a name="l00046"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a41">00046</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a41">DecodeDEFGTag</a>[]     = <span class="stringliteral">"/DecodeDEFG "</span> ;
<a name="l00047"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a42">00047</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a42">DecodeDEFTag</a>[]      = <span class="stringliteral">"/DecodeDEF "</span> ;
00048 
<a name="l00049"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a43">00049</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a43">NullOp</a>[]            = <span class="stringliteral">""</span>;
<a name="l00050"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a44">00050</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a44">DupOp</a>[]             = <span class="stringliteral">"dup "</span>;
<a name="l00051"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a45">00051</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a45">UserDictOp</a>[]        = <span class="stringliteral">"userdict "</span>;
<a name="l00052"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a46">00052</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a46">GlobalDictOp</a>[]      = <span class="stringliteral">"globaldict "</span>;
<a name="l00053"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a47">00053</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a47">CurrentGlobalOp</a>[]   = <span class="stringliteral">"currentglobal "</span>;
<a name="l00054"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a48">00054</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a48">SetGlobalOp</a>[]       = <span class="stringliteral">"setglobal "</span>;
<a name="l00055"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a49">00055</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a49">DefOp</a>[]             = <span class="stringliteral">"def "</span>;
<a name="l00056"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a50">00056</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a50">BeginOp</a>[]           = <span class="stringliteral">"begin "</span>;
<a name="l00057"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a51">00057</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a51">EndOp</a>[]             = <span class="stringliteral">"end "</span>;
<a name="l00058"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a52">00058</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a52">TrueOp</a>[]            = <span class="stringliteral">"true "</span>;
<a name="l00059"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a53">00059</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a53">FalseOp</a>[]           = <span class="stringliteral">"false "</span>;
<a name="l00060"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a54">00060</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a54">MulOp</a>[]             = <span class="stringliteral">"mul "</span>;
<a name="l00061"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a55">00061</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a55">DivOp</a>[]             = <span class="stringliteral">"div "</span>;
00062 
<a name="l00063"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a56">00063</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a56">NewLine</a>[]           = <span class="stringliteral">"\n"</span> ;
<a name="l00064"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a57">00064</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a57">Slash</a>[]             = <span class="stringliteral">"/"</span> ;
<a name="l00065"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a58">00065</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d7/d0/cmdat2_8c.html#a32">Space</a>[]             = <span class="stringliteral">" "</span> ;
<a name="l00066"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a59">00066</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a59">CRDBegin</a>[]          = <span class="stringliteral">"%** CRD Begin "</span>;
<a name="l00067"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a60">00067</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a60">CRDEnd</a>[]            = <span class="stringliteral">"%** CRD End "</span>;
<a name="l00068"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a61">00068</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a61">CieBasedDEFGBegin</a>[] = <span class="stringliteral">"%** CieBasedDEFG CSA Begin "</span>;
<a name="l00069"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a62">00069</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a62">CieBasedDEFBegin</a>[]  = <span class="stringliteral">"%** CieBasedDEF CSA Begin "</span>;
<a name="l00070"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a63">00070</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a63">CieBasedABCBegin</a>[]  = <span class="stringliteral">"%** CieBasedABC CSA Begin "</span>;
<a name="l00071"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a64">00071</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a64">CieBasedABegin</a>[]    = <span class="stringliteral">"%** CieBasedA CSA Begin "</span>;
<a name="l00072"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a65">00072</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a65">CieBasedDEFGEnd</a>[]   = <span class="stringliteral">"%** CieBasedDEFG CSA End "</span>;
<a name="l00073"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a66">00073</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a66">CieBasedDEFEnd</a>[]    = <span class="stringliteral">"%** CieBasedDEF CSA End "</span>;
<a name="l00074"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a67">00074</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a67">CieBasedABCEnd</a>[]    = <span class="stringliteral">"%** CieBasedABC CSA End "</span>;
<a name="l00075"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a68">00075</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a68">CieBasedAEnd</a>[]      = <span class="stringliteral">"%** CieBasedA CSA End "</span>;
<a name="l00076"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a69">00076</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a69">RangeABC</a>[]          = <span class="stringliteral">"[ 0 1 0 1 0 1 ] "</span>;
<a name="l00077"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a70">00077</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a70">RangeLMN</a>[]          = <span class="stringliteral">"[ 0 2 0 2 0 2 ] "</span>;
<a name="l00078"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a71">00078</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a71">Identity</a>[]          = <span class="stringliteral">"[1 0 0 0 1 0 0 0 1]"</span>;
<a name="l00079"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a72">00079</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a72">RangeABC_Lab</a>[]      = <span class="stringliteral">"[0 100 -128 127 -128 127]"</span>;
00080 
00081 <span class="comment">/********** This PostScript code clips incoming value between 0.0 and 1.0</span>
00082 <span class="comment">   Use:   x &lt;clip&gt;   --   &lt;clipped x&gt;                                   */</span>
<a name="l00083"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a73">00083</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a73">Clip01</a>[]            = <span class="stringliteral">"dup 1.0 ge{pop 1.0}{dup 0.0 lt{pop 0.0}if}ifelse "</span> ;
<a name="l00084"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a74">00084</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a74">DecodeA3</a>[]          = <span class="stringliteral">"256 div exp "</span>;
<a name="l00085"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a75">00085</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a75">DecodeA3Rev</a>[]       = <span class="stringliteral">"256 div 1.0 exch div exp "</span>;
<a name="l00086"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a76">00086</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a76">DecodeABCArray</a>[]    = <span class="stringliteral">"DecodeABC_"</span>;
<a name="l00087"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a77">00087</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a77">InputArray</a>[]        = <span class="stringliteral">"Inp_"</span>;
<a name="l00088"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a78">00088</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a78">OutputArray</a>[]       = <span class="stringliteral">"Out_"</span>;
<a name="l00089"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a79">00089</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a79">PreViewInArray</a>[]    = <span class="stringliteral">"IPV_"</span>;
<a name="l00090"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a80">00090</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a80">PreViewOutArray</a>[]   = <span class="stringliteral">"OPV_"</span>;
00091 
<a name="l00092"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a81">00092</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a81">AdobeCSA</a>[] = <span class="stringliteral">"[ /CIEBasedABC &lt;&lt; /DecodeLMN [\n\</span>
00093 <span class="stringliteral">{dup 0.03928 le {12.92321 div}{0.055 add 1.055 div 2.4 exp}ifelse} bind dup dup ]\n\</span>
00094 <span class="stringliteral">/MatrixLMN [0.412457 0.212673 0.019334 0.357576 0.715152 0.119192 0.180437 0.072175 0.950301]\n\</span>
00095 <span class="stringliteral">/WhitePoint [ 0.9505 1 1.0890 ] &gt;&gt; ]"</span>;
00096 
<a name="l00097"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a82">00097</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a82">AdobeCRD</a>[] = <span class="stringliteral">" /RangePQR [ -0.5 2 -0.5 2 -0.5 2 ]\n\</span>
00098 <span class="stringliteral">/MatrixPQR [0.8951 -0.7502  0.0389 0.2664  1.7135 -0.0685 -0.1614  0.0367  1.0296]\n\</span>
00099 <span class="stringliteral">/TransformPQR [{exch pop exch 3 get mul exch pop exch 3 get div} bind\n\</span>
00100 <span class="stringliteral">{exch pop exch 4 get mul exch pop exch 4 get div} bind\n\</span>
00101 <span class="stringliteral">{exch pop exch 5 get mul exch pop exch 5 get div} bind]\n\</span>
00102 <span class="stringliteral">/MatrixLMN [3.240449 -0.969265  0.055643 -1.537136  1.876011 -0.204026 -0.498531  0.041556  1.057229]\n\</span>
00103 <span class="stringliteral">/EncodeABC [{dup 0.00304 le {12.92321 mul}{1 2.4 div exp 1.055 mul 0.055 sub}ifelse} bind dup dup]\n\</span>
00104 <span class="stringliteral">/WhitePoint[0.9505 1 1.0890] &gt;&gt;"</span>;
00105 
00106 <span class="comment">// This PostScript segment takes value in range from 0.0 to 1.0 and</span>
00107 <span class="comment">//  interpolates the result using array supplied.</span>
00108 <span class="comment">//   x [array]  -- &lt;interpolated value&gt;</span>
00109 
<a name="l00110"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a83">00110</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a83">IndexArray16b</a>[]     = \
00111 <span class="stringliteral">" dup length 1 sub 3 -1 roll mul dup dup floor cvi \</span>
00112 <span class="stringliteral">exch ceiling cvi 3 index exch get 32768 add 4 -1 roll 3 -1 roll get 32768 add \</span>
00113 <span class="stringliteral">dup 3 1 roll sub 3 -1 roll dup floor cvi sub mul add "</span>;
00114 
<a name="l00115"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a84">00115</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a84">IndexArray</a>[]        = \
00116 <span class="stringliteral">" dup length 1 sub 3 -1 roll mul dup dup floor cvi \</span>
00117 <span class="stringliteral">exch ceiling cvi 3 index exch get 4 -1 roll 3 -1 roll get \</span>
00118 <span class="stringliteral">dup 3 1 roll sub 3 -1 roll dup floor cvi sub mul add "</span>;
00119 
<a name="l00120"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a85">00120</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a85">TestingDEFG</a>[]       = \
00121 <span class="stringliteral">"/SupportDEFG? {/CIEBasedDEFG /ColorSpaceFamily resourcestatus { pop pop languagelevel 3 ge}{false} ifelse} def"</span>;
00122 
<a name="l00123"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a86">00123</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a86">SupportDEFG_S</a>[]     = <span class="stringliteral">"SupportDEFG? { "</span>;
<a name="l00124"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a87">00124</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a87">NotSupportDEFG_S</a>[]  = <span class="stringliteral">"SupportDEFG? not { "</span>;
<a name="l00125"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a88">00125</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a88">SupportDEFG_E</a>[]     = <span class="stringliteral">"}if "</span>;
00126 
<a name="l00127"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a89">00127</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a89">StartClip</a>[]         = <span class="stringliteral">"dup 1.0 le{dup 0.0 ge{"</span> ;
<a name="l00128"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a90">00128</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a90">EndClip</a>[]           = <span class="stringliteral">"}if}if "</span> ;
00129 
<a name="l00130"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a91">00130</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a91">Scale8</a>[]            = <span class="stringliteral">"255 div "</span> ;
<a name="l00131"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a92">00131</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a92">Scale16</a>[]           = <span class="stringliteral">"65535 div "</span> ;
<a name="l00132"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a93">00132</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a93">Scale16XYZ</a>[]        = <span class="stringliteral">"32768 div "</span> ;
<a name="l00133"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a94">00133</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a94">TFunction8</a>[]        = <span class="stringliteral">"exch 255 mul round cvi get 255 div "</span> ;
<a name="l00134"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a95">00134</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a95">TFunction8XYZ</a>[]     = <span class="stringliteral">"exch 255 mul round cvi get 128 div "</span> ;
<a name="l00135"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a96">00135</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a96">MatrixABCLab</a>[]      = <span class="stringliteral">"[1 1 1 1 0 0 0 0 -1]"</span> ;
<a name="l00136"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a97">00136</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a97">DecodeABCLab1</a>[]     = <span class="stringliteral">"[{16 add 116 div} bind {500 div} bind {200 div} bind]"</span>;
<a name="l00137"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a98">00137</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a98">DecodeALab</a>[]        = <span class="stringliteral">" 50 mul 16 add 116 div "</span>;
<a name="l00138"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a99">00138</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a99">DecodeLMNLab</a>[]      = \
00139 <span class="stringliteral">"dup 0.206897 ge{dup dup mul mul}{0.137931 sub 0.128419 mul} ifelse "</span>;
00140 
<a name="l00141"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a100">00141</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a100">RangeLMNLab</a>[]       = <span class="stringliteral">"[0 1 0 1 0 1]"</span> ;
<a name="l00142"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a101">00142</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a101">EncodeLMNLab</a>[]      = <span class="stringliteral">"\</span>
00143 <span class="stringliteral">dup 0.008856 le{7.787 mul 0.13793 add}{0.3333 exp}ifelse "</span> ;
00144 
<a name="l00145"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a102">00145</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a102">MatrixABCLabCRD</a>[]   = <span class="stringliteral">"[0 500 0 116 -500 200 0 0 -200]"</span> ;
<a name="l00146"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a103">00146</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a103">MatrixABCXYZCRD</a>[]   = <span class="stringliteral">"[0 1 0 1 0 0 0 0 1]"</span> ;
<a name="l00147"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a104">00147</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a104">EncodeABCLab1</a>[]     = <span class="stringliteral">"16 sub 100 div "</span> ;
<a name="l00148"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a105">00148</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a> <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a105">EncodeABCLab2</a>[]     = <span class="stringliteral">"128 add 255 div "</span> ;
00149 
<a name="l00150"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a106">00150</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a>   <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a106">RangePQR</a>[]          = <span class="stringliteral">"[ -0.07 2.2 -0.02 1.4 -0.2 4.8 ]"</span>;
<a name="l00151"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a107">00151</a> <span class="keywordtype">char</span> <a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a0">ICMSEG</a>   <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a107">MatrixPQR</a>[]         = <span class="stringliteral">"[0.8951 -0.7502 0.0389 0.2664 1.7135 -0.0685 -0.1614 0.0367 1.0296]"</span>;
00152 
<a name="l00153"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a108">00153</a> <span class="keywordtype">char</span> *<a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a108">TransformPQR</a>[3]             = {
00154 <span class="stringliteral">"exch pop exch 3 get mul exch pop exch 3 get div "</span>,
00155 <span class="stringliteral">"exch pop exch 4 get mul exch pop exch 4 get div "</span>,
00156 <span class="stringliteral">"exch pop exch 5 get mul exch pop exch 5 get div "</span> };
00157 
<a name="l00158"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a1">00158</a> <span class="preprocessor">#define SRGBCRC 0x678175D2L</span>
00159 <span class="preprocessor"></span>
00160 <span class="preprocessor">#pragma optimize("",off)</span>
00161 <span class="preprocessor"></span>
00162 <span class="comment">/***************************************************************************</span>
00163 <span class="comment">*                               CreateLutCRD</span>
00164 <span class="comment">*  function:</span>
00165 <span class="comment">*    this is the function which creates the Color Rendering Dictionary (CRD)</span>
00166 <span class="comment">*    from the data supplied in the ColorProfile's LUT8 or LUT16 tag.</span>
00167 <span class="comment">*  prototype:</span>
00168 <span class="comment">*       SINT EXTERN CreateLutCRD(</span>
00169 <span class="comment">*                          CHANDLE      cp,</span>
00170 <span class="comment">*                          SINT         Index,</span>
00171 <span class="comment">*                          MEMPTR       lpMem,</span>
00172 <span class="comment">*                          BOOL         AllowBinary)</span>
00173 <span class="comment">*  parameters:</span>
00174 <span class="comment">*       cp          --  Color Profile handle</span>
00175 <span class="comment">*       Index       --  Index of the tag</span>
00176 <span class="comment">*       lpMem       --  Pointer to the memory block</span>
00177 <span class="comment">*       AllowBinary --  1: binary CRD allowed,  0: only ascii CRD allowed.</span>
00178 <span class="comment">*</span>
00179 <span class="comment">*  returns:</span>
00180 <span class="comment">*       SINT        --  !=0 if the function was successful,</span>
00181 <span class="comment">*                         0 otherwise.</span>
00182 <span class="comment">*                       Returns number of bytes required/transferred</span>
00183 <span class="comment">***************************************************************************/</span>
00184 
00185 <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a0">EXTERN</a> 
<a name="l00186"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a109">00186</a> <a class="code" href="../../d2/d9/ps2_8c.html#a188">CreateLutCRD</a> (CHANDLE cp, SINT Index, MEMPTR lpMem, DWORD InputIntent, BOOL AllowBinary)
00187 {
00188     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a> nInputCh, nOutputCh, nGrids;
00189     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a> nInputTable, nOutputTable, nNumbers;
00190     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a17">CSIG</a> Tag, PCS;
00191     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a17">CSIG</a> IntentSig;
00192 
00193     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a> Ret;
00194     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a> i, j;
00195     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a> lpTable;
00196 
00197     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a16">SFLOAT</a> IlluminantWP[3];
00198     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a16">SFLOAT</a> MediaWP[3];
00199     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a> Buff = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00200     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a> MemSize = 0;
00201     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a> lpOldMem = lpMem;
00202     <span class="keywordtype">char</span> PublicArrayName[<a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a1">TempBfSize</a>];
00203     HGLOBAL hMem;
00204     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a> lpLineStart;
00205  <span class="comment">// Check if we can generate the CRD</span>
00206     <span class="keywordflow">if</span> (!<a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a15">GetCPTagSig</a> (cp, <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a27">LPCSIG</a>) &amp; IntentSig) ||
00207         !<a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a16">GetCPElementType</a> (cp, <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a27">LPCSIG</a>) &amp; Tag) ||
00208         ((Tag != <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a91">icSigLut8Type</a>) &amp;&amp; (Tag != <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a90">icSigLut16Type</a>)) ||
00209         !<a class="code" href="../../d2/d9/ps2_8c.html#a40">GetCPConnSpace</a> (cp, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a27">LPCSIG</a>) &amp; PCS) ||
00210         !<a class="code" href="../../d2/d9/ps2_8c.html#a194">GetCPElementSize</a> (cp, <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a25">LPSINT</a>) &amp; MemSize) ||
00211         !<a class="code" href="../../d2/d1/object_8c.html#a7">MemAlloc</a> (MemSize, (HGLOBAL <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a5">FAR</a> *)&amp;hMem, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a29">LPMEMPTR</a>) &amp; Buff) ||
00212         !<a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a19">GetCPElement</a> (cp, <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>, Buff, MemSize))
00213     {
00214         <span class="keywordflow">if</span> (<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> != Buff)
00215         {
00216             <a class="code" href="../../d2/d1/object_8c.html#a9">MemFree</a> (hMem);
00217         }
00218         <span class="keywordflow">return</span> (0);
00219     }
00220     <a class="code" href="../../d7/d4/jul98_2test_2getcsa_8h.html#a7">GetCLUTinfo</a>(Tag, Buff, &amp;nInputCh, &amp;nOutputCh, 
00221         &amp;nGrids, &amp;nInputTable, &amp;nOutputTable, &amp;i);
00222  <span class="comment">// Level 2 printers support only tri-component CIEBasedABC input,</span>
00223  <span class="comment">// but can have either 3 or 4 output channels.</span>
00224     <span class="keywordflow">if</span> (((nOutputCh != 3) &amp;&amp;
00225          (nOutputCh != 4)) ||
00226         (nInputCh != 3))
00227     {
00228         <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a39">SetCPLastError</a> (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a48a47">CP_POSTSCRIPT_ERR</a>);
00229         <a class="code" href="../../d2/d1/object_8c.html#a9">MemFree</a> (hMem);
00230         <span class="keywordflow">return</span> (0);
00231     }
00232     Ret = nInputCh * nInputTable * 6 +
00233         nOutputCh * nOutputTable * 6 +  <span class="comment">// Number of INT bytes</span>
00234         nOutputCh * nGrids * nGrids * nGrids * 2 +  <span class="comment">// LUT HEX bytes</span>
00235         nInputCh * (lstrlen (<a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a84">IndexArray</a>) +
00236                     lstrlen (<a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a89">StartClip</a>) +
00237                     lstrlen (<a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a90">EndClip</a>)) +
00238         nOutputCh * (lstrlen (<a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a84">IndexArray</a>) +
00239                      lstrlen (<a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a89">StartClip</a>) +
00240                      lstrlen (<a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a90">EndClip</a>)) +
00241         2048;                           <span class="comment">// + other PS stuff</span>
00242 
00243     <span class="keywordflow">if</span> (lpMem == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)                  <span class="comment">// This is a size request</span>
00244     {
00245         <a class="code" href="../../d2/d1/object_8c.html#a9">MemFree</a> (hMem);
00246         <span class="keywordflow">return</span> (Ret);
00247     }
00248 <span class="comment">//  Get all necessary params from the header</span>
00249 <span class="comment">//  GetCPRenderIntent (cp, (LPCSIG) &amp; Intent);  // Get Intent</span>
00250     <a class="code" href="../../d2/d9/ps2_8c.html#a191">GetCPWhitePoint</a> (cp, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a26">LPSFLOAT</a>) &amp; IlluminantWP);          <span class="comment">// .. Illuminant</span>
00251 
00252  <span class="comment">// Support absolute whitePoint</span>
00253     <span class="keywordflow">if</span> (InputIntent == <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a145">icAbsoluteColorimetric</a>)
00254     {
00255         <span class="keywordflow">if</span> (!<a class="code" href="../../d2/d9/ps2_8c.html#a192">GetCPMediaWhitePoint</a> (cp, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a26">LPSFLOAT</a>) &amp; MediaWP)) <span class="comment">// .. Media WhitePoint</span>
00256         {
00257             MediaWP[0] = IlluminantWP[0];
00258             MediaWP[1] = IlluminantWP[1];
00259             MediaWP[2] = IlluminantWP[2];
00260         }
00261     }
00262 
00263 <span class="comment">//******** Define golbal array used in EncodeABC and RenderTaber</span>
00264     <a class="code" href="../../d2/d9/ps2_8c.html#a217">GetPublicArrayName</a> (cp, IntentSig, PublicArrayName);
00265     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a223">WriteNewLineObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a59">CRDBegin</a>);
00266 
00267     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a220">EnableGlobalDict</a>(lpMem);
00268     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a221">BeginGlobalDict</a>(lpMem);
00269 
00270     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a215">CreateInputArray</a> (lpMem, nInputCh, nInputTable,
00271              (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a>) PublicArrayName, Tag, Buff, <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a27">AllowBinary</a>, <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>);
00272 
00273     i = nInputTable * nInputCh +
00274         nGrids * nGrids * nGrids * nOutputCh;
00275     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a216">CreateOutputArray</a> (lpMem, nOutputCh, nOutputTable, i,
00276              (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a>) PublicArrayName, Tag, Buff, <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a27">AllowBinary</a>, <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>);
00277 
00278     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a222">EndGlobalDict</a>(lpMem);
00279 
00280 <span class="comment">//************* Start writing  CRD  ****************************</span>
00281     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a223">WriteNewLineObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a8">BeginDict</a>);    <span class="comment">// Begin dictionary</span>
00282     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a11">DictType</a>); <span class="comment">// Dictionary type</span>
00283     
00284     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a223">WriteNewLineObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a12">IntentType</a>); <span class="comment">// RenderingIntent</span>
00285     <span class="keywordflow">switch</span> (InputIntent)
00286     {
00287         <span class="keywordflow">case</span> <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a142">icPerceptual</a>:
00288             lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a13">IntentPer</a>);
00289             <span class="keywordflow">break</span>;
00290 
00291         <span class="keywordflow">case</span> <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a144">icSaturation</a>:
00292             lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a14">IntentSat</a>);
00293             <span class="keywordflow">break</span>;
00294 
00295         <span class="keywordflow">case</span> <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a143">icRelativeColorimetric</a>:
00296             lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a16">IntentRCol</a>);
00297             <span class="keywordflow">break</span>;
00298 
00299         <span class="keywordflow">case</span> <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a145">icAbsoluteColorimetric</a>:
00300             lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a15">IntentACol</a>);
00301             <span class="keywordflow">break</span>;
00302     }
00303     
00304  <span class="comment">//********** Send Black/White Point.</span>
00305     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a203">SendCRDBWPoint</a>(lpMem, IlluminantWP);
00306 
00307  <span class="comment">//********** Send PQR - used for Absolute Colorimetric *****</span>
00308     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a204">SendCRDPQR</a>(lpMem, InputIntent, IlluminantWP);
00309 
00310  <span class="comment">//********** Send LMN - For Absolute Colorimetric use WhitePoint's XYZs</span>
00311     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a205">SendCRDLMN</a>(lpMem, InputIntent, IlluminantWP, MediaWP, PCS);
00312 
00313  <span class="comment">// ******** Create MatrixABC and  EncodeABC  stuff</span>
00314     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a206">SendCRDABC</a>(lpMem, PublicArrayName, 
00315         PCS, nInputCh, Buff, <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>, Tag, <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a27">AllowBinary</a>);
00316 
00317  <span class="comment">//********** /RenderTable</span>
00318     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a223">WriteNewLineObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a29">RenderTableTag</a>);
00319     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a4">BeginArray</a>);
00320 
00321     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a44">WriteInt</a> (lpMem, nGrids);  <span class="comment">// Send down Na</span>
00322     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a44">WriteInt</a> (lpMem, nGrids);  <span class="comment">// Send down Nb</span>
00323     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a44">WriteInt</a> (lpMem, nGrids);  <span class="comment">// Send down Nc</span>
00324 
00325     lpLineStart = lpMem;
00326     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a223">WriteNewLineObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a4">BeginArray</a>);
00327     nNumbers = nGrids * nGrids * nOutputCh;
00328     <span class="keywordflow">for</span> (i = 0; i &lt; nGrids; i++)        <span class="comment">// Na strings should be sent</span>
00329     {
00330         lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a56">NewLine</a>);
00331         lpLineStart = lpMem;
00332         <span class="keywordflow">if</span> (Tag == <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a91">icSigLut8Type</a>)
00333         {
00334             lpTable = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a>) (((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a37">lpcpLut8Type</a>) Buff)-&gt;lut.data) +
00335                 nInputTable * nInputCh +
00336                 nNumbers * i;
00337         } <span class="keywordflow">else</span>
00338         {
00339             lpTable = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a>) (((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a36">lpcpLut16Type</a>) Buff)-&gt;lut.data) +
00340                 2 * nInputTable * nInputCh +
00341                 2 * nNumbers * i;
00342         }
00343         <span class="keywordflow">if</span> (!<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a27">AllowBinary</a>)               <span class="comment">// Output ASCII CRD</span>
00344         {
00345             lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a2">BeginString</a>);
00346             <span class="keywordflow">if</span> (Tag == <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a91">icSigLut8Type</a>)
00347                 lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a227">WriteHexBuffer</a> (lpMem, lpTable, lpLineStart, nNumbers);
00348             <span class="keywordflow">else</span>
00349             {
00350                 <span class="keywordflow">for</span> (j = 0; j &lt; nNumbers; j++)
00351                 {
00352                     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a45">WriteHex</a> (lpMem, <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a2">ui16toSINT</a> (lpTable) / 256);
00353                     lpTable += <span class="keyword">sizeof</span> (<a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a185">icUInt16Number</a>);
00354                     <span class="keywordflow">if</span> (((<a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>) (lpMem - lpLineStart)) &gt; <a class="code" href="../../d2/d9/aug98_2dll32_2csprof_8h.html#a4">MAX_LINELENG</a>)
00355                     {
00356                         lpLineStart = lpMem;
00357                         lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a56">NewLine</a>);
00358                     }
00359                 }
00360             }
00361             lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a3">EndString</a>);
00362         } <span class="keywordflow">else</span>
00363         {                               <span class="comment">// Output BINARY CRD</span>
00364             lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a228">WriteStringToken</a> (lpMem, 143, nNumbers);
00365             <span class="keywordflow">if</span> (Tag == <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a91">icSigLut8Type</a>)
00366                 lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a229">WriteByteString</a> (lpMem, lpTable, nNumbers);
00367             <span class="keywordflow">else</span>
00368                 lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a230">WriteInt2ByteString</a> (lpMem, lpTable, nNumbers);
00369         }
00370     }
00371 
00372     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a5">EndArray</a>); <span class="comment">// End array</span>
00373     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a44">WriteInt</a> (lpMem, nOutputCh);   <span class="comment">// Send down m</span>
00374 
00375  <span class="comment">//********** Send Output Table.</span>
00376     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a207">SendCRDOutputTable</a>(lpMem, PublicArrayName, 
00377         nOutputCh, Tag, <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>, <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a27">AllowBinary</a>);
00378 
00379     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a5">EndArray</a>); <span class="comment">// End array</span>
00380     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a9">EndDict</a>);  <span class="comment">// End dictionary definition</span>
00381 
00382     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a223">WriteNewLineObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a60">CRDEnd</a>);
00383 
00384 <span class="comment">// Testing Convert binary to ascii</span>
00385 <span class="comment">//    i = ConvertBinaryData2Ascii(lpOldMem, (SINT)(lpMem - lpOldMem), Ret);</span>
00386 <span class="comment">//    lpMem = lpOldMem + i;</span>
00387 <span class="comment">// Testing Convert binary to ascii</span>
00388 
00389     <a class="code" href="../../d2/d1/object_8c.html#a9">MemFree</a> (hMem);
00390     <span class="keywordflow">return</span> ((<a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>) ((<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>) (lpMem - lpOldMem)));
00391 }
00392 <span class="comment">/***************************************************************************</span>
00393 <span class="comment">*                               GetRevCurve</span>
00394 <span class="comment">*  function:</span>
00395 <span class="comment">*  prototype:</span>
00396 <span class="comment">*       BOOL  GetRevCurve(</span>
00397 <span class="comment">*                          MEMPTR       Buff,</span>
00398 <span class="comment">*                          MEMPTR       lpRevCurve)</span>
00399 <span class="comment">*  parameters:</span>
00400 <span class="comment">*       Buff        --</span>
00401 <span class="comment">*       lpRevCurve  --</span>
00402 <span class="comment">*  returns:</span>
00403 <span class="comment">*       BOOL        --  TRUE:  successful,</span>
00404 <span class="comment">*                       FALSE: otherwise.</span>
00405 <span class="comment">***************************************************************************/</span>
00406 
00407 <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>
<a name="l00408"></a><a class="code" href="../../d6/d3/jul98_2test_2getcrd_8h.html#a6">00408</a> <a class="code" href="../../d2/d9/ps2_8c.html#a218">GetRevCurve</a> (MEMPTR lpBuff, MEMPTR lpCurve, MEMPTR lpRevCurve)
00409 {
00410     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a> i, j, nCount;
00411     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a> lpTable;
00412     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a22">PUSHORT</a> lpInput, lpOutput;
00413     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a16">SFLOAT</a> fTemp;
00414     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a> iBegin, iEnd, iTemp;
00415     nCount = <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a3">ui32toSINT</a> (((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a35">lpcpCurveType</a>) lpBuff)-&gt;curve.count);
00416     lpTable = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a>) (((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a35">lpcpCurveType</a>) lpBuff)-&gt;curve.data);
00417     lpOutput = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a22">PUSHORT</a>) lpRevCurve;
00418     lpInput = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a22">PUSHORT</a>) lpCurve;
00419 
00420     <span class="keywordflow">for</span> (i = 0; i &lt; nCount; i++)
00421     {
00422         lpInput[i] = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>) (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a2">ui16toSINT</a> (lpTable));
00423         lpTable += <span class="keyword">sizeof</span> (<a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a185">icUInt16Number</a>);
00424     }
00425 
00426     j = nCount * <a class="code" href="../../d1/d6/aug98_2dll32_2icm_8h.html#a32">REVCURVE_RATIO</a>;
00427     <span class="keywordflow">for</span> (i = 0; i &lt; j; i++)
00428     {
00429         fTemp = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a16">SFLOAT</a>) i *65535 / (j - 1);
00430         lpOutput[i] = (fTemp &lt; 65535) ? (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>) fTemp : (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>) 65535;
00431     }
00432 
00433     <span class="keywordflow">for</span> (i = 0; i &lt; j; i++)
00434     {
00435         iBegin = 0;
00436         iEnd = nCount - 1;
00437         <span class="keywordflow">for</span> (;;)
00438         {
00439             <span class="keywordflow">if</span> ((iEnd - iBegin) &lt;= 1)
00440                 <span class="keywordflow">break</span>;
00441             iTemp = (iEnd + iBegin) / 2;
00442             <span class="keywordflow">if</span> (lpOutput[i] &lt; lpInput[iTemp])
00443                 iEnd = iTemp;
00444             <span class="keywordflow">else</span>
00445                 iBegin = iTemp;
00446         }
00447         <span class="keywordflow">if</span> (lpOutput[i] &lt;= lpInput[iBegin])
00448             fTemp = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a16">SFLOAT</a>) iBegin;
00449         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (lpOutput[i] &gt;= lpInput[iEnd])
00450             fTemp = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a16">SFLOAT</a>) iEnd;
00451         <span class="keywordflow">else</span>
00452         {
00453             fTemp = ((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a16">SFLOAT</a>) (lpInput[iEnd] - lpOutput[i])) /
00454                 (lpOutput[i] - lpInput[iBegin]);
00455             fTemp = (iBegin * fTemp + iEnd) / (fTemp + 1);
00456         }
00457         fTemp = (fTemp / (nCount - 1)) * 65535;
00458         lpOutput[i] = (fTemp &lt; 65535) ? (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>) fTemp : (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>) 65535;
00459     }
00460 
00461     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00462 }
00463 <span class="comment">/***************************************************************************</span>
00464 <span class="comment">*                               CreateMonoCRD</span>
00465 <span class="comment">*  function:</span>
00466 <span class="comment">*    this is the function which creates the Color Rendering Dictionary (CRD)</span>
00467 <span class="comment">*    from the data supplied in the GrayTRC tag.</span>
00468 <span class="comment">*  prototype:</span>
00469 <span class="comment">*       BOOL EXTERN CreateMonoCRD(</span>
00470 <span class="comment">*                          CHANDLE      cp,</span>
00471 <span class="comment">*                          SINT         Index,</span>
00472 <span class="comment">*                          MEMPTR       lpMem)</span>
00473 <span class="comment">*  parameters:</span>
00474 <span class="comment">*       cp          --  Color Profile handle</span>
00475 <span class="comment">*       Index       --  Index of the tag</span>
00476 <span class="comment">*       lpMem       --  Pointer to the memory block</span>
00477 <span class="comment">*  returns:</span>
00478 <span class="comment">*       SINT        --  !=0 if the function was successful,</span>
00479 <span class="comment">*                         0 otherwise.</span>
00480 <span class="comment">*                       Returns number of bytes required/transferred</span>
00481 <span class="comment">***************************************************************************/</span>
00482 <span class="comment">//  According to the spec this tag-based function only converts from</span>
00483 <span class="comment">//  Device to PCS, so we need to create an inverse function to perform</span>
00484 <span class="comment">//  PCS-&gt;device conversion. By definition the CRD is only</span>
00485 <span class="comment">//  for XYZ-&gt;DeviceRGB/CMYK conversion.</span>
00486 <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a0">EXTERN</a> 
<a name="l00487"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a111">00487</a> <a class="code" href="../../d2/d9/ps2_8c.html#a187">CreateMonoCRD</a> (CHANDLE cp, SINT Index, MEMPTR lpMem, DWORD InputIntent)
00488 {
00489     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a> nCount;
00490     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a17">CSIG</a> Tag, PCS;
00491 
00492     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a> Buff = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00493     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a> MemSize = 0;
00494     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a> lpOldMem = lpMem;
00495     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a> lpCurve, lpRevCurve;
00496     HGLOBAL hRevCurve;
00497     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a> Ret = 0;
00498     HGLOBAL hMem;
00499     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a> i;
00500     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a> lpTable;
00501     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a16">SFLOAT</a> IlluminantWP[3];
00502     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a16">SFLOAT</a> MediaWP[3];
00503     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a> lpLineStart;
00504  <span class="comment">// Check if we can generate the CRD</span>
00505     <span class="keywordflow">if</span> (!<a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a16">GetCPElementType</a> (cp, <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a27">LPCSIG</a>) &amp; Tag) ||
00506         (Tag != <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a87">icSigCurveType</a>) ||
00507         !<a class="code" href="../../d2/d9/ps2_8c.html#a40">GetCPConnSpace</a> (cp, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a27">LPCSIG</a>) &amp; PCS) ||
00508         !<a class="code" href="../../d2/d9/ps2_8c.html#a194">GetCPElementSize</a> (cp, <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a25">LPSINT</a>) &amp; MemSize) ||
00509         !<a class="code" href="../../d2/d1/object_8c.html#a7">MemAlloc</a> (MemSize, (HGLOBAL <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a5">FAR</a> *)&amp;hMem, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a29">LPMEMPTR</a>) &amp; Buff) ||
00510         !<a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a19">GetCPElement</a> (cp, <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>, Buff, MemSize))
00511     {
00512         <span class="keywordflow">if</span> (<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> != Buff)
00513         {
00514             <a class="code" href="../../d2/d1/object_8c.html#a9">MemFree</a> (hMem);
00515         }
00516         <span class="keywordflow">return</span> (0);
00517     }
00518     nCount = <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a3">ui32toSINT</a> (((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a35">lpcpCurveType</a>) Buff)-&gt;curve.count);
00519 
00520  <span class="comment">// Estimate the memory size required to hold CRD</span>
00521  <span class="comment">// SRGB98</span>
00522     Ret = nCount * 6 * <a class="code" href="../../d1/d6/aug98_2dll32_2icm_8h.html#a32">REVCURVE_RATIO</a> + <span class="comment">// Number of INT elements</span>
00523         2048;                           <span class="comment">// + other PS stuff</span>
00524     <span class="keywordflow">if</span> (lpMem == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)                  <span class="comment">// This is a size request</span>
00525     {
00526         <a class="code" href="../../d2/d1/object_8c.html#a9">MemFree</a> (hMem);
00527         <span class="keywordflow">return</span> (Ret);
00528     }
00529     <span class="keywordflow">if</span> (!<a class="code" href="../../d2/d1/object_8c.html#a7">MemAlloc</a> (nCount * 2 * (<a class="code" href="../../d1/d6/aug98_2dll32_2icm_8h.html#a32">REVCURVE_RATIO</a> + 1),
00530                    (HGLOBAL <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a5">FAR</a> *) &amp;hRevCurve, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a29">LPMEMPTR</a>) &amp; lpRevCurve))
00531     {
00532         <a class="code" href="../../d2/d1/object_8c.html#a9">MemFree</a> (hMem);
00533         <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00534     }
00535     lpCurve = lpRevCurve + 2 * <a class="code" href="../../d1/d6/aug98_2dll32_2icm_8h.html#a32">REVCURVE_RATIO</a> * nCount;
00536     <a class="code" href="../../d2/d9/ps2_8c.html#a218">GetRevCurve</a> (Buff, lpCurve, lpRevCurve);
00537 
00538  <span class="comment">//   GetCPCMMType (cp, (LPCSIG) &amp; Intent);   // Get Intent</span>
00539     <a class="code" href="../../d2/d9/ps2_8c.html#a191">GetCPWhitePoint</a> (cp, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a26">LPSFLOAT</a>) &amp; IlluminantWP);          <span class="comment">// .. Illuminant</span>
00540 
00541  <span class="comment">// Support absolute whitePoint</span>
00542     <span class="keywordflow">if</span> (InputIntent == <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a145">icAbsoluteColorimetric</a>)
00543     {
00544         <span class="keywordflow">if</span> (!<a class="code" href="../../d2/d9/ps2_8c.html#a192">GetCPMediaWhitePoint</a> (cp, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a26">LPSFLOAT</a>) &amp; MediaWP)) <span class="comment">// .. Media WhitePoint</span>
00545         {
00546             MediaWP[0] = IlluminantWP[0];
00547             MediaWP[1] = IlluminantWP[1];
00548             MediaWP[2] = IlluminantWP[2];
00549         }
00550     }
00551 
00552 <span class="comment">//************* Start writing  CRD  ****************************</span>
00553     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a223">WriteNewLineObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a8">BeginDict</a>);    <span class="comment">// Begin dictionary</span>
00554     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a11">DictType</a>); <span class="comment">// Dictionary type</span>
00555 
00556     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a223">WriteNewLineObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a12">IntentType</a>); <span class="comment">// RenderingIntent</span>
00557     <span class="keywordflow">switch</span> (InputIntent)
00558     {
00559         <span class="keywordflow">case</span> <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a142">icPerceptual</a>:
00560             lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a13">IntentPer</a>);
00561             <span class="keywordflow">break</span>;
00562 
00563         <span class="keywordflow">case</span> <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a144">icSaturation</a>:
00564             lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a14">IntentSat</a>);
00565             <span class="keywordflow">break</span>;
00566         
00567         <span class="keywordflow">case</span> <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a143">icRelativeColorimetric</a>:
00568             lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a16">IntentRCol</a>);
00569             <span class="keywordflow">break</span>;
00570         
00571         <span class="keywordflow">case</span> <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a145">icAbsoluteColorimetric</a>:
00572             lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a15">IntentACol</a>);
00573             <span class="keywordflow">break</span>;
00574     }
00575     
00576  <span class="comment">//********** Send Black/White Point.</span>
00577     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a203">SendCRDBWPoint</a>(lpMem, IlluminantWP);
00578 
00579  <span class="comment">//********** /TransformPQR</span>
00580     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a204">SendCRDPQR</a>(lpMem, InputIntent, IlluminantWP);
00581 
00582  <span class="comment">//********** /MatrixLMN</span>
00583     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a205">SendCRDLMN</a>(lpMem, InputIntent, IlluminantWP, MediaWP, PCS);
00584 
00585  <span class="comment">//********** /MatrixABC</span>
00586     <span class="keywordflow">if</span> (PCS == <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a109">icSigXYZData</a>)
00587     {   <span class="comment">// Switch ABC to BAC, since we want to output B which is converted from Y.</span>
00588         lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a223">WriteNewLineObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a24">MatrixABCTag</a>);
00589         lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a103">MatrixABCXYZCRD</a>);
00590     }
00591     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (PCS == <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a110">icSigLabData</a>)
00592     {
00593         lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a223">WriteNewLineObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a24">MatrixABCTag</a>);
00594         lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a102">MatrixABCLabCRD</a>);
00595     }
00596  <span class="comment">//********** /EncodeABC</span>
00597     <span class="keywordflow">if</span> (nCount != 0)
00598     {
00599         lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a56">NewLine</a>);
00600         lpLineStart = lpMem;
00601         lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a25">EncodeABCTag</a>);
00602         lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a4">BeginArray</a>);
00603         lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a6">BeginFunction</a>);
00604         <span class="keywordflow">if</span> (nCount == 1)                <span class="comment">// Gamma supplied in ui16 format</span>
00605         {
00606             lpTable = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a>) (((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a35">lpcpCurveType</a>) Buff)-&gt;curve.data);
00607             lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a44">WriteInt</a> (lpMem, <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a2">ui16toSINT</a> (lpTable));
00608             lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a75">DecodeA3Rev</a>);
00609         } <span class="keywordflow">else</span>
00610         {
00611             <span class="keywordflow">if</span> (PCS == <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a110">icSigLabData</a>)
00612             {
00613                 lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a104">EncodeABCLab1</a>);
00614             }
00615             lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a89">StartClip</a>);
00616             lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a4">BeginArray</a>);
00617             <span class="keywordflow">for</span> (i = 0; i &lt; nCount * <a class="code" href="../../d1/d6/aug98_2dll32_2icm_8h.html#a32">REVCURVE_RATIO</a>; i++)
00618             {
00619                 lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a44">WriteInt</a> (lpMem, (<a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>) (*((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a22">PUSHORT</a>) lpRevCurve)));
00620                 lpRevCurve += <span class="keyword">sizeof</span> (<a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a185">icUInt16Number</a>);
00621                 <span class="keywordflow">if</span> (((<a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>) (lpMem - lpLineStart)) &gt; <a class="code" href="../../d2/d9/aug98_2dll32_2csprof_8h.html#a4">MAX_LINELENG</a>)
00622                 {
00623                     lpLineStart = lpMem;
00624                     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a56">NewLine</a>);
00625                 }
00626             }
00627             lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a5">EndArray</a>);
00628             lpLineStart = lpMem;
00629             lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a223">WriteNewLineObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a84">IndexArray</a>);
00630             lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a92">Scale16</a>);
00631             lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a90">EndClip</a>);
00632         }
00633         lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a7">EndFunction</a>);
00634         lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a44">DupOp</a>);
00635         lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a44">DupOp</a>);
00636         lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a5">EndArray</a>);
00637     }
00638     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a9">EndDict</a>);  <span class="comment">// End dictionary definition</span>
00639 
00640     <a class="code" href="../../d2/d1/object_8c.html#a9">MemFree</a> (hRevCurve);
00641     <a class="code" href="../../d2/d1/object_8c.html#a9">MemFree</a> (hMem);
00642     <span class="keywordflow">return</span> ((<a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>) ((<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>) (lpMem - lpOldMem)));
00643 }
00644 
00645 <span class="comment">// SRGB98 start</span>
00646 <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>
<a name="l00647"></a><a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a62">00647</a> <a class="code" href="../../d2/d9/ps2_8c.html#a197">GetTRCElementSize</a>(CHANDLE cp, CSIG icSigXTRCTag, LPSINT pIndex, LPSINT pTRCSize)
00648 {
00649     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a17">CSIG</a> Tag;
00650 
00651     <span class="keywordflow">if</span> (!<a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a12">GetCPTagIndex</a> (cp, icSigXTRCTag, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a25">LPSINT</a>) pIndex) ||
00652         !<a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a16">GetCPElementType</a> (cp, *pIndex, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a27">LPCSIG</a>) &amp; Tag) ||
00653         !(Tag == <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a87">icSigCurveType</a>) ||
00654         !<a class="code" href="../../d2/d9/ps2_8c.html#a194">GetCPElementSize</a> (cp, *pIndex, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a25">LPSINT</a>) pTRCSize))
00655     {
00656         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00657     }
00658     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00659 }
00660 
00661 <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>
<a name="l00662"></a><a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a61">00662</a> <a class="code" href="../../d2/d9/ps2_8c.html#a190">DoesTRCAndColorantTagExist</a> (CHANDLE cp)
00663 {
00664     <span class="keywordflow">if</span> (<a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a> (cp, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a55">icSigRedColorantTag</a>) &amp;&amp;
00665         <a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a> (cp, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a56">icSigRedTRCTag</a> ) &amp;&amp;
00666         <a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a> (cp, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a34">icSigGreenColorantTag</a>) &amp;&amp;
00667         <a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a> (cp, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a35">icSigGreenTRCTag</a> ) &amp;&amp;
00668         <a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a> (cp, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a21">icSigBlueColorantTag</a>) &amp;&amp;
00669         <a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a> (cp, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a22">icSigBlueTRCTag</a> ))
00670     {
00671         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00672     }
00673 
00674     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00675 }
00676 
00677 <span class="keyword">static</span> <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a> 
<a name="l00678"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a114">00678</a> <a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a106">CreateRevArray</a> (CHANDLE cp, MEMPTR lpMem, MEMPTR lpBuff, 
00679                 MEMPTR lpRevCurve, CSIG CPTag, BOOL AllowBinary)
00680 {
00681     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a> i, nCount;
00682     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a> MemSize = 0;
00683     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a> lpOldMem, lpLineStart;
00684     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a> lpCurve;
00685 
00686     lpOldMem = lpMem;
00687 
00688     lpLineStart = lpMem;
00689     nCount = <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a3">ui32toSINT</a> (((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a35">lpcpCurveType</a>) lpBuff)-&gt;curve.count);
00690     <span class="keywordflow">if</span> (nCount &gt; 1)
00691     {
00692         lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a223">WriteNewLineObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a57">Slash</a>);
00693         lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a77">InputArray</a>);
00694         lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a44">WriteInt</a> (lpMem, (<a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>) CPTag);
00695 
00696         lpCurve = lpRevCurve + 2 * <a class="code" href="../../d1/d6/aug98_2dll32_2icm_8h.html#a32">REVCURVE_RATIO</a> * nCount;
00697         <a class="code" href="../../d2/d9/ps2_8c.html#a218">GetRevCurve</a> (lpBuff, lpCurve, lpRevCurve);
00698 
00699         <span class="keywordflow">if</span> (!<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a27">AllowBinary</a>)           <span class="comment">// Output ASCII DATA</span>
00700         {
00701             lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a4">BeginArray</a>);
00702             <span class="keywordflow">for</span> (i = 0; i &lt; nCount * <a class="code" href="../../d1/d6/aug98_2dll32_2icm_8h.html#a32">REVCURVE_RATIO</a>; i++)
00703             {
00704                 lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a44">WriteInt</a> (lpMem, (<a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>) (*((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a22">PUSHORT</a>) lpRevCurve)));
00705                 lpRevCurve += <span class="keyword">sizeof</span> (<a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a185">icUInt16Number</a>);
00706                 <span class="keywordflow">if</span> (((<a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>) (lpMem - lpLineStart)) &gt; <a class="code" href="../../d2/d9/aug98_2dll32_2csprof_8h.html#a4">MAX_LINELENG</a>)
00707                 {
00708                     lpLineStart = lpMem;
00709                     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a56">NewLine</a>);
00710                 }
00711             }
00712             lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a5">EndArray</a>);
00713         } <span class="keywordflow">else</span>
00714         {                           <span class="comment">// Output BINARY DATA</span>
00715             lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a224">WriteHNAToken</a> (lpMem, 149, nCount);
00716             lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a226">WriteIntStringU2S_L</a> (lpMem, lpRevCurve, nCount);
00717         }
00718     }
00719     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a49">DefOp</a>);
00720     <span class="keywordflow">return</span> ((<a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>) (lpMem - lpOldMem));
00721 }
00722 
00723 <span class="keyword">static</span> <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a> 
<a name="l00724"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a115">00724</a> <a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a107">SendRevArray</a> (CHANDLE cp, MEMPTR lpMem, MEMPTR lpBuff, 
00725               CSIG CPTag, BOOL AllowBinary)
00726 {
00727     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a> nCount;
00728     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a> lpOldMem;
00729     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a> lpTable;
00730 
00731     lpOldMem = lpMem;
00732     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a6">BeginFunction</a>);
00733     nCount = <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a3">ui32toSINT</a> (((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a35">lpcpCurveType</a>) lpBuff)-&gt;curve.count);
00734     <span class="keywordflow">if</span> (nCount != 0)
00735     {
00736         <span class="keywordflow">if</span> (nCount == 1)            <span class="comment">// Gamma supplied in ui16 format</span>
00737         {
00738             lpTable = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a>) (((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a35">lpcpCurveType</a>) lpBuff)-&gt;curve.data);
00739             lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a44">WriteInt</a> (lpMem, <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a2">ui16toSINT</a> (lpTable));
00740             lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a75">DecodeA3Rev</a>);
00741         } <span class="keywordflow">else</span>
00742         {
00743             lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a89">StartClip</a>);
00744             lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a77">InputArray</a>);
00745             lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a44">WriteInt</a> (lpMem, (<a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>) CPTag);
00746 
00747             <span class="keywordflow">if</span> (!<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a27">AllowBinary</a>)       <span class="comment">// Output ASCII CS</span>
00748             {
00749                 lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a84">IndexArray</a>);
00750             } <span class="keywordflow">else</span>
00751             {                       <span class="comment">// Output BINARY CS</span>
00752                 lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a83">IndexArray16b</a>);
00753             }
00754             lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a92">Scale16</a>);
00755             lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a90">EndClip</a>);
00756         }
00757     }
00758     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a7">EndFunction</a>);
00759     <span class="keywordflow">return</span> ((<a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>) (lpMem - lpOldMem));
00760 }
00761 
00762 <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a> 
<a name="l00763"></a><a class="code" href="../../d6/d3/jul98_2test_2getcrd_8h.html#a7">00763</a> <a class="code" href="../../d2/d9/ps2_8c.html#a251">CreateColorantArray</a>(CHANDLE cp, <span class="keywordtype">double</span> FAR *lpArray, CSIG CPTag)
00764 {
00765     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a> i, <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>;
00766     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a> lpTable;
00767     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a> Buff = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00768     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a> MemSize = 0;
00769     HGLOBAL hBuff;
00770 
00771     <span class="keywordflow">if</span> (<a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a12">GetCPTagIndex</a> (cp, CPTag, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a25">LPSINT</a>) &amp; <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>) &amp;&amp;
00772         <a class="code" href="../../d2/d9/ps2_8c.html#a194">GetCPElementSize</a> (cp, <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a25">LPSINT</a>) &amp; MemSize) &amp;&amp;
00773         <a class="code" href="../../d2/d1/object_8c.html#a7">MemAlloc</a> (MemSize, (HGLOBAL <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a5">FAR</a> *)&amp;hBuff, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a29">LPMEMPTR</a>) &amp; Buff) &amp;&amp;
00774         <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a19">GetCPElement</a> (cp, <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>, Buff, MemSize))
00775     {
00776         lpTable = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a>) &amp; (((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a38">lpcpXYZType</a>) Buff)-&gt;data);
00777         <span class="keywordflow">for</span> (i = 0; i &lt; 3; i++)
00778         {
00779             *lpArray++ = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a16">SFLOAT</a>)<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a9">si16f16toSFLOAT</a> (lpTable);
00780             lpTable += <span class="keyword">sizeof</span> (<a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a192">icS15Fixed16Number</a>);
00781         }
00782         <a class="code" href="../../d2/d1/object_8c.html#a9">MemFree</a> (hBuff);
00783     }
00784     <span class="keywordflow">return</span> ( <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> );
00785 }  
00786 
00787 
00788 <span class="comment">/***************************************************************************</span>
00789 <span class="comment">*                           IsSRGB</span>
00790 <span class="comment">*  function: check if the profile is sRGB</span>
00791 <span class="comment">*</span>
00792 <span class="comment">*  parameters:</span>
00793 <span class="comment">*       cp          --  Color Profile handle</span>
00794 <span class="comment">*</span>
00795 <span class="comment">*  returns:</span>
00796 <span class="comment">*       BOOL        --  TRUE if the profile is sRGB</span>
00797 <span class="comment">*                       FALSE otherwise.</span>
00798 <span class="comment">***************************************************************************/</span>
<a name="l00799"></a><a class="code" href="../../d9/d3/jan99_2dll32_2getcsa_8c.html#a2">00799</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a5">FAR</a> <a class="code" href="../../d9/d3/jan99_2dll32_2getcsa_8c.html#a2">IsSRGB</a> (CHANDLE cp)
00800 {   
00801     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    match = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00802     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>    RedTRCIndex, GreenTRCIndex, BlueTRCIndex, RedCIndex, GreenCIndex, BlueCIndex;
00803     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>    MemSize;
00804     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>    RedTRCSize=0, GreenTRCSize=0, BlueTRCSize=0, RedCSize=0, GreenCSize=0, BlueCSize=0;
00805     HGLOBAL hMem;
00806     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a>  lpRed = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>,lpGreen, lpBlue, lpRedC, lpGreenC, lpBlueC;
00807     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>   crc;
00808 
00809     <span class="keywordflow">if</span> (<a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a12">GetCPTagIndex</a> (cp, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a56">icSigRedTRCTag</a>, &amp;RedTRCIndex) &amp;&amp;
00810         <a class="code" href="../../d2/d9/ps2_8c.html#a194">GetCPElementSize</a> (cp, RedTRCIndex, &amp;RedTRCSize)  &amp;&amp;
00811             
00812         <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a12">GetCPTagIndex</a> (cp, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a35">icSigGreenTRCTag</a>, &amp;GreenTRCIndex) &amp;&amp;
00813         <a class="code" href="../../d2/d9/ps2_8c.html#a194">GetCPElementSize</a> (cp, GreenTRCIndex, &amp;GreenTRCSize)  &amp;&amp;
00814             
00815         <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a12">GetCPTagIndex</a> (cp, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a22">icSigBlueTRCTag</a>, &amp;BlueTRCIndex) &amp;&amp;
00816         <a class="code" href="../../d2/d9/ps2_8c.html#a194">GetCPElementSize</a> (cp, BlueTRCIndex, &amp;BlueTRCSize) &amp;&amp; 
00817             
00818         <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a12">GetCPTagIndex</a> (cp, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a55">icSigRedColorantTag</a>, &amp;RedCIndex) &amp;&amp;
00819         <a class="code" href="../../d2/d9/ps2_8c.html#a194">GetCPElementSize</a> (cp, RedCIndex, &amp;RedCSize)  &amp;&amp;
00820             
00821         <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a12">GetCPTagIndex</a> (cp, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a34">icSigGreenColorantTag</a>, &amp;GreenCIndex) &amp;&amp;
00822         <a class="code" href="../../d2/d9/ps2_8c.html#a194">GetCPElementSize</a> (cp, GreenCIndex, &amp;GreenCSize)  &amp;&amp;
00823             
00824         <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a12">GetCPTagIndex</a> (cp, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a21">icSigBlueColorantTag</a>, &amp;BlueCIndex) &amp;&amp;
00825         <a class="code" href="../../d2/d9/ps2_8c.html#a194">GetCPElementSize</a> (cp, BlueCIndex, &amp;BlueCSize) )
00826     {
00827         MemSize = RedTRCSize + GreenTRCSize + BlueTRCSize + RedCSize + GreenCSize + BlueCSize;
00828 
00829         <span class="keywordflow">if</span> ( (MemSize == 6240) &amp;&amp; <span class="comment">// #bytes in sRGBColorTags</span>
00830              <a class="code" href="../../d2/d1/object_8c.html#a7">MemAlloc</a> (MemSize, (HGLOBAL <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a5">FAR</a> *)&amp;hMem, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a29">LPMEMPTR</a>)&amp;lpRed) )
00831         {
00832             lpGreen = lpRed + RedTRCSize;
00833             lpBlue = lpGreen + GreenTRCSize;
00834             lpRedC = lpBlue + BlueTRCSize;
00835             lpGreenC = lpRedC + RedCSize;
00836             lpBlueC = lpGreenC + GreenCSize;
00837             
00838             <span class="keywordflow">if</span> (<a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a19">GetCPElement</a> (cp, RedTRCIndex, lpRed, RedTRCSize) &amp;&amp;
00839                 <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a19">GetCPElement</a> (cp, GreenTRCIndex, lpGreen, GreenTRCSize ) &amp;&amp;
00840                 <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a19">GetCPElement</a> (cp, BlueTRCIndex, lpBlue, BlueTRCSize ) &amp;&amp;
00841                 <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a19">GetCPElement</a> (cp, RedCIndex, lpRedC, RedCSize) &amp;&amp;
00842                 <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a19">GetCPElement</a> (cp, GreenCIndex, lpGreenC, GreenCSize ) &amp;&amp;
00843                 <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a19">GetCPElement</a> (cp, BlueCIndex, lpBlueC, BlueCSize ))
00844             {   
00845                 crc = <a class="code" href="../../d2/d9/ps2_8c.html#a253">crc32</a>( lpRed, 6240 );    
00846                 match = (crc == <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a1">SRGBCRC</a>);
00847             }
00848             <a class="code" href="../../d2/d1/object_8c.html#a9">MemFree</a>(hMem);
00849         }    
00850     }            
00851     <span class="keywordflow">return</span> (match);
00852 }
00853 
00854 <span class="comment">/***************************************************************************</span>
00855 <span class="comment">*                           CreateMatrixCRD</span>
00856 <span class="comment">*  function:</span>
00857 <span class="comment">*    this is the function which creates the Color Rendering Dictionary (CRD)</span>
00858 <span class="comment">*    from the data supplied in the redTRC, greenTRC, blueTRA, redColorant,</span>
00859 <span class="comment">*    greenColorant and BlueColorant tags</span>
00860 <span class="comment">*  prototype:</span>
00861 <span class="comment">*       BOOL EXTERN CreateMatrixCRD(</span>
00862 <span class="comment">*                          CHANDLE      cp,</span>
00863 <span class="comment">*                          MEMPTR       lpMem,</span>
00864 <span class="comment">*                          BOOL         AllowBinary)</span>
00865 <span class="comment">*  parameters:</span>
00866 <span class="comment">*       cp          --  Color Profile handle</span>
00867 <span class="comment">*       lpMem       --  Pointer to the memory block</span>
00868 <span class="comment">*       AllowBinary --</span>
00869 <span class="comment">*  returns:</span>
00870 <span class="comment">*       SINT        --  !=0 if the function was successful,</span>
00871 <span class="comment">*                         0 otherwise.</span>
00872 <span class="comment">*                       Returns number of bytes required/transferred</span>
00873 <span class="comment">***************************************************************************/</span>
00874 <span class="comment">// With matrix/TRC model, only the CIEXYZ encoding of the PCS can be used.</span>
00875 <span class="comment">// So, we don't need to worry about CIELAB.</span>
00876 <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a0">EXTERN</a> 
<a name="l00877"></a><a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a118">00877</a> <a class="code" href="../../d2/d9/ps2_8c.html#a234">CreateMatrixCRD</a> (CHANDLE cp, MEMPTR lpMem, DWORD InputIntent, BOOL AllowBinary)
00878 {
00879     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a> RedTRCIndex, GreenTRCIndex, BlueTRCIndex;
00880     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a> i, MemSize;
00881     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a> nRedCount, nGreenCount, nBlueCount;
00882     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a> lpRed = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>,lpGreen, lpBlue;
00883     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a> RedTRCSize = 0, GreenTRCSize = 0, BlueTRCSize = 0;
00884     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a> lpOldMem = lpMem;
00885     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a> lpRevCurve;
00886     HGLOBAL hRevCurve;
00887     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a> Ret = 0;
00888     HGLOBAL hMem;
00889     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a16">SFLOAT</a> IlluminantWP[3];
00890     <span class="keywordtype">double</span> Colorant[9];
00891     <span class="keywordtype">double</span> RevColorant[9];
00892  
00893  <span class="comment">// Check if we can generate the CRD</span>
00894     <span class="keywordflow">if</span> (!<a class="code" href="../../d2/d9/ps2_8c.html#a197">GetTRCElementSize</a>(cp, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a56">icSigRedTRCTag</a>, &amp;RedTRCIndex, &amp;RedTRCSize) ||
00895         !<a class="code" href="../../d2/d9/ps2_8c.html#a197">GetTRCElementSize</a>(cp, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a35">icSigGreenTRCTag</a>, &amp;GreenTRCIndex, &amp;GreenTRCSize) ||
00896         !<a class="code" href="../../d2/d9/ps2_8c.html#a197">GetTRCElementSize</a>(cp, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a22">icSigBlueTRCTag</a>, &amp;BlueTRCIndex, &amp;BlueTRCSize))
00897     {
00898         <span class="keywordflow">return</span> 0;
00899     }
00900     MemSize = RedTRCSize + GreenTRCSize + BlueTRCSize;
00901     <span class="keywordflow">if</span> (!<a class="code" href="../../d2/d1/object_8c.html#a7">MemAlloc</a> (MemSize, (HGLOBAL <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a5">FAR</a> *)&amp;hMem, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a29">LPMEMPTR</a>) &amp; lpRed))
00902         <span class="keywordflow">return</span> 0;
00903 
00904     lpGreen = lpRed + RedTRCSize;
00905     lpBlue = lpGreen + GreenTRCSize;
00906     <span class="keywordflow">if</span> (!<a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a19">GetCPElement</a> (cp, RedTRCIndex, lpRed, RedTRCSize) ||
00907         !<a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a19">GetCPElement</a> (cp, GreenTRCIndex, lpGreen, GreenTRCSize ) ||
00908         !<a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a19">GetCPElement</a> (cp, BlueTRCIndex, lpBlue, BlueTRCSize ))
00909     {
00910         <a class="code" href="../../d2/d1/object_8c.html#a9">MemFree</a> (hMem);
00911         <span class="keywordflow">return</span> (0);
00912     }
00913     nRedCount = <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a3">ui32toSINT</a> (((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a35">lpcpCurveType</a>) lpRed)-&gt;curve.count);
00914     nGreenCount = <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a3">ui32toSINT</a> (((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a35">lpcpCurveType</a>) lpGreen)-&gt;curve.count);
00915     nBlueCount = <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a3">ui32toSINT</a> (((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a35">lpcpCurveType</a>) lpBlue)-&gt;curve.count);
00916 
00917  <span class="comment">// Estimate the memory size required to hold CRD</span>
00918     Ret = (nRedCount + nGreenCount + nBlueCount) * 6 * <a class="code" href="../../d1/d6/aug98_2dll32_2icm_8h.html#a32">REVCURVE_RATIO</a> + 
00919         2048;                <span class="comment">// Number of INT elements + other PS stuff</span>
00920     <span class="keywordflow">if</span> (lpMem == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)       <span class="comment">// This is a size request</span>
00921     {
00922         <a class="code" href="../../d2/d1/object_8c.html#a9">MemFree</a> (hMem);
00923         <span class="keywordflow">return</span> (Ret);
00924     }
00925 
00926     <span class="keywordflow">if</span> (!<a class="code" href="../../d2/d1/object_8c.html#a7">MemAlloc</a> (nRedCount * 2 * (<a class="code" href="../../d1/d6/aug98_2dll32_2icm_8h.html#a32">REVCURVE_RATIO</a> + 1),
00927                   (HGLOBAL <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a5">FAR</a> *) &amp;hRevCurve, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a29">LPMEMPTR</a>) &amp; lpRevCurve))
00928     {
00929         <a class="code" href="../../d2/d1/object_8c.html#a9">MemFree</a> (hMem);
00930         <span class="keywordflow">return</span> (0);
00931     }
00932 
00933     <span class="keywordflow">if</span> (<a class="code" href="../../d9/d3/jan99_2dll32_2getcsa_8c.html#a2">IsSRGB</a>(cp))
00934     {
00935        lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a223">WriteNewLineObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a59">CRDBegin</a>);
00936        lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a223">WriteNewLineObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a8">BeginDict</a>);    <span class="comment">// Begin dictionary</span>
00937        lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a11">DictType</a>); <span class="comment">// Dictionary type</span>
00938        lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a223">WriteNewLineObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a12">IntentType</a>); <span class="comment">// RenderingIntent</span>
00939        <span class="keywordflow">switch</span> (InputIntent)
00940        {
00941            <span class="keywordflow">case</span> <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a142">icPerceptual</a>:
00942                lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a13">IntentPer</a>);
00943                <span class="keywordflow">break</span>;
00944 
00945            <span class="keywordflow">case</span> <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a144">icSaturation</a>:
00946                lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a14">IntentSat</a>);
00947                <span class="keywordflow">break</span>;
00948         
00949            <span class="keywordflow">case</span> <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a143">icRelativeColorimetric</a>:
00950                lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a16">IntentRCol</a>);
00951                <span class="keywordflow">break</span>;
00952         
00953            <span class="keywordflow">case</span> <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a145">icAbsoluteColorimetric</a>:
00954                lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a15">IntentACol</a>);
00955                <span class="keywordflow">break</span>;
00956        }
00957        lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a223">WriteNewLineObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a82">AdobeCRD</a>);
00958        lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a223">WriteNewLineObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a60">CRDEnd</a>);
00959     }
00960     <span class="keywordflow">else</span>
00961     {
00962        lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a220">EnableGlobalDict</a>(lpMem);
00963        lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a221">BeginGlobalDict</a>(lpMem);
00964        
00965        lpMem += <a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a106">CreateRevArray</a> (cp, lpMem, lpRed, lpRevCurve, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a56">icSigRedTRCTag</a>, <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a27">AllowBinary</a>);
00966        lpMem += <a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a106">CreateRevArray</a> (cp, lpMem, lpGreen, lpRevCurve, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a35">icSigGreenTRCTag</a>, <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a27">AllowBinary</a>);
00967        lpMem += <a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a106">CreateRevArray</a> (cp, lpMem, lpBlue, lpRevCurve, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a22">icSigBlueTRCTag</a>, <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a27">AllowBinary</a>);
00968    
00969        lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a222">EndGlobalDict</a>(lpMem);
00970    
00971     <span class="comment">//   GetCPCMMType (cp, (LPCSIG) &amp; Intent);   // Get Intent</span>
00972        <a class="code" href="../../d2/d9/ps2_8c.html#a191">GetCPWhitePoint</a> (cp, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a26">LPSFLOAT</a>) &amp; IlluminantWP);          <span class="comment">// .. Illuminant</span>
00973    
00974     <span class="comment">//************* Start writing  CRD  ****************************</span>
00975        lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a223">WriteNewLineObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a59">CRDBegin</a>);
00976    
00977        lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a223">WriteNewLineObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a8">BeginDict</a>);    <span class="comment">// Begin dictionary</span>
00978        lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a11">DictType</a>); <span class="comment">// Dictionary type</span>
00979                             
00980        lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a223">WriteNewLineObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a12">IntentType</a>); <span class="comment">// RenderingIntent</span>
00981        <span class="keywordflow">switch</span> (InputIntent)
00982        {
00983            <span class="keywordflow">case</span> <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a142">icPerceptual</a>:
00984                lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a13">IntentPer</a>);
00985                <span class="keywordflow">break</span>;
00986 
00987            <span class="keywordflow">case</span> <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a144">icSaturation</a>:
00988                lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a14">IntentSat</a>);
00989                <span class="keywordflow">break</span>;
00990         
00991            <span class="keywordflow">case</span> <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a143">icRelativeColorimetric</a>:
00992                lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a16">IntentRCol</a>);
00993                <span class="keywordflow">break</span>;
00994         
00995            <span class="keywordflow">case</span> <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a145">icAbsoluteColorimetric</a>:
00996                lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a15">IntentACol</a>);
00997                <span class="keywordflow">break</span>;
00998        }
00999                      
01000     <span class="comment">//********** Send Black/White Point.</span>
01001        lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a203">SendCRDBWPoint</a>(lpMem, IlluminantWP);
01002    
01003     <span class="comment">//********** /TransformPQR</span>
01004        lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a204">SendCRDPQR</a>(lpMem, InputIntent, IlluminantWP);
01005    
01006     <span class="comment">//********** /MatrixLMN</span>
01007        <a class="code" href="../../d2/d9/ps2_8c.html#a251">CreateColorantArray</a>(cp, &amp;Colorant[0], <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a55">icSigRedColorantTag</a>);
01008        <a class="code" href="../../d2/d9/ps2_8c.html#a251">CreateColorantArray</a>(cp, &amp;Colorant[3], <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a34">icSigGreenColorantTag</a>);
01009        <a class="code" href="../../d2/d9/ps2_8c.html#a251">CreateColorantArray</a>(cp, &amp;Colorant[6], <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a21">icSigBlueColorantTag</a>);
01010        <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a56">InvertMatrix</a> (Colorant, RevColorant);
01011    
01012        lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a223">WriteNewLineObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a27">MatrixLMNTag</a>);
01013    
01014        lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a4">BeginArray</a>);
01015        <span class="keywordflow">for</span> (i = 0; i &lt; 9; i++)
01016        {
01017            lpMem += <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a46">WriteFloat</a> (lpMem, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a16">SFLOAT</a>)RevColorant[i]);
01018        }
01019        lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a5">EndArray</a>);
01020    
01021     <span class="comment">//********** /EncodeABC</span>
01022        lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a223">WriteNewLineObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a25">EncodeABCTag</a>);
01023        lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a4">BeginArray</a>);
01024    
01025        lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a56">NewLine</a>);
01026        lpMem += <a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a107">SendRevArray</a> (cp, lpMem, lpRed, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a56">icSigRedTRCTag</a>, <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a27">AllowBinary</a>);
01027        lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a56">NewLine</a>);
01028        lpMem += <a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a107">SendRevArray</a> (cp, lpMem, lpGreen, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a35">icSigGreenTRCTag</a>, <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a27">AllowBinary</a>);
01029        lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a56">NewLine</a>);
01030        lpMem += <a class="code" href="../../d9/d2/jul98_2dll32_2getcrd_8c.html#a107">SendRevArray</a> (cp, lpMem, lpBlue, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a22">icSigBlueTRCTag</a>, <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a27">AllowBinary</a>);
01031        lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a223">WriteNewLineObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a5">EndArray</a>);
01032    
01033        lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a9">EndDict</a>);  <span class="comment">// End dictionary definition</span>
01034    
01035        lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a223">WriteNewLineObject</a> (lpMem, <a class="code" href="../../d6/d2/aug98_2dll32_2getcrd_8c.html#a60">CRDEnd</a>);
01036     }
01037     <a class="code" href="../../d2/d1/object_8c.html#a9">MemFree</a> (hRevCurve);
01038     <a class="code" href="../../d2/d1/object_8c.html#a9">MemFree</a> (hMem);
01039     <span class="keywordflow">return</span> ((<a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>) ((<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>) (lpMem - lpOldMem)));
01040 }
01041 <span class="comment">// SRGB98 End</span>
01042 
01043 <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a0">EXTERN</a>
<a name="l01044"></a><a class="code" href="../../d9/d9/jul98_2test_2ps2color_8h.html#a0">01044</a> <a class="code" href="../../d0/d7/w32_2ntgdi_2icm_2mscms_2profile_8c.html#a29">GetPS2ColorRenderingDictionary</a> (
01045                                 CHANDLE cp,
01046                                 DWORD Intent,
01047                                 MEMPTR lpMem,
01048                                 LPDWORD lpcbSize,
01049                                 BOOL AllowBinary)
01050 {
01051     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a> <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>;
01052     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a> Ret, <a class="code" href="../../d8/d7/lh__open_2pi__mem_8h.html#a0">Size</a>;
01053     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a17">CSIG</a> icSigPs2CRDx, icSigBToAx;
01054 
01055     <span class="keywordflow">if</span> (!cp)
01056         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01057 
01058     <span class="keywordflow">if</span> ((lpMem == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) || (*lpcbSize == 0))
01059     {
01060         lpMem = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01061         *lpcbSize = 0;
01062     }
01063     Ret = 0;
01064     <a class="code" href="../../d8/d7/lh__open_2pi__mem_8h.html#a0">Size</a> = (<a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>) * lpcbSize;
01065 
01066     <span class="keywordflow">switch</span> (<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a28">Intent</a>)
01067     {
01068         <span class="keywordflow">case</span> <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a142">icPerceptual</a>:
01069             icSigPs2CRDx = <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a46">icSigPs2CRD0Tag</a>;
01070             icSigBToAx = <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a23">icSigBToA0Tag</a>;
01071             <span class="keywordflow">break</span>;
01072 
01073         <span class="keywordflow">case</span> <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a143">icRelativeColorimetric</a>:
01074             icSigPs2CRDx = <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a47">icSigPs2CRD1Tag</a>;
01075             icSigBToAx = <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a24">icSigBToA1Tag</a>;
01076             <span class="keywordflow">break</span>;
01077 
01078         <span class="keywordflow">case</span> <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a144">icSaturation</a>:
01079             icSigPs2CRDx = <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a48">icSigPs2CRD2Tag</a>;
01080             icSigBToAx = <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a25">icSigBToA2Tag</a>;
01081             <span class="keywordflow">break</span>;
01082 
01083         <span class="keywordflow">case</span> <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a145">icAbsoluteColorimetric</a>:
01084             icSigPs2CRDx = <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a49">icSigPs2CRD3Tag</a>;
01085             icSigBToAx = <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a24">icSigBToA1Tag</a>;
01086             <span class="keywordflow">break</span>;
01087 
01088         <span class="keywordflow">default</span>:
01089             *lpcbSize = (<a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>) Ret;
01090             <span class="keywordflow">return</span> (Ret &gt; 0);
01091     }
01092 
01093     <span class="keywordflow">if</span> (
01094         (<a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a> (cp, icSigPs2CRDx) &amp;&amp;
01095          <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a12">GetCPTagIndex</a> (cp, icSigPs2CRDx, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a25">LPSINT</a>) &amp; <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>) &amp;&amp;
01096          <a class="code" href="../../d2/d9/ps2_8c.html#a193">GetCPElementDataSize</a> (cp, <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a25">LPSINT</a>) &amp; Ret) &amp;&amp;
01097          ((<a class="code" href="../../d8/d7/lh__open_2pi__mem_8h.html#a0">Size</a> == 0) ||
01098           <a class="code" href="../../d2/d9/ps2_8c.html#a196">GetCPElementData</a> (cp, <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>, lpMem, <a class="code" href="../../d8/d7/lh__open_2pi__mem_8h.html#a0">Size</a>)) &amp;&amp;
01099          (Ret = <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a55">Convert2Ascii</a> (cp, <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>, lpMem, <a class="code" href="../../d8/d7/lh__open_2pi__mem_8h.html#a0">Size</a>, Ret, <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a27">AllowBinary</a>))
01100         ) ||
01101         (<a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a> (cp, icSigBToAx) &amp;&amp;
01102          <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a12">GetCPTagIndex</a> (cp, icSigBToAx, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a25">LPSINT</a>) &amp; <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>) &amp;&amp;
01103          (Ret = <a class="code" href="../../d2/d9/ps2_8c.html#a188">CreateLutCRD</a> (cp, <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>, lpMem, <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a28">Intent</a>, <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a27">AllowBinary</a>))
01104         ) || 
01105         <span class="comment">// SRGB98 Support Windows 98 sRGB icc profile.</span>
01106         <span class="comment">// Create CRD from TRC and Colorant Tags.</span>
01107         (<a class="code" href="../../d2/d9/ps2_8c.html#a190">DoesTRCAndColorantTagExist</a> (cp) &amp;&amp;
01108          (Ret = <a class="code" href="../../d2/d9/ps2_8c.html#a234">CreateMatrixCRD</a> (cp, lpMem, <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a28">Intent</a>, <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a27">AllowBinary</a>))
01109         ) ||
01110         (<a class="code" href="../../d2/d9/ps2_8c.html#a189">DoesCPTagExist</a> (cp, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a33">icSigGrayTRCTag</a>) &amp;&amp;
01111          <a class="code" href="../../d8/d9/jul98_2test_2csprof_8h.html#a12">GetCPTagIndex</a> (cp, <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a33">icSigGrayTRCTag</a>, (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a25">LPSINT</a>) &amp; <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>) &amp;&amp;
01112          (Ret = <a class="code" href="../../d2/d9/ps2_8c.html#a187">CreateMonoCRD</a> (cp, <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>, lpMem, <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a28">Intent</a>))
01113         )
01114        )
01115     {
01116     }
01117 
01118     *lpcbSize = (<a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>) Ret;
01119     <span class="keywordflow">return</span> (Ret &gt; 0);
01120 }
</div></pre><hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:40:11 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
