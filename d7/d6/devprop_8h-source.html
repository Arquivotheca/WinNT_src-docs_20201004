<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: devprop.h Source File</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>devprop.h</h1><a href="../../d6/d7/devprop_8h.html">Go to the documentation of this file.</a><pre class="fragment"><div>00001 <span class="comment">/******************************************************************************</span>
00002 <span class="comment"></span>
00003 <span class="comment">  Header File:  Device Property Page.H</span>
00004 <span class="comment"></span>
00005 <span class="comment">  Defines the class that handles the various device profile management pages.</span>
00006 <span class="comment">  These derive from CShellExtensionPage.</span>
00007 <span class="comment"></span>
00008 <span class="comment">  Since much of the profile management process is common to all devices, a base</span>
00009 <span class="comment">  class (CDeviceProfileManagement) provides these core services- filling the</span>
00010 <span class="comment">  device list box, properly enabling and disabling the "Remove" button, and</span>
00011 <span class="comment">  adding, associating, and dissociating profiles as needed.  Virtual functions</span>
00012 <span class="comment">  provide the means by which the individual device pages customize or modify</span>
00013 <span class="comment">  this behavior.</span>
00014 <span class="comment"></span>
00015 <span class="comment">  Copyright (c) 1996 by Microsoft Corporation</span>
00016 <span class="comment"></span>
00017 <span class="comment">  A Pretty Penny Enterprises, Inc. Production</span>
00018 <span class="comment"></span>
00019 <span class="comment">  Change History:</span>
00020 <span class="comment"></span>
00021 <span class="comment">  11-27-96  a-RobKj@microsoft.com coded it</span>
00022 <span class="comment"></span>
00023 <span class="comment">******************************************************************************/</span>
00024 
00025 <span class="preprocessor">#if !defined(DEVICE_PROFILE_UI)</span>
00026 <span class="preprocessor"></span>
<a name="l00027"></a><a class="code" href="../../d6/d7/devprop_8h.html#a0">00027</a> <span class="preprocessor">#define DEVICE_PROFILE_UI</span>
00028 <span class="preprocessor"></span>
00029 <span class="preprocessor">#include    "PropPage.H"</span>
00030 <span class="preprocessor">#include    "Profile.H"</span>
00031 
00032 <span class="comment">/******************************************************************************</span>
00033 <span class="comment"></span>
00034 <span class="comment">  CDeviceProfileManagement class</span>
00035 <span class="comment"></span>
00036 <span class="comment">  This class provides the core services for these pages.</span>
00037 <span class="comment"></span>
00038 <span class="comment">  NOTES:</span>
00039 <span class="comment"></span>
00040 <span class="comment">  The profiles must be in a list box (not a combo box) with the ID ProfileList.</span>
00041 <span class="comment">  If this isn't done, you must both override OnInit, and not call this class's</span>
00042 <span class="comment">  OnInit function.</span>
00043 <span class="comment"></span>
00044 <span class="comment">  Most implementations of derived classes will call this class's version of</span>
00045 <span class="comment">  functions they override.  Whether they do that before or after they do their</span>
00046 <span class="comment">  customizatins will probably require understanding what this class does.</span>
00047 <span class="comment"></span>
00048 <span class="comment">******************************************************************************/</span>
00049 
00050 <span class="comment">/*</span>
00051 <span class="comment"> * m_bReadOnly == FALSE (default)</span>
00052 <span class="comment"> * In this case the property page behaves normally - user input</span>
00053 <span class="comment"> * is accepted.</span>
00054 <span class="comment"> * m_bReadOnly == TRUE</span>
00055 <span class="comment"> * In this case all the buttons for this page are greyed out and</span>
00056 <span class="comment"> * the user can only inspect the data.</span>
00057 <span class="comment"> *</span>
00058 <span class="comment"> * The flag is used for locking out users without permission to</span>
00059 <span class="comment"> * modify the settings - but still allows them to view the settings.</span>
00060 <span class="comment"> *</span>
00061 <span class="comment"> * m_bCMYK is true if the device is a printer and it supports</span>
00062 <span class="comment"> * CMYK profiles</span>
00063 <span class="comment"> */</span>
00064 
<a name="l00065"></a><a class="code" href="../../d6/d7/devprop_8h.html#a1">00065</a> <span class="preprocessor">#define DEVLIST_ONINIT   0x0001</span>
<a name="l00066"></a><a class="code" href="../../d6/d7/devprop_8h.html#a2">00066</a> <span class="preprocessor"></span><span class="preprocessor">#define DEVLIST_CHANGED  0x0002</span>
<a name="l00067"></a><a class="code" href="../../d6/d7/devprop_8h.html#a3">00067</a> <span class="preprocessor"></span><span class="preprocessor">#define DEVLIST_NOSELECT 0x0004</span>
00068 <span class="preprocessor"></span>
<a name="l00069"></a><a class="code" href="../../d2/d2/classCDeviceProfileManagement.html">00069</a> <span class="keyword">class </span><a class="code" href="../../d2/d2/classCDeviceProfileManagement.html">CDeviceProfileManagement</a> : <span class="keyword">public</span> <a class="code" href="../../d9/d6/classCShellExtensionPage.html">CShellExtensionPage</a> {
00070 
<a name="l00071"></a><a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#r0">00071</a>     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>           <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#r0">m_dwType</a>;       <span class="comment">//  Type class of target device</span>
00072 
00073 <span class="keyword">protected</span>:
00074 
<a name="l00075"></a><a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p0">00075</a>     <a class="code" href="../../d3/d7/classCUintArray.html">CUintArray</a>      <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p0">m_cuaRemovals</a>;  <span class="comment">//  indices of dissociations to be done</span>
<a name="l00076"></a><a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p1">00076</a>     <a class="code" href="../../d8/d5/classCProfileArray.html">CProfileArray</a>   <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p1">m_cpaAdds</a>;      <span class="comment">//  Profiles to be added</span>
<a name="l00077"></a><a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p2">00077</a>     <a class="code" href="../../d8/d5/classCProfileArray.html">CProfileArray</a>   <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p2">m_cpaProfile</a>;   <span class="comment">//  Associated Profile Names</span>
<a name="l00078"></a><a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p3">00078</a>     <a class="code" href="../../d1/d7/classCString.html">CString</a>         <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p3">m_csDevice</a>;     <span class="comment">//  Target Device Name</span>
<a name="l00079"></a><a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p4">00079</a>     HWND            <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p4">m_hwndList</a>;     <span class="comment">//  Profile list box in dialog</span>
<a name="l00080"></a><a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p5">00080</a>     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>            <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p5">m_bCMYK</a>;        <span class="comment">//  Printer support for CMYK</span>
<a name="l00081"></a><a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p6">00081</a>     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>            <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p6">m_bReadOnly</a>;    <span class="comment">//  Flag indicating that settings can be</span>
00082                                     <span class="comment">//  modified by the user</span>
00083     <span class="keyword">virtual</span> <span class="keywordtype">void</span>    <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#b0">InitList</a>();
00084     <span class="keyword">virtual</span> <span class="keywordtype">void</span>    <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#b1">FillList</a>(DWORD dwFlags = 0);
00085 
00086     <span class="keywordtype">void</span>            <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#b2">GetDeviceTypeString</a>(DWORD dwType,<a class="code" href="../../d1/d7/classCString.html">CString</a>&amp; csDeviceName);
00087 
00088 <span class="keyword">public</span>:
00089 
00090     <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html">CDeviceProfileManagement</a>(LPCTSTR lpstrName, HINSTANCE hiWhere, <span class="keywordtype">int</span> idPage,
00091                              DWORD  dwType);
<a name="l00092"></a><a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#a1">00092</a>     <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#a1">~CDeviceProfileManagement</a>() {}
00093 
00094 
00095     <span class="keyword">virtual</span> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#a2">OnInit</a>();
00096     <span class="keyword">virtual</span> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    OnCommand(WORD wNotifyCode, WORD wid, HWND hwndCtl);
00097     <span class="keyword">virtual</span> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    OnNotify(<span class="keywordtype">int</span> idCtrl, LPNMHDR pnmh);
00098 };
00099 
00100 <span class="comment">//  This class encapsulates the required "Add Profile" old-style file open</span>
00101 <span class="comment">//  dialog.  Kind of a shame, Explorer's a much nicer interface...</span>
00102 
<a name="l00103"></a><a class="code" href="../../d5/d1/classCAddProfileDialog.html">00103</a> <span class="keyword">class </span><a class="code" href="../../d5/d1/classCAddProfileDialog.html">CAddProfileDialog</a> {
00104 
<a name="l00105"></a><a class="code" href="../../d5/d1/classCAddProfileDialog.html#r0">00105</a>     <a class="code" href="../../d2/d7/classCStringArray.html">CStringArray</a> <a class="code" href="../../d5/d1/classCAddProfileDialog.html#r0">csa_Files</a>;
00106 
00107     <span class="keyword">static</span> UINT_PTR <a class="code" href="../../d1/d1/bench_8c.html#a0">APIENTRY</a> <a class="code" href="../../d5/d1/classCAddProfileDialog.html#h0">OpenFileHookProc</a>(HWND hDlg, UINT uMessage, WPARAM wp,
00108                                           LPARAM lp);
00109 
00110 <span class="keyword">public</span>:
00111 
00112     <a class="code" href="../../d5/d1/classCAddProfileDialog.html">CAddProfileDialog</a>(HWND hwndOwner, HINSTANCE hi);
<a name="l00113"></a><a class="code" href="../../d5/d1/classCAddProfileDialog.html#a1">00113</a>     <a class="code" href="../../d5/d1/classCAddProfileDialog.html#a1">~CAddProfileDialog</a>() { <a class="code" href="../../d5/d1/classCAddProfileDialog.html#r0">csa_Files</a>.<a class="code" href="../../d2/d7/classCStringArray.html#a6">Empty</a>(); }
00114 
<a name="l00115"></a><a class="code" href="../../d5/d1/classCAddProfileDialog.html#a2">00115</a>     <span class="keywordtype">unsigned</span>  <a class="code" href="../../d5/d1/classCAddProfileDialog.html#a2">ProfileCount</a>()              { <span class="keywordflow">return</span> <a class="code" href="../../d5/d1/classCAddProfileDialog.html#r0">csa_Files</a>.<a class="code" href="../../d2/d7/classCStringArray.html#a2">Count</a>(); }
<a name="l00116"></a><a class="code" href="../../d5/d1/classCAddProfileDialog.html#a3">00116</a>     LPCTSTR   <a class="code" href="../../d5/d1/classCAddProfileDialog.html#a3">ProfileName</a>(<span class="keywordtype">unsigned</span> u)     { <span class="keywordflow">return</span> <a class="code" href="../../d5/d1/classCAddProfileDialog.html#r0">csa_Files</a>[u]; }
<a name="l00117"></a><a class="code" href="../../d5/d1/classCAddProfileDialog.html#a4">00117</a>     <a class="code" href="../../d1/d7/classCString.html">CString</a>   <a class="code" href="../../d5/d1/classCAddProfileDialog.html#a4">ProfileNameAndExtension</a>(<span class="keywordtype">unsigned</span> u) 
00118                                           { <span class="keywordflow">return</span> <a class="code" href="../../d5/d1/classCAddProfileDialog.html#r0">csa_Files</a>[u].NameAndExtension(); }
<a name="l00119"></a><a class="code" href="../../d5/d1/classCAddProfileDialog.html#a5">00119</a>     <span class="keywordtype">void</span>      <a class="code" href="../../d5/d1/classCAddProfileDialog.html#a5">AddProfile</a>(LPCTSTR str)     { <a class="code" href="../../d5/d1/classCAddProfileDialog.html#r0">csa_Files</a>.<a class="code" href="../../d2/d7/classCStringArray.html#a3">Add</a>(str); }
00120 };
00121 
00122 <span class="comment">//  The Printer Profile Management class uses the core class pretty much as is.</span>
00123 <span class="comment">//  We override the OnInit member to disable all controls if the user lacks</span>
00124 <span class="comment">//  administrative authority for the target printer.</span>
00125 
<a name="l00126"></a><a class="code" href="../../d6/d5/classCPrinterProfileManagement.html">00126</a> <span class="keyword">class </span><a class="code" href="../../d6/d5/classCPrinterProfileManagement.html">CPrinterProfileManagement</a> : <span class="keyword">public</span> <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html">CDeviceProfileManagement</a> {
00127 
00128 <span class="keyword">protected</span>:
00129 
<a name="l00130"></a><a class="code" href="../../d6/d5/classCPrinterProfileManagement.html#p0">00130</a>     <span class="keywordtype">unsigned</span>    <a class="code" href="../../d6/d5/classCPrinterProfileManagement.html#p0">m_uDefault</a>;    <span class="comment">//  Default profile index</span>
<a name="l00131"></a><a class="code" href="../../d6/d5/classCPrinterProfileManagement.html#p1">00131</a>     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>        <a class="code" href="../../d6/d5/classCPrinterProfileManagement.html#p1">m_bManualMode</a>; <span class="comment">//  Manual profile selection mode</span>
<a name="l00132"></a><a class="code" href="../../d6/d5/classCPrinterProfileManagement.html#p2">00132</a>     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>        <a class="code" href="../../d6/d5/classCPrinterProfileManagement.html#p2">m_bAdminAccess</a>;
<a name="l00133"></a><a class="code" href="../../d6/d5/classCPrinterProfileManagement.html#p3">00133</a>     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>        <a class="code" href="../../d6/d5/classCPrinterProfileManagement.html#p3">m_bLocalPrinter</a>;
00134 
00135     <span class="keyword">virtual</span> <span class="keywordtype">void</span>    <a class="code" href="../../d6/d5/classCPrinterProfileManagement.html#b0">InitList</a>();
00136     <span class="keyword">virtual</span> <span class="keywordtype">void</span>    <a class="code" href="../../d6/d5/classCPrinterProfileManagement.html#b1">FillList</a>(DWORD dwFlags = 0);
00137 
00138 <span class="keyword">public</span>:
00139 
00140     <a class="code" href="../../d6/d5/classCPrinterProfileManagement.html">CPrinterProfileManagement</a>(LPCTSTR lpstrName, HINSTANCE hiWhere);
<a name="l00141"></a><a class="code" href="../../d6/d5/classCPrinterProfileManagement.html#a1">00141</a>     <a class="code" href="../../d6/d5/classCPrinterProfileManagement.html#a1">~CPrinterProfileManagement</a>() {}
00142 
00143     <span class="keyword">virtual</span> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    <a class="code" href="../../d6/d5/classCPrinterProfileManagement.html#a2">OnInit</a>();
00144     <span class="keyword">virtual</span> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    OnCommand(WORD wNotifyCode, WORD wid, HWND hwndCtl);
00145     <span class="keyword">virtual</span> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    OnNotify(<span class="keywordtype">int</span> idCtrl, LPNMHDR pnmh);
00146 
00147     <span class="keyword">virtual</span> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    OnHelp(LPHELPINFO pHelp);
00148     <span class="keyword">virtual</span> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    OnContextMenu(HWND hwnd);
00149 };
00150 
00151 <span class="comment">//  The Scanner Profile Management class uses the core class pretty much as is.</span>
00152 <span class="comment">//  We override the OnInit member to disable all controls if the user lacks</span>
00153 <span class="comment">//  administrative authority for the target printer.</span>
00154 
<a name="l00155"></a><a class="code" href="../../d8/d6/classCScannerProfileManagement.html">00155</a> <span class="keyword">class </span><a class="code" href="../../d8/d6/classCScannerProfileManagement.html">CScannerProfileManagement</a> : <span class="keyword">public</span> <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html">CDeviceProfileManagement</a> {
00156 
00157 <span class="keyword">public</span>:
00158 
00159     <a class="code" href="../../d8/d6/classCScannerProfileManagement.html">CScannerProfileManagement</a>(LPCTSTR lpstrName, HINSTANCE hiWhere);
<a name="l00160"></a><a class="code" href="../../d8/d6/classCScannerProfileManagement.html#a1">00160</a>     <a class="code" href="../../d8/d6/classCScannerProfileManagement.html#a1">~CScannerProfileManagement</a>() {}
00161 
00162     <span class="keyword">virtual</span> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    <a class="code" href="../../d8/d6/classCScannerProfileManagement.html#a2">OnInit</a>();
00163 
00164     <span class="keyword">virtual</span> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    OnHelp(LPHELPINFO pHelp);
00165     <span class="keyword">virtual</span> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    OnContextMenu(HWND hwnd);
00166 };
00167 
00168 <span class="comment">//  The monitor profile class is a bit more complex, as it allows the</span>
00169 <span class="comment">//  manipulation and setting of device default profiles as well as association</span>
00170 <span class="comment">//  and dissociation of profiles.  It also has some extra controls to</span>
00171 <span class="comment">//  initialize.</span>
00172 
<a name="l00173"></a><a class="code" href="../../d3/d4/classCMonitorProfileManagement.html">00173</a> <span class="keyword">class </span><a class="code" href="../../d3/d4/classCMonitorProfileManagement.html">CMonitorProfileManagement</a> : <span class="keyword">public</span> <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html">CDeviceProfileManagement</a> {
00174 
00175 <span class="keyword">protected</span>:
00176 
<a name="l00177"></a><a class="code" href="../../d3/d4/classCMonitorProfileManagement.html#p0">00177</a>     <span class="keywordtype">unsigned</span>    <a class="code" href="../../d3/d4/classCMonitorProfileManagement.html#p0">m_uDefault</a>;              <span class="comment">//  Default profile index</span>
<a name="l00178"></a><a class="code" href="../../d3/d4/classCMonitorProfileManagement.html#p1">00178</a>     <a class="code" href="../../d1/d7/classCString.html">CString</a>     <a class="code" href="../../d3/d4/classCMonitorProfileManagement.html#p1">m_csDeviceFriendlyName</a>;  <span class="comment">//  Target Device Friendly Name</span>
00179 
00180     <span class="keyword">virtual</span> <span class="keywordtype">void</span>    <a class="code" href="../../d3/d4/classCMonitorProfileManagement.html#b0">InitList</a>();
00181     <span class="keyword">virtual</span> <span class="keywordtype">void</span>    <a class="code" href="../../d3/d4/classCMonitorProfileManagement.html#b1">FillList</a>(DWORD dwFlags = 0);
00182 
00183 <span class="keyword">public</span>:
00184 
00185     <a class="code" href="../../d3/d4/classCMonitorProfileManagement.html">CMonitorProfileManagement</a>(LPCTSTR lpstrName, LPCTSTR lpstrFriendlyName, HINSTANCE hiWhere);
<a name="l00186"></a><a class="code" href="../../d3/d4/classCMonitorProfileManagement.html#a1">00186</a>     <a class="code" href="../../d3/d4/classCMonitorProfileManagement.html#a1">~CMonitorProfileManagement</a>() {}
00187 
00188     <span class="keyword">virtual</span> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    <a class="code" href="../../d3/d4/classCMonitorProfileManagement.html#a2">OnInit</a>();
00189     <span class="keyword">virtual</span> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    OnCommand(WORD wNotifyCode, WORD wid, HWND hwndCtl);
00190     <span class="keyword">virtual</span> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    OnNotify(<span class="keywordtype">int</span> idCtrl, LPNMHDR pnmh);
00191 
00192     <span class="keyword">virtual</span> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    OnHelp(LPHELPINFO pHelp);
00193     <span class="keyword">virtual</span> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>    OnContextMenu(HWND hwnd);
00194 };
00195 
00196 <span class="preprocessor">#endif</span>
</div></pre><hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:39:41 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
