<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: jan99/dll32/profcrd.h File Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>profcrd.h File Reference</h1>
<p>
<a href="../../d7/d5/jan99_2dll32_2profcrd_8h-source.html">Go to the source code of this file.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Classes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d6/structtagHOSTCLUT.html">tagHOSTCLUT</a></td></tr>

<tr><td colspan=2><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d6/jan99_2dll32_2profcrd_8h.html#a0">MAXCHANNELS</a>&nbsp;&nbsp;&nbsp;4</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d6/jan99_2dll32_2profcrd_8h.html#a1">PREVIEWCRDGRID</a>&nbsp;&nbsp;&nbsp;16</td></tr>

<tr><td colspan=2><br><h2>Typedefs</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d7/d6/structtagHOSTCLUT.html">tagHOSTCLUT</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d6/jan99_2dll32_2profcrd_8h.html#a2">HOSTCLUT</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d7/d6/structtagHOSTCLUT.html">HOSTCLUT</a> __huge *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d6/jan99_2dll32_2profcrd_8h.html#a3">LPHOSTCLUT</a></td></tr>

<tr><td colspan=2><br><h2>Enumerations</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>enum &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d6/jan99_2dll32_2profcrd_8h.html#a7">DATATYPE</a> { <a class="el" href="../../d6/d6/jan99_2dll32_2profcrd_8h.html#a7a4">DATA_lut</a> = 0, 
<a class="el" href="../../d6/d6/jan99_2dll32_2profcrd_8h.html#a7a5">DATA_matrix</a>
 }</td></tr>

<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL EXTERN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d6/jan99_2dll32_2profcrd_8h.html#a6">GetPS2PreviewColorRenderingDictionary</a> (<a class="el" href="../../d8/d9/jul98_2test_2csprof_8h.html#a5">CHANDLE</a> cpDev, <a class="el" href="../../d8/d9/jul98_2test_2csprof_8h.html#a5">CHANDLE</a> cpTarget, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> <a class="el" href="../../d5/d8/jul98_2test_2main_8c.html#a28">Intent</a>, <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a19">MEMPTR</a> lpMem, LPDWORD lpcbSize, BOOL <a class="el" href="../../d5/d8/jul98_2test_2main_8c.html#a27">AllowBinary</a>)</td></tr>

</table>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="a0" doxytag="jan99/dll32/profcrd.h::MAXCHANNELS" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define MAXCHANNELS&nbsp;&nbsp;&nbsp;4          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d5/jan99_2dll32_2profcrd_8h-source.html#l00004">4</a> of file <a class="el" href="../../d7/d5/jan99_2dll32_2profcrd_8h-source.html">jan99/dll32/profcrd.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="jan99/dll32/profcrd.h::PREVIEWCRDGRID" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define PREVIEWCRDGRID&nbsp;&nbsp;&nbsp;16          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d5/jan99_2dll32_2profcrd_8h-source.html#l00005">5</a> of file <a class="el" href="../../d7/d5/jan99_2dll32_2profcrd_8h-source.html">jan99/dll32/profcrd.h</a>.    </td>
  </tr>
</table>
<hr><h2>Typedef Documentation</h2>
<a class="anchor" name="a2" doxytag="jan99/dll32/profcrd.h::HOSTCLUT" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d7/d6/structtagHOSTCLUT.html">tagHOSTCLUT</a>  <a class="el" href="../../d7/d6/structtagHOSTCLUT.html">HOSTCLUT</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="jan99/dll32/profcrd.h::LPHOSTCLUT" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef <a class="el" href="../../d7/d6/structtagHOSTCLUT.html">HOSTCLUT</a> __huge* <a class="el" href="../../d8/d6/jul98_2test_2profcrd_8h.html#a3">LPHOSTCLUT</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d5/jan99_2dll32_2profcrd_8h-source.html#l00028">28</a> of file <a class="el" href="../../d7/d5/jan99_2dll32_2profcrd_8h-source.html">jan99/dll32/profcrd.h</a>.    </td>
  </tr>
</table>
<hr><h2>Enumeration Type Documentation</h2>
<a class="anchor" name="a7" doxytag="jan99/dll32/profcrd.h::DATATYPE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> enum <a class="el" href="../../d7/d6/jul98_2dll32_2profcrd_8h.html#a7">DATATYPE</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<dl compact><dt><b>Enumeration values: </b></dt><dd>
<table border=0 cellspacing=2 cellpadding=0>
<tr><td valign=top><em><a class="anchor" name="a7a4" doxytag="DATA_lut" ></a>DATA_lut</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a7a5" doxytag="DATA_matrix" ></a>DATA_matrix</em>&nbsp;</td><td>
</td></tr>
</table>
</dl>

<p>
Definition at line <a class="el" href="../../d7/d5/jan99_2dll32_2profcrd_8h-source.html#l00007">7</a> of file <a class="el" href="../../d7/d5/jan99_2dll32_2profcrd_8h-source.html">jan99/dll32/profcrd.h</a>.
<p>
<pre class="fragment"><div>00007 { <a class="code" href="../../d2/d6/aug98_2dll32_2profcrd_8h.html#a7a4">DATA_lut</a>=0, <a class="code" href="../../d2/d6/aug98_2dll32_2profcrd_8h.html#a7a5">DATA_matrix</a> } <a class="code" href="../../d2/d6/aug98_2dll32_2profcrd_8h.html#a7">DATATYPE</a>;
</div></pre>    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a6" doxytag="jan99/dll32/profcrd.h::GetPS2PreviewColorRenderingDictionary" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL EXTERN GetPS2PreviewColorRenderingDictionary           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d8/d9/jul98_2test_2csprof_8h.html#a5">CHANDLE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>cpDev</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d8/d9/jul98_2test_2csprof_8h.html#a5">CHANDLE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>cpTarget</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Intent</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a19">MEMPTR</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>lpMem</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPDWORD&nbsp;</td>
          <td class="mdname" nowrap> <em>lpcbSize</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>BOOL&nbsp;</td>
          <td class="mdname" nowrap> <em>AllowBinary</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d4/aug98_2dll32_2profcrd_8c-source.html#l01954">1954</a> of file <a class="el" href="../../d9/d4/aug98_2dll32_2profcrd_8c-source.html">aug98/dll32/profcrd.c</a>.
<p>
<pre class="fragment"><div>01960 {
01961     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a>    lpTargetCRD, lpTargetCSA, lpDevCRD;
01962     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>     cbTargetCRD, cbTargetCSA, cbDevCRD;
01963     HGLOBAL   hTargetCRD, hTargetCSA, hDevCRD;
01964     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>      Success = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01965     <span class="keywordtype">float</span>     Input[<a class="code" href="../../d2/d6/aug98_2dll32_2profcrd_8h.html#a0">MAXCHANNELS</a>];
01966     <span class="keywordtype">float</span>     Output[<a class="code" href="../../d2/d6/aug98_2dll32_2profcrd_8h.html#a0">MAXCHANNELS</a>];
01967     <span class="keywordtype">float</span>     Temp[<a class="code" href="../../d2/d6/aug98_2dll32_2profcrd_8h.html#a0">MAXCHANNELS</a>];
01968     <span class="keywordtype">int</span>       i, j, k, l;
01969     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a>    lpLineStart;
01970     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a19">MEMPTR</a>    lpOldMem;
01971     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a17">CSIG</a>      ColorSpace;
01972     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a17">CSIG</a>      DevColorSpace;
01973     <span class="keyword">static</span> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a17">CSIG</a>      IntentTag;
01974     <span class="keyword">static</span> <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>      PreviewCRDGrid;
01975     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>      OutArraySize, InArraySize;
01976     <span class="keywordtype">char</span>      PublicArrayName[<a class="code" href="../../d8/d8/aug98_2dll32_2csprof_8c.html#a1">TempBfSize</a>];
01977     <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>      TargetGrids, DevGrids;
01978 
01979     <span class="comment">// First pass, return the size of Previewind CRD.</span>
01980     <span class="keywordflow">if</span> (lpMem == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
01981     {
01982         <a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>   dwOutArraySizr = 0;
01983 
01984         i = 3;      <span class="comment">// Default output channal;</span>
01985         <span class="keywordflow">if</span> ((<a class="code" href="../../d2/d9/ps2_8c.html#a41">GetCPDevSpace</a> (cpDev, (LPCSIG) &amp; DevColorSpace)) &amp;&amp;
01986                           (DevColorSpace == <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a118">icSigCmykData</a>))
01987         {
01988             i = 4;
01989         }
01990 
01991         <span class="comment">// Get the input array size IntentTag and Grid of the Target icc profile.</span>
01992         <span class="keywordflow">if</span> (!<a class="code" href="../../d2/d9/ps2_8c.html#a199">GetCRDInputOutputArraySize</a>(cpTarget, Intent,
01993             &amp;InArraySize, NULL, &amp;IntentTag, &amp;TargetGrids ))
01994             <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01995 
01996         <span class="comment">// Get the output array size IntentTag and Grid of the Dev icc profile.</span>
01997         <span class="keywordflow">if</span> (!<a class="code" href="../../d2/d9/ps2_8c.html#a199">GetCRDInputOutputArraySize</a>(cpDev, Intent,
01998             NULL, &amp;OutArraySize, &amp;IntentTag, &amp;DevGrids ))
01999             <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
02000 
02001         PreviewCRDGrid = (TargetGrids &gt; DevGrids)? TargetGrids: DevGrids;
02002 
02003         <span class="comment">// Min proofing CRD grid will be PREVIEWCRDGRID</span>
02004         <span class="keywordflow">if</span> (PreviewCRDGrid &lt; <a class="code" href="../../d2/d6/aug98_2dll32_2profcrd_8h.html#a1">PREVIEWCRDGRID</a>)
02005             PreviewCRDGrid = <a class="code" href="../../d2/d6/aug98_2dll32_2profcrd_8h.html#a1">PREVIEWCRDGRID</a>;
02006         *lpcbSize = PreviewCRDGrid * PreviewCRDGrid * PreviewCRDGrid * 
02007                     i * 2 +           <span class="comment">// CLUT size (Hex output)</span>
02008                     OutArraySize +    <span class="comment">// Output Array size</span>
02009                     InArraySize  +    <span class="comment">// Input Array size</span>
02010                     4096;             <span class="comment">// Extra PostScript staff.</span>
02011          <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
02012     }
02013 
02014     <span class="comment">// Second pass, return the Previewind CRD.</span>
02015     lpOldMem = lpMem;
02016 
02017     <span class="comment">//Query the sizes of Host TargetCRD, TargetCSA and DevCRD.</span>
02018     <span class="keywordflow">if</span> (!(<a class="code" href="../../d2/d9/ps2_8c.html#a201">GetHostColorRenderingDictionary</a> (cpTarget, Intent, NULL, &amp;cbTargetCRD)) ||
02019         !(<a class="code" href="../../d2/d9/ps2_8c.html#a202">GetHostColorSpaceArray</a> (cpTarget, Intent, NULL, &amp;cbTargetCSA)) ||
02020         !(<a class="code" href="../../d2/d9/ps2_8c.html#a201">GetHostColorRenderingDictionary</a> (cpDev, Intent, NULL, &amp;cbDevCRD)))
02021     {
02022         <span class="keywordflow">return</span> (Success);
02023     }
02024 
02025     <span class="comment">//Alloc the buffers for Host TargetCRD, TargetCSA and DevCRD.</span>
02026     hTargetCRD = hTargetCSA = hDevCRD = 0;
02027     <span class="keywordflow">if</span> (!<a class="code" href="../../d2/d1/object_8c.html#a7">MemAlloc</a> (cbTargetCRD, (HGLOBAL FAR *)&amp;hTargetCRD, (LPMEMPTR)&amp;lpTargetCRD) ||
02028         !<a class="code" href="../../d2/d1/object_8c.html#a7">MemAlloc</a> (cbTargetCSA, (HGLOBAL FAR *)&amp;hTargetCSA, (LPMEMPTR)&amp;lpTargetCSA) ||
02029         !<a class="code" href="../../d2/d1/object_8c.html#a7">MemAlloc</a> (cbDevCRD, (HGLOBAL FAR *)&amp;hDevCRD, (LPMEMPTR)&amp;lpDevCRD))
02030     {
02031         <span class="keywordflow">goto</span> Done;
02032     }
02033 
02034     <span class="comment">//Build Host TargetCRD, TargetCSA and DevCRD.</span>
02035     <span class="keywordflow">if</span> (!(<a class="code" href="../../d2/d9/ps2_8c.html#a201">GetHostColorRenderingDictionary</a> (cpTarget, Intent, lpTargetCRD, &amp;cbTargetCRD)) ||
02036         !(<a class="code" href="../../d2/d9/ps2_8c.html#a202">GetHostColorSpaceArray</a> (cpTarget, Intent, lpTargetCSA, &amp;cbTargetCSA)) ||
02037         !(<a class="code" href="../../d2/d9/ps2_8c.html#a201">GetHostColorRenderingDictionary</a> (cpDev, Intent, lpDevCRD, &amp;cbDevCRD)))
02038     {
02039         <span class="keywordflow">goto</span> Done;
02040     }
02041 
02042 <span class="comment">//  Build Proofing CRD based on Host TargetCRD TargetCSA and DevCRD.</span>
02043 <span class="comment">//  We use TargetCRD input tables and matrix as the</span>
02044 <span class="comment">//  input tables and matrix of the ProofCRD.</span>
02045 <span class="comment">//  We use DevCRD output tables as the output tables of the ProofCRD.</span>
02046 
02047 <span class="comment">//******** Define golbal array used in EncodeABC and RenderTaber</span>
02048     <a class="code" href="../../d2/d9/ps2_8c.html#a217">GetPublicArrayName</a> (cpDev, IntentTag, PublicArrayName);
02049     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a223">WriteNewLineObject</a> (lpMem, CRDBegin);
02050 
02051     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a220">EnableGlobalDict</a>(lpMem);
02052     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a221">BeginGlobalDict</a>(lpMem);
02053 
02054     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a215">CreateInputArray</a> (lpMem, (SINT)0, (SINT)0, (MEMPTR)PublicArrayName, 
02055              (CSIG)0, NULL, bAllowBinary, lpTargetCRD);
02056 
02057     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a216">CreateOutputArray</a> (lpMem, (SINT)0, (SINT)0, (SINT)0, 
02058              (MEMPTR)PublicArrayName, (CSIG)0, NULL, bAllowBinary, lpDevCRD);
02059 
02060     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a222">EndGlobalDict</a>(lpMem);
02061 
02062 <span class="comment">//************* Start writing  CRD  ****************************</span>
02063     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a223">WriteNewLineObject</a> (lpMem, BeginDict);    <span class="comment">// Begin dictionary</span>
02064     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, DictType); <span class="comment">// Dictionary type</span>
02065 
02066     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a223">WriteNewLineObject</a> (lpMem, IntentType); <span class="comment">// RenderingIntent</span>
02067     <span class="keywordflow">switch</span> (<a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a28">Intent</a>)
02068     {
02069         <span class="keywordflow">case</span> <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a142">icPerceptual</a>:
02070             lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, IntentPer);
02071             <span class="keywordflow">break</span>;
02072 
02073         <span class="keywordflow">case</span> <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a144">icSaturation</a>:
02074             lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, IntentSat);
02075             <span class="keywordflow">break</span>;
02076 
02077         <span class="keywordflow">case</span> <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a143">icRelativeColorimetric</a>:
02078             lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, IntentRCol);
02079             <span class="keywordflow">break</span>;
02080 
02081         <span class="keywordflow">case</span> <a class="code" href="../../d7/d4/aug98_2dll32_2icc_8h.html#a145">icAbsoluteColorimetric</a>:
02082             lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, IntentACol);
02083             <span class="keywordflow">break</span>;
02084     }
02085 
02086 <span class="comment">//********** Send Black/White Point.</span>
02087     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a203">SendCRDBWPoint</a>(lpMem, 
02088         ((LPHOSTCLUT)lpTargetCRD)-&gt;whitePoint);
02089 
02090 <span class="comment">//********** Send PQR - For White Point correction</span>
02091     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a204">SendCRDPQR</a>(lpMem, Intent, 
02092         ((LPHOSTCLUT)lpTargetCRD)-&gt;whitePoint);
02093 
02094 <span class="comment">//********** Send LMN - For Absolute Colorimetric use WhitePoint's XYZs</span>
02095     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a205">SendCRDLMN</a>(lpMem, Intent, 
02096         ((LPHOSTCLUT)lpTargetCRD)-&gt;whitePoint,
02097         ((LPHOSTCLUT)lpTargetCRD)-&gt;mediaWP,
02098         ((LPHOSTCLUT)lpTargetCRD)-&gt;pcs);
02099 
02100 <span class="comment">//********** Create MatrixABC and  EncodeABC  stuff</span>
02101     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a206">SendCRDABC</a>(lpMem, PublicArrayName, 
02102         ((LPHOSTCLUT)lpTargetCRD)-&gt;pcs,
02103         ((LPHOSTCLUT)lpTargetCRD)-&gt;inputChan,
02104         NULL,
02105         ((LPHOSTCLUT)lpTargetCRD)-&gt;e,
02106         (((LPHOSTCLUT)lpTargetCRD)-&gt;lutBits == 8)? icSigLut8Type:icSigLut16Type,
02107         bAllowBinary);
02108 
02109 <span class="comment">//********** /RenderTable</span>
02110     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a223">WriteNewLineObject</a> (lpMem, RenderTableTag);
02111     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, BeginArray);
02112 
02113     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a44">WriteInt</a> (lpMem, PreviewCRDGrid);  <span class="comment">// Send down Na</span>
02114     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a44">WriteInt</a> (lpMem, PreviewCRDGrid);  <span class="comment">// Send down Nb</span>
02115     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a44">WriteInt</a> (lpMem, PreviewCRDGrid);  <span class="comment">// Send down Nc</span>
02116 
02117     lpLineStart = lpMem;
02118     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a223">WriteNewLineObject</a> (lpMem, BeginArray);
02119     ColorSpace = ((<a class="code" href="../../d2/d6/aug98_2dll32_2profcrd_8h.html#a3">LPHOSTCLUT</a>)lpDevCRD)-&gt;pcs;
02120     <span class="keywordflow">for</span> (i = 0; i &lt; PreviewCRDGrid; i++)        <span class="comment">// Na strings should be sent</span>
02121     {
02122         lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, NewLine);
02123         lpLineStart = lpMem;
02124         <span class="keywordflow">if</span> (bAllowBinary)
02125         {
02126             lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a228">WriteStringToken</a> (lpMem, 143, 
02127                 PreviewCRDGrid * PreviewCRDGrid * ((LPHOSTCLUT)lpDevCRD)-&gt;outputChan);
02128         }
02129         <span class="keywordflow">else</span>
02130         {
02131             lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, BeginString);
02132         }
02133         Input[0] = ((<span class="keywordtype">float</span>)i) / (PreviewCRDGrid - 1);
02134         <span class="keywordflow">for</span> (j = 0; j &lt; PreviewCRDGrid; j++)
02135         {
02136             Input[1] = ((<span class="keywordtype">float</span>)j) / (PreviewCRDGrid - 1);
02137             <span class="keywordflow">for</span> (k = 0; k &lt; PreviewCRDGrid; k++)
02138             {
02139                 Input[2] = ((<span class="keywordtype">float</span>)k) / (PreviewCRDGrid - 1);
02140 
02141                 <a class="code" href="../../d2/d9/ps2_8c.html#a243">DoHostConversionCRD</a> ((LPHOSTCLUT)lpTargetCRD, NULL, Input, Output, ColorSpace, 1);
02142                 <a class="code" href="../../d2/d9/ps2_8c.html#a242">DoHostConversionCSA</a> ((LPHOSTCLUT)lpTargetCSA, Output, Temp);
02143                 <a class="code" href="../../d2/d9/ps2_8c.html#a243">DoHostConversionCRD</a> ((LPHOSTCLUT)lpDevCRD, (LPHOSTCLUT)lpTargetCSA, 
02144                                      Temp, Output, 0, 0);
02145                 <span class="keywordflow">for</span> (l = 0; l &lt; ((<a class="code" href="../../d2/d6/aug98_2dll32_2profcrd_8h.html#a3">LPHOSTCLUT</a>)lpDevCRD)-&gt;outputChan; l++)
02146                 {
02147                     <span class="keywordflow">if</span> (bAllowBinary)
02148                     {
02149                         *lpMem++ = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a12">BYTES</a>)(Output[l]*255);
02150                     }
02151                     <span class="keywordflow">else</span>
02152                     {
02153                         lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a45">WriteHex</a> (lpMem, (USHORT)(Output[l]*255));
02154                         <span class="keywordflow">if</span> (((<a class="code" href="../../d6/d7/aug98_2dll32_2icmdll_8h.html#a6">SINT</a>) (lpMem - lpLineStart)) &gt; <a class="code" href="../../d2/d9/aug98_2dll32_2csprof_8h.html#a4">MAX_LINELENG</a>)
02155                         {
02156                             lpLineStart = lpMem;
02157                             lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, NewLine);
02158                         }
02159                     }
02160                 }
02161             }
02162         }
02163         <span class="keywordflow">if</span> (!bAllowBinary)
02164             lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, EndString);
02165     }
02166     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a223">WriteNewLineObject</a> (lpMem, EndArray);
02167     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a44">WriteInt</a> (lpMem, ((LPHOSTCLUT)lpDevCRD)-&gt;outputChan);
02168 
02169 <span class="comment">//********** Send Output Table.</span>
02170     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a207">SendCRDOutputTable</a>(lpMem, PublicArrayName, 
02171         ((LPHOSTCLUT)lpDevCRD)-&gt;outputChan,
02172         (((LPHOSTCLUT)lpDevCRD)-&gt;lutBits == 8)? icSigLut8Type:icSigLut16Type,
02173         TRUE,
02174         bAllowBinary);
02175 
02176 
02177     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a223">WriteNewLineObject</a> (lpMem, EndArray);
02178     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a43">WriteObject</a> (lpMem, EndDict); <span class="comment">// End dictionary definition</span>
02179     lpMem += <a class="code" href="../../d2/d9/ps2_8c.html#a223">WriteNewLineObject</a> (lpMem, CRDEnd);
02180     Success = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
02181 
02182 Done:
02183     *lpcbSize = (<a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)(lpMem - lpOldMem);
02184 
02185     <span class="keywordflow">if</span> (hTargetCRD)
02186          <a class="code" href="../../d2/d1/object_8c.html#a9">MemFree</a>(hTargetCRD);
02187     <span class="keywordflow">if</span> (hTargetCSA)
02188          <a class="code" href="../../d2/d1/object_8c.html#a9">MemFree</a>(hTargetCSA);
02189     <span class="keywordflow">if</span> (hDevCRD)
02190          <a class="code" href="../../d2/d1/object_8c.html#a9">MemFree</a>(hDevCRD);
02191     <span class="keywordflow">return</span> (Success);
02192 }
</div></pre>    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:45:20 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
