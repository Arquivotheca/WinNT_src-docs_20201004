<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: nls.c File Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>nls.c File Reference</h1><code>#include "<a class="el" href="../../d6/d8/ntrtlp_8h-source.html">ntrtlp.h</a>"</code><br>

<p>
<a href="../../d7/d5/nls_8c-source.html">Go to the source code of this file.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d6/nls_8c.html#a0">NETBIOS_NAME_LEN</a>&nbsp;&nbsp;&nbsp;16</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d6/nls_8c.html#a1">UNICODE_FFFF</a>&nbsp;&nbsp;&nbsp;0xFFFF</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d6/nls_8c.html#a2">REVERSE_BYTE_ORDER_MARK</a>&nbsp;&nbsp;&nbsp;0xFFFE</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d6/nls_8c.html#a3">BYTE_ORDER_MARK</a>&nbsp;&nbsp;&nbsp;0xFEFF</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d6/nls_8c.html#a4">PARAGRAPH_SEPARATOR</a>&nbsp;&nbsp;&nbsp;0x2029</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d6/nls_8c.html#a5">LINE_SEPARATOR</a>&nbsp;&nbsp;&nbsp;0x2028</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d6/nls_8c.html#a6">UNICODE_TAB</a>&nbsp;&nbsp;&nbsp;0x0009</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d6/nls_8c.html#a7">UNICODE_LF</a>&nbsp;&nbsp;&nbsp;0x000A</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d6/nls_8c.html#a8">UNICODE_CR</a>&nbsp;&nbsp;&nbsp;0x000D</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d6/nls_8c.html#a9">UNICODE_SPACE</a>&nbsp;&nbsp;&nbsp;0x0020</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d6/nls_8c.html#a10">UNICODE_CJK_SPACE</a>&nbsp;&nbsp;&nbsp;0x3000</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d6/nls_8c.html#a11">UNICODE_R_TAB</a>&nbsp;&nbsp;&nbsp;0x0900</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d6/nls_8c.html#a12">UNICODE_R_LF</a>&nbsp;&nbsp;&nbsp;0x0A00</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d6/nls_8c.html#a13">UNICODE_R_CR</a>&nbsp;&nbsp;&nbsp;0x0D00</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d6/nls_8c.html#a14">UNICODE_R_SPACE</a>&nbsp;&nbsp;&nbsp;0x2000</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d6/nls_8c.html#a15">UNICODE_R_CJK_SPACE</a>&nbsp;&nbsp;&nbsp;0x0030  /* Ambiguous - same as ASCII '0' */</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d6/nls_8c.html#a16">ASCII_CRLF</a>&nbsp;&nbsp;&nbsp;0x0A0D</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d6/nls_8c.html#a17">__max</a>(a, b)&nbsp;&nbsp;&nbsp;(((a) &gt; (b)) ? (a) : (b))</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d6/nls_8c.html#a18">__min</a>(a, b)&nbsp;&nbsp;&nbsp;(((a) &lt; (b)) ? (a) : (b))</td></tr>

<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d6/nls_8c.html#a21">RtlAnsiStringToUnicodeString</a> (OUT PUNICODE_STRING DestinationString, IN PANSI_STRING <a class="el" href="../../d0/d2/usrbench_8h.html#a33">SourceString</a>, IN BOOLEAN AllocateDestinationString)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>WCHAR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d6/nls_8c.html#a22">RtlAnsiCharToUnicodeChar</a> (IN OUT PUCHAR *SourceCharacter)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d6/nls_8c.html#a23">RtlUnicodeStringToAnsiString</a> (OUT PANSI_STRING DestinationString, IN PUNICODE_STRING <a class="el" href="../../d0/d2/usrbench_8h.html#a33">SourceString</a>, IN BOOLEAN AllocateDestinationString)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d6/nls_8c.html#a24">RtlUpcaseUnicodeStringToAnsiString</a> (OUT PANSI_STRING DestinationString, IN PUNICODE_STRING <a class="el" href="../../d0/d2/usrbench_8h.html#a33">SourceString</a>, IN BOOLEAN AllocateDestinationString)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d6/nls_8c.html#a25">RtlOemStringToUnicodeString</a> (OUT PUNICODE_STRING DestinationString, IN POEM_STRING <a class="el" href="../../d0/d2/usrbench_8h.html#a33">SourceString</a>, IN BOOLEAN AllocateDestinationString)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d6/nls_8c.html#a26">RtlUnicodeStringToOemString</a> (OUT POEM_STRING DestinationString, IN PUNICODE_STRING <a class="el" href="../../d0/d2/usrbench_8h.html#a33">SourceString</a>, IN BOOLEAN AllocateDestinationString)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d6/nls_8c.html#a27">RtlUpcaseUnicodeStringToOemString</a> (OUT POEM_STRING DestinationString, IN PUNICODE_STRING <a class="el" href="../../d0/d2/usrbench_8h.html#a33">SourceString</a>, IN BOOLEAN AllocateDestinationString)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d6/nls_8c.html#a28">RtlOemStringToCountedUnicodeString</a> (OUT PUNICODE_STRING DestinationString, IN POEM_STRING <a class="el" href="../../d0/d2/usrbench_8h.html#a33">SourceString</a>, IN BOOLEAN AllocateDestinationString)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d6/nls_8c.html#a29">RtlUnicodeStringToCountedOemString</a> (OUT POEM_STRING DestinationString, IN PUNICODE_STRING <a class="el" href="../../d0/d2/usrbench_8h.html#a33">SourceString</a>, IN BOOLEAN AllocateDestinationString)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d6/nls_8c.html#a30">RtlUpcaseUnicodeStringToCountedOemString</a> (OUT POEM_STRING DestinationString, IN PUNICODE_STRING <a class="el" href="../../d0/d2/usrbench_8h.html#a33">SourceString</a>, IN BOOLEAN AllocateDestinationString)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d6/nls_8c.html#a31">RtlUpcaseUnicodeString</a> (OUT PUNICODE_STRING DestinationString, IN PCUNICODE_STRING <a class="el" href="../../d0/d2/usrbench_8h.html#a33">SourceString</a>, IN BOOLEAN AllocateDestinationString)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d6/nls_8c.html#a32">RtlDowncaseUnicodeString</a> (OUT PUNICODE_STRING DestinationString, IN PUNICODE_STRING <a class="el" href="../../d0/d2/usrbench_8h.html#a33">SourceString</a>, IN BOOLEAN AllocateDestinationString)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>WCHAR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d6/nls_8c.html#a33">RtlUpcaseUnicodeChar</a> (IN WCHAR SourceCharacter)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d6/nls_8c.html#a34">RtlFreeUnicodeString</a> (IN OUT PUNICODE_STRING UnicodeString)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d6/nls_8c.html#a35">RtlFreeAnsiString</a> (IN OUT PANSI_STRING AnsiString)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d6/nls_8c.html#a36">RtlFreeOemString</a> (IN OUT POEM_STRING OemString)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d6/nls_8c.html#a37">RtlxUnicodeStringToAnsiSize</a> (IN PUNICODE_STRING UnicodeString)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d6/nls_8c.html#a38">RtlxUnicodeStringToOemSize</a> (IN PUNICODE_STRING UnicodeString)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d6/nls_8c.html#a39">RtlxAnsiStringToUnicodeSize</a> (IN PANSI_STRING AnsiString)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d6/nls_8c.html#a40">RtlxOemStringToUnicodeSize</a> (IN POEM_STRING OemString)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>LONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d6/nls_8c.html#a41">RtlCompareUnicodeString</a> (IN PUNICODE_STRING <a class="el" href="../../d9/d9/tcmpmem_8c.html#a1">String1</a>, IN PUNICODE_STRING <a class="el" href="../../d9/d9/tcmpmem_8c.html#a2">String2</a>, IN BOOLEAN CaseInSensitive)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d6/nls_8c.html#a42">RtlEqualUnicodeString</a> (IN PCUNICODE_STRING <a class="el" href="../../d9/d9/tcmpmem_8c.html#a1">String1</a>, IN PCUNICODE_STRING <a class="el" href="../../d9/d9/tcmpmem_8c.html#a2">String2</a>, IN BOOLEAN CaseInSensitive)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d6/nls_8c.html#a43">RtlPrefixUnicodeString</a> (IN PUNICODE_STRING <a class="el" href="../../d9/d9/tcmpmem_8c.html#a1">String1</a>, IN PUNICODE_STRING <a class="el" href="../../d9/d9/tcmpmem_8c.html#a2">String2</a>, IN BOOLEAN CaseInSensitive)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d6/nls_8c.html#a44">RtlCopyUnicodeString</a> (OUT PUNICODE_STRING DestinationString, IN PUNICODE_STRING <a class="el" href="../../d0/d2/usrbench_8h.html#a33">SourceString</a> OPTIONAL)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d6/nls_8c.html#a45">RtlAppendUnicodeToString</a> (IN PUNICODE_STRING Destination, IN PCWSTR Source OPTIONAL)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d6/nls_8c.html#a46">RtlAppendUnicodeStringToString</a> (IN PUNICODE_STRING Destination, IN PUNICODE_STRING Source)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d6/nls_8c.html#a47">RtlCreateUnicodeString</a> (OUT PUNICODE_STRING DestinationString, IN PCWSTR <a class="el" href="../../d0/d2/usrbench_8h.html#a33">SourceString</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d6/nls_8c.html#a48">RtlEqualDomainName</a> (IN PUNICODE_STRING <a class="el" href="../../d9/d9/tcmpmem_8c.html#a1">String1</a>, IN PUNICODE_STRING <a class="el" href="../../d9/d9/tcmpmem_8c.html#a2">String2</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d6/nls_8c.html#a49">RtlEqualComputerName</a> (IN PUNICODE_STRING <a class="el" href="../../d9/d9/tcmpmem_8c.html#a1">String1</a>, IN PUNICODE_STRING <a class="el" href="../../d9/d9/tcmpmem_8c.html#a2">String2</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d6/nls_8c.html#a50">RtlIsTextUnicode</a> (IN PVOID <a class="el" href="../../d8/d6/ttri_8c.html#a3">Buffer</a>, IN ULONG <a class="el" href="../../d9/d7/w98_2lh__open_2pi__mem_8h.html#a0">Size</a>, IN OUT PULONG Result OPTIONAL)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d6/nls_8c.html#a51">RtlDnsHostNameToComputerName</a> (OUT PUNICODE_STRING ComputerNameString, IN PUNICODE_STRING DnsHostNameString, IN BOOLEAN AllocateComputerNameString)</td></tr>

<tr><td colspan=2><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a22">PUSHORT</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d6/nls_8c.html#a19">NlsAnsiToUnicodeData</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a22">PUSHORT</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d6/nls_8c.html#a20">NlsLeadByteInfo</a></td></tr>

</table>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="a17" doxytag="nls.c::__max" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define __max          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">a,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>b&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;(((a) &gt; (b)) ? (a) : (b))</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d5/nls_8c-source.html#l02093">2093</a> of file <a class="el" href="../../d7/d5/nls_8c-source.html">nls.c</a>.
<p>
Referenced by <a class="el" href="../../d9/d7/arbiter_8c-source.html#l02592">ArbGetNextAllocationRange()</a>, and <a class="el" href="../../d7/d5/nls_8c-source.html#l02098">RtlIsTextUnicode()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a18" doxytag="nls.c::__min" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define __min          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">a,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>b&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;(((a) &lt; (b)) ? (a) : (b))</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d5/nls_8c-source.html#l02094">2094</a> of file <a class="el" href="../../d7/d5/nls_8c-source.html">nls.c</a>.
<p>
Referenced by <a class="el" href="../../d9/d7/arbiter_8c-source.html#l02592">ArbGetNextAllocationRange()</a>, and <a class="el" href="../../d7/d5/nls_8c-source.html#l02098">RtlIsTextUnicode()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a16" doxytag="nls.c::ASCII_CRLF" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ASCII_CRLF&nbsp;&nbsp;&nbsp;0x0A0D          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d5/nls_8c-source.html#l02091">2091</a> of file <a class="el" href="../../d7/d5/nls_8c-source.html">nls.c</a>.
<p>
Referenced by <a class="el" href="../../d7/d5/nls_8c-source.html#l02098">RtlIsTextUnicode()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="nls.c::BYTE_ORDER_MARK" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define BYTE_ORDER_MARK&nbsp;&nbsp;&nbsp;0xFEFF          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d5/nls_8c-source.html#l02074">2074</a> of file <a class="el" href="../../d7/d5/nls_8c-source.html">nls.c</a>.
<p>
Referenced by <a class="el" href="../../d7/d5/nls_8c-source.html#l02098">RtlIsTextUnicode()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a5" doxytag="nls.c::LINE_SEPARATOR" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define LINE_SEPARATOR&nbsp;&nbsp;&nbsp;0x2028          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d5/nls_8c-source.html#l02077">2077</a> of file <a class="el" href="../../d7/d5/nls_8c-source.html">nls.c</a>.
<p>
Referenced by <a class="el" href="../../d7/d5/nls_8c-source.html#l02098">RtlIsTextUnicode()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a0" doxytag="nls.c::NETBIOS_NAME_LEN" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define NETBIOS_NAME_LEN&nbsp;&nbsp;&nbsp;16          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d5/nls_8c-source.html#l00076">76</a> of file <a class="el" href="../../d7/d5/nls_8c-source.html">nls.c</a>.
<p>
Referenced by <a class="el" href="../../d7/d5/nls_8c-source.html#l02519">RtlDnsHostNameToComputerName()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a4" doxytag="nls.c::PARAGRAPH_SEPARATOR" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define PARAGRAPH_SEPARATOR&nbsp;&nbsp;&nbsp;0x2029          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d5/nls_8c-source.html#l02076">2076</a> of file <a class="el" href="../../d7/d5/nls_8c-source.html">nls.c</a>.
<p>
Referenced by <a class="el" href="../../d7/d5/nls_8c-source.html#l02098">RtlIsTextUnicode()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a2" doxytag="nls.c::REVERSE_BYTE_ORDER_MARK" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define REVERSE_BYTE_ORDER_MARK&nbsp;&nbsp;&nbsp;0xFFFE          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d5/nls_8c-source.html#l02073">2073</a> of file <a class="el" href="../../d7/d5/nls_8c-source.html">nls.c</a>.
<p>
Referenced by <a class="el" href="../../d7/d5/nls_8c-source.html#l02098">RtlIsTextUnicode()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a10" doxytag="nls.c::UNICODE_CJK_SPACE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define UNICODE_CJK_SPACE&nbsp;&nbsp;&nbsp;0x3000          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d5/nls_8c-source.html#l02083">2083</a> of file <a class="el" href="../../d7/d5/nls_8c-source.html">nls.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a8" doxytag="nls.c::UNICODE_CR" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define UNICODE_CR&nbsp;&nbsp;&nbsp;0x000D          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d5/nls_8c-source.html#l02081">2081</a> of file <a class="el" href="../../d7/d5/nls_8c-source.html">nls.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="nls.c::UNICODE_FFFF" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define UNICODE_FFFF&nbsp;&nbsp;&nbsp;0xFFFF          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d5/nls_8c-source.html#l02072">2072</a> of file <a class="el" href="../../d7/d5/nls_8c-source.html">nls.c</a>.
<p>
Referenced by <a class="el" href="../../d7/d5/nls_8c-source.html#l02098">RtlIsTextUnicode()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a7" doxytag="nls.c::UNICODE_LF" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define UNICODE_LF&nbsp;&nbsp;&nbsp;0x000A          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d5/nls_8c-source.html#l02080">2080</a> of file <a class="el" href="../../d7/d5/nls_8c-source.html">nls.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a15" doxytag="nls.c::UNICODE_R_CJK_SPACE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define UNICODE_R_CJK_SPACE&nbsp;&nbsp;&nbsp;0x0030  /* Ambiguous - same as ASCII '0' */          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d5/nls_8c-source.html#l02089">2089</a> of file <a class="el" href="../../d7/d5/nls_8c-source.html">nls.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a13" doxytag="nls.c::UNICODE_R_CR" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define UNICODE_R_CR&nbsp;&nbsp;&nbsp;0x0D00          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d5/nls_8c-source.html#l02087">2087</a> of file <a class="el" href="../../d7/d5/nls_8c-source.html">nls.c</a>.
<p>
Referenced by <a class="el" href="../../d7/d5/nls_8c-source.html#l02098">RtlIsTextUnicode()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a12" doxytag="nls.c::UNICODE_R_LF" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define UNICODE_R_LF&nbsp;&nbsp;&nbsp;0x0A00          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d5/nls_8c-source.html#l02086">2086</a> of file <a class="el" href="../../d7/d5/nls_8c-source.html">nls.c</a>.
<p>
Referenced by <a class="el" href="../../d7/d5/nls_8c-source.html#l02098">RtlIsTextUnicode()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a14" doxytag="nls.c::UNICODE_R_SPACE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define UNICODE_R_SPACE&nbsp;&nbsp;&nbsp;0x2000          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d5/nls_8c-source.html#l02088">2088</a> of file <a class="el" href="../../d7/d5/nls_8c-source.html">nls.c</a>.
<p>
Referenced by <a class="el" href="../../d7/d5/nls_8c-source.html#l02098">RtlIsTextUnicode()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a11" doxytag="nls.c::UNICODE_R_TAB" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define UNICODE_R_TAB&nbsp;&nbsp;&nbsp;0x0900          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d5/nls_8c-source.html#l02085">2085</a> of file <a class="el" href="../../d7/d5/nls_8c-source.html">nls.c</a>.
<p>
Referenced by <a class="el" href="../../d7/d5/nls_8c-source.html#l02098">RtlIsTextUnicode()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a9" doxytag="nls.c::UNICODE_SPACE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define UNICODE_SPACE&nbsp;&nbsp;&nbsp;0x0020          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d5/nls_8c-source.html#l02082">2082</a> of file <a class="el" href="../../d7/d5/nls_8c-source.html">nls.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a6" doxytag="nls.c::UNICODE_TAB" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define UNICODE_TAB&nbsp;&nbsp;&nbsp;0x0009          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d5/nls_8c-source.html#l02079">2079</a> of file <a class="el" href="../../d7/d5/nls_8c-source.html">nls.c</a>.    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a22" doxytag="nls.c::RtlAnsiCharToUnicodeChar" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> WCHAR RtlAnsiCharToUnicodeChar           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN OUT PUCHAR *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>SourceCharacter</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d5/nls_8c-source.html#l00171">171</a> of file <a class="el" href="../../d7/d5/nls_8c-source.html">nls.c</a>.
<p>
References <a class="el" href="../../d7/d5/nls_8c-source.html#l00068">NlsAnsiToUnicodeData</a>, <a class="el" href="../../d7/d5/nls_8c-source.html#l00069">NlsLeadByteInfo</a>, <a class="el" href="../../d6/d5/stierr_8h-source.html#l00030">NT_SUCCESS</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d6/d8/ntrtlp_8h-source.html#l00246">RTL_PAGED_CODE</a>, and <a class="el" href="../../d0/d6/nlsxlat_8c-source.html#l00369">RtlMultiByteToUnicodeN()</a>.
<p>
Referenced by <a class="el" href="../../d4/d6/config_2utils_2regutil_8c-source.html#l00259">RegLoadAsciiFileAsUnicode()</a>, and <a class="el" href="../../d9/d5/nlssup_8c-source.html#l00069">RtlpAnsiPszToUnicodePsz()</a>.
<p>
<pre class="fragment"><div>00177                    :
00178 
00179     This function translates <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified ansi character to unicode and
00180     returns <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> unicode value.  The purpose <span class="keywordflow">for</span> <span class="keyword">this</span> routine <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to allow
00181     <span class="keywordflow">for</span> character by character ansi to unicode <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a46">translation</a>.  The
00182     <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a46">translation</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> done with respect to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> current system locale
00183     information.
00184 
00185 
00186 Arguments:
00187 
00188     SourceCharacter - Supplies a pointer to an ansi character pointer.
00189         Through two levels of indirection, <span class="keyword">this</span> supplies an ansi
00190         character that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to be translated to unicode.  After
00191         <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a46">translation</a>, <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> ansi character pointer <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> modified to point to
00192         <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> next character to be converted.  This <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> done to allow <span class="keywordflow">for</span>
00193         dbcs ansi characters.
00194 
00195 Return Value:
00196 
00197     Returns <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> unicode equivalent of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified ansi character.
00198 
00199 --*/
00200 
00201 {
00202     WCHAR UnicodeCharacter;
00203     ULONG cbCharSize;
00204     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> st;
00205 
00206 
00207     <a class="code" href="../../d5/d9/ntrtlp_8h.html#a12">RTL_PAGED_CODE</a>();
00208 
00209 
00210 <span class="preprocessor">#if 0</span>
00211 <span class="preprocessor"></span>    UnicodeCharacter = <a class="code" href="../../d6/d6/nls_8c.html#a19">NlsAnsiToUnicodeData</a>[(UCHAR)(**SourceCharacter)];
00212     (*SourceCharacter)++;
00213     <span class="keywordflow">return</span> UnicodeCharacter;
00214 <span class="preprocessor">#endif</span>
00215 <span class="preprocessor"></span>
00216 
00217     <span class="comment">//</span>
00218     <span class="comment">// Translate the ansi character to unicode - this handles DBCS.</span>
00219     <span class="comment">//</span>
00220     cbCharSize = <a class="code" href="../../d6/d6/nls_8c.html#a20">NlsLeadByteInfo</a>[ **SourceCharacter ] ? 2 : 1;
00221     st = <a class="code" href="../../d9/d6/nlsxlat_8c.html#a33">RtlMultiByteToUnicodeN</a> ( &amp;UnicodeCharacter,
00222                                   <span class="keyword">sizeof</span> ( WCHAR ),
00223                                   NULL,
00224                                   *SourceCharacter,
00225                                   cbCharSize );
00226 
00227     <span class="comment">//</span>
00228     <span class="comment">// Check for error - The only time this will happen is if there is</span>
00229     <span class="comment">// a leadbyte without a trail byte.</span>
00230     <span class="comment">//</span>
00231     <span class="keywordflow">if</span> ( ! <a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>( st ) )
00232     {
00233         <span class="comment">// Use space as default.</span>
00234         UnicodeCharacter = 0x0020;
00235     }
00236 
00237     <span class="comment">//</span>
00238     <span class="comment">// Advance the source pointer and return the Unicode character.</span>
00239     <span class="comment">//</span>
00240     (*SourceCharacter) += cbCharSize;
00241     <span class="keywordflow">return</span> UnicodeCharacter;
00242 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a21" doxytag="nls.c::RtlAnsiStringToUnicodeString" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS RtlAnsiStringToUnicodeString           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">OUT PUNICODE_STRING&nbsp;</td>
          <td class="mdname" nowrap> <em>DestinationString</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PANSI_STRING&nbsp;</td>
          <td class="mdname" nowrap> <em>SourceString</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>AllocateDestinationString</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d5/nls_8c-source.html#l00082">82</a> of file <a class="el" href="../../d7/d5/nls_8c-source.html">nls.c</a>.
<p>
References <a class="el" href="../../d2/d9/cmchek_8c-source.html#l00095">Index</a>, <a class="el" href="../../d6/d5/stierr_8h-source.html#l00030">NT_SUCCESS</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d6/d8/ntrtlp_8h-source.html#l00246">RTL_PAGED_CODE</a>, <a class="el" href="../../d9/d1/ldrinit_8c-source.html#l00136">RtlAllocateStringRoutine</a>, <a class="el" href="../../d9/d1/ldrinit_8c-source.html#l00137">RtlFreeStringRoutine</a>, <a class="el" href="../../d0/d6/nlsxlat_8c-source.html#l00369">RtlMultiByteToUnicodeN()</a>, <a class="el" href="../../d1/d1/usrbench_8h-source.html#l00230">SourceString</a>, and <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00064">USHORT</a>.
<p>
Referenced by <a class="el" href="../../d1/d7/ntcftxt_8h-source.html#l01386">ChangeDisplaySettingsEx()</a>, <a class="el" href="../../d2/d2/cmsysini_8c-source.html#l02606">CmpAddAliasEntry()</a>, <a class="el" href="../../d9/d9/geninst_8c-source.html#l01392">CmpAppendStringToMultiSz()</a>, <a class="el" href="../../d2/d2/cmsysini_8c-source.html#l02786">CmpCreateControlSet()</a>, <a class="el" href="../../d7/d1/hwprofil_8c-source.html#l02529">CmpCreateHwProfileFriendlyName()</a>, <a class="el" href="../../d1/d9/cmboot_8c-source.html#l01082">CmpFindControlSet()</a>, <a class="el" href="../../d9/d9/geninst_8c-source.html#l00987">CmpGetAddRegInfData()</a>, <a class="el" href="../../d5/d0/config_2alpha_2init_8c-source.html#l00037">CmpInitializeMachineDependentConfiguration()</a>, <a class="el" href="../../d5/d9/cmconfig_8c-source.html#l00458">CmpInitializeRegistryNode()</a>, <a class="el" href="../../d2/d2/cmsysini_8c-source.html#l02022">CmpInitializeSystemHive()</a>, <a class="el" href="../../d9/d9/geninst_8c-source.html#l01264">CmpOpenRegKey()</a>, <a class="el" href="../../d9/d9/geninst_8c-source.html#l00311">CmpProcessAddRegLine()</a>, <a class="el" href="../../d9/d9/geninst_8c-source.html#l00776">CmpProcessBitRegLine()</a>, <a class="el" href="../../d9/d9/geninst_8c-source.html#l00658">CmpProcessDelRegLine()</a>, <a class="el" href="../../d2/d2/cmsysini_8c-source.html#l01545">CmpSetVersionData()</a>, <a class="el" href="../../d4/d7/client_8c-source.html#l02455">CreateDesktopA()</a>, <a class="el" href="../../d2/d9/csrinit_8c-source.html#l00106">CsrClientConnectToServer()</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l01165">CtLnpQos()</a>, <a class="el" href="../../d9/d9/ctlpcqos_8c-source.html#l01187">CtLpcQos()</a>, <a class="el" href="../../d8/d2/dbgkproc_8c-source.html#l00211">DbgkCreateThread()</a>, <a class="el" href="../../d8/d2/dbgkproc_8c-source.html#l00136">DbgkpSectionHandleToFileHandle()</a>, <a class="el" href="../../d1/d7/ntcftxt_8h-source.html#l01102">EnumDisplayDevices()</a>, <a class="el" href="../../d1/d7/ntcftxt_8h-source.html#l01211">EnumDisplaySettingsEx()</a>, <a class="el" href="../../d7/d7/ex_2harderr_8c-source.html#l00064">ExpSystemErrorHandler()</a>, <a class="el" href="../../d3/d4/editreg_8c-source.html#l00453">FtCreateKey()</a>, <a class="el" href="../../d3/d4/editreg_8c-source.html#l00557">FtDeleteValue()</a>, <a class="el" href="../../d3/d4/editreg_8c-source.html#l00357">FtOpenKey()</a>, <a class="el" href="../../d3/d4/editreg_8c-source.html#l01534">FtReturnValue()</a>, <a class="el" href="../../d3/d4/editreg_8c-source.html#l00602">FtSetValue()</a>, <a class="el" href="../../d8/d7/w32_2ntuser_2server_2harderr_8c-source.html#l00423">GetHardErrorText()</a>, <a class="el" href="../../d7/d2/queue_8c-source.html#l05857">GetTaskName()</a>, <a class="el" href="../../d8/d1/drivesup_8c-source.html#l00934">HalpNextDriveLetter()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l11641">IoGetBootDiskInformation()</a>, <a class="el" href="../../d0/d5/ioinit_8c-source.html#l00270">IoInitSystem()</a>, <a class="el" href="../../d5/d5/netboot_8c-source.html#l00314">IopAddRemoteBootValuesToRegistry()</a>, <a class="el" href="../../d6/d8/arcsec_8c-source.html#l00168">IopApplySystemPartitionProt()</a>, <a class="el" href="../../d5/d5/netboot_8c-source.html#l01546">IopAssignNetworkDriveLetter()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l09157">IopCopyBootLogRegistryToFile()</a>, <a class="el" href="../../d0/d5/ioinit_8c-source.html#l01047">IopCreateArcNames()</a>, <a class="el" href="../../d3/d2/dumpctl_8c-source.html#l00384">IopGetDumpStack()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l08928">IopInitializeBootLogging()</a>, <a class="el" href="../../d0/d5/ioinit_8c-source.html#l03479">IopMarkBootPartition()</a>, <a class="el" href="../../d0/d5/ioinit_8c-source.html#l03612">IopReassignSystemRoot()</a>, <a class="el" href="../../d5/d5/netboot_8c-source.html#l01982">IopSetupRemoteBootCard()</a>, <a class="el" href="../../d5/d5/netboot_8c-source.html#l03974">IopWriteIpAddressToRegistry()</a>, <a class="el" href="../../d6/d1/fekbdcom_8c-source.html#l00199">KbdLayerRealDllFileForWBT()</a>, <a class="el" href="../../d3/d2/ldrsnap_8c-source.html#l00140">LdrpLoadImportModule()</a>, <a class="el" href="../../d3/d2/ldrsnap_8c-source.html#l02476">LdrpSnapThunk()</a>, <a class="el" href="../../d3/d2/ldrsnap_8c-source.html#l02802">LdrpUpdateLoadCount()</a>, <a class="el" href="../../d3/d4/editreg_8c-source.html#l02460">main()</a>, <a class="el" href="../../d6/d5/memprint_8c-source.html#l00598">MemPrintWriteThread()</a>, <a class="el" href="../../d9/d7/sysload_8c-source.html#l00443">MiLoadSystemImage()</a>, <a class="el" href="../../d9/d7/sysload_8c-source.html#l03953">MiResolveImageReferences()</a>, <a class="el" href="../../d9/d7/sysload_8c-source.html#l04464">MiSnapThunk()</a>, <a class="el" href="../../d6/d7/sysenv_8c-source.html#l00045">NtQuerySystemEnvironmentValue()</a>, <a class="el" href="../../d9/d9/rtbatcr_8c-source.html#l00222">processargs()</a>, <a class="el" href="../../d3/d6/string_8c-source.html#l00544">RtlCreateUnicodeStringFromAsciiz()</a>, <a class="el" href="../../d0/d3/cnvint_8c-source.html#l00632">RtlInt64ToUnicodeString()</a>, <a class="el" href="../../d0/d3/cnvint_8c-source.html#l00433">RtlIntegerToUnicodeString()</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l01582">SepClientOpenPipe()</a>, <a class="el" href="../../d0/d5/seinit_8c-source.html#l00184">SepInitializationPhase1()</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l01093">SepServerSpawnClientProcess()</a>, <a class="el" href="../../d1/d9/rmmain_8c-source.html#l00060">SeRmInitPhase1()</a>, <a class="el" href="../../d3/d0/client_2cmdline_8c-source.html#l01313">SetConsoleInputExeNameA()</a>, <a class="el" href="../../d3/d9/tenv_8c-source.html#l00046">SetEnvironment()</a>, <a class="el" href="../../d1/d0/ctseacc_8c-source.html#l00086">TestSeInitialize()</a>, and <a class="el" href="../../d8/d1/drivesup_8c-source.html#l01243">xHalIoAssignDriveLetters()</a>.
<p>
<pre class="fragment"><div>00090                    :
00091 
00092     This <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a16">functions</a> converts <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified ansi source string into a
00093     <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a96">Unicode</a> string. The <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a46">translation</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> done with respect to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00094     current system locale information.
00095 
00096 Arguments:
00097 
00098     DestinationString - Returns a unicode string that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> equivalent to
00099         <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> ansi source string. The maximum length field <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <a class="code" href="../../d3/d0/imm32_8def.html#a1">only</a>
00100         set <span class="keywordflow">if</span> AllocateDestinationString <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>.
00101 
00102     <a class="code" href="../../d0/d2/usrbench_8h.html#a33">SourceString</a> - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> ansi source string that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to be
00103         converted to unicode.
00104 
00105     AllocateDestinationString - Supplies a flag that controls whether or
00106         not <span class="keyword">this</span> API allocates <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> buffer space <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> destination
00107         string.  If <a class="code" href="../../d1/d9/icmui_8def.html#a4">it</a> does, then <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> buffer must be deallocated <span class="keyword">using</span>
00108         <a class="code" href="../../d6/d6/nls_8c.html#a34">RtlFreeUnicodeString</a> (note that only storage <span class="keywordflow">for</span>
00109         DestinationString-&gt;Buffer is allocated by <span class="keyword">this</span> API).
00110 
00111 Return Value:
00112 
00113     SUCCESS - The conversion was successful
00114 
00115     !SUCCESS - The operation failed.  No storage was allocated and no
00116         conversion was done.  None.
00117 
00118 --*/
00119 
00120 {
00121     ULONG UnicodeLength;
00122     ULONG <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>;
00123     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> st;
00124 
00125     <a class="code" href="../../d5/d9/ntrtlp_8h.html#a12">RTL_PAGED_CODE</a>();
00126 
00127     UnicodeLength = RtlAnsiStringToUnicodeSize(SourceString);
00128     <span class="keywordflow">if</span> ( UnicodeLength &gt; MAXUSHORT ) {
00129         <span class="keywordflow">return</span> STATUS_INVALID_PARAMETER_2;
00130         }
00131 
00132     DestinationString-&gt;Length = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)(UnicodeLength - <span class="keyword">sizeof</span>(UNICODE_NULL));
00133     <span class="keywordflow">if</span> ( AllocateDestinationString ) {
00134         DestinationString-&gt;MaximumLength = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)UnicodeLength;
00135         DestinationString-&gt;Buffer = (<a class="code" href="../../d8/d2/ldrinit_8c.html#a7">RtlAllocateStringRoutine</a>)(UnicodeLength);
00136         <span class="keywordflow">if</span> ( !DestinationString-&gt;Buffer ) {
00137             <span class="keywordflow">return</span> STATUS_NO_MEMORY;
00138             }
00139         }
00140     <span class="keywordflow">else</span> {
00141         <span class="keywordflow">if</span> ( DestinationString-&gt;Length &gt;= DestinationString-&gt;MaximumLength ) {
00142             <span class="keywordflow">return</span> STATUS_BUFFER_OVERFLOW;
00143             }
00144         }
00145 
00146     st = <a class="code" href="../../d9/d6/nlsxlat_8c.html#a33">RtlMultiByteToUnicodeN</a>(
00147              DestinationString-&gt;Buffer,
00148              DestinationString-&gt;Length,
00149              &amp;Index,
00150              <a class="code" href="../../d0/d2/usrbench_8h.html#a33">SourceString</a>-&gt;Buffer,
00151              <a class="code" href="../../d0/d2/usrbench_8h.html#a33">SourceString</a>-&gt;Length
00152              );
00153 
00154     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(st)) {
00155         <span class="keywordflow">if</span> ( AllocateDestinationString ) {
00156             (<a class="code" href="../../d8/d2/ldrinit_8c.html#a8">RtlFreeStringRoutine</a>)(DestinationString-&gt;Buffer);
00157             DestinationString-&gt;Buffer = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00158         }
00159 
00160         <span class="keywordflow">return</span> st;
00161     }
00162 
00163     DestinationString-&gt;Buffer[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> / <span class="keyword">sizeof</span>(WCHAR)] = UNICODE_NULL;
00164 
00165     <span class="keywordflow">return</span> STATUS_SUCCESS;
00166 
00167 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a46" doxytag="nls.c::RtlAppendUnicodeStringToString" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS RtlAppendUnicodeStringToString           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PUNICODE_STRING&nbsp;</td>
          <td class="mdname" nowrap> <em>Destination</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PUNICODE_STRING&nbsp;</td>
          <td class="mdname" nowrap> <em>Source</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d5/nls_8c-source.html#l01883">1883</a> of file <a class="el" href="../../d7/d5/nls_8c-source.html">nls.c</a>.
<p>
References <a class="el" href="../../d8/d9/exts_8h-source.html#l00092">n</a>, and <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00064">USHORT</a>.
<p>
Referenced by <a class="el" href="../../d1/d9/cmboot_8c-source.html#l00538">CmpAddDriverToList()</a>, <a class="el" href="../../d3/d1/cmparse_8c-source.html#l01476">CmpGetSymbolicLink()</a>, <a class="el" href="../../d7/d1/cmsavres_8c-source.html#l00484">CmpLoadHiveVolatile()</a>, <a class="el" href="../../d8/d6/ntapi_8c-source.html#l03603">CmpNameFromAttributes()</a>, <a class="el" href="../../d7/d7/fsvga_8c-source.html#l00053">DriverEntry()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l00810">IoOpenDeviceRegistryKey()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l09046">IopBootLog()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l05137">IopBuildSymbolicLinkStrings()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l06037">IopDeleteSessionSymLinks()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l02072">IopGetDriverNameFromKeyNode()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l03200">IopLoadDriver()</a>, <a class="el" href="../../d3/d2/dumpctl_8c-source.html#l00954">IopLoadDumpDriver()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l08822">IopSafebootDriverLoad()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l04140">IopUnregisterDeviceInterface()</a>, <a class="el" href="../../d3/d2/io_2query_8c-source.html#l00070">IoQueryDeviceDescription()</a>, <a class="el" href="../../d7/d8/restrfil_8c-source.html#l01163">IsInterestingPath()</a>, <a class="el" href="../../d6/d1/fekbdcom_8c-source.html#l00199">KbdLayerRealDllFileForWBT()</a>, <a class="el" href="../../d2/d2/ldrrsrc_8c-source.html#l01563">LdrLoadAlternateResourceModule()</a>, <a class="el" href="../../d9/d1/ldrinit_8c-source.html#l00616">LdrpInitializeProcess()</a>, <a class="el" href="../../d9/d1/ldrinit_8c-source.html#l01796">LdrQueryImageFileExecutionOptions()</a>, <a class="el" href="../../d9/d7/sysload_8c-source.html#l00443">MiLoadSystemImage()</a>, <a class="el" href="../../d9/d7/sysload_8c-source.html#l03953">MiResolveImageReferences()</a>, <a class="el" href="../../d9/d7/sysload_8c-source.html#l06717">MmCallDllInitialize()</a>, <a class="el" href="../../d2/d6/w32_2ntuser_2kernel_2profile_8c-source.html#l00263">OpenCacheKeyEx()</a>, <a class="el" href="../../d3/d2/io_2query_8c-source.html#l00223">pIoQueryBusDescription()</a>, <a class="el" href="../../d3/d2/io_2query_8c-source.html#l00565">pIoQueryDeviceDescription()</a>, <a class="el" href="../../d5/d6/rtl_2regutil_8c-source.html#l00092">RtlpGetRegistryHandle()</a>, <a class="el" href="../../d0/d6/desktop_8c-source.html#l04821">xxxResolveDesktop()</a>, and <a class="el" href="../../d0/d6/desktop_8c-source.html#l04588">xxxResolveDesktopForWOW()</a>.
<p>
<pre class="fragment"><div>01890                    :
01891 
01892     This routine will concatinate two PSTRINGs together.  It will copy
01893     bytes from <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> source up to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> MaximumLength of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> destination.
01894 
01895 Arguments:
01896 
01897     IN PSTRING Destination, - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> destination string
01898     IN PSTRING Source - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> source <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> string copy
01899 
01900 Return Value:
01901 
01902     STATUS_SUCCESS - The source string was successfully appended to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
01903         destination counted string.
01904 
01905     STATUS_BUFFER_TOO_SMALL - The destination string length was not big
01906         enough to allow <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> source string to be appended.  The Destination
01907         string length <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> not updated.
01908 
01909 --*/
01910 
01911 {
01912     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a> <a class="code" href="../../d7/d0/exts_8h.html#a0">n</a> = Source-&gt;Length;
01913     UNALIGNED WCHAR *dst;
01914 
01915     <span class="keywordflow">if</span> (<a class="code" href="../../d7/d0/exts_8h.html#a0">n</a>) {
01916         <span class="keywordflow">if</span> ((<a class="code" href="../../d7/d0/exts_8h.html#a0">n</a> + Destination-&gt;Length) &gt; Destination-&gt;MaximumLength) {
01917             <span class="keywordflow">return</span>( STATUS_BUFFER_TOO_SMALL );
01918             }
01919 
01920         dst = &amp;Destination-&gt;Buffer[ (Destination-&gt;Length / <span class="keyword">sizeof</span>( WCHAR )) ];
01921         RtlMoveMemory( dst, Source-&gt;Buffer, n );
01922 
01923         Destination-&gt;Length += <a class="code" href="../../d7/d0/exts_8h.html#a0">n</a>;
01924 
01925         <span class="keywordflow">if</span> (Destination-&gt;Length &lt; Destination-&gt;MaximumLength) {
01926             dst[ <a class="code" href="../../d7/d0/exts_8h.html#a0">n</a> / <span class="keyword">sizeof</span>( WCHAR ) ] = UNICODE_NULL;
01927             }
01928         }
01929 
01930     <span class="keywordflow">return</span>( STATUS_SUCCESS );
01931 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a45" doxytag="nls.c::RtlAppendUnicodeToString" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS RtlAppendUnicodeToString           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PUNICODE_STRING&nbsp;</td>
          <td class="mdname" nowrap> <em>Destination</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PCWSTR Source&nbsp;</td>
          <td class="mdname" nowrap> <em>OPTIONAL</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d5/nls_8c-source.html#l01821">1821</a> of file <a class="el" href="../../d7/d5/nls_8c-source.html">nls.c</a>.
<p>
References <a class="el" href="../../d8/d9/exts_8h-source.html#l00092">n</a>, <a class="el" href="../../d3/d6/string_8c-source.html#l00148">RtlInitUnicodeString()</a>, and <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00064">USHORT</a>.
<p>
Referenced by <a class="el" href="../../d1/d9/cmboot_8c-source.html#l00538">CmpAddDriverToList()</a>, <a class="el" href="../../d1/d9/cmboot_8c-source.html#l00333">CmpFindDrivers()</a>, <a class="el" href="../../d7/d1/cmsavres_8c-source.html#l00484">CmpLoadHiveVolatile()</a>, <a class="el" href="../../d2/d9/csrinit_8c-source.html#l00359">CsrpConnectToServer()</a>, <a class="el" href="../../d7/d7/fsvga_8c-source.html#l00053">DriverEntry()</a>, <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l00769">ExpValidateLocale()</a>, <a class="el" href="../../d7/d7/fsvga_8c-source.html#l00858">FsVgaServiceParameters()</a>, <a class="el" href="../../d6/d1/fekbdcom_8c-source.html#l00118">GetRealDllFileNameWorker()</a>, <a class="el" href="../../d7/d8/restrfil_8c-source.html#l00879">InitializeRestrictedStuff()</a>, <a class="el" href="../../d2/d6/w32_2ntuser_2kernel_2profile_8c-source.html#l00103">InitPreviousUserString()</a>, <a class="el" href="../../d8/d4/ioerr_8c-source.html#l01052">IoepCatMsgArg()</a>, <a class="el" href="../../d8/d4/ioerr_8c-source.html#l00936">IoepGetErrMessage()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l00810">IoOpenDeviceRegistryKey()</a>, <a class="el" href="../../d6/d0/pnpres_8c-source.html#l02034">IopBuildCmResourceList()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l05137">IopBuildSymbolicLinkStrings()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l02072">IopGetDriverNameFromKeyNode()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l03200">IopLoadDriver()</a>, <a class="el" href="../../d3/d2/dumpctl_8c-source.html#l00954">IopLoadDumpDriver()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l08822">IopSafebootDriverLoad()</a>, <a class="el" href="../../d7/d8/restrfil_8c-source.html#l01163">IsInterestingPath()</a>, <a class="el" href="../../d2/d2/ldrrsrc_8c-source.html#l01563">LdrLoadAlternateResourceModule()</a>, <a class="el" href="../../d9/d1/ldrinit_8c-source.html#l00616">LdrpInitializeProcess()</a>, <a class="el" href="../../d9/d1/ldrinit_8c-source.html#l01796">LdrQueryImageFileExecutionOptions()</a>, <a class="el" href="../../d3/d4/mapper_8c-source.html#l01600">MapperConstructRootEnumTree()</a>, <a class="el" href="../../d3/d4/mapper_8c-source.html#l01091">MapperMarkKey()</a>, <a class="el" href="../../d3/d4/mapper_8c-source.html#l02060">MapperPhantomizeDetectedComPorts()</a>, <a class="el" href="../../d3/d4/mapper_8c-source.html#l01298">MapperSeedKey()</a>, <a class="el" href="../../d9/d7/sysload_8c-source.html#l03953">MiResolveImageReferences()</a>, <a class="el" href="../../d9/d7/sysload_8c-source.html#l06717">MmCallDllInitialize()</a>, <a class="el" href="../../d2/d6/w32_2ntuser_2kernel_2profile_8c-source.html#l00263">OpenCacheKeyEx()</a>, <a class="el" href="../../d6/d8/w32_2ntuser_2kernel_2pnp_8c-source.html#l00565">OpenMultiplePortDevice()</a>, <a class="el" href="../../d3/d2/io_2query_8c-source.html#l00223">pIoQueryBusDescription()</a>, <a class="el" href="../../d3/d2/io_2query_8c-source.html#l00565">pIoQueryDeviceDescription()</a>, <a class="el" href="../../d2/d6/w32_2ntuser_2kernel_2profile_8c-source.html#l00188">RemoteOpenCacheKeyEx()</a>, <a class="el" href="../../d5/d6/rtl_2regutil_8c-source.html#l01453">RtlFormatCurrentUserKeyPath()</a>, <a class="el" href="../../d5/d6/rtl_2regutil_8c-source.html#l00092">RtlpGetRegistryHandle()</a>, <a class="el" href="../../d0/d6/desktop_8c-source.html#l04821">xxxResolveDesktop()</a>, and <a class="el" href="../../d0/d6/desktop_8c-source.html#l04588">xxxResolveDesktopForWOW()</a>.
<p>
<pre class="fragment"><div>01828                    :
01829 
01830     This routine appends <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> supplied UNICODE string to an existing
01831     PUNICODE_STRING.
01832 
01833     It will copy bytes from <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> Source PSZ to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> destination PSTRING up to
01834     <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> destinations PUNICODE_STRING-&gt;MaximumLength field.
01835 
01836 Arguments:
01837 
01838     IN PUNICODE_STRING Destination, - Supplies a pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> destination
01839                             string
01840     IN PWSTR Source - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> string to append to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> destination
01841 
01842 Return Value:
01843 
01844     STATUS_SUCCESS - The source string was successfully appended to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
01845         destination counted string.
01846 
01847     STATUS_BUFFER_TOO_SMALL - The destination string length was not big
01848         enough to allow <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> source string to be appended.  The Destination
01849         string length <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> not updated.
01850 
01851 --*/
01852 
01853 {
01854     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a> <a class="code" href="../../d7/d0/exts_8h.html#a0">n</a>;
01855     UNALIGNED WCHAR *dst;
01856 
01857     <span class="keywordflow">if</span> (ARGUMENT_PRESENT( Source )) {
01858         UNICODE_STRING UniSource;
01859 
01860         <a class="code" href="../../d2/d7/string_8c.html#a7">RtlInitUnicodeString</a>(&amp;UniSource, Source);
01861 
01862         <a class="code" href="../../d7/d0/exts_8h.html#a0">n</a> = UniSource.Length;
01863 
01864         <span class="keywordflow">if</span> ((<a class="code" href="../../d7/d0/exts_8h.html#a0">n</a> + Destination-&gt;Length) &gt; Destination-&gt;MaximumLength) {
01865             <span class="keywordflow">return</span>( STATUS_BUFFER_TOO_SMALL );
01866             }
01867 
01868         dst = &amp;Destination-&gt;Buffer[ (Destination-&gt;Length / <span class="keyword">sizeof</span>( WCHAR )) ];
01869         RtlMoveMemory( dst, Source, n );
01870 
01871         Destination-&gt;Length += <a class="code" href="../../d7/d0/exts_8h.html#a0">n</a>;
01872 
01873         <span class="keywordflow">if</span> (Destination-&gt;Length &lt; Destination-&gt;MaximumLength) {
01874             dst[ <a class="code" href="../../d7/d0/exts_8h.html#a0">n</a> / <span class="keyword">sizeof</span>( WCHAR ) ] = UNICODE_NULL;
01875             }
01876         }
01877 
01878     <span class="keywordflow">return</span>( STATUS_SUCCESS );
01879 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a41" doxytag="nls.c::RtlCompareUnicodeString" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> LONG RtlCompareUnicodeString           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PUNICODE_STRING&nbsp;</td>
          <td class="mdname" nowrap> <em>String1</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PUNICODE_STRING&nbsp;</td>
          <td class="mdname" nowrap> <em>String2</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>CaseInSensitive</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d5/nls_8c-source.html#l01520">1520</a> of file <a class="el" href="../../d7/d5/nls_8c-source.html">nls.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d6/d8/ntrtlp_8h-source.html#l00219">NLS_UPCASE</a>, <a class="el" href="../../d0/d9/tcmpmem_8c-source.html#l00037">String1</a>, and <a class="el" href="../../d0/d9/tcmpmem_8c-source.html#l00038">String2</a>.
<p>
Referenced by <a class="el" href="../../d3/d1/cmparse_8c-source.html#l01853">CmpCacheLookup()</a>, <a class="el" href="../../d8/d0/cmindex_8c-source.html#l00722">CmpDoCompareKeyName()</a>, <a class="el" href="../../d5/d2/cmtree_8c-source.html#l00033">CmpFindNameInList()</a>, <a class="el" href="../../d5/d2/cmtree_8c-source.html#l00309">CmpFindValueByNameFromCache()</a>, <a class="el" href="../../d3/d4/mapper_8c-source.html#l01955">ComPortDBAdd()</a>, <a class="el" href="../../d2/d6/tunnel_8c-source.html#l00218">FsRtlCompareNodeAndKey()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l06037">IopDeleteSessionSymLinks()</a>, <a class="el" href="../../d6/d0/pnpres_8c-source.html#l07775">IopEliminateBogusConflict()</a>, <a class="el" href="../../d0/d0/dockhwp_8c-source.html#l01028">IopExecuteHardwareProfileChange()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l02707">IopGetDeviceInterfaces()</a>, <a class="el" href="../../d4/d0/server_2cmdline_8c-source.html#l00369">MyStringCompareW()</a>, <a class="el" href="../../d3/d0/pnpmap_8c-source.html#l02089">PnPBiosCopyDeviceParamKey()</a>, <a class="el" href="../../d6/d6/environ_8c-source.html#l00458">RtlSetEnvironmentVariable()</a>, and <a class="el" href="../../d7/d2/queue_8c-source.html#l00702">SetAppImeCompatFlags()</a>.
<p>
<pre class="fragment"><div>01528                    :
01529 
01530     The <a class="code" href="../../d7/d6/nlsboot_8c.html#a2">RtlCompareUnicodeString</a> function compares two counted strings.  The
01531     <span class="keywordflow">return</span> value indicates <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> strings are equal or <a class="code" href="../../d9/d9/tcmpmem_8c.html#a1">String1</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> less than
01532     <a class="code" href="../../d9/d9/tcmpmem_8c.html#a2">String2</a> or <a class="code" href="../../d9/d9/tcmpmem_8c.html#a1">String1</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> greater than <a class="code" href="../../d9/d9/tcmpmem_8c.html#a2">String2</a>.
01533 
01534     The CaseInSensitive parameter specifies <span class="keywordflow">if</span> <span class="keywordflow">case</span> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to be ignored when
01535     doing <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> comparison.
01536 
01537 Arguments:
01538 
01539     <a class="code" href="../../d9/d9/tcmpmem_8c.html#a1">String1</a> - Pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> first string.
01540 
01541     <a class="code" href="../../d9/d9/tcmpmem_8c.html#a2">String2</a> - Pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> second string.
01542 
01543     CaseInsensitive - <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> <span class="keywordflow">if</span> <span class="keywordflow">case</span> should be ignored when doing <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
01544         comparison.
01545 
01546 Return Value:
01547 
01548     Signed value that gives <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> results of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> comparison:
01549 
01550         <a class="code" href="../../d6/d6/ttime_8c.html#a0">Zero</a> - <a class="code" href="../../d9/d9/tcmpmem_8c.html#a1">String1</a> equals <a class="code" href="../../d9/d9/tcmpmem_8c.html#a2">String2</a>
01551 
01552         &lt; <a class="code" href="../../d6/d6/ttime_8c.html#a0">Zero</a> - <a class="code" href="../../d9/d9/tcmpmem_8c.html#a1">String1</a> less than <a class="code" href="../../d9/d9/tcmpmem_8c.html#a2">String2</a>
01553 
01554         &gt; <a class="code" href="../../d6/d6/ttime_8c.html#a0">Zero</a> - <a class="code" href="../../d9/d9/tcmpmem_8c.html#a1">String1</a> greater than <a class="code" href="../../d9/d9/tcmpmem_8c.html#a2">String2</a>
01555 
01556 
01557 --*/
01558 
01559 {
01560 
01561     PWCHAR s1, s2, Limit;
01562     LONG n1, n2;
01563     WCHAR c1, c2;
01564 
01565     s1 = <a class="code" href="../../d9/d9/tcmpmem_8c.html#a1">String1</a>-&gt;Buffer;
01566     s2 = <a class="code" href="../../d9/d9/tcmpmem_8c.html#a2">String2</a>-&gt;Buffer;
01567     n1 = <a class="code" href="../../d9/d9/tcmpmem_8c.html#a1">String1</a>-&gt;Length;
01568     n2 = <a class="code" href="../../d9/d9/tcmpmem_8c.html#a2">String2</a>-&gt;Length;
01569 
01570     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>((n1 &amp; 1) == 0);
01571     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>((n2 &amp; 1) == 0);
01572     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(!(((((ULONG_PTR)s1 &amp; 1) != 0) || (((ULONG_PTR)s2 &amp; 1) != 0)) &amp;&amp; (n1 != 0) &amp;&amp; (n2 != 0)));
01573 
01574     Limit = (PWCHAR)((PCHAR)s1 + (n1 &lt;= n2 ? n1 : n2));
01575     <span class="keywordflow">if</span> (CaseInSensitive) {
01576         <span class="keywordflow">while</span> (s1 &lt; Limit) {
01577             c1 = *s1++;
01578             c2 = *s2++;
01579             <span class="keywordflow">if</span> (c1 != c2) {
01580 
01581                 <span class="comment">//</span>
01582                 <span class="comment">// Note that this needs to reference the translation table!</span>
01583                 <span class="comment">//</span>
01584 
01585                 c1 = <a class="code" href="../../d5/d9/ntrtlp_8h.html#a10">NLS_UPCASE</a>(c1);
01586                 c2 = <a class="code" href="../../d5/d9/ntrtlp_8h.html#a10">NLS_UPCASE</a>(c2);
01587                 <span class="keywordflow">if</span> (c1 != c2) {
01588                     <span class="keywordflow">return</span> (LONG)(c1) - (LONG)(c2);
01589                 }
01590             }
01591         }
01592 
01593     } <span class="keywordflow">else</span> {
01594         <span class="keywordflow">while</span> (s1 &lt; Limit) {
01595             c1 = *s1++;
01596             c2 = *s2++;
01597             <span class="keywordflow">if</span> (c1 != c2) {
01598                 <span class="keywordflow">return</span> (LONG)(c1) - (LONG)(c2);
01599             }
01600         }
01601     }
01602 
01603     <span class="keywordflow">return</span> n1 - n2;
01604 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a44" doxytag="nls.c::RtlCopyUnicodeString" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID RtlCopyUnicodeString           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">OUT PUNICODE_STRING&nbsp;</td>
          <td class="mdname" nowrap> <em>DestinationString</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PUNICODE_STRING <a class="el" href="../../d0/d2/usrbench_8h.html#a33">SourceString</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>OPTIONAL</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d5/nls_8c-source.html#l01763">1763</a> of file <a class="el" href="../../d7/d5/nls_8c-source.html">nls.c</a>.
<p>
References <a class="el" href="../../d8/d9/exts_8h-source.html#l00092">n</a>, <a class="el" href="../../d1/d1/usrbench_8h-source.html#l00230">SourceString</a>, and <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00064">USHORT</a>.
<p>
Referenced by <a class="el" href="../../d8/d3/loadbits_8c-source.html#l00395">_InternalGetIconInfo()</a>, <a class="el" href="../../d7/d1/cmsavres_8c-source.html#l00484">CmpLoadHiveVolatile()</a>, <a class="el" href="../../d6/d8/w32_2ntuser_2kernel_2pnp_8c-source.html#l00406">CreateDeviceInfo()</a>, <a class="el" href="../../d2/d6/w32_2ntuser_2kernel_2profile_8c-source.html#l00151">CreateProfileUserName()</a>, <a class="el" href="../../d2/d6/tunnel_8c-source.html#l00913">FsRtlFindInTunnelCache()</a>, <a class="el" href="../../d7/d7/fsvga_8c-source.html#l00858">FsVgaServiceParameters()</a>, <a class="el" href="../../d2/d6/w32_2ntuser_2kernel_2profile_8c-source.html#l00103">InitPreviousUserString()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l09046">IopBootLog()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l05137">IopBuildSymbolicLinkStrings()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l06037">IopDeleteSessionSymLinks()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l06858">IopNotifyHwProfileChange()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l04741">IopOpenOrCreateDeviceInterfaceSubKeys()</a>, <a class="el" href="../../d5/d2/parse_8c-source.html#l00202">IopParseDevice()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l08822">IopSafebootDriverLoad()</a>, <a class="el" href="../../d7/d8/restrfil_8c-source.html#l01163">IsInterestingPath()</a>, <a class="el" href="../../d6/d1/fekbdcom_8c-source.html#l00199">KbdLayerRealDllFileForWBT()</a>, <a class="el" href="../../d2/d2/ldrrsrc_8c-source.html#l01563">LdrLoadAlternateResourceModule()</a>, <a class="el" href="../../d3/d2/ldrsnap_8c-source.html#l00832">LdrpCheckForLoadedDll()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l01303">NtUserResolveDesktopForWOW()</a>, <a class="el" href="../../d1/d1/obtype_8c-source.html#l00069">ObCreateObjectType()</a>, <a class="el" href="../../d1/d0/obinit_8c-source.html#l01349">ObpCreateDosDevicesDirectory()</a>, <a class="el" href="../../d1/d0/psinit_8c-source.html#l00525">PsLocateSystemDll()</a>, <a class="el" href="../../d9/d5/sertl_8c-source.html#l01611">RtlConvertSidToUnicodeString()</a>, <a class="el" href="../../d4/d4/seaudit_8c-source.html#l02765">SeOpenObjectAuditAlarm()</a>, <a class="el" href="../../d4/d4/seaudit_8c-source.html#l03085">SeOpenObjectForDeleteAuditAlarm()</a>, <a class="el" href="../../d3/d4/se_2capture_8c-source.html#l00681">SepCopyProxyData()</a>, <a class="el" href="../../d0/d6/desktop_8c-source.html#l04821">xxxResolveDesktop()</a>, and <a class="el" href="../../d0/d6/desktop_8c-source.html#l04588">xxxResolveDesktopForWOW()</a>.
<p>
<pre class="fragment"><div>01770                    :
01771 
01772     The <a class="code" href="../../d2/d7/string_8c.html#a8">RtlCopyString</a> function copies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d0/d2/usrbench_8h.html#a33">SourceString</a> to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
01773     DestinationString.  If <a class="code" href="../../d0/d2/usrbench_8h.html#a33">SourceString</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> not specified, then
01774     <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> Length field of DestinationString <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> set to zero.  The
01775     MaximumLength and <a class="code" href="../../d6/d2/rtqkey_8c.html#a3">Buffer</a> fields of DestinationString are not
01776     modified by <span class="keyword">this</span> function.
01777 
01778     The number of bytes copied from <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d0/d2/usrbench_8h.html#a33">SourceString</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> either <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
01779     Length of <a class="code" href="../../d0/d2/usrbench_8h.html#a33">SourceString</a> or <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> MaximumLength of DestinationString,
01780     whichever <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> smaller.
01781 
01782 Arguments:
01783 
01784     DestinationString - Pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> destination string.
01785 
01786     <a class="code" href="../../d0/d2/usrbench_8h.html#a33">SourceString</a> - Optional pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> source string.
01787 
01788 Return Value:
01789 
01790     None.
01791 
01792 --*/
01793 
01794 {
01795     UNALIGNED WCHAR *src, *dst;
01796     ULONG <a class="code" href="../../d7/d0/exts_8h.html#a0">n</a>;
01797 
01798     <span class="keywordflow">if</span> (ARGUMENT_PRESENT(SourceString)) {
01799         dst = DestinationString-&gt;Buffer;
01800         src = <a class="code" href="../../d0/d2/usrbench_8h.html#a33">SourceString</a>-&gt;Buffer;
01801         <a class="code" href="../../d7/d0/exts_8h.html#a0">n</a> = <a class="code" href="../../d0/d2/usrbench_8h.html#a33">SourceString</a>-&gt;Length;
01802         <span class="keywordflow">if</span> ((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)<a class="code" href="../../d7/d0/exts_8h.html#a0">n</a> &gt; DestinationString-&gt;MaximumLength) {
01803             <a class="code" href="../../d7/d0/exts_8h.html#a0">n</a> = DestinationString-&gt;MaximumLength;
01804         }
01805 
01806         DestinationString-&gt;Length = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)<a class="code" href="../../d7/d0/exts_8h.html#a0">n</a>;
01807         RtlCopyMemory(dst, src, n);
01808         <span class="keywordflow">if</span> (DestinationString-&gt;Length &lt; DestinationString-&gt;MaximumLength) {
01809             dst[<a class="code" href="../../d7/d0/exts_8h.html#a0">n</a> / <span class="keyword">sizeof</span>(WCHAR)] = UNICODE_NULL;
01810         }
01811 
01812     } <span class="keywordflow">else</span> {
01813         DestinationString-&gt;Length = 0;
01814     }
01815 
01816     <span class="keywordflow">return</span>;
01817 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a47" doxytag="nls.c::RtlCreateUnicodeString" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN RtlCreateUnicodeString           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">OUT PUNICODE_STRING&nbsp;</td>
          <td class="mdname" nowrap> <em>DestinationString</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PCWSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>SourceString</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d5/nls_8c-source.html#l01935">1935</a> of file <a class="el" href="../../d7/d5/nls_8c-source.html">nls.c</a>.
<p>
References <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d6/d8/ntrtlp_8h-source.html#l00246">RTL_PAGED_CODE</a>, <a class="el" href="../../d9/d1/ldrinit_8c-source.html#l00136">RtlAllocateStringRoutine</a>, <a class="el" href="../../d1/d1/usrbench_8h-source.html#l00230">SourceString</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, and <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00064">USHORT</a>.
<p>
Referenced by <a class="el" href="../../d7/d1/hwprofil_8c-source.html#l02529">CmpCreateHwProfileFriendlyName()</a>, <a class="el" href="../../d8/d7/w32_2ntuser_2server_2harderr_8c-source.html#l00423">GetHardErrorText()</a>, <a class="el" href="../../d7/d8/restrfil_8c-source.html#l00879">InitializeRestrictedStuff()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l09046">IopBootLog()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l09157">IopCopyBootLogRegistryToFile()</a>, <a class="el" href="../../d5/d5/netboot_8c-source.html#l00770">IopStartNetworkForRemoteBoot()</a>, <a class="el" href="../../d1/d0/obinit_8c-source.html#l01349">ObpCreateDosDevicesDirectory()</a>, <a class="el" href="../../d9/d5/sertl_8c-source.html#l01611">RtlConvertSidToUnicodeString()</a>, and <a class="el" href="../../d7/d8/heappage_8c-source.html#l05087">RtlpDphTargetDllsLoadCallBack()</a>.
<p>
<pre class="fragment"><div>01939 {
01940     ULONG cb;
01941 
01942     <a class="code" href="../../d5/d9/ntrtlp_8h.html#a12">RTL_PAGED_CODE</a>();
01943 
01944     cb = (wcslen( SourceString ) + 1) * <span class="keyword">sizeof</span>( WCHAR );
01945     DestinationString-&gt;Buffer = (<a class="code" href="../../d8/d2/ldrinit_8c.html#a7">RtlAllocateStringRoutine</a>)( cb );
01946     <span class="keywordflow">if</span> (DestinationString-&gt;Buffer) {
01947         RtlMoveMemory( DestinationString-&gt;Buffer, SourceString, cb );
01948         DestinationString-&gt;MaximumLength = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)cb;
01949         DestinationString-&gt;Length = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)(cb - <span class="keyword">sizeof</span>( UNICODE_NULL ));
01950         <span class="keywordflow">return</span>( <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> );
01951         }
01952     <span class="keywordflow">else</span> {
01953         <span class="keywordflow">return</span>( <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a> );
01954         }
01955 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a51" doxytag="nls.c::RtlDnsHostNameToComputerName" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS RtlDnsHostNameToComputerName           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">OUT PUNICODE_STRING&nbsp;</td>
          <td class="mdname" nowrap> <em>ComputerNameString</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PUNICODE_STRING&nbsp;</td>
          <td class="mdname" nowrap> <em>DnsHostNameString</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>AllocateComputerNameString</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d5/nls_8c-source.html#l02519">2519</a> of file <a class="el" href="../../d7/d5/nls_8c-source.html">nls.c</a>.
<p>
References <a class="el" href="../../d2/d0/bench_8c-source.html#l00050">CHAR</a>, <a class="el" href="../../d3/d9/aw_8h-source.html#l00031">L</a>, <a class="el" href="../../d7/d5/nls_8c-source.html#l00076">NETBIOS_NAME_LEN</a>, <a class="el" href="../../d6/d5/stierr_8h-source.html#l00030">NT_SUCCESS</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d6/d8/ntrtlp_8h-source.html#l00246">RTL_PAGED_CODE</a>, <a class="el" href="../../d7/d5/nls_8c-source.html#l00439">RtlOemStringToUnicodeString()</a>, <a class="el" href="../../d0/d6/nlsxlat_8c-source.html#l01665">RtlpDidUnicodeToOemWork()</a>, <a class="el" href="../../d0/d6/nlsxlat_8c-source.html#l01433">RtlUpcaseUnicodeToOemN()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00135">Status</a>, and <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00064">USHORT</a>.
<p>
Referenced by <a class="el" href="../../d5/d5/netboot_8c-source.html#l00314">IopAddRemoteBootValuesToRegistry()</a>.
<p>
<pre class="fragment"><div>02527                    :
02528 
02529     The <a class="code" href="../../d6/d6/nls_8c.html#a51">RtlDnsHostNameToComputerName</a> API converts a DNS-style host name to a
02530     Netbios-style computer name.
02531 
02532     This API does a syntactical mapping of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> name.  As such, <a class="code" href="../../d1/d9/icmui_8def.html#a4">it</a> should not
02533     be used to convert a DNS domain name to a Netbios domain name.
02534     There <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> no syntactical mapping <span class="keywordflow">for</span> domain names.
02535 
02536     DNS-style names consist of one or more <span class="stringliteral">"labels"</span> separated by a period
02537     (e.g., xxx.nt.microsoft.com).  Each label can be up to 63 bytes of
02538     UTF-8 characters and must consist <a class="code" href="../../d3/d0/imm32_8def.html#a1">only</a> of characters specified
02539     by <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> DnsValidateDnsName API.  Upper and lower <span class="keywordflow">case</span> characters are treated
02540     as <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> same character.  DNS names are represented in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> UTF-8 character set
02541     or UNICODE.
02542 
02543     Netbios computer names consist of up to 15 bytes of OEM characters
02544     including letters, digits, hyphens, periods and various other characters.
02545     Some of these characters are specific to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> character set. Netbios names
02546     are typically represented in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> OEM character set.  The OEM character
02547     set <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> different depending on <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> locale of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> particular version of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> OS
02548     (e.g., <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> German version has a different character set than <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> US version).
02549     Some OEM character sets represent certain characters as 2 bytes
02550     (e.g., Japanese).  Netbios names, by convention, are represented in
02551     uppercase where <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a46">translation</a> algorithm from lowercase to uppercase
02552     <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> OEM character set dependent.
02553 
02554     These characteristics make translating between DNS name and Netbios name
02555     difficult.
02556 
02557     <a class="code" href="../../d6/d6/nls_8c.html#a51">RtlDnsHostNameToComputerName</a> enforces a textual convention <span class="keywordflow">for</span>
02558     mapping between <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> two names.  This convention limits <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> names of
02559     computers to be <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> common subset of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> names.  Specifically, <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> leftmost
02560     label of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> DNS name <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> truncated to 15-bytes of OEM characters.
02561     As such, <a class="code" href="../../d6/d6/nls_8c.html#a51">RtlDnsHostNameToComputerName</a> simply interprets <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> leftmost label
02562     of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> DNS name as <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> Netbios name.  If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> DNS name doesn'<a class="code" href="../../d4/d1/genmips_8c.html#a17">t</a> meet <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
02563     criteria of a valid translatable name, a distinct error code <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned.
02564 
02565 Arguments:
02566 
02567     ComputerNameString - Returns a unicode string that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> equivalent to
02568         <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> DNS source string. The maximum length field <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <a class="code" href="../../d3/d0/imm32_8def.html#a1">only</a>
02569         set <span class="keywordflow">if</span> AllocateComputerNameString <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>.
02570 
02571     DnsHostNameString - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> DNS host name source string that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to be
02572         converted to a netbios computer name.
02573 
02574         This routine does NOT attempt to validate that <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> passed in DnsHostNameString
02575         <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> a valid DNS host a DNS host name.  Rather <a class="code" href="../../d1/d9/icmui_8def.html#a4">it</a> assumes that <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> passed in
02576         name <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> valid and converts <a class="code" href="../../d1/d9/icmui_8def.html#a4">it</a> on a best effort basis.
02577 
02578     AllocateComputerNameString - Supplies a flag that controls whether or
02579         not <span class="keyword">this</span> API allocates <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> buffer space <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> destination
02580         string.  If <a class="code" href="../../d1/d9/icmui_8def.html#a4">it</a> does, then <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> buffer must be deallocated <span class="keyword">using</span>
02581         <a class="code" href="../../d6/d6/nls_8c.html#a34">RtlFreeUnicodeString</a> (note that only storage <span class="keywordflow">for</span>
02582         DestinationString-&gt;Buffer is allocated by <span class="keyword">this</span> API).
02583 
02584 Return Value:
02585 
02586     SUCCESS - The conversion was successful
02587 
02588     STATUS_NO_MEMORY - There <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> not enough memory to allocate <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <span class="keywordflow">return</span> buffer.
02589 
02590     STATUS_INVALID_COMPUTER_NAME - The DnsHostName has no first label or
02591         one or more characters of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> DnsHostName could not be converted to
02592         <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> OEM character set.
02593 
02594 --*/
02595 
02596 {
02597     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
02598 
02599 
02600     UNICODE_STRING LocalDnsHostNameString;
02601 
02602     OEM_STRING OemString;
02603     ULONG ActualOemLength;
02604     <a class="code" href="../../d1/d1/bench_8c.html#a16">CHAR</a> OemStringBuffer[16];
02605 
02606     ULONG i;
02607 
02608     <a class="code" href="../../d5/d9/ntrtlp_8h.html#a12">RTL_PAGED_CODE</a>();
02609 
02610     <span class="comment">//</span>
02611     <span class="comment">// Truncate the dns name to the first label</span>
02612     <span class="comment">//</span>
02613 
02614     LocalDnsHostNameString = *DnsHostNameString;
02615 
02616     <span class="keywordflow">for</span> ( i=0; i&lt;LocalDnsHostNameString.Length/<span class="keyword">sizeof</span>(WCHAR); i++ ) {
02617 
02618         <span class="keywordflow">if</span> ( LocalDnsHostNameString.Buffer[i] == <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="charliteral">'.'</span> ) {
02619             LocalDnsHostNameString.Length = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)(i * <span class="keyword">sizeof</span>(WCHAR));
02620             <span class="keywordflow">break</span>;
02621         }
02622     }
02623 
02624     <span class="keywordflow">if</span> ( LocalDnsHostNameString.Length &lt; <span class="keyword">sizeof</span>(WCHAR) ) {
02625         <span class="keywordflow">return</span> STATUS_INVALID_COMPUTER_NAME;
02626     }
02627 
02628     <span class="comment">//</span>
02629     <span class="comment">// Convert the DNS name to OEM truncating at 15 OEM bytes.</span>
02630     <span class="comment">//</span>
02631 
02632     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d9/d6/nlsxlat_8c.html#a40">RtlUpcaseUnicodeToOemN</a>(
02633                 OemStringBuffer,
02634                 NETBIOS_NAME_LEN-1,         <span class="comment">// truncate to 15 bytes</span>
02635                 &amp;ActualOemLength,
02636                 LocalDnsHostNameString.Buffer,
02637                 LocalDnsHostNameString.Length );
02638 
02639     <span class="keywordflow">if</span> ( !<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status) &amp;&amp; <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> != STATUS_BUFFER_OVERFLOW ) {
02640         <span class="keywordflow">return</span> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
02641     }
02642 
02643 
02644     <span class="comment">//</span>
02645     <span class="comment">// Check to see if any characters are not valid OEM characters.</span>
02646     <span class="comment">//</span>
02647 
02648     OemString.Buffer = OemStringBuffer;
02649     OemString.MaximumLength = OemString.Length = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>) ActualOemLength;
02650 
02651     <span class="keywordflow">if</span> ( !<a class="code" href="../../d5/d9/ntrtlp_8h.html#a37">RtlpDidUnicodeToOemWork</a>( &amp;OemString, &amp;LocalDnsHostNameString )) {
02652         <span class="keywordflow">return</span> STATUS_INVALID_COMPUTER_NAME;
02653     }
02654 
02655 
02656     <span class="comment">//</span>
02657     <span class="comment">// Convert the OEM string back to UNICODE</span>
02658     <span class="comment">//</span>
02659 
02660     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d6/d6/nls_8c.html#a25">RtlOemStringToUnicodeString</a>(
02661                 ComputerNameString,
02662                 &amp;OemString,
02663                 AllocateComputerNameString );
02664 
02665     <span class="keywordflow">if</span> ( !<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status) ) {
02666         <span class="keywordflow">return</span> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
02667     }
02668 
02669     <span class="keywordflow">return</span> STATUS_SUCCESS;
02670 }
}
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a32" doxytag="nls.c::RtlDowncaseUnicodeString" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS RtlDowncaseUnicodeString           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">OUT PUNICODE_STRING&nbsp;</td>
          <td class="mdname" nowrap> <em>DestinationString</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PUNICODE_STRING&nbsp;</td>
          <td class="mdname" nowrap> <em>SourceString</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>AllocateDestinationString</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d5/nls_8c-source.html#l01108">1108</a> of file <a class="el" href="../../d7/d5/nls_8c-source.html">nls.c</a>.
<p>
References <a class="el" href="../../d2/d9/cmchek_8c-source.html#l00095">Index</a>, <a class="el" href="../../d6/d8/ntrtlp_8h-source.html#l00231">NLS_DOWNCASE</a>, <a class="el" href="../../d6/d8/ntrtlp_8h-source.html#l00246">RTL_PAGED_CODE</a>, <a class="el" href="../../d9/d1/ldrinit_8c-source.html#l00136">RtlAllocateStringRoutine</a>, and <a class="el" href="../../d1/d1/usrbench_8h-source.html#l00230">SourceString</a>.
<p>
<pre class="fragment"><div>01116                    :
01117 
01118     This <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a16">functions</a> converts <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified unicode source string into a
01119     downcased unicode string. The <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a46">translation</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> done with respect to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
01120     current system locale information.
01121 
01122 Arguments:
01123 
01124     DestinationString - Returns a unicode string that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> downcased
01125         equivalent to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> unicode source string.  The maximum length field
01126         <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <a class="code" href="../../d3/d0/imm32_8def.html#a1">only</a> set <span class="keywordflow">if</span> AllocateDestinationString <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>.
01127 
01128     <a class="code" href="../../d0/d2/usrbench_8h.html#a33">SourceString</a> - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> unicode source string that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to being
01129         downcased.
01130 
01131     AllocateDestinationString - Supplies a flag that controls whether or
01132         not <span class="keyword">this</span> API allocates <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> buffer space <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> destination
01133         string.  If <a class="code" href="../../d1/d9/icmui_8def.html#a4">it</a> does, then <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> buffer must be deallocated <span class="keyword">using</span>
01134         <a class="code" href="../../d6/d6/nls_8c.html#a34">RtlFreeUnicodeString</a> (note that only storage <span class="keywordflow">for</span>
01135         DestinationString-&gt;Buffer is allocated by <span class="keyword">this</span> API).
01136 
01137 Return Value:
01138 
01139     SUCCESS - The conversion was successful
01140 
01141     !SUCCESS - The operation failed.  No storage was allocated and no
01142         conversion was done.  None.
01143 
01144 --*/
01145 
01146 {
01147     ULONG <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>;
01148     ULONG StopIndex;
01149 
01150     <a class="code" href="../../d5/d9/ntrtlp_8h.html#a12">RTL_PAGED_CODE</a>();
01151 
01152     <span class="keywordflow">if</span> ( AllocateDestinationString ) {
01153         DestinationString-&gt;MaximumLength = <a class="code" href="../../d0/d2/usrbench_8h.html#a33">SourceString</a>-&gt;Length;
01154         DestinationString-&gt;Buffer = (<a class="code" href="../../d8/d2/ldrinit_8c.html#a7">RtlAllocateStringRoutine</a>)((ULONG)DestinationString-&gt;MaximumLength);
01155         <span class="keywordflow">if</span> ( !DestinationString-&gt;Buffer ) {
01156             <span class="keywordflow">return</span> STATUS_NO_MEMORY;
01157             }
01158         }
01159     <span class="keywordflow">else</span> {
01160         <span class="keywordflow">if</span> ( <a class="code" href="../../d0/d2/usrbench_8h.html#a33">SourceString</a>-&gt;Length &gt; DestinationString-&gt;MaximumLength ) {
01161             <span class="keywordflow">return</span> STATUS_BUFFER_OVERFLOW;
01162             }
01163         }
01164 
01165     StopIndex = ((ULONG)<a class="code" href="../../d0/d2/usrbench_8h.html#a33">SourceString</a>-&gt;Length) / <span class="keyword">sizeof</span>( WCHAR );
01166 
01167     <span class="keywordflow">for</span> (<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> = 0; <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> &lt; StopIndex; <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>++) {
01168         DestinationString-&gt;Buffer[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>] = (WCHAR)<a class="code" href="../../d5/d9/ntrtlp_8h.html#a11">NLS_DOWNCASE</a>(<a class="code" href="../../d0/d2/usrbench_8h.html#a33">SourceString</a>-&gt;Buffer[Index]);
01169     }
01170 
01171     DestinationString-&gt;Length = <a class="code" href="../../d0/d2/usrbench_8h.html#a33">SourceString</a>-&gt;Length;
01172 
01173     <span class="keywordflow">return</span> STATUS_SUCCESS;
01174 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a49" doxytag="nls.c::RtlEqualComputerName" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN RtlEqualComputerName           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PUNICODE_STRING&nbsp;</td>
          <td class="mdname" nowrap> <em>String1</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PUNICODE_STRING&nbsp;</td>
          <td class="mdname" nowrap> <em>String2</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d5/nls_8c-source.html#l02035">2035</a> of file <a class="el" href="../../d7/d5/nls_8c-source.html">nls.c</a>.
<p>
References <a class="el" href="../../d7/d5/nls_8c-source.html#l01959">RtlEqualDomainName()</a>, <a class="el" href="../../d0/d9/tcmpmem_8c-source.html#l00037">String1</a>, and <a class="el" href="../../d0/d9/tcmpmem_8c-source.html#l00038">String2</a>.
<p>
<pre class="fragment"><div>02042                    :
02043 
02044     The <a class="code" href="../../d6/d6/nls_8c.html#a49">RtlEqualComputerName</a> function compares two computer names <span class="keywordflow">for</span> equality.
02045 
02046     The comparison <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> a <span class="keywordflow">case</span> insensitive comparison of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> OEM equivalent
02047     strings.
02048 
02049     The domain name <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> not validated <span class="keywordflow">for</span> length nor invalid characters.
02050 
02051 Arguments:
02052 
02053     <a class="code" href="../../d9/d9/tcmpmem_8c.html#a1">String1</a> - Pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> first string.
02054 
02055     <a class="code" href="../../d9/d9/tcmpmem_8c.html#a2">String2</a> - Pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> second string.
02056 
02057 Return Value:
02058 
02059     <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a21">Boolean</a> value that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> <span class="keywordflow">if</span> <a class="code" href="../../d9/d9/tcmpmem_8c.html#a1">String1</a> equals <a class="code" href="../../d9/d9/tcmpmem_8c.html#a2">String2</a> and <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a> otherwise.
02060 
02061 --*/
02062 
02063 {
02064     <span class="keywordflow">return</span> <a class="code" href="../../d6/d6/nls_8c.html#a48">RtlEqualDomainName</a>( String1, String2 );
02065 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a48" doxytag="nls.c::RtlEqualDomainName" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN RtlEqualDomainName           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PUNICODE_STRING&nbsp;</td>
          <td class="mdname" nowrap> <em>String1</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PUNICODE_STRING&nbsp;</td>
          <td class="mdname" nowrap> <em>String2</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d5/nls_8c-source.html#l01959">1959</a> of file <a class="el" href="../../d7/d5/nls_8c-source.html">nls.c</a>.
<p>
References <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d6/d5/stierr_8h-source.html#l00030">NT_SUCCESS</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d6/d8/ntrtlp_8h-source.html#l00246">RTL_PAGED_CODE</a>, <a class="el" href="../../d3/d6/string_8c-source.html#l00399">RtlEqualString()</a>, <a class="el" href="../../d7/d5/nls_8c-source.html#l01283">RtlFreeOemString()</a>, <a class="el" href="../../d7/d5/nls_8c-source.html#l00617">RtlUpcaseUnicodeStringToOemString()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00135">Status</a>, <a class="el" href="../../d0/d9/tcmpmem_8c-source.html#l00037">String1</a>, <a class="el" href="../../d0/d9/tcmpmem_8c-source.html#l00038">String2</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d7/d5/nls_8c-source.html#l02035">RtlEqualComputerName()</a>.
<p>
<pre class="fragment"><div>01966                    :
01967 
01968     The <a class="code" href="../../d6/d6/nls_8c.html#a48">RtlEqualDomainName</a> function compares two domain names <span class="keywordflow">for</span> equality.
01969 
01970     The comparison <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> a <span class="keywordflow">case</span> insensitive comparison of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> OEM equivalent
01971     strings.
01972 
01973     The domain name <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> not validated <span class="keywordflow">for</span> length nor invalid characters.
01974 
01975 Arguments:
01976 
01977     <a class="code" href="../../d9/d9/tcmpmem_8c.html#a1">String1</a> - Pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> first string.
01978 
01979     <a class="code" href="../../d9/d9/tcmpmem_8c.html#a2">String2</a> - Pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> second string.
01980 
01981 Return Value:
01982 
01983     <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a21">Boolean</a> value that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> <span class="keywordflow">if</span> <a class="code" href="../../d9/d9/tcmpmem_8c.html#a1">String1</a> equals <a class="code" href="../../d9/d9/tcmpmem_8c.html#a2">String2</a> and <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a> otherwise.
01984 
01985 --*/
01986 
01987 {
01988     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
01989     BOOLEAN ReturnValue = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01990     OEM_STRING OemString1;
01991     OEM_STRING OemString2;
01992 
01993     <a class="code" href="../../d5/d9/ntrtlp_8h.html#a12">RTL_PAGED_CODE</a>();
01994 
01995     <span class="comment">//</span>
01996     <span class="comment">// Upper case and convert the first string to OEM</span>
01997     <span class="comment">//</span>
01998 
01999     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d6/d6/nls_8c.html#a27">RtlUpcaseUnicodeStringToOemString</a>( &amp;OemString1,
02000                                                 String1,
02001                                                 TRUE );   <span class="comment">// Allocate Dest</span>
02002 
02003     <span class="keywordflow">if</span> ( <a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>( Status ) ) {
02004 
02005         <span class="comment">//</span>
02006         <span class="comment">// Upper case and convert the second string to OEM</span>
02007         <span class="comment">//</span>
02008 
02009         <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d6/d6/nls_8c.html#a27">RtlUpcaseUnicodeStringToOemString</a>( &amp;OemString2,
02010                                                     String2,
02011                                                     TRUE );   <span class="comment">// Allocate Dest</span>
02012 
02013         <span class="keywordflow">if</span> ( <a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>( Status ) ) {
02014 
02015             <span class="comment">//</span>
02016             <span class="comment">// Do a case insensitive comparison.</span>
02017             <span class="comment">//</span>
02018 
02019             ReturnValue = <a class="code" href="../../d2/d7/string_8c.html#a11">RtlEqualString</a>( &amp;OemString1,
02020                                           &amp;OemString2,
02021                                           FALSE );
02022 
02023             <a class="code" href="../../d6/d6/nls_8c.html#a36">RtlFreeOemString</a>( &amp;OemString2 );
02024         }
02025 
02026         <a class="code" href="../../d6/d6/nls_8c.html#a36">RtlFreeOemString</a>( &amp;OemString1 );
02027     }
02028 
02029     <span class="keywordflow">return</span> ReturnValue;
02030 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a42" doxytag="nls.c::RtlEqualUnicodeString" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN RtlEqualUnicodeString           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PCUNICODE_STRING&nbsp;</td>
          <td class="mdname" nowrap> <em>String1</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PCUNICODE_STRING&nbsp;</td>
          <td class="mdname" nowrap> <em>String2</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>CaseInSensitive</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d5/nls_8c-source.html#l01608">1608</a> of file <a class="el" href="../../d7/d5/nls_8c-source.html">nls.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d6/d8/ntrtlp_8h-source.html#l00219">NLS_UPCASE</a>, <a class="el" href="../../d6/d8/ntrtlp_8h-source.html#l00246">RTL_PAGED_CODE</a>, <a class="el" href="../../d0/d9/tcmpmem_8c-source.html#l00037">String1</a>, <a class="el" href="../../d0/d9/tcmpmem_8c-source.html#l00038">String2</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d8/d4/w32_2ntuser_2kernel_2security_8c-source.html#l00295">_UserTestForWinStaAccess()</a>, <a class="el" href="../../d1/d9/cmboot_8c-source.html#l00837">CmpDoSort()</a>, <a class="el" href="../../d0/d3/rules_8c-source.html#l02430">CmpFindRSDTTable()</a>, <a class="el" href="../../d1/d9/cmboot_8c-source.html#l00920">CmpResolveDriverDependencies()</a>, <a class="el" href="../../d9/d8/cmapi_8c-source.html#l01087">CmSetValueKey()</a>, <a class="el" href="../../d1/d6/dev2dos_8c-source.html#l00454">FindPathForDevice()</a>, <a class="el" href="../../d8/d1/drivesup_8c-source.html#l00934">HalpNextDriveLetter()</a>, <a class="el" href="../../d0/d1/pnpsubs_8c-source.html#l03759">IopDeviceObjectFromDeviceInstance()</a>, <a class="el" href="../../d0/d1/pnpsubs_8c-source.html#l05334">IopGetGroupOrderIndex()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l02286">IopIsReportedAlready()</a>, <a class="el" href="../../d0/d5/ioinit_8c-source.html#l04654">IopLoadBootFilterDriver()</a>, <a class="el" href="../../d0/d5/ioinit_8c-source.html#l03379">IopLookupGroupName()</a>, <a class="el" href="../../d7/d9/pnpenum_8c-source.html#l04000">IopProcessCriticalDeviceRoutine()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l09922">IopProcessSetInterfaceState()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l04414">IopRemoveDeviceInterfaces()</a>, <a class="el" href="../../d0/d1/pnpsubs_8c-source.html#l00449">IopRemoveStringFromValueKey()</a>, <a class="el" href="../../d5/d5/netboot_8c-source.html#l01982">IopSetupRemoteBootCard()</a>, <a class="el" href="../../d5/d1/ldrapi_8c-source.html#l00295">LdrGetDllHandle()</a>, <a class="el" href="../../d3/d2/ldrsnap_8c-source.html#l00832">LdrpCheckForLoadedDll()</a>, <a class="el" href="../../d3/d2/ldrsnap_8c-source.html#l01261">LdrpMapDll()</a>, <a class="el" href="../../d0/d5/verifier_8c-source.html#l03448">MiApplyDriverVerifier()</a>, <a class="el" href="../../d9/d7/sysload_8c-source.html#l03326">MiBuildImportsForBootDrivers()</a>, <a class="el" href="../../d0/d5/verifier_8c-source.html#l03121">MiInitializeDriverVerifierList()</a>, <a class="el" href="../../d9/d7/sysload_8c-source.html#l00443">MiLoadSystemImage()</a>, <a class="el" href="../../d9/d7/sysload_8c-source.html#l03953">MiResolveImageReferences()</a>, <a class="el" href="../../d5/d6/sessload_8c-source.html#l00936">MiSessionWideReserveImageAddress()</a>, <a class="el" href="../../d0/d5/verifier_8c-source.html#l03625">MiVerifyingDriverUnloading()</a>, <a class="el" href="../../d9/d7/sysload_8c-source.html#l06808">MmGetSystemRoutineAddress()</a>, <a class="el" href="../../d5/d1/fekbd_8c-source.html#l01092">NlsKbdInitializePerSystem()</a>, <a class="el" href="../../d9/d9/obdir_8c-source.html#l00705">ObpLookupDirectoryEntry()</a>, <a class="el" href="../../d0/d6/desktop_8c-source.html#l02391">ParseDesktop()</a>, <a class="el" href="../../d8/d3/loadbits_8c-source.html#l00190">ResStrCmp()</a>, <a class="el" href="../../d6/d0/curdir_8c-source.html#l01717">RtlDosPathNameToNtPathName_U()</a>, <a class="el" href="../../d6/d4/prodtype_8c-source.html#l00030">RtlGetNtProductType()</a>, <a class="el" href="../../d6/d0/curdir_8c-source.html#l00577">RtlIsDosDeviceName_Ustr()</a>, <a class="el" href="../../d6/d6/environ_8c-source.html#l00250">RtlQueryEnvironmentVariable_U()</a>, <a class="el" href="../../d1/d6/dev2dos_8c-source.html#l00580">RtlVolumeDeviceToDosName()</a>, and <a class="el" href="../../d8/d7/w32_2ntuser_2server_2harderr_8c-source.html#l00191">SubstituteDeviceName()</a>.
<p>
<pre class="fragment"><div>01616                    :
01617 
01618     The <a class="code" href="../../d7/d6/nlsboot_8c.html#a3">RtlEqualUnicodeString</a> function compares two counted unicode strings <span class="keywordflow">for</span>
01619     equality.
01620 
01621     The CaseInSensitive parameter specifies <span class="keywordflow">if</span> <span class="keywordflow">case</span> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to be ignored when
01622     doing <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> comparison.
01623 
01624 Arguments:
01625 
01626     <a class="code" href="../../d9/d9/tcmpmem_8c.html#a1">String1</a> - Pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> first string.
01627 
01628     <a class="code" href="../../d9/d9/tcmpmem_8c.html#a2">String2</a> - Pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> second string.
01629 
01630     CaseInsensitive - <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> <span class="keywordflow">if</span> <span class="keywordflow">case</span> should be ignored when doing <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
01631         comparison.
01632 
01633 Return Value:
01634 
01635     <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a21">Boolean</a> value that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> <span class="keywordflow">if</span> <a class="code" href="../../d9/d9/tcmpmem_8c.html#a1">String1</a> equals <a class="code" href="../../d9/d9/tcmpmem_8c.html#a2">String2</a> and <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a> otherwise.
01636 
01637 --*/
01638 
01639 {
01640 
01641     PWCHAR s1, s2, Limit;
01642     LONG n1, n2;
01643     WCHAR c1, c2;
01644 
01645     <a class="code" href="../../d5/d9/ntrtlp_8h.html#a12">RTL_PAGED_CODE</a>();
01646 
01647     n1 = <a class="code" href="../../d9/d9/tcmpmem_8c.html#a1">String1</a>-&gt;Length;
01648     n2 = <a class="code" href="../../d9/d9/tcmpmem_8c.html#a2">String2</a>-&gt;Length;
01649 
01650     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>((n1 &amp; 1) == 0);
01651     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>((n2 &amp; 1) == 0);
01652 
01653     <span class="keywordflow">if</span> (n1 == n2) {
01654         s1 = <a class="code" href="../../d9/d9/tcmpmem_8c.html#a1">String1</a>-&gt;Buffer;
01655         s2 = <a class="code" href="../../d9/d9/tcmpmem_8c.html#a2">String2</a>-&gt;Buffer;
01656 
01657         <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(!(((((ULONG_PTR)s1 &amp; 1) != 0) || (((ULONG_PTR)s2 &amp; 1) != 0)) &amp;&amp; (n1 != 0) &amp;&amp; (n2 != 0)));
01658 
01659         Limit = (PWCHAR)((PCHAR)s1 + n1);
01660         <span class="keywordflow">if</span> (CaseInSensitive) {
01661             <span class="keywordflow">while</span> (s1 &lt; Limit) {
01662                 c1 = *s1++;
01663                 c2 = *s2++;
01664                 <span class="keywordflow">if</span> ((c1 != c2) &amp;&amp; (<a class="code" href="../../d5/d9/ntrtlp_8h.html#a10">NLS_UPCASE</a>(c1) != <a class="code" href="../../d5/d9/ntrtlp_8h.html#a10">NLS_UPCASE</a>(c2))) {
01665                     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01666                 }
01667             }
01668 
01669             <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01670 
01671         } <span class="keywordflow">else</span> {
01672             <span class="keywordflow">while</span> (s1 &lt; Limit) {
01673                 c1 = *s1++;
01674                 c2 = *s2++;
01675                 <span class="keywordflow">if</span> (c1 != c2) {
01676                     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01677                 }
01678             }
01679 
01680             <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01681         }
01682 
01683     } <span class="keywordflow">else</span> {
01684         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01685     }
01686 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a35" doxytag="nls.c::RtlFreeAnsiString" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID RtlFreeAnsiString           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN OUT PANSI_STRING&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>AnsiString</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d5/nls_8c-source.html#l01249">1249</a> of file <a class="el" href="../../d7/d5/nls_8c-source.html">nls.c</a>.
<p>
References <a class="el" href="../../d6/d8/ntrtlp_8h-source.html#l00246">RTL_PAGED_CODE</a>, and <a class="el" href="../../d9/d1/ldrinit_8c-source.html#l00137">RtlFreeStringRoutine</a>.
<p>
Referenced by <a class="el" href="../../d8/d7/w32_2ntuser_2server_2harderr_8c-source.html#l00423">GetHardErrorText()</a>, <a class="el" href="../../d4/d4/mapview_8c-source.html#l01567">MiMapViewOfImageSection()</a>, <a class="el" href="../../d6/d4/sectsup_8c-source.html#l00191">MiSegmentDelete()</a>, <a class="el" href="../../d9/d7/sysload_8c-source.html#l06808">MmGetSystemRoutineAddress()</a>, and <a class="el" href="../../d9/d7/sysload_8c-source.html#l02896">MmUnloadSystemImage()</a>.
<p>
<pre class="fragment"><div>01255                    :
01256 
01257     This API <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> used to free storage allocated by
01258     <a class="code" href="../../d6/d6/nls_8c.html#a23">RtlUnicodeStringToAnsiString</a>.  Note that <a class="code" href="../../d3/d0/imm32_8def.html#a1">only</a> AnsiString-&gt;Buffer
01259     <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> free'd by <span class="keyword">this</span> routine.
01260 
01261 Arguments:
01262 
01263     AnsiString - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> address of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> ansi string whose buffer
01264         was previously allocated by <a class="code" href="../../d6/d6/nls_8c.html#a23">RtlUnicodeStringToAnsiString</a>.
01265 
01266 Return Value:
01267 
01268     None.
01269 
01270 --*/
01271 
01272 {
01273     <a class="code" href="../../d5/d9/ntrtlp_8h.html#a12">RTL_PAGED_CODE</a>();
01274 
01275     <span class="keywordflow">if</span> (AnsiString-&gt;Buffer) {
01276         (<a class="code" href="../../d8/d2/ldrinit_8c.html#a8">RtlFreeStringRoutine</a>)(AnsiString-&gt;Buffer);
01277         memset( AnsiString, 0, <span class="keyword">sizeof</span>( *AnsiString ) );
01278         }
01279 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a36" doxytag="nls.c::RtlFreeOemString" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID RtlFreeOemString           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN OUT POEM_STRING&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>OemString</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d5/nls_8c-source.html#l01283">1283</a> of file <a class="el" href="../../d7/d5/nls_8c-source.html">nls.c</a>.
<p>
References <a class="el" href="../../d6/d8/ntrtlp_8h-source.html#l00246">RTL_PAGED_CODE</a>, and <a class="el" href="../../d9/d1/ldrinit_8c-source.html#l00137">RtlFreeStringRoutine</a>.
<p>
Referenced by <a class="el" href="../../d7/d5/nls_8c-source.html#l01959">RtlEqualDomainName()</a>.
<p>
<pre class="fragment"><div>01289                    :
01290 
01291     This API <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> used to free storage allocated by
01292     <a class="code" href="../../d6/d6/nls_8c.html#a26">RtlUnicodeStringToOemString</a>.  Note that <a class="code" href="../../d3/d0/imm32_8def.html#a1">only</a> OemString-&gt;Buffer
01293     <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> free'd by <span class="keyword">this</span> routine.
01294 
01295 Arguments:
01296 
01297     OemString - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> address of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> oem string whose buffer
01298         was previously allocated by <a class="code" href="../../d6/d6/nls_8c.html#a26">RtlUnicodeStringToOemString</a>.
01299 
01300 Return Value:
01301 
01302     None.
01303 
01304 --*/
01305 
01306 {
01307     <a class="code" href="../../d5/d9/ntrtlp_8h.html#a12">RTL_PAGED_CODE</a>();
01308 
01309     <span class="keywordflow">if</span> (OemString-&gt;Buffer) {(<a class="code" href="../../d8/d2/ldrinit_8c.html#a8">RtlFreeStringRoutine</a>)(OemString-&gt;Buffer);}
01310 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a34" doxytag="nls.c::RtlFreeUnicodeString" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID RtlFreeUnicodeString           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN OUT PUNICODE_STRING&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>UnicodeString</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d5/nls_8c-source.html#l01215">1215</a> of file <a class="el" href="../../d7/d5/nls_8c-source.html">nls.c</a>.
<p>
References <a class="el" href="../../d6/d8/ntrtlp_8h-source.html#l00246">RTL_PAGED_CODE</a>, and <a class="el" href="../../d9/d1/ldrinit_8c-source.html#l00137">RtlFreeStringRoutine</a>.
<p>
Referenced by <a class="el" href="../../d9/d9/geninst_8c-source.html#l01392">CmpAppendStringToMultiSz()</a>, <a class="el" href="../../d7/d1/hwprofil_8c-source.html#l01869">CmpCloneHwProfile()</a>, <a class="el" href="../../d7/d1/hwprofil_8c-source.html#l02529">CmpCreateHwProfileFriendlyName()</a>, <a class="el" href="../../d5/d0/config_2alpha_2init_8c-source.html#l00037">CmpInitializeMachineDependentConfiguration()</a>, <a class="el" href="../../d5/d9/cmconfig_8c-source.html#l00458">CmpInitializeRegistryNode()</a>, <a class="el" href="../../d9/d9/geninst_8c-source.html#l01264">CmpOpenRegKey()</a>, <a class="el" href="../../d9/d9/geninst_8c-source.html#l00311">CmpProcessAddRegLine()</a>, <a class="el" href="../../d9/d9/geninst_8c-source.html#l00776">CmpProcessBitRegLine()</a>, <a class="el" href="../../d9/d9/geninst_8c-source.html#l00658">CmpProcessDelRegLine()</a>, <a class="el" href="../../d4/d7/client_8c-source.html#l02455">CreateDesktopA()</a>, <a class="el" href="../../d4/d7/client_8c-source.html#l02291">CreateWindowStationA()</a>, <a class="el" href="../../d2/d9/csrinit_8c-source.html#l00106">CsrClientConnectToServer()</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l01165">CtLnpQos()</a>, <a class="el" href="../../d8/d2/dbgkproc_8c-source.html#l00211">DbgkCreateThread()</a>, <a class="el" href="../../d8/d2/dbgkproc_8c-source.html#l00136">DbgkpSectionHandleToFileHandle()</a>, <a class="el" href="../../d8/d7/w32_2ntuser_2server_2harderr_8c-source.html#l00291">FreePhi()</a>, <a class="el" href="../../d5/d4/name_8c-source.html#l00288">FsRtlAreNamesEqual()</a>, <a class="el" href="../../d5/d4/name_8c-source.html#l00415">FsRtlIsNameInExpression()</a>, <a class="el" href="../../d3/d4/editreg_8c-source.html#l00453">FtCreateKey()</a>, <a class="el" href="../../d3/d4/editreg_8c-source.html#l00557">FtDeleteValue()</a>, <a class="el" href="../../d3/d4/editreg_8c-source.html#l00357">FtOpenKey()</a>, <a class="el" href="../../d3/d4/editreg_8c-source.html#l01534">FtReturnValue()</a>, <a class="el" href="../../d3/d4/editreg_8c-source.html#l00602">FtSetValue()</a>, <a class="el" href="../../d8/d7/w32_2ntuser_2server_2harderr_8c-source.html#l00423">GetHardErrorText()</a>, <a class="el" href="../../d8/d1/drivesup_8c-source.html#l00934">HalpNextDriveLetter()</a>, <a class="el" href="../../d7/d8/restrfil_8c-source.html#l00879">InitializeRestrictedStuff()</a>, <a class="el" href="../../d2/d6/w32_2ntuser_2kernel_2profile_8c-source.html#l00103">InitPreviousUserString()</a>, <a class="el" href="../../d8/d4/ioerr_8c-source.html#l00414">IoepFreeErrStack()</a>, <a class="el" href="../../d8/d4/ioerr_8c-source.html#l00680">IoepHandleErrCase()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l11641">IoGetBootDiskInformation()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l04946">IoGetDeviceInterfaceAlias()</a>, <a class="el" href="../../d5/d5/netboot_8c-source.html#l00314">IopAddRemoteBootValuesToRegistry()</a>, <a class="el" href="../../d6/d8/arcsec_8c-source.html#l00168">IopApplySystemPartitionProt()</a>, <a class="el" href="../../d5/d5/netboot_8c-source.html#l01546">IopAssignNetworkDriveLetter()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l09046">IopBootLog()</a>, <a class="el" href="../../d7/d9/pnpenum_8c-source.html#l03165">IopCallDriverAddDeviceQueryRoutine()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l09157">IopCopyBootLogRegistryToFile()</a>, <a class="el" href="../../d0/d5/ioinit_8c-source.html#l01047">IopCreateArcNames()</a>, <a class="el" href="../../d0/d1/pnpsubs_8c-source.html#l00091">IopCreateMadeupNode()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l02707">IopGetDeviceInterfaces()</a>, <a class="el" href="../../d3/d2/dumpctl_8c-source.html#l00384">IopGetDumpStack()</a>, <a class="el" href="../../d0/d5/ioinit_8c-source.html#l03146">IopInitializeSystemDrivers()</a>, <a class="el" href="../../d1/d0/pnpirp_8c-source.html#l01891">IopMakeGloballyUniqueId()</a>, <a class="el" href="../../d0/d5/ioinit_8c-source.html#l03479">IopMarkBootPartition()</a>, <a class="el" href="../../d0/d1/pnpsubs_8c-source.html#l01712">IopOpenCurrentHwProfileDeviceInstanceKey()</a>, <a class="el" href="../../d0/d1/pnpsubs_8c-source.html#l00753">IopPrepareDriverLoading()</a>, <a class="el" href="../../d7/d9/pnpenum_8c-source.html#l04000">IopProcessCriticalDeviceRoutine()</a>, <a class="el" href="../../d0/d5/ioinit_8c-source.html#l03612">IopReassignSystemRoot()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l03929">IopRegisterDeviceInterface()</a>, <a class="el" href="../../d6/d0/pnpres_8c-source.html#l06660">IopSetLegacyDeviceInstance()</a>, <a class="el" href="../../d5/d5/netboot_8c-source.html#l00770">IopStartNetworkForRemoteBoot()</a>, <a class="el" href="../../d9/d1/ldrinit_8c-source.html#l00616">LdrpInitializeProcess()</a>, <a class="el" href="../../d3/d2/ldrsnap_8c-source.html#l01261">LdrpMapDll()</a>, <a class="el" href="../../d3/d2/ldrsnap_8c-source.html#l03120">LdrpResolveDllName()</a>, <a class="el" href="../../d3/d2/ldrsnap_8c-source.html#l02476">LdrpSnapThunk()</a>, <a class="el" href="../../d5/d1/ldrapi_8c-source.html#l00528">LdrUnloadDll()</a>, <a class="el" href="../../d3/d4/editreg_8c-source.html#l02460">main()</a>, <a class="el" href="../../d6/d5/memprint_8c-source.html#l00598">MemPrintWriteThread()</a>, <a class="el" href="../../d9/d7/sysload_8c-source.html#l00443">MiLoadSystemImage()</a>, <a class="el" href="../../d9/d7/sysload_8c-source.html#l02740">MiRememberUnloadedDriver()</a>, <a class="el" href="../../d9/d7/sysload_8c-source.html#l03953">MiResolveImageReferences()</a>, <a class="el" href="../../d9/d7/sysload_8c-source.html#l04464">MiSnapThunk()</a>, <a class="el" href="../../d4/d7/client_8c-source.html#l02575">OpenDesktopA()</a>, <a class="el" href="../../d4/d7/client_8c-source.html#l02382">OpenWindowStationA()</a>, <a class="el" href="../../d5/d6/rtl_2regutil_8c-source.html#l01453">RtlFormatCurrentUserKeyPath()</a>, <a class="el" href="../../d5/d6/rtl_2regutil_8c-source.html#l01564">RtlOpenCurrentUser()</a>, <a class="el" href="../../d5/d6/rtl_2regutil_8c-source.html#l00092">RtlpGetRegistryHandle()</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l01582">SepClientOpenPipe()</a>, <a class="el" href="../../d0/d5/seinit_8c-source.html#l00184">SepInitializationPhase1()</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l01377">SepServerCreatePipe()</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l01093">SepServerSpawnClientProcess()</a>, <a class="el" href="../../d1/d9/rmmain_8c-source.html#l00060">SeRmInitPhase1()</a>, <a class="el" href="../../d3/d9/tenv_8c-source.html#l00046">SetEnvironment()</a>, and <a class="el" href="../../d8/d1/drivesup_8c-source.html#l01243">xHalIoAssignDriveLetters()</a>.
<p>
<pre class="fragment"><div>01221                    :
01222 
01223     This API <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> used to free storage allocated by
01224     <a class="code" href="../../d7/d6/nlsboot_8c.html#a1">RtlAnsiStringToUnicodeString</a>.  Note that <a class="code" href="../../d3/d0/imm32_8def.html#a1">only</a> UnicodeString-&gt;Buffer
01225     <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> free'd by <span class="keyword">this</span> routine.
01226 
01227 Arguments:
01228 
01229     UnicodeString - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> address of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> unicode string whose
01230         buffer was previously allocated by <a class="code" href="../../d7/d6/nlsboot_8c.html#a1">RtlAnsiStringToUnicodeString</a>.
01231 
01232 Return Value:
01233 
01234     None.
01235 
01236 --*/
01237 
01238 {
01239     <a class="code" href="../../d5/d9/ntrtlp_8h.html#a12">RTL_PAGED_CODE</a>();
01240 
01241     <span class="keywordflow">if</span> (UnicodeString-&gt;Buffer) {
01242         (<a class="code" href="../../d8/d2/ldrinit_8c.html#a8">RtlFreeStringRoutine</a>)(UnicodeString-&gt;Buffer);
01243         memset( UnicodeString, 0, <span class="keyword">sizeof</span>( *UnicodeString ) );
01244         }
01245 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a50" doxytag="nls.c::RtlIsTextUnicode" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN RtlIsTextUnicode           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>Buffer</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Size</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN OUT PULONG Result&nbsp;</td>
          <td class="mdname" nowrap> <em>OPTIONAL</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d5/nls_8c-source.html#l02098">2098</a> of file <a class="el" href="../../d7/d5/nls_8c-source.html">nls.c</a>.
<p>
References <a class="el" href="../../d7/d5/nls_8c-source.html#l02093">__max</a>, <a class="el" href="../../d7/d5/nls_8c-source.html#l02094">__min</a>, <a class="el" href="../../d7/d5/nls_8c-source.html#l02091">ASCII_CRLF</a>, <a class="el" href="../../d7/d1/rtqkey_8c-source.html#l00042">Buffer</a>, <a class="el" href="../../d7/d5/nls_8c-source.html#l02074">BYTE_ORDER_MARK</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d6/d8/ntrtlp_8h-source.html#l00184">HIBYTE</a>, <a class="el" href="../../d7/d5/nls_8c-source.html#l02077">LINE_SEPARATOR</a>, <a class="el" href="../../d6/d8/ntrtlp_8h-source.html#l00183">LOBYTE</a>, <a class="el" href="../../d7/d5/nls_8c-source.html#l00069">NlsLeadByteInfo</a>, <a class="el" href="../../d0/d6/nlsxlat_8c-source.html#l00086">NlsMbCodePageTag</a>, <a class="el" href="../../d7/d5/nls_8c-source.html#l02076">PARAGRAPH_SEPARATOR</a>, <a class="el" href="../../d7/d5/nls_8c-source.html#l02073">REVERSE_BYTE_ORDER_MARK</a>, <a class="el" href="../../d9/d6/lh__open_2pi__mem_8h-source.html#l00017">Size</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d0/d5/verifier_8c-source.html#l03112">UNICODE_CJK_SPACE</a>, <a class="el" href="../../d0/d5/verifier_8c-source.html#l03110">UNICODE_CR</a>, <a class="el" href="../../d7/d5/nls_8c-source.html#l02072">UNICODE_FFFF</a>, <a class="el" href="../../d0/d5/verifier_8c-source.html#l03109">UNICODE_LF</a>, <a class="el" href="../../d7/d5/nls_8c-source.html#l02087">UNICODE_R_CR</a>, <a class="el" href="../../d7/d5/nls_8c-source.html#l02086">UNICODE_R_LF</a>, <a class="el" href="../../d7/d5/nls_8c-source.html#l02088">UNICODE_R_SPACE</a>, <a class="el" href="../../d7/d5/nls_8c-source.html#l02085">UNICODE_R_TAB</a>, <a class="el" href="../../d0/d5/verifier_8c-source.html#l03111">UNICODE_SPACE</a>, and <a class="el" href="../../d0/d5/verifier_8c-source.html#l03108">UNICODE_TAB</a>.
<p>
Referenced by <a class="el" href="../../d9/d3/w32_2ntuser_2client_2callback_8c-source.html#l00129">_ClientEventCallback()</a>, and <a class="el" href="../../d5/d3/client_2ddetrack_8c-source.html#l00208">FixupDdeExecuteIfNecessary()</a>.
<p>
<pre class="fragment"><div>02106                    :
02107 
02108     IsTextUnicode performs a series of inexpensive heuristic checks
02109     on a buffer in order to verify that <a class="code" href="../../d1/d9/icmui_8def.html#a4">it</a> contains <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a96">Unicode</a> data.
02110 
02111 
02112     [[ need to fix <span class="keyword">this</span> section, see at <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> end ]]
02113 
02114     Found            Return Result
02115 
02116     BOM              <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>   BOM
02117     RBOM             <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>  RBOM
02118     FFFF             <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>  Binary
02119     <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>             <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>  Binary
02120     null             <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>   null bytes
02121     <a class="code" href="../../d6/d6/nls_8c.html#a16">ASCII_CRLF</a>       <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>  CRLF
02122     <a class="code" href="../../d9/d5/verifier_8c.html#a3">UNICODE_TAB</a> etc. <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>   <a class="code" href="../../d6/d6/ttime_8c.html#a0">Zero</a> Ext Controls
02123     UNICODE_TAB_R    <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>  Reversed Controls
02124     UNICODE_ZW  etc. <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>   <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a96">Unicode</a> specials
02125 
02126     1/3 as little variation in hi-byte as in lo byte: <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>   Correl
02127     3/1 or worse   <span class="stringliteral">"                                  FALSE  AntiCorrel</span>
02128 <span class="stringliteral"></span>
02129 <span class="stringliteral">Arguments:</span>
02130 <span class="stringliteral"></span>
02131 <span class="stringliteral">    Buffer - pointer to buffer containing text to examine.</span>
02132 <span class="stringliteral"></span>
02133 <span class="stringliteral">    Size - size of buffer in bytes.  At most 256 characters in this will</span>
02134 <span class="stringliteral">           be examined.  If the size is less than the size of a unicode</span>
02135 <span class="stringliteral">           character, then this function returns FALSE.</span>
02136 <span class="stringliteral"></span>
02137 <span class="stringliteral">    Result - optional pointer to a flag word that contains additional information</span>
02138 <span class="stringliteral">             about the reason for the return value.  If specified, this value on</span>
02139 <span class="stringliteral">             input is a mask that is used to limit the factors this routine uses</span>
02140 <span class="stringliteral">             to make it decision.  On output, this flag word is set to contain</span>
02141 <span class="stringliteral">             those flags that were used to make its decision.</span>
02142 <span class="stringliteral"></span>
02143 <span class="stringliteral">Return Value:</span>
02144 <span class="stringliteral"></span>
02145 <span class="stringliteral">    Boolean value that is TRUE if Buffer contains unicode characters.</span>
02146 <span class="stringliteral"></span>
02147 <span class="stringliteral">--*/</span>
02148 <span class="stringliteral">{</span>
02149 <span class="stringliteral">    UNALIGNED WCHAR *lpBuff = Buffer;</span>
02150 <span class="stringliteral">    PCHAR lpb = Buffer;</span>
02151 <span class="stringliteral">    ULONG iBOM = 0;</span>
02152 <span class="stringliteral">    ULONG iCR = 0;</span>
02153 <span class="stringliteral">    ULONG iLF = 0;</span>
02154 <span class="stringliteral">    ULONG iTAB = 0;</span>
02155 <span class="stringliteral">    ULONG iSPACE = 0;</span>
02156 <span class="stringliteral">    ULONG iCJK_SPACE = 0;</span>
02157 <span class="stringliteral">    ULONG iFFFF = 0;</span>
02158 <span class="stringliteral">    ULONG iPS = 0;</span>
02159 <span class="stringliteral">    ULONG iLS = 0;</span>
02160 <span class="stringliteral"></span>
02161 <span class="stringliteral">    ULONG iRBOM = 0;</span>
02162 <span class="stringliteral">    ULONG iR_CR = 0;</span>
02163 <span class="stringliteral">    ULONG iR_LF = 0;</span>
02164 <span class="stringliteral">    ULONG iR_TAB = 0;</span>
02165 <span class="stringliteral">    ULONG iR_SPACE = 0;</span>
02166 <span class="stringliteral"></span>
02167 <span class="stringliteral">    ULONG iNull = 0;</span>
02168 <span class="stringliteral">    ULONG iUNULL = 0;</span>
02169 <span class="stringliteral">    ULONG iCRLF = 0;</span>
02170 <span class="stringliteral">    ULONG iTmp;</span>
02171 <span class="stringliteral">    ULONG LastLo = 0;</span>
02172 <span class="stringliteral">    ULONG LastHi = 0;</span>
02173 <span class="stringliteral">    ULONG iHi, iLo;</span>
02174 <span class="stringliteral">    ULONG HiDiff = 0;</span>
02175 <span class="stringliteral">    ULONG LoDiff = 0;</span>
02176 <span class="stringliteral">    ULONG cLeadByte = 0;</span>
02177 <span class="stringliteral">    ULONG cWeird = 0;</span>
02178 <span class="stringliteral"></span>
02179 <span class="stringliteral">    ULONG iResult = 0;</span>
02180 <span class="stringliteral"></span>
02181 <span class="stringliteral">    ULONG iMaxTmp = __min(256, Size / sizeof(WCHAR));</span>
02182 <span class="stringliteral"></span>
02183 <span class="stringliteral">    //</span>
02184 <span class="stringliteral">    //  Special case when the size is less than or equal to 2.</span>
02185 <span class="stringliteral">    //  Make sure we don't have a character followed by a null byte.</span>
02186 <span class="stringliteral">    //</span>
02187 <span class="stringliteral">    if ((Size &lt; 2) ||</span>
02188 <span class="stringliteral">        ((Size == 2) &amp;&amp; (lpBuff[0] != 0) &amp;&amp; (lpb[1] == 0)))</span>
02189 <span class="stringliteral">    {</span>
02190 <span class="stringliteral">        if (ARGUMENT_PRESENT(Result))</span>
02191 <span class="stringliteral">        {</span>
02192 <span class="stringliteral">            *Result = IS_TEXT_UNICODE_ASCII16 | IS_TEXT_UNICODE_CONTROLS;</span>
02193 <span class="stringliteral">        }</span>
02194 <span class="stringliteral"></span>
02195 <span class="stringliteral">        return (FALSE);</span>
02196 <span class="stringliteral">    }</span>
02197 <span class="stringliteral">    else if ((Size &gt; 2) &amp;&amp; ((Size / sizeof(WCHAR)) &lt;= 256))</span>
02198 <span class="stringliteral">    {</span>
02199 <span class="stringliteral">        //</span>
02200 <span class="stringliteral">        //  If the Size passed in is an even number, we don't want to</span>
02201 <span class="stringliteral">        //  use the last WCHAR because it will contain the final null</span>
02202 <span class="stringliteral">        //  byte.</span>
02203 <span class="stringliteral">        //</span>
02204 <span class="stringliteral">        if (((Size % sizeof(WCHAR)) == 0) &amp;&amp;</span>
02205 <span class="stringliteral">            ((lpBuff[iMaxTmp - 1] &amp; 0xff00) == 0))</span>
02206 <span class="stringliteral">        {</span>
02207 <span class="stringliteral">            iMaxTmp--;</span>
02208 <span class="stringliteral">        }</span>
02209 <span class="stringliteral">    }</span>
02210 <span class="stringliteral"></span>
02211 <span class="stringliteral">    //</span>
02212 <span class="stringliteral">    //  Check at most 256 wide characters, collect various statistics.</span>
02213 <span class="stringliteral">    //</span>
02214 <span class="stringliteral">    for (iTmp = 0; iTmp &lt; iMaxTmp; iTmp++)</span>
02215 <span class="stringliteral">    {</span>
02216 <span class="stringliteral">        switch (lpBuff[iTmp])</span>
02217 <span class="stringliteral">        {</span>
02218 <span class="stringliteral">            case BYTE_ORDER_MARK:</span>
02219 <span class="stringliteral">                iBOM++;</span>
02220 <span class="stringliteral">                break;</span>
02221 <span class="stringliteral">            case PARAGRAPH_SEPARATOR:</span>
02222 <span class="stringliteral">                iPS++;</span>
02223 <span class="stringliteral">                break;</span>
02224 <span class="stringliteral">            case LINE_SEPARATOR:</span>
02225 <span class="stringliteral">                iLS++;</span>
02226 <span class="stringliteral">                break;</span>
02227 <span class="stringliteral">            case UNICODE_LF:</span>
02228 <span class="stringliteral">                iLF++;</span>
02229 <span class="stringliteral">                break;</span>
02230 <span class="stringliteral">            case UNICODE_TAB:</span>
02231 <span class="stringliteral">                iTAB++;</span>
02232 <span class="stringliteral">                break;</span>
02233 <span class="stringliteral">            case UNICODE_SPACE:</span>
02234 <span class="stringliteral">                iSPACE++;</span>
02235 <span class="stringliteral">                break;</span>
02236 <span class="stringliteral">            case UNICODE_CJK_SPACE:</span>
02237 <span class="stringliteral">                iCJK_SPACE++;</span>
02238 <span class="stringliteral">                break;</span>
02239 <span class="stringliteral">            case UNICODE_CR:</span>
02240 <span class="stringliteral">                iCR++;</span>
02241 <span class="stringliteral">                break;</span>
02242 <span class="stringliteral"></span>
02243 <span class="stringliteral">            //</span>
02244 <span class="stringliteral">            //  The following codes are expected to show up in</span>
02245 <span class="stringliteral">            //  byte reversed files.</span>
02246 <span class="stringliteral">            //</span>
02247 <span class="stringliteral">            case REVERSE_BYTE_ORDER_MARK:</span>
02248 <span class="stringliteral">                iRBOM++;</span>
02249 <span class="stringliteral">                break;</span>
02250 <span class="stringliteral">            case UNICODE_R_LF:</span>
02251 <span class="stringliteral">                iR_LF++;</span>
02252 <span class="stringliteral">                break;</span>
02253 <span class="stringliteral">            case UNICODE_R_TAB:</span>
02254 <span class="stringliteral">                iR_TAB++;</span>
02255 <span class="stringliteral">                break;</span>
02256 <span class="stringliteral">            case UNICODE_R_CR:</span>
02257 <span class="stringliteral">                iR_CR++;</span>
02258 <span class="stringliteral">                break;</span>
02259 <span class="stringliteral">            case UNICODE_R_SPACE:</span>
02260 <span class="stringliteral">                iR_SPACE++;</span>
02261 <span class="stringliteral">                break;</span>
02262 <span class="stringliteral"></span>
02263 <span class="stringliteral">            //</span>
02264 <span class="stringliteral">            //  The following codes are illegal and should never occur.</span>
02265 <span class="stringliteral">            //</span>
02266 <span class="stringliteral">            case UNICODE_FFFF:</span>
02267 <span class="stringliteral">                iFFFF++;</span>
02268 <span class="stringliteral">                break;</span>
02269 <span class="stringliteral">            case UNICODE_NULL:</span>
02270 <span class="stringliteral">                iUNULL++;</span>
02271 <span class="stringliteral">                break;</span>
02272 <span class="stringliteral"></span>
02273 <span class="stringliteral">            //</span>
02274 <span class="stringliteral">            //  The following is not currently a Unicode character</span>
02275 <span class="stringliteral">            //  but is expected to show up accidentally when reading</span>
02276 <span class="stringliteral">            //  in ASCII files which use CRLF on a little endian machine.</span>
02277 <span class="stringliteral">            //</span>
02278 <span class="stringliteral">            case ASCII_CRLF:</span>
02279 <span class="stringliteral">                iCRLF++;</span>
02280 <span class="stringliteral">                break;       /* little endian */</span>
02281 <span class="stringliteral">        }</span>
02282 <span class="stringliteral"></span>
02283 <span class="stringliteral">        //</span>
02284 <span class="stringliteral">        //  Collect statistics on the fluctuations of high bytes</span>
02285 <span class="stringliteral">        //  versus low bytes.</span>
02286 <span class="stringliteral">        //</span>
02287 <span class="stringliteral">        iHi = HIBYTE(lpBuff[iTmp]);</span>
02288 <span class="stringliteral">        iLo = LOBYTE(lpBuff[iTmp]);</span>
02289 <span class="stringliteral"></span>
02290 <span class="stringliteral">        //</span>
02291 <span class="stringliteral">        //  Count cr/lf and lf/cr that cross two words.</span>
02292 <span class="stringliteral">        //</span>
02293 <span class="stringliteral">        if ((iLo == '\r' &amp;&amp; LastHi == '\n') ||</span>
02294 <span class="stringliteral">            (iLo == '\n' &amp;&amp; LastHi == '\r'))</span>
02295 <span class="stringliteral">        {</span>
02296 <span class="stringliteral">            cWeird++;</span>
02297 <span class="stringliteral">        }</span>
02298 <span class="stringliteral"></span>
02299 <span class="stringliteral">        iNull += (iHi ? 0 : 1) + (iLo ? 0 : 1);   /* count Null bytes */</span>
02300 <span class="stringliteral"></span>
02301 <span class="stringliteral">        HiDiff += __max(iHi, LastHi) - __min(LastHi, iHi);</span>
02302 <span class="stringliteral">        LoDiff += __max(iLo, LastLo) - __min(LastLo, iLo);</span>
02303 <span class="stringliteral"></span>
02304 <span class="stringliteral">        LastLo = iLo;</span>
02305 <span class="stringliteral">        LastHi = iHi;</span>
02306 <span class="stringliteral">    }</span>
02307 <span class="stringliteral"></span>
02308 <span class="stringliteral">    //</span>
02309 <span class="stringliteral">    //  Count cr/lf and lf/cr that cross two words.</span>
02310 <span class="stringliteral">    //</span>
02311 <span class="stringliteral">    if ((iLo == '\r' &amp;&amp; LastHi == '\n') ||</span>
02312 <span class="stringliteral">        (iLo == '\n' &amp;&amp; LastHi == '\r'))</span>
02313 <span class="stringliteral">    {</span>
02314 <span class="stringliteral">        cWeird++;</span>
02315 <span class="stringliteral">    }</span>
02316 <span class="stringliteral"></span>
02317 <span class="stringliteral">    if (iHi == '\0')     /* don't count the last null */</span>
02318 <span class="stringliteral">        iNull--;</span>
02319 <span class="stringliteral">    if (iHi == 26)       /* count ^Z at end as weird */</span>
02320 <span class="stringliteral">        cWeird++;</span>
02321 <span class="stringliteral"></span>
02322 <span class="stringliteral">    iMaxTmp = __min(256 * sizeof(WCHAR), Size);</span>
02323 <span class="stringliteral">    if (NlsMbCodePageTag)</span>
02324 <span class="stringliteral">    {</span>
02325 <span class="stringliteral">        for (iTmp = 0; iTmp &lt; iMaxTmp; iTmp++)</span>
02326 <span class="stringliteral">        {</span>
02327 <span class="stringliteral">            if (NlsLeadByteInfo[lpb[iTmp]])</span>
02328 <span class="stringliteral">            {</span>
02329 <span class="stringliteral">                cLeadByte++;</span>
02330 <span class="stringliteral">                iTmp++;         /* should check for trailing-byte range */</span>
02331 <span class="stringliteral">            }</span>
02332 <span class="stringliteral">        }</span>
02333 <span class="stringliteral">    }</span>
02334 <span class="stringliteral"></span>
02335 <span class="stringliteral">    //</span>
02336 <span class="stringliteral">    //  Sift through the statistical evidence.</span>
02337 <span class="stringliteral">    //</span>
02338 <span class="stringliteral">    if (LoDiff &lt; 127 &amp;&amp; HiDiff == 0)</span>
02339 <span class="stringliteral">    {</span>
02340 <span class="stringliteral">        iResult |= IS_TEXT_UNICODE_ASCII16;         /* likely 16-bit ASCII */</span>
02341 <span class="stringliteral">    }</span>
02342 <span class="stringliteral"></span>
02343 <span class="stringliteral">    if (HiDiff &amp;&amp; LoDiff == 0)</span>
02344 <span class="stringliteral">    {</span>
02345 <span class="stringliteral">        iResult |= IS_TEXT_UNICODE_REVERSE_ASCII16; /* reverse 16-bit ASCII */</span>
02346 <span class="stringliteral">    }</span>
02347 <span class="stringliteral"></span>
02348 <span class="stringliteral">    //</span>
02349 <span class="stringliteral">    //  Use leadbyte info to weight statistics.</span>
02350 <span class="stringliteral">    //</span>
02351 <span class="stringliteral">    if (!NlsMbCodePageTag || cLeadByte == 0 ||</span>
02352 <span class="stringliteral">        !ARGUMENT_PRESENT(Result) || !(*Result &amp; IS_TEXT_UNICODE_DBCS_LEADBYTE))</span>
02353 <span class="stringliteral">    {</span>
02354 <span class="stringliteral">        iHi = 3;</span>
02355 <span class="stringliteral">    }</span>
02356 <span class="stringliteral">    else</span>
02357 <span class="stringliteral">    {</span>
02358 <span class="stringliteral">        //</span>
02359 <span class="stringliteral">        //  A ratio of cLeadByte:cb of 1:2 ==&gt; dbcs</span>
02360 <span class="stringliteral">        //  Very crude - should have a nice eq.</span>
02361 <span class="stringliteral">        //</span>
02362 <span class="stringliteral">        iHi = __min(256, Size / sizeof(WCHAR)) / 2;</span>
02363 <span class="stringliteral">        if (cLeadByte &lt; (iHi - 1) / 3)</span>
02364 <span class="stringliteral">        {</span>
02365 <span class="stringliteral">            iHi = 3;</span>
02366 <span class="stringliteral">        }</span>
02367 <span class="stringliteral">        else if (cLeadByte &lt; (2 * (iHi - 1)) / 3)</span>
02368 <span class="stringliteral">        {</span>
02369 <span class="stringliteral">            iHi = 2;</span>
02370 <span class="stringliteral">        }</span>
02371 <span class="stringliteral">        else</span>
02372 <span class="stringliteral">        {</span>
02373 <span class="stringliteral">            iHi = 1;</span>
02374 <span class="stringliteral">        }</span>
02375 <span class="stringliteral">        iResult |= IS_TEXT_UNICODE_DBCS_LEADBYTE;</span>
02376 <span class="stringliteral">    }</span>
02377 <span class="stringliteral"></span>
02378 <span class="stringliteral">    if (iHi * HiDiff &lt; LoDiff)</span>
02379 <span class="stringliteral">    {</span>
02380 <span class="stringliteral">        iResult |= IS_TEXT_UNICODE_STATISTICS;</span>
02381 <span class="stringliteral">    }</span>
02382 <span class="stringliteral"></span>
02383 <span class="stringliteral">    if (iHi * LoDiff &lt; HiDiff)</span>
02384 <span class="stringliteral">    {</span>
02385 <span class="stringliteral">        iResult |= IS_TEXT_UNICODE_REVERSE_STATISTICS;</span>
02386 <span class="stringliteral">    }</span>
02387 <span class="stringliteral"></span>
02388 <span class="stringliteral">    //</span>
02389 <span class="stringliteral">    //  Any control codes widened to 16 bits? Any Unicode character</span>
02390 <span class="stringliteral">    //  which contain one byte in the control code range?</span>
02391 <span class="stringliteral">    //</span>
02392 <span class="stringliteral">    if (iCR + iLF + iTAB + iSPACE + iCJK_SPACE /*+iPS+iLS*/)</span>
02393 <span class="stringliteral">    {</span>
02394 <span class="stringliteral">        iResult |= IS_TEXT_UNICODE_CONTROLS;</span>
02395 <span class="stringliteral">    }</span>
02396 <span class="stringliteral"></span>
02397 <span class="stringliteral">    if (iR_LF + iR_CR + iR_TAB + iR_SPACE)</span>
02398 <span class="stringliteral">    {</span>
02399 <span class="stringliteral">        iResult |= IS_TEXT_UNICODE_REVERSE_CONTROLS;</span>
02400 <span class="stringliteral">    }</span>
02401 <span class="stringliteral"></span>
02402 <span class="stringliteral">    //</span>
02403 <span class="stringliteral">    //  Any characters that are illegal for Unicode?</span>
02404 <span class="stringliteral">    //</span>
02405 <span class="stringliteral">    if ((iRBOM + iFFFF + iUNULL + iCRLF) != 0 ||</span>
02406 <span class="stringliteral">         (cWeird != 0 &amp;&amp; cWeird &gt;= iMaxTmp/40))</span>
02407 <span class="stringliteral">    {</span>
02408 <span class="stringliteral">        iResult |= IS_TEXT_UNICODE_ILLEGAL_CHARS;</span>
02409 <span class="stringliteral">    }</span>
02410 <span class="stringliteral"></span>
02411 <span class="stringliteral">    //</span>
02412 <span class="stringliteral">    //  Odd buffer length cannot be Unicode.</span>
02413 <span class="stringliteral">    //</span>
02414 <span class="stringliteral">    if (Size &amp; 1)</span>
02415 <span class="stringliteral">    {</span>
02416 <span class="stringliteral">        iResult |= IS_TEXT_UNICODE_ODD_LENGTH;</span>
02417 <span class="stringliteral">    }</span>
02418 <span class="stringliteral"></span>
02419 <span class="stringliteral">    //</span>
02420 <span class="stringliteral">    //  Any NULL bytes? (Illegal in ANSI)</span>
02421 <span class="stringliteral">    //</span>
02422 <span class="stringliteral">    if (iNull)</span>
02423 <span class="stringliteral">    {</span>
02424 <span class="stringliteral">        iResult |= IS_TEXT_UNICODE_NULL_BYTES;</span>
02425 <span class="stringliteral">    }</span>
02426 <span class="stringliteral"></span>
02427 <span class="stringliteral">    //</span>
02428 <span class="stringliteral">    //  POSITIVE evidence, BOM or RBOM used as signature.</span>
02429 <span class="stringliteral">    //</span>
02430 <span class="stringliteral">    if (*lpBuff == BYTE_ORDER_MARK)</span>
02431 <span class="stringliteral">    {</span>
02432 <span class="stringliteral">        iResult |= IS_TEXT_UNICODE_SIGNATURE;</span>
02433 <span class="stringliteral">    }</span>
02434 <span class="stringliteral">    else if (*lpBuff == REVERSE_BYTE_ORDER_MARK)</span>
02435 <span class="stringliteral">    {</span>
02436 <span class="stringliteral">        iResult |= IS_TEXT_UNICODE_REVERSE_SIGNATURE;</span>
02437 <span class="stringliteral">    }</span>
02438 <span class="stringliteral"></span>
02439 <span class="stringliteral">    //</span>
02440 <span class="stringliteral">    //  Limit to desired categories if requested.</span>
02441 <span class="stringliteral">    //</span>
02442 <span class="stringliteral">    if (ARGUMENT_PRESENT(Result))</span>
02443 <span class="stringliteral">    {</span>
02444 <span class="stringliteral">        iResult &amp;= *Result;</span>
02445 <span class="stringliteral">        *Result = iResult;</span>
02446 <span class="stringliteral">    }</span>
02447 <span class="stringliteral"></span>
02448 <span class="stringliteral">    //</span>
02449 <span class="stringliteral">    //  There are four separate conclusions:</span>
02450 <span class="stringliteral">    //</span>
02451 <span class="stringliteral">    //  1: The file APPEARS to be Unicode     AU</span>
02452 <span class="stringliteral">    //  2: The file CANNOT be Unicode         CU</span>
02453 <span class="stringliteral">    //  3: The file CANNOT be ANSI            CA</span>
02454 <span class="stringliteral">    //</span>
02455 <span class="stringliteral">    //</span>
02456 <span class="stringliteral">    //  This gives the following possible results</span>
02457 <span class="stringliteral">    //</span>
02458 <span class="stringliteral">    //      CU</span>
02459 <span class="stringliteral">    //      +        -</span>
02460 <span class="stringliteral">    //</span>
02461 <span class="stringliteral">    //      AU       AU</span>
02462 <span class="stringliteral">    //      +   -    +   -</span>
02463 <span class="stringliteral">    //      --------  --------</span>
02464 <span class="stringliteral">    //      CA +| 0   0    2   3</span>
02465 <span class="stringliteral">    //      |</span>
02466 <span class="stringliteral">    //      -| 1   1    4   5</span>
02467 <span class="stringliteral">    //</span>
02468 <span class="stringliteral">    //</span>
02469 <span class="stringliteral">    //  Note that there are only 6 really different cases, not 8.</span>
02470 <span class="stringliteral">    //</span>
02471 <span class="stringliteral">    //  0 - This must be a binary file</span>
02472 <span class="stringliteral">    //  1 - ANSI file</span>
02473 <span class="stringliteral">    //  2 - Unicode file (High probability)</span>
02474 <span class="stringliteral">    //  3 - Unicode file (more than 50% chance)</span>
02475 <span class="stringliteral">    //  5 - No evidence for Unicode (ANSI is default)</span>
02476 <span class="stringliteral">    //</span>
02477 <span class="stringliteral">    //  The whole thing is more complicated if we allow the assumption</span>
02478 <span class="stringliteral">    //  of reverse polarity input. At this point we have a simplistic</span>
02479 <span class="stringliteral">    //  model: some of the reverse Unicode evidence is very strong,</span>
02480 <span class="stringliteral">    //  we ignore most weak evidence except statistics. If this kind of</span>
02481 <span class="stringliteral">    //  strong evidence is found together with Unicode evidence, it means</span>
02482 <span class="stringliteral">    //  its likely NOT Text at all. Furthermore if a REVERSE_BYTE_ORDER_MARK</span>
02483 <span class="stringliteral">    //  is found, it precludes normal Unicode. If both byte order marks are</span>
02484 <span class="stringliteral">    //  found it's not Unicode.</span>
02485 <span class="stringliteral">    //</span>
02486 <span class="stringliteral"></span>
02487 <span class="stringliteral">    //</span>
02488 <span class="stringliteral">    //  Unicode signature : uncontested signature outweighs reverse evidence.</span>
02489 <span class="stringliteral">    //</span>
02490 <span class="stringliteral">    if ((iResult &amp; IS_TEXT_UNICODE_SIGNATURE) &amp;&amp;</span>
02491 <span class="stringliteral">        !(iResult &amp; (IS_TEXT_UNICODE_NOT_UNICODE_MASK&amp;(~IS_TEXT_UNICODE_DBCS_LEADBYTE))))</span>
02492 <span class="stringliteral">    {</span>
02493 <span class="stringliteral">        return (TRUE);</span>
02494 <span class="stringliteral">    }</span>
02495 <span class="stringliteral"></span>
02496 <span class="stringliteral">    //</span>
02497 <span class="stringliteral">    //  If we have conflicting evidence, it's not Unicode.</span>
02498 <span class="stringliteral">    //</span>
02499 <span class="stringliteral">    if (iResult &amp; IS_TEXT_UNICODE_REVERSE_MASK)</span>
02500 <span class="stringliteral">    {</span>
02501 <span class="stringliteral">        return (FALSE);</span>
02502 <span class="stringliteral">    }</span>
02503 <span class="stringliteral"></span>
02504 <span class="stringliteral">    //</span>
02505 <span class="stringliteral">    //  Statistical and other results (cases 2 and 3).</span>
02506 <span class="stringliteral">    //</span>
02507 <span class="stringliteral">    if (!(iResult &amp; IS_TEXT_UNICODE_NOT_UNICODE_MASK) &amp;&amp;</span>
02508 <span class="stringliteral">         ((iResult &amp; IS_TEXT_UNICODE_NOT_ASCII_MASK) ||</span>
02509 <span class="stringliteral">          (iResult &amp; IS_TEXT_UNICODE_UNICODE_MASK)))</span>
02510 <span class="stringliteral">    {</span>
02511 <span class="stringliteral">        return (TRUE);</span>
02512 <span class="stringliteral">    }</span>
02513 <span class="stringliteral"></span>
02514 <span class="stringliteral">    return (FALSE);</span>
02515 <span class="stringliteral">}</span>
</span>
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a28" doxytag="nls.c::RtlOemStringToCountedUnicodeString" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS RtlOemStringToCountedUnicodeString           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">OUT PUNICODE_STRING&nbsp;</td>
          <td class="mdname" nowrap> <em>DestinationString</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN POEM_STRING&nbsp;</td>
          <td class="mdname" nowrap> <em>SourceString</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>AllocateDestinationString</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d5/nls_8c-source.html#l00716">716</a> of file <a class="el" href="../../d7/d5/nls_8c-source.html">nls.c</a>.
<p>
References <a class="el" href="../../d2/d9/cmchek_8c-source.html#l00095">Index</a>, <a class="el" href="../../d6/d5/stierr_8h-source.html#l00030">NT_SUCCESS</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d6/d8/ntrtlp_8h-source.html#l00246">RTL_PAGED_CODE</a>, <a class="el" href="../../d9/d1/ldrinit_8c-source.html#l00136">RtlAllocateStringRoutine</a>, <a class="el" href="../../d9/d1/ldrinit_8c-source.html#l00137">RtlFreeStringRoutine</a>, <a class="el" href="../../d0/d6/nlsxlat_8c-source.html#l00576">RtlOemToUnicodeN()</a>, <a class="el" href="../../d1/d1/usrbench_8h-source.html#l00230">SourceString</a>, and <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00064">USHORT</a>.
<p>
<pre class="fragment"><div>00724                    :
00725 
00726     This <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a16">functions</a> converts <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified oem source string into a
00727     <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a96">Unicode</a> string. The <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a46">translation</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> done with respect to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00728     installed OEM code page (OCP).
00729 
00730     The destination string <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> NOT unnaturally null terminated.  It <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> a
00731     counted string as counted strings are meant to be.
00732 
00733 Arguments:
00734 
00735     DestinationString - Returns a unicode string that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> equivalent to
00736         <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> oem source string. The maximum length field <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <a class="code" href="../../d3/d0/imm32_8def.html#a1">only</a>
00737         set <span class="keywordflow">if</span> AllocateDestinationString <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>.
00738 
00739     <a class="code" href="../../d0/d2/usrbench_8h.html#a33">SourceString</a> - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> oem source string that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to be
00740         converted to unicode.
00741 
00742     AllocateDestinationString - Supplies a flag that controls whether or
00743         not <span class="keyword">this</span> API allocates <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> buffer space <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> destination
00744         string.  If <a class="code" href="../../d1/d9/icmui_8def.html#a4">it</a> does, then <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> buffer must be deallocated <span class="keyword">using</span>
00745         <a class="code" href="../../d6/d6/nls_8c.html#a34">RtlFreeUnicodeString</a> (note that only storage <span class="keywordflow">for</span>
00746         DestinationString-&gt;Buffer is allocated by <span class="keyword">this</span> API).
00747 
00748 Return Value:
00749 
00750     SUCCESS - The conversion was successful
00751 
00752     !SUCCESS - The operation failed.  No storage was allocated and no
00753         conversion was done.  None.
00754 
00755 --*/
00756 
00757 {
00758     ULONG UnicodeLength;
00759     ULONG <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>;
00760     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> st;
00761 
00762     <a class="code" href="../../d5/d9/ntrtlp_8h.html#a12">RTL_PAGED_CODE</a>();
00763 
00764     UnicodeLength = RtlOemStringToCountedUnicodeSize(SourceString);
00765 
00766     <span class="keywordflow">if</span> ( UnicodeLength == 0 ) {
00767 
00768         DestinationString-&gt;Length = 0;
00769         DestinationString-&gt;MaximumLength = 0;
00770         DestinationString-&gt;Buffer = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00771 
00772         <span class="keywordflow">return</span> STATUS_SUCCESS;
00773     }
00774 
00775     <span class="keywordflow">if</span> ( UnicodeLength &gt; MAXUSHORT ) {
00776         <span class="keywordflow">return</span> STATUS_INVALID_PARAMETER_2;
00777         }
00778 
00779     DestinationString-&gt;Length = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)(UnicodeLength);
00780     <span class="keywordflow">if</span> ( AllocateDestinationString ) {
00781         DestinationString-&gt;MaximumLength = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)UnicodeLength;
00782         DestinationString-&gt;Buffer = (<a class="code" href="../../d8/d2/ldrinit_8c.html#a7">RtlAllocateStringRoutine</a>)(UnicodeLength);
00783         <span class="keywordflow">if</span> ( !DestinationString-&gt;Buffer ) {
00784             <span class="keywordflow">return</span> STATUS_NO_MEMORY;
00785             }
00786         }
00787     <span class="keywordflow">else</span> {
00788         <span class="keywordflow">if</span> ( DestinationString-&gt;Length &gt; DestinationString-&gt;MaximumLength ) {
00789             <span class="keywordflow">return</span> STATUS_BUFFER_OVERFLOW;
00790             }
00791         }
00792 
00793     st = <a class="code" href="../../d9/d6/nlsxlat_8c.html#a34">RtlOemToUnicodeN</a>(
00794              DestinationString-&gt;Buffer,
00795              DestinationString-&gt;Length,
00796              &amp;Index,
00797              <a class="code" href="../../d0/d2/usrbench_8h.html#a33">SourceString</a>-&gt;Buffer,
00798              <a class="code" href="../../d0/d2/usrbench_8h.html#a33">SourceString</a>-&gt;Length
00799              );
00800 
00801     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(st)) {
00802         <span class="keywordflow">if</span> ( AllocateDestinationString ) {
00803             (<a class="code" href="../../d8/d2/ldrinit_8c.html#a8">RtlFreeStringRoutine</a>)(DestinationString-&gt;Buffer);
00804             DestinationString-&gt;Buffer = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00805         }
00806 
00807         <span class="keywordflow">return</span> st;
00808     }
00809 
00810     <span class="keywordflow">return</span> STATUS_SUCCESS;
00811 
00812 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a25" doxytag="nls.c::RtlOemStringToUnicodeString" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS RtlOemStringToUnicodeString           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">OUT PUNICODE_STRING&nbsp;</td>
          <td class="mdname" nowrap> <em>DestinationString</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN POEM_STRING&nbsp;</td>
          <td class="mdname" nowrap> <em>SourceString</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>AllocateDestinationString</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d5/nls_8c-source.html#l00439">439</a> of file <a class="el" href="../../d7/d5/nls_8c-source.html">nls.c</a>.
<p>
References <a class="el" href="../../d2/d9/cmchek_8c-source.html#l00095">Index</a>, <a class="el" href="../../d6/d5/stierr_8h-source.html#l00030">NT_SUCCESS</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d6/d8/ntrtlp_8h-source.html#l00246">RTL_PAGED_CODE</a>, <a class="el" href="../../d9/d1/ldrinit_8c-source.html#l00136">RtlAllocateStringRoutine</a>, <a class="el" href="../../d9/d1/ldrinit_8c-source.html#l00137">RtlFreeStringRoutine</a>, <a class="el" href="../../d0/d6/nlsxlat_8c-source.html#l00576">RtlOemToUnicodeN()</a>, <a class="el" href="../../d1/d1/usrbench_8h-source.html#l00230">SourceString</a>, and <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00064">USHORT</a>.
<p>
Referenced by <a class="el" href="../../d7/d5/nls_8c-source.html#l02519">RtlDnsHostNameToComputerName()</a>.
<p>
<pre class="fragment"><div>00447                    :
00448 
00449     This <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a16">functions</a> converts <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified oem source string into a
00450     <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a96">Unicode</a> string. The <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a46">translation</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> done with respect to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00451     installed OEM code page (OCP).
00452 
00453 Arguments:
00454 
00455     DestinationString - Returns a unicode string that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> equivalent to
00456         <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> oem source string. The maximum length field <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <a class="code" href="../../d3/d0/imm32_8def.html#a1">only</a>
00457         set <span class="keywordflow">if</span> AllocateDestinationString <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>.
00458 
00459     <a class="code" href="../../d0/d2/usrbench_8h.html#a33">SourceString</a> - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> oem source string that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to be
00460         converted to unicode.
00461 
00462     AllocateDestinationString - Supplies a flag that controls whether or
00463         not <span class="keyword">this</span> API allocates <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> buffer space <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> destination
00464         string.  If <a class="code" href="../../d1/d9/icmui_8def.html#a4">it</a> does, then <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> buffer must be deallocated <span class="keyword">using</span>
00465         <a class="code" href="../../d6/d6/nls_8c.html#a34">RtlFreeUnicodeString</a> (note that only storage <span class="keywordflow">for</span>
00466         DestinationString-&gt;Buffer is allocated by <span class="keyword">this</span> API).
00467 
00468 Return Value:
00469 
00470     SUCCESS - The conversion was successful
00471 
00472     !SUCCESS - The operation failed.  No storage was allocated and no
00473         conversion was done.  None.
00474 
00475 --*/
00476 
00477 {
00478     ULONG UnicodeLength;
00479     ULONG <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>;
00480     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> st;
00481 
00482     <a class="code" href="../../d5/d9/ntrtlp_8h.html#a12">RTL_PAGED_CODE</a>();
00483 
00484     UnicodeLength = RtlOemStringToUnicodeSize(SourceString);
00485     <span class="keywordflow">if</span> ( UnicodeLength &gt; MAXUSHORT ) {
00486         <span class="keywordflow">return</span> STATUS_INVALID_PARAMETER_2;
00487         }
00488 
00489     DestinationString-&gt;Length = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)(UnicodeLength - <span class="keyword">sizeof</span>(UNICODE_NULL));
00490     <span class="keywordflow">if</span> ( AllocateDestinationString ) {
00491         DestinationString-&gt;MaximumLength = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)UnicodeLength;
00492         DestinationString-&gt;Buffer = (<a class="code" href="../../d8/d2/ldrinit_8c.html#a7">RtlAllocateStringRoutine</a>)(UnicodeLength);
00493         <span class="keywordflow">if</span> ( !DestinationString-&gt;Buffer ) {
00494             <span class="keywordflow">return</span> STATUS_NO_MEMORY;
00495             }
00496         }
00497     <span class="keywordflow">else</span> {
00498         <span class="keywordflow">if</span> ( DestinationString-&gt;Length &gt;= DestinationString-&gt;MaximumLength ) {
00499             <span class="keywordflow">return</span> STATUS_BUFFER_OVERFLOW;
00500             }
00501         }
00502 
00503     st = <a class="code" href="../../d9/d6/nlsxlat_8c.html#a34">RtlOemToUnicodeN</a>(
00504              DestinationString-&gt;Buffer,
00505              DestinationString-&gt;Length,
00506              &amp;Index,
00507              <a class="code" href="../../d0/d2/usrbench_8h.html#a33">SourceString</a>-&gt;Buffer,
00508              <a class="code" href="../../d0/d2/usrbench_8h.html#a33">SourceString</a>-&gt;Length
00509              );
00510 
00511     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(st)) {
00512         <span class="keywordflow">if</span> ( AllocateDestinationString ) {
00513             (<a class="code" href="../../d8/d2/ldrinit_8c.html#a8">RtlFreeStringRoutine</a>)(DestinationString-&gt;Buffer);
00514             DestinationString-&gt;Buffer = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00515         }
00516 
00517         <span class="keywordflow">return</span> st;
00518     }
00519 
00520     DestinationString-&gt;Buffer[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> / <span class="keyword">sizeof</span>(WCHAR)] = UNICODE_NULL;
00521 
00522     <span class="keywordflow">return</span> STATUS_SUCCESS;
00523 
00524 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a43" doxytag="nls.c::RtlPrefixUnicodeString" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN RtlPrefixUnicodeString           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PUNICODE_STRING&nbsp;</td>
          <td class="mdname" nowrap> <em>String1</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PUNICODE_STRING&nbsp;</td>
          <td class="mdname" nowrap> <em>String2</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>CaseInSensitive</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d5/nls_8c-source.html#l01690">1690</a> of file <a class="el" href="../../d7/d5/nls_8c-source.html">nls.c</a>.
<p>
References <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d8/d9/exts_8h-source.html#l00092">n</a>, <a class="el" href="../../d6/d8/ntrtlp_8h-source.html#l00219">NLS_UPCASE</a>, <a class="el" href="../../d0/d9/tcmpmem_8c-source.html#l00037">String1</a>, <a class="el" href="../../d0/d9/tcmpmem_8c-source.html#l00038">String2</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d8/d1/drivesup_8c-source.html#l00934">HalpNextDriveLetter()</a>, <a class="el" href="../../d6/d0/pnpres_8c-source.html#l06660">IopSetLegacyDeviceInstance()</a>, <a class="el" href="../../d7/d8/restrfil_8c-source.html#l01163">IsInterestingPath()</a>, <a class="el" href="../../d4/d6/config_2utils_2regutil_8c-source.html#l01096">RegGetKeyValue()</a>, and <a class="el" href="../../d8/d1/drivesup_8c-source.html#l01243">xHalIoAssignDriveLetters()</a>.
<p>
<pre class="fragment"><div>01698                    :
01699 
01700     The <a class="code" href="../../d3/d7/config_2utils_2regutil_8c.html#a30">RtlPrefixUnicodeString</a> function determines <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d9/d9/tcmpmem_8c.html#a1">String1</a>
01701     counted string parameter <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> a prefix of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d9/d9/tcmpmem_8c.html#a2">String2</a> counted string
01702     parameter.
01703 
01704     The CaseInSensitive parameter specifies <span class="keywordflow">if</span> <span class="keywordflow">case</span> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to be ignored when
01705     doing <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> comparison.
01706 
01707 Arguments:
01708 
01709     <a class="code" href="../../d9/d9/tcmpmem_8c.html#a1">String1</a> - Pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> first unicode string.
01710 
01711     <a class="code" href="../../d9/d9/tcmpmem_8c.html#a2">String2</a> - Pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> second unicode string.
01712 
01713     CaseInsensitive - <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> <span class="keywordflow">if</span> <span class="keywordflow">case</span> should be ignored when doing <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
01714         comparison.
01715 
01716 Return Value:
01717 
01718     <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a21">Boolean</a> value that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> <span class="keywordflow">if</span> <a class="code" href="../../d9/d9/tcmpmem_8c.html#a1">String1</a> equals a prefix of <a class="code" href="../../d9/d9/tcmpmem_8c.html#a2">String2</a> and
01719     <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a> otherwise.
01720 
01721 --*/
01722 
01723 {
01724     PWSTR s1, s2;
01725     ULONG <a class="code" href="../../d7/d0/exts_8h.html#a0">n</a>;
01726     WCHAR c1, c2;
01727 
01728     s1 = <a class="code" href="../../d9/d9/tcmpmem_8c.html#a1">String1</a>-&gt;Buffer;
01729     s2 = <a class="code" href="../../d9/d9/tcmpmem_8c.html#a2">String2</a>-&gt;Buffer;
01730     <a class="code" href="../../d7/d0/exts_8h.html#a0">n</a> = <a class="code" href="../../d9/d9/tcmpmem_8c.html#a1">String1</a>-&gt;Length;
01731     <span class="keywordflow">if</span> (<a class="code" href="../../d9/d9/tcmpmem_8c.html#a2">String2</a>-&gt;Length &lt; <a class="code" href="../../d7/d0/exts_8h.html#a0">n</a>) {
01732         <span class="keywordflow">return</span>( <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a> );
01733         }
01734 
01735     <a class="code" href="../../d7/d0/exts_8h.html#a0">n</a> = <a class="code" href="../../d7/d0/exts_8h.html#a0">n</a> / <span class="keyword">sizeof</span>(c1);
01736     <span class="keywordflow">if</span> (CaseInSensitive) {
01737         <span class="keywordflow">while</span> (<a class="code" href="../../d7/d0/exts_8h.html#a0">n</a>) {
01738             c1 = *s1++;
01739             c2 = *s2++;
01740 
01741             <span class="keywordflow">if</span> ((c1 != c2) &amp;&amp; (<a class="code" href="../../d5/d9/ntrtlp_8h.html#a10">NLS_UPCASE</a>(c1) != <a class="code" href="../../d5/d9/ntrtlp_8h.html#a10">NLS_UPCASE</a>(c2))) {
01742                 <span class="keywordflow">return</span>( <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a> );
01743                 }
01744 
01745             <a class="code" href="../../d7/d0/exts_8h.html#a0">n</a>--;
01746             }
01747         }
01748     <span class="keywordflow">else</span> {
01749         <span class="keywordflow">while</span> (<a class="code" href="../../d7/d0/exts_8h.html#a0">n</a>) {
01750             <span class="keywordflow">if</span> (*s1++ != *s2++) {
01751                 <span class="keywordflow">return</span>( <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a> );
01752                 }
01753 
01754             <a class="code" href="../../d7/d0/exts_8h.html#a0">n</a>--;
01755             }
01756         }
01757 
01758     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01759 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a23" doxytag="nls.c::RtlUnicodeStringToAnsiString" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS RtlUnicodeStringToAnsiString           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">OUT PANSI_STRING&nbsp;</td>
          <td class="mdname" nowrap> <em>DestinationString</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PUNICODE_STRING&nbsp;</td>
          <td class="mdname" nowrap> <em>SourceString</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>AllocateDestinationString</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d5/nls_8c-source.html#l00246">246</a> of file <a class="el" href="../../d7/d5/nls_8c-source.html">nls.c</a>.
<p>
References <a class="el" href="../../d2/d9/cmchek_8c-source.html#l00095">Index</a>, <a class="el" href="../../d6/d5/stierr_8h-source.html#l00030">NT_SUCCESS</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d6/d8/ntrtlp_8h-source.html#l00246">RTL_PAGED_CODE</a>, <a class="el" href="../../d9/d1/ldrinit_8c-source.html#l00136">RtlAllocateStringRoutine</a>, <a class="el" href="../../d9/d1/ldrinit_8c-source.html#l00137">RtlFreeStringRoutine</a>, <a class="el" href="../../d0/d6/nlsxlat_8c-source.html#l00905">RtlUnicodeToMultiByteN()</a>, <a class="el" href="../../d1/d1/usrbench_8h-source.html#l00230">SourceString</a>, and <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00064">USHORT</a>.
<p>
Referenced by <a class="el" href="../../d4/d9/w32_2ntcon_2fullscr_2vga_2misc_8c-source.html#l00031">ConvertOutputToOem()</a>, <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l04185">ExpQueryModuleInformation()</a>, <a class="el" href="../../d7/d7/ex_2harderr_8c-source.html#l00064">ExpSystemErrorHandler()</a>, <a class="el" href="../../d3/d0/client_2cmdline_8c-source.html#l01256">GetConsoleInputExeNameA()</a>, <a class="el" href="../../d8/d7/w32_2ntuser_2server_2harderr_8c-source.html#l00423">GetHardErrorText()</a>, <a class="el" href="../../d3/d6/class_8c-source.html#l00244">InternalRegisterClassEx()</a>, <a class="el" href="../../d0/d5/ioinit_8c-source.html#l00270">IoInitSystem()</a>, <a class="el" href="../../d0/d5/ioinit_8c-source.html#l03612">IopReassignSystemRoot()</a>, <a class="el" href="../../d5/d1/ldrapi_8c-source.html#l01210">LdrQueryProcessModuleInformation()</a>, <a class="el" href="../../d3/d4/editreg_8c-source.html#l02369">ListDrivers()</a>, <a class="el" href="../../d4/d4/mapview_8c-source.html#l01567">MiMapViewOfImageSection()</a>, <a class="el" href="../../d6/d4/sectsup_8c-source.html#l00191">MiSegmentDelete()</a>, <a class="el" href="../../d6/d4/sectsup_8c-source.html#l01721">MmGetFileNameForSection()</a>, <a class="el" href="../../d9/d7/sysload_8c-source.html#l06808">MmGetSystemRoutineAddress()</a>, <a class="el" href="../../d9/d7/sysload_8c-source.html#l02896">MmUnloadSystemImage()</a>, <a class="el" href="../../d6/d7/sysenv_8c-source.html#l00045">NtQuerySystemEnvironmentValue()</a>, <a class="el" href="../../d6/d7/sysenv_8c-source.html#l00305">NtSetSystemEnvironmentValue()</a>, <a class="el" href="../../d1/d1/obtype_8c-source.html#l00069">ObCreateObjectType()</a>, <a class="el" href="../../d3/d0/rtdmp_8c-source.html#l00313">print()</a>, and <a class="el" href="../../d3/d4/editreg_8c-source.html#l00866">UnicodePrint()</a>.
<p>
<pre class="fragment"><div>00254                    :
00255 
00256     This <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a16">functions</a> converts <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified unicode source string into an
00257     ansi string. The <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a46">translation</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> done with respect to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00258     current system locale information.
00259 
00260 Arguments:
00261 
00262     DestinationString - Returns an ansi string that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> equivalent to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00263         unicode source string.  If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a46">translation</a> can not be done,
00264         an error <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned.  The maximum length field <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <a class="code" href="../../d3/d0/imm32_8def.html#a1">only</a> set <span class="keywordflow">if</span>
00265         AllocateDestinationString <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>.
00266 
00267     <a class="code" href="../../d0/d2/usrbench_8h.html#a33">SourceString</a> - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> unicode source string that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to be
00268         converted to ansi.
00269 
00270     AllocateDestinationString - Supplies a flag that controls whether or
00271         not <span class="keyword">this</span> API allocates <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> buffer space <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> destination
00272         string.  If <a class="code" href="../../d1/d9/icmui_8def.html#a4">it</a> does, then <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> buffer must be deallocated <span class="keyword">using</span>
00273         <a class="code" href="../../d6/d6/nls_8c.html#a35">RtlFreeAnsiString</a> (note that only storage <span class="keywordflow">for</span>
00274         DestinationString-&gt;Buffer is allocated by <span class="keyword">this</span> API).
00275 
00276 Return Value:
00277 
00278     SUCCESS - The conversion was successful
00279 
00280     !SUCCESS - The operation failed.  No storage was allocated and no
00281         conversion was done.  None.
00282 
00283 --*/
00284 
00285 {
00286     ULONG AnsiLength;
00287     ULONG <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>;
00288     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> st;
00289     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> ReturnStatus = STATUS_SUCCESS;
00290 
00291     <a class="code" href="../../d5/d9/ntrtlp_8h.html#a12">RTL_PAGED_CODE</a>();
00292 
00293     AnsiLength = RtlUnicodeStringToAnsiSize(SourceString);
00294     <span class="keywordflow">if</span> ( AnsiLength &gt; MAXUSHORT ) {
00295         <span class="keywordflow">return</span> STATUS_INVALID_PARAMETER_2;
00296         }
00297 
00298     DestinationString-&gt;Length = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)(AnsiLength - 1);
00299     <span class="keywordflow">if</span> ( AllocateDestinationString ) {
00300         DestinationString-&gt;MaximumLength = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)AnsiLength;
00301         DestinationString-&gt;Buffer = (<a class="code" href="../../d8/d2/ldrinit_8c.html#a7">RtlAllocateStringRoutine</a>)(AnsiLength);
00302         <span class="keywordflow">if</span> ( !DestinationString-&gt;Buffer ) {
00303             <span class="keywordflow">return</span> STATUS_NO_MEMORY;
00304             }
00305         }
00306     <span class="keywordflow">else</span> {
00307         <span class="keywordflow">if</span> ( DestinationString-&gt;Length &gt;= DestinationString-&gt;MaximumLength ) {
00308             <span class="comment">/*</span>
00309 <span class="comment">             * Return STATUS_BUFFER_OVERFLOW, but translate as much as</span>
00310 <span class="comment">             * will fit into the buffer first.  This is the expected</span>
00311 <span class="comment">             * behavior for routines such as GetProfileStringA.</span>
00312 <span class="comment">             * Set the length of the buffer to one less than the maximum</span>
00313 <span class="comment">             * (so that the trail byte of a double byte char is not</span>
00314 <span class="comment">             * overwritten by doing DestinationString-&gt;Buffer[Index] = '\0').</span>
00315 <span class="comment">             * RtlUnicodeToMultiByteN is careful not to truncate a</span>
00316 <span class="comment">             * multibyte character.</span>
00317 <span class="comment">             */</span>
00318             <span class="keywordflow">if</span> (!DestinationString-&gt;MaximumLength) {
00319                 <span class="keywordflow">return</span> STATUS_BUFFER_OVERFLOW;
00320             }
00321             ReturnStatus = STATUS_BUFFER_OVERFLOW;
00322             DestinationString-&gt;Length = DestinationString-&gt;MaximumLength - 1;
00323             }
00324         }
00325 
00326     st = <a class="code" href="../../d9/d6/nlsxlat_8c.html#a37">RtlUnicodeToMultiByteN</a>(
00327              DestinationString-&gt;Buffer,
00328              DestinationString-&gt;Length,
00329              &amp;Index,
00330              <a class="code" href="../../d0/d2/usrbench_8h.html#a33">SourceString</a>-&gt;Buffer,
00331              <a class="code" href="../../d0/d2/usrbench_8h.html#a33">SourceString</a>-&gt;Length
00332              );
00333 
00334     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(st)) {
00335         <span class="keywordflow">if</span> ( AllocateDestinationString ) {
00336             (<a class="code" href="../../d8/d2/ldrinit_8c.html#a8">RtlFreeStringRoutine</a>)(DestinationString-&gt;Buffer);
00337             DestinationString-&gt;Buffer = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00338         }
00339 
00340         <span class="keywordflow">return</span> st;
00341     }
00342 
00343     DestinationString-&gt;Buffer[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>] = <span class="charliteral">'\0'</span>;
00344 
00345     <span class="keywordflow">return</span> ReturnStatus;
00346 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a29" doxytag="nls.c::RtlUnicodeStringToCountedOemString" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS RtlUnicodeStringToCountedOemString           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">OUT POEM_STRING&nbsp;</td>
          <td class="mdname" nowrap> <em>DestinationString</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PUNICODE_STRING&nbsp;</td>
          <td class="mdname" nowrap> <em>SourceString</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>AllocateDestinationString</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d5/nls_8c-source.html#l00816">816</a> of file <a class="el" href="../../d7/d5/nls_8c-source.html">nls.c</a>.
<p>
References <a class="el" href="../../d2/d9/cmchek_8c-source.html#l00095">Index</a>, <a class="el" href="../../d6/d5/stierr_8h-source.html#l00030">NT_SUCCESS</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d6/d8/ntrtlp_8h-source.html#l00246">RTL_PAGED_CODE</a>, <a class="el" href="../../d9/d1/ldrinit_8c-source.html#l00136">RtlAllocateStringRoutine</a>, <a class="el" href="../../d9/d1/ldrinit_8c-source.html#l00137">RtlFreeStringRoutine</a>, <a class="el" href="../../d0/d6/nlsxlat_8c-source.html#l01665">RtlpDidUnicodeToOemWork()</a>, <a class="el" href="../../d0/d6/nlsxlat_8c-source.html#l01277">RtlUnicodeToOemN()</a>, <a class="el" href="../../d1/d1/usrbench_8h-source.html#l00230">SourceString</a>, and <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00064">USHORT</a>.
<p>
Referenced by <a class="el" href="../../d6/d4/namesup_8c-source.html#l00176">UdfIs8dot3Name()</a>.
<p>
<pre class="fragment"><div>00824                    :
00825 
00826     This <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a16">functions</a> converts <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified unicode source string into an
00827     oem string. The <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a46">translation</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> done with respect to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> OEM code
00828     page (OCP).
00829 
00830     The destination string <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> NOT unnaturally null terminated.  It <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> a
00831     counted string as counted strings are meant to be.
00832 
00833 Arguments:
00834 
00835     DestinationString - Returns an oem string that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> equivalent to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00836         unicode source string.  If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a46">translation</a> can not be done,
00837         an error <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned.  The maximum length field <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <a class="code" href="../../d3/d0/imm32_8def.html#a1">only</a> set <span class="keywordflow">if</span>
00838         AllocateDestinationString <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>.
00839 
00840     <a class="code" href="../../d0/d2/usrbench_8h.html#a33">SourceString</a> - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> unicode source string that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to be
00841         converted to oem.
00842 
00843     AllocateDestinationString - Supplies a flag that controls whether or
00844         not <span class="keyword">this</span> API allocates <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> buffer space <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> destination
00845         string.  If <a class="code" href="../../d1/d9/icmui_8def.html#a4">it</a> does, then <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> buffer must be deallocated <span class="keyword">using</span>
00846         <a class="code" href="../../d6/d6/nls_8c.html#a35">RtlFreeAnsiString</a> (note that only storage <span class="keywordflow">for</span>
00847         DestinationString-&gt;Buffer is allocated by <span class="keyword">this</span> API).
00848 
00849 Return Value:
00850 
00851     SUCCESS - The conversion was successful
00852 
00853     !SUCCESS - The operation failed.  No storage was allocated and no
00854         conversion was done.  None.
00855 
00856 --*/
00857 
00858 {
00859     ULONG OemLength;
00860     ULONG <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>;
00861     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> st;
00862 
00863     <a class="code" href="../../d5/d9/ntrtlp_8h.html#a12">RTL_PAGED_CODE</a>();
00864 
00865     OemLength = RtlUnicodeStringToCountedOemSize(SourceString);
00866 
00867     <span class="keywordflow">if</span> ( OemLength == 0 ) {
00868 
00869         DestinationString-&gt;Length = 0;
00870         DestinationString-&gt;MaximumLength = 0;
00871         DestinationString-&gt;Buffer = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00872 
00873         <span class="keywordflow">return</span> STATUS_SUCCESS;
00874     }
00875 
00876     <span class="keywordflow">if</span> ( OemLength &gt; MAXUSHORT ) {
00877         <span class="keywordflow">return</span> STATUS_INVALID_PARAMETER_2;
00878         }
00879 
00880     DestinationString-&gt;Length = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)(OemLength);
00881     <span class="keywordflow">if</span> ( AllocateDestinationString ) {
00882         DestinationString-&gt;MaximumLength = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)OemLength;
00883         DestinationString-&gt;Buffer = (<a class="code" href="../../d8/d2/ldrinit_8c.html#a7">RtlAllocateStringRoutine</a>)(OemLength);
00884         <span class="keywordflow">if</span> ( !DestinationString-&gt;Buffer ) {
00885             <span class="keywordflow">return</span> STATUS_NO_MEMORY;
00886             }
00887         }
00888     <span class="keywordflow">else</span> {
00889         <span class="keywordflow">if</span> ( DestinationString-&gt;Length &gt; DestinationString-&gt;MaximumLength ) {
00890             <span class="keywordflow">return</span> STATUS_BUFFER_OVERFLOW;
00891             }
00892         }
00893 
00894     st = <a class="code" href="../../d9/d6/nlsxlat_8c.html#a39">RtlUnicodeToOemN</a>(
00895              DestinationString-&gt;Buffer,
00896              DestinationString-&gt;Length,
00897              &amp;Index,
00898              <a class="code" href="../../d0/d2/usrbench_8h.html#a33">SourceString</a>-&gt;Buffer,
00899              <a class="code" href="../../d0/d2/usrbench_8h.html#a33">SourceString</a>-&gt;Length
00900              );
00901 
00902     <span class="comment">//</span>
00903     <span class="comment">//  Now do a check here to see if there was really a mapping for all</span>
00904     <span class="comment">//  characters converted.</span>
00905     <span class="comment">//</span>
00906 
00907     <span class="keywordflow">if</span> (<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(st) &amp;&amp;
00908         !<a class="code" href="../../d5/d9/ntrtlp_8h.html#a37">RtlpDidUnicodeToOemWork</a>( DestinationString, SourceString )) {
00909 
00910         st = STATUS_UNMAPPABLE_CHARACTER;
00911     }
00912 
00913     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(st)) {
00914         <span class="keywordflow">if</span> ( AllocateDestinationString ) {
00915             (<a class="code" href="../../d8/d2/ldrinit_8c.html#a8">RtlFreeStringRoutine</a>)(DestinationString-&gt;Buffer);
00916             DestinationString-&gt;Buffer = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00917         }
00918 
00919         <span class="keywordflow">return</span> st;
00920     }
00921 
00922     <span class="keywordflow">return</span> STATUS_SUCCESS;
00923 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a26" doxytag="nls.c::RtlUnicodeStringToOemString" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS RtlUnicodeStringToOemString           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">OUT POEM_STRING&nbsp;</td>
          <td class="mdname" nowrap> <em>DestinationString</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PUNICODE_STRING&nbsp;</td>
          <td class="mdname" nowrap> <em>SourceString</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>AllocateDestinationString</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d5/nls_8c-source.html#l00528">528</a> of file <a class="el" href="../../d7/d5/nls_8c-source.html">nls.c</a>.
<p>
References <a class="el" href="../../d2/d9/cmchek_8c-source.html#l00095">Index</a>, <a class="el" href="../../d6/d5/stierr_8h-source.html#l00030">NT_SUCCESS</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d6/d8/ntrtlp_8h-source.html#l00246">RTL_PAGED_CODE</a>, <a class="el" href="../../d9/d1/ldrinit_8c-source.html#l00136">RtlAllocateStringRoutine</a>, <a class="el" href="../../d9/d1/ldrinit_8c-source.html#l00137">RtlFreeStringRoutine</a>, <a class="el" href="../../d0/d6/nlsxlat_8c-source.html#l01277">RtlUnicodeToOemN()</a>, <a class="el" href="../../d1/d1/usrbench_8h-source.html#l00230">SourceString</a>, and <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00064">USHORT</a>.
<p>
Referenced by <a class="el" href="../../d7/d7/ex_2harderr_8c-source.html#l00064">ExpSystemErrorHandler()</a>.
<p>
<pre class="fragment"><div>00536                    :
00537 
00538     This <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a16">functions</a> converts <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified unicode source string into an
00539     oem string. The <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a46">translation</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> done with respect to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> OEM code
00540     page (OCP).
00541 
00542 Arguments:
00543 
00544     DestinationString - Returns an oem string that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> equivalent to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00545         unicode source string.  If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a46">translation</a> can not be done,
00546         an error <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned.  The maximum length field <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <a class="code" href="../../d3/d0/imm32_8def.html#a1">only</a> set <span class="keywordflow">if</span>
00547         AllocateDestinationString <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>.
00548 
00549     <a class="code" href="../../d0/d2/usrbench_8h.html#a33">SourceString</a> - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> unicode source string that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to be
00550         converted to oem.
00551 
00552     AllocateDestinationString - Supplies a flag that controls whether or
00553         not <span class="keyword">this</span> API allocates <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> buffer space <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> destination
00554         string.  If <a class="code" href="../../d1/d9/icmui_8def.html#a4">it</a> does, then <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> buffer must be deallocated <span class="keyword">using</span>
00555         <a class="code" href="../../d6/d6/nls_8c.html#a35">RtlFreeAnsiString</a> (note that only storage <span class="keywordflow">for</span>
00556         DestinationString-&gt;Buffer is allocated by <span class="keyword">this</span> API).
00557 
00558 Return Value:
00559 
00560     SUCCESS - The conversion was successful
00561 
00562     !SUCCESS - The operation failed.  No storage was allocated and no
00563         conversion was done.  None.
00564 
00565 --*/
00566 
00567 {
00568     ULONG OemLength;
00569     ULONG <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>;
00570     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> st;
00571 
00572     <a class="code" href="../../d5/d9/ntrtlp_8h.html#a12">RTL_PAGED_CODE</a>();
00573 
00574     OemLength = RtlUnicodeStringToOemSize(SourceString);
00575     <span class="keywordflow">if</span> ( OemLength &gt; MAXUSHORT ) {
00576         <span class="keywordflow">return</span> STATUS_INVALID_PARAMETER_2;
00577         }
00578 
00579     DestinationString-&gt;Length = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)(OemLength - 1);
00580     <span class="keywordflow">if</span> ( AllocateDestinationString ) {
00581         DestinationString-&gt;MaximumLength = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)OemLength;
00582         DestinationString-&gt;Buffer = (<a class="code" href="../../d8/d2/ldrinit_8c.html#a7">RtlAllocateStringRoutine</a>)(OemLength);
00583         <span class="keywordflow">if</span> ( !DestinationString-&gt;Buffer ) {
00584             <span class="keywordflow">return</span> STATUS_NO_MEMORY;
00585             }
00586         }
00587     <span class="keywordflow">else</span> {
00588         <span class="keywordflow">if</span> ( DestinationString-&gt;Length &gt;= DestinationString-&gt;MaximumLength ) {
00589             <span class="keywordflow">return</span> STATUS_BUFFER_OVERFLOW;
00590             }
00591         }
00592 
00593     st = <a class="code" href="../../d9/d6/nlsxlat_8c.html#a39">RtlUnicodeToOemN</a>(
00594              DestinationString-&gt;Buffer,
00595              DestinationString-&gt;Length,
00596              &amp;Index,
00597              <a class="code" href="../../d0/d2/usrbench_8h.html#a33">SourceString</a>-&gt;Buffer,
00598              <a class="code" href="../../d0/d2/usrbench_8h.html#a33">SourceString</a>-&gt;Length
00599              );
00600 
00601     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(st)) {
00602         <span class="keywordflow">if</span> ( AllocateDestinationString ) {
00603             (<a class="code" href="../../d8/d2/ldrinit_8c.html#a8">RtlFreeStringRoutine</a>)(DestinationString-&gt;Buffer);
00604             DestinationString-&gt;Buffer = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00605         }
00606 
00607         <span class="keywordflow">return</span> st;
00608     }
00609 
00610     DestinationString-&gt;Buffer[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>] = <span class="charliteral">'\0'</span>;
00611 
00612     <span class="keywordflow">return</span> STATUS_SUCCESS;
00613 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a33" doxytag="nls.c::RtlUpcaseUnicodeChar" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> WCHAR RtlUpcaseUnicodeChar           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN WCHAR&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>SourceCharacter</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d5/nls_8c-source.html#l01178">1178</a> of file <a class="el" href="../../d7/d5/nls_8c-source.html">nls.c</a>.
<p>
References <a class="el" href="../../d6/d8/ntrtlp_8h-source.html#l00219">NLS_UPCASE</a>, and <a class="el" href="../../d6/d8/ntrtlp_8h-source.html#l00246">RTL_PAGED_CODE</a>.
<p>
Referenced by <a class="el" href="../../d0/d1/cmname_8c-source.html#l00195">CmpCompareCompressedName()</a>, <a class="el" href="../../d8/d0/cmindex_8c-source.html#l00615">CmpCompareInIndex()</a>, <a class="el" href="../../d3/d1/cmparse_8c-source.html#l01737">CmpComputeHashValue()</a>, <a class="el" href="../../d9/d1/cmsubs_8c-source.html#l00824">CmpCreateKeyControlBlock()</a>, <a class="el" href="../../d9/d1/cmsubs_8c-source.html#l00368">CmpGetNameControlBlock()</a>, <a class="el" href="../../d3/d1/cmparse_8c-source.html#l01476">CmpGetSymbolicLink()</a>, <a class="el" href="../../d3/d1/cmparse_8c-source.html#l00145">CmpParseKey()</a>, <a class="el" href="../../d0/d5/verifier_8c-source.html#l03448">MiApplyDriverVerifier()</a>, <a class="el" href="../../d5/d0/oblink_8c-source.html#l01015">ObpCreateSymbolicLinkName()</a>, <a class="el" href="../../d9/d9/obdir_8c-source.html#l00705">ObpLookupDirectoryEntry()</a>, <a class="el" href="../../d6/d0/curdir_8c-source.html#l00920">RtlGetFullPathName_Ustr()</a>, <a class="el" href="../../d7/d8/heappage_8c-source.html#l05143">RtlpDphIsDllTargeted()</a>, <a class="el" href="../../d1/d9/rtl_2atom_8c-source.html#l00451">RtlpHashStringToAtom()</a>, <a class="el" href="../../d8/d5/nlsboot_8c-source.html#l00506">RtlUpcaseUnicodeToMultiByteN()</a>, and <a class="el" href="../../d0/d5/verifier_8c-source.html#l04336">ViPrintString()</a>.
<p>
<pre class="fragment"><div>01184                    :
01185 
01186     This function translates <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified unicode character to its
01187     equivalent upcased unicode chararacter.  The purpose <span class="keywordflow">for</span> <span class="keyword">this</span> routine
01188     <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to allow <span class="keywordflow">for</span> character by character <a class="code" href="../../d7/d6/nlsboot_8c.html#a0">upcase</a> <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a46">translation</a>.  The
01189     <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a46">translation</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> done with respect to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> current system locale
01190     information.
01191 
01192 
01193 Arguments:
01194 
01195     SourceCharacter - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> unicode character to be upcased.
01196 
01197 Return Value:
01198 
01199     Returns <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> upcased unicode equivalent of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified input character.
01200 
01201 --*/
01202 
01203 {
01204     <a class="code" href="../../d5/d9/ntrtlp_8h.html#a12">RTL_PAGED_CODE</a>();
01205 
01206     <span class="comment">//</span>
01207     <span class="comment">// Note that this needs to reference the translation table !</span>
01208     <span class="comment">//</span>
01209 
01210     <span class="keywordflow">return</span> (WCHAR)<a class="code" href="../../d5/d9/ntrtlp_8h.html#a10">NLS_UPCASE</a>(SourceCharacter);
01211 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a31" doxytag="nls.c::RtlUpcaseUnicodeString" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS RtlUpcaseUnicodeString           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">OUT PUNICODE_STRING&nbsp;</td>
          <td class="mdname" nowrap> <em>DestinationString</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PCUNICODE_STRING&nbsp;</td>
          <td class="mdname" nowrap> <em>SourceString</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>AllocateDestinationString</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d5/nls_8c-source.html#l01038">1038</a> of file <a class="el" href="../../d7/d5/nls_8c-source.html">nls.c</a>.
<p>
References <a class="el" href="../../d2/d9/cmchek_8c-source.html#l00095">Index</a>, <a class="el" href="../../d6/d8/ntrtlp_8h-source.html#l00219">NLS_UPCASE</a>, <a class="el" href="../../d6/d8/ntrtlp_8h-source.html#l00246">RTL_PAGED_CODE</a>, <a class="el" href="../../d9/d1/ldrinit_8c-source.html#l00136">RtlAllocateStringRoutine</a>, and <a class="el" href="../../d1/d1/usrbench_8h-source.html#l00230">SourceString</a>.
<p>
Referenced by <a class="el" href="../../d5/d4/name_8c-source.html#l00288">FsRtlAreNamesEqual()</a>, <a class="el" href="../../d5/d4/name_8c-source.html#l00415">FsRtlIsNameInExpression()</a>, <a class="el" href="../../d0/d1/pnpsubs_8c-source.html#l00091">IopCreateMadeupNode()</a>, <a class="el" href="../../d1/d0/pnpirp_8c-source.html#l01891">IopMakeGloballyUniqueId()</a>, <a class="el" href="../../d2/d7/dirctrl_8c-source.html#l01003">UdfInitializeEnumeration()</a>, and <a class="el" href="../../d4/d7/udfprocs_8h-source.html#l01131">UdfUpcaseName()</a>.
<p>
<pre class="fragment"><div>01046                    :
01047 
01048     This <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a16">functions</a> converts <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified unicode source string into an
01049     upcased unicode string. The <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a46">translation</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> done with respect to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
01050     current system locale information.
01051 
01052 Arguments:
01053 
01054     DestinationString - Returns a unicode string that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> upcased equivalent
01055         to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> unicode source string.  The maximum length field <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <a class="code" href="../../d3/d0/imm32_8def.html#a1">only</a> set <span class="keywordflow">if</span>
01056         AllocateDestinationString <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>.
01057 
01058     <a class="code" href="../../d0/d2/usrbench_8h.html#a33">SourceString</a> - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> unicode source string that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to being
01059         upcased.
01060 
01061     AllocateDestinationString - Supplies a flag that controls whether or
01062         not <span class="keyword">this</span> API allocates <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> buffer space <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> destination
01063         string.  If <a class="code" href="../../d1/d9/icmui_8def.html#a4">it</a> does, then <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> buffer must be deallocated <span class="keyword">using</span>
01064         <a class="code" href="../../d6/d6/nls_8c.html#a34">RtlFreeUnicodeString</a> (note that only storage <span class="keywordflow">for</span>
01065         DestinationString-&gt;Buffer is allocated by <span class="keyword">this</span> API).
01066 
01067 Return Value:
01068 
01069     SUCCESS - The conversion was successful
01070 
01071     !SUCCESS - The operation failed.  No storage was allocated and no
01072         conversion was done.  None.
01073 
01074 --*/
01075 
01076 {
01077     ULONG <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>;
01078     ULONG StopIndex;
01079 
01080     <a class="code" href="../../d5/d9/ntrtlp_8h.html#a12">RTL_PAGED_CODE</a>();
01081 
01082     <span class="keywordflow">if</span> ( AllocateDestinationString ) {
01083         DestinationString-&gt;MaximumLength = <a class="code" href="../../d0/d2/usrbench_8h.html#a33">SourceString</a>-&gt;Length;
01084         DestinationString-&gt;Buffer = (<a class="code" href="../../d8/d2/ldrinit_8c.html#a7">RtlAllocateStringRoutine</a>)((ULONG)DestinationString-&gt;MaximumLength);
01085         <span class="keywordflow">if</span> ( !DestinationString-&gt;Buffer ) {
01086             <span class="keywordflow">return</span> STATUS_NO_MEMORY;
01087             }
01088         }
01089     <span class="keywordflow">else</span> {
01090         <span class="keywordflow">if</span> ( <a class="code" href="../../d0/d2/usrbench_8h.html#a33">SourceString</a>-&gt;Length &gt; DestinationString-&gt;MaximumLength ) {
01091             <span class="keywordflow">return</span> STATUS_BUFFER_OVERFLOW;
01092             }
01093         }
01094 
01095     StopIndex = ((ULONG)<a class="code" href="../../d0/d2/usrbench_8h.html#a33">SourceString</a>-&gt;Length) / <span class="keyword">sizeof</span>( WCHAR );
01096 
01097     <span class="keywordflow">for</span> (<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> = 0; <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> &lt; StopIndex; <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>++) {
01098         DestinationString-&gt;Buffer[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>] = (WCHAR)<a class="code" href="../../d5/d9/ntrtlp_8h.html#a10">NLS_UPCASE</a>(<a class="code" href="../../d0/d2/usrbench_8h.html#a33">SourceString</a>-&gt;Buffer[Index]);
01099     }
01100 
01101     DestinationString-&gt;Length = <a class="code" href="../../d0/d2/usrbench_8h.html#a33">SourceString</a>-&gt;Length;
01102 
01103     <span class="keywordflow">return</span> STATUS_SUCCESS;
01104 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a24" doxytag="nls.c::RtlUpcaseUnicodeStringToAnsiString" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS RtlUpcaseUnicodeStringToAnsiString           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">OUT PANSI_STRING&nbsp;</td>
          <td class="mdname" nowrap> <em>DestinationString</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PUNICODE_STRING&nbsp;</td>
          <td class="mdname" nowrap> <em>SourceString</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>AllocateDestinationString</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d5/nls_8c-source.html#l00350">350</a> of file <a class="el" href="../../d7/d5/nls_8c-source.html">nls.c</a>.
<p>
References <a class="el" href="../../d2/d9/cmchek_8c-source.html#l00095">Index</a>, <a class="el" href="../../d6/d5/stierr_8h-source.html#l00030">NT_SUCCESS</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d6/d8/ntrtlp_8h-source.html#l00246">RTL_PAGED_CODE</a>, <a class="el" href="../../d9/d1/ldrinit_8c-source.html#l00136">RtlAllocateStringRoutine</a>, <a class="el" href="../../d9/d1/ldrinit_8c-source.html#l00137">RtlFreeStringRoutine</a>, <a class="el" href="../../d0/d6/nlsxlat_8c-source.html#l01053">RtlUpcaseUnicodeToMultiByteN()</a>, <a class="el" href="../../d1/d1/usrbench_8h-source.html#l00230">SourceString</a>, and <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00064">USHORT</a>.
<p>
<pre class="fragment"><div>00358                    :
00359 
00360     This <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a16">functions</a> upper cases <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified unicode source string and then
00361     converts <a class="code" href="../../d1/d9/icmui_8def.html#a4">it</a> into an ansi string. The <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a46">translation</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> done with respect
00362     to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> current system locale information.
00363 
00364 Arguments:
00365 
00366     DestinationString - Returns an ansi string that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> equivalent to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00367         unicode source string.  If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a46">translation</a> can not be done,
00368         an error <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned.  The maximum length field <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <a class="code" href="../../d3/d0/imm32_8def.html#a1">only</a> set
00369         <span class="keywordflow">if</span> AllocateDestinationString <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>.
00370 
00371     <a class="code" href="../../d0/d2/usrbench_8h.html#a33">SourceString</a> - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> unicode source string that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to be
00372         converted to upper <span class="keywordflow">case</span> ansi.
00373 
00374     AllocateDestinationString - Supplies a flag that controls whether or
00375         not <span class="keyword">this</span> API allocates <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> buffer space <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> destination
00376         string.  If <a class="code" href="../../d1/d9/icmui_8def.html#a4">it</a> does, then <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> buffer must be deallocated <span class="keyword">using</span>
00377         <a class="code" href="../../d6/d6/nls_8c.html#a35">RtlFreeAnsiString</a> (note that only storage <span class="keywordflow">for</span>
00378         DestinationString-&gt;Buffer is allocated by <span class="keyword">this</span> API).
00379 
00380 Return Value:
00381 
00382     SUCCESS - The conversion was successful
00383 
00384     !SUCCESS - The operation failed.  No storage was allocated and no
00385         conversion was done.  None.
00386 
00387 --*/
00388 
00389 {
00390     ULONG AnsiLength;
00391     ULONG <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>;
00392     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> st;
00393 
00394     <a class="code" href="../../d5/d9/ntrtlp_8h.html#a12">RTL_PAGED_CODE</a>();
00395 
00396     AnsiLength = RtlUnicodeStringToAnsiSize(SourceString);
00397     <span class="keywordflow">if</span> ( AnsiLength &gt; MAXUSHORT ) {
00398         <span class="keywordflow">return</span> STATUS_INVALID_PARAMETER_2;
00399         }
00400 
00401     DestinationString-&gt;Length = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)(AnsiLength - 1);
00402     <span class="keywordflow">if</span> ( AllocateDestinationString ) {
00403         DestinationString-&gt;MaximumLength = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)AnsiLength;
00404         DestinationString-&gt;Buffer = (<a class="code" href="../../d8/d2/ldrinit_8c.html#a7">RtlAllocateStringRoutine</a>)(AnsiLength);
00405         <span class="keywordflow">if</span> ( !DestinationString-&gt;Buffer ) {
00406             <span class="keywordflow">return</span> STATUS_NO_MEMORY;
00407             }
00408         }
00409     <span class="keywordflow">else</span> {
00410         <span class="keywordflow">if</span> ( DestinationString-&gt;Length &gt;= DestinationString-&gt;MaximumLength ) {
00411             <span class="keywordflow">return</span> STATUS_BUFFER_OVERFLOW;
00412             }
00413         }
00414 
00415     st = <a class="code" href="../../d9/d6/nlsxlat_8c.html#a38">RtlUpcaseUnicodeToMultiByteN</a>(
00416              DestinationString-&gt;Buffer,
00417              DestinationString-&gt;Length,
00418              &amp;Index,
00419              <a class="code" href="../../d0/d2/usrbench_8h.html#a33">SourceString</a>-&gt;Buffer,
00420              <a class="code" href="../../d0/d2/usrbench_8h.html#a33">SourceString</a>-&gt;Length
00421              );
00422 
00423     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(st)) {
00424         <span class="keywordflow">if</span> ( AllocateDestinationString ) {
00425             (<a class="code" href="../../d8/d2/ldrinit_8c.html#a8">RtlFreeStringRoutine</a>)(DestinationString-&gt;Buffer);
00426             DestinationString-&gt;Buffer = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00427         }
00428 
00429         <span class="keywordflow">return</span> st;
00430     }
00431 
00432     DestinationString-&gt;Buffer[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>] = <span class="charliteral">'\0'</span>;
00433 
00434     <span class="keywordflow">return</span> STATUS_SUCCESS;
00435 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a30" doxytag="nls.c::RtlUpcaseUnicodeStringToCountedOemString" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS RtlUpcaseUnicodeStringToCountedOemString           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">OUT POEM_STRING&nbsp;</td>
          <td class="mdname" nowrap> <em>DestinationString</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PUNICODE_STRING&nbsp;</td>
          <td class="mdname" nowrap> <em>SourceString</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>AllocateDestinationString</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d5/nls_8c-source.html#l00927">927</a> of file <a class="el" href="../../d7/d5/nls_8c-source.html">nls.c</a>.
<p>
References <a class="el" href="../../d2/d9/cmchek_8c-source.html#l00095">Index</a>, <a class="el" href="../../d6/d5/stierr_8h-source.html#l00030">NT_SUCCESS</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d6/d8/ntrtlp_8h-source.html#l00246">RTL_PAGED_CODE</a>, <a class="el" href="../../d9/d1/ldrinit_8c-source.html#l00136">RtlAllocateStringRoutine</a>, <a class="el" href="../../d9/d1/ldrinit_8c-source.html#l00137">RtlFreeStringRoutine</a>, <a class="el" href="../../d0/d6/nlsxlat_8c-source.html#l01665">RtlpDidUnicodeToOemWork()</a>, <a class="el" href="../../d0/d6/nlsxlat_8c-source.html#l01433">RtlUpcaseUnicodeToOemN()</a>, <a class="el" href="../../d1/d1/usrbench_8h-source.html#l00230">SourceString</a>, and <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00064">USHORT</a>.
<p>
Referenced by <a class="el" href="../../d6/d8/gen8dot3_8c-source.html#l00729">RtlIsNameLegalDOS8Dot3()</a>.
<p>
<pre class="fragment"><div>00935                    :
00936 
00937     This <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a16">functions</a> upper cases <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified unicode source string and
00938     then converts <a class="code" href="../../d1/d9/icmui_8def.html#a4">it</a> into an oem string. The <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a46">translation</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> done with
00939     respect to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> OEM code page (OCP).
00940 
00941     The destination string <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> NOT unnaturally null terminated.  It <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> a
00942     counted string as counted strings are meant to be.
00943 
00944 Arguments:
00945 
00946     DestinationString - Returns an oem string that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> equivalent to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00947         unicode source string.  If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a46">translation</a> can not be done,
00948         an error <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned.  The maximum length field <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <a class="code" href="../../d3/d0/imm32_8def.html#a1">only</a> set
00949         <span class="keywordflow">if</span> AllocateDestinationString <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>.
00950 
00951     <a class="code" href="../../d0/d2/usrbench_8h.html#a33">SourceString</a> - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> unicode source string that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to be
00952         converted to oem.
00953 
00954     AllocateDestinationString - Supplies a flag that controls whether or
00955         not <span class="keyword">this</span> API allocates <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> buffer space <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> destination
00956         string.  If <a class="code" href="../../d1/d9/icmui_8def.html#a4">it</a> does, then <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> buffer must be deallocated <span class="keyword">using</span>
00957         <a class="code" href="../../d6/d6/nls_8c.html#a35">RtlFreeAnsiString</a> (note that only storage <span class="keywordflow">for</span>
00958         DestinationString-&gt;Buffer is allocated by <span class="keyword">this</span> API).
00959 
00960 Return Value:
00961 
00962     SUCCESS - The conversion was successful
00963 
00964     !SUCCESS - The operation failed.  No storage was allocated and no
00965         conversion was done.  None.
00966 
00967 --*/
00968 
00969 {
00970     ULONG OemLength;
00971     ULONG <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>;
00972     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> st;
00973 
00974     <a class="code" href="../../d5/d9/ntrtlp_8h.html#a12">RTL_PAGED_CODE</a>();
00975 
00976     OemLength = RtlUnicodeStringToCountedOemSize(SourceString);
00977 
00978     <span class="keywordflow">if</span> ( OemLength == 0 ) {
00979 
00980         DestinationString-&gt;Length = 0;
00981         DestinationString-&gt;MaximumLength = 0;
00982         DestinationString-&gt;Buffer = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00983 
00984         <span class="keywordflow">return</span> STATUS_SUCCESS;
00985     }
00986 
00987     <span class="keywordflow">if</span> ( OemLength &gt; MAXUSHORT ) {
00988         <span class="keywordflow">return</span> STATUS_INVALID_PARAMETER_2;
00989         }
00990 
00991     DestinationString-&gt;Length = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)(OemLength);
00992     <span class="keywordflow">if</span> ( AllocateDestinationString ) {
00993         DestinationString-&gt;MaximumLength = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)OemLength;
00994         DestinationString-&gt;Buffer = (<a class="code" href="../../d8/d2/ldrinit_8c.html#a7">RtlAllocateStringRoutine</a>)(OemLength);
00995         <span class="keywordflow">if</span> ( !DestinationString-&gt;Buffer ) {
00996             <span class="keywordflow">return</span> STATUS_NO_MEMORY;
00997             }
00998         }
00999     <span class="keywordflow">else</span> {
01000         <span class="keywordflow">if</span> ( DestinationString-&gt;Length &gt; DestinationString-&gt;MaximumLength ) {
01001             <span class="keywordflow">return</span> STATUS_BUFFER_OVERFLOW;
01002             }
01003         }
01004 
01005     st = <a class="code" href="../../d9/d6/nlsxlat_8c.html#a40">RtlUpcaseUnicodeToOemN</a>(
01006              DestinationString-&gt;Buffer,
01007              DestinationString-&gt;Length,
01008              &amp;Index,
01009              <a class="code" href="../../d0/d2/usrbench_8h.html#a33">SourceString</a>-&gt;Buffer,
01010              <a class="code" href="../../d0/d2/usrbench_8h.html#a33">SourceString</a>-&gt;Length
01011              );
01012 
01013     <span class="comment">//</span>
01014     <span class="comment">//  Now do a check here to see if there was really a mapping for all</span>
01015     <span class="comment">//  characters converted.</span>
01016     <span class="comment">//</span>
01017 
01018     <span class="keywordflow">if</span> (<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(st) &amp;&amp;
01019         !<a class="code" href="../../d5/d9/ntrtlp_8h.html#a37">RtlpDidUnicodeToOemWork</a>( DestinationString, SourceString )) {
01020 
01021         st = STATUS_UNMAPPABLE_CHARACTER;
01022     }
01023 
01024     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(st)) {
01025         <span class="keywordflow">if</span> ( AllocateDestinationString ) {
01026             (<a class="code" href="../../d8/d2/ldrinit_8c.html#a8">RtlFreeStringRoutine</a>)(DestinationString-&gt;Buffer);
01027             DestinationString-&gt;Buffer = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01028         }
01029 
01030         <span class="keywordflow">return</span> st;
01031     }
01032 
01033     <span class="keywordflow">return</span> STATUS_SUCCESS;
01034 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a27" doxytag="nls.c::RtlUpcaseUnicodeStringToOemString" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS RtlUpcaseUnicodeStringToOemString           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">OUT POEM_STRING&nbsp;</td>
          <td class="mdname" nowrap> <em>DestinationString</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PUNICODE_STRING&nbsp;</td>
          <td class="mdname" nowrap> <em>SourceString</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>AllocateDestinationString</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d5/nls_8c-source.html#l00617">617</a> of file <a class="el" href="../../d7/d5/nls_8c-source.html">nls.c</a>.
<p>
References <a class="el" href="../../d2/d9/cmchek_8c-source.html#l00095">Index</a>, <a class="el" href="../../d6/d5/stierr_8h-source.html#l00030">NT_SUCCESS</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d6/d8/ntrtlp_8h-source.html#l00246">RTL_PAGED_CODE</a>, <a class="el" href="../../d9/d1/ldrinit_8c-source.html#l00136">RtlAllocateStringRoutine</a>, <a class="el" href="../../d9/d1/ldrinit_8c-source.html#l00137">RtlFreeStringRoutine</a>, <a class="el" href="../../d0/d6/nlsxlat_8c-source.html#l01665">RtlpDidUnicodeToOemWork()</a>, <a class="el" href="../../d0/d6/nlsxlat_8c-source.html#l01433">RtlUpcaseUnicodeToOemN()</a>, <a class="el" href="../../d1/d1/usrbench_8h-source.html#l00230">SourceString</a>, and <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00064">USHORT</a>.
<p>
Referenced by <a class="el" href="../../d7/d5/nls_8c-source.html#l01959">RtlEqualDomainName()</a>.
<p>
<pre class="fragment"><div>00625                    :
00626 
00627     This function upper cases <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified unicode source string and then
00628     converts <a class="code" href="../../d1/d9/icmui_8def.html#a4">it</a> into an oem string. The <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a46">translation</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> done with respect
00629     to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> OEM code page (OCP).
00630 
00631 Arguments:
00632 
00633     DestinationString - Returns an oem string that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> equivalent to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00634         unicode source string.  The maximum length field <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <a class="code" href="../../d3/d0/imm32_8def.html#a1">only</a> set <span class="keywordflow">if</span>
00635         AllocateDestinationString <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>.
00636 
00637     <a class="code" href="../../d0/d2/usrbench_8h.html#a33">SourceString</a> - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> unicode source string that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to be
00638         converted to oem.
00639 
00640     AllocateDestinationString - Supplies a flag that controls whether or
00641         not <span class="keyword">this</span> API allocates <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> buffer space <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> destination
00642         string.  If <a class="code" href="../../d1/d9/icmui_8def.html#a4">it</a> does, then <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> buffer must be deallocated <span class="keyword">using</span>
00643         <a class="code" href="../../d6/d6/nls_8c.html#a35">RtlFreeAnsiString</a> (note that only storage <span class="keywordflow">for</span>
00644         DestinationString-&gt;Buffer is allocated by <span class="keyword">this</span> API).
00645 
00646 Return Value:
00647 
00648     SUCCESS - The conversion was successful
00649 
00650     !SUCCESS - The operation failed.  No storage was allocated and no
00651         conversion was done.  None.
00652 
00653 --*/
00654 
00655 {
00656     ULONG OemLength;
00657     ULONG <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>;
00658     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> st;
00659 
00660     <a class="code" href="../../d5/d9/ntrtlp_8h.html#a12">RTL_PAGED_CODE</a>();
00661 
00662     OemLength = RtlUnicodeStringToOemSize(SourceString);
00663     <span class="keywordflow">if</span> ( OemLength &gt; MAXUSHORT ) {
00664         <span class="keywordflow">return</span> STATUS_INVALID_PARAMETER_2;
00665         }
00666 
00667     DestinationString-&gt;Length = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)(OemLength - 1);
00668     <span class="keywordflow">if</span> ( AllocateDestinationString ) {
00669         DestinationString-&gt;MaximumLength = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)OemLength;
00670         DestinationString-&gt;Buffer = (<a class="code" href="../../d8/d2/ldrinit_8c.html#a7">RtlAllocateStringRoutine</a>)(OemLength);
00671         <span class="keywordflow">if</span> ( !DestinationString-&gt;Buffer ) {
00672             <span class="keywordflow">return</span> STATUS_NO_MEMORY;
00673             }
00674         }
00675     <span class="keywordflow">else</span> {
00676         <span class="keywordflow">if</span> ( DestinationString-&gt;Length &gt;= DestinationString-&gt;MaximumLength ) {
00677             <span class="keywordflow">return</span> STATUS_BUFFER_OVERFLOW;
00678             }
00679         }
00680 
00681     st = <a class="code" href="../../d9/d6/nlsxlat_8c.html#a40">RtlUpcaseUnicodeToOemN</a>(
00682              DestinationString-&gt;Buffer,
00683              DestinationString-&gt;Length,
00684              &amp;Index,
00685              <a class="code" href="../../d0/d2/usrbench_8h.html#a33">SourceString</a>-&gt;Buffer,
00686              <a class="code" href="../../d0/d2/usrbench_8h.html#a33">SourceString</a>-&gt;Length
00687              );
00688 
00689     <span class="comment">//</span>
00690     <span class="comment">//  Now do a check here to see if there was really a mapping for all</span>
00691     <span class="comment">//  characters converted.</span>
00692     <span class="comment">//</span>
00693 
00694     <span class="keywordflow">if</span> (<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(st) &amp;&amp;
00695         !<a class="code" href="../../d5/d9/ntrtlp_8h.html#a37">RtlpDidUnicodeToOemWork</a>( DestinationString, SourceString )) {
00696 
00697         st = STATUS_UNMAPPABLE_CHARACTER;
00698     }
00699 
00700     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(st)) {
00701         <span class="keywordflow">if</span> ( AllocateDestinationString ) {
00702             (<a class="code" href="../../d8/d2/ldrinit_8c.html#a8">RtlFreeStringRoutine</a>)(DestinationString-&gt;Buffer);
00703             DestinationString-&gt;Buffer = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00704         }
00705 
00706         <span class="keywordflow">return</span> st;
00707     }
00708 
00709     DestinationString-&gt;Buffer[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>] = <span class="charliteral">'\0'</span>;
00710 
00711     <span class="keywordflow">return</span> STATUS_SUCCESS;
00712 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a39" doxytag="nls.c::RtlxAnsiStringToUnicodeSize" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG RtlxAnsiStringToUnicodeSize           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PANSI_STRING&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>AnsiString</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d5/nls_8c-source.html#l01421">1421</a> of file <a class="el" href="../../d7/d5/nls_8c-source.html">nls.c</a>.
<p>
References <a class="el" href="../../d6/d8/ntrtlp_8h-source.html#l00246">RTL_PAGED_CODE</a>, and <a class="el" href="../../d0/d6/nlsxlat_8c-source.html#l00755">RtlMultiByteToUnicodeSize()</a>.
<p>
<pre class="fragment"><div>01427                    :
01428 
01429     This function computes <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> number of bytes required to store a <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>
01430     terminated unicode string that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> equivalent to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified ansi
01431     string.
01432 
01433 Arguments:
01434 
01435     AnsiString - Supplies an ansi string whose equivalent size as a
01436         unicode string <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to be calculated.  The ansi string <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a>
01437         interpreted relative to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> current system locale.
01438 
01439 Return Value:
01440 
01441     The <span class="keywordflow">return</span> value specifies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> number of bytes required to hold a
01442     <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> terminated unicode string equivalent to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified ansi
01443     string.
01444 
01445 --*/
01446 
01447 {
01448     ULONG cbConverted;
01449 
01450     <a class="code" href="../../d5/d9/ntrtlp_8h.html#a12">RTL_PAGED_CODE</a>();
01451 
01452     <span class="comment">//</span>
01453     <span class="comment">// Get the size of the string - this call handles DBCS.</span>
01454     <span class="comment">//</span>
01455     <a class="code" href="../../d9/d6/nlsxlat_8c.html#a35">RtlMultiByteToUnicodeSize</a>( &amp;cbConverted ,
01456                                AnsiString-&gt;Buffer,
01457                                AnsiString-&gt;Length );
01458 
01459     <span class="comment">//</span>
01460     <span class="comment">// Return the size in bytes.</span>
01461     <span class="comment">//</span>
01462     <span class="keywordflow">return</span> ( cbConverted + <span class="keyword">sizeof</span>(UNICODE_NULL) );
01463 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a40" doxytag="nls.c::RtlxOemStringToUnicodeSize" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG RtlxOemStringToUnicodeSize           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN POEM_STRING&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>OemString</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d5/nls_8c-source.html#l01467">1467</a> of file <a class="el" href="../../d7/d5/nls_8c-source.html">nls.c</a>.
<p>
References <a class="el" href="../../d6/d8/ntrtlp_8h-source.html#l00246">RTL_PAGED_CODE</a>, and <a class="el" href="../../d0/d6/nlsxlat_8c-source.html#l00755">RtlMultiByteToUnicodeSize()</a>.
<p>
<pre class="fragment"><div>01473                    :
01474 
01475     This function computes <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> number of bytes required to store a <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>
01476     terminated unicode string that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> equivalent to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified oem
01477     string.
01478 
01479 Arguments:
01480 
01481     OemString - Supplies an oem string whose equivalent size as a
01482         unicode string <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to be calculated.  The oem string <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a>
01483         interpreted relative to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> current oem code page (OCP).
01484 
01485 Return Value:
01486 
01487     The <span class="keywordflow">return</span> value specifies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> number of bytes required to hold a
01488     <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> terminated unicode string equivalent to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified oem
01489     string.
01490 
01491 --*/
01492 
01493 {
01494     ULONG cbConverted;
01495 
01496     <a class="code" href="../../d5/d9/ntrtlp_8h.html#a12">RTL_PAGED_CODE</a>();
01497 
01498     <span class="comment">//</span>
01499     <span class="comment">// LATER:  Define an RtlOemToUnicodeSize.</span>
01500     <span class="comment">//         In the Japanese version, it's safe to call</span>
01501     <span class="comment">//         RtlMultiByteToUnicodeSize because the Ansi code page</span>
01502     <span class="comment">//         and the OEM code page are the same.</span>
01503     <span class="comment">//</span>
01504 
01505     <span class="comment">//</span>
01506     <span class="comment">// Get the size of the string - this call handles DBCS.</span>
01507     <span class="comment">//</span>
01508     <a class="code" href="../../d9/d6/nlsxlat_8c.html#a35">RtlMultiByteToUnicodeSize</a>( &amp;cbConverted,
01509                                OemString-&gt;Buffer,
01510                                OemString-&gt;Length );
01511 
01512     <span class="comment">//</span>
01513     <span class="comment">// Return the size in bytes.</span>
01514     <span class="comment">//</span>
01515     <span class="keywordflow">return</span> ( cbConverted + <span class="keyword">sizeof</span>(UNICODE_NULL) );
01516 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a37" doxytag="nls.c::RtlxUnicodeStringToAnsiSize" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG RtlxUnicodeStringToAnsiSize           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PUNICODE_STRING&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>UnicodeString</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d5/nls_8c-source.html#l01314">1314</a> of file <a class="el" href="../../d7/d5/nls_8c-source.html">nls.c</a>.
<p>
References <a class="el" href="../../d6/d8/ntrtlp_8h-source.html#l00246">RTL_PAGED_CODE</a>, and <a class="el" href="../../d0/d6/nlsxlat_8c-source.html#l00839">RtlUnicodeToMultiByteSize()</a>.
<p>
<pre class="fragment"><div>01320                    :
01321 
01322     This function computes <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> number of bytes required to store
01323     a <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> terminated ansi string that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> equivalent to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified
01324     unicode string. If an ansi string can not be formed, <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <span class="keywordflow">return</span> value
01325     <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> 0.
01326 
01327 Arguments:
01328 
01329     UnicodeString - Supplies a unicode string whose equivalent size as
01330         an ansi string <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to be calculated.
01331 
01332 Return Value:
01333 
01334     0 - The operation failed, <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> unicode string can not be translated
01335         into ansi <span class="keyword">using</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> current system locale therefore no storage
01336         <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> needed <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> ansi string.
01337 
01338     !0 - The operation was successful.  The <span class="keywordflow">return</span> value specifies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
01339         number of bytes required to hold an <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> terminated ansi string
01340         equivalent to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified unicode string.
01341 
01342 --*/
01343 
01344 {
01345     ULONG  cbMultiByteString;
01346 
01347     <a class="code" href="../../d5/d9/ntrtlp_8h.html#a12">RTL_PAGED_CODE</a>();
01348 
01349     <span class="comment">//</span>
01350     <span class="comment">// Get the size of the string - this call handles DBCS.</span>
01351     <span class="comment">//</span>
01352     <a class="code" href="../../d9/d6/nlsxlat_8c.html#a36">RtlUnicodeToMultiByteSize</a>( &amp;cbMultiByteString,
01353                                UnicodeString-&gt;Buffer,
01354                                UnicodeString-&gt;Length );
01355 
01356     <span class="comment">//</span>
01357     <span class="comment">// Return the size in bytes.</span>
01358     <span class="comment">//</span>
01359     <span class="keywordflow">return</span> (cbMultiByteString + 1);
01360 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a38" doxytag="nls.c::RtlxUnicodeStringToOemSize" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG RtlxUnicodeStringToOemSize           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PUNICODE_STRING&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>UnicodeString</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d5/nls_8c-source.html#l01364">1364</a> of file <a class="el" href="../../d7/d5/nls_8c-source.html">nls.c</a>.
<p>
References <a class="el" href="../../d6/d8/ntrtlp_8h-source.html#l00246">RTL_PAGED_CODE</a>, and <a class="el" href="../../d0/d6/nlsxlat_8c-source.html#l00839">RtlUnicodeToMultiByteSize()</a>.
<p>
<pre class="fragment"><div>01370                    :
01371 
01372     This function computes <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> number of bytes required to store
01373     a <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> terminated oem string that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> equivalent to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified
01374     unicode string. If an oem string can not be formed, <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <span class="keywordflow">return</span> value
01375     <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> 0.
01376 
01377 Arguments:
01378 
01379     UnicodeString - Supplies a unicode string whose equivalent size as
01380         an oem string <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to be calculated.
01381 
01382 Return Value:
01383 
01384     0 - The operation failed, <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> unicode string can not be translated
01385         into oem <span class="keyword">using</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> OEM code page therefore no storage <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a>
01386         needed <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> oem string.
01387 
01388     !0 - The operation was successful.  The <span class="keywordflow">return</span> value specifies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
01389         number of bytes required to hold an <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> terminated oem string
01390         equivalent to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified unicode string.
01391 
01392 --*/
01393 
01394 {
01395     ULONG  cbMultiByteString;
01396 
01397     <a class="code" href="../../d5/d9/ntrtlp_8h.html#a12">RTL_PAGED_CODE</a>();
01398 
01399     <span class="comment">//</span>
01400     <span class="comment">// LATER:  Define an RtlUnicodeToOemSize.</span>
01401     <span class="comment">//         In the Japanese version, it's safe to call</span>
01402     <span class="comment">//         RtlUnicodeToMultiByteSize because the Ansi code page</span>
01403     <span class="comment">//         and the OEM code page are the same.</span>
01404     <span class="comment">//</span>
01405 
01406     <span class="comment">//</span>
01407     <span class="comment">// Get the size of the string - this call handles DBCS.</span>
01408     <span class="comment">//</span>
01409     <a class="code" href="../../d9/d6/nlsxlat_8c.html#a36">RtlUnicodeToMultiByteSize</a>( &amp;cbMultiByteString,
01410                                UnicodeString-&gt;Buffer,
01411                                UnicodeString-&gt;Length );
01412 
01413     <span class="comment">//</span>
01414     <span class="comment">// Return the size in bytes.</span>
01415     <span class="comment">//</span>
01416     <span class="keywordflow">return</span> (cbMultiByteString + 1);
01417 }

</div></pre>    </td>
  </tr>
</table>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="a19" doxytag="nls.c::NlsAnsiToUnicodeData" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a22">PUSHORT</a> <a class="el" href="../../d2/d7/string_8c.html#a0">NlsAnsiToUnicodeData</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d5/nls_8c-source.html#l00068">68</a> of file <a class="el" href="../../d7/d5/nls_8c-source.html">nls.c</a>.
<p>
Referenced by <a class="el" href="../../d7/d5/nls_8c-source.html#l00171">RtlAnsiCharToUnicodeChar()</a>, <a class="el" href="../../d0/d6/nlsxlat_8c-source.html#l00115">RtlConsoleMultiByteToUnicodeN()</a>, <a class="el" href="../../d0/d6/nlsxlat_8c-source.html#l00369">RtlMultiByteToUnicodeN()</a>, <a class="el" href="../../d0/d6/nlsxlat_8c-source.html#l02454">RtlResetRtlTranslations()</a>, <a class="el" href="../../d0/d6/nlsxlat_8c-source.html#l01053">RtlUpcaseUnicodeToMultiByteN()</a>, and <a class="el" href="../../d3/d6/string_8c-source.html#l00250">RtlUpperChar()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a20" doxytag="nls.c::NlsLeadByteInfo" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a22">PUSHORT</a> <a class="el" href="../../d2/d7/string_8c.html#a2">NlsLeadByteInfo</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d5/nls_8c-source.html#l00069">69</a> of file <a class="el" href="../../d7/d5/nls_8c-source.html">nls.c</a>.
<p>
Referenced by <a class="el" href="../../d5/d3/prefix_8c-source.html#l00843">CompareNamesCaseSensitive()</a>, <a class="el" href="../../d5/d3/prefix_8c-source.html#l00750">ComputeNameLength()</a>, <a class="el" href="../../d7/d5/nls_8c-source.html#l00171">RtlAnsiCharToUnicodeChar()</a>, <a class="el" href="../../d0/d6/nlsxlat_8c-source.html#l00115">RtlConsoleMultiByteToUnicodeN()</a>, <a class="el" href="../../d7/d5/nls_8c-source.html#l02098">RtlIsTextUnicode()</a>, <a class="el" href="../../d0/d6/nlsxlat_8c-source.html#l00369">RtlMultiByteToUnicodeN()</a>, <a class="el" href="../../d0/d6/nlsxlat_8c-source.html#l00755">RtlMultiByteToUnicodeSize()</a>, <a class="el" href="../../d0/d6/nlsxlat_8c-source.html#l02454">RtlResetRtlTranslations()</a>, <a class="el" href="../../d0/d6/nlsxlat_8c-source.html#l01053">RtlUpcaseUnicodeToMultiByteN()</a>, and <a class="el" href="../../d3/d6/string_8c-source.html#l00250">RtlUpperChar()</a>.    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:44:50 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
