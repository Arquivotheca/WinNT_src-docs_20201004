<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: filobsup.c File Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>filobsup.c File Reference</h1><code>#include "UdfProcs.h"</code><br>

<p>
<a href="../../d7/d2/filobsup_8c-source.html">Go to the source code of this file.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d3/filobsup_8c.html#a0">BugCheckFileId</a>&nbsp;&nbsp;&nbsp;(UDFS_BUG_CHECK_FILOBSUP)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d3/filobsup_8c.html#a1">Dbg</a>&nbsp;&nbsp;&nbsp;(UDFS_DEBUG_LEVEL_FILOBSUP)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d3/filobsup_8c.html#a2">TYPE_OF_OPEN_MASK</a>&nbsp;&nbsp;&nbsp;(0x00000007)</td></tr>

<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d3/filobsup_8c.html#a3">UdfSetFileObject</a> (IN <a class="el" href="../../d0/d3/struct__IRP__CONTEXT.html">PIRP_CONTEXT</a> IrpContext, IN <a class="el" href="../../d9/d1/struct__FILE__OBJECT.html">PFILE_OBJECT</a> FileObject, IN <a class="el" href="../../d3/d8/udfprocs_8h.html#a109">TYPE_OF_OPEN</a> TypeOfOpen, IN <a class="el" href="../../d7/d9/struct__FCB.html">PFCB</a> Fcb OPTIONAL, IN <a class="el" href="../../d2/d9/struct__CCB.html">PCCB</a> Ccb OPTIONAL)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d3/d8/udfprocs_8h.html#a109">TYPE_OF_OPEN</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d3/filobsup_8c.html#a4">UdfDecodeFileObject</a> (IN <a class="el" href="../../d9/d1/struct__FILE__OBJECT.html">PFILE_OBJECT</a> FileObject, OUT <a class="el" href="../../d7/d9/struct__FCB.html">PFCB</a> *Fcb, OUT <a class="el" href="../../d2/d9/struct__CCB.html">PCCB</a> *Ccb)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d3/d8/udfprocs_8h.html#a109">TYPE_OF_OPEN</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d3/filobsup_8c.html#a5">UdfFastDecodeFileObject</a> (IN <a class="el" href="../../d9/d1/struct__FILE__OBJECT.html">PFILE_OBJECT</a> FileObject, OUT <a class="el" href="../../d7/d9/struct__FCB.html">PFCB</a> *Fcb)</td></tr>

</table>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="a0" doxytag="filobsup.c::BugCheckFileId" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define BugCheckFileId&nbsp;&nbsp;&nbsp;(UDFS_BUG_CHECK_FILOBSUP)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d2/filobsup_8c-source.html#l00027">27</a> of file <a class="el" href="../../d7/d2/filobsup_8c-source.html">filobsup.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="filobsup.c::Dbg" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define Dbg&nbsp;&nbsp;&nbsp;(UDFS_DEBUG_LEVEL_FILOBSUP)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d2/filobsup_8c-source.html#l00033">33</a> of file <a class="el" href="../../d7/d2/filobsup_8c-source.html">filobsup.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a2" doxytag="filobsup.c::TYPE_OF_OPEN_MASK" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define TYPE_OF_OPEN_MASK&nbsp;&nbsp;&nbsp;(0x00000007)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d2/filobsup_8c-source.html#l00039">39</a> of file <a class="el" href="../../d7/d2/filobsup_8c-source.html">filobsup.c</a>.
<p>
Referenced by <a class="el" href="../../d7/d2/filobsup_8c-source.html#l00133">UdfDecodeFileObject()</a>, <a class="el" href="../../d7/d2/filobsup_8c-source.html#l00201">UdfFastDecodeFileObject()</a>, and <a class="el" href="../../d7/d2/filobsup_8c-source.html#l00049">UdfSetFileObject()</a>.    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a4" doxytag="filobsup.c::UdfDecodeFileObject" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d3/d8/udfprocs_8h.html#a109">TYPE_OF_OPEN</a> UdfDecodeFileObject           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d9/d1/struct__FILE__OBJECT.html">PFILE_OBJECT</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>FileObject</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT <a class="el" href="../../d7/d9/struct__FCB.html">PFCB</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>Fcb</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT <a class="el" href="../../d2/d9/struct__CCB.html">PCCB</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>Ccb</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d2/filobsup_8c-source.html#l00133">133</a> of file <a class="el" href="../../d7/d2/filobsup_8c-source.html">filobsup.c</a>.
<p>
References <a class="el" href="../../d6/d4/cc_8h-source.html#l00509">ClearFlag</a>, <a class="el" href="../../d6/d4/cc_8h-source.html#l00497">FlagOn</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d1/d8/ntosdef_8h-source.html#l00462">PAGED_CODE</a>, <a class="el" href="../../d3/d8/udfprocs_8h.html#a109">TYPE_OF_OPEN</a>, <a class="el" href="../../d7/d2/filobsup_8c-source.html#l00039">TYPE_OF_OPEN_MASK</a>, and <a class="el" href="../../d3/d8/udfprocs_8h.html#a263a113">UnopenedFileObject</a>.
<p>
Referenced by <a class="el" href="../../d9/d6/udfs_2cleanup_8c-source.html#l00042">UdfCommonCleanup()</a>, <a class="el" href="../../d3/d8/close_8c-source.html#l00319">UdfCommonClose()</a>, <a class="el" href="../../d4/d7/udfs_2create_8c-source.html#l00108">UdfCommonCreate()</a>, <a class="el" href="../../d3/d6/udfs_2devctrl_8c-source.html#l00069">UdfCommonDevControl()</a>, <a class="el" href="../../d2/d7/dirctrl_8c-source.html#l00255">UdfCommonDirControl()</a>, <a class="el" href="../../d3/d4/lockctrl_8c-source.html#l00046">UdfCommonLockControl()</a>, <a class="el" href="../../d5/d2/fileinfo_8c-source.html#l00156">UdfCommonQueryInfo()</a>, <a class="el" href="../../d8/d5/volinfo_8c-source.html#l00082">UdfCommonQueryVolInfo()</a>, <a class="el" href="../../d8/d4/udfs_2read_8c-source.html#l00068">UdfCommonRead()</a>, <a class="el" href="../../d5/d2/fileinfo_8c-source.html#l00385">UdfCommonSetInfo()</a>, <a class="el" href="../../d0/d7/udfs_2fsctrl_8c-source.html#l00966">UdfDismountVolume()</a>, <a class="el" href="../../d5/d2/fileinfo_8c-source.html#l00496">UdfFastQueryBasicInfo()</a>, <a class="el" href="../../d5/d2/fileinfo_8c-source.html#l00740">UdfFastQueryNetworkInfo()</a>, <a class="el" href="../../d0/d7/udfs_2fsctrl_8c-source.html#l01064">UdfIsVolumeDirty()</a>, <a class="el" href="../../d0/d7/udfs_2fsctrl_8c-source.html#l01175">UdfIsVolumeMounted()</a>, <a class="el" href="../../d0/d7/udfs_2fsctrl_8c-source.html#l00780">UdfLockVolume()</a>, <a class="el" href="../../d0/d7/udfs_2fsctrl_8c-source.html#l00470">UdfOplockRequest()</a>, and <a class="el" href="../../d0/d7/udfs_2fsctrl_8c-source.html#l00877">UdfUnlockVolume()</a>.
<p>
<pre class="fragment"><div>00141                    :
00142 
00143     This routine takes a <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a9">file</a> object and extracts <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> Fcb and Ccb (possibly NULL)
00144     and returns <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> of open.
00145 
00146 Arguments:
00147 
00148     FileObject - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a9">file</a> object pointer being initialized.
00149 
00150     Fcb - Address to store <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> Fcb contained in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a9">file</a> object.
00151 
00152     Ccb - Address to store <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> Ccb contained in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a9">file</a> object.
00153 
00154 Return Value:
00155 
00156     <a class="code" href="../../d3/d8/udfprocs_8h.html#a109">TYPE_OF_OPEN</a> - Indicates <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> of <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a9">file</a> object.
00157 
00158 --*/
00159 
00160 {
00161     <a class="code" href="../../d3/d8/udfprocs_8h.html#a109">TYPE_OF_OPEN</a> TypeOfOpen;
00162 
00163     <a class="code" href="../../d0/d9/ntosdef_8h.html#a28">PAGED_CODE</a>();
00164 
00165     <span class="comment">//</span>
00166     <span class="comment">//  If this is an unopened file object then return NULL for the</span>
00167     <span class="comment">//  Fcb/Ccb.  Don't trust any other values in the file object.</span>
00168     <span class="comment">//</span>
00169 
00170     TypeOfOpen = (<a class="code" href="../../d3/d8/udfprocs_8h.html#a109">TYPE_OF_OPEN</a>) <a class="code" href="../../d5/d5/cc_8h.html#a58">FlagOn</a>( (ULONG_PTR) FileObject-&gt;FsContext2,
00171                                         TYPE_OF_OPEN_MASK );
00172 
00173     <span class="keywordflow">if</span> (TypeOfOpen == <a class="code" href="../../d3/d8/udfprocs_8h.html#a263a113">UnopenedFileObject</a>) {
00174 
00175         *Fcb = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00176         *Ccb = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00177 
00178     } <span class="keywordflow">else</span> {
00179 
00180         <span class="comment">//</span>
00181         <span class="comment">//  The Fcb is pointed to by the FsContext field.  The Ccb is in</span>
00182         <span class="comment">//  FsContext2 (after clearing the low three bits).  The low three</span>
00183         <span class="comment">//  bits are the file object type.</span>
00184         <span class="comment">//</span>
00185 
00186         *Fcb = FileObject-&gt;FsContext;
00187         *Ccb = FileObject-&gt;FsContext2;
00188 
00189         <a class="code" href="../../d5/d5/cc_8h.html#a61">ClearFlag</a>( (ULONG_PTR) *Ccb, TYPE_OF_OPEN_MASK );
00190     }
00191 
00192     <span class="comment">//</span>
00193     <span class="comment">//  Now return the type of open.</span>
00194     <span class="comment">//</span>
00195 
00196     <span class="keywordflow">return</span> TypeOfOpen;
00197 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a5" doxytag="filobsup.c::UdfFastDecodeFileObject" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d3/d8/udfprocs_8h.html#a109">TYPE_OF_OPEN</a> UdfFastDecodeFileObject           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d9/d1/struct__FILE__OBJECT.html">PFILE_OBJECT</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>FileObject</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT <a class="el" href="../../d7/d9/struct__FCB.html">PFCB</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>Fcb</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d2/filobsup_8c-source.html#l00201">201</a> of file <a class="el" href="../../d7/d2/filobsup_8c-source.html">filobsup.c</a>.
<p>
References <a class="el" href="../../d2/d7/udfdata_8h-source.html#l00358">ASSERT_FILE_OBJECT</a>, <a class="el" href="../../d6/d4/cc_8h-source.html#l00497">FlagOn</a>, <a class="el" href="../../d1/d8/ntosdef_8h-source.html#l00462">PAGED_CODE</a>, <a class="el" href="../../d3/d8/udfprocs_8h.html#a109">TYPE_OF_OPEN</a>, and <a class="el" href="../../d7/d2/filobsup_8c-source.html#l00039">TYPE_OF_OPEN_MASK</a>.
<p>
Referenced by <a class="el" href="../../d3/d4/lockctrl_8c-source.html#l00152">UdfFastLock()</a>, <a class="el" href="../../d5/d2/fileinfo_8c-source.html#l00614">UdfFastQueryStdInfo()</a>, <a class="el" href="../../d3/d4/lockctrl_8c-source.html#l00436">UdfFastUnlockAll()</a>, <a class="el" href="../../d3/d4/lockctrl_8c-source.html#l00557">UdfFastUnlockAllByKey()</a>, and <a class="el" href="../../d3/d4/lockctrl_8c-source.html#l00297">UdfFastUnlockSingle()</a>.
<p>
<pre class="fragment"><div>00208                    :
00209 
00210     This <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a69">procedure</a> takes a pointer to a <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a9">file</a> object, that has already been
00211     opened by Udfs and does a quick decode operation.  It will <a class="code" href="../../d3/d0/imm32_8def.html#a1">only</a> <span class="keywordflow">return</span>
00212     a non null value <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a9">file</a> object <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> a user <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a9">file</a> open
00213 
00214 Arguments:
00215 
00216     FileObject - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a9">file</a> object pointer being interrogated
00217 
00218     Fcb - Address to store Fcb <span class="keywordflow">if</span> <span class="keyword">this</span> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> a user <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a9">file</a> object.  <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>
00219         otherwise.
00220 
00221 Return Value:
00222 
00223     <a class="code" href="../../d3/d8/udfprocs_8h.html#a109">TYPE_OF_OPEN</a> - <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> of open of <span class="keyword">this</span> <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a9">file</a> object.
00224 
00225 --*/
00226 
00227 {
00228     <a class="code" href="../../d0/d9/ntosdef_8h.html#a28">PAGED_CODE</a>();
00229 
00230     <a class="code" href="../../d1/d8/udfdata_8h.html#a34">ASSERT_FILE_OBJECT</a>( FileObject );
00231 
00232     <span class="comment">//</span>
00233     <span class="comment">//  The Fcb is in the FsContext field.  The type of open is in the low</span>
00234     <span class="comment">//  bits of the Ccb.</span>
00235     <span class="comment">//</span>
00236 
00237     *Fcb = FileObject-&gt;FsContext;
00238 
00239     <span class="keywordflow">return</span> (<a class="code" href="../../d3/d8/udfprocs_8h.html#a109">TYPE_OF_OPEN</a>) <a class="code" href="../../d5/d5/cc_8h.html#a58">FlagOn</a>( (ULONG_PTR) FileObject-&gt;FsContext2, TYPE_OF_OPEN_MASK );
00240 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="filobsup.c::UdfSetFileObject" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID UdfSetFileObject           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d0/d3/struct__IRP__CONTEXT.html">PIRP_CONTEXT</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>IrpContext</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d9/d1/struct__FILE__OBJECT.html">PFILE_OBJECT</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>FileObject</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d3/d8/udfprocs_8h.html#a109">TYPE_OF_OPEN</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>TypeOfOpen</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d7/d9/struct__FCB.html">PFCB</a> Fcb&nbsp;</td>
          <td class="mdname" nowrap> <em>OPTIONAL</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d2/d9/struct__CCB.html">PCCB</a> Ccb&nbsp;</td>
          <td class="mdname" nowrap> <em>OPTIONAL</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d2/filobsup_8c-source.html#l00049">49</a> of file <a class="el" href="../../d7/d2/filobsup_8c-source.html">filobsup.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00147">ASSERTMSG</a>, <a class="el" href="../../d3/d8/udfprocs_8h.html#a263a118">BeyondValidType</a>, <a class="el" href="../../d6/d4/cc_8h-source.html#l00497">FlagOn</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d1/d8/ntosdef_8h-source.html#l00462">PAGED_CODE</a>, <a class="el" href="../../d6/d4/cc_8h-source.html#l00505">SetFlag</a>, <a class="el" href="../../d7/d2/filobsup_8c-source.html#l00039">TYPE_OF_OPEN_MASK</a>, and <a class="el" href="../../d3/d8/udfprocs_8h.html#a263a113">UnopenedFileObject</a>.
<p>
Referenced by <a class="el" href="../../d4/d7/udfs_2create_8c-source.html#l01955">UdfCompleteFcbOpen()</a>, and <a class="el" href="../../d9/d1/udfs_2cachesup_8c-source.html#l00046">UdfCreateInternalStream()</a>.
<p>
<pre class="fragment"><div>00059                    :
00060 
00061     This routine will initialize <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> FileObject context fields based on <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00062     input <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> and data structures.
00063 
00064 Arguments:
00065 
00066     FileObject - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a9">file</a> object pointer being initialized.
00067 
00068     TypeOfOpen - Sets <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> of open.
00069 
00070     Fcb - Fcb <span class="keywordflow">for</span> <span class="keyword">this</span> <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a9">file</a> object.  Ignored <span class="keywordflow">for</span> <a class="code" href="../../d3/d8/udfprocs_8h.html#a263a113">UnopenedFileObject</a>.
00071 
00072     Ccb - Ccb <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> handle corresponding to <span class="keyword">this</span> <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a9">file</a> object.  Will not
00073         be present <span class="keywordflow">for</span> stream <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a9">file</a> objects.
00074 
00075 Return Value:
00076 
00077     None.
00078 
00079 --*/
00080 
00081 {
00082     <a class="code" href="../../d0/d9/ntosdef_8h.html#a28">PAGED_CODE</a>();
00083 
00084     <span class="comment">//</span>
00085     <span class="comment">//  We only have values 0 to 7 available so make sure we didn't</span>
00086     <span class="comment">//  inadvertantly add a new type.</span>
00087     <span class="comment">//</span>
00088 
00089     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a8">ASSERTMSG</a>( <span class="stringliteral">"FileObject types exceed available bits\n"</span>, BeyondValidType &lt;= 8 );
00090 
00091     <span class="comment">//</span>
00092     <span class="comment">//  Setting a file object to type UnopenedFileObject means just</span>
00093     <span class="comment">//  clearing all of the context fields.  All the other input</span>
00094     <span class="comment">//</span>
00095 
00096     <span class="keywordflow">if</span> (TypeOfOpen == <a class="code" href="../../d3/d8/udfprocs_8h.html#a263a113">UnopenedFileObject</a>) {
00097 
00098         FileObject-&gt;FsContext =
00099         FileObject-&gt;FsContext2 = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00100 
00101         <span class="keywordflow">return</span>;
00102     }
00103 
00104     <span class="comment">//</span>
00105     <span class="comment">//  Check that the 3 low-order bits of the Ccb are clear.</span>
00106     <span class="comment">//</span>
00107 
00108     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a8">ASSERTMSG</a>( <span class="stringliteral">"Ccb is not quad-aligned\n"</span>, !<a class="code" href="../../d5/d5/cc_8h.html#a58">FlagOn</a>( ((ULONG_PTR) Ccb), TYPE_OF_OPEN_MASK ));
00109 
00110     <span class="comment">//</span>
00111     <span class="comment">//  We will or the type of open into the low order bits of FsContext2</span>
00112     <span class="comment">//  along with the Ccb value.</span>
00113     <span class="comment">//  The Fcb is stored into the FsContext field.</span>
00114     <span class="comment">//</span>
00115 
00116     FileObject-&gt;FsContext = Fcb;
00117     FileObject-&gt;FsContext2 = Ccb;
00118 
00119     <a class="code" href="../../d5/d5/cc_8h.html#a60">SetFlag</a>( ((ULONG_PTR) FileObject-&gt;FsContext2), TypeOfOpen );
00120 
00121     <span class="comment">//</span>
00122     <span class="comment">//  Set the Vpb field in the file object.</span>
00123     <span class="comment">//</span>
00124 
00125     FileObject-&gt;Vpb = Fcb-&gt;Vcb-&gt;Vpb;
00126 
00127     <span class="keywordflow">return</span>;
00128 }

</div></pre>    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:43:40 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
