<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: pnpeisa.c Source File</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>pnpeisa.c</h1><a href="../../d5/d0/pnpeisa_8c.html">Go to the documentation of this file.</a><pre class="fragment"><div>00001 <span class="comment">/*++</span>
00002 <span class="comment"></span>
00003 <span class="comment">Copyright (c) 1990  Microsoft Corporation</span>
00004 <span class="comment"></span>
00005 <span class="comment">Module Name:</span>
00006 <span class="comment"></span>
00007 <span class="comment">    PnpEisa.c</span>
00008 <span class="comment"></span>
00009 <span class="comment">Abstract:</span>
00010 <span class="comment"></span>
00011 <span class="comment">    This file implements Eisa related code.</span>
00012 <span class="comment"></span>
00013 <span class="comment">Author:</span>
00014 <span class="comment"></span>
00015 <span class="comment">    Shie-Lin Tzong (shielint)</span>
00016 <span class="comment"></span>
00017 <span class="comment">Environment:</span>
00018 <span class="comment"></span>
00019 <span class="comment">    Kernel Mode.</span>
00020 <span class="comment"></span>
00021 <span class="comment">Notes:</span>
00022 <span class="comment"></span>
00023 <span class="comment">Revision History:</span>
00024 <span class="comment"></span>
00025 <span class="comment">--*/</span>
00026 
00027 <span class="preprocessor">#include "<a class="code" href="../../d0/d6/iop_8h.html">iop.h</a>"</span>
00028 <span class="preprocessor">#pragma hdrstop</span>
00029 <span class="preprocessor"></span>
00030 <span class="preprocessor">#ifdef POOL_TAGGING</span>
00031 <span class="preprocessor"></span><span class="preprocessor">#undef ExAllocatePool</span>
00032 <span class="preprocessor"></span><span class="preprocessor">#define ExAllocatePool(a,b) ExAllocatePoolWithTag(a,b,'iepP')</span>
00033 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00034 <span class="preprocessor"></span>
<a name="l00035"></a><a class="code" href="../../d5/d0/pnpeisa_8c.html#a0">00035</a> <span class="preprocessor">#define EISA_DEVICE_NODE_NAME L"EisaResources"</span>
<a name="l00036"></a><a class="code" href="../../d5/d0/pnpeisa_8c.html#a1">00036</a> <span class="preprocessor"></span><span class="preprocessor">#define BUFFER_LENGTH 50</span>
00037 <span class="preprocessor"></span>
00038 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
00039 <a class="code" href="../../d5/d0/pnpeisa_8c.html#a2">EisaGetEisaDevicesResources</a> (
00040     OUT PCM_RESOURCE_LIST *ResourceList,
00041     OUT PULONG ResourceLength
00042     );
00043 
00044 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
00045 <a class="code" href="../../d5/d0/pnpeisa_8c.html#a3">EisaBuildSlotsResources</a> (
00046     IN ULONG SlotMasks,
00047     IN ULONG NumberMasks,
00048     OUT PCM_RESOURCE_LIST *Resource,
00049     OUT ULONG *Length
00050     );
00051 
00052 <span class="preprocessor">#ifdef ALLOC_PRAGMA</span>
00053 <span class="preprocessor"></span><span class="preprocessor">#pragma alloc_text(INIT, EisaBuildEisaDeviceNode)</span>
00054 <span class="preprocessor"></span><span class="preprocessor">#pragma alloc_text(INIT, EisaGetEisaDevicesResources)</span>
00055 <span class="preprocessor"></span><span class="preprocessor">#pragma alloc_text(INIT, EisaBuildSlotsResources)</span>
00056 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00057 <span class="preprocessor"></span>
00058 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
<a name="l00059"></a><a class="code" href="../../d9/d0/pnpiop_8h.html#a341">00059</a> <a class="code" href="../../d9/d0/pnpiop_8h.html#a341">EisaBuildEisaDeviceNode</a> (
00060     VOID
00061     )
00062 
00063 <span class="comment">/*++</span>
00064 <span class="comment"></span>
00065 <span class="comment">Routine Description:</span>
00066 <span class="comment"></span>
00067 <span class="comment">    This routine build an registry key to report eisa resources to arbiters.</span>
00068 <span class="comment"></span>
00069 <span class="comment">Arguments:</span>
00070 <span class="comment"></span>
00071 <span class="comment">    None.</span>
00072 <span class="comment"></span>
00073 <span class="comment">Return Value:</span>
00074 <span class="comment"></span>
00075 <span class="comment">    NTSTATUS code.</span>
00076 <span class="comment"></span>
00077 <span class="comment">--*/</span>
00078 
00079 {
00080     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>            status;
00081     ULONG               disposition, tmpValue;
00082     WCHAR               buffer[<a class="code" href="../../d5/d0/pnpeisa_8c.html#a1">BUFFER_LENGTH</a>];
00083 
00084     UNICODE_STRING      unicodeString;
00085     HANDLE              rootHandle, deviceHandle, instanceHandle, logConfHandle;
00086 
00087     PCM_RESOURCE_LIST   resourceList;
00088     ULONG               resourceLength;
00089 
00090     status = <a class="code" href="../../d5/d0/pnpeisa_8c.html#a2">EisaGetEisaDevicesResources</a>(&amp;resourceList, &amp;resourceLength);
00091     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(status) || resourceList == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00092         <span class="keywordflow">return</span> STATUS_UNSUCCESSFUL;
00093     }
00094 
00095     <a class="code" href="../../d2/d7/string_8c.html#a7">RtlInitUnicodeString</a>(&amp;unicodeString, <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="stringliteral">"\\Registry\\Machine\\System\\CurrentControlSet\\Enum\\Root"</span>);
00096     status = <a class="code" href="../../d9/d1/pnpsubs_8c.html#a7">IopOpenRegistryKeyEx</a>( &amp;rootHandle,
00097                                    <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>,
00098                                    &amp;unicodeString,
00099                                    KEY_ALL_ACCESS
00100                                    );
00101 
00102     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(status)) {
00103         <span class="keywordflow">if</span> (resourceList) {
00104             <a class="code" href="../../d5/d8/ex_8h.html#a224">ExFreePool</a> (resourceList);
00105         }
00106         <span class="keywordflow">return</span> status;
00107     }
00108 
00109     <a class="code" href="../../d2/d7/string_8c.html#a7">RtlInitUnicodeString</a>(&amp;unicodeString, <a class="code" href="../../d5/d0/pnpeisa_8c.html#a0">EISA_DEVICE_NODE_NAME</a>);
00110     status = <a class="code" href="../../d9/d1/pnpsubs_8c.html#a8">IopCreateRegistryKeyEx</a>( &amp;deviceHandle,
00111                                      rootHandle,
00112                                      &amp;unicodeString,
00113                                      KEY_ALL_ACCESS,
00114                                      REG_OPTION_NON_VOLATILE,
00115                                      <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>
00116                                      );
00117 
00118     ZwClose(rootHandle);
00119     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(status)) {
00120         <span class="keywordflow">if</span> (resourceList) {
00121             <a class="code" href="../../d5/d8/ex_8h.html#a224">ExFreePool</a> (resourceList);
00122         }
00123         <span class="keywordflow">return</span> status;
00124     }
00125 
00126     <a class="code" href="../../d2/d7/string_8c.html#a7">RtlInitUnicodeString</a>( &amp;unicodeString, <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="stringliteral">"0000"</span> );
00127     status = <a class="code" href="../../d9/d1/pnpsubs_8c.html#a8">IopCreateRegistryKeyEx</a>( &amp;instanceHandle,
00128                                      deviceHandle,
00129                                      &amp;unicodeString,
00130                                      KEY_ALL_ACCESS,
00131                                      REG_OPTION_NON_VOLATILE,
00132                                      &amp;disposition );
00133     ZwClose(deviceHandle);
00134     <span class="keywordflow">if</span> (<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(status))  {
00135         <span class="keywordflow">if</span> (disposition == REG_CREATED_NEW_KEY) {
00136 
00137             <a class="code" href="../../d2/d7/string_8c.html#a7">RtlInitUnicodeString</a>( &amp;unicodeString, <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="stringliteral">"DeviceDesc"</span> );
00138             swprintf(buffer, <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="stringliteral">"%s"</span>, <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="stringliteral">"Device to report Eisa Slot Resources"</span>);
00139 
00140             ZwSetValueKey(instanceHandle,
00141                           &amp;unicodeString,
00142                           0,
00143                           REG_SZ,
00144                           buffer,
00145                           (wcslen(buffer) + 1) * <span class="keyword">sizeof</span>(WCHAR)
00146                           );
00147 
00148             <a class="code" href="../../d2/d7/string_8c.html#a7">RtlInitUnicodeString</a>( &amp;unicodeString, <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="stringliteral">"HardwareID"</span> );
00149             RtlZeroMemory(buffer, <a class="code" href="../../d5/d0/pnpeisa_8c.html#a1">BUFFER_LENGTH</a> * <span class="keyword">sizeof</span>(WCHAR));
00150             swprintf(buffer, <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="stringliteral">"%s"</span>, <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="stringliteral">"*Eisa_Resource_Device"</span>);
00151 
00152             ZwSetValueKey(instanceHandle,
00153                           &amp;unicodeString,
00154                           0,
00155                           REG_MULTI_SZ,
00156                           buffer,
00157                           (wcslen(buffer) + 2) * <span class="keyword">sizeof</span>(WCHAR)
00158                           );
00159 
00160             PiWstrToUnicodeString(&amp;unicodeString, REGSTR_VALUE_CONFIG_FLAGS);
00161             tmpValue = 0;
00162             ZwSetValueKey(instanceHandle,
00163                          &amp;unicodeString,
00164                          <a class="code" href="../../d4/d1/config_2alpha_2init_8c.html#a0">TITLE_INDEX_VALUE</a>,
00165                          REG_DWORD,
00166                          &amp;tmpValue,
00167                          <span class="keyword">sizeof</span>(tmpValue)
00168                          );
00169 
00170         }
00171 
00172         <a class="code" href="../../d2/d7/string_8c.html#a7">RtlInitUnicodeString</a>( &amp;unicodeString, REGSTR_KEY_LOGCONF );
00173         status = <a class="code" href="../../d9/d1/pnpsubs_8c.html#a8">IopCreateRegistryKeyEx</a>( &amp;logConfHandle,
00174                                          instanceHandle,
00175                                          &amp;unicodeString,
00176                                          KEY_ALL_ACCESS,
00177                                          REG_OPTION_NON_VOLATILE,
00178                                          <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>
00179                                          );
00180         ZwClose(instanceHandle);
00181         <span class="keywordflow">if</span> (<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(status))  {
00182             <a class="code" href="../../d2/d7/string_8c.html#a7">RtlInitUnicodeString</a>( &amp;unicodeString, REGSTR_VAL_BOOTCONFIG );
00183 
00184             status = ZwSetValueKey(logConfHandle,
00185                                    &amp;unicodeString,
00186                                    0,
00187                                    REG_RESOURCE_LIST,
00188                                    resourceList,
00189                                    resourceLength
00190                                    );
00191             ZwClose(logConfHandle);
00192         }
00193     }
00194     <span class="keywordflow">if</span> (resourceList) {
00195         <a class="code" href="../../d5/d8/ex_8h.html#a224">ExFreePool</a> (resourceList);
00196     }
00197     <span class="keywordflow">return</span> status;
00198 }
00199 
00200 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
<a name="l00201"></a><a class="code" href="../../d5/d0/pnpeisa_8c.html#a2">00201</a> <a class="code" href="../../d5/d0/pnpeisa_8c.html#a2">EisaGetEisaDevicesResources</a> (
00202     OUT PCM_RESOURCE_LIST *ResourceList,
00203     OUT PULONG ResourceLength
00204     )
00205 
00206 <span class="comment">/*++</span>
00207 <span class="comment"></span>
00208 <span class="comment">Routine Description:</span>
00209 <span class="comment"></span>
00210 <span class="comment">    This routine builds a cm resource list for all the eisa slots.</span>
00211 <span class="comment"></span>
00212 <span class="comment">Arguments:</span>
00213 <span class="comment"></span>
00214 <span class="comment">    None.</span>
00215 <span class="comment"></span>
00216 <span class="comment">Return Value:</span>
00217 <span class="comment"></span>
00218 <span class="comment">    A CmResourceList.</span>
00219 <span class="comment"></span>
00220 <span class="comment">--*/</span>
00221 
00222 {
00223     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> status = STATUS_SUCCESS;
00224     PCM_RESOURCE_LIST resources = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00225     HANDLE handle;
00226     PKEY_VALUE_FULL_INFORMATION keyValueInformation;
00227     UNICODE_STRING unicodeString;
00228     ULONG slotMasks = 0, numberMasks = 0, i;
00229 
00230     *ResourceList = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00231     *ResourceLength = 0;
00232 
00233     <span class="comment">//</span>
00234     <span class="comment">// Open LocalMachine\Hardware\Description</span>
00235     <span class="comment">//</span>
00236 
00237     <span class="comment">//RtlInitUnicodeString(&amp;unicodeString, L"\\REGISTRY\\MACHINE\\HARDWARE\\DESCRIPTION\\SYSTEM\\EisaAdapter\\0");</span>
00238     <a class="code" href="../../d2/d7/string_8c.html#a7">RtlInitUnicodeString</a>(&amp;unicodeString, <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="stringliteral">"\\REGISTRY\\MACHINE\\SYSTEM\\CurrentControlSet\\EisaAdapter"</span>);
00239     status = <a class="code" href="../../d9/d1/pnpsubs_8c.html#a7">IopOpenRegistryKeyEx</a>( &amp;handle,
00240                                    <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>,
00241                                    &amp;unicodeString,
00242                                    KEY_READ
00243                                    );
00244     <span class="keywordflow">if</span> (<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(status)) {
00245         status = <a class="code" href="../../d6/d5/ioep_8h.html#a52">IopGetRegistryValue</a>(handle,
00246                                      <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="stringliteral">"Configuration Data"</span>,
00247                                      &amp;keyValueInformation
00248                                      );
00249         <span class="keywordflow">if</span> (<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(status)) {
00250             PCM_FULL_RESOURCE_DESCRIPTOR resourceDescriptor;
00251             PCM_PARTIAL_RESOURCE_DESCRIPTOR partialResourceDescriptor;
00252 
00253             resourceDescriptor = (PCM_FULL_RESOURCE_DESCRIPTOR)
00254                 ((PUCHAR) keyValueInformation + keyValueInformation-&gt;DataOffset);
00255 
00256             <span class="keywordflow">if</span> ((keyValueInformation-&gt;DataLength &gt;= <span class="keyword">sizeof</span>(CM_FULL_RESOURCE_DESCRIPTOR)) &amp;&amp;
00257                 (resourceDescriptor-&gt;PartialResourceList.Count &gt; 0) ) {
00258                 LONG eisaInfoLength;
00259                 PCM_EISA_SLOT_INFORMATION eisaInfo;
00260 
00261                 partialResourceDescriptor = resourceDescriptor-&gt;PartialResourceList.PartialDescriptors;
00262                 <span class="keywordflow">if</span> (partialResourceDescriptor-&gt;Type == CmResourceTypeDeviceSpecific) {
00263                     eisaInfo = (PCM_EISA_SLOT_INFORMATION)
00264                         ((PUCHAR)partialResourceDescriptor + <span class="keyword">sizeof</span>(CM_PARTIAL_RESOURCE_DESCRIPTOR));
00265                     eisaInfoLength = (LONG)partialResourceDescriptor-&gt;u.DeviceSpecificData.DataSize;
00266 
00267                     <span class="comment">//</span>
00268                     <span class="comment">// Parse the eisa slot info to find the eisa slots with device installed.</span>
00269                     <span class="comment">//</span>
00270 
00271                     <span class="keywordflow">for</span> (i = 0; i &lt; 0x10 &amp;&amp; eisaInfoLength &gt; 0; i++) {
00272                         <span class="keywordflow">if</span> (eisaInfo-&gt;ReturnCode == EISA_INVALID_SLOT) {
00273                             <span class="keywordflow">break</span>;
00274                         }
00275                         <span class="keywordflow">if</span> (eisaInfo-&gt;ReturnCode != EISA_EMPTY_SLOT &amp;&amp; (i != 0)) {
00276                             slotMasks |= (1 &lt;&lt; i);
00277                             numberMasks++;
00278                         }
00279                         <span class="keywordflow">if</span> (eisaInfo-&gt;ReturnCode == EISA_EMPTY_SLOT) {
00280                             eisaInfoLength -= <span class="keyword">sizeof</span>(CM_EISA_SLOT_INFORMATION);
00281                             eisaInfo++;
00282                         } <span class="keywordflow">else</span> {
00283                             eisaInfoLength -= <span class="keyword">sizeof</span>(CM_EISA_SLOT_INFORMATION) + eisaInfo-&gt;NumberFunctions * <span class="keyword">sizeof</span>(CM_EISA_FUNCTION_INFORMATION);
00284                             eisaInfo = (PCM_EISA_SLOT_INFORMATION)
00285                                        ((PUCHAR)eisaInfo + eisaInfo-&gt;NumberFunctions * <span class="keyword">sizeof</span>(CM_EISA_FUNCTION_INFORMATION) +
00286                                            <span class="keyword">sizeof</span>(CM_EISA_SLOT_INFORMATION));
00287                         }
00288                     }
00289 
00290                     <span class="keywordflow">if</span> (slotMasks) {
00291                         status = <a class="code" href="../../d5/d0/pnpeisa_8c.html#a3">EisaBuildSlotsResources</a>(slotMasks, numberMasks, ResourceList, ResourceLength);
00292                     }
00293                 }
00294 
00295             }
00296             <a class="code" href="../../d5/d8/ex_8h.html#a224">ExFreePool</a>(keyValueInformation);
00297         }
00298         ZwClose(handle);
00299     }
00300     <span class="keywordflow">return</span> status;
00301 }
00302 
00303 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
<a name="l00304"></a><a class="code" href="../../d5/d0/pnpeisa_8c.html#a3">00304</a> <a class="code" href="../../d5/d0/pnpeisa_8c.html#a3">EisaBuildSlotsResources</a> (
00305     IN ULONG SlotMasks,
00306     IN ULONG NumberMasks,
00307     OUT PCM_RESOURCE_LIST *Resources,
00308     OUT ULONG *Length
00309     )
00310 
00311 <span class="comment">/*++</span>
00312 <span class="comment"></span>
00313 <span class="comment">Routine Description:</span>
00314 <span class="comment"></span>
00315 <span class="comment">    This routine build a cm resource list for all the io resources used</span>
00316 <span class="comment">    by the eisa devices.</span>
00317 <span class="comment"></span>
00318 <span class="comment">Arguments:</span>
00319 <span class="comment"></span>
00320 <span class="comment">    SlotMask - a mask to indicate the valid eisa slot.</span>
00321 <span class="comment"></span>
00322 <span class="comment">Return Value:</span>
00323 <span class="comment"></span>
00324 <span class="comment">    A pointer to a CM_RESOURCE_LIST.</span>
00325 <span class="comment"></span>
00326 <span class="comment">--*/</span>
00327 
00328 {
00329     PCM_RESOURCE_LIST resources = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00330     PCM_PARTIAL_RESOURCE_DESCRIPTOR partialDesc;
00331     ULONG slot;
00332 
00333     *Length = <span class="keyword">sizeof</span>(CM_RESOURCE_LIST) + <span class="keyword">sizeof</span>(CM_PARTIAL_RESOURCE_DESCRIPTOR) * (NumberMasks - 1);
00334     resources = <a class="code" href="../../d5/d5/cc_8h.html#a10">ExAllocatePool</a>(<a class="code" href="../../d5/d8/ex_8h.html#a329a174">PagedPool</a>, *Length);
00335     <span class="keywordflow">if</span> (resources) {
00336         resources-&gt;Count = 1;
00337         resources-&gt;List[0].InterfaceType = Eisa;
00338         resources-&gt;List[0].BusNumber = 0;
00339         resources-&gt;List[0].PartialResourceList.Version = 0;
00340         resources-&gt;List[0].PartialResourceList.Revision = 0;
00341         resources-&gt;List[0].PartialResourceList.Count = NumberMasks;
00342         partialDesc = resources-&gt;List[0].PartialResourceList.PartialDescriptors;
00343         slot = 0; <span class="comment">// ignore slot 0</span>
00344         <span class="keywordflow">while</span> (SlotMasks) {
00345             SlotMasks &gt;&gt;= 1;
00346             slot++;
00347             <span class="keywordflow">if</span> (SlotMasks &amp; 1) {
00348                 partialDesc-&gt;Type = CmResourceTypePort;
00349                 partialDesc-&gt;ShareDisposition = CmResourceShareDeviceExclusive;
00350                 partialDesc-&gt;Flags = CM_RESOURCE_PORT_16_BIT_DECODE + CM_RESOURCE_PORT_IO;
00351                 partialDesc-&gt;u.Port.Start.LowPart = slot &lt;&lt; 12;
00352                 partialDesc-&gt;u.Port.Start.HighPart = 0;
00353                 partialDesc-&gt;u.Port.Length = 0x1000;
00354                 partialDesc++;
00355             }
00356         }
00357         *Resources = resources;
00358         <span class="keywordflow">return</span> STATUS_SUCCESS;
00359     } <span class="keywordflow">else</span> {
00360         <span class="keywordflow">return</span> STATUS_NO_MEMORY;
00361     }
00362 }
</div></pre><hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:41:16 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
