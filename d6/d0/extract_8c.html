<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: extract.c File Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>extract.c File Reference</h1><code>#include "<a class="el" href="../../d8/d2/w32_2ntuser_2client_2precomp_8h-source.html">precomp.h</a>"</code><br>
<code>#include "newexe.h"</code><br>

<p>
<a href="../../d7/d9/extract_8c-source.html">Go to the source code of this file.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/extract_8c.html#a0">ARRAYSIZE</a>(a)&nbsp;&nbsp;&nbsp;(sizeof(a)/sizeof(a[0]))</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/extract_8c.html#a1">ICON_MAGIC</a>&nbsp;&nbsp;&nbsp;0</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/extract_8c.html#a2">ICO_MAGIC1</a>&nbsp;&nbsp;&nbsp;1</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/extract_8c.html#a3">CUR_MAGIC1</a>&nbsp;&nbsp;&nbsp;2</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/extract_8c.html#a4">BMP_MAGIC</a>&nbsp;&nbsp;&nbsp;((WORD)'B'+((WORD)'M'&lt;&lt;8))</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/extract_8c.html#a5">ANI_MAGIC</a>&nbsp;&nbsp;&nbsp;((WORD)'R'+((WORD)'I'&lt;&lt;8))</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/extract_8c.html#a6">ANI_MAGIC1</a>&nbsp;&nbsp;&nbsp;((WORD)'F'+((WORD)'F'&lt;&lt;8))</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/extract_8c.html#a7">ANI_MAGIC4</a>&nbsp;&nbsp;&nbsp;((WORD)'A'+((WORD)'C'&lt;&lt;8))</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/extract_8c.html#a8">ANI_MAGIC5</a>&nbsp;&nbsp;&nbsp;((WORD)'O'+((WORD)'N'&lt;&lt;8))</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/extract_8c.html#a9">MZMAGIC</a>&nbsp;&nbsp;&nbsp;((WORD)'M'+((WORD)'Z'&lt;&lt;8))</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/extract_8c.html#a10">PEMAGIC</a>&nbsp;&nbsp;&nbsp;((WORD)'P'+((WORD)'E'&lt;&lt;8))</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/extract_8c.html#a11">LEMAGIC</a>&nbsp;&nbsp;&nbsp;((WORD)'L'+((WORD)'E'&lt;&lt;8))</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/extract_8c.html#a12">RESOURCE_VA</a>(x)&nbsp;&nbsp;&nbsp;((x)-&gt;OptionalHeader.DataDirectory[IMAGE_DIRECTORY_ENTRY_RESOURCE].VirtualAddress)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/extract_8c.html#a13">RESOURCE_SIZE</a>(x)&nbsp;&nbsp;&nbsp;((x)-&gt;OptionalHeader.DataDirectory[IMAGE_DIRECTORY_ENTRY_RESOURCE].<a class="el" href="../../d9/d7/w98_2lh__open_2pi__mem_8h.html#a0">Size</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/extract_8c.html#a14">NUMBER_OF_SECTIONS</a>(x)&nbsp;&nbsp;&nbsp;((x)-&gt;FileHeader.NumberOfSections)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/extract_8c.html#a15">FCC</a>(c0, c1, c2, c3)&nbsp;&nbsp;&nbsp;((<a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)(c0)|((<a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)(c1)&lt;&lt;8)|((<a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)(c2)&lt;&lt;16)|((<a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)(c3)&lt;&lt;24))</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/extract_8c.html#a16">COM_FILE</a>&nbsp;&nbsp;&nbsp;FCC('.', '<a class="el" href="../../d7/d1/genuedef_8c.html#a8">c</a>', 'o', 'm')</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/extract_8c.html#a17">BAT_FILE</a>&nbsp;&nbsp;&nbsp;FCC('.', 'b', 'a', 't')</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/extract_8c.html#a18">CMD_FILE</a>&nbsp;&nbsp;&nbsp;FCC('.', '<a class="el" href="../../d7/d1/genuedef_8c.html#a8">c</a>', 'm', 'd')</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/extract_8c.html#a19">PIF_FILE</a>&nbsp;&nbsp;&nbsp;FCC('.', 'p', 'i', 'f')</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/extract_8c.html#a20">LNK_FILE</a>&nbsp;&nbsp;&nbsp;FCC('.', 'l', '<a class="el" href="../../d7/d0/exts_8h.html#a0">n</a>', 'k')</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/extract_8c.html#a21">ICO_FILE</a>&nbsp;&nbsp;&nbsp;FCC('.', 'i', '<a class="el" href="../../d7/d1/genuedef_8c.html#a8">c</a>', 'o')</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/extract_8c.html#a22">EXE_FILE</a>&nbsp;&nbsp;&nbsp;FCC('.', 'e', 'x', 'e')</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/extract_8c.html#a23">WIN32VER30</a>&nbsp;&nbsp;&nbsp;0x00030000</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/extract_8c.html#a24">GET_COUNT</a>&nbsp;&nbsp;&nbsp;424242</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/extract_8c.html#a25">ROP_DSna</a>&nbsp;&nbsp;&nbsp;0x00220326</td></tr>

<tr><td colspan=2><br><h2>Typedefs</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>typedef new_exe NEWEXE *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/extract_8c.html#a26">LPNEWEXE</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef exe_hdr EXEHDR *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/extract_8c.html#a27">LPEXEHDR</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef rsrc_nameinfo RESNAMEINFO *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/extract_8c.html#a28">LPRESNAMEINFO</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef rsrc_typeinfo RESTYPEINFO *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/extract_8c.html#a29">LPRESTYPEINFO</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef rsrc_typeinfo UNALIGNED *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/extract_8c.html#a30">ULPRESTYPEINFO</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef new_rsrc RESTABLE *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/extract_8c.html#a31">LPRESTABLE</a></td></tr>

<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>__inline BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/extract_8c.html#a32">PathIsUNC</a> (LPWSTR psz)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/extract_8c.html#a33">ReadAByte</a> (LPCVOID pMem)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d0/d5/perfuser_8c.html#a5">LPVOID</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/extract_8c.html#a34">RVAtoP</a> (<a class="el" href="../../d0/d5/perfuser_8c.html#a5">LPVOID</a> pBase, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> rva)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d0/d5/perfuser_8c.html#a5">LPVOID</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/extract_8c.html#a35">GetResourceTablePE</a> (<a class="el" href="../../d0/d5/perfuser_8c.html#a5">LPVOID</a> pBase)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d0/d5/perfuser_8c.html#a5">LPVOID</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/extract_8c.html#a36">FindResourcePE</a> (<a class="el" href="../../d0/d5/perfuser_8c.html#a5">LPVOID</a> pBase, <a class="el" href="../../d0/d5/perfuser_8c.html#a5">LPVOID</a> prt, int iResIndex, int ResType, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> *pcb)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d0/d5/perfuser_8c.html#a5">LPVOID</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/extract_8c.html#a37">GetResourceTableNE</a> (<a class="el" href="../../d0/d5/perfuser_8c.html#a5">LPVOID</a> pBase)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d0/d5/perfuser_8c.html#a5">LPVOID</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/extract_8c.html#a38">FindResourceNE</a> (<a class="el" href="../../d0/d5/perfuser_8c.html#a5">LPVOID</a> lpBase, <a class="el" href="../../d0/d5/perfuser_8c.html#a5">LPVOID</a> prt, int iResIndex, int iResType, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> *pcb)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>UINT&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/extract_8c.html#a39">ExtractIconFromICO</a> (LPTSTR <a class="el" href="../../d5/d8/jul98_2test_2main_8c.html#a3">szFile</a>, int nIconIndex, int cxIcon, int cyIcon, HICON *phicon, UINT flags)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>UINT&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/extract_8c.html#a40">ExtractIconFromBMP</a> (LPTSTR <a class="el" href="../../d5/d8/jul98_2test_2main_8c.html#a3">szFile</a>, int nIconIndex, int cxIcon, int cyIcon, HICON *phicon, UINT flags)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>UINT&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/extract_8c.html#a41">ExtractIconFromEXE</a> (HANDLE hFile, int nIconIndex, int cxIconSize, int cyIconSize, HICON *phicon, UINT *piconid, UINT nIcons, UINT flags)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>LPWSTR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/extract_8c.html#a42">PathFindExtension</a> (LPWSTR pszPath)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>WINUSERAPI UINT&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/extract_8c.html#a43">PrivateExtractIconExA</a> (LPCSTR szFileName, int nIconIndex, HICON *phiconLarge, HICON *phiconSmall, UINT nIcons)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/extract_8c.html#a44">HasExtension</a> (LPWSTR pszPath)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>WINUSERAPI UINT WINAPI&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/extract_8c.html#a45">PrivateExtractIconsW</a> (LPCWSTR szFileName, int nIconIndex, int cxIcon, int cyIcon, HICON *phicon, UINT *piconid, UINT nIcons, UINT flags)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>WINUSERAPI UINT WINAPI&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/extract_8c.html#a46">PrivateExtractIconsA</a> (LPCSTR szFileName, int nIconIndex, int cxIcon, int cyIcon, HICON *phicon, UINT *piconid, UINT nIcons, UINT flags)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>WINUSERAPI UINT&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/extract_8c.html#a47">PrivateExtractIconExW</a> (LPCWSTR szFileName, int nIconIndex, HICON *phiconLarge, HICON *phiconSmall, UINT nIcons)</td></tr>

</table>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="a5" doxytag="extract.c::ANI_MAGIC" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ANI_MAGIC&nbsp;&nbsp;&nbsp;((WORD)'R'+((WORD)'I'&lt;&lt;8))          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/extract_8c-source.html#l00025">25</a> of file <a class="el" href="../../d7/d9/extract_8c-source.html">extract.c</a>.
<p>
Referenced by <a class="el" href="../../d7/d9/extract_8c-source.html#l00830">PrivateExtractIconsW()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a6" doxytag="extract.c::ANI_MAGIC1" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ANI_MAGIC1&nbsp;&nbsp;&nbsp;((WORD)'F'+((WORD)'F'&lt;&lt;8))          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/extract_8c-source.html#l00026">26</a> of file <a class="el" href="../../d7/d9/extract_8c-source.html">extract.c</a>.
<p>
Referenced by <a class="el" href="../../d7/d9/extract_8c-source.html#l00830">PrivateExtractIconsW()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a7" doxytag="extract.c::ANI_MAGIC4" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ANI_MAGIC4&nbsp;&nbsp;&nbsp;((WORD)'A'+((WORD)'C'&lt;&lt;8))          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/extract_8c-source.html#l00027">27</a> of file <a class="el" href="../../d7/d9/extract_8c-source.html">extract.c</a>.
<p>
Referenced by <a class="el" href="../../d7/d9/extract_8c-source.html#l00830">PrivateExtractIconsW()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a8" doxytag="extract.c::ANI_MAGIC5" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ANI_MAGIC5&nbsp;&nbsp;&nbsp;((WORD)'O'+((WORD)'N'&lt;&lt;8))          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/extract_8c-source.html#l00028">28</a> of file <a class="el" href="../../d7/d9/extract_8c-source.html">extract.c</a>.
<p>
Referenced by <a class="el" href="../../d7/d9/extract_8c-source.html#l00830">PrivateExtractIconsW()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a0" doxytag="extract.c::ARRAYSIZE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ARRAYSIZE          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">a&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;(sizeof(a)/sizeof(a[0]))</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/extract_8c-source.html#l00019">19</a> of file <a class="el" href="../../d7/d9/extract_8c-source.html">extract.c</a>.
<p>
Referenced by <a class="el" href="../../d7/d9/extract_8c-source.html#l00830">PrivateExtractIconsW()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a17" doxytag="extract.c::BAT_FILE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define BAT_FILE&nbsp;&nbsp;&nbsp;FCC('.', 'b', 'a', 't')          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/extract_8c-source.html#l00047">47</a> of file <a class="el" href="../../d7/d9/extract_8c-source.html">extract.c</a>.
<p>
Referenced by <a class="el" href="../../d7/d9/extract_8c-source.html#l00765">HasExtension()</a>, and <a class="el" href="../../d7/d9/extract_8c-source.html#l00830">PrivateExtractIconsW()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a4" doxytag="extract.c::BMP_MAGIC" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define BMP_MAGIC&nbsp;&nbsp;&nbsp;((WORD)'B'+((WORD)'M'&lt;&lt;8))          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/extract_8c-source.html#l00024">24</a> of file <a class="el" href="../../d7/d9/extract_8c-source.html">extract.c</a>.
<p>
Referenced by <a class="el" href="../../d7/d9/extract_8c-source.html#l00830">PrivateExtractIconsW()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a18" doxytag="extract.c::CMD_FILE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define CMD_FILE&nbsp;&nbsp;&nbsp;FCC('.', '<a class="el" href="../../d7/d1/genuedef_8c.html#a8">c</a>', 'm', 'd')          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/extract_8c-source.html#l00048">48</a> of file <a class="el" href="../../d7/d9/extract_8c-source.html">extract.c</a>.
<p>
Referenced by <a class="el" href="../../d7/d9/extract_8c-source.html#l00765">HasExtension()</a>, and <a class="el" href="../../d7/d9/extract_8c-source.html#l00830">PrivateExtractIconsW()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a16" doxytag="extract.c::COM_FILE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define COM_FILE&nbsp;&nbsp;&nbsp;FCC('.', '<a class="el" href="../../d7/d1/genuedef_8c.html#a8">c</a>', 'o', 'm')          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/extract_8c-source.html#l00046">46</a> of file <a class="el" href="../../d7/d9/extract_8c-source.html">extract.c</a>.
<p>
Referenced by <a class="el" href="../../d7/d9/extract_8c-source.html#l00765">HasExtension()</a>, and <a class="el" href="../../d7/d9/extract_8c-source.html#l00830">PrivateExtractIconsW()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="extract.c::CUR_MAGIC1" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define CUR_MAGIC1&nbsp;&nbsp;&nbsp;2          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/extract_8c-source.html#l00023">23</a> of file <a class="el" href="../../d7/d9/extract_8c-source.html">extract.c</a>.
<p>
Referenced by <a class="el" href="../../d7/d9/extract_8c-source.html#l00830">PrivateExtractIconsW()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a22" doxytag="extract.c::EXE_FILE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define EXE_FILE&nbsp;&nbsp;&nbsp;FCC('.', 'e', 'x', 'e')          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/extract_8c-source.html#l00052">52</a> of file <a class="el" href="../../d7/d9/extract_8c-source.html">extract.c</a>.
<p>
Referenced by <a class="el" href="../../d7/d9/extract_8c-source.html#l00765">HasExtension()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a15" doxytag="extract.c::FCC" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define FCC          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">c0,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>c1,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>c2,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>c3&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;((<a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)(c0)|((<a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)(c1)&lt;&lt;8)|((<a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)(c2)&lt;&lt;16)|((<a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)(c3)&lt;&lt;24))</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/extract_8c-source.html#l00044">44</a> of file <a class="el" href="../../d7/d9/extract_8c-source.html">extract.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a24" doxytag="extract.c::GET_COUNT" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define GET_COUNT&nbsp;&nbsp;&nbsp;424242          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/extract_8c-source.html#l00057">57</a> of file <a class="el" href="../../d7/d9/extract_8c-source.html">extract.c</a>.
<p>
Referenced by <a class="el" href="../../d7/d9/extract_8c-source.html#l00517">ExtractIconFromEXE()</a>, <a class="el" href="../../d7/d9/extract_8c-source.html#l00310">FindResourceNE()</a>, and <a class="el" href="../../d7/d9/extract_8c-source.html#l00165">FindResourcePE()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a21" doxytag="extract.c::ICO_FILE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ICO_FILE&nbsp;&nbsp;&nbsp;FCC('.', 'i', '<a class="el" href="../../d7/d1/genuedef_8c.html#a8">c</a>', 'o')          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/extract_8c-source.html#l00051">51</a> of file <a class="el" href="../../d7/d9/extract_8c-source.html">extract.c</a>.
<p>
Referenced by <a class="el" href="../../d7/d9/extract_8c-source.html#l00765">HasExtension()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a2" doxytag="extract.c::ICO_MAGIC1" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ICO_MAGIC1&nbsp;&nbsp;&nbsp;1          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/extract_8c-source.html#l00022">22</a> of file <a class="el" href="../../d7/d9/extract_8c-source.html">extract.c</a>.
<p>
Referenced by <a class="el" href="../../d7/d9/extract_8c-source.html#l00830">PrivateExtractIconsW()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="extract.c::ICON_MAGIC" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ICON_MAGIC&nbsp;&nbsp;&nbsp;0          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/extract_8c-source.html#l00021">21</a> of file <a class="el" href="../../d7/d9/extract_8c-source.html">extract.c</a>.
<p>
Referenced by <a class="el" href="../../d7/d9/extract_8c-source.html#l00830">PrivateExtractIconsW()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a11" doxytag="extract.c::LEMAGIC" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define LEMAGIC&nbsp;&nbsp;&nbsp;((WORD)'L'+((WORD)'E'&lt;&lt;8))          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/extract_8c-source.html#l00031">31</a> of file <a class="el" href="../../d7/d9/extract_8c-source.html">extract.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a20" doxytag="extract.c::LNK_FILE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define LNK_FILE&nbsp;&nbsp;&nbsp;FCC('.', 'l', '<a class="el" href="../../d7/d0/exts_8h.html#a0">n</a>', 'k')          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/extract_8c-source.html#l00050">50</a> of file <a class="el" href="../../d7/d9/extract_8c-source.html">extract.c</a>.
<p>
Referenced by <a class="el" href="../../d7/d9/extract_8c-source.html#l00765">HasExtension()</a>, and <a class="el" href="../../d7/d9/extract_8c-source.html#l00830">PrivateExtractIconsW()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a9" doxytag="extract.c::MZMAGIC" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define MZMAGIC&nbsp;&nbsp;&nbsp;((WORD)'M'+((WORD)'Z'&lt;&lt;8))          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/extract_8c-source.html#l00029">29</a> of file <a class="el" href="../../d7/d9/extract_8c-source.html">extract.c</a>.
<p>
Referenced by <a class="el" href="../../d7/d9/extract_8c-source.html#l00517">ExtractIconFromEXE()</a>, <a class="el" href="../../d7/d9/extract_8c-source.html#l00266">GetResourceTableNE()</a>, <a class="el" href="../../d7/d9/extract_8c-source.html#l00133">GetResourceTablePE()</a>, and <a class="el" href="../../d7/d9/extract_8c-source.html#l00830">PrivateExtractIconsW()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a14" doxytag="extract.c::NUMBER_OF_SECTIONS" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define NUMBER_OF_SECTIONS          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">x&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;((x)-&gt;FileHeader.NumberOfSections)</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/extract_8c-source.html#l00042">42</a> of file <a class="el" href="../../d7/d9/extract_8c-source.html">extract.c</a>.
<p>
Referenced by <a class="el" href="../../d7/d9/extract_8c-source.html#l00094">RVAtoP()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a10" doxytag="extract.c::PEMAGIC" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define PEMAGIC&nbsp;&nbsp;&nbsp;((WORD)'P'+((WORD)'E'&lt;&lt;8))          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/extract_8c-source.html#l00030">30</a> of file <a class="el" href="../../d7/d9/extract_8c-source.html">extract.c</a>.
<p>
Referenced by <a class="el" href="../../d7/d9/extract_8c-source.html#l00517">ExtractIconFromEXE()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a19" doxytag="extract.c::PIF_FILE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define PIF_FILE&nbsp;&nbsp;&nbsp;FCC('.', 'p', 'i', 'f')          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/extract_8c-source.html#l00049">49</a> of file <a class="el" href="../../d7/d9/extract_8c-source.html">extract.c</a>.
<p>
Referenced by <a class="el" href="../../d7/d9/extract_8c-source.html#l00765">HasExtension()</a>, and <a class="el" href="../../d7/d9/extract_8c-source.html#l00830">PrivateExtractIconsW()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a13" doxytag="extract.c::RESOURCE_SIZE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define RESOURCE_SIZE          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">x&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;((x)-&gt;OptionalHeader.DataDirectory[IMAGE_DIRECTORY_ENTRY_RESOURCE].<a class="el" href="../../d9/d7/w98_2lh__open_2pi__mem_8h.html#a0">Size</a>)</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/extract_8c-source.html#l00041">41</a> of file <a class="el" href="../../d7/d9/extract_8c-source.html">extract.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a12" doxytag="extract.c::RESOURCE_VA" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define RESOURCE_VA          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">x&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;((x)-&gt;OptionalHeader.DataDirectory[IMAGE_DIRECTORY_ENTRY_RESOURCE].VirtualAddress)</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/extract_8c-source.html#l00040">40</a> of file <a class="el" href="../../d7/d9/extract_8c-source.html">extract.c</a>.
<p>
Referenced by <a class="el" href="../../d7/d9/extract_8c-source.html#l00133">GetResourceTablePE()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a25" doxytag="extract.c::ROP_DSna" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ROP_DSna&nbsp;&nbsp;&nbsp;0x00220326          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/extract_8c-source.html#l00424">424</a> of file <a class="el" href="../../d7/d9/extract_8c-source.html">extract.c</a>.
<p>
Referenced by <a class="el" href="../../d7/d9/extract_8c-source.html#l00426">ExtractIconFromBMP()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a23" doxytag="extract.c::WIN32VER30" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define WIN32VER30&nbsp;&nbsp;&nbsp;0x00030000          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/extract_8c-source.html#l00055">55</a> of file <a class="el" href="../../d7/d9/extract_8c-source.html">extract.c</a>.
<p>
Referenced by <a class="el" href="../../d7/d9/extract_8c-source.html#l00517">ExtractIconFromEXE()</a>.    </td>
  </tr>
</table>
<hr><h2>Typedef Documentation</h2>
<a class="anchor" name="a27" doxytag="extract.c::LPEXEHDR" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct exe_hdr EXEHDR* <a class="el" href="../../d6/d0/extract_8c.html#a27">LPEXEHDR</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/extract_8c-source.html#l00034">34</a> of file <a class="el" href="../../d7/d9/extract_8c-source.html">extract.c</a>.
<p>
Referenced by <a class="el" href="../../d7/d9/extract_8c-source.html#l00266">GetResourceTableNE()</a>, <a class="el" href="../../d7/d9/extract_8c-source.html#l00133">GetResourceTablePE()</a>, and <a class="el" href="../../d7/d9/extract_8c-source.html#l00094">RVAtoP()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a26" doxytag="extract.c::LPNEWEXE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct new_exe NEWEXE* <a class="el" href="../../d6/d0/extract_8c.html#a26">LPNEWEXE</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/extract_8c-source.html#l00033">33</a> of file <a class="el" href="../../d7/d9/extract_8c-source.html">extract.c</a>.
<p>
Referenced by <a class="el" href="../../d7/d9/extract_8c-source.html#l00266">GetResourceTableNE()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a28" doxytag="extract.c::LPRESNAMEINFO" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct rsrc_nameinfo RESNAMEINFO* <a class="el" href="../../d6/d0/extract_8c.html#a28">LPRESNAMEINFO</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/extract_8c-source.html#l00035">35</a> of file <a class="el" href="../../d7/d9/extract_8c-source.html">extract.c</a>.
<p>
Referenced by <a class="el" href="../../d7/d9/extract_8c-source.html#l00310">FindResourceNE()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a31" doxytag="extract.c::LPRESTABLE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct new_rsrc RESTABLE* <a class="el" href="../../d6/d0/extract_8c.html#a31">LPRESTABLE</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/extract_8c-source.html#l00038">38</a> of file <a class="el" href="../../d7/d9/extract_8c-source.html">extract.c</a>.
<p>
Referenced by <a class="el" href="../../d7/d9/extract_8c-source.html#l00310">FindResourceNE()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a29" doxytag="extract.c::LPRESTYPEINFO" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct rsrc_typeinfo RESTYPEINFO* <a class="el" href="../../d6/d0/extract_8c.html#a29">LPRESTYPEINFO</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/extract_8c-source.html#l00036">36</a> of file <a class="el" href="../../d7/d9/extract_8c-source.html">extract.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a30" doxytag="extract.c::ULPRESTYPEINFO" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct rsrc_typeinfo UNALIGNED* <a class="el" href="../../d6/d0/extract_8c.html#a30">ULPRESTYPEINFO</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/extract_8c-source.html#l00037">37</a> of file <a class="el" href="../../d7/d9/extract_8c-source.html">extract.c</a>.
<p>
Referenced by <a class="el" href="../../d7/d9/extract_8c-source.html#l00310">FindResourceNE()</a>.    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a40" doxytag="extract.c::ExtractIconFromBMP" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> UINT ExtractIconFromBMP           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">LPTSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>szFile</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>nIconIndex</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>cxIcon</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>cyIcon</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HICON *&nbsp;</td>
          <td class="mdname" nowrap> <em>phicon</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>flags</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/extract_8c-source.html#l00426">426</a> of file <a class="el" href="../../d7/d9/extract_8c-source.html">extract.c</a>.
<p>
References <a class="el" href="../../d5/d8/clres_8c-source.html#l01307">CreateIconIndirect()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d7/d9/extract_8c-source.html#l00424">ROP_DSna</a>, <a class="el" href="../../d4/d7/aug98_2test_2main_8c-source.html#l00077">szFile</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, and <a class="el" href="../../d0/d5/ndismain_8h-source.html#l00026">UINT</a>.
<p>
Referenced by <a class="el" href="../../d7/d9/extract_8c-source.html#l00830">PrivateExtractIconsW()</a>.
<p>
<pre class="fragment"><div>00433 {
00434     HICON    hicon;
00435     HBITMAP  hbm;
00436     HBITMAP  hbmMask;
00437     HDC      hdc;
00438     HDC      hdcMask;
00439     ICONINFO ii;
00440 
00441     <span class="keywordflow">if</span> (nIconIndex &gt;= 1)
00442         <span class="keywordflow">return</span> 0;
00443 
00444     <span class="comment">/*</span>
00445 <span class="comment">     * BUGUS: don't use LR_CREATEDIBSECTION.  USER can't make an icon out</span>
00446 <span class="comment">     * of a DibSection.</span>
00447 <span class="comment">     */</span>
00448     flags |= LR_LOADFROMFILE;
00449 
00450 again:
00451 
00452     hbm = (HBITMAP)LoadImage(NULL,
00453                              szFile,
00454                              IMAGE_BITMAP,
00455                              LOWORD(cxIcon),
00456                              LOWORD(cyIcon),
00457                              flags);
00458 
00459     <span class="keywordflow">if</span> (hbm == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00460         <span class="keywordflow">return</span> 0;
00461 
00462     <span class="comment">/*</span>
00463 <span class="comment">     *  do we just want a count?</span>
00464 <span class="comment">     */</span>
00465     <span class="keywordflow">if</span> (phicon == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00466         DeleteObject(hbm);
00467         <span class="keywordflow">return</span> 1;
00468     }
00469 
00470     hbmMask = CreateBitmap(LOWORD(cxIcon), LOWORD(cyIcon), 1, 1, NULL);
00471 
00472     hdc = CreateCompatibleDC(NULL);
00473     SelectObject(hdc, hbm);
00474 
00475     hdcMask = CreateCompatibleDC(NULL);
00476     SelectObject(hdcMask, hbmMask);
00477 
00478     SetBkColor(hdc, GetPixel(hdc, 0, 0));
00479 
00480     BitBlt(hdcMask, 0, 0, LOWORD(cxIcon), LOWORD(cyIcon), hdc, 0, 0, SRCCOPY);
00481     BitBlt(hdc, 0, 0, LOWORD(cxIcon), LOWORD(cyIcon), hdcMask, 0, 0, ROP_DSna);
00482 
00483     ii.fIcon    = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00484     ii.xHotspot = 0;
00485     ii.yHotspot = 0;
00486     ii.hbmColor = hbm;
00487     ii.hbmMask  = hbmMask;
00488     hicon = <a class="code" href="../../d4/d9/clres_8c.html#a60">CreateIconIndirect</a>(&amp;ii);
00489 
00490     DeleteObject(hdc);
00491     DeleteObject(hbm);
00492     DeleteObject(hdcMask);
00493     DeleteObject(hbmMask);
00494 
00495     *phicon = hicon;
00496 
00497     <span class="comment">/*</span>
00498 <span class="comment">     * Check for large/small icon extract</span>
00499 <span class="comment">     */</span>
00500     <span class="keywordflow">if</span> (HIWORD(cxIcon)) {
00501         cxIcon = HIWORD(cxIcon);
00502         cyIcon = HIWORD(cyIcon);
00503         phicon++;
00504 
00505         <span class="keywordflow">goto</span> again;
00506     }
00507 
00508     <span class="keywordflow">return</span> 1;
00509 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a41" doxytag="extract.c::ExtractIconFromEXE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> UINT ExtractIconFromEXE           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HANDLE&nbsp;</td>
          <td class="mdname" nowrap> <em>hFile</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>nIconIndex</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>cxIconSize</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>cyIconSize</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HICON *&nbsp;</td>
          <td class="mdname" nowrap> <em>phicon</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT *&nbsp;</td>
          <td class="mdname" nowrap> <em>piconid</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>nIcons</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>flags</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/extract_8c-source.html#l00517">517</a> of file <a class="el" href="../../d7/d9/extract_8c-source.html">extract.c</a>.
<p>
References <a class="el" href="../../d0/d7/halvprnt_8c-source.html#l00031">BYTE</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l01627">CreateIconFromResourceEx()</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d0/d1/fedefs_8h-source.html#l00051">exit</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d7/d9/extract_8c-source.html#l00310">FindResourceNE()</a>, <a class="el" href="../../d7/d9/extract_8c-source.html#l00165">FindResourcePE()</a>, <a class="el" href="../../d7/d9/extract_8c-source.html#l00057">GET_COUNT</a>, <a class="el" href="../../d7/d9/extract_8c-source.html#l00266">GetResourceTableNE()</a>, <a class="el" href="../../d7/d9/extract_8c-source.html#l00133">GetResourceTablePE()</a>, <a class="el" href="../../d6/d3/rxact_8c-source.html#l00212">INVALID_HANDLE_VALUE</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l01550">LookupIconIdFromDirectoryEx()</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">LPVOID</a>, <a class="el" href="../../d7/d9/extract_8c-source.html#l00029">MZMAGIC</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d7/d9/extract_8c-source.html#l00030">PEMAGIC</a>, <a class="el" href="../../d7/d9/extract_8c-source.html#l00082">ReadAByte()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d0/d5/ndismain_8h-source.html#l00026">UINT</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00923">UPBITMAPINFOHEADER</a>, and <a class="el" href="../../d7/d9/extract_8c-source.html#l00055">WIN32VER30</a>.
<p>
Referenced by <a class="el" href="../../d7/d9/extract_8c-source.html#l00830">PrivateExtractIconsW()</a>.
<p>
<pre class="fragment"><div>00526 {
00527     HANDLE           hFileMap = <a class="code" href="../../d5/d4/rxact_8c.html#a0">INVALID_HANDLE_VALUE</a>;
00528     <a class="code" href="../../d0/d5/perfuser_8c.html#a5">LPVOID</a>           lpFile = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00529     EXEHDR           *pmz;
00530     NEWEXE UNALIGNED *pne;
00531     <a class="code" href="../../d0/d5/perfuser_8c.html#a5">LPVOID</a>           pBase;
00532     <a class="code" href="../../d0/d5/perfuser_8c.html#a5">LPVOID</a>           pres = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00533     <a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a>             result = 0;
00534     LONG             FileLength;
00535     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>            cbSize;
00536     <span class="keywordtype">int</span>              cxIcon;
00537     <span class="keywordtype">int</span>              cyIcon;
00538 
00539     <a class="code" href="../../d0/d5/perfuser_8c.html#a5">LPVOID</a> (*FindResourceX)(<a class="code" href="../../d0/d5/perfuser_8c.html#a5">LPVOID</a> pBase,
00540                             <a class="code" href="../../d0/d5/perfuser_8c.html#a5">LPVOID</a> prt,
00541                             <span class="keywordtype">int</span>    iResIndex,
00542                             <span class="keywordtype">int</span>    iResType,
00543                             <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>  *pcb);
00544 
00545     FileLength = (LONG)GetFileSize(hFile, NULL);
00546 
00547     hFileMap = CreateFileMapping(hFile, NULL, PAGE_READONLY, 0, 0, NULL);
00548     <span class="keywordflow">if</span> (hFileMap == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00549         <span class="keywordflow">goto</span> <a class="code" href="../../d9/d1/fedefs_8h.html#a16">exit</a>;
00550 
00551     lpFile = MapViewOfFile(hFileMap, FILE_MAP_READ, 0, 0, 0);
00552     <span class="keywordflow">if</span> (lpFile == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00553         <span class="keywordflow">goto</span> <a class="code" href="../../d9/d1/fedefs_8h.html#a16">exit</a>;
00554 
00555     pBase = (<a class="code" href="../../d0/d5/perfuser_8c.html#a5">LPVOID</a>)lpFile;
00556     pmz = (<span class="keyword">struct </span>exe_hdr *)pBase;
00557 
00558     _try {
00559 
00560         <span class="keywordflow">if</span> (pmz-&gt;e_magic != <a class="code" href="../../d6/d0/extract_8c.html#a9">MZMAGIC</a>)
00561             <span class="keywordflow">goto</span> <a class="code" href="../../d9/d1/fedefs_8h.html#a16">exit</a>;
00562 
00563         <span class="keywordflow">if</span> (pmz-&gt;e_lfanew &lt;= 0)             <span class="comment">// not a new exe</span>
00564             <span class="keywordflow">goto</span> <a class="code" href="../../d9/d1/fedefs_8h.html#a16">exit</a>;
00565 
00566         <span class="keywordflow">if</span> (pmz-&gt;e_lfanew &gt;= FileLength)    <span class="comment">// not a new exe</span>
00567             <span class="keywordflow">goto</span> <a class="code" href="../../d9/d1/fedefs_8h.html#a16">exit</a>;
00568 
00569         pne = (NEWEXE UNALIGNED *)((<a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a>*)pmz + pmz-&gt;e_lfanew);
00570 
00571         <span class="keywordflow">switch</span> (pne-&gt;ne_magic) {
00572         <span class="keywordflow">case</span> NEMAGIC:
00573             pres = <a class="code" href="../../d6/d0/extract_8c.html#a37">GetResourceTableNE</a>(pBase);
00574             FindResourceX = <a class="code" href="../../d6/d0/extract_8c.html#a38">FindResourceNE</a>;
00575             <span class="keywordflow">break</span>;
00576 
00577         <span class="keywordflow">case</span> <a class="code" href="../../d6/d0/extract_8c.html#a10">PEMAGIC</a>:
00578             pres = <a class="code" href="../../d6/d0/extract_8c.html#a35">GetResourceTablePE</a>(pBase);
00579             FindResourceX = <a class="code" href="../../d6/d0/extract_8c.html#a36">FindResourcePE</a>;
00580             <span class="keywordflow">break</span>;
00581         }
00582 
00583         <span class="comment">/*</span>
00584 <span class="comment">         * cant find the resource table, fail</span>
00585 <span class="comment">         */</span>
00586         <span class="keywordflow">if</span> (pres == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00587             <span class="keywordflow">goto</span> <a class="code" href="../../d9/d1/fedefs_8h.html#a16">exit</a>;
00588 
00589         <span class="comment">/*</span>
00590 <span class="comment">         * do we just want a count?</span>
00591 <span class="comment">         */</span>
00592         <span class="keywordflow">if</span> (phicon == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00593             result = PtrToUlong(FindResourceX(pBase,
00594                                              pres,
00595                                              GET_COUNT,
00596                                              (LONG_PTR)RT_GROUP_ICON,
00597                                              &amp;cbSize));
00598             <span class="keywordflow">goto</span> <a class="code" href="../../d9/d1/fedefs_8h.html#a16">exit</a>;
00599         }
00600 
00601         <span class="keywordflow">while</span> (result &lt; nIcons) {
00602 
00603             <a class="code" href="../../d0/d5/perfuser_8c.html#a5">LPVOID</a> lpIconDir;
00604             <a class="code" href="../../d0/d5/perfuser_8c.html#a5">LPVOID</a> lpIcon;
00605             <span class="keywordtype">int</span>    idIcon;
00606 
00607             cxIcon = cxIconSize;
00608             cyIcon = cyIconSize;
00609 
00610             <span class="comment">/*</span>
00611 <span class="comment">             *  find the icon dir for this icon.</span>
00612 <span class="comment">             */</span>
00613             lpIconDir = FindResourceX(pBase,
00614                                       pres,
00615                                       nIconIndex,
00616                                       (LONG_PTR)RT_GROUP_ICON,
00617                                       &amp;cbSize);
00618 
00619             <span class="keywordflow">if</span> (lpIconDir == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00620                 <span class="keywordflow">goto</span> <a class="code" href="../../d9/d1/fedefs_8h.html#a16">exit</a>;
00621 
00622             <span class="keywordflow">if</span> ((((LPNEWHEADER)lpIconDir)-&gt;Reserved != 0) ||
00623                 (((LPNEWHEADER)lpIconDir)-&gt;ResType != FT_ICON)) {
00624 
00625                 <span class="keywordflow">goto</span> <a class="code" href="../../d9/d1/fedefs_8h.html#a16">exit</a>;
00626             }
00627 again:
00628             idIcon = <a class="code" href="../../d4/d9/clres_8c.html#a67">LookupIconIdFromDirectoryEx</a>((LPBYTE)lpIconDir,
00629                                                  TRUE,
00630                                                  LOWORD(cxIcon),
00631                                                  LOWORD(cyIcon),
00632                                                  flags);
00633             lpIcon = FindResourceX(pBase,
00634                                    pres,
00635                                    -idIcon,
00636                                    (LONG_PTR)RT_ICON,
00637                                    &amp;cbSize);
00638 
00639             <span class="keywordflow">if</span> (lpIcon == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00640                 <span class="keywordflow">goto</span> <a class="code" href="../../d9/d1/fedefs_8h.html#a16">exit</a>;
00641 
00642             <span class="keywordflow">if</span> ((((<a class="code" href="../../d6/d0/usercli_8h.html#a378">UPBITMAPINFOHEADER</a>)lpIcon)-&gt;biSize != <span class="keyword">sizeof</span>(BITMAPINFOHEADER)) &amp;&amp;
00643                 (((<a class="code" href="../../d6/d0/usercli_8h.html#a378">UPBITMAPINFOHEADER</a>)lpIcon)-&gt;biSize != <span class="keyword">sizeof</span>(BITMAPCOREHEADER))) {
00644 
00645                 <span class="keywordflow">goto</span> <a class="code" href="../../d9/d1/fedefs_8h.html#a16">exit</a>;
00646             }
00647 
00648 <span class="preprocessor">#ifndef WINNT</span>
00649 <span class="preprocessor"></span>            <span class="comment">/* touch this memory before calling USER</span>
00650 <span class="comment">             * so if we page fault we will do it outside of the Win16Lock</span>
00651 <span class="comment">             * most icons aren't more than 2 pages</span>
00652 <span class="comment">             */</span>
00653             <a class="code" href="../../d6/d0/extract_8c.html#a33">ReadAByte</a>(((BYTE *)lpIcon) + cbSize - 1);
00654 <span class="preprocessor">#endif</span>
00655 <span class="preprocessor"></span>
00656             <span class="keywordflow">if</span> (piconid)
00657                 piconid[result] = idIcon;
00658 
00659             phicon[result++] = <a class="code" href="../../d4/d9/clres_8c.html#a70">CreateIconFromResourceEx</a>((LPBYTE)lpIcon,
00660                                                         cbSize,
00661                                                         TRUE,
00662                                                         WIN32VER30,
00663                                                         LOWORD(cxIcon),
00664                                                         LOWORD(cyIcon),
00665                                                         flags);
00666 
00667             <span class="comment">/*</span>
00668 <span class="comment">             * check for large/small icon extract</span>
00669 <span class="comment">             */</span>
00670             <span class="keywordflow">if</span> (HIWORD(cxIcon)) {
00671 
00672                 cxIcon = HIWORD(cxIcon);
00673                 cyIcon = HIWORD(cyIcon);
00674 
00675                 <span class="keywordflow">goto</span> again;
00676             }
00677 
00678             nIconIndex++;       <span class="comment">// next icon index</span>
00679         }
00680 
00681     } _except (W32ExceptionHandler(FALSE, RIP_WARNING)) {
00682         result = 0;
00683     }
00684 
00685 <a class="code" href="../../d9/d1/fedefs_8h.html#a16">exit</a>:
00686 
00687     <span class="keywordflow">if</span> (lpFile)
00688         UnmapViewOfFile(lpFile);
00689 
00690     <span class="keywordflow">if</span> (hFileMap != <a class="code" href="../../d5/d4/rxact_8c.html#a0">INVALID_HANDLE_VALUE</a>)
00691         CloseHandle(hFileMap);
00692 
00693     <span class="keywordflow">return</span> result;
00694 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a39" doxytag="extract.c::ExtractIconFromICO" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> UINT ExtractIconFromICO           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">LPTSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>szFile</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>nIconIndex</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>cxIcon</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>cyIcon</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HICON *&nbsp;</td>
          <td class="mdname" nowrap> <em>phicon</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>flags</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/extract_8c-source.html#l00368">368</a> of file <a class="el" href="../../d7/d9/extract_8c-source.html">extract.c</a>.
<p>
References <a class="el" href="../../d5/d8/clres_8c-source.html#l01017">DestroyCursor()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d4/d7/aug98_2test_2main_8c-source.html#l00077">szFile</a>, and <a class="el" href="../../d0/d5/ndismain_8h-source.html#l00026">UINT</a>.
<p>
Referenced by <a class="el" href="../../d7/d9/extract_8c-source.html#l00830">PrivateExtractIconsW()</a>.
<p>
<pre class="fragment"><div>00375 {
00376     HICON hicon;
00377 
00378     <span class="keywordflow">if</span> (nIconIndex &gt;= 1)
00379         <span class="keywordflow">return</span> 0;
00380 
00381     flags |= LR_LOADFROMFILE;
00382 
00383 again:
00384 
00385     hicon = LoadImage(NULL,
00386                       szFile,
00387                       IMAGE_ICON,
00388                       LOWORD(cxIcon),
00389                       LOWORD(cyIcon),
00390                       flags);
00391 
00392     <span class="keywordflow">if</span> (hicon == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00393         <span class="keywordflow">return</span> 0;
00394 
00395     <span class="comment">/*</span>
00396 <span class="comment">     * Do we just want a count?</span>
00397 <span class="comment">     */</span>
00398     <span class="keywordflow">if</span> (phicon == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00399         <a class="code" href="../../d4/d9/clres_8c.html#a55">DestroyCursor</a>((HCURSOR)hicon);
00400     <span class="keywordflow">else</span>
00401         *phicon = hicon;
00402 
00403     <span class="comment">/*</span>
00404 <span class="comment">     * Check for large/small icon extract</span>
00405 <span class="comment">     */</span>
00406     <span class="keywordflow">if</span> (HIWORD(cxIcon)) {
00407 
00408         cxIcon = HIWORD(cxIcon);
00409         cyIcon = HIWORD(cyIcon);
00410         phicon++;
00411 
00412         <span class="keywordflow">goto</span> again;
00413     }
00414 
00415     <span class="keywordflow">return</span> 1;
00416 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a38" doxytag="extract.c::FindResourceNE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d0/d5/perfuser_8c.html#a5">LPVOID</a> FindResourceNE           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d0/d5/perfuser_8c.html#a5">LPVOID</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>lpBase</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a5">LPVOID</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>prt</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>iResIndex</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>iResType</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>pcb</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/extract_8c-source.html#l00310">310</a> of file <a class="el" href="../../d7/d9/extract_8c-source.html">extract.c</a>.
<p>
References <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d7/d9/extract_8c-source.html#l00057">GET_COUNT</a>, <a class="el" href="../../d7/d9/extract_8c-source.html#l00035">LPRESNAMEINFO</a>, <a class="el" href="../../d7/d9/extract_8c-source.html#l00038">LPRESTABLE</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">LPVOID</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, and <a class="el" href="../../d7/d9/extract_8c-source.html#l00037">ULPRESTYPEINFO</a>.
<p>
Referenced by <a class="el" href="../../d7/d9/extract_8c-source.html#l00517">ExtractIconFromEXE()</a>.
<p>
<pre class="fragment"><div>00316 {
00317     <a class="code" href="../../d6/d0/extract_8c.html#a31">LPRESTABLE</a>     lpResTable;
00318     <a class="code" href="../../d6/d0/extract_8c.html#a30">ULPRESTYPEINFO</a> ulpResTypeInfo;
00319     <a class="code" href="../../d6/d0/extract_8c.html#a28">LPRESNAMEINFO</a>  lpResNameInfo;  <span class="comment">// 16 bit alignment ok - had ushorts only</span>
00320     <span class="keywordtype">int</span>            i;
00321 
00322     lpResTable = (<a class="code" href="../../d6/d0/extract_8c.html#a31">LPRESTABLE</a>)prt;
00323 <span class="comment">//ulpResTypeInfo = (ULPRESTYPEINFO)(LPWBYTE)&amp;lpResTable-&gt;rs_typeinfo;</span>
00324     ulpResTypeInfo = (<a class="code" href="../../d6/d0/extract_8c.html#a30">ULPRESTYPEINFO</a>)((LPBYTE)lpResTable + 2);
00325 
00326     <span class="keywordflow">while</span> (ulpResTypeInfo-&gt;rt_id) {
00327 
00328         <span class="keywordflow">if</span> (ulpResTypeInfo-&gt;rt_id == (iResType | RSORDID)) {
00329 
00330             lpResNameInfo = (<a class="code" href="../../d6/d0/extract_8c.html#a28">LPRESNAMEINFO</a>)(ulpResTypeInfo + 1);
00331 
00332             <span class="keywordflow">if</span> (iResIndex == <a class="code" href="../../d6/d0/extract_8c.html#a24">GET_COUNT</a>)
00333                 <span class="keywordflow">return</span> (<a class="code" href="../../d0/d5/perfuser_8c.html#a5">LPVOID</a>)ulpResTypeInfo-&gt;rt_nres;
00334 
00335             <span class="keywordflow">if</span> (iResIndex &lt; 0) {
00336 
00337                 <span class="keywordflow">for</span> (i=0; i &lt; (<span class="keywordtype">int</span>)ulpResTypeInfo-&gt;rt_nres; i++) {
00338 
00339                     <span class="keywordflow">if</span> (lpResNameInfo[i].rn_id == ((-iResIndex) | RSORDID))
00340                         <span class="keywordflow">break</span>;
00341                 }
00342 
00343                 iResIndex = i;
00344             }
00345 
00346             <span class="keywordflow">if</span> (iResIndex &gt;= (<span class="keywordtype">int</span>)ulpResTypeInfo-&gt;rt_nres)
00347                 <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00348 
00349             *pcb = ((<a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)lpResNameInfo[iResIndex].rn_length) &lt;&lt; lpResTable-&gt;rs_align;
00350             <span class="keywordflow">return</span> (LPBYTE)lpBase + ((<span class="keywordtype">long</span>)lpResNameInfo[iResIndex].rn_offset &lt;&lt; lpResTable-&gt;rs_align);
00351         }
00352 
00353         ulpResTypeInfo =
00354                (<a class="code" href="../../d6/d0/extract_8c.html#a30">ULPRESTYPEINFO</a>)((<a class="code" href="../../d6/d0/extract_8c.html#a28">LPRESNAMEINFO</a>)(ulpResTypeInfo + 1) +
00355                 ulpResTypeInfo-&gt;rt_nres);
00356     }
00357 
00358     *pcb = 0;
00359     <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00360 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a36" doxytag="extract.c::FindResourcePE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d0/d5/perfuser_8c.html#a5">LPVOID</a> FindResourcePE           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d0/d5/perfuser_8c.html#a5">LPVOID</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pBase</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a5">LPVOID</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>prt</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>iResIndex</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>ResType</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>pcb</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/extract_8c-source.html#l00165">165</a> of file <a class="el" href="../../d7/d9/extract_8c-source.html">extract.c</a>.
<p>
References <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d7/d9/extract_8c-source.html#l00057">GET_COUNT</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">LPVOID</a>, and <a class="el" href="../../d7/d9/extract_8c-source.html#l00094">RVAtoP()</a>.
<p>
Referenced by <a class="el" href="../../d7/d9/extract_8c-source.html#l00517">ExtractIconFromEXE()</a>.
<p>
<pre class="fragment"><div>00171 {
00172     <span class="keywordtype">int</span>                            i;
00173     <span class="keywordtype">int</span>                            cnt;
00174     IMAGE_RESOURCE_DIRECTORY       *pdir;
00175     IMAGE_RESOURCE_DIRECTORY_ENTRY *pres;
00176     IMAGE_RESOURCE_DATA_ENTRY      *pent;
00177 
00178     pdir = (IMAGE_RESOURCE_DIRECTORY *)prt;
00179 
00180     <span class="comment">/*</span>
00181 <span class="comment">     * First find the type always a ID so ignore strings totaly</span>
00182 <span class="comment">     */</span>
00183     cnt  = pdir-&gt;NumberOfIdEntries + pdir-&gt;NumberOfNamedEntries;
00184     pres = (IMAGE_RESOURCE_DIRECTORY_ENTRY*)(pdir+1);
00185 
00186     <span class="keywordflow">for</span> (i = 0; i &lt; cnt; i++) {
00187 
00188         <span class="keywordflow">if</span> (pres[i].Name == (<a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)ResType)
00189             <span class="keywordflow">break</span>;
00190     }
00191 
00192     <span class="keywordflow">if</span> (i==cnt)             <span class="comment">// did not find the type</span>
00193         <span class="keywordflow">return</span> 0;
00194 
00195     <span class="comment">/*</span>
00196 <span class="comment">     * Now go find the actual resource  either by id (iResIndex &lt; 0) or</span>
00197 <span class="comment">     * by ordinal (iResIndex &gt;= 0)</span>
00198 <span class="comment">     */</span>
00199     pdir = (IMAGE_RESOURCE_DIRECTORY*)((LPBYTE)prt +
00200         (pres[i].OffsetToData &amp; ~IMAGE_RESOURCE_DATA_IS_DIRECTORY));
00201 
00202     cnt  = pdir-&gt;NumberOfIdEntries + pdir-&gt;NumberOfNamedEntries;
00203     pres = (IMAGE_RESOURCE_DIRECTORY_ENTRY*)(pdir+1);
00204 
00205     <span class="comment">/*</span>
00206 <span class="comment">     * If we just want size, do it.</span>
00207 <span class="comment">     */</span>
00208     <span class="keywordflow">if</span> (iResIndex == <a class="code" href="../../d6/d0/extract_8c.html#a24">GET_COUNT</a>)
00209         <span class="keywordflow">return</span> (<a class="code" href="../../d0/d5/perfuser_8c.html#a5">LPVOID</a>)UIntToPtr( cnt );
00210 
00211     <span class="comment">/*</span>
00212 <span class="comment">     * if we are to search for a specific id do it.</span>
00213 <span class="comment">     */</span>
00214     <span class="keywordflow">if</span> (iResIndex &lt; 0) {
00215 
00216         <span class="keywordflow">for</span> (i = 0; i &lt; cnt; i++)
00217             <span class="keywordflow">if</span> (pres[i].Name == (<a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>)(-iResIndex))
00218                 <span class="keywordflow">break</span>;
00219     } <span class="keywordflow">else</span> {
00220         i = iResIndex;
00221     }
00222 
00223     <span class="comment">/*</span>
00224 <span class="comment">     * is the index in range?</span>
00225 <span class="comment">     */</span>
00226     <span class="keywordflow">if</span> (i &gt;= cnt)
00227         <span class="keywordflow">return</span> 0;
00228 
00229     <span class="comment">/*</span>
00230 <span class="comment">     * if we get this far the resource has a language part, ick!</span>
00231 <span class="comment">     * !!!for now just punt and return the first one.</span>
00232 <span class="comment">     * !!!BUGBUG we dont handle multi-language icons</span>
00233 <span class="comment">     */</span>
00234     <span class="keywordflow">if</span> (pres[i].OffsetToData &amp; IMAGE_RESOURCE_DATA_IS_DIRECTORY) {
00235 
00236         pdir = (IMAGE_RESOURCE_DIRECTORY*)((LPBYTE)prt +
00237                 (pres[i].OffsetToData &amp; ~IMAGE_RESOURCE_DATA_IS_DIRECTORY));
00238         pres = (IMAGE_RESOURCE_DIRECTORY_ENTRY*)(pdir+1);
00239         i = 0;  <span class="comment">// choose first one</span>
00240     }
00241 
00242     <span class="comment">/*</span>
00243 <span class="comment">     * Nested way to deep for me!</span>
00244 <span class="comment">     */</span>
00245     <span class="keywordflow">if</span> (pres[i].OffsetToData &amp; IMAGE_RESOURCE_DATA_IS_DIRECTORY)
00246         <span class="keywordflow">return</span> 0;
00247 
00248     pent = (IMAGE_RESOURCE_DATA_ENTRY*)((LPBYTE)prt + pres[i].OffsetToData);
00249 
00250     <span class="comment">/*</span>
00251 <span class="comment">     * all OffsetToData fields except the final one are relative to</span>
00252 <span class="comment">     * the start of the section.  the final one is a virtual address</span>
00253 <span class="comment">     * we need to go back to the header and get the virtual address</span>
00254 <span class="comment">     * of the resource section to do this right.</span>
00255 <span class="comment">     */</span>
00256     *pcb = pent-&gt;Size;
00257     <span class="keywordflow">return</span> <a class="code" href="../../d6/d0/extract_8c.html#a34">RVAtoP</a>(pBase, pent-&gt;OffsetToData);
00258 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a37" doxytag="extract.c::GetResourceTableNE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d0/d5/perfuser_8c.html#a5">LPVOID</a> GetResourceTableNE           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d0/d5/perfuser_8c.html#a5">LPVOID</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>pBase</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/extract_8c-source.html#l00266">266</a> of file <a class="el" href="../../d7/d9/extract_8c-source.html">extract.c</a>.
<p>
References <a class="el" href="../../d7/d9/extract_8c-source.html#l00034">LPEXEHDR</a>, <a class="el" href="../../d7/d9/extract_8c-source.html#l00033">LPNEWEXE</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">LPVOID</a>, and <a class="el" href="../../d7/d9/extract_8c-source.html#l00029">MZMAGIC</a>.
<p>
Referenced by <a class="el" href="../../d7/d9/extract_8c-source.html#l00517">ExtractIconFromEXE()</a>.
<p>
<pre class="fragment"><div>00268 {
00269     <a class="code" href="../../d6/d0/extract_8c.html#a26">LPNEWEXE</a> pne;
00270     <a class="code" href="../../d6/d0/extract_8c.html#a27">LPEXEHDR</a> pmz;
00271 
00272     pmz = (<a class="code" href="../../d6/d0/extract_8c.html#a27">LPEXEHDR</a>)pBase;
00273     pne = (<a class="code" href="../../d6/d0/extract_8c.html#a26">LPNEWEXE</a>)((LPBYTE)pBase + pmz-&gt;e_lfanew);
00274 
00275     <span class="keywordflow">if</span> (pmz-&gt;e_magic != <a class="code" href="../../d6/d0/extract_8c.html#a9">MZMAGIC</a>)
00276         <span class="keywordflow">return</span> 0;
00277 
00278     <span class="keywordflow">if</span> (pne-&gt;ne_magic != NEMAGIC)           <span class="comment">// must be a NEWEXE</span>
00279         <span class="keywordflow">return</span> 0;
00280 
00281     <span class="keywordflow">if</span> (pne-&gt;ne_exetyp != NE_WINDOWS &amp;&amp;     <span class="comment">// must be a Win DLL/EXE/386</span>
00282         pne-&gt;ne_exetyp != NE_DEV386)
00283         <span class="keywordflow">return</span> 0;
00284 
00285     <span class="keywordflow">if</span> (pne-&gt;ne_expver &lt; 0x0300)            <span class="comment">// must be 3.0 or greater</span>
00286         <span class="keywordflow">return</span> 0;
00287 
00288     <span class="keywordflow">if</span> (pne-&gt;ne_rsrctab == pne-&gt;ne_restab)  <span class="comment">// no resources</span>
00289         <span class="keywordflow">return</span> 0;
00290 
00291     <span class="keywordflow">return</span> (LPBYTE)pne + pne-&gt;ne_rsrctab;   <span class="comment">// return resource table pointer</span>
00292 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a35" doxytag="extract.c::GetResourceTablePE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d0/d5/perfuser_8c.html#a5">LPVOID</a> GetResourceTablePE           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d0/d5/perfuser_8c.html#a5">LPVOID</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>pBase</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/extract_8c-source.html#l00133">133</a> of file <a class="el" href="../../d7/d9/extract_8c-source.html">extract.c</a>.
<p>
References <a class="el" href="../../d0/d7/halvprnt_8c-source.html#l00031">BYTE</a>, <a class="el" href="../../d7/d9/extract_8c-source.html#l00034">LPEXEHDR</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">LPVOID</a>, <a class="el" href="../../d7/d9/extract_8c-source.html#l00029">MZMAGIC</a>, <a class="el" href="../../d7/d9/extract_8c-source.html#l00040">RESOURCE_VA</a>, and <a class="el" href="../../d7/d9/extract_8c-source.html#l00094">RVAtoP()</a>.
<p>
Referenced by <a class="el" href="../../d7/d9/extract_8c-source.html#l00517">ExtractIconFromEXE()</a>.
<p>
<pre class="fragment"><div>00135 {
00136     <a class="code" href="../../d6/d0/extract_8c.html#a27">LPEXEHDR</a>         pmz;
00137     IMAGE_NT_HEADERS *ppe;
00138 
00139     pmz = (<a class="code" href="../../d6/d0/extract_8c.html#a27">LPEXEHDR</a>)pBase;
00140     ppe = (IMAGE_NT_HEADERS*)((<a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a>*)pBase + pmz-&gt;e_lfanew);
00141 
00142     <span class="keywordflow">if</span> (pmz-&gt;e_magic != <a class="code" href="../../d6/d0/extract_8c.html#a9">MZMAGIC</a>)
00143         <span class="keywordflow">return</span> 0;
00144 
00145     <span class="keywordflow">if</span> (ppe-&gt;Signature != IMAGE_NT_SIGNATURE)
00146         <span class="keywordflow">return</span> 0;
00147 
00148     <span class="keywordflow">if</span> (ppe-&gt;FileHeader.SizeOfOptionalHeader &lt; IMAGE_SIZEOF_NT_OPTIONAL_HEADER)
00149         <span class="keywordflow">return</span> 0;
00150 
00151     <span class="keywordflow">return</span> <a class="code" href="../../d6/d0/extract_8c.html#a34">RVAtoP</a>(pBase, <a class="code" href="../../d6/d0/extract_8c.html#a12">RESOURCE_VA</a>(ppe));
00152 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a44" doxytag="extract.c::HasExtension" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> HasExtension           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">LPWSTR&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>pszPath</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/extract_8c-source.html#l00765">765</a> of file <a class="el" href="../../d7/d9/extract_8c-source.html">extract.c</a>.
<p>
References <a class="el" href="../../d7/d9/extract_8c-source.html#l00047">BAT_FILE</a>, <a class="el" href="../../d7/d9/extract_8c-source.html#l00048">CMD_FILE</a>, <a class="el" href="../../d7/d9/extract_8c-source.html#l00046">COM_FILE</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d7/d9/extract_8c-source.html#l00052">EXE_FILE</a>, <a class="el" href="../../d7/d9/extract_8c-source.html#l00051">ICO_FILE</a>, <a class="el" href="../../d3/d9/aw_8h-source.html#l00031">L</a>, <a class="el" href="../../d7/d9/extract_8c-source.html#l00050">LNK_FILE</a>, <a class="el" href="../../d7/d9/extract_8c-source.html#l00702">PathFindExtension()</a>, and <a class="el" href="../../d7/d9/extract_8c-source.html#l00049">PIF_FILE</a>.
<p>
Referenced by <a class="el" href="../../d7/d9/extract_8c-source.html#l00830">PrivateExtractIconsW()</a>.
<p>
<pre class="fragment"><div>00767 {
00768     LPWSTR p = <a class="code" href="../../d6/d0/extract_8c.html#a42">PathFindExtension</a>(pszPath);
00769 
00770     <span class="comment">/*</span>
00771 <span class="comment">     * BUGBUG - BobDay - Shouldn't this limit the length to 4 characters?</span>
00772 <span class="comment">     * "Fister.Bather" would return .BAT</span>
00773 <span class="comment">     *</span>
00774 <span class="comment">     * BUGBUG - BobDay - We could make this EXTKEY based like the extension</span>
00775 <span class="comment">     * matching stuff elsewhere.  EXTKEY is a QWORD value so UNICODE would</span>
00776 <span class="comment">     * fit.</span>
00777 <span class="comment">     */</span>
00778     <span class="keywordflow">if</span> (*p == <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="charliteral">'.'</span>) {
00779 
00780         WCHAR szExt[5];
00781 
00782         lstrcpynW(szExt, p, 5);
00783 
00784         <span class="keywordflow">if</span> (lstrcmpiW(szExt,TEXT(<span class="stringliteral">".com"</span>)) == 0) <span class="keywordflow">return</span> <a class="code" href="../../d6/d0/extract_8c.html#a16">COM_FILE</a>;
00785         <span class="keywordflow">if</span> (lstrcmpiW(szExt,TEXT(<span class="stringliteral">".bat"</span>)) == 0) <span class="keywordflow">return</span> <a class="code" href="../../d6/d0/extract_8c.html#a17">BAT_FILE</a>;
00786         <span class="keywordflow">if</span> (lstrcmpiW(szExt,TEXT(<span class="stringliteral">".cmd"</span>)) == 0) <span class="keywordflow">return</span> <a class="code" href="../../d6/d0/extract_8c.html#a18">CMD_FILE</a>;
00787         <span class="keywordflow">if</span> (lstrcmpiW(szExt,TEXT(<span class="stringliteral">".pif"</span>)) == 0) <span class="keywordflow">return</span> <a class="code" href="../../d6/d0/extract_8c.html#a19">PIF_FILE</a>;
00788         <span class="keywordflow">if</span> (lstrcmpiW(szExt,TEXT(<span class="stringliteral">".lnk"</span>)) == 0) <span class="keywordflow">return</span> <a class="code" href="../../d6/d0/extract_8c.html#a20">LNK_FILE</a>;
00789         <span class="keywordflow">if</span> (lstrcmpiW(szExt,TEXT(<span class="stringliteral">".ico"</span>)) == 0) <span class="keywordflow">return</span> <a class="code" href="../../d6/d0/extract_8c.html#a21">ICO_FILE</a>;
00790         <span class="keywordflow">if</span> (lstrcmpiW(szExt,TEXT(<span class="stringliteral">".exe"</span>)) == 0) <span class="keywordflow">return</span> <a class="code" href="../../d6/d0/extract_8c.html#a22">EXE_FILE</a>;
00791     }
00792 
00793     <span class="keywordflow">return</span> 0;
00794 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a42" doxytag="extract.c::PathFindExtension" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> LPWSTR PathFindExtension           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">LPWSTR&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>pszPath</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/extract_8c-source.html#l00702">702</a> of file <a class="el" href="../../d7/d9/extract_8c-source.html">extract.c</a>.
<p>
References <a class="el" href="../../d3/d9/aw_8h-source.html#l00031">L</a>, and <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>.
<p>
Referenced by <a class="el" href="../../d7/d9/extract_8c-source.html#l00765">HasExtension()</a>.
<p>
<pre class="fragment"><div>00704 {
00705     LPWSTR pszDot;
00706 
00707     <span class="keywordflow">for</span> (pszDot = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>; *pszPath; pszPath = CharNext(pszPath)) {
00708 
00709         <span class="keywordflow">switch</span> (*pszPath) {
00710         <span class="keywordflow">case</span> <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="charliteral">'.'</span>:
00711             pszDot = pszPath;    <span class="comment">// remember the last dot</span>
00712             <span class="keywordflow">break</span>;
00713 
00714         <span class="keywordflow">case</span> <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="charliteral">'\\'</span>:
00715         <span class="keywordflow">case</span> <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="charliteral">' '</span>:               <span class="comment">// extensions can't have spaces</span>
00716             pszDot = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;       <span class="comment">// forget last dot, it was in a directory</span>
00717             <span class="keywordflow">break</span>;
00718         }
00719     }
00720 
00721     <span class="comment">/*</span>
00722 <span class="comment">     * if we found the extension, return ptr to the dot, else</span>
00723 <span class="comment">     * ptr to end of the string (NULL extension) (cast-&gt;non const)</span>
00724 <span class="comment">     */</span>
00725     <span class="keywordflow">return</span> pszDot ? (LPWSTR)pszDot : (LPWSTR)pszPath;
00726 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a32" doxytag="extract.c::PathIsUNC" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> __inline BOOL PathIsUNC           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">LPWSTR&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>psz</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/extract_8c-source.html#l00068">68</a> of file <a class="el" href="../../d7/d9/extract_8c-source.html">extract.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, and <a class="el" href="../../d3/d9/aw_8h-source.html#l00031">L</a>.
<p>
Referenced by <a class="el" href="../../d7/d9/extract_8c-source.html#l00830">PrivateExtractIconsW()</a>.
<p>
<pre class="fragment"><div>00070 {
00071     <span class="keywordflow">return</span> (psz[0] == <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="charliteral">'\\'</span> &amp;&amp; psz[1] == <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="charliteral">'\\'</span>);
00072 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a43" doxytag="extract.c::PrivateExtractIconExA" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> WINUSERAPI UINT PrivateExtractIconExA           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">LPCSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>szFileName</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>nIconIndex</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HICON *&nbsp;</td>
          <td class="mdname" nowrap> <em>phiconLarge</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HICON *&nbsp;</td>
          <td class="mdname" nowrap> <em>phiconSmall</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>nIcons</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/extract_8c-source.html#l00735">735</a> of file <a class="el" href="../../d7/d9/extract_8c-source.html">extract.c</a>.
<p>
References <a class="el" href="../../d7/d9/extract_8c-source.html#l01072">PrivateExtractIconExW()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d0/d5/ndismain_8h-source.html#l00026">UINT</a>, and <a class="el" href="../../d7/d9/usercli_8h-source.html#l00960">UserLocalFree</a>.
<p>
<pre class="fragment"><div>00741 {
00742     LPWSTR szFileNameW;
00743     <a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a>    uRet;
00744 
00745     <span class="keywordflow">if</span> (!MBToWCS(szFileName, -1, &amp;szFileNameW, -1, TRUE))
00746         <span class="keywordflow">return</span> 0;
00747 
00748     uRet = <a class="code" href="../../d6/d0/extract_8c.html#a47">PrivateExtractIconExW</a>(szFileNameW,
00749                                  nIconIndex,
00750                                  phiconLarge,
00751                                  phiconSmall,
00752                                  nIcons);
00753 
00754     <a class="code" href="../../d6/d0/usercli_8h.html#a138">UserLocalFree</a>(szFileNameW);
00755 
00756     <span class="keywordflow">return</span> uRet;
00757 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a47" doxytag="extract.c::PrivateExtractIconExW" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> WINUSERAPI UINT PrivateExtractIconExW           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">LPCWSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>szFileName</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>nIconIndex</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HICON *&nbsp;</td>
          <td class="mdname" nowrap> <em>phiconLarge</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HICON *&nbsp;</td>
          <td class="mdname" nowrap> <em>phiconSmall</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>nIcons</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/extract_8c-source.html#l01072">1072</a> of file <a class="el" href="../../d7/d9/extract_8c-source.html">extract.c</a>.
<p>
References <a class="el" href="../../d4/d8/client_2wow_8c-source.html#l00401">GetSystemMetrics()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d7/d9/extract_8c-source.html#l00830">PrivateExtractIconsW()</a>, and <a class="el" href="../../d0/d5/ndismain_8h-source.html#l00026">UINT</a>.
<p>
Referenced by <a class="el" href="../../d1/d4/srvinit_8c-source.html#l00360">LoadLinkInfo()</a>, and <a class="el" href="../../d7/d9/extract_8c-source.html#l00735">PrivateExtractIconExA()</a>.
<p>
<pre class="fragment"><div>01078 {
01079     <a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a> result = 0;
01080 
01081     <span class="keywordflow">if</span> ((nIconIndex == -1) || ((phiconLarge == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) &amp;&amp; (phiconSmall == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)))
01082         <span class="keywordflow">return</span> <a class="code" href="../../d6/d0/extract_8c.html#a45">PrivateExtractIconsW</a>(szFileName, 0, 0, 0, NULL, NULL, 0, 0);
01083 
01084     <span class="keywordflow">if</span> (phiconLarge &amp;&amp; phiconSmall &amp;&amp; (nIcons == 1)) {
01085 
01086         HICON ahicon[2];
01087 
01088         ahicon[0] = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01089         ahicon[1] = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01090 
01091         result = <a class="code" href="../../d6/d0/extract_8c.html#a45">PrivateExtractIconsW</a>(szFileName,
01092                                       nIconIndex,
01093                                       MAKELONG(<a class="code" href="../../d3/d9/client_2wow_8c.html#a16">GetSystemMetrics</a>(SM_CXICON),
01094                                                <a class="code" href="../../d3/d9/client_2wow_8c.html#a16">GetSystemMetrics</a>(SM_CXSMICON)),
01095                                       MAKELONG(<a class="code" href="../../d3/d9/client_2wow_8c.html#a16">GetSystemMetrics</a>(SM_CYICON),
01096                                                <a class="code" href="../../d3/d9/client_2wow_8c.html#a16">GetSystemMetrics</a>(SM_CYSMICON)),
01097                                       ahicon,
01098                                       NULL,
01099                                       2,
01100                                       0);
01101 
01102         *phiconLarge = ahicon[0];
01103         *phiconSmall = ahicon[1];
01104 
01105     } <span class="keywordflow">else</span> {
01106 
01107         <span class="keywordflow">if</span> (phiconLarge)
01108             result = <a class="code" href="../../d6/d0/extract_8c.html#a45">PrivateExtractIconsW</a>(szFileName,
01109                                           nIconIndex,
01110                                           <a class="code" href="../../d3/d9/client_2wow_8c.html#a16">GetSystemMetrics</a>(SM_CXICON),
01111                                           <a class="code" href="../../d3/d9/client_2wow_8c.html#a16">GetSystemMetrics</a>(SM_CYICON),
01112                                           phiconLarge,
01113                                           NULL,
01114                                           nIcons,
01115                                           0);
01116 
01117         <span class="keywordflow">if</span> (phiconSmall)
01118             result = <a class="code" href="../../d6/d0/extract_8c.html#a45">PrivateExtractIconsW</a>(szFileName,
01119                                           nIconIndex,
01120                                           <a class="code" href="../../d3/d9/client_2wow_8c.html#a16">GetSystemMetrics</a>(SM_CXSMICON),
01121                                           <a class="code" href="../../d3/d9/client_2wow_8c.html#a16">GetSystemMetrics</a>(SM_CYSMICON),
01122                                           phiconSmall,
01123                                           NULL,
01124                                           nIcons,
01125                                           0);
01126     }
01127 
01128     <span class="keywordflow">return</span> result;
01129 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a46" doxytag="extract.c::PrivateExtractIconsA" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> WINUSERAPI UINT WINAPI PrivateExtractIconsA           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">LPCSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>szFileName</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>nIconIndex</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>cxIcon</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>cyIcon</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HICON *&nbsp;</td>
          <td class="mdname" nowrap> <em>phicon</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT *&nbsp;</td>
          <td class="mdname" nowrap> <em>piconid</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>nIcons</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>flags</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/extract_8c-source.html#l01019">1019</a> of file <a class="el" href="../../d7/d9/extract_8c-source.html">extract.c</a>.
<p>
References <a class="el" href="../../d7/d9/extract_8c-source.html#l00830">PrivateExtractIconsW()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d0/d5/ndismain_8h-source.html#l00026">UINT</a>, and <a class="el" href="../../d7/d9/usercli_8h-source.html#l00960">UserLocalFree</a>.
<p>
<pre class="fragment"><div>01028 {
01029     LPWSTR szFileNameW;
01030     <a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a> uRet;
01031 
01032     <span class="keywordflow">if</span> (!MBToWCS(szFileName, -1, &amp;szFileNameW, -1, TRUE))
01033         <span class="keywordflow">return</span> 0;
01034 
01035     uRet = <a class="code" href="../../d6/d0/extract_8c.html#a45">PrivateExtractIconsW</a>(szFileNameW,
01036                                 nIconIndex,
01037                                 cxIcon,
01038                                 cyIcon,
01039                                 phicon,
01040                                 piconid,
01041                                 nIcons,
01042                                 flags);
01043 
01044     <a class="code" href="../../d6/d0/usercli_8h.html#a138">UserLocalFree</a>(szFileNameW);
01045 
01046     <span class="keywordflow">return</span> uRet;
01047 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a45" doxytag="extract.c::PrivateExtractIconsW" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> WINUSERAPI UINT WINAPI PrivateExtractIconsW           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">LPCWSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>szFileName</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>nIconIndex</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>cxIcon</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>cyIcon</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HICON *&nbsp;</td>
          <td class="mdname" nowrap> <em>phicon</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT *&nbsp;</td>
          <td class="mdname" nowrap> <em>piconid</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>nIcons</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>flags</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/extract_8c-source.html#l00830">830</a> of file <a class="el" href="../../d7/d9/extract_8c-source.html">extract.c</a>.
<p>
References <a class="el" href="../../d7/d9/extract_8c-source.html#l00025">ANI_MAGIC</a>, <a class="el" href="../../d7/d9/extract_8c-source.html#l00026">ANI_MAGIC1</a>, <a class="el" href="../../d7/d9/extract_8c-source.html#l00027">ANI_MAGIC4</a>, <a class="el" href="../../d7/d9/extract_8c-source.html#l00028">ANI_MAGIC5</a>, <a class="el" href="../../d7/d9/extract_8c-source.html#l00019">ARRAYSIZE</a>, <a class="el" href="../../d7/d9/extract_8c-source.html#l00047">BAT_FILE</a>, <a class="el" href="../../d7/d9/extract_8c-source.html#l00024">BMP_MAGIC</a>, <a class="el" href="../../d7/d9/extract_8c-source.html#l00048">CMD_FILE</a>, <a class="el" href="../../d7/d9/extract_8c-source.html#l00046">COM_FILE</a>, <a class="el" href="../../d7/d9/extract_8c-source.html#l00023">CUR_MAGIC1</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d0/d1/fedefs_8h-source.html#l00051">exit</a>, <a class="el" href="../../d7/d9/extract_8c-source.html#l00426">ExtractIconFromBMP()</a>, <a class="el" href="../../d7/d9/extract_8c-source.html#l00517">ExtractIconFromEXE()</a>, <a class="el" href="../../d7/d9/extract_8c-source.html#l00368">ExtractIconFromICO()</a>, <a class="el" href="../../d7/d9/extract_8c-source.html#l00765">HasExtension()</a>, <a class="el" href="../../d7/d9/extract_8c-source.html#l00022">ICO_MAGIC1</a>, <a class="el" href="../../d7/d9/extract_8c-source.html#l00021">ICON_MAGIC</a>, <a class="el" href="../../d6/d3/rxact_8c-source.html#l00212">INVALID_HANDLE_VALUE</a>, <a class="el" href="../../d7/d9/extract_8c-source.html#l00050">LNK_FILE</a>, <a class="el" href="../../d4/d8/arcinst_8c-source.html#l00065">MAX_PATH</a>, <a class="el" href="../../d7/d9/extract_8c-source.html#l00029">MZMAGIC</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d4/d8/ntfsexp_8h.html#a141a69">OPEN_EXISTING</a>, <a class="el" href="../../d7/d9/extract_8c-source.html#l00068">PathIsUNC()</a>, <a class="el" href="../../d7/d9/extract_8c-source.html#l00049">PIF_FILE</a>, and <a class="el" href="../../d0/d5/ndismain_8h-source.html#l00026">UINT</a>.
<p>
Referenced by <a class="el" href="../../d7/d9/extract_8c-source.html#l01072">PrivateExtractIconExW()</a>, and <a class="el" href="../../d7/d9/extract_8c-source.html#l01019">PrivateExtractIconsA()</a>.
<p>
<pre class="fragment"><div>00839 {
00840     HANDLE   hFile = (HANDLE)<a class="code" href="../../d5/d4/rxact_8c.html#a0">INVALID_HANDLE_VALUE</a>;
00841     <a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a>     result = 0;
00842     WORD     magic[6];
00843     WCHAR    achFileName[<a class="code" href="../../d3/d9/arcinst_8c.html#a6">MAX_PATH</a>];
00844     FILETIME ftAccess;
00845     WCHAR    szExpFileName[<a class="code" href="../../d3/d9/arcinst_8c.html#a6">MAX_PATH</a>];
00846     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>    dwBytesRead;
00847 
00848     <span class="comment">/*</span>
00849 <span class="comment">     * Set failure defaults.</span>
00850 <span class="comment">     */</span>
00851     <span class="keywordflow">if</span> (phicon)
00852         *phicon = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00853 
00854     <span class="comment">/*</span>
00855 <span class="comment">     * Check for special extensions, and fail quick</span>
00856 <span class="comment">     */</span>
00857     <span class="keywordflow">switch</span> (<a class="code" href="../../d6/d0/extract_8c.html#a44">HasExtension</a>((LPWSTR)szFileName)) {
00858     <span class="keywordflow">case</span> <a class="code" href="../../d6/d0/extract_8c.html#a16">COM_FILE</a>:
00859     <span class="keywordflow">case</span> <a class="code" href="../../d6/d0/extract_8c.html#a17">BAT_FILE</a>:
00860     <span class="keywordflow">case</span> <a class="code" href="../../d6/d0/extract_8c.html#a18">CMD_FILE</a>:
00861     <span class="keywordflow">case</span> <a class="code" href="../../d6/d0/extract_8c.html#a19">PIF_FILE</a>:
00862     <span class="keywordflow">case</span> <a class="code" href="../../d6/d0/extract_8c.html#a20">LNK_FILE</a>:
00863         <span class="keywordflow">goto</span> <a class="code" href="../../d9/d1/fedefs_8h.html#a16">exit</a>;
00864 
00865     <span class="keywordflow">default</span>:
00866         <span class="keywordflow">break</span>;
00867     }
00868 
00869     <span class="comment">/*</span>
00870 <span class="comment">     * Try expanding environment variables in the file name we're passed.</span>
00871 <span class="comment">     */</span>
00872     ExpandEnvironmentStrings(szFileName, szExpFileName, MAX_PATH);
00873     szExpFileName[ <a class="code" href="../../d3/d9/arcinst_8c.html#a6">MAX_PATH</a>-1 ] = (WCHAR)0;
00874 
00875     <span class="comment">/*</span>
00876 <span class="comment">     * Open the file - First check to see if it is a UNC path.  If it</span>
00877 <span class="comment">     * is make sure that we have access to the path...</span>
00878 <span class="comment">     */</span>
00879     <span class="keywordflow">if</span> (<a class="code" href="../../d6/d0/extract_8c.html#a32">PathIsUNC</a>(szExpFileName)) {
00880 
00881         lstrcpynW(achFileName, szExpFileName, <a class="code" href="../../d6/d0/extract_8c.html#a0">ARRAYSIZE</a>(achFileName));     <span class="comment">// BUGBUG sizeof</span>
00882 
00883     } <span class="keywordflow">else</span> {
00884 
00885         <span class="keywordflow">if</span> (SearchPath(NULL,
00886                        szExpFileName,
00887                        NULL,
00888                        <a class="code" href="../../d6/d0/extract_8c.html#a0">ARRAYSIZE</a>(achFileName),
00889                        achFileName, NULL) == 0) {
00890 
00891             <span class="keywordflow">goto</span> error_file;
00892         }
00893     }
00894 
00895     hFile = CreateFile(achFileName,
00896                        GENERIC_READ|FILE_WRITE_ATTRIBUTES,
00897                        FILE_SHARE_WRITE | FILE_SHARE_READ,
00898                        NULL,
00899                        OPEN_EXISTING,
00900                        FILE_ATTRIBUTE_NORMAL | FILE_FLAG_RANDOM_ACCESS,
00901                        0);
00902 
00903     <span class="keywordflow">if</span> (hFile == <a class="code" href="../../d5/d4/rxact_8c.html#a0">INVALID_HANDLE_VALUE</a>) {
00904 
00905         hFile = CreateFile(achFileName, GENERIC_READ,
00906                            FILE_SHARE_READ,
00907                            NULL,
00908                            OPEN_EXISTING,
00909                            FILE_ATTRIBUTE_NORMAL | FILE_FLAG_RANDOM_ACCESS,
00910                            0);
00911 
00912         <span class="keywordflow">if</span> (hFile == <a class="code" href="../../d5/d4/rxact_8c.html#a0">INVALID_HANDLE_VALUE</a>)
00913             <span class="keywordflow">goto</span> error_file;
00914 
00915     } <span class="keywordflow">else</span> {
00916 
00917         <span class="comment">/*</span>
00918 <span class="comment">         * Restore the Access Date</span>
00919 <span class="comment">         */</span>
00920         <span class="keywordflow">if</span> (GetFileTime(hFile, NULL, &amp;ftAccess, NULL))
00921             SetFileTime(hFile, NULL, &amp;ftAccess, NULL);
00922     }
00923 
00924 
00925     ReadFile(hFile, &amp;magic, <span class="keyword">sizeof</span>(magic), &amp;dwBytesRead, NULL);
00926     <span class="keywordflow">if</span> (dwBytesRead != <span class="keyword">sizeof</span>(magic))
00927         <span class="keywordflow">goto</span> <a class="code" href="../../d9/d1/fedefs_8h.html#a16">exit</a>;
00928 
00929     <span class="keywordflow">if</span> (piconid)
00930         *piconid = (<a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a>)-1;    <span class="comment">// Fill in "don't know" value</span>
00931 
00932     <span class="keywordflow">switch</span> (magic[0]) {
00933     <span class="keywordflow">case</span> <a class="code" href="../../d6/d0/extract_8c.html#a9">MZMAGIC</a>:
00934         result = <a class="code" href="../../d6/d0/extract_8c.html#a41">ExtractIconFromEXE</a>(hFile,
00935                                     nIconIndex,
00936                                     cxIcon,
00937                                     cyIcon,
00938                                     phicon,
00939                                     piconid,
00940                                     nIcons,
00941                                     flags);
00942         <span class="keywordflow">break</span>;
00943 
00944     <span class="keywordflow">case</span> <a class="code" href="../../d6/d0/extract_8c.html#a5">ANI_MAGIC</a>:    <span class="comment">// possible .ani cursor</span>
00945 
00946         <span class="comment">/*</span>
00947 <span class="comment">         * Ani cursors are easy they are RIFF files of type 'ACON'</span>
00948 <span class="comment">         */</span>
00949         <span class="keywordflow">if</span> (magic[1] == <a class="code" href="../../d6/d0/extract_8c.html#a6">ANI_MAGIC1</a> &amp;&amp; magic[4] == <a class="code" href="../../d6/d0/extract_8c.html#a7">ANI_MAGIC4</a> &amp;&amp;
00950             magic[5] == <a class="code" href="../../d6/d0/extract_8c.html#a8">ANI_MAGIC5</a>) {
00951 
00952             result = <a class="code" href="../../d6/d0/extract_8c.html#a39">ExtractIconFromICO</a>(achFileName,
00953                                         nIconIndex,
00954                                         cxIcon,
00955                                         cyIcon,
00956                                         phicon,
00957                                         flags);
00958         }
00959         <span class="keywordflow">break</span>;
00960 
00961     <span class="keywordflow">case</span> <a class="code" href="../../d6/d0/extract_8c.html#a4">BMP_MAGIC</a>:    <span class="comment">// possible bitmap</span>
00962         result = <a class="code" href="../../d6/d0/extract_8c.html#a40">ExtractIconFromBMP</a>(achFileName,
00963                                     nIconIndex,
00964                                     cxIcon,
00965                                     cyIcon,
00966                                     phicon,
00967                                     flags);
00968         <span class="keywordflow">break</span>;
00969 
00970     <span class="keywordflow">case</span> <a class="code" href="../../d6/d0/extract_8c.html#a1">ICON_MAGIC</a>:   <span class="comment">// possible .ico or .cur</span>
00971 
00972         <span class="comment">/*</span>
00973 <span class="comment">         * Icons and cursors look like this</span>
00974 <span class="comment">         *</span>
00975 <span class="comment">         * iReserved       - always zero</span>
00976 <span class="comment">         * iResourceType   - 1 for icons 2 cor cursor.</span>
00977 <span class="comment">         * cresIcons       - number of resolutions in this file</span>
00978 <span class="comment">         *</span>
00979 <span class="comment">         * We only allow 1 &lt;= cresIcons &lt;= 10</span>
00980 <span class="comment">         */</span>
00981         <span class="keywordflow">if</span> ((magic[1] == <a class="code" href="../../d6/d0/extract_8c.html#a2">ICO_MAGIC1</a> || magic[1] == <a class="code" href="../../d6/d0/extract_8c.html#a3">CUR_MAGIC1</a>) &amp;&amp;
00982             magic[2] &gt;= 1 &amp;&amp; magic[2] &lt;= 10) {
00983 
00984             result = <a class="code" href="../../d6/d0/extract_8c.html#a39">ExtractIconFromICO</a>(achFileName,
00985                                         nIconIndex,
00986                                         cxIcon,
00987                                         cyIcon,
00988                                         phicon,
00989                                         flags);
00990         }
00991         <span class="keywordflow">break</span>;
00992     }
00993 
00994 <a class="code" href="../../d9/d1/fedefs_8h.html#a16">exit</a>:
00995 
00996     <span class="keywordflow">if</span> (hFile!=<a class="code" href="../../d5/d4/rxact_8c.html#a0">INVALID_HANDLE_VALUE</a>)
00997         CloseHandle(hFile);
00998 
00999     <span class="keywordflow">return</span> result;
01000 
01001     <span class="comment">/*</span>
01002 <span class="comment">     *  if we cant open the file, return a code saying we cant open the file</span>
01003 <span class="comment">     *  if phicon==NULL return the count of icons in the file 0</span>
01004 <span class="comment">     */</span>
01005 
01006 error_file:
01007 
01008     result = (phicon ? (<a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a>)-1 : 0);
01009 
01010     <span class="keywordflow">goto</span> <a class="code" href="../../d9/d1/fedefs_8h.html#a16">exit</a>;
01011 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a33" doxytag="extract.c::ReadAByte" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL ReadAByte           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">LPCVOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>pMem</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/extract_8c-source.html#l00082">82</a> of file <a class="el" href="../../d7/d9/extract_8c-source.html">extract.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, and <a class="el" href="../../d0/d7/halvprnt_8c-source.html#l00031">PBYTE</a>.
<p>
Referenced by <a class="el" href="../../d7/d9/extract_8c-source.html#l00517">ExtractIconFromEXE()</a>.
<p>
<pre class="fragment"><div>00084 {
00085     <span class="keywordflow">return</span> ((*(<a class="code" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a>)pMem) == 0);
00086 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a34" doxytag="extract.c::RVAtoP" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d0/d5/perfuser_8c.html#a5">LPVOID</a> RVAtoP           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d0/d5/perfuser_8c.html#a5">LPVOID</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pBase</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>rva</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/extract_8c-source.html#l00094">94</a> of file <a class="el" href="../../d7/d9/extract_8c-source.html">extract.c</a>.
<p>
References <a class="el" href="../../d0/d7/halvprnt_8c-source.html#l00031">BYTE</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d7/d9/extract_8c-source.html#l00034">LPEXEHDR</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">LPVOID</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, and <a class="el" href="../../d7/d9/extract_8c-source.html#l00042">NUMBER_OF_SECTIONS</a>.
<p>
Referenced by <a class="el" href="../../d7/d9/extract_8c-source.html#l00165">FindResourcePE()</a>, and <a class="el" href="../../d7/d9/extract_8c-source.html#l00133">GetResourceTablePE()</a>.
<p>
<pre class="fragment"><div>00097 {
00098     <a class="code" href="../../d6/d0/extract_8c.html#a27">LPEXEHDR</a>             pmz;
00099     IMAGE_NT_HEADERS     *ppe;
00100     IMAGE_SECTION_HEADER *pSection; <span class="comment">// section table</span>
00101     <span class="keywordtype">int</span>                  i;
00102     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>                size;
00103 
00104     pmz = (<a class="code" href="../../d6/d0/extract_8c.html#a27">LPEXEHDR</a>)pBase;
00105     ppe = (IMAGE_NT_HEADERS*)((<a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a>*)pBase + pmz-&gt;e_lfanew);
00106 
00107     <span class="comment">/*</span>
00108 <span class="comment">     * Scan the section table looking for the RVA</span>
00109 <span class="comment">     */</span>
00110     pSection = IMAGE_FIRST_SECTION(ppe);
00111 
00112     <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="../../d6/d0/extract_8c.html#a14">NUMBER_OF_SECTIONS</a>(ppe); i++) {
00113 
00114         size = pSection[i].Misc.VirtualSize ?
00115                pSection[i].Misc.VirtualSize : pSection[i].SizeOfRawData;
00116 
00117         <span class="keywordflow">if</span> (rva &gt;= pSection[i].VirtualAddress &amp;&amp;
00118             rva &lt;  pSection[i].VirtualAddress + size) {
00119 
00120             <span class="keywordflow">return</span> (LPBYTE)pBase + pSection[i].PointerToRawData + (rva - pSection[i].VirtualAddress);
00121         }
00122     }
00123 
00124     <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00125 }
</div></pre>    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:43:36 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
