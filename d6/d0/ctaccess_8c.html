<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: ctaccess.c File Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>ctaccess.c File Reference</h1><code>#include "<a class="el" href="../../d3/d5/tsecomm_8c-source.html">tsecomm.c</a>"</code><br>

<p>
<a href="../../d7/d9/ctaccess_8c-source.html">Go to the source code of this file.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Classes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d9/d5/struct__STANDARD__ACE.html">_STANDARD_ACE</a></td></tr>

<tr><td colspan=2><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/ctaccess_8c.html#a0">FirstAce</a>(Acl)&nbsp;&nbsp;&nbsp;((PVOID)((PUCHAR)(Acl) + sizeof(ACL)))</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/ctaccess_8c.html#a1">NextAce</a>(Ace)&nbsp;&nbsp;&nbsp;((PVOID)((PUCHAR)(Ace) + ((PACE_HEADER)(Ace))-&gt;AceSize))</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/ctaccess_8c.html#a2">DEFAULT_DACL_LENGTH</a>&nbsp;&nbsp;&nbsp;(1024L)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/ctaccess_8c.html#a3">GROUP_IDS_LENGTH</a>&nbsp;&nbsp;&nbsp;(1024L)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/ctaccess_8c.html#a4">NEW_GROUP_STATE_LENGTH</a>&nbsp;&nbsp;&nbsp;(1024L)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/ctaccess_8c.html#a5">PRIVILEGES_LENGTH</a>&nbsp;&nbsp;&nbsp;(128L)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/ctaccess_8c.html#a6">TOO_BIG_ACL_SIZE</a>&nbsp;&nbsp;&nbsp;(2048L)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/ctaccess_8c.html#a7">FLINTSTONE_INDEX</a>&nbsp;&nbsp;&nbsp;(0L)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/ctaccess_8c.html#a8">CHILD_INDEX</a>&nbsp;&nbsp;&nbsp;(1L)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/ctaccess_8c.html#a9">NEANDERTHOL_INDEX</a>&nbsp;&nbsp;&nbsp;(2L)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/ctaccess_8c.html#a10">WORLD_INDEX</a>&nbsp;&nbsp;&nbsp;(3L)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/ctaccess_8c.html#a11">GROUP_COUNT</a>&nbsp;&nbsp;&nbsp;(4L)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/ctaccess_8c.html#a12">UNSOLICITED_INDEX</a>&nbsp;&nbsp;&nbsp;(0L)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/ctaccess_8c.html#a13">SECURITY_INDEX</a>&nbsp;&nbsp;&nbsp;(1L)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/ctaccess_8c.html#a14">PRIVILEGE_COUNT</a>&nbsp;&nbsp;&nbsp;(2L)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/ctaccess_8c.html#a15">SET_WIDGET_COLOR</a>&nbsp;&nbsp;&nbsp;0x00000001</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/ctaccess_8c.html#a16">SET_WIDGET_SIZE</a>&nbsp;&nbsp;&nbsp;0x00000002</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/ctaccess_8c.html#a17">GET_WIDGET_COLOR</a>&nbsp;&nbsp;&nbsp;0x00000004</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/ctaccess_8c.html#a18">GET_WIDGET_SIZE</a>&nbsp;&nbsp;&nbsp;0x00000008</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/ctaccess_8c.html#a19">START_WIDGET</a>&nbsp;&nbsp;&nbsp;0x00000010</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/ctaccess_8c.html#a20">STOP_WIDGET</a>&nbsp;&nbsp;&nbsp;0x00000020</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/ctaccess_8c.html#a21">GIVE_WIDGET</a>&nbsp;&nbsp;&nbsp;0x00000040</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/ctaccess_8c.html#a22">TAKE_WIDGET</a>&nbsp;&nbsp;&nbsp;0x00000080</td></tr>

<tr><td colspan=2><br><h2>Typedefs</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d9/d5/struct__STANDARD__ACE.html">_STANDARD_ACE</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/ctaccess_8c.html#a59">STANDARD_ACE</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d9/d5/struct__STANDARD__ACE.html">STANDARD_ACE</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/ctaccess_8c.html#a60">PSTANDARD_ACE</a></td></tr>

<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/ctaccess_8c.html#a61">DumpAcl</a> (IN PACL Acl)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/ctaccess_8c.html#a62">TestTokenInitialize</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/ctaccess_8c.html#a63">CreateDAclToken</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/ctaccess_8c.html#a64">CTAccess</a> ()</td></tr>

<tr><td colspan=2><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/ctaccess_8c.html#a23">Status</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HANDLE&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/ctaccess_8c.html#a24">SimpleToken</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HANDLE&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/ctaccess_8c.html#a25">TokenWithGroups</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HANDLE&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/ctaccess_8c.html#a26">TokenWithDefaultOwner</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HANDLE&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/ctaccess_8c.html#a27">TokenWithPrivileges</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HANDLE&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/ctaccess_8c.html#a28">TokenWithDefaultDacl</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HANDLE&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/ctaccess_8c.html#a29">Token</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HANDLE&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/ctaccess_8c.html#a30">ImpersonationToken</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HANDLE&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/ctaccess_8c.html#a31">PrimaryToken</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HANDLE&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/ctaccess_8c.html#a32">AnonymousToken</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>OBJECT_ATTRIBUTES&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/ctaccess_8c.html#a33">PrimaryTokenAttributes</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>PSECURITY_DESCRIPTOR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/ctaccess_8c.html#a34">PrimarySecurityDescriptor</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>SECURITY_QUALITY_OF_SERVICE&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/ctaccess_8c.html#a35">PrimarySecurityQos</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>OBJECT_ATTRIBUTES&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/ctaccess_8c.html#a36">ImpersonationTokenAttributes</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>PSECURITY_DESCRIPTOR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/ctaccess_8c.html#a37">ImpersonationSecurityDescriptor</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>SECURITY_QUALITY_OF_SERVICE&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/ctaccess_8c.html#a38">ImpersonationSecurityQos</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>OBJECT_ATTRIBUTES&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/ctaccess_8c.html#a39">AnonymousTokenAttributes</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>PSECURITY_DESCRIPTOR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/ctaccess_8c.html#a40">AnonymousSecurityDescriptor</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>SECURITY_QUALITY_OF_SERVICE&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/ctaccess_8c.html#a41">AnonymousSecurityQos</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/ctaccess_8c.html#a42">DisabledGroupAttributes</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/ctaccess_8c.html#a43">OptionalGroupAttributes</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/ctaccess_8c.html#a44">NormalGroupAttributes</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/ctaccess_8c.html#a45">OwnerGroupAttributes</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/ctaccess_8c.html#a46">LengthAvailable</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/ctaccess_8c.html#a47">CurrentLength</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>TIME_FIELDS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/ctaccess_8c.html#a48">TempTimeFields</a> = {3000, 1, 1, 1, 1, 1, 1, 1}</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>LARGE_INTEGER&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/ctaccess_8c.html#a49">NoExpiration</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>LUID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/ctaccess_8c.html#a50">DummyAuthenticationId</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>LUID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/ctaccess_8c.html#a51">SystemAuthenticationId</a> = SYSTEM_LUID</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>TOKEN_SOURCE&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/ctaccess_8c.html#a52">TestSource</a> = {"SE: TEST", 0}</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>PSID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/ctaccess_8c.html#a53">Owner</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>PSID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/ctaccess_8c.html#a54">Group</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>PACL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/ctaccess_8c.html#a55">Dacl</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>PSID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/ctaccess_8c.html#a56">TempOwner</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>PSID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/ctaccess_8c.html#a57">TempGroup</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>PACL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d0/ctaccess_8c.html#a58">TempDacl</a></td></tr>

</table>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="a8" doxytag="ctaccess.c::CHILD_INDEX" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define CHILD_INDEX&nbsp;&nbsp;&nbsp;(1L)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00087">87</a> of file <a class="el" href="../../d7/d9/ctaccess_8c-source.html">ctaccess.c</a>.
<p>
Referenced by <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00299">CreateDAclToken()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l04885">TestTokenAdjustGroups()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l07648">TestTokenAssignPrimary()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00421">TestTokenCreate()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l01085">TestTokenFilter()</a>, and <a class="el" href="../../d3/d0/cttoken_8c-source.html#l01434">TestTokenQuery()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a2" doxytag="ctaccess.c::DEFAULT_DACL_LENGTH" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define DEFAULT_DACL_LENGTH&nbsp;&nbsp;&nbsp;(1024L)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00076">76</a> of file <a class="el" href="../../d7/d9/ctaccess_8c-source.html">ctaccess.c</a>.
<p>
Referenced by <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00299">CreateDAclToken()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l07648">TestTokenAssignPrimary()</a>, and <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00421">TestTokenCreate()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a0" doxytag="ctaccess.c::FirstAce" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define FirstAce          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">Acl&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;((PVOID)((PUCHAR)(Acl) + sizeof(ACL)))</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00051">51</a> of file <a class="el" href="../../d7/d9/ctaccess_8c-source.html">ctaccess.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a7" doxytag="ctaccess.c::FLINTSTONE_INDEX" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define FLINTSTONE_INDEX&nbsp;&nbsp;&nbsp;(0L)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00086">86</a> of file <a class="el" href="../../d7/d9/ctaccess_8c-source.html">ctaccess.c</a>.
<p>
Referenced by <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00299">CreateDAclToken()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l04885">TestTokenAdjustGroups()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l07648">TestTokenAssignPrimary()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00421">TestTokenCreate()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l01085">TestTokenFilter()</a>, and <a class="el" href="../../d3/d0/cttoken_8c-source.html#l01434">TestTokenQuery()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a17" doxytag="ctaccess.c::GET_WIDGET_COLOR" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define GET_WIDGET_COLOR&nbsp;&nbsp;&nbsp;0x00000004          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00107">107</a> of file <a class="el" href="../../d7/d9/ctaccess_8c-source.html">ctaccess.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a18" doxytag="ctaccess.c::GET_WIDGET_SIZE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define GET_WIDGET_SIZE&nbsp;&nbsp;&nbsp;0x00000008          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00108">108</a> of file <a class="el" href="../../d7/d9/ctaccess_8c-source.html">ctaccess.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a21" doxytag="ctaccess.c::GIVE_WIDGET" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define GIVE_WIDGET&nbsp;&nbsp;&nbsp;0x00000040          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00111">111</a> of file <a class="el" href="../../d7/d9/ctaccess_8c-source.html">ctaccess.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a11" doxytag="ctaccess.c::GROUP_COUNT" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define GROUP_COUNT&nbsp;&nbsp;&nbsp;(4L)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00090">90</a> of file <a class="el" href="../../d7/d9/ctaccess_8c-source.html">ctaccess.c</a>.
<p>
Referenced by <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00299">CreateDAclToken()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l04885">TestTokenAdjustGroups()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l07648">TestTokenAssignPrimary()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00421">TestTokenCreate()</a>, and <a class="el" href="../../d3/d0/cttoken_8c-source.html#l01434">TestTokenQuery()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="ctaccess.c::GROUP_IDS_LENGTH" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define GROUP_IDS_LENGTH&nbsp;&nbsp;&nbsp;(1024L)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00077">77</a> of file <a class="el" href="../../d7/d9/ctaccess_8c-source.html">ctaccess.c</a>.
<p>
Referenced by <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00299">CreateDAclToken()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l07648">TestTokenAssignPrimary()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00421">TestTokenCreate()</a>, and <a class="el" href="../../d3/d0/cttoken_8c-source.html#l01085">TestTokenFilter()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a9" doxytag="ctaccess.c::NEANDERTHOL_INDEX" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define NEANDERTHOL_INDEX&nbsp;&nbsp;&nbsp;(2L)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00088">88</a> of file <a class="el" href="../../d7/d9/ctaccess_8c-source.html">ctaccess.c</a>.
<p>
Referenced by <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00299">CreateDAclToken()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l04885">TestTokenAdjustGroups()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l07648">TestTokenAssignPrimary()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00421">TestTokenCreate()</a>, and <a class="el" href="../../d3/d0/cttoken_8c-source.html#l01434">TestTokenQuery()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a4" doxytag="ctaccess.c::NEW_GROUP_STATE_LENGTH" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define NEW_GROUP_STATE_LENGTH&nbsp;&nbsp;&nbsp;(1024L)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00078">78</a> of file <a class="el" href="../../d7/d9/ctaccess_8c-source.html">ctaccess.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="ctaccess.c::NextAce" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define NextAce          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">Ace&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;((PVOID)((PUCHAR)(Ace) + ((PACE_HEADER)(Ace))-&gt;AceSize))</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00063">63</a> of file <a class="el" href="../../d7/d9/ctaccess_8c-source.html">ctaccess.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a14" doxytag="ctaccess.c::PRIVILEGE_COUNT" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define PRIVILEGE_COUNT&nbsp;&nbsp;&nbsp;(2L)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00099">99</a> of file <a class="el" href="../../d7/d9/ctaccess_8c-source.html">ctaccess.c</a>.
<p>
Referenced by <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00299">CreateDAclToken()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l03929">TestTokenAdjustPrivileges()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l07648">TestTokenAssignPrimary()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00421">TestTokenCreate()</a>, and <a class="el" href="../../d3/d0/cttoken_8c-source.html#l01434">TestTokenQuery()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a5" doxytag="ctaccess.c::PRIVILEGES_LENGTH" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define PRIVILEGES_LENGTH&nbsp;&nbsp;&nbsp;(128L)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00079">79</a> of file <a class="el" href="../../d7/d9/ctaccess_8c-source.html">ctaccess.c</a>.
<p>
Referenced by <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00299">CreateDAclToken()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l07648">TestTokenAssignPrimary()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00421">TestTokenCreate()</a>, and <a class="el" href="../../d3/d0/cttoken_8c-source.html#l01085">TestTokenFilter()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a13" doxytag="ctaccess.c::SECURITY_INDEX" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define SECURITY_INDEX&nbsp;&nbsp;&nbsp;(1L)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00098">98</a> of file <a class="el" href="../../d7/d9/ctaccess_8c-source.html">ctaccess.c</a>.
<p>
Referenced by <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00299">CreateDAclToken()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l03929">TestTokenAdjustPrivileges()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l07648">TestTokenAssignPrimary()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00421">TestTokenCreate()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l01085">TestTokenFilter()</a>, and <a class="el" href="../../d3/d0/cttoken_8c-source.html#l01434">TestTokenQuery()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a15" doxytag="ctaccess.c::SET_WIDGET_COLOR" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define SET_WIDGET_COLOR&nbsp;&nbsp;&nbsp;0x00000001          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00105">105</a> of file <a class="el" href="../../d7/d9/ctaccess_8c-source.html">ctaccess.c</a>.
<p>
Referenced by <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00299">CreateDAclToken()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a16" doxytag="ctaccess.c::SET_WIDGET_SIZE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define SET_WIDGET_SIZE&nbsp;&nbsp;&nbsp;0x00000002          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00106">106</a> of file <a class="el" href="../../d7/d9/ctaccess_8c-source.html">ctaccess.c</a>.
<p>
Referenced by <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00299">CreateDAclToken()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a19" doxytag="ctaccess.c::START_WIDGET" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define START_WIDGET&nbsp;&nbsp;&nbsp;0x00000010          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00109">109</a> of file <a class="el" href="../../d7/d9/ctaccess_8c-source.html">ctaccess.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a20" doxytag="ctaccess.c::STOP_WIDGET" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define STOP_WIDGET&nbsp;&nbsp;&nbsp;0x00000020          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00110">110</a> of file <a class="el" href="../../d7/d9/ctaccess_8c-source.html">ctaccess.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a22" doxytag="ctaccess.c::TAKE_WIDGET" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define TAKE_WIDGET&nbsp;&nbsp;&nbsp;0x00000080          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00112">112</a> of file <a class="el" href="../../d7/d9/ctaccess_8c-source.html">ctaccess.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a6" doxytag="ctaccess.c::TOO_BIG_ACL_SIZE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define TOO_BIG_ACL_SIZE&nbsp;&nbsp;&nbsp;(2048L)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00080">80</a> of file <a class="el" href="../../d7/d9/ctaccess_8c-source.html">ctaccess.c</a>.
<p>
Referenced by <a class="el" href="../../d3/d0/cttoken_8c-source.html#l03311">TestTokenSet()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a12" doxytag="ctaccess.c::UNSOLICITED_INDEX" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define UNSOLICITED_INDEX&nbsp;&nbsp;&nbsp;(0L)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00097">97</a> of file <a class="el" href="../../d7/d9/ctaccess_8c-source.html">ctaccess.c</a>.
<p>
Referenced by <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00299">CreateDAclToken()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l03929">TestTokenAdjustPrivileges()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l07648">TestTokenAssignPrimary()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00421">TestTokenCreate()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l01085">TestTokenFilter()</a>, and <a class="el" href="../../d3/d0/cttoken_8c-source.html#l01434">TestTokenQuery()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a10" doxytag="ctaccess.c::WORLD_INDEX" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define WORLD_INDEX&nbsp;&nbsp;&nbsp;(3L)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00089">89</a> of file <a class="el" href="../../d7/d9/ctaccess_8c-source.html">ctaccess.c</a>.
<p>
Referenced by <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00299">CreateDAclToken()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l04885">TestTokenAdjustGroups()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l07648">TestTokenAssignPrimary()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00421">TestTokenCreate()</a>, and <a class="el" href="../../d3/d0/cttoken_8c-source.html#l01434">TestTokenQuery()</a>.    </td>
  </tr>
</table>
<hr><h2>Typedef Documentation</h2>
<a class="anchor" name="a60" doxytag="ctaccess.c::PSTANDARD_ACE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef <a class="el" href="../../d9/d5/struct__STANDARD__ACE.html">STANDARD_ACE</a>* <a class="el" href="../../d9/d5/struct__STANDARD__ACE.html">PSTANDARD_ACE</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l01134">1134</a> of file <a class="el" href="../../d7/d9/ctaccess_8c-source.html">ctaccess.c</a>.
<p>
Referenced by <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l01139">DumpAcl()</a>, and <a class="el" href="../../d2/d8/tacl_8c-source.html#l00055">main()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a59" doxytag="ctaccess.c::STANDARD_ACE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d9/d5/struct__STANDARD__ACE.html">_STANDARD_ACE</a>  <a class="el" href="../../d9/d5/struct__STANDARD__ACE.html">STANDARD_ACE</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d2/d8/tacl_8c-source.html#l00055">main()</a>, and <a class="el" href="../../d4/d5/tseum_8c-source.html#l00282">TestAddAce()</a>.    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a63" doxytag="ctaccess.c::CreateDAclToken" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN CreateDAclToken           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00299">299</a> of file <a class="el" href="../../d7/d9/ctaccess_8c-source.html">ctaccess.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d5/d5/tsevars_8c-source.html#l00096">BarneySid</a>, <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00087">CHILD_INDEX</a>, <a class="el" href="../../d5/d5/tsevars_8c-source.html#l00104">ChildSid</a>, <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00161">Dacl</a>, <a class="el" href="../../d7/d5/memprint_8h-source.html#l00079">DbgPrint</a>, <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00076">DEFAULT_DACL_LENGTH</a>, <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00154">DummyAuthenticationId</a>, <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l01139">DumpAcl()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00086">FLINTSTONE_INDEX</a>, <a class="el" href="../../d5/d5/tsevars_8c-source.html#l00100">FlintstoneSid</a>, <a class="el" href="../../d5/d5/tsevars_8c-source.html#l00091">FredSid</a>, <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00090">GROUP_COUNT</a>, <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00077">GROUP_IDS_LENGTH</a>, <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00124">ImpersonationToken</a>, <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00134">ImpersonationTokenAttributes</a>, <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00088">NEANDERTHOL_INDEX</a>, <a class="el" href="../../d5/d5/tsevars_8c-source.html#l00106">NeandertholSid</a>, <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00152">NoExpiration</a>, <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00144">NormalGroupAttributes</a>, <a class="el" href="../../d6/d5/stierr_8h-source.html#l00030">NT_SUCCESS</a>, <a class="el" href="../../d1/d3/accessck_8c-source.html#l02413">NtAccessCheck()</a>, <a class="el" href="../../d5/d2/token_8c-source.html#l01690">NtCreateToken()</a>, <a class="el" href="../../d0/d1/psquery_8c-source.html#l01510">NtSetInformationProcess()</a>, <a class="el" href="../../d0/d1/psquery_8c-source.html#l03103">NtSetInformationThread()</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00143">OptionalGroupAttributes</a>, <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00159">Owner</a>, <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00145">OwnerGroupAttributes</a>, <a class="el" href="../../d5/d8/ex_8h.html#a329a174">PagedPool</a>, <a class="el" href="../../d5/d5/tsevars_8c-source.html#l00093">PebblesSid</a>, <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00126">PrimaryToken</a>, <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00130">PrimaryTokenAttributes</a>, <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00099">PRIVILEGE_COUNT</a>, <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00079">PRIVILEGES_LENGTH</a>, <a class="el" href="../../d3/d3/acledit_8c-source.html#l00718">RtlAddAce()</a>, <a class="el" href="../../d9/d5/sertl_8c-source.html#l01380">RtlCopySid()</a>, <a class="el" href="../../d3/d3/acledit_8c-source.html#l00099">RtlCreateAcl()</a>, <a class="el" href="../../d9/d5/sertl_8c-source.html#l01945">RtlCreateSecurityDescriptor()</a>, <a class="el" href="../../d3/d3/acledit_8c-source.html#l00895">RtlDeleteAce()</a>, <a class="el" href="../../d9/d5/sertl_8c-source.html#l02543">RtlSetDaclSecurityDescriptor()</a>, <a class="el" href="../../d9/d5/sertl_8c-source.html#l03135">RtlSetGroupSecurityDescriptor()</a>, <a class="el" href="../../d9/d5/sertl_8c-source.html#l02963">RtlSetOwnerSecurityDescriptor()</a>, <a class="el" href="../../d9/d5/sertl_8c-source.html#l02756">RtlSetSaclSecurityDescriptor()</a>, <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00098">SECURITY_INDEX</a>, <a class="el" href="../../d5/d5/tsevars_8c-source.html#l00147">SecurityPrivilege</a>, <a class="el" href="../../d1/d4/se_8h-source.html#l00540">SeLengthSid</a>, <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00105">SET_WIDGET_COLOR</a>, <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00106">SET_WIDGET_SIZE</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00135">Status</a>, <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00157">TestSource</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00097">UNSOLICITED_INDEX</a>, <a class="el" href="../../d5/d5/tsevars_8c-source.html#l00145">UnsolicitedInputPrivilege</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00064">USHORT</a>, <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00089">WORLD_INDEX</a>, and <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html#l00109">WorldSid</a>.
<p>
Referenced by <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l01107">CTAccess()</a>.
<p>
<pre class="fragment"><div>00300 {
00301 
00302     BOOLEAN CompletionStatus = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00303 
00304     TOKEN_USER UserId;
00305     TOKEN_PRIMARY_GROUP PrimaryGroup;
00306     PTOKEN_GROUPS GroupIds;
00307     PTOKEN_PRIVILEGES Privileges;
00308     TOKEN_DEFAULT_DACL DefaultDacl;
00309     TOKEN_OWNER <a class="code" href="../../d6/d0/ctaccess_8c.html#a53">Owner</a>;
00310 
00311     PSECURITY_DESCRIPTOR Widget1SecurityDescriptor;
00312 
00313     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> AccessStatus;
00314 
00315     ACCESS_MASK GrantedAccess;
00316 
00317     PACCESS_ALLOWED_ACE AllowBarneySetColor;
00318     PACCESS_ALLOWED_ACE AllowFredSetColor;
00319 
00320     PACCESS_DENIED_ACE  DenyPebblesSetColor;
00321 
00322     PACCESS_ALLOWED_ACE AllowPebblesSetColor;
00323     PACCESS_DENIED_ACE  DenyFredSetColor;
00324     PACCESS_ALLOWED_ACE AllowBarneySetSize;
00325     PACCESS_ALLOWED_ACE AllowPebblesSetSize;
00326 
00327     PACCESS_ALLOWED_ACE AllowPebblesGetColor;
00328     PACCESS_ALLOWED_ACE AllowPebblesGetSize;
00329 
00330     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a> AllowBarneySetColorLength;
00331     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a> AllowFredSetColorLength;
00332     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a> DenyPebblesSetColorLength;
00333 
00334     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a> AllowPebblesSetColorLength;
00335     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a> DenyFredSetColorLength;
00336     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a> AllowBarneySetSizeLength;
00337     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a> AllowPebblesSetSizeLength;
00338 
00339     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a> AllowPebblesGetColorLength;
00340     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a> AllowPebblesGetSizeLength;
00341 
00342 
00343     <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"\n"</span>);
00344 
00345     GroupIds = (PTOKEN_GROUPS)TstAllocatePool( PagedPool,
00346                                                GROUP_IDS_LENGTH
00347                                                );
00348 
00349     Privileges = (PTOKEN_PRIVILEGES)TstAllocatePool( PagedPool,
00350                                                      PRIVILEGES_LENGTH
00351                                                      );
00352 
00353     DefaultDacl.DefaultDacl = (PACL)TstAllocatePool( PagedPool,
00354                                                      DEFAULT_DACL_LENGTH
00355                                                      );
00356 
00357 
00358     <span class="comment">//</span>
00359     <span class="comment">// Create a token with default DACL</span>
00360     <span class="comment">//</span>
00361 
00362     <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"Se:     Create Token With Default Dacl ...                     "</span>);
00363 
00364     GroupIds-&gt;GroupCount = <a class="code" href="../../d6/d0/ctaccess_8c.html#a11">GROUP_COUNT</a>;
00365 
00366     GroupIds-&gt;Groups[<a class="code" href="../../d6/d0/ctaccess_8c.html#a7">FLINTSTONE_INDEX</a>].Sid  = <a class="code" href="../../d4/d6/tsevars_8c.html#a25">FlintstoneSid</a>;
00367     GroupIds-&gt;Groups[<a class="code" href="../../d6/d0/ctaccess_8c.html#a8">CHILD_INDEX</a>].Sid       = <a class="code" href="../../d4/d6/tsevars_8c.html#a28">ChildSid</a>;
00368     GroupIds-&gt;Groups[<a class="code" href="../../d6/d0/ctaccess_8c.html#a9">NEANDERTHOL_INDEX</a>].Sid = <a class="code" href="../../d4/d6/tsevars_8c.html#a29">NeandertholSid</a>;
00369     GroupIds-&gt;Groups[<a class="code" href="../../d6/d0/ctaccess_8c.html#a10">WORLD_INDEX</a>].Sid       = <a class="code" href="../../d4/d1/rtdmpsec_8c.html#a8">WorldSid</a>;
00370 
00371     GroupIds-&gt;Groups[<a class="code" href="../../d6/d0/ctaccess_8c.html#a7">FLINTSTONE_INDEX</a>].Attributes  = <a class="code" href="../../d6/d0/ctaccess_8c.html#a45">OwnerGroupAttributes</a>;
00372     GroupIds-&gt;Groups[<a class="code" href="../../d6/d0/ctaccess_8c.html#a8">CHILD_INDEX</a>].Attributes       = <a class="code" href="../../d6/d0/ctaccess_8c.html#a43">OptionalGroupAttributes</a>;
00373     GroupIds-&gt;Groups[<a class="code" href="../../d6/d0/ctaccess_8c.html#a9">NEANDERTHOL_INDEX</a>].Attributes = <a class="code" href="../../d6/d0/ctaccess_8c.html#a43">OptionalGroupAttributes</a>;
00374     GroupIds-&gt;Groups[<a class="code" href="../../d6/d0/ctaccess_8c.html#a10">WORLD_INDEX</a>].Attributes       = <a class="code" href="../../d6/d0/ctaccess_8c.html#a44">NormalGroupAttributes</a>;
00375 
00376     UserId.User.Sid = <a class="code" href="../../d4/d6/tsevars_8c.html#a20">PebblesSid</a>;
00377     UserId.User.Attributes = 0;
00378 
00379     <a class="code" href="../../d6/d0/ctaccess_8c.html#a53">Owner</a>.Owner = <a class="code" href="../../d4/d6/tsevars_8c.html#a25">FlintstoneSid</a>;
00380 
00381     Privileges-&gt;PrivilegeCount = <a class="code" href="../../d6/d0/ctaccess_8c.html#a14">PRIVILEGE_COUNT</a>;
00382 
00383     Privileges-&gt;Privileges[<a class="code" href="../../d6/d0/ctaccess_8c.html#a12">UNSOLICITED_INDEX</a>].Luid = <a class="code" href="../../d4/d6/tsevars_8c.html#a44">UnsolicitedInputPrivilege</a>;
00384     Privileges-&gt;Privileges[<a class="code" href="../../d6/d0/ctaccess_8c.html#a13">SECURITY_INDEX</a>].Luid = <a class="code" href="../../d4/d6/tsevars_8c.html#a46">SecurityPrivilege</a>;
00385     Privileges-&gt;Privileges[<a class="code" href="../../d6/d0/ctaccess_8c.html#a12">UNSOLICITED_INDEX</a>].Attributes = 0;
00386     Privileges-&gt;Privileges[<a class="code" href="../../d6/d0/ctaccess_8c.html#a13">SECURITY_INDEX</a>].Attributes = 0;
00387 
00388     PrimaryGroup.PrimaryGroup = <a class="code" href="../../d4/d6/tsevars_8c.html#a25">FlintstoneSid</a>;
00389 
00390     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d2/d4/acledit_8c.html#a6">RtlCreateAcl</a>( DefaultDacl.DefaultDacl, DEFAULT_DACL_LENGTH, ACL_REVISION);
00391 
00392     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status) );
00393 
00394     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d4/d3/token_8c.html#a15">NtCreateToken</a>(
00395                  &amp;PrimaryToken,            <span class="comment">// Handle</span>
00396                  (TOKEN_ALL_ACCESS),       <span class="comment">// DesiredAccess</span>
00397                  &amp;PrimaryTokenAttributes,  <span class="comment">// ObjectAttributes</span>
00398                  TokenPrimary,             <span class="comment">// TokenType</span>
00399                  &amp;DummyAuthenticationId,   <span class="comment">// Authentication LUID</span>
00400                  &amp;NoExpiration,            <span class="comment">// Expiration Time</span>
00401                  &amp;UserId,                  <span class="comment">// Owner ID</span>
00402                  GroupIds,                 <span class="comment">// Group IDs</span>
00403                  Privileges,               <span class="comment">// Privileges</span>
00404                  &amp;Owner,                   <span class="comment">// Owner</span>
00405                  &amp;PrimaryGroup,            <span class="comment">// Primary Group</span>
00406                  &amp;DefaultDacl,             <span class="comment">// Default Dacl</span>
00407                  &amp;TestSource               <span class="comment">// TokenSource</span>
00408                  );
00409 
00410     <span class="keywordflow">if</span> (<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status)) {
00411         <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"Succeeded.\n"</span>);
00412     } <span class="keywordflow">else</span> {
00413         <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"********** Failed ************\n"</span>);
00414         <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"Status is: 0x%lx \n"</span>, Status);
00415         CompletionStatus = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00416     }
00417 
00418     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status));
00419 
00420 
00421 
00422     <span class="comment">//</span>
00423     <span class="comment">// Create an impersonation token, Impersonation level = Impersonation</span>
00424     <span class="comment">//</span>
00425 
00426     <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"Se:     Create an impersonation token ...                      "</span>);
00427 
00428     GroupIds-&gt;GroupCount = <a class="code" href="../../d6/d0/ctaccess_8c.html#a11">GROUP_COUNT</a>;
00429 
00430     GroupIds-&gt;Groups[<a class="code" href="../../d6/d0/ctaccess_8c.html#a7">FLINTSTONE_INDEX</a>].Sid  = <a class="code" href="../../d4/d6/tsevars_8c.html#a25">FlintstoneSid</a>;
00431     GroupIds-&gt;Groups[<a class="code" href="../../d6/d0/ctaccess_8c.html#a8">CHILD_INDEX</a>].Sid       = <a class="code" href="../../d4/d6/tsevars_8c.html#a28">ChildSid</a>;
00432     GroupIds-&gt;Groups[<a class="code" href="../../d6/d0/ctaccess_8c.html#a9">NEANDERTHOL_INDEX</a>].Sid = <a class="code" href="../../d4/d6/tsevars_8c.html#a29">NeandertholSid</a>;
00433     GroupIds-&gt;Groups[<a class="code" href="../../d6/d0/ctaccess_8c.html#a10">WORLD_INDEX</a>].Sid       = <a class="code" href="../../d4/d1/rtdmpsec_8c.html#a8">WorldSid</a>;
00434 
00435     GroupIds-&gt;Groups[<a class="code" href="../../d6/d0/ctaccess_8c.html#a7">FLINTSTONE_INDEX</a>].Attributes  = <a class="code" href="../../d6/d0/ctaccess_8c.html#a45">OwnerGroupAttributes</a>;
00436     GroupIds-&gt;Groups[<a class="code" href="../../d6/d0/ctaccess_8c.html#a8">CHILD_INDEX</a>].Attributes       = <a class="code" href="../../d6/d0/ctaccess_8c.html#a43">OptionalGroupAttributes</a>;
00437     GroupIds-&gt;Groups[<a class="code" href="../../d6/d0/ctaccess_8c.html#a9">NEANDERTHOL_INDEX</a>].Attributes = <a class="code" href="../../d6/d0/ctaccess_8c.html#a43">OptionalGroupAttributes</a>;
00438     GroupIds-&gt;Groups[<a class="code" href="../../d6/d0/ctaccess_8c.html#a10">WORLD_INDEX</a>].Attributes       = <a class="code" href="../../d6/d0/ctaccess_8c.html#a44">NormalGroupAttributes</a>;
00439 
00440     UserId.User.Sid = <a class="code" href="../../d4/d6/tsevars_8c.html#a20">PebblesSid</a>;
00441     UserId.User.Attributes = 0;
00442 
00443     <a class="code" href="../../d6/d0/ctaccess_8c.html#a53">Owner</a>.Owner = <a class="code" href="../../d4/d6/tsevars_8c.html#a25">FlintstoneSid</a>;
00444 
00445     Privileges-&gt;PrivilegeCount = <a class="code" href="../../d6/d0/ctaccess_8c.html#a14">PRIVILEGE_COUNT</a>;
00446 
00447     Privileges-&gt;Privileges[<a class="code" href="../../d6/d0/ctaccess_8c.html#a12">UNSOLICITED_INDEX</a>].Luid = <a class="code" href="../../d4/d6/tsevars_8c.html#a44">UnsolicitedInputPrivilege</a>;
00448     Privileges-&gt;Privileges[<a class="code" href="../../d6/d0/ctaccess_8c.html#a13">SECURITY_INDEX</a>].Luid = <a class="code" href="../../d4/d6/tsevars_8c.html#a46">SecurityPrivilege</a>;
00449     Privileges-&gt;Privileges[<a class="code" href="../../d6/d0/ctaccess_8c.html#a12">UNSOLICITED_INDEX</a>].Attributes = 0;
00450     Privileges-&gt;Privileges[<a class="code" href="../../d6/d0/ctaccess_8c.html#a13">SECURITY_INDEX</a>].Attributes = 0;
00451 
00452     PrimaryGroup.PrimaryGroup = <a class="code" href="../../d4/d6/tsevars_8c.html#a25">FlintstoneSid</a>;
00453 
00454     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d2/d4/acledit_8c.html#a6">RtlCreateAcl</a>( DefaultDacl.DefaultDacl, DEFAULT_DACL_LENGTH, ACL_REVISION);
00455 
00456     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status) );
00457 
00458     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d4/d3/token_8c.html#a15">NtCreateToken</a>(
00459                  &amp;ImpersonationToken,      <span class="comment">// Handle</span>
00460                  (TOKEN_ALL_ACCESS),       <span class="comment">// DesiredAccess</span>
00461                  &amp;ImpersonationTokenAttributes,  <span class="comment">// ObjectAttributes</span>
00462                  TokenImpersonation,       <span class="comment">// TokenType</span>
00463                  &amp;DummyAuthenticationId,   <span class="comment">// Authentication LUID</span>
00464                  &amp;NoExpiration,            <span class="comment">// Expiration Time</span>
00465                  &amp;UserId,                  <span class="comment">// Owner ID</span>
00466                  GroupIds,                 <span class="comment">// Group IDs</span>
00467                  Privileges,               <span class="comment">// Privileges</span>
00468                  &amp;Owner,                   <span class="comment">// Owner</span>
00469                  &amp;PrimaryGroup,            <span class="comment">// Primary Group</span>
00470                  &amp;DefaultDacl,             <span class="comment">// Default Dacl</span>
00471                  &amp;TestSource               <span class="comment">// TokenSource</span>
00472                  );
00473 
00474     <span class="keywordflow">if</span> (<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status)) {
00475         <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"Succeeded.\n"</span>);
00476     } <span class="keywordflow">else</span> {
00477         <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"********** Failed ************\n"</span>);
00478         <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"Status is: 0x%lx \n"</span>, Status);
00479         CompletionStatus = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00480     }
00481 
00482     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status));
00483 
00484 <span class="comment">//</span>
00485 <span class="comment">//    Attach tokens to process</span>
00486 <span class="comment">//</span>
00487 
00488     <a class="code" href="../../d9/d1/psquery_8c.html#a19">NtSetInformationProcess</a>(
00489         NtCurrentProcess(),
00490         ProcessAccessToken,
00491         &amp;PrimaryToken,
00492         <span class="keyword">sizeof</span>( PHANDLE ));
00493 
00494 
00495     <a class="code" href="../../d9/d1/psquery_8c.html#a21">NtSetInformationThread</a>(
00496         NtCurrentThread(),
00497         ThreadImpersonationToken,
00498         &amp;ImpersonationToken,
00499         <span class="keyword">sizeof</span>( PHANDLE ));
00500 
00501 
00502 
00503 <span class="comment">//  Create some ACEs</span>
00504 
00505 <span class="comment">//    AllowBarneySetColor</span>
00506 
00507     AllowBarneySetColorLength = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)(<span class="keyword">sizeof</span>( ACCESS_ALLOWED_ACE ) - <span class="keyword">sizeof</span>( ULONG ) +
00508                                 <a class="code" href="../../d0/d5/se_8h.html#a10">SeLengthSid</a>( BarneySid ));
00509 
00510     AllowBarneySetColor = (PVOID) TstAllocatePool ( PagedPool, AllowBarneySetColorLength );
00511 
00512     AllowBarneySetColor-&gt;Header.AceType = ACCESS_ALLOWED_ACE_TYPE;
00513     AllowBarneySetColor-&gt;Header.AceSize = AllowBarneySetColorLength;
00514     AllowBarneySetColor-&gt;Header.AceFlags = 0;
00515 
00516     AllowBarneySetColor-&gt;Mask = <a class="code" href="../../d6/d0/ctaccess_8c.html#a15">SET_WIDGET_COLOR</a>;
00517 
00518     <a class="code" href="../../d8/d6/sertl_8c.html#a46">RtlCopySid</a>(
00519             <a class="code" href="../../d0/d5/se_8h.html#a10">SeLengthSid</a>( BarneySid ),
00520             &amp;(AllowBarneySetColor-&gt;SidStart),
00521             BarneySid );
00522 
00523 
00524 <span class="comment">//    DenyPebblesSetColor</span>
00525 
00526     DenyPebblesSetColorLength = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)(<span class="keyword">sizeof</span>( ACCESS_DENIED_ACE ) - <span class="keyword">sizeof</span>( ULONG ) +
00527                                 <a class="code" href="../../d0/d5/se_8h.html#a10">SeLengthSid</a>( BarneySid ));
00528 
00529     DenyPebblesSetColor = (PVOID) TstAllocatePool ( PagedPool, DenyPebblesSetColorLength );
00530 
00531     DenyPebblesSetColor-&gt;Header.AceType = ACCESS_DENIED_ACE_TYPE;
00532     DenyPebblesSetColor-&gt;Header.AceSize = DenyPebblesSetColorLength;
00533     DenyPebblesSetColor-&gt;Header.AceFlags = 0;
00534 
00535     DenyPebblesSetColor-&gt;Mask = <a class="code" href="../../d6/d0/ctaccess_8c.html#a15">SET_WIDGET_COLOR</a>;
00536 
00537     <a class="code" href="../../d8/d6/sertl_8c.html#a46">RtlCopySid</a>(
00538             <a class="code" href="../../d0/d5/se_8h.html#a10">SeLengthSid</a>( PebblesSid ),
00539             &amp;(DenyPebblesSetColor-&gt;SidStart),
00540             PebblesSid );
00541 
00542 
00543 <span class="comment">//    AllowFredSetColor</span>
00544 
00545     AllowFredSetColorLength = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)(<span class="keyword">sizeof</span>( ACCESS_ALLOWED_ACE ) - <span class="keyword">sizeof</span>( ULONG ) +
00546                                 <a class="code" href="../../d0/d5/se_8h.html#a10">SeLengthSid</a>( FredSid ));
00547 
00548     AllowFredSetColor = (PVOID) TstAllocatePool ( PagedPool, AllowFredSetColorLength );
00549 
00550     AllowFredSetColor-&gt;Header.AceType = ACCESS_ALLOWED_ACE_TYPE;
00551     AllowFredSetColor-&gt;Header.AceSize = AllowFredSetColorLength;
00552     AllowFredSetColor-&gt;Header.AceFlags = 0;
00553 
00554     AllowFredSetColor-&gt;Mask = <a class="code" href="../../d6/d0/ctaccess_8c.html#a15">SET_WIDGET_COLOR</a>;
00555 
00556     <a class="code" href="../../d8/d6/sertl_8c.html#a46">RtlCopySid</a>(
00557             <a class="code" href="../../d0/d5/se_8h.html#a10">SeLengthSid</a>( FredSid ),
00558             &amp;(AllowFredSetColor-&gt;SidStart),
00559             FredSid );
00560 
00561 
00562 
00563 
00564 <span class="comment">//    AllowPebblesSetColor</span>
00565 
00566 
00567     AllowPebblesSetColorLength = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)(<span class="keyword">sizeof</span>( ACCESS_ALLOWED_ACE ) - <span class="keyword">sizeof</span>( ULONG ) +
00568                                 <a class="code" href="../../d0/d5/se_8h.html#a10">SeLengthSid</a>( PebblesSid ));
00569 
00570     AllowPebblesSetColor = (PVOID) TstAllocatePool ( PagedPool, AllowPebblesSetColorLength );
00571 
00572     AllowPebblesSetColor-&gt;Header.AceType = ACCESS_ALLOWED_ACE_TYPE;
00573     AllowPebblesSetColor-&gt;Header.AceSize = AllowPebblesSetColorLength;
00574     AllowPebblesSetColor-&gt;Header.AceFlags = 0;
00575 
00576     AllowPebblesSetColor-&gt;Mask = <a class="code" href="../../d6/d0/ctaccess_8c.html#a15">SET_WIDGET_COLOR</a>;
00577 
00578     <a class="code" href="../../d8/d6/sertl_8c.html#a46">RtlCopySid</a>(
00579             <a class="code" href="../../d0/d5/se_8h.html#a10">SeLengthSid</a>( PebblesSid ),
00580             &amp;(AllowPebblesSetColor-&gt;SidStart),
00581             PebblesSid );
00582 
00583 
00584 <span class="comment">//    DenyFredSetColor</span>
00585 
00586     DenyFredSetColorLength = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)(<span class="keyword">sizeof</span>( ACCESS_DENIED_ACE ) - <span class="keyword">sizeof</span>( ULONG ) +
00587                                 <a class="code" href="../../d0/d5/se_8h.html#a10">SeLengthSid</a>( FredSid ));
00588 
00589     DenyFredSetColor = (PVOID) TstAllocatePool ( PagedPool, DenyFredSetColorLength );
00590 
00591     DenyFredSetColor-&gt;Header.AceType = ACCESS_DENIED_ACE_TYPE;
00592     DenyFredSetColor-&gt;Header.AceSize = DenyFredSetColorLength;
00593     DenyFredSetColor-&gt;Header.AceFlags = 0;
00594 
00595     DenyFredSetColor-&gt;Mask = <a class="code" href="../../d6/d0/ctaccess_8c.html#a15">SET_WIDGET_COLOR</a>;
00596 
00597     <a class="code" href="../../d8/d6/sertl_8c.html#a46">RtlCopySid</a>(
00598             <a class="code" href="../../d0/d5/se_8h.html#a10">SeLengthSid</a>( FredSid ),
00599             &amp;(DenyFredSetColor-&gt;SidStart),
00600             FredSid );
00601 
00602 <span class="comment">//    AllowBarneySetSize</span>
00603 
00604     AllowBarneySetSizeLength = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)(<span class="keyword">sizeof</span>( ACCESS_ALLOWED_ACE ) - <span class="keyword">sizeof</span>( ULONG ) +
00605                                 <a class="code" href="../../d0/d5/se_8h.html#a10">SeLengthSid</a>( BarneySid ));
00606 
00607     AllowBarneySetSize = (PVOID) TstAllocatePool ( PagedPool, AllowBarneySetSizeLength );
00608 
00609     AllowBarneySetSize-&gt;Header.AceType = ACCESS_ALLOWED_ACE_TYPE;
00610     AllowBarneySetSize-&gt;Header.AceSize = AllowBarneySetSizeLength;
00611     AllowBarneySetSize-&gt;Header.AceFlags = 0;
00612 
00613     AllowBarneySetSize-&gt;Mask = <a class="code" href="../../d6/d0/ctaccess_8c.html#a16">SET_WIDGET_SIZE</a>;
00614 
00615     <a class="code" href="../../d8/d6/sertl_8c.html#a46">RtlCopySid</a>(
00616             <a class="code" href="../../d0/d5/se_8h.html#a10">SeLengthSid</a>( BarneySid ),
00617             &amp;(AllowBarneySetSize-&gt;SidStart),
00618             BarneySid );
00619 
00620 <span class="comment">//    AllowPebblesSetSize</span>
00621 
00622     AllowPebblesSetSizeLength = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)(<span class="keyword">sizeof</span>( ACCESS_ALLOWED_ACE ) - <span class="keyword">sizeof</span>( ULONG ) +
00623                                 <a class="code" href="../../d0/d5/se_8h.html#a10">SeLengthSid</a>( PebblesSid ));
00624 
00625     AllowPebblesSetSize = (PVOID) TstAllocatePool ( PagedPool, AllowPebblesSetSizeLength );
00626 
00627     AllowPebblesSetSize-&gt;Header.AceType = ACCESS_ALLOWED_ACE_TYPE;
00628     AllowPebblesSetSize-&gt;Header.AceSize = AllowPebblesSetSizeLength;
00629     AllowPebblesSetSize-&gt;Header.AceFlags = 0;
00630 
00631     AllowPebblesSetSize-&gt;Mask = <a class="code" href="../../d6/d0/ctaccess_8c.html#a16">SET_WIDGET_SIZE</a>;
00632 
00633     <a class="code" href="../../d8/d6/sertl_8c.html#a46">RtlCopySid</a>(
00634             <a class="code" href="../../d0/d5/se_8h.html#a10">SeLengthSid</a>( PebblesSid ),
00635             &amp;(AllowPebblesSetSize-&gt;SidStart),
00636             PebblesSid );
00637 
00638 
00639 <span class="comment">//    AllowPebblesGetSize</span>
00640 
00641     AllowPebblesGetSizeLength = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)(<span class="keyword">sizeof</span>( ACCESS_ALLOWED_ACE ) - <span class="keyword">sizeof</span>( ULONG ) +
00642                                 <a class="code" href="../../d0/d5/se_8h.html#a10">SeLengthSid</a>( PebblesSid ));
00643 
00644     AllowPebblesGetSize = (PVOID) TstAllocatePool ( PagedPool, AllowPebblesGetSizeLength );
00645 
00646     AllowPebblesGetSize-&gt;Header.AceType = ACCESS_ALLOWED_ACE_TYPE;
00647     AllowPebblesGetSize-&gt;Header.AceSize = AllowPebblesGetSizeLength;
00648     AllowPebblesGetSize-&gt;Header.AceFlags = 0;
00649 
00650     AllowPebblesGetSize-&gt;Mask = <a class="code" href="../../d6/d0/ctaccess_8c.html#a16">SET_WIDGET_SIZE</a>;
00651 
00652     <a class="code" href="../../d8/d6/sertl_8c.html#a46">RtlCopySid</a>(
00653             <a class="code" href="../../d0/d5/se_8h.html#a10">SeLengthSid</a>( PebblesSid ),
00654             &amp;(AllowPebblesGetSize-&gt;SidStart),
00655             PebblesSid );
00656 
00657 
00658 <span class="comment">//    AllowPebblesGetColor</span>
00659 
00660     AllowPebblesGetColorLength = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)(<span class="keyword">sizeof</span>( ACCESS_ALLOWED_ACE ) - <span class="keyword">sizeof</span>( ULONG ) +
00661                                 <a class="code" href="../../d0/d5/se_8h.html#a10">SeLengthSid</a>( PebblesSid ));
00662 
00663     AllowPebblesGetColor = (PVOID) TstAllocatePool ( PagedPool, AllowPebblesGetColorLength );
00664 
00665     AllowPebblesGetColor-&gt;Header.AceType = ACCESS_ALLOWED_ACE_TYPE;
00666     AllowPebblesGetColor-&gt;Header.AceSize = AllowPebblesGetColorLength;
00667     AllowPebblesGetColor-&gt;Header.AceFlags = 0;
00668 
00669     AllowPebblesGetColor-&gt;Mask = <a class="code" href="../../d6/d0/ctaccess_8c.html#a15">SET_WIDGET_COLOR</a>;
00670 
00671     <a class="code" href="../../d8/d6/sertl_8c.html#a46">RtlCopySid</a>(
00672             <a class="code" href="../../d0/d5/se_8h.html#a10">SeLengthSid</a>( PebblesSid ),
00673             &amp;(AllowPebblesGetColor-&gt;SidStart),
00674             PebblesSid );
00675 
00676 <span class="comment">//</span>
00677 <span class="comment">//    Create some ACLs that we can put into a Security Descriptor</span>
00678 <span class="comment">//</span>
00679     DbgBreakPoint();
00680 
00681 <span class="comment">//</span>
00682 <span class="comment">//    Dacl</span>
00683 <span class="comment">//</span>
00684 <span class="comment">//  +----------------+    +----------------+   +----------------+</span>
00685 <span class="comment">//  |  1st ACE       |    |  2nd ACE       |   |  3rd ACE       |</span>
00686 <span class="comment">//  +----------------+    +----------------+   +----------------+</span>
00687 <span class="comment">//  |  AccessAllowed |    |  AccessDenied  |   |  AccessAllowed |</span>
00688 <span class="comment">//  +----------------+    +----------------+   +----------------+</span>
00689 <span class="comment">//  |  BARNEY        |    |  PEBBLES       |   |  FRED          |</span>
00690 <span class="comment">//  +----------------+    +----------------+   +----------------+</span>
00691 <span class="comment">//  |  SetWidgeColor |    |  SetWidgeColor |   |  SetWidgeColor |</span>
00692 <span class="comment">//  +----------------+    +----------------+   +----------------+</span>
00693 <span class="comment">//</span>
00694 
00695     <a class="code" href="../../d6/d0/ctaccess_8c.html#a55">Dacl</a> = (PACL) TstAllocatePool ( PagedPool,  2048 );
00696 
00697     <a class="code" href="../../d2/d4/acledit_8c.html#a6">RtlCreateAcl</a>( Dacl, 2048, ACL_REVISION);
00698 
00699 
00700     <a class="code" href="../../d2/d4/acledit_8c.html#a10">RtlAddAce</a> ( Dacl,
00701                 ACL_REVISION,
00702                 0,
00703                 AllowBarneySetColor,
00704                 AllowBarneySetColorLength );
00705 
00706     <a class="code" href="../../d2/d4/acledit_8c.html#a10">RtlAddAce</a> ( Dacl,
00707                 ACL_REVISION,
00708                 1,
00709                 DenyPebblesSetColor,
00710                 DenyPebblesSetColorLength );
00711 
00712     <a class="code" href="../../d2/d4/acledit_8c.html#a10">RtlAddAce</a> ( Dacl,
00713                 ACL_REVISION,
00714                 2,
00715                 DenyFredSetColor,
00716                 AllowFredSetColorLength );
00717 
00718     <a class="code" href="../../d6/d0/ctaccess_8c.html#a61">DumpAcl</a> (Dacl);
00719 
00720 
00721 
00722 
00723 
00724 <span class="comment">//  Create a security descriptor</span>
00725 <span class="comment">//</span>
00726 <span class="comment">//  Owner = Pebbles</span>
00727 <span class="comment">//  Group = Flintstone</span>
00728 <span class="comment">//  Dacl  = Dacl</span>
00729 <span class="comment">//  Sacl  = NULL</span>
00730 <span class="comment">//</span>
00731 
00732     Widget1SecurityDescriptor =
00733         (PSECURITY_DESCRIPTOR)TstAllocatePool( PagedPool, 1024 );
00734 
00735     <a class="code" href="../../d8/d6/sertl_8c.html#a53">RtlCreateSecurityDescriptor</a>( Widget1SecurityDescriptor,
00736                                  1 );
00737 
00738 
00739     <a class="code" href="../../d8/d6/sertl_8c.html#a64">RtlSetOwnerSecurityDescriptor</a>( Widget1SecurityDescriptor,
00740                                    PebblesSid,
00741                                    FALSE );
00742 
00743     <a class="code" href="../../d8/d6/sertl_8c.html#a66">RtlSetGroupSecurityDescriptor</a>( Widget1SecurityDescriptor,
00744                                    FlintstoneSid,
00745                                    FALSE );
00746 
00747     <a class="code" href="../../d8/d6/sertl_8c.html#a60">RtlSetDaclSecurityDescriptor</a>( Widget1SecurityDescriptor,
00748                                   TRUE,
00749                                   Dacl,
00750                                   FALSE );
00751 
00752     <a class="code" href="../../d8/d6/sertl_8c.html#a62">RtlSetSaclSecurityDescriptor</a>( Widget1SecurityDescriptor,
00753                                   FALSE,
00754                                   NULL,
00755                                   NULL );
00756 
00757 <span class="comment">//  See if Pebbles is allowed SET_WIDGET_COLOR (should be denied)</span>
00758 
00759     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d0/d4/accessck_8c.html#a14">NtAccessCheck</a>( Widget1SecurityDescriptor,
00760                    PrimaryToken,
00761                    (ACCESS_MASK) SET_WIDGET_COLOR,
00762                    &amp;GrantedAccess,
00763                    &amp;AccessStatus );
00764 
00765 <span class="comment">//    DbgBreakPoint();</span>
00766 
00767     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status));
00768 
00769     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(AccessStatus));
00770 
00771     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(GrantedAccess == NULL);
00772 
00773 
00774 <span class="comment">//  Update Dacl to be the following:</span>
00775 <span class="comment">//</span>
00776 <span class="comment">//    Dacl2</span>
00777 <span class="comment">//</span>
00778 <span class="comment">//  +----------------+    +----------------+   +----------------+</span>
00779 <span class="comment">//  |  1st ACE       |    |  2nd ACE       |   |  3rd ACE       |</span>
00780 <span class="comment">//  +----------------+    +----------------+   +----------------+</span>
00781 <span class="comment">//  |  AccessAllowed |    |  AccessAllowed |   |  AccessDenied  |</span>
00782 <span class="comment">//  +----------------+    +----------------+   +----------------+</span>
00783 <span class="comment">//  |  BARNEY        |    |  PEBBLES       |   |  FRED          |</span>
00784 <span class="comment">//  +----------------+    +----------------+   +----------------+</span>
00785 <span class="comment">//  |  SetWidgeColor |    |  SetWidgeColor |   |  SetWidgeColor |</span>
00786 <span class="comment">//  +----------------+    +----------------+   +----------------+</span>
00787 <span class="comment">//</span>
00788 
00789 <span class="comment">//  Delete 2nd Ace</span>
00790 
00791     <a class="code" href="../../d2/d4/acledit_8c.html#a11">RtlDeleteAce</a> (Dacl, 1);
00792 
00793     <a class="code" href="../../d2/d4/acledit_8c.html#a10">RtlAddAce</a> ( Dacl,
00794                 ACL_REVISION,
00795                 1,
00796                 AllowPebblesSetColor,
00797                 AllowPebblesSetColorLength );
00798 
00799     <a class="code" href="../../d2/d4/acledit_8c.html#a11">RtlDeleteAce</a> ( Dacl, 2 );
00800 
00801     <a class="code" href="../../d2/d4/acledit_8c.html#a10">RtlAddAce</a> ( Dacl,
00802                 ACL_REVISION,
00803                 1,
00804                 DenyFredSetColor,
00805                 DenyFredSetColorLength );
00806 
00807 
00808 
00809 
00810 <span class="comment">//  Change the security descriptor to use updated Dacl</span>
00811 <span class="comment">//</span>
00812 <span class="comment">//  Owner = Pebbles</span>
00813 <span class="comment">//  Group = Flintstone</span>
00814 <span class="comment">//  Dacl  = Dacl2</span>
00815 <span class="comment">//  Sacl  = NULL</span>
00816 <span class="comment">//</span>
00817 
00818     <a class="code" href="../../d8/d6/sertl_8c.html#a60">RtlSetDaclSecurityDescriptor</a>( Widget1SecurityDescriptor,
00819                                   TRUE,
00820                                   Dacl,
00821                                   FALSE );
00822 
00823 <span class="comment">//  See if Pebbles is allowed SET_WIDGET_COLOR (should be permitted)</span>
00824 
00825     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d0/d4/accessck_8c.html#a14">NtAccessCheck</a>( Widget1SecurityDescriptor,
00826                             PrimaryToken,
00827                             (ACCESS_MASK) SET_WIDGET_COLOR,
00828                             &amp;GrantedAccess,
00829                             &amp;AccessStatus );
00830 
00831 
00832     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status));
00833 
00834     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(AccessStatus));
00835 
00836     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(GrantedAccess == (ACCESS_MASK)SET_WIDGET_COLOR);
00837 
00838 <span class="comment">//</span>
00839 <span class="comment">//    Dacl3</span>
00840 <span class="comment">//</span>
00841 <span class="comment">//  +----------------+    +----------------+   +----------------+</span>
00842 <span class="comment">//  |  1st ACE       |    |  2nd ACE       |   |  3rd ACE       |</span>
00843 <span class="comment">//  +----------------+    +----------------+   +----------------+</span>
00844 <span class="comment">//  |  AccessAllowed |    |  AccessAllowed |   |  AccessDenied  |</span>
00845 <span class="comment">//  +----------------+    +----------------+   +----------------+</span>
00846 <span class="comment">//  |  BARNEY        |    |  PEBBLES       |   |  FRED          |</span>
00847 <span class="comment">//  +----------------+    +----------------+   +----------------+</span>
00848 <span class="comment">//  |  SetWidgeColor |    |  SetWidgeColor |   |  SetWidgeColor |</span>
00849 <span class="comment">//  +----------------+    +----------------+   +----------------+</span>
00850 <span class="comment">//</span>
00851 <span class="comment">//  +----------------+    +----------------+</span>
00852 <span class="comment">//  |  4th ACE       |    |  5th ACE       |</span>
00853 <span class="comment">//  +----------------+    +----------------+</span>
00854 <span class="comment">//  |  AccessAllowed |    |  AccessAllowed |</span>
00855 <span class="comment">//  +----------------+    +----------------+</span>
00856 <span class="comment">//  |  BARNEY        |    |  PEBBLES       |</span>
00857 <span class="comment">//  +----------------+    +----------------+</span>
00858 <span class="comment">//  |  SetWidgeSize  |    |  SetWidgeSize  |</span>
00859 <span class="comment">//  +----------------+    +----------------+</span>
00860 <span class="comment">//</span>
00861 
00862 
00863     <a class="code" href="../../d2/d4/acledit_8c.html#a10">RtlAddAce</a> ( Dacl,
00864                 ACL_REVISION,
00865                 MAXULONG,
00866                 AllowBarneySetSize,
00867                 AllowBarneySetSizeLength );
00868 
00869     <a class="code" href="../../d2/d4/acledit_8c.html#a10">RtlAddAce</a> ( Dacl,
00870                 ACL_REVISION,
00871                 MAXULONG,
00872                 AllowPebblesSetSize,
00873                 AllowPebblesSetSizeLength );
00874 
00875 <span class="comment">//  Change the security descriptor to use Dacl3</span>
00876 <span class="comment">//</span>
00877 <span class="comment">//  Owner = Pebbles</span>
00878 <span class="comment">//  Group = Flintstone</span>
00879 <span class="comment">//  Dacl  = Dacl3</span>
00880 <span class="comment">//  Sacl  = NULL</span>
00881 <span class="comment">//</span>
00882 
00883     <a class="code" href="../../d8/d6/sertl_8c.html#a60">RtlSetDaclSecurityDescriptor</a>( Widget1SecurityDescriptor,
00884                                   TRUE,
00885                                   Dacl,
00886                                   FALSE );
00887 
00888 <span class="comment">//  Request MAXIMUM_ACCESS for Pebbles.  Should get back SetWidgetSize</span>
00889 <span class="comment">//  and SetWidgetColor</span>
00890 
00891     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d0/d4/accessck_8c.html#a14">NtAccessCheck</a>( Widget1SecurityDescriptor,
00892                             PrimaryToken,
00893                             (ACCESS_MASK) MAXIMUM_ALLOWED,
00894                             &amp;GrantedAccess,
00895                             &amp;AccessStatus );
00896 
00897 
00898     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status));
00899 
00900     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(AccessStatus));
00901 
00902     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(GrantedAccess == (ACCESS_MASK) (SET_WIDGET_COLOR | SET_WIDGET_SIZE));
00903 
00904 
00905 <span class="comment">//</span>
00906 <span class="comment">//    Dacl4</span>
00907 <span class="comment">//</span>
00908 <span class="comment">//  +----------------+    +----------------+   +----------------+</span>
00909 <span class="comment">//  |  1st ACE       |    |  2nd ACE       |   |  3rd ACE       |</span>
00910 <span class="comment">//  +----------------+    +----------------+   +----------------+</span>
00911 <span class="comment">//  |  AccessAllowed |    |  AccessAllowed |   |  AccessDenied  |</span>
00912 <span class="comment">//  +----------------+    +----------------+   +----------------+</span>
00913 <span class="comment">//  |  BARNEY        |    |  PEBBLES       |   |  FRED          |</span>
00914 <span class="comment">//  +----------------+    +----------------+   +----------------+</span>
00915 <span class="comment">//  |  SetWidgeColor |    |  SetWidgeColor |   |  SetWidgeColor |</span>
00916 <span class="comment">//  +----------------+    +----------------+   +----------------+</span>
00917 <span class="comment">//</span>
00918 <span class="comment">//  +----------------+    +----------------+   +----------------+</span>
00919 <span class="comment">//  |  4th ACE       |    |  5th ACE       |   |  6th ACE       |</span>
00920 <span class="comment">//  +----------------+    +----------------+   +----------------+</span>
00921 <span class="comment">//  |  AccessAllowed |    |  AccessAllowed |   |  AccessDenied  |</span>
00922 <span class="comment">//  +----------------+    +----------------+   +----------------+</span>
00923 <span class="comment">//  |  BARNEY        |    |  PEBBLES       |   |  PEBBLES       |</span>
00924 <span class="comment">//  +----------------+    +----------------+   +----------------+</span>
00925 <span class="comment">//  |  SetWidgeSize  |    |  SetWidgeSize  |   |  SetWidgeColor |</span>
00926 <span class="comment">//  +----------------+    +----------------+   +----------------+</span>
00927 <span class="comment">//</span>
00928 
00929     <a class="code" href="../../d2/d4/acledit_8c.html#a10">RtlAddAce</a> ( Dacl,
00930                 ACL_REVISION,
00931                 MAXULONG,
00932                 DenyPebblesSetColor,
00933                 DenyPebblesSetColorLength );
00934 
00935     <a class="code" href="../../d8/d6/sertl_8c.html#a60">RtlSetDaclSecurityDescriptor</a>( Widget1SecurityDescriptor,
00936                                   TRUE,
00937                                   Dacl,
00938                                   FALSE );
00939 
00940 <span class="comment">//  Request MAXIMUM_ACCESS for Pebbles.  Should get back SetWidgetSize</span>
00941 <span class="comment">//  and SetWidgetColor</span>
00942 
00943     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d0/d4/accessck_8c.html#a14">NtAccessCheck</a>( Widget1SecurityDescriptor,
00944                             PrimaryToken,
00945                             (ACCESS_MASK) MAXIMUM_ALLOWED,
00946                             &amp;GrantedAccess,
00947                             &amp;AccessStatus );
00948 
00949 
00950     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status));
00951 
00952     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(AccessStatus));
00953 
00954     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(GrantedAccess == (ACCESS_MASK) (SET_WIDGET_COLOR | SET_WIDGET_SIZE));
00955 
00956 
00957 <span class="comment">//</span>
00958 <span class="comment">//    Dacl5</span>
00959 <span class="comment">//</span>
00960 <span class="comment">//  +----------------+    +----------------+   +----------------+</span>
00961 <span class="comment">//  |  1st ACE       |    |  2nd ACE       |   |  3rd ACE       |</span>
00962 <span class="comment">//  +----------------+    +----------------+   +----------------+</span>
00963 <span class="comment">//  |  AccessAllowed |    |  AccessDenied  |   |  AccessDenied  |</span>
00964 <span class="comment">//  +----------------+    +----------------+   +----------------+</span>
00965 <span class="comment">//  |  BARNEY        |    |  PEBBLES       |   |  FRED          |</span>
00966 <span class="comment">//  +----------------+    +----------------+   +----------------+</span>
00967 <span class="comment">//  |  SetWidgeColor |    |  SetWidgeColor |   |  SetWidgeColor |</span>
00968 <span class="comment">//  +----------------+    +----------------+   +----------------+</span>
00969 <span class="comment">//</span>
00970 <span class="comment">//  +----------------+    +----------------+   +----------------+</span>
00971 <span class="comment">//  |  4th ACE       |    |  5th ACE       |   |  6th ACE       |</span>
00972 <span class="comment">//  +----------------+    +----------------+   +----------------+</span>
00973 <span class="comment">//  |  AccessAllowed |    |  AccessAllowed |   |  AccessAllowed |</span>
00974 <span class="comment">//  +----------------+    +----------------+   +----------------+</span>
00975 <span class="comment">//  |  BARNEY        |    |  PEBBLES       |   |  PEBBLES       |</span>
00976 <span class="comment">//  +----------------+    +----------------+   +----------------+</span>
00977 <span class="comment">//  |  SetWidgeSize  |    |  SetWidgeSize  |   |  SetWidgeColor |</span>
00978 <span class="comment">//  +----------------+    +----------------+   +----------------+</span>
00979 <span class="comment">//</span>
00980 
00981     <a class="code" href="../../d2/d4/acledit_8c.html#a11">RtlDeleteAce</a> (Dacl, 1);
00982 
00983     <a class="code" href="../../d2/d4/acledit_8c.html#a10">RtlAddAce</a> ( Dacl,
00984                 ACL_REVISION,
00985                 1,
00986                 DenyPebblesSetColor,
00987                 DenyPebblesSetColorLength );
00988 
00989     <a class="code" href="../../d2/d4/acledit_8c.html#a11">RtlDeleteAce</a> (Dacl, 5);
00990 
00991     <a class="code" href="../../d2/d4/acledit_8c.html#a10">RtlAddAce</a> ( Dacl,
00992                 ACL_REVISION,
00993                 MAXULONG,
00994                 AllowPebblesSetColor,
00995                 AllowPebblesSetColorLength );
00996 
00997 
00998     <a class="code" href="../../d6/d0/ctaccess_8c.html#a61">DumpAcl</a> ( Dacl );
00999 
01000     <a class="code" href="../../d8/d6/sertl_8c.html#a60">RtlSetDaclSecurityDescriptor</a>( Widget1SecurityDescriptor,
01001                                   TRUE,
01002                                   Dacl,
01003                                   FALSE );
01004 
01005 <span class="comment">//  Request MAXIMUM_ACCESS for Pebbles.  Should get back SetWidgetSize</span>
01006 
01007     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d0/d4/accessck_8c.html#a14">NtAccessCheck</a>( Widget1SecurityDescriptor,
01008                             PrimaryToken,
01009                             (ACCESS_MASK) MAXIMUM_ALLOWED,
01010                             &amp;GrantedAccess,
01011                             &amp;AccessStatus );
01012 
01013 
01014     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status));
01015 
01016     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(AccessStatus));
01017 
01018     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(GrantedAccess == (ACCESS_MASK) SET_WIDGET_SIZE);
01019 
01020 
01021 <span class="comment">//</span>
01022 <span class="comment">//    Dacl6</span>
01023 <span class="comment">//</span>
01024 <span class="comment">//  +----------------+    +----------------+   +----------------+</span>
01025 <span class="comment">//  |  1st ACE       |    |  2nd ACE       |   |  3rd ACE       |</span>
01026 <span class="comment">//  +----------------+    +----------------+   +----------------+</span>
01027 <span class="comment">//  |  AccessAllowed |    |  AccessDenied  |   |  AccessDenied  |</span>
01028 <span class="comment">//  +----------------+    +----------------+   +----------------+</span>
01029 <span class="comment">//  |  BARNEY        |    |  PEBBLES       |   |  FRED          |</span>
01030 <span class="comment">//  +----------------+    +----------------+   +----------------+</span>
01031 <span class="comment">//  |  SetWidgeColor |    |  SetWidgeColor |   |  SetWidgeColor |</span>
01032 <span class="comment">//  +----------------+    +----------------+   +----------------+</span>
01033 <span class="comment">//</span>
01034 <span class="comment">//  +----------------+    +----------------+   +----------------+</span>
01035 <span class="comment">//  |  4th ACE       |    |  5th ACE       |   |  6th ACE       |</span>
01036 <span class="comment">//  +----------------+    +----------------+   +----------------+</span>
01037 <span class="comment">//  |  AccessAllowed |    |  AccessAllowed |   |  AccessAllowed |</span>
01038 <span class="comment">//  +----------------+    +----------------+   +----------------+</span>
01039 <span class="comment">//  |  BARNEY        |    |  PEBBLES       |   |  PEBBLES       |</span>
01040 <span class="comment">//  +----------------+    +----------------+   +----------------+</span>
01041 <span class="comment">//  |  SetWidgeSize  |    |  SetWidgeSize  |   |  SetWidgeColor |</span>
01042 <span class="comment">//  +----------------+    +----------------+   +----------------+</span>
01043 <span class="comment">//</span>
01044 <span class="comment">//  +----------------+    +----------------+</span>
01045 <span class="comment">//  |  7th ACE       |    |  8th ACE       |</span>
01046 <span class="comment">//  +----------------+    +----------------+</span>
01047 <span class="comment">//  |  AccessAllowed |    |  AccessAllowed |</span>
01048 <span class="comment">//  +----------------+    +----------------+</span>
01049 <span class="comment">//  |  PEBBLES       |    |  PEBBLES       |</span>
01050 <span class="comment">//  +----------------+    +----------------+</span>
01051 <span class="comment">//  |  GetWidgeSize  |    |  GetWidgeColor |</span>
01052 <span class="comment">//  +----------------+    +----------------+</span>
01053 <span class="comment">//</span>
01054 
01055     <a class="code" href="../../d2/d4/acledit_8c.html#a10">RtlAddAce</a> ( Dacl,
01056                 ACL_REVISION,
01057                 MAXULONG,
01058                 AllowPebblesGetSize,
01059                 AllowPebblesGetSizeLength );
01060 
01061     <a class="code" href="../../d2/d4/acledit_8c.html#a10">RtlAddAce</a> ( Dacl,
01062                 ACL_REVISION,
01063                 MAXULONG,
01064                 AllowPebblesGetColor,
01065                 AllowPebblesGetColorLength );
01066 
01067     <a class="code" href="../../d6/d0/ctaccess_8c.html#a61">DumpAcl</a> ( Dacl );
01068 
01069     <a class="code" href="../../d8/d6/sertl_8c.html#a60">RtlSetDaclSecurityDescriptor</a>( Widget1SecurityDescriptor,
01070                                   TRUE,
01071                                   Dacl,
01072                                   FALSE );
01073 
01074 <span class="comment">//  Request MAXIMUM_ACCESS for Pebbles.  Should get back SetWidgetSize</span>
01075 
01076     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d0/d4/accessck_8c.html#a14">NtAccessCheck</a>( Widget1SecurityDescriptor,
01077                             PrimaryToken,
01078                             (ACCESS_MASK) MAXIMUM_ALLOWED,
01079                             &amp;GrantedAccess,
01080                             &amp;AccessStatus );
01081 
01082 
01083     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status));
01084 
01085     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(AccessStatus));
01086 
01087     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(GrantedAccess == (ACCESS_MASK) SET_WIDGET_SIZE);
01088 
01089 
01090 
01091     <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
01092 
01093 
01094 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a64" doxytag="ctaccess.c::CTAccess" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN CTAccess           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l01107">1107</a> of file <a class="el" href="../../d7/d9/ctaccess_8c-source.html">ctaccess.c</a>.
<p>
References <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00299">CreateDAclToken()</a>, <a class="el" href="../../d7/d5/memprint_8h-source.html#l00079">DbgPrint</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00178">TestTokenInitialize()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, and <a class="el" href="../../d5/d5/tsevars_8c-source.html#l00167">TSeVariableInitialization()</a>.
<p>
Referenced by <a class="el" href="../../d2/d1/utaccess_8c-source.html#l00035">Test()</a>.
<p>
<pre class="fragment"><div>01108 {
01109 
01110     BOOLEAN Result = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01111 
01112     <span class="keywordflow">if</span> (!<a class="code" href="../../d4/d6/tsevars_8c.html#a65">TSeVariableInitialization</a>()) {
01113         <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"Se:    Failed to initialize global test variables.\n"</span>);
01114         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01115     }
01116 
01117     <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"Se:   Initialization..."</span>);
01118     <a class="code" href="../../d6/d0/ctaccess_8c.html#a62">TestTokenInitialize</a>();
01119     <a class="code" href="../../d6/d0/ctaccess_8c.html#a63">CreateDAclToken</a>();
01120 
01121 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a61" doxytag="ctaccess.c::DumpAcl" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID DumpAcl           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PACL&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Acl</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l01139">1139</a> of file <a class="el" href="../../d7/d9/ctaccess_8c-source.html">ctaccess.c</a>.
<p>
References <a class="el" href="../../d7/d5/memprint_8h-source.html#l00079">DbgPrint</a>, <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html#l00053">FirstAce</a>, <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html#l00059">NextAce</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, and <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l01134">PSTANDARD_ACE</a>.
<p>
Referenced by <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00299">CreateDAclToken()</a>.
<p>
<pre class="fragment"><div>01145                    :
01146 
01147     This routine dumps via (DbgPrint) an Acl for debug purposes.  It is
01148     specialized to dump standard aces.
01149 
01150 Arguments:
01151 
01152     Acl - Supplies the Acl to dump
01153 
01154 Return Value:
01155 
01156     None
01157 
01158 --*/
01159 
01160 
01161 {
01162     ULONG i;
01163     <a class="code" href="../../d9/d5/struct__STANDARD__ACE.html">PSTANDARD_ACE</a> Ace;
01164 
01165     <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"DumpAcl @ %8lx"</span>, Acl);
01166 
01167     <span class="comment">//</span>
01168     <span class="comment">//  Check if the Acl is null</span>
01169     <span class="comment">//</span>
01170 
01171     <span class="keywordflow">if</span> (Acl == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01172 
01173         <span class="keywordflow">return</span>;
01174 
01175     }
01176 
01177     <span class="comment">//</span>
01178     <span class="comment">//  Dump the Acl header</span>
01179     <span class="comment">//</span>
01180 
01181     <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">" Revision: %02x"</span>, Acl-&gt;AclRevision);
01182     <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">" Size: %04x"</span>, Acl-&gt;AclSize);
01183     <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">" AceCount: %04x\n"</span>, Acl-&gt;AceCount);
01184 
01185     <span class="comment">//</span>
01186     <span class="comment">//  Now for each Ace we want do dump it</span>
01187     <span class="comment">//</span>
01188 
01189     <span class="keywordflow">for</span> (i = 0, Ace = <a class="code" href="../../d4/d1/rtdmpsec_8c.html#a1">FirstAce</a>(Acl);
01190          i &lt; Acl-&gt;AceCount;
01191          i++, Ace = <a class="code" href="../../d4/d1/rtdmpsec_8c.html#a2">NextAce</a>(Ace) ) {
01192 
01193         <span class="comment">//</span>
01194         <span class="comment">//  print out the ace header</span>
01195         <span class="comment">//</span>
01196 
01197         <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">" AceHeader: %08lx "</span>, *(PULONG)Ace);
01198 
01199         <span class="comment">//</span>
01200         <span class="comment">//  special case on the standard ace types</span>
01201         <span class="comment">//</span>
01202 
01203         <span class="keywordflow">if</span> ((Ace-&gt;Header.AceType == ACCESS_ALLOWED_ACE_TYPE) ||
01204             (Ace-&gt;Header.AceType == ACCESS_DENIED_ACE_TYPE) ||
01205             (Ace-&gt;Header.AceType == SYSTEM_AUDIT_ACE_TYPE) ||
01206             (Ace-&gt;Header.AceType == SYSTEM_ALARM_ACE_TYPE)) {
01207 
01208             <span class="comment">//</span>
01209             <span class="comment">//  The following array is indexed by ace types and must</span>
01210             <span class="comment">//  follow the allowed, denied, audit, alarm seqeuence</span>
01211             <span class="comment">//</span>
01212 
01213             <span class="keyword">static</span> PCHAR AceTypes[] = { <span class="stringliteral">"Access Allowed"</span>,
01214                                         <span class="stringliteral">"Access Denied "</span>,
01215                                         <span class="stringliteral">"System Audit  "</span>,
01216                                         <span class="stringliteral">"System Alarm  "</span>
01217                                       };
01218 
01219             <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(AceTypes[Ace-&gt;Header.AceType]);
01220             <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"\nAccess Mask: %08lx "</span>, Ace-&gt;Mask);
01221 
01222         } <span class="keywordflow">else</span> {
01223 
01224             <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"Unknown Ace Type\n"</span>);
01225 
01226         }
01227 
01228         <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"\n"</span>);
01229 
01230         <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"AceSize = %d\n"</span>,Ace-&gt;Header.AceSize);
01231         <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"Ace Flags = "</span>);
01232         <span class="keywordflow">if</span> (Ace-&gt;Header.AceFlags &amp; OBJECT_INHERIT_ACE) {
01233             <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"OBJECT_INHERIT_ACE\n"</span>);
01234             <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"                   "</span>);
01235         }
01236         <span class="keywordflow">if</span> (Ace-&gt;Header.AceFlags &amp; CONTAINER_INHERIT_ACE) {
01237             <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"CONTAINER_INHERIT_ACE\n"</span>);
01238             <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"                   "</span>);
01239         }
01240 
01241         <span class="keywordflow">if</span> (Ace-&gt;Header.AceFlags &amp; NO_PROPAGATE_INHERIT_ACE) {
01242             <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"NO_PROPAGATE_INHERIT_ACE\n"</span>);
01243             <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"                   "</span>);
01244         }
01245 
01246         <span class="keywordflow">if</span> (Ace-&gt;Header.AceFlags &amp; INHERIT_ONLY_ACE) {
01247             <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"INHERIT_ONLY_ACE\n"</span>);
01248             <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"                   "</span>);
01249         }
01250 
01251 
01252         <span class="keywordflow">if</span> (Ace-&gt;Header.AceFlags &amp; SUCCESSFUL_ACCESS_ACE_FLAG) {
01253             <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"SUCCESSFUL_ACCESS_ACE_FLAG\n"</span>);
01254             <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"            "</span>);
01255         }
01256 
01257         <span class="keywordflow">if</span> (Ace-&gt;Header.AceFlags &amp; FAILED_ACCESS_ACE_FLAG) {
01258             <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"FAILED_ACCESS_ACE_FLAG\n"</span>);
01259             <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"            "</span>);
01260         }
01261 
01262         <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"\n"</span>);
01263 
01264 
01265     }
01266 
01267 }
}
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a62" doxytag="ctaccess.c::TestTokenInitialize" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN TestTokenInitialize           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00178">178</a> of file <a class="el" href="../../d7/d9/ctaccess_8c-source.html">ctaccess.c</a>.
<p>
References <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00139">AnonymousSecurityDescriptor</a>, <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00140">AnonymousSecurityQos</a>, <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00138">AnonymousTokenAttributes</a>, <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00161">Dacl</a>, <a class="el" href="../../d7/d5/memprint_8h-source.html#l00079">DbgPrint</a>, <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00142">DisabledGroupAttributes</a>, <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00154">DummyAuthenticationId</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00135">ImpersonationSecurityDescriptor</a>, <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00136">ImpersonationSecurityQos</a>, <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00134">ImpersonationTokenAttributes</a>, <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00152">NoExpiration</a>, <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00144">NormalGroupAttributes</a>, <a class="el" href="../../d1/d7/luid_8c-source.html#l00081">NtAllocateLocallyUniqueId()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00143">OptionalGroupAttributes</a>, <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00145">OwnerGroupAttributes</a>, <a class="el" href="../../d5/d8/ex_8h.html#a329a174">PagedPool</a>, <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00131">PrimarySecurityDescriptor</a>, <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00130">PrimaryTokenAttributes</a>, <a class="el" href="../../d2/d1/time_8c-source.html#l00822">RtlTimeFieldsToTime()</a>, <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00151">TempTimeFields</a>, <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00157">TestSource</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, and <a class="el" href="../../d5/d5/tsevars_8c-source.html#l00167">TSeVariableInitialization()</a>.
<p>
Referenced by <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l01107">CTAccess()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l08414">CTToken()</a>, and <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00167">TestTokenInitialize()</a>.
<p>
<pre class="fragment"><div>00179 {
00180 
00181     <a class="code" href="../../d4/d6/tsevars_8c.html#a65">TSeVariableInitialization</a>();    <span class="comment">// Initialize global variables</span>
00182 
00183 
00184     <a class="code" href="../../d6/d0/ctaccess_8c.html#a42">DisabledGroupAttributes</a> =  (SE_GROUP_ENABLED_BY_DEFAULT);
00185 
00186     <a class="code" href="../../d6/d0/ctaccess_8c.html#a43">OptionalGroupAttributes</a> =  (SE_GROUP_ENABLED_BY_DEFAULT |
00187                                 SE_GROUP_ENABLED
00188                                 );
00189     <a class="code" href="../../d6/d0/ctaccess_8c.html#a44">NormalGroupAttributes</a> =    (SE_GROUP_MANDATORY          |
00190                                 SE_GROUP_ENABLED_BY_DEFAULT |
00191                                 SE_GROUP_ENABLED
00192                                 );
00193     <a class="code" href="../../d6/d0/ctaccess_8c.html#a45">OwnerGroupAttributes</a>  =    (SE_GROUP_MANDATORY          |
00194                                 SE_GROUP_ENABLED_BY_DEFAULT |
00195                                 SE_GROUP_ENABLED            |
00196                                 SE_GROUP_OWNER
00197                                 );
00198 
00199 
00200     <a class="code" href="../../d6/d0/ctaccess_8c.html#a34">PrimarySecurityDescriptor</a> =
00201         (PSECURITY_DESCRIPTOR)TstAllocatePool( PagedPool, 1024 );
00202 
00203     InitializeObjectAttributes(
00204         &amp;PrimaryTokenAttributes,
00205         NULL,
00206         OBJ_INHERIT,
00207         NULL,
00208         NULL
00209         );
00210 
00211 
00212     <a class="code" href="../../d6/d0/ctaccess_8c.html#a37">ImpersonationSecurityDescriptor</a> =
00213         (PSECURITY_DESCRIPTOR)TstAllocatePool( PagedPool, 1024 );
00214 
00215     <a class="code" href="../../d6/d0/ctaccess_8c.html#a38">ImpersonationSecurityQos</a>.Length = (ULONG)<span class="keyword">sizeof</span>(SECURITY_QUALITY_OF_SERVICE);
00216     <a class="code" href="../../d6/d0/ctaccess_8c.html#a38">ImpersonationSecurityQos</a>.ImpersonationLevel = SecurityImpersonation;
00217     <a class="code" href="../../d6/d0/ctaccess_8c.html#a38">ImpersonationSecurityQos</a>.ContextTrackingMode = SECURITY_DYNAMIC_TRACKING;
00218     <a class="code" href="../../d6/d0/ctaccess_8c.html#a38">ImpersonationSecurityQos</a>.EffectiveOnly = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00219 
00220     InitializeObjectAttributes(
00221         &amp;ImpersonationTokenAttributes,
00222         NULL,
00223         OBJ_INHERIT,
00224         NULL,
00225         NULL
00226         );
00227     <a class="code" href="../../d6/d0/ctaccess_8c.html#a36">ImpersonationTokenAttributes</a>.SecurityQualityOfService =
00228         &amp;<a class="code" href="../../d6/d0/ctaccess_8c.html#a38">ImpersonationSecurityQos</a>;
00229 
00230 
00231     <a class="code" href="../../d6/d0/ctaccess_8c.html#a40">AnonymousSecurityDescriptor</a> =
00232         (PSECURITY_DESCRIPTOR)TstAllocatePool( PagedPool, 1024 );
00233 
00234     <a class="code" href="../../d6/d0/ctaccess_8c.html#a41">AnonymousSecurityQos</a>.Length = (ULONG)<span class="keyword">sizeof</span>(SECURITY_QUALITY_OF_SERVICE);
00235     <a class="code" href="../../d6/d0/ctaccess_8c.html#a41">AnonymousSecurityQos</a>.ImpersonationLevel = SecurityAnonymous;
00236     <a class="code" href="../../d6/d0/ctaccess_8c.html#a41">AnonymousSecurityQos</a>.ContextTrackingMode = SECURITY_DYNAMIC_TRACKING;
00237     <a class="code" href="../../d6/d0/ctaccess_8c.html#a41">AnonymousSecurityQos</a>.EffectiveOnly = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00238 
00239     InitializeObjectAttributes(
00240         &amp;AnonymousTokenAttributes,
00241         NULL,
00242         OBJ_INHERIT,
00243         NULL,
00244         NULL
00245         );
00246     <a class="code" href="../../d6/d0/ctaccess_8c.html#a39">AnonymousTokenAttributes</a>.SecurityQualityOfService =
00247         &amp;<a class="code" href="../../d6/d0/ctaccess_8c.html#a41">AnonymousSecurityQos</a>;
00248 
00249 
00250     <span class="comment">//</span>
00251     <span class="comment">// Build an ACL for use.</span>
00252     <span class="comment">//</span>
00253 
00254     <a class="code" href="../../d6/d0/ctaccess_8c.html#a55">Dacl</a>        = (PACL)TstAllocatePool( PagedPool, 256 );
00255 
00256     <a class="code" href="../../d6/d0/ctaccess_8c.html#a55">Dacl</a>-&gt;AclRevision=ACL_REVISION;
00257     <a class="code" href="../../d6/d0/ctaccess_8c.html#a55">Dacl</a>-&gt;Sbz1=0;
00258     <a class="code" href="../../d6/d0/ctaccess_8c.html#a55">Dacl</a>-&gt;Sbz2=0;
00259     <a class="code" href="../../d6/d0/ctaccess_8c.html#a55">Dacl</a>-&gt;AclSize=256;
00260     <a class="code" href="../../d6/d0/ctaccess_8c.html#a55">Dacl</a>-&gt;AceCount=0;
00261 
00262 
00263     <span class="comment">//</span>
00264     <span class="comment">// Set up expiration times</span>
00265     <span class="comment">//</span>
00266 
00267     <a class="code" href="../../d6/d0/ctaccess_8c.html#a48">TempTimeFields</a>.Year = 3000;
00268     <a class="code" href="../../d6/d0/ctaccess_8c.html#a48">TempTimeFields</a>.Month = 1;
00269     <a class="code" href="../../d6/d0/ctaccess_8c.html#a48">TempTimeFields</a>.Day = 1;
00270     <a class="code" href="../../d6/d0/ctaccess_8c.html#a48">TempTimeFields</a>.Hour = 1;
00271     <a class="code" href="../../d6/d0/ctaccess_8c.html#a48">TempTimeFields</a>.Minute = 1;
00272     <a class="code" href="../../d6/d0/ctaccess_8c.html#a48">TempTimeFields</a>.Second = 1;
00273     <a class="code" href="../../d6/d0/ctaccess_8c.html#a48">TempTimeFields</a>.Milliseconds = 1;
00274     <a class="code" href="../../d6/d0/ctaccess_8c.html#a48">TempTimeFields</a>.Weekday = 1;
00275 
00276     <a class="code" href="../../d1/d2/time_8c.html#a28">RtlTimeFieldsToTime</a>( &amp;TempTimeFields, &amp;NoExpiration );
00277 
00278 
00279     <span class="comment">//</span>
00280     <span class="comment">// Use a dummy authentication ID for a while.</span>
00281     <span class="comment">//</span>
00282 
00283     <a class="code" href="../../d6/d0/ctaccess_8c.html#a50">DummyAuthenticationId</a> = FredLuid;
00284 
00285 
00286     <span class="comment">//</span>
00287     <span class="comment">// Use a token source specific to security test</span>
00288     <span class="comment">//</span>
00289 
00290     <a class="code" href="../../d0/d8/luid_8c.html#a4">NtAllocateLocallyUniqueId</a>( &amp;(<a class="code" href="../../d6/d0/ctaccess_8c.html#a52">TestSource</a>.SourceIdentifier) );
00291 
00292     <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"Done.\n"</span>);
00293 
00294     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00295 }
</div></pre>    </td>
  </tr>
</table>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="a40" doxytag="ctaccess.c::AnonymousSecurityDescriptor" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PSECURITY_DESCRIPTOR <a class="el" href="../../d2/d1/cttoken_8c.html#a39">AnonymousSecurityDescriptor</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00139">139</a> of file <a class="el" href="../../d7/d9/ctaccess_8c-source.html">ctaccess.c</a>.
<p>
Referenced by <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00178">TestTokenInitialize()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a41" doxytag="ctaccess.c::AnonymousSecurityQos" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> SECURITY_QUALITY_OF_SERVICE <a class="el" href="../../d2/d1/cttoken_8c.html#a40">AnonymousSecurityQos</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00140">140</a> of file <a class="el" href="../../d7/d9/ctaccess_8c-source.html">ctaccess.c</a>.
<p>
Referenced by <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00178">TestTokenInitialize()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a32" doxytag="ctaccess.c::AnonymousToken" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HANDLE <a class="el" href="../../d2/d1/cttoken_8c.html#a31">AnonymousToken</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00128">128</a> of file <a class="el" href="../../d7/d9/ctaccess_8c-source.html">ctaccess.c</a>.
<p>
Referenced by <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00421">TestTokenCreate()</a>, and <a class="el" href="../../d3/d0/cttoken_8c-source.html#l07982">TestTokenImpersonation()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a39" doxytag="ctaccess.c::AnonymousTokenAttributes" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> OBJECT_ATTRIBUTES <a class="el" href="../../d2/d1/cttoken_8c.html#a38">AnonymousTokenAttributes</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00138">138</a> of file <a class="el" href="../../d7/d9/ctaccess_8c-source.html">ctaccess.c</a>.
<p>
Referenced by <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00421">TestTokenCreate()</a>, and <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00178">TestTokenInitialize()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a47" doxytag="ctaccess.c::CurrentLength" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG <a class="el" href="../../d2/d1/cttoken_8c.html#a46">CurrentLength</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00148">148</a> of file <a class="el" href="../../d7/d9/ctaccess_8c-source.html">ctaccess.c</a>.
<p>
Referenced by <a class="el" href="../../d2/d5/low_8c-source.html#l00528">LowTraverseChildren()</a>, <a class="el" href="../../d1/d3/tokenset_8c-source.html#l00037">NtSetInformationToken()</a>, and <a class="el" href="../../d3/d0/cttoken_8c-source.html#l03311">TestTokenSet()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a55" doxytag="ctaccess.c::Dacl" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PACL <a class="el" href="../../d2/d1/cttoken_8c.html#a55">Dacl</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00161">161</a> of file <a class="el" href="../../d7/d9/ctaccess_8c-source.html">ctaccess.c</a>.
<p>
Referenced by <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00299">CreateDAclToken()</a>, <a class="el" href="../../d5/d0/rtdmpsec_8c-source.html#l00283">DumpSecurity()</a>, <a class="el" href="../../d1/d0/obinit_8c-source.html#l01805">ObpFreeDosDevicesProtection()</a>, <a class="el" href="../../d9/d0/obsdata_8c-source.html#l00182">ObpHashSecurityDescriptor()</a>, <a class="el" href="../../d5/d7/seurtl_8c-source.html#l01021">RtlCopySecurityDescriptor()</a>, <a class="el" href="../../d5/d7/seurtl_8c-source.html#l01260">RtlCreateAndSetSD()</a>, <a class="el" href="../../d9/d5/sertl_8c-source.html#l02665">RtlGetDaclSecurityDescriptor()</a>, <a class="el" href="../../d8/d0/rtlassig_8c-source.html#l00425">RtlpQuerySecurityDescriptor()</a>, <a class="el" href="../../d5/d7/seurtl_8c-source.html#l00418">RtlQuerySecurityObject()</a>, <a class="el" href="../../d8/d0/rtlassig_8c-source.html#l00049">RtlSelfRelativeToAbsoluteSD()</a>, <a class="el" href="../../d9/d5/sertl_8c-source.html#l02543">RtlSetDaclSecurityDescriptor()</a>, <a class="el" href="../../d9/d5/sertl_8c-source.html#l11089">RtlValidRelativeSecurityDescriptor()</a>, <a class="el" href="../../d9/d5/sertl_8c-source.html#l02066">RtlValidSecurityDescriptor()</a>, <a class="el" href="../../d3/d4/se_2capture_8c-source.html#l02350">SeComputeQuotaInformationSize()</a>, <a class="el" href="../../d1/d3/accessck_8c-source.html#l03871">SeFastTraverseCheck()</a>, <a class="el" href="../../d1/d3/accessck_8c-source.html#l01564">SepAccessCheck()</a>, <a class="el" href="../../d2/d4/seassign_8c-source.html#l00650">SepDumpSecurityDescriptor()</a>, <a class="el" href="../../d0/d5/seinit_8c-source.html#l00184">SepInitializationPhase1()</a>, <a class="el" href="../../d1/d3/accessck_8c-source.html#l00992">SepMaximumAccessCheck()</a>, <a class="el" href="../../d1/d3/accessck_8c-source.html#l01304">SepNormalAccessCheck()</a>, <a class="el" href="../../d3/d4/se_2capture_8c-source.html#l02414">SeValidSecurityDescriptor()</a>, <a class="el" href="../../d2/d5/tse_8c-source.html#l00296">TestCaptureSecurityDescriptor()</a>, and <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00178">TestTokenInitialize()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a42" doxytag="ctaccess.c::DisabledGroupAttributes" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG <a class="el" href="../../d2/d1/cttoken_8c.html#a41">DisabledGroupAttributes</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00142">142</a> of file <a class="el" href="../../d7/d9/ctaccess_8c-source.html">ctaccess.c</a>.
<p>
Referenced by <a class="el" href="../../d3/d0/cttoken_8c-source.html#l04885">TestTokenAdjustGroups()</a>, and <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00178">TestTokenInitialize()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a50" doxytag="ctaccess.c::DummyAuthenticationId" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> LUID <a class="el" href="../../d6/d0/ctaccess_8c.html#a50">DummyAuthenticationId</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00154">154</a> of file <a class="el" href="../../d7/d9/ctaccess_8c-source.html">ctaccess.c</a>.
<p>
Referenced by <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00299">CreateDAclToken()</a>, and <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00178">TestTokenInitialize()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a54" doxytag="ctaccess.c::Group" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PSID <a class="el" href="../../d2/d1/cttoken_8c.html#a54">Group</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00160">160</a> of file <a class="el" href="../../d7/d9/ctaccess_8c-source.html">ctaccess.c</a>.
<p>
Referenced by <a class="el" href="../../d3/d4/editreg_8c-source.html#l01771">ChangeMemberState()</a>, <a class="el" href="../../d3/d4/editreg_8c-source.html#l02210">CreateFtMember()</a>, <a class="el" href="../../d9/d0/obsdata_8c-source.html#l00182">ObpHashSecurityDescriptor()</a>, <a class="el" href="../../d3/d4/editreg_8c-source.html#l01924">OrphanMember()</a>, <a class="el" href="../../d3/d4/editreg_8c-source.html#l01957">RegenerateMember()</a>, <a class="el" href="../../d3/d4/editreg_8c-source.html#l01891">RestoreOrphan()</a>, <a class="el" href="../../d9/d5/sertl_8c-source.html#l03232">RtlGetGroupSecurityDescriptor()</a>, <a class="el" href="../../d5/d7/seurtl_8c-source.html#l00418">RtlQuerySecurityObject()</a>, <a class="el" href="../../d9/d5/sertl_8c-source.html#l03135">RtlSetGroupSecurityDescriptor()</a>, <a class="el" href="../../d9/d5/sertl_8c-source.html#l02066">RtlValidSecurityDescriptor()</a>, <a class="el" href="../../d3/d4/se_2capture_8c-source.html#l02350">SeComputeQuotaInformationSize()</a>, <a class="el" href="../../d2/d4/seassign_8c-source.html#l00650">SepDumpSecurityDescriptor()</a>, and <a class="el" href="../../d1/d7/subject_8c-source.html#l00306">SepIdAssignableAsGroup()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a37" doxytag="ctaccess.c::ImpersonationSecurityDescriptor" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PSECURITY_DESCRIPTOR <a class="el" href="../../d2/d1/cttoken_8c.html#a36">ImpersonationSecurityDescriptor</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00135">135</a> of file <a class="el" href="../../d7/d9/ctaccess_8c-source.html">ctaccess.c</a>.
<p>
Referenced by <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00178">TestTokenInitialize()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a38" doxytag="ctaccess.c::ImpersonationSecurityQos" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> SECURITY_QUALITY_OF_SERVICE <a class="el" href="../../d2/d1/cttoken_8c.html#a37">ImpersonationSecurityQos</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00136">136</a> of file <a class="el" href="../../d7/d9/ctaccess_8c-source.html">ctaccess.c</a>.
<p>
Referenced by <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00178">TestTokenInitialize()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a30" doxytag="ctaccess.c::ImpersonationToken" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HANDLE <a class="el" href="../../d2/d1/cttoken_8c.html#a30">ImpersonationToken</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00124">124</a> of file <a class="el" href="../../d7/d9/ctaccess_8c-source.html">ctaccess.c</a>.
<p>
Referenced by <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00299">CreateDAclToken()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00421">TestTokenCreate()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l07402">TestTokenDuplicate()</a>, and <a class="el" href="../../d3/d0/cttoken_8c-source.html#l07982">TestTokenImpersonation()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a36" doxytag="ctaccess.c::ImpersonationTokenAttributes" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> OBJECT_ATTRIBUTES <a class="el" href="../../d2/d1/cttoken_8c.html#a35">ImpersonationTokenAttributes</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00134">134</a> of file <a class="el" href="../../d7/d9/ctaccess_8c-source.html">ctaccess.c</a>.
<p>
Referenced by <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00299">CreateDAclToken()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l07648">TestTokenAssignPrimary()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00421">TestTokenCreate()</a>, and <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00178">TestTokenInitialize()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a46" doxytag="ctaccess.c::LengthAvailable" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG <a class="el" href="../../d2/d1/cttoken_8c.html#a45">LengthAvailable</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00147">147</a> of file <a class="el" href="../../d7/d9/ctaccess_8c-source.html">ctaccess.c</a>.
<p>
Referenced by <a class="el" href="../../d3/d0/cttoken_8c-source.html#l03311">TestTokenSet()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a49" doxytag="ctaccess.c::NoExpiration" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> LARGE_INTEGER <a class="el" href="../../d2/d1/cttoken_8c.html#a48">NoExpiration</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00152">152</a> of file <a class="el" href="../../d7/d9/ctaccess_8c-source.html">ctaccess.c</a>.
<p>
Referenced by <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00299">CreateDAclToken()</a>, <a class="el" href="../../d5/d2/token_8c-source.html#l01010">SeMakeAnonymousLogonToken()</a>, <a class="el" href="../../d5/d2/token_8c-source.html#l00536">SeMakeSystemToken()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l07648">TestTokenAssignPrimary()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00421">TestTokenCreate()</a>, and <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00178">TestTokenInitialize()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a44" doxytag="ctaccess.c::NormalGroupAttributes" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG <a class="el" href="../../d2/d1/cttoken_8c.html#a43">NormalGroupAttributes</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00144">144</a> of file <a class="el" href="../../d7/d9/ctaccess_8c-source.html">ctaccess.c</a>.
<p>
Referenced by <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00299">CreateDAclToken()</a>, <a class="el" href="../../d5/d2/token_8c-source.html#l01010">SeMakeAnonymousLogonToken()</a>, <a class="el" href="../../d5/d2/token_8c-source.html#l00536">SeMakeSystemToken()</a>, <a class="el" href="../../d2/d0/ctsertl_8c-source.html#l00042">TestSeSid()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l04885">TestTokenAdjustGroups()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l07648">TestTokenAssignPrimary()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00421">TestTokenCreate()</a>, <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00178">TestTokenInitialize()</a>, and <a class="el" href="../../d3/d0/cttoken_8c-source.html#l01434">TestTokenQuery()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a43" doxytag="ctaccess.c::OptionalGroupAttributes" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG <a class="el" href="../../d2/d1/cttoken_8c.html#a42">OptionalGroupAttributes</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00143">143</a> of file <a class="el" href="../../d7/d9/ctaccess_8c-source.html">ctaccess.c</a>.
<p>
Referenced by <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00299">CreateDAclToken()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l04885">TestTokenAdjustGroups()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l07648">TestTokenAssignPrimary()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00421">TestTokenCreate()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l01085">TestTokenFilter()</a>, <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00178">TestTokenInitialize()</a>, and <a class="el" href="../../d3/d0/cttoken_8c-source.html#l01434">TestTokenQuery()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a53" doxytag="ctaccess.c::Owner" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PSID <a class="el" href="../../d2/d1/cttoken_8c.html#a53">Owner</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00159">159</a> of file <a class="el" href="../../d7/d9/ctaccess_8c-source.html">ctaccess.c</a>.
<p>
Referenced by <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00299">CreateDAclToken()</a>, <a class="el" href="../../d5/d2/rtsetsec_8c-source.html#l00273">GetMySid()</a>, <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00170">KeI386GetLid()</a>, <a class="el" href="../../d5/d2/token_8c-source.html#l01690">NtCreateToken()</a>, <a class="el" href="../../d9/d0/obsdata_8c-source.html#l00182">ObpHashSecurityDescriptor()</a>, <a class="el" href="../../d3/d4/range_8c-source.html#l00340">RtlAddRange()</a>, <a class="el" href="../../d5/d7/seurtl_8c-source.html#l01021">RtlCopySecurityDescriptor()</a>, <a class="el" href="../../d3/d4/range_8c-source.html#l01197">RtlDeleteOwnersRanges()</a>, <a class="el" href="../../d3/d4/range_8c-source.html#l01071">RtlDeleteRange()</a>, <a class="el" href="../../d9/d5/sertl_8c-source.html#l03059">RtlGetOwnerSecurityDescriptor()</a>, <a class="el" href="../../d8/d0/rtlassig_8c-source.html#l00219">RtlMakeSelfRelativeSD()</a>, <a class="el" href="../../d3/d4/range_8c-source.html#l00771">RtlpCreateRangeListEntry()</a>, <a class="el" href="../../d8/d0/rtlassig_8c-source.html#l00425">RtlpQuerySecurityDescriptor()</a>, <a class="el" href="../../d9/d5/sertl_8c-source.html#l03544">RtlpValidOwnerSubjectContext()</a>, <a class="el" href="../../d5/d7/seurtl_8c-source.html#l00418">RtlQuerySecurityObject()</a>, <a class="el" href="../../d8/d0/rtlassig_8c-source.html#l00049">RtlSelfRelativeToAbsoluteSD()</a>, <a class="el" href="../../d9/d5/sertl_8c-source.html#l02963">RtlSetOwnerSecurityDescriptor()</a>, <a class="el" href="../../d9/d5/sertl_8c-source.html#l02066">RtlValidSecurityDescriptor()</a>, <a class="el" href="../../d5/d2/token_8c-source.html#l01010">SeMakeAnonymousLogonToken()</a>, <a class="el" href="../../d5/d2/token_8c-source.html#l00536">SeMakeSystemToken()</a>, <a class="el" href="../../d5/d2/token_8c-source.html#l02213">SepCreateToken()</a>, <a class="el" href="../../d2/d4/seassign_8c-source.html#l00650">SepDumpSecurityDescriptor()</a>, <a class="el" href="../../d1/d3/accessck_8c-source.html#l03796">SepTokenIsOwner()</a>, <a class="el" href="../../d1/d7/subject_8c-source.html#l00381">SepValidOwnerSubjectContext()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l07648">TestTokenAssignPrimary()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00421">TestTokenCreate()</a>, and <a class="el" href="../../d3/d0/cttoken_8c-source.html#l01434">TestTokenQuery()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a45" doxytag="ctaccess.c::OwnerGroupAttributes" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG <a class="el" href="../../d2/d1/cttoken_8c.html#a44">OwnerGroupAttributes</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00145">145</a> of file <a class="el" href="../../d7/d9/ctaccess_8c-source.html">ctaccess.c</a>.
<p>
Referenced by <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00299">CreateDAclToken()</a>, <a class="el" href="../../d5/d2/token_8c-source.html#l00536">SeMakeSystemToken()</a>, <a class="el" href="../../d2/d0/ctsertl_8c-source.html#l00042">TestSeSid()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l04885">TestTokenAdjustGroups()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l07648">TestTokenAssignPrimary()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00421">TestTokenCreate()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l01085">TestTokenFilter()</a>, <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00178">TestTokenInitialize()</a>, and <a class="el" href="../../d3/d0/cttoken_8c-source.html#l01434">TestTokenQuery()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a34" doxytag="ctaccess.c::PrimarySecurityDescriptor" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PSECURITY_DESCRIPTOR <a class="el" href="../../d2/d1/cttoken_8c.html#a33">PrimarySecurityDescriptor</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00131">131</a> of file <a class="el" href="../../d7/d9/ctaccess_8c-source.html">ctaccess.c</a>.
<p>
Referenced by <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00178">TestTokenInitialize()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a35" doxytag="ctaccess.c::PrimarySecurityQos" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> SECURITY_QUALITY_OF_SERVICE <a class="el" href="../../d2/d1/cttoken_8c.html#a34">PrimarySecurityQos</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00132">132</a> of file <a class="el" href="../../d7/d9/ctaccess_8c-source.html">ctaccess.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a31" doxytag="ctaccess.c::PrimaryToken" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HANDLE <a class="el" href="../../d6/d0/ctaccess_8c.html#a31">PrimaryToken</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00126">126</a> of file <a class="el" href="../../d7/d9/ctaccess_8c-source.html">ctaccess.c</a>.
<p>
Referenced by <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00299">CreateDAclToken()</a>, <a class="el" href="../../d8/d2/tokenopn_8c-source.html#l00458">NtOpenThreadToken()</a>, <a class="el" href="../../d9/d5/sertl_8c-source.html#l06520">RtlpConvertToAutoInheritSecurityObject()</a>, <a class="el" href="../../d9/d5/sertl_8c-source.html#l08795">RtlpGetDefaultsSubjectContext()</a>, <a class="el" href="../../d9/d5/sertl_8c-source.html#l10195">RtlpSetSecurityObject()</a>, <a class="el" href="../../d1/d3/accessck_8c-source.html#l01564">SepAccessCheck()</a>, <a class="el" href="../../d8/d5/sepaudit_8c-source.html#l01907">SepAdtObjectReferenceAuditAlarm()</a>, <a class="el" href="../../d8/d5/sepaudit_8c-source.html#l00571">SepAdtOpenObjectAuditAlarm()</a>, <a class="el" href="../../d8/d5/sepaudit_8c-source.html#l01003">SepAdtOpenObjectForDeleteAuditAlarm()</a>, <a class="el" href="../../d8/d5/sepaudit_8c-source.html#l00346">SepAdtPrivilegedServiceAuditAlarm()</a>, <a class="el" href="../../d8/d5/sepaudit_8c-source.html#l00125">SepAdtPrivilegeObjectAuditAlarm()</a>, <a class="el" href="../../d8/d2/tokenopn_8c-source.html#l00049">SepCreateImpersonationTokenDacl()</a>, <a class="el" href="../../d1/d7/subject_8c-source.html#l00234">SepGetDefaultsSubjectContext()</a>, <a class="el" href="../../d1/d3/accessck_8c-source.html#l00992">SepMaximumAccessCheck()</a>, and <a class="el" href="../../d1/d3/accessck_8c-source.html#l01304">SepNormalAccessCheck()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a33" doxytag="ctaccess.c::PrimaryTokenAttributes" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> OBJECT_ATTRIBUTES <a class="el" href="../../d2/d1/cttoken_8c.html#a32">PrimaryTokenAttributes</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00130">130</a> of file <a class="el" href="../../d7/d9/ctaccess_8c-source.html">ctaccess.c</a>.
<p>
Referenced by <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00299">CreateDAclToken()</a>, <a class="el" href="../../d5/d2/token_8c-source.html#l01327">SeSubProcessToken()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l07648">TestTokenAssignPrimary()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00421">TestTokenCreate()</a>, and <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00178">TestTokenInitialize()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a24" doxytag="ctaccess.c::SimpleToken" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HANDLE <a class="el" href="../../d2/d1/cttoken_8c.html#a19">SimpleToken</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00117">117</a> of file <a class="el" href="../../d7/d9/ctaccess_8c-source.html">ctaccess.c</a>.
<p>
Referenced by <a class="el" href="../../d3/d0/cttoken_8c-source.html#l04885">TestTokenAdjustGroups()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l03929">TestTokenAdjustPrivileges()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00421">TestTokenCreate()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l07402">TestTokenDuplicate()</a>, and <a class="el" href="../../d3/d0/cttoken_8c-source.html#l01434">TestTokenQuery()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a23" doxytag="ctaccess.c::Status" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS <a class="el" href="../../d2/d1/cttoken_8c.html#a18">Status</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00115">115</a> of file <a class="el" href="../../d7/d9/ctaccess_8c-source.html">ctaccess.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a51" doxytag="ctaccess.c::SystemAuthenticationId" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> LUID <a class="el" href="../../d1/d9/uipers_8c.html#a3">SystemAuthenticationId</a> = SYSTEM_LUID          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00155">155</a> of file <a class="el" href="../../d7/d9/ctaccess_8c-source.html">ctaccess.c</a>.
<p>
Referenced by <a class="el" href="../../d2/d8/uipers_8c-source.html#l00345">DisplaySecurityContext()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l07648">TestTokenAssignPrimary()</a>, and <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00421">TestTokenCreate()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a58" doxytag="ctaccess.c::TempDacl" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PACL <a class="el" href="../../d2/d1/cttoken_8c.html#a58">TempDacl</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00165">165</a> of file <a class="el" href="../../d7/d9/ctaccess_8c-source.html">ctaccess.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a57" doxytag="ctaccess.c::TempGroup" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PSID <a class="el" href="../../d2/d1/cttoken_8c.html#a57">TempGroup</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00164">164</a> of file <a class="el" href="../../d7/d9/ctaccess_8c-source.html">ctaccess.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a56" doxytag="ctaccess.c::TempOwner" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PSID <a class="el" href="../../d2/d1/cttoken_8c.html#a56">TempOwner</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00163">163</a> of file <a class="el" href="../../d7/d9/ctaccess_8c-source.html">ctaccess.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a48" doxytag="ctaccess.c::TempTimeFields" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> TIME_FIELDS <a class="el" href="../../d2/d1/cttoken_8c.html#a47">TempTimeFields</a> = {3000, 1, 1, 1, 1, 1, 1, 1}          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00151">151</a> of file <a class="el" href="../../d7/d9/ctaccess_8c-source.html">ctaccess.c</a>.
<p>
Referenced by <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00178">TestTokenInitialize()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a52" doxytag="ctaccess.c::TestSource" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> TOKEN_SOURCE <a class="el" href="../../d2/d1/cttoken_8c.html#a52">TestSource</a> = {"SE: TEST", 0}          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00157">157</a> of file <a class="el" href="../../d7/d9/ctaccess_8c-source.html">ctaccess.c</a>.
<p>
Referenced by <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00299">CreateDAclToken()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l07648">TestTokenAssignPrimary()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00421">TestTokenCreate()</a>, <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00178">TestTokenInitialize()</a>, and <a class="el" href="../../d3/d0/cttoken_8c-source.html#l01434">TestTokenQuery()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a29" doxytag="ctaccess.c::Token" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HANDLE <a class="el" href="../../d2/d1/cttoken_8c.html#a28">Token</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00123">123</a> of file <a class="el" href="../../d7/d9/ctaccess_8c-source.html">ctaccess.c</a>.
<p>
Referenced by <a class="el" href="../../d6/d9/exports_8c-source.html#l00045">_UserTestTokenForInteractive()</a>, <a class="el" href="../../d8/d2/partit_8c-source.html#l00149">ChooseDisk()</a>, <a class="el" href="../../d6/d2/parseini_8c-source.html#l00537">CmpGetToken()</a>, <a class="el" href="../../d3/d8/uipriv_8c-source.html#l00432">DisableAllPrivileges()</a>, <a class="el" href="../../d0/d4/edithive_8c-source.html#l00988">EhpAttachSecurity()</a>, <a class="el" href="../../d3/d8/uipriv_8c-source.html#l00225">EnableAllPrivileges()</a>, <a class="el" href="../../d5/d2/rtsetsec_8c-source.html#l00273">GetMySid()</a>, <a class="el" href="../../d6/d2/tokenadj_8c-source.html#l00432">NtAdjustGroupsToken()</a>, <a class="el" href="../../d6/d2/tokenadj_8c-source.html#l00046">NtAdjustPrivilegesToken()</a>, <a class="el" href="../../d7/d2/tokendup_8c-source.html#l00046">NtDuplicateToken()</a>, <a class="el" href="../../d7/d2/tokendup_8c-source.html#l01306">NtFilterToken()</a>, <a class="el" href="../../d4/d4/seaudit_8c-source.html#l02072">NtOpenObjectAuditAlarm()</a>, <a class="el" href="../../d8/d2/tokenopn_8c-source.html#l00178">NtOpenProcessToken()</a>, <a class="el" href="../../d8/d2/tokenopn_8c-source.html#l00458">NtOpenThreadToken()</a>, <a class="el" href="../../d9/d3/privileg_8c-source.html#l00231">NtPrivilegeCheck()</a>, <a class="el" href="../../d4/d4/seaudit_8c-source.html#l00731">NtPrivilegedServiceAuditAlarm()</a>, <a class="el" href="../../d4/d4/seaudit_8c-source.html#l00406">NtPrivilegeObjectAuditAlarm()</a>, <a class="el" href="../../d0/d3/tokenqry_8c-source.html#l00034">NtQueryInformationToken()</a>, <a class="el" href="../../d6/d5/lpcconn_8c-source.html#l00084">NtSecureConnectPort()</a>, <a class="el" href="../../d0/d1/psquery_8c-source.html#l01510">NtSetInformationProcess()</a>, <a class="el" href="../../d1/d3/tokenset_8c-source.html#l00037">NtSetInformationToken()</a>, <a class="el" href="../../d3/d8/uipriv_8c-source.html#l00148">OpenAppropriateToken()</a>, <a class="el" href="../../d7/d4/ps_2security_8c-source.html#l01483">PsAssignImpersonationToken()</a>, <a class="el" href="../../d7/d4/ps_2security_8c-source.html#l00650">PsImpersonateClient()</a>, <a class="el" href="../../d7/d4/ps_2security_8c-source.html#l00586">PsOpenTokenOfJobObject()</a>, <a class="el" href="../../d7/d4/ps_2security_8c-source.html#l00326">PsOpenTokenOfThread()</a>, <a class="el" href="../../d7/d4/ps_2security_8c-source.html#l01256">PspAssignPrimaryToken()</a>, <a class="el" href="../../d7/d4/ps_2security_8c-source.html#l00208">PsReferenceEffectiveToken()</a>, <a class="el" href="../../d7/d4/ps_2security_8c-source.html#l00097">PsReferenceImpersonationToken()</a>, <a class="el" href="../../d7/d4/ps_2security_8c-source.html#l00028">PsReferencePrimaryToken()</a>, <a class="el" href="../../d3/d8/uipriv_8c-source.html#l00322">ResetAllPrivileges()</a>, <a class="el" href="../../d9/d5/sertl_8c-source.html#l00639">RtlAdjustPrivilege()</a>, <a class="el" href="../../d5/d7/seurtl_8c-source.html#l00680">RtlNewInstanceSecurityObject()</a>, <a class="el" href="../../d5/d7/seurtl_8c-source.html#l00818">RtlNewSecurityGrantedAccess()</a>, <a class="el" href="../../d5/d7/seurtl_8c-source.html#l00280">RtlNewSecurityObject()</a>, <a class="el" href="../../d5/d7/seurtl_8c-source.html#l00226">RtlNewSecurityObjectEx()</a>, <a class="el" href="../../d9/d5/sertl_8c-source.html#l09057">RtlpNewSecurityObject()</a>, <a class="el" href="../../d9/d5/sertl_8c-source.html#l10195">RtlpSetSecurityObject()</a>, <a class="el" href="../../d9/d5/sertl_8c-source.html#l03544">RtlpValidOwnerSubjectContext()</a>, <a class="el" href="../../d5/d7/seurtl_8c-source.html#l00331">RtlSetSecurityObject()</a>, <a class="el" href="../../d5/d7/seurtl_8c-source.html#l00373">RtlSetSecurityObjectEx()</a>, <a class="el" href="../../d1/d3/accessck_8c-source.html#l02704">SeAccessCheckByType()</a>, <a class="el" href="../../d5/d2/token_8c-source.html#l00241">SeAssignPrimaryToken()</a>, <a class="el" href="../../d8/d5/sepaudit_8c-source.html#l02653">SeAuditProcessExit()</a>, <a class="el" href="../../d5/d4/seclient_8c-source.html#l00209">SeCreateClientSecurity()</a>, <a class="el" href="../../d5/d4/seclient_8c-source.html#l00712">SeCreateClientSecurityFromSubjectContext()</a>, <a class="el" href="../../d7/d2/tokendup_8c-source.html#l01634">SeFilterToken()</a>, <a class="el" href="../../d5/d2/token_8c-source.html#l00475">SeGetTokenControlInformation()</a>, <a class="el" href="../../d5/d2/token_8c-source.html#l02867">SeIsChildToken()</a>, <a class="el" href="../../d5/d2/token_8c-source.html#l02960">SeIsChildTokenByPointer()</a>, <a class="el" href="../../d5/d2/token_8c-source.html#l01010">SeMakeAnonymousLogonToken()</a>, <a class="el" href="../../d5/d2/token_8c-source.html#l00536">SeMakeSystemToken()</a>, <a class="el" href="../../d4/d4/seaudit_8c-source.html#l02765">SeOpenObjectAuditAlarm()</a>, <a class="el" href="../../d4/d4/seaudit_8c-source.html#l03085">SeOpenObjectForDeleteAuditAlarm()</a>, <a class="el" href="../../d6/d2/tokenadj_8c-source.html#l01099">SepAdjustGroups()</a>, <a class="el" href="../../d6/d2/tokenadj_8c-source.html#l00819">SepAdjustPrivileges()</a>, <a class="el" href="../../d1/d3/tokenset_8c-source.html#l00778">SepAppendDefaultDacl()</a>, <a class="el" href="../../d1/d3/tokenset_8c-source.html#l00697">SepAppendPrimaryGroup()</a>, <a class="el" href="../../d5/d4/seclient_8c-source.html#l00062">SepCreateClientSecurity()</a>, <a class="el" href="../../d8/d2/tokenopn_8c-source.html#l00049">SepCreateImpersonationTokenDacl()</a>, <a class="el" href="../../d5/d2/token_8c-source.html#l02213">SepCreateToken()</a>, <a class="el" href="../../d2/d4/seassign_8c-source.html#l00995">SepDumpTokenInfo()</a>, <a class="el" href="../../d4/d4/seaudit_8c-source.html#l03952">SepExamineSacl()</a>, <a class="el" href="../../d4/d4/seaudit_8c-source.html#l04257">SepExamineSaclEx()</a>, <a class="el" href="../../d1/d3/tokenset_8c-source.html#l00635">SepFreeDefaultDacl()</a>, <a class="el" href="../../d1/d3/tokenset_8c-source.html#l00576">SepFreePrimaryGroup()</a>, <a class="el" href="../../d1/d7/subject_8c-source.html#l00306">SepIdAssignableAsGroup()</a>, <a class="el" href="../../d5/d2/token_8c-source.html#l02813">SepIdAssignableAsOwner()</a>, <a class="el" href="../../d7/d2/tokendup_8c-source.html#l00806">SepMakeTokenEffectiveOnly()</a>, <a class="el" href="../../d8/d2/tokenopn_8c-source.html#l00294">SepOpenTokenOfThread()</a>, <a class="el" href="../../d9/d3/privileg_8c-source.html#l00038">SepPrivilegeCheck()</a>, <a class="el" href="../../d7/d2/tokendup_8c-source.html#l01041">SepRemoveDisabledGroupsAndPrivileges()</a>, <a class="el" href="../../d4/d4/seaudit_8c-source.html#l00989">SePrivilegedServiceAuditAlarm()</a>, <a class="el" href="../../d1/d3/accessck_8c-source.html#l03652">SePrivilegePolicyCheck()</a>, <a class="el" href="../../d7/d2/tokendup_8c-source.html#l00933">SepSidInSidAndAttributes()</a>, <a class="el" href="../../d1/d3/accessck_8c-source.html#l00733">SepSidInToken()</a>, <a class="el" href="../../d1/d3/accessck_8c-source.html#l00856">SepSidInTokenEx()</a>, <a class="el" href="../../d4/d4/seaudit_8c-source.html#l00143">SepSinglePrivilegeCheck()</a>, <a class="el" href="../../d5/d2/token_8c-source.html#l02156">SepTokenDeleteMethod()</a>, <a class="el" href="../../d1/d3/accessck_8c-source.html#l03796">SepTokenIsOwner()</a>, <a class="el" href="../../d0/d3/tokenqry_8c-source.html#l01152">SeQueryAuthenticationIdToken()</a>, <a class="el" href="../../d0/d3/tokenqry_8c-source.html#l01189">SeQueryInformationToken()</a>, <a class="el" href="../../d0/d3/tokenqry_8c-source.html#l01763">SeQuerySessionIdToken()</a>, <a class="el" href="../../d1/d3/tokenset_8c-source.html#l00851">SeSetSessionIdToken()</a>, <a class="el" href="../../d5/d2/token_8c-source.html#l00211">SeTokenImpersonationLevel()</a>, <a class="el" href="../../d5/d2/token_8c-source.html#l00150">SeTokenIsAdmin()</a>, <a class="el" href="../../d5/d2/token_8c-source.html#l00181">SeTokenIsRestricted()</a>, <a class="el" href="../../d5/d2/token_8c-source.html#l00118">SeTokenType()</a>, <a class="el" href="../../d2/d5/tse_8c-source.html#l00503">TestAccessCheck()</a>, <a class="el" href="../../d2/d5/tse_8c-source.html#l00360">TestAssignSecurity()</a>, <a class="el" href="../../d2/d5/tse_8c-source.html#l00105">TestMakeSystemToken()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l07648">TestTokenAssignPrimary()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00421">TestTokenCreate()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l01085">TestTokenFilter()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l07982">TestTokenImpersonation()</a>, <a class="el" href="../../d2/d5/tse_8c-source.html#l00177">TestTokenSize()</a>, <a class="el" href="../../d9/d7/aug98_2dll32_2csprof_8c-source.html#l01241">WriteHNAToken()</a>, and <a class="el" href="../../d9/d7/aug98_2dll32_2csprof_8c-source.html#l01227">WriteStringToken()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a28" doxytag="ctaccess.c::TokenWithDefaultDacl" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HANDLE <a class="el" href="../../d2/d1/cttoken_8c.html#a23">TokenWithDefaultDacl</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00121">121</a> of file <a class="el" href="../../d7/d9/ctaccess_8c-source.html">ctaccess.c</a>.
<p>
Referenced by <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00421">TestTokenCreate()</a>, and <a class="el" href="../../d3/d0/cttoken_8c-source.html#l01434">TestTokenQuery()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a26" doxytag="ctaccess.c::TokenWithDefaultOwner" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HANDLE <a class="el" href="../../d2/d1/cttoken_8c.html#a21">TokenWithDefaultOwner</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00119">119</a> of file <a class="el" href="../../d7/d9/ctaccess_8c-source.html">ctaccess.c</a>.
<p>
Referenced by <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00421">TestTokenCreate()</a>, and <a class="el" href="../../d3/d0/cttoken_8c-source.html#l01434">TestTokenQuery()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a25" doxytag="ctaccess.c::TokenWithGroups" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HANDLE <a class="el" href="../../d2/d1/cttoken_8c.html#a20">TokenWithGroups</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00118">118</a> of file <a class="el" href="../../d7/d9/ctaccess_8c-source.html">ctaccess.c</a>.
<p>
Referenced by <a class="el" href="../../d3/d0/cttoken_8c-source.html#l04885">TestTokenAdjustGroups()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00421">TestTokenCreate()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l01085">TestTokenFilter()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l07982">TestTokenImpersonation()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l01434">TestTokenQuery()</a>, and <a class="el" href="../../d3/d0/cttoken_8c-source.html#l03311">TestTokenSet()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a27" doxytag="ctaccess.c::TokenWithPrivileges" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HANDLE <a class="el" href="../../d2/d1/cttoken_8c.html#a22">TokenWithPrivileges</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d9/ctaccess_8c-source.html#l00120">120</a> of file <a class="el" href="../../d7/d9/ctaccess_8c-source.html">ctaccess.c</a>.
<p>
Referenced by <a class="el" href="../../d3/d0/cttoken_8c-source.html#l03929">TestTokenAdjustPrivileges()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00421">TestTokenCreate()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l01085">TestTokenFilter()</a>, and <a class="el" href="../../d3/d0/cttoken_8c-source.html#l01434">TestTokenQuery()</a>.    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:43:21 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
