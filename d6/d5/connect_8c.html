<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: connect.c File Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>connect.c File Reference</h1><code>#include "<a class="el" href="../../d8/d2/w32_2ntuser_2client_2precomp_8h-source.html">precomp.h</a>"</code><br>
<code>#include "nddeagnt.h"</code><br>

<p>
<a href="../../d7/d4/connect_8c-source.html">Go to the source code of this file.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Classes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d8/structtagINIT__ENUM.html">tagINIT_ENUM</a></td></tr>

<tr><td colspan=2><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d5/connect_8c.html#a0">ValidateConvList</a>(h)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d5/connect_8c.html#a1">ValidateAllConvLists</a>()</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d5/connect_8c.html#a2">ORPATH</a>(x)</td></tr>

<tr><td colspan=2><br><h2>Typedefs</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d6/d8/structtagINIT__ENUM.html">tagINIT_ENUM</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d5/connect_8c.html#a5">INIT_ENUM</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d6/d8/structtagINIT__ENUM.html">tagINIT_ENUM</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d5/connect_8c.html#a6">PINIT_ENUM</a></td></tr>

<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d5/connect_8c.html#a7">InitiateEnumerationProc</a> (HWND hwndTarget, <a class="el" href="../../d6/d8/structtagINIT__ENUM.html">PINIT_ENUM</a> pie)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d5/connect_8c.html#a8">DisconnectConv</a> (<a class="el" href="../../d2/d1/structtagCONV__INFO.html">PCONV_INFO</a> pcoi)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HCONV&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d5/connect_8c.html#a9">DdeConnect</a> (<a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> idInst, HSZ hszService, HSZ hszTopic, PCONVCONTEXT pCC)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HCONVLIST&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d5/connect_8c.html#a10">DdeConnectList</a> (<a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> idInst, HSZ hszService, HSZ hszTopic, HCONVLIST hConvList, PCONVCONTEXT pCC)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HCONV&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d5/connect_8c.html#a11">DdeReconnect</a> (HCONV hConv)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d5/connect_8c.html#a12">ValidateConnectParameters</a> (HANDLE <a class="el" href="../../d5/d8/jul98_2test_2main_8c.html#a0">hInst</a>, <a class="el" href="../../d2/d0/structtagCL__INSTANCE__INFO.html">PCL_INSTANCE_INFO</a> *ppcii, HSZ *phszService, HSZ hszTopic, <a class="el" href="../../d0/d4/ddemlcli_8h.html#a51">LATOM</a> *plaNormalSvcName, PCONVCONTEXT *ppCC, HWND *phwndTarget, HCONVLIST hConvList)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d1/d0/structtagCL__CONV__INFO.html">PCL_CONV_INFO</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d5/connect_8c.html#a13">ConnectConv</a> (<a class="el" href="../../d2/d0/structtagCL__INSTANCE__INFO.html">PCL_INSTANCE_INFO</a> pcii, <a class="el" href="../../d0/d4/ddemlcli_8h.html#a51">LATOM</a> laService, <a class="el" href="../../d0/d4/ddemlcli_8h.html#a51">LATOM</a> laTopic, HWND hwndTarget, HWND hwndSkip, PCONVCONTEXT pCC, HCONVLIST hConvList, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> clst)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d5/connect_8c.html#a14">SetCommonStateFlags</a> (HWND hwndUs, HWND hwndThem, PWORD pwFlags)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HCONV&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d5/connect_8c.html#a15">DdeQueryNextServer</a> (HCONVLIST hConvList, HCONV hConvPrev)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d5/connect_8c.html#a16">DdeDisconnect</a> (HCONV hConv)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d5/connect_8c.html#a17">DdeDisconnectList</a> (HCONVLIST hConvList)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d5/connect_8c.html#a18">ShutdownConversation</a> (<a class="el" href="../../d2/d1/structtagCONV__INFO.html">PCONV_INFO</a> pcoi, BOOL fMakeCallback)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d5/connect_8c.html#a19">UnlinkConvFromOthers</a> (<a class="el" href="../../d2/d1/structtagCONV__INFO.html">PCONV_INFO</a> pcoi, BOOL gGoingZombie)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d5/connect_8c.html#a20">FreeConversationResources</a> (<a class="el" href="../../d2/d1/structtagCONV__INFO.html">PCONV_INFO</a> pcoi)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d5/connect_8c.html#a21">WaitForZombieTerminate</a> (HANDLE hData)</td></tr>

<tr><td colspan=2><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>CONVCONTEXT&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d5/connect_8c.html#a3">TempConvContext</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>CONVCONTEXT&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d5/connect_8c.html#a4">DefConvContext</a></td></tr>

</table>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="a2" doxytag="connect.c::ORPATH" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ORPATH          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">x&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d7/d4/connect_8c-source.html#l01153">UnlinkConvFromOthers()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="connect.c::ValidateAllConvLists" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ValidateAllConvLists          </td>
          <td class="md" valign="top">(&nbsp;</td>
&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d4/connect_8c-source.html#l00103">103</a> of file <a class="el" href="../../d7/d4/connect_8c-source.html">connect.c</a>.
<p>
Referenced by <a class="el" href="../../d7/d4/connect_8c-source.html#l01153">UnlinkConvFromOthers()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a0" doxytag="connect.c::ValidateConvList" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ValidateConvList          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">h&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d4/connect_8c-source.html#l00102">102</a> of file <a class="el" href="../../d7/d4/connect_8c-source.html">connect.c</a>.
<p>
Referenced by <a class="el" href="../../d7/d4/connect_8c-source.html#l00195">DdeConnectList()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l01053">DdeDisconnectList()</a>, and <a class="el" href="../../d7/d4/connect_8c-source.html#l01153">UnlinkConvFromOthers()</a>.    </td>
  </tr>
</table>
<hr><h2>Typedef Documentation</h2>
<a class="anchor" name="a5" doxytag="connect.c::INIT_ENUM" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d6/d8/structtagINIT__ENUM.html">tagINIT_ENUM</a>  <a class="el" href="../../d6/d8/structtagINIT__ENUM.html">INIT_ENUM</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a6" doxytag="connect.c::PINIT_ENUM" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d6/d8/structtagINIT__ENUM.html">tagINIT_ENUM</a> * <a class="el" href="../../d6/d8/structtagINIT__ENUM.html">PINIT_ENUM</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a13" doxytag="connect.c::ConnectConv" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d1/d0/structtagCL__CONV__INFO.html">PCL_CONV_INFO</a> ConnectConv           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d2/d0/structtagCL__INSTANCE__INFO.html">PCL_INSTANCE_INFO</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pcii</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d4/ddemlcli_8h.html#a51">LATOM</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>laService</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d4/ddemlcli_8h.html#a51">LATOM</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>laTopic</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HWND&nbsp;</td>
          <td class="mdname" nowrap> <em>hwndTarget</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HWND&nbsp;</td>
          <td class="mdname" nowrap> <em>hwndSkip</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>PCONVCONTEXT&nbsp;</td>
          <td class="mdname" nowrap> <em>pCC</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HCONVLIST&nbsp;</td>
          <td class="mdname" nowrap> <em>hConvList</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>clst</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d4/connect_8c-source.html#l00607">607</a> of file <a class="el" href="../../d7/d4/connect_8c-source.html">connect.c</a>.
<p>
References <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l01297">tagSERVERINFO::atomSysClass</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00058">CheckDDECritIn</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00059">CheckDDECritOut</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00231">tagCL_CONV_INFO::ci</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00129">tagINIT_ENUM::clst</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00679">CLST_CONNECTED</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00048">EnterDDECrit</a>, <a class="el" href="../../d1/d7/clenum_8c-source.html#l00171">EnumWindows()</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00011">Error</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00200">tagCL_INSTANCE_INFO::flags</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00025">GATOM</a>, <a class="el" href="../../d6/d8/cltxt_8h-source.html#l00388">GetWindowLongPtr()</a>, <a class="el" href="../../d2/d7/clglobal_8c-source.html#l00051">gpsi</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00675">GWL_CONVSTATE</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00677">GWLP_CHINST</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00673">GWLP_PCI</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00676">GWLP_SHINST</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00128">tagINIT_ENUM::hConvList</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00186">tagCL_INSTANCE_INFO::hInstClient</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00185">tagCL_INSTANCE_INFO::hInstServer</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00123">tagINIT_ENUM::hwndClient</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00188">tagCL_INSTANCE_INFO::hwndMother</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00232">tagCL_CONV_INFO::hwndReconnect</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00124">tagINIT_ENUM::hwndSkip</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00358">ICLS_DDEMLCLIENTA</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00359">ICLS_DDEMLCLIENTW</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00206">IIF_UNICODE</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00516">IncLocalAtomCount()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00784">InitiateEnumerationProc()</a>, <a class="el" href="../../d3/d9/aw_8h-source.html#l00031">L</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00126">tagINIT_ENUM::laServiceRequested</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00220">tagCONV_INFO::laServiceRequested</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00127">tagINIT_ENUM::laTopic</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00049">LeaveDDECrit</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00438">LocalToGlobalAtom()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00125">tagINIT_ENUM::lParam</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">LPVOID</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00036">MONCONV</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00187">tagCL_INSTANCE_INFO::MonitorFlags</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00211">tagCONV_INFO::next</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l04369">NtUserDdeSetQualityOfService()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l04115">NtUserDestroyWindow()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d6/d8/cltxt_8h-source.html#l00652">SendMessage()</a>, <a class="el" href="../../d1/d0/xact_8c-source.html#l00387">SetConvContext()</a>, <a class="el" href="../../d1/d3/instance_8c-source.html#l00137">SetLastDDEMLError()</a>, <a class="el" href="../../d6/d8/cltxt_8h-source.html#l00408">SetWindowLongPtr()</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d7/d4/connect_8c-source.html#l00146">DdeConnect()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00195">DdeConnectList()</a>, and <a class="el" href="../../d7/d4/connect_8c-source.html#l00409">DdeReconnect()</a>.
<p>
<pre class="fragment"><div>00616 {
00617     <a class="code" href="../../d6/d8/structtagINIT__ENUM.html">INIT_ENUM</a> ie;
00618     <a class="code" href="../../d1/d0/structtagCL__CONV__INFO.html">PCL_CONV_INFO</a> pci;
00619     <a class="code" href="../../d2/d1/structtagCONV__INFO.html">PCONV_INFO</a> pcoi;
00620     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a52">GATOM</a> gaService, gaTopic;
00621 
00622     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a8">CheckDDECritIn</a>;
00623 
00624     <span class="keywordflow">if</span> (hwndTarget &amp;&amp; hwndTarget == hwndSkip) {
00625         <span class="keywordflow">return</span>(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>);
00626     }
00627 
00628     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a7">LeaveDDECrit</a>;
00629     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a9">CheckDDECritOut</a>;
00630 
00631     <span class="keywordflow">if</span> (pcii-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o16">flags</a> &amp; <a class="code" href="../../d0/d4/ddemlcli_8h.html#a50">IIF_UNICODE</a>) {
00632         ie.<a class="code" href="../../d6/d8/structtagINIT__ENUM.html#o0">hwndClient</a> = CreateWindowW((LPWSTR)(<a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;<a class="code" href="../../d2/d6/structtagSERVERINFO.html#o12">atomSysClass</a>[ICLS_DDEMLCLIENTW]),
00633                                      L<span class="stringliteral">""</span>,
00634                                      WS_CHILD,
00635                                      0, 0, 0, 0,
00636                                      pcii-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o4">hwndMother</a>,
00637                                      (HMENU)0,
00638                                      (HANDLE)0,
00639                                      (LPVOID)NULL);
00640     } <span class="keywordflow">else</span> {
00641         ie.<a class="code" href="../../d6/d8/structtagINIT__ENUM.html#o0">hwndClient</a> = CreateWindowA((LPSTR)(<a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;<a class="code" href="../../d2/d6/structtagSERVERINFO.html#o12">atomSysClass</a>[ICLS_DDEMLCLIENTA]),
00642                                      <span class="stringliteral">""</span>,
00643                                      WS_CHILD,
00644                                      0, 0, 0, 0,
00645                                      pcii-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o4">hwndMother</a>,
00646                                      (HMENU)0,
00647                                      (HANDLE)0,
00648                                      (LPVOID)NULL);
00649     }
00650 
00651     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a6">EnterDDECrit</a>;
00652 
00653     <span class="keywordflow">if</span> (ie.<a class="code" href="../../d6/d8/structtagINIT__ENUM.html#o0">hwndClient</a> == 0) {
00654         <span class="keywordflow">return</span> (<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>);
00655     }
00656 
00657     <span class="keywordflow">if</span> (pCC != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00658         <span class="keywordflow">if</span> (!<a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a168">NtUserDdeSetQualityOfService</a>(ie.<a class="code" href="../../d6/d8/structtagINIT__ENUM.html#o0">hwndClient</a>, &amp;(pCC-&gt;qos), NULL)) {
00659             <a class="code" href="../../d0/d4/instance_8c.html#a8">SetLastDDEMLError</a>(pcii, DMLERR_MEMORY_ERROR);
00660             <span class="keywordflow">goto</span> <a class="code" href="../../d7/d0/ctlnpqos_8c.html#a1">Error</a>;
00661         }
00662     }
00663     <span class="comment">/*</span>
00664 <span class="comment">     * Note that a pci will be created and allocated for each ACK recieved.</span>
00665 <span class="comment">     */</span>
00666     <a class="code" href="../../d0/d1/xact_8c.html#a2">SetConvContext</a>(ie.<a class="code" href="../../d6/d8/structtagINIT__ENUM.html#o0">hwndClient</a>, (LONG *)pCC);
00667     SetWindowLong(ie.<a class="code" href="../../d6/d8/structtagINIT__ENUM.html#o0">hwndClient</a>, GWL_CONVSTATE, clst);
00668     <a class="code" href="../../d5/d9/cltxt_8h.html#a12">SetWindowLongPtr</a>(ie.<a class="code" href="../../d6/d8/structtagINIT__ENUM.html#o0">hwndClient</a>, GWLP_SHINST, (LONG_PTR)pcii-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o1">hInstServer</a>);
00669     <a class="code" href="../../d5/d9/cltxt_8h.html#a12">SetWindowLongPtr</a>(ie.<a class="code" href="../../d6/d8/structtagINIT__ENUM.html#o0">hwndClient</a>, GWLP_CHINST, (LONG_PTR)pcii-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o2">hInstClient</a>);
00670 
00671     gaService = <a class="code" href="../../d4/d2/hsz_8c.html#a12">LocalToGlobalAtom</a>(laService);
00672     gaTopic = <a class="code" href="../../d4/d2/hsz_8c.html#a12">LocalToGlobalAtom</a>(laTopic);
00673     ie.<a class="code" href="../../d6/d8/structtagINIT__ENUM.html#o2">lParam</a> = MAKELONG(gaService, gaTopic);
00674     <span class="keywordflow">if</span> (!hwndTarget) {
00675         ie.<a class="code" href="../../d6/d8/structtagINIT__ENUM.html#o1">hwndSkip</a> = hwndSkip;
00676         ie.<a class="code" href="../../d6/d8/structtagINIT__ENUM.html#o3">laServiceRequested</a> = laService;
00677         ie.<a class="code" href="../../d6/d8/structtagINIT__ENUM.html#o4">laTopic</a> = laTopic;
00678         ie.<a class="code" href="../../d6/d8/structtagINIT__ENUM.html#o5">hConvList</a> = hConvList;
00679         ie.<a class="code" href="../../d6/d8/structtagINIT__ENUM.html#o6">clst</a> = clst;
00680     }
00681 
00682     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a7">LeaveDDECrit</a>;
00683 
00684     <span class="keywordflow">if</span> (hwndTarget) {
00685         <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(hwndTarget, WM_DDE_INITIATE, (WPARAM)ie.<a class="code" href="../../d6/d8/structtagINIT__ENUM.html#o0">hwndClient</a>,
00686                 ie.<a class="code" href="../../d6/d8/structtagINIT__ENUM.html#o2">lParam</a>);
00687     } <span class="keywordflow">else</span> {
00688         <span class="comment">/*</span>
00689 <span class="comment">         * Send this message to the nddeagnt app first so it can start</span>
00690 <span class="comment">         * the netdde services BEFORE we do an enumeration of windows.</span>
00691 <span class="comment">         * This lets things work the first time.  NetDDEAgent caches</span>
00692 <span class="comment">         * service status so this is the fastest way to do this.</span>
00693 <span class="comment">         */</span>
00694         HWND hwndAgent = FindWindowW(SZ_NDDEAGNT_CLASS, SZ_NDDEAGNT_TITLE);
00695         <span class="keywordflow">if</span> (hwndAgent) {
00696             <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(hwndAgent,
00697                 WM_DDE_INITIATE, (WPARAM)ie.<a class="code" href="../../d6/d8/structtagINIT__ENUM.html#o0">hwndClient</a>, ie.<a class="code" href="../../d6/d8/structtagINIT__ENUM.html#o2">lParam</a>);
00698         }
00699         <a class="code" href="../../d0/d8/clenum_8c.html#a7">EnumWindows</a>((WNDENUMPROC)InitiateEnumerationProc, (LPARAM)&amp;ie);
00700     }
00701 
00702     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a6">EnterDDECrit</a>;
00703     <span class="comment">/*</span>
00704 <span class="comment">     * hConvList may have been destroyed during the enumeration but we are</span>
00705 <span class="comment">     * done with it now so no need to revalidate.</span>
00706 <span class="comment">     */</span>
00707 
00708 <span class="preprocessor">#if DBG</span>
00709 <span class="preprocessor"></span>    {
00710         WCHAR sz[10];
00711 
00712         <span class="keywordflow">if</span> (gaService &amp;&amp; GlobalGetAtomName(gaService, sz, 10) == 0) {
00713             RIPMSG1(RIP_ERROR, <span class="stringliteral">"Bad Service Atom after Initiate phase: %lX"</span>, (DWORD)gaService);
00714         }
00715         <span class="keywordflow">if</span> (gaTopic &amp;&amp; GlobalGetAtomName(gaTopic, sz, 10) == 0) {
00716             RIPMSG1(RIP_ERROR, <span class="stringliteral">"Bad Topic Atom after Initiate phase: %lX"</span>, (DWORD)gaTopic);
00717         }
00718     }
00719 <span class="preprocessor">#endif // DBG</span>
00720 <span class="preprocessor"></span>
00721     GlobalDeleteAtom(gaService);
00722     GlobalDeleteAtom(gaTopic);
00723 
00724     <span class="comment">//</span>
00725     <span class="comment">// Get the first pci allocated when a WM_DDE_ACK was recieved.</span>
00726     <span class="comment">//</span>
00727     pci = (<a class="code" href="../../d1/d0/structtagCL__CONV__INFO.html">PCL_CONV_INFO</a>)<a class="code" href="../../d5/d9/cltxt_8h.html#a11">GetWindowLongPtr</a>(ie.<a class="code" href="../../d6/d8/structtagINIT__ENUM.html#o0">hwndClient</a>, GWLP_PCI);
00728     <span class="keywordflow">if</span> (pci == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00729 <a class="code" href="../../d7/d0/ctlnpqos_8c.html#a1">Error</a>:
00730         <a class="code" href="../../d0/d4/ddemlcli_8h.html#a7">LeaveDDECrit</a>;
00731         <a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a159">NtUserDestroyWindow</a>(ie.<a class="code" href="../../d6/d8/structtagINIT__ENUM.html#o0">hwndClient</a>);
00732         <a class="code" href="../../d0/d4/ddemlcli_8h.html#a6">EnterDDECrit</a>;
00733         <span class="keywordflow">return</span> (<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>);
00734     }
00735 
00736     SetWindowLong(ie.<a class="code" href="../../d6/d8/structtagINIT__ENUM.html#o0">hwndClient</a>, GWL_CONVSTATE, CLST_CONNECTED);
00737     <span class="keywordflow">if</span> (hwndTarget) {
00738         <span class="comment">/*</span>
00739 <span class="comment">         * If hwndTarget was NULL, the enumeration proc took care of this.</span>
00740 <span class="comment">         */</span>
00741         pci-&gt;<a class="code" href="../../d1/d0/structtagCL__CONV__INFO.html#o1">hwndReconnect</a> = hwndTarget;
00742         UserAssert(pci-&gt;<a class="code" href="../../d1/d0/structtagCL__CONV__INFO.html#o0">ci</a>.<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o0">next</a> == NULL);
00743         pci-&gt;<a class="code" href="../../d1/d0/structtagCL__CONV__INFO.html#o0">ci</a>.<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o9">laServiceRequested</a> = laService;
00744         <a class="code" href="../../d4/d2/hsz_8c.html#a15">IncLocalAtomCount</a>(laService); <span class="comment">// pci copy</span>
00745     }
00746 
00747     <span class="keywordflow">if</span> (pcii-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o3">MonitorFlags</a> &amp; MF_CONV) {
00748         <span class="keywordflow">for</span> (pcoi = (<a class="code" href="../../d2/d1/structtagCONV__INFO.html">PCONV_INFO</a>)pci; pcoi; pcoi = pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o0">next</a>) {
00749             <a class="code" href="../../d0/d4/ddemlcli_8h.html#a5">MONCONV</a>(pcoi, TRUE);
00750         }
00751     }
00752     <span class="keywordflow">return</span> (pci);
00753 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a9" doxytag="connect.c::DdeConnect" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HCONV DdeConnect           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>idInst</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HSZ&nbsp;</td>
          <td class="mdname" nowrap> <em>hszService</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HSZ&nbsp;</td>
          <td class="mdname" nowrap> <em>hszTopic</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>PCONVCONTEXT&nbsp;</td>
          <td class="mdname" nowrap> <em>pCC</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d4/connect_8c-source.html#l00146">146</a> of file <a class="el" href="../../d7/d4/connect_8c-source.html">connect.c</a>.
<p>
References <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00191">tagCL_INSTANCE_INFO::afCmd</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00231">tagCL_CONV_INFO::ci</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00680">CLST_SINGLE_INITIALIZING</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00607">ConnectConv()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00048">EnterDDECrit</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00214">tagCONV_INFO::hConv</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00188">tagCL_INSTANCE_INFO::hwndMother</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00024">LATOM</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00069">LATOM_FROM_HSZ</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00049">LeaveDDECrit</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d1/d3/instance_8c-source.html#l00137">SetLastDDEMLError()</a>, and <a class="el" href="../../d7/d4/connect_8c-source.html#l00491">ValidateConnectParameters()</a>.
<p>
<pre class="fragment"><div>00151 {
00152     <a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html">PCL_INSTANCE_INFO</a> pcii;
00153     <a class="code" href="../../d1/d0/structtagCL__CONV__INFO.html">PCL_CONV_INFO</a> pci;
00154     HCONV hConvRet = 0;
00155     HWND hwndTarget = 0;
00156     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a51">LATOM</a> aNormalSvcName = 0;
00157 
00158     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a6">EnterDDECrit</a>;
00159 
00160     <span class="keywordflow">if</span> (!<a class="code" href="../../d0/d4/ddemlcli_8h.html#a110">ValidateConnectParameters</a>((HANDLE)LongToHandle( idInst ), &amp;pcii, &amp;hszService, hszTopic,
00161             &amp;aNormalSvcName, &amp;pCC, &amp;hwndTarget, 0)) {
00162         <span class="keywordflow">goto</span> Exit;
00163     }
00164     pci = <a class="code" href="../../d0/d4/ddemlcli_8h.html#a111">ConnectConv</a>(pcii, <a class="code" href="../../d0/d4/ddemlcli_8h.html#a13">LATOM_FROM_HSZ</a>(hszService), <a class="code" href="../../d0/d4/ddemlcli_8h.html#a13">LATOM_FROM_HSZ</a>(hszTopic),
00165             hwndTarget,
00166             (pcii-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o7">afCmd</a> &amp; CBF_FAIL_SELFCONNECTIONS) ? pcii-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o4">hwndMother</a> : 0,
00167             pCC, 0, CLST_SINGLE_INITIALIZING);
00168     <span class="keywordflow">if</span> (pci == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00169         <a class="code" href="../../d0/d4/instance_8c.html#a8">SetLastDDEMLError</a>(pcii, DMLERR_NO_CONV_ESTABLISHED);
00170         <span class="keywordflow">goto</span> Exit;
00171     } <span class="keywordflow">else</span> {
00172         hConvRet = pci-&gt;<a class="code" href="../../d1/d0/structtagCL__CONV__INFO.html#o0">ci</a>.<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o3">hConv</a>;
00173     }
00174 
00175 Exit:
00176     <span class="keywordflow">if</span> (aNormalSvcName) {
00177         GlobalDeleteAtom(aNormalSvcName);
00178     }
00179     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a7">LeaveDDECrit</a>;
00180     <span class="keywordflow">return</span> (hConvRet);
00181 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a10" doxytag="connect.c::DdeConnectList" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HCONVLIST DdeConnectList           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>idInst</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HSZ&nbsp;</td>
          <td class="mdname" nowrap> <em>hszService</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HSZ&nbsp;</td>
          <td class="mdname" nowrap> <em>hszTopic</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HCONVLIST&nbsp;</td>
          <td class="mdname" nowrap> <em>hConvList</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>PCONVCONTEXT&nbsp;</td>
          <td class="mdname" nowrap> <em>pCC</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d4/connect_8c-source.html#l00195">195</a> of file <a class="el" href="../../d7/d4/connect_8c-source.html">connect.c</a>.
<p>
References <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00191">tagCL_INSTANCE_INFO::afCmd</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00242">tagCONVLIST::ahwnd</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00059">CheckDDECritOut</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00241">tagCONVLIST::chwnd</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00681">CLST_MULT_INITIALIZING</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00607">ConnectConv()</a>, <a class="el" href="../../d0/d4/ddemlcli_8h.html#a76">CONVLIST</a>, <a class="el" href="../../d4/d7/handles_8c-source.html#l00075">CreateHandle()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00016">DDEMLAlloc</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00018">DDEMLFree</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00017">DDEMLReAlloc</a>, <a class="el" href="../../d4/d7/handles_8c-source.html#l00137">DestroyHandle()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00759">DisconnectConv()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00048">EnterDDECrit</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d4/d7/handles_8c-source.html#l00165">GetHandleData()</a>, <a class="el" href="../../d6/d8/cltxt_8h-source.html#l00388">GetWindowLongPtr()</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00673">GWLP_PCI</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00186">tagCL_INSTANCE_INFO::hInstClient</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00106">HTYPE_CONVERSATION_LIST</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00218">tagCONV_INFO::hwndConv</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00188">tagCL_INSTANCE_INFO::hwndMother</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00095">InstFromHandle</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00024">LATOM</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00069">LATOM_FROM_HSZ</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00049">LeaveDDECrit</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00211">tagCONV_INFO::next</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d4/d7/handles_8c-source.html#l00185">SetHandleData()</a>, <a class="el" href="../../d1/d3/instance_8c-source.html#l00137">SetLastDDEMLError()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l01109">ShutdownConversation()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00219">tagCONV_INFO::state</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00491">ValidateConnectParameters()</a>, and <a class="el" href="../../d7/d4/connect_8c-source.html#l00102">ValidateConvList</a>.
<p>
<pre class="fragment"><div>00201 {
00202     <a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html">PCL_INSTANCE_INFO</a> pcii;
00203     <a class="code" href="../../d2/d1/structtagCONV__INFO.html">PCONV_INFO</a> pcoi, pcoiNew, pcoiExisting, pcoiNext;
00204     HCONVLIST hConvListRet = 0;
00205     HWND hwndTarget = 0;
00206     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a51">LATOM</a> aNormalSvcName = 0;
00207     <a class="code" href="../../d3/d1/structtagCONVLIST.html">PCONVLIST</a> pcl = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00208     HCONVLIST hConvListOld;
00209     <span class="keywordtype">int</span> i;
00210 
00211     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a9">CheckDDECritOut</a>;
00212 
00213     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a6">EnterDDECrit</a>;
00214 
00215     <span class="keywordflow">if</span> (!<a class="code" href="../../d0/d4/ddemlcli_8h.html#a110">ValidateConnectParameters</a>((HANDLE)LongToHandle( idInst ), &amp;pcii, &amp;hszService, hszTopic,
00216             &amp;aNormalSvcName, &amp;pCC, &amp;hwndTarget, hConvList)) {
00217         <span class="keywordflow">goto</span> Exit;
00218     }
00219 
00220     <a class="code" href="../../d6/d5/connect_8c.html#a0">ValidateConvList</a>(hConvList);
00221 
00222     hConvListOld = hConvList;
00223     pcoi = (<a class="code" href="../../d2/d1/structtagCONV__INFO.html">PCONV_INFO</a>)<a class="code" href="../../d0/d4/ddemlcli_8h.html#a111">ConnectConv</a>(pcii,
00224             <a class="code" href="../../d0/d4/ddemlcli_8h.html#a13">LATOM_FROM_HSZ</a>(hszService),
00225             <a class="code" href="../../d0/d4/ddemlcli_8h.html#a13">LATOM_FROM_HSZ</a>(hszTopic),
00226             hwndTarget,
00227             (pcii-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o7">afCmd</a> &amp; (CBF_FAIL_SELFCONNECTIONS | CBF_FAIL_CONNECTIONS)) ?
00228                 pcii-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o4">hwndMother</a> : 0,
00229             pCC,
00230             hConvListOld,
00231             CLST_MULT_INITIALIZING);
00232 
00233     <span class="keywordflow">if</span> (pcoi == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00234         <span class="comment">/*</span>
00235 <span class="comment">         * no new connections made</span>
00236 <span class="comment">         */</span>
00237         <a class="code" href="../../d0/d4/instance_8c.html#a8">SetLastDDEMLError</a>(pcii, DMLERR_NO_CONV_ESTABLISHED);
00238         hConvListRet = hConvListOld;
00239         <span class="keywordflow">goto</span> Exit;
00240     }
00241 
00242     <span class="comment">/*</span>
00243 <span class="comment">     * allocate or reallocate the hConvList hwnd list for later addition</span>
00244 <span class="comment">     * If we already have a valid list, reuse the handle so we don't have</span>
00245 <span class="comment">     * to alter the preexisting pcoi-&gt;hConvList values.</span>
00246 <span class="comment">     */</span>
00247     <span class="keywordflow">if</span> (hConvListOld == 0) {
00248         pcl = (<a class="code" href="../../d3/d1/structtagCONVLIST.html">PCONVLIST</a>)<a class="code" href="../../d0/d4/ddemlcli_8h.html#a0">DDEMLAlloc</a>(<span class="keyword">sizeof</span>(<a class="code" href="../../d3/d1/structtagCONVLIST.html">CONVLIST</a>));
00249         <span class="keywordflow">if</span> (pcl == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00250             <a class="code" href="../../d0/d4/instance_8c.html#a8">SetLastDDEMLError</a>(pcii, DMLERR_MEMORY_ERROR);
00251             <a class="code" href="../../d6/d5/connect_8c.html#a8">DisconnectConv</a>(pcoi);
00252             <span class="keywordflow">goto</span> Exit;
00253         }
00254         <span class="comment">// pcl-&gt;chwnd = 0; LPTR zero inits.</span>
00255 
00256         hConvList = (HCONVLIST)<a class="code" href="../../d3/d8/handles_8c.html#a6">CreateHandle</a>((ULONG_PTR)pcl,
00257                 HTYPE_CONVERSATION_LIST, <a class="code" href="../../d0/d4/ddemlcli_8h.html#a28">InstFromHandle</a>(pcii-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o2">hInstClient</a>));
00258         <span class="keywordflow">if</span> (hConvList == 0) {
00259             <a class="code" href="../../d0/d4/ddemlcli_8h.html#a2">DDEMLFree</a>(pcl);
00260             <a class="code" href="../../d0/d4/instance_8c.html#a8">SetLastDDEMLError</a>(pcii, DMLERR_MEMORY_ERROR);
00261             <a class="code" href="../../d6/d5/connect_8c.html#a8">DisconnectConv</a>(pcoi);
00262             <span class="keywordflow">goto</span> Exit;
00263         }
00264     } <span class="keywordflow">else</span> {
00265         pcl = (<a class="code" href="../../d3/d1/structtagCONVLIST.html">PCONVLIST</a>)<a class="code" href="../../d3/d8/handles_8c.html#a8">GetHandleData</a>((HANDLE)hConvList);
00266         pcl = <a class="code" href="../../d0/d4/ddemlcli_8h.html#a1">DDEMLReAlloc</a>(pcl, <span class="keyword">sizeof</span>(<a class="code" href="../../d3/d1/structtagCONVLIST.html">CONVLIST</a>) + <span class="keyword">sizeof</span>(HWND) * pcl-&gt;<a class="code" href="../../d3/d1/structtagCONVLIST.html#o0">chwnd</a>);
00267         <span class="keywordflow">if</span> (pcl == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00268             <a class="code" href="../../d0/d4/instance_8c.html#a8">SetLastDDEMLError</a>(pcii, DMLERR_MEMORY_ERROR);
00269             hConvListRet = hConvListOld;
00270             <a class="code" href="../../d6/d5/connect_8c.html#a8">DisconnectConv</a>(pcoi);
00271             <span class="keywordflow">goto</span> Exit;
00272         }
00273         <a class="code" href="../../d3/d8/handles_8c.html#a9">SetHandleData</a>((HANDLE)hConvList, (ULONG_PTR)pcl);
00274     }
00275 
00276     <a class="code" href="../../d6/d5/connect_8c.html#a0">ValidateConvList</a>(hConvListOld);
00277 
00278     <span class="keywordflow">if</span> (hConvListOld) {
00279         <span class="comment">/*</span>
00280 <span class="comment">         * remove duplicates from new conversations</span>
00281 <span class="comment">         *</span>
00282 <span class="comment">         * Although we tried to prevent duplicates from happening</span>
00283 <span class="comment">         * within the initiate enumeration code, wild initiates or</span>
00284 <span class="comment">         * servers responding with different service names than</span>
00285 <span class="comment">         * requested could cause duplicates.</span>
00286 <span class="comment">         */</span>
00287 
00288         <span class="comment">/* For each client window... */</span>
00289 
00290         <span class="keywordflow">for</span> (i = 0; i &lt; pcl-&gt;<a class="code" href="../../d3/d1/structtagCONVLIST.html#o0">chwnd</a>; i++) {
00291 
00292         <span class="comment">/* For each existing conversation in that window... */</span>
00293 
00294             <span class="keywordflow">for</span> (pcoiExisting = (<a class="code" href="../../d2/d1/structtagCONV__INFO.html">PCONV_INFO</a>)
00295                         <a class="code" href="../../d5/d9/cltxt_8h.html#a11">GetWindowLongPtr</a>(pcl-&gt;<a class="code" href="../../d3/d1/structtagCONVLIST.html#o1">ahwnd</a>[i], GWLP_PCI);
00296                     pcoi != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> &amp;&amp; pcoiExisting != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00297                     pcoiExisting = pcoiExisting-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o0">next</a>) {
00298 
00299                 <span class="keywordflow">if</span> (!(pcoiExisting-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o8">state</a> &amp; ST_CONNECTED))
00300                     <span class="keywordflow">continue</span>;
00301 
00302         <span class="comment">/* For each new conversation... */</span>
00303 
00304                 <span class="keywordflow">for</span> (pcoiNew = pcoi; pcoiNew != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>; pcoiNew = pcoiNext) {
00305 
00306                     pcoiNext = pcoiNew-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o0">next</a>;
00307 
00308         <span class="comment">/* see if the new conversation duplicates the existing one */</span>
00309 
00310                     <span class="keywordflow">if</span> (!(pcoiNew-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o8">state</a> &amp; ST_CONNECTED))
00311                         <span class="keywordflow">continue</span>;
00312 
00313                     UserAssert(((<a class="code" href="../../d1/d0/structtagCL__CONV__INFO.html">PCL_CONV_INFO</a>)pcoiExisting)-&gt;hwndReconnect);
00314                     UserAssert(((<a class="code" href="../../d1/d0/structtagCL__CONV__INFO.html">PCL_CONV_INFO</a>)pcoiNew)-&gt;hwndReconnect);
00315 
00316                     <span class="keywordflow">if</span> (((<a class="code" href="../../d1/d0/structtagCL__CONV__INFO.html">PCL_CONV_INFO</a>)pcoiExisting)-&gt;hwndReconnect ==
00317                                 ((<a class="code" href="../../d1/d0/structtagCL__CONV__INFO.html">PCL_CONV_INFO</a>)pcoiNew)-&gt;hwndReconnect &amp;&amp;
00318                             pcoiExisting-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o5">laTopic</a> == pcoiNew-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o5">laTopic</a> &amp;&amp;
00319                             pcoiExisting-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o4">laService</a> == pcoiNew-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o4">laService</a>) {
00320                         <span class="comment">/*</span>
00321 <span class="comment">                         * duplicate conversation - disconnection causes an unlink</span>
00322 <span class="comment">                         */</span>
00323                         <span class="keywordflow">if</span> (pcoiNew == pcoi) {
00324                             <span class="comment">/*</span>
00325 <span class="comment">                             * We are freeing up the head of the list,</span>
00326 <span class="comment">                             * Reset the head to the next guy.</span>
00327 <span class="comment">                             */</span>
00328                             pcoi = pcoiNext;
00329                         }
00330                         <a class="code" href="../../d6/d5/connect_8c.html#a0">ValidateConvList</a>(hConvList);
00331                         <a class="code" href="../../d0/d4/ddemlcli_8h.html#a113">ShutdownConversation</a>(pcoiNew, FALSE);
00332                         <a class="code" href="../../d6/d5/connect_8c.html#a0">ValidateConvList</a>(hConvList);
00333                         <span class="keywordflow">break</span>;
00334                     }
00335                 }
00336             }
00337         }
00338 
00339         <span class="keywordflow">for</span> (pcoiExisting = pcoi; pcoiExisting != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>; pcoiExisting = pcoiExisting-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o0">next</a>) {
00340             <span class="comment">/*</span>
00341 <span class="comment">             * if these are all zombies - we DONT want to link it in!</span>
00342 <span class="comment">             * This is possible because ShutdownConversation() leaves the critical section</span>
00343 <span class="comment">             * and could allow responding terminates to come through.</span>
00344 <span class="comment">             */</span>
00345             <span class="keywordflow">if</span> (pcoiExisting-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o8">state</a> &amp; ST_CONNECTED) {
00346                 <span class="keywordflow">goto</span> FoundOne;
00347             }
00348         }
00349         pcoi = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;    <span class="comment">// abandon this guy - he will clean up in time.</span>
00350 FoundOne:
00351         <span class="comment">/*</span>
00352 <span class="comment">         * add new pcoi (if any are left) hwnd to ConvList hwnd list.</span>
00353 <span class="comment">         */</span>
00354         <span class="keywordflow">if</span> (pcoi != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00355             UserAssert(pcoi-&gt;hwndConv);
00356             pcl-&gt;<a class="code" href="../../d3/d1/structtagCONVLIST.html#o1">ahwnd</a>[pcl-&gt;<a class="code" href="../../d3/d1/structtagCONVLIST.html#o0">chwnd</a>] = pcoi-&gt;hwndConv;
00357             pcl-&gt;<a class="code" href="../../d3/d1/structtagCONVLIST.html#o0">chwnd</a>++;
00358             hConvListRet = hConvList;
00359         } <span class="keywordflow">else</span> {
00360             hConvListRet = hConvListOld;
00361             <span class="keywordflow">if</span> (!hConvListOld) {
00362                 <a class="code" href="../../d3/d8/handles_8c.html#a7">DestroyHandle</a>((HANDLE)hConvList);
00363             }
00364         }
00365 
00366 
00367     } <span class="keywordflow">else</span> {    <span class="comment">// no hConvListOld</span>
00368 
00369         UserAssert(pcoi-&gt;hwndConv);
00370         pcl-&gt;<a class="code" href="../../d3/d1/structtagCONVLIST.html#o1">ahwnd</a>[0] = pcoi-&gt;hwndConv;
00371         pcl-&gt;<a class="code" href="../../d3/d1/structtagCONVLIST.html#o0">chwnd</a> = 1;
00372         hConvListRet = hConvList;
00373     }
00374 
00375     <span class="keywordflow">if</span> (pcoi != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00376         <span class="comment">/*</span>
00377 <span class="comment">         * set hConvList field for all remaining new conversations.</span>
00378 <span class="comment">         */</span>
00379         UserAssert(hConvListRet);
00380         <span class="keywordflow">for</span> (pcoiNew = pcoi; pcoiNew != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>; pcoiNew = pcoiNew-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o0">next</a>) {
00381             <span class="keywordflow">if</span> (pcoiNew-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o8">state</a> &amp; ST_CONNECTED) {
00382                 ((<a class="code" href="../../d1/d0/structtagCL__CONV__INFO.html">PCL_CONV_INFO</a>)pcoiNew)-&gt;hConvList = hConvListRet;
00383             }
00384         }
00385     }
00386 
00387 Exit:
00388     <span class="keywordflow">if</span> (aNormalSvcName) {
00389         DeleteAtom(aNormalSvcName);
00390     }
00391     <a class="code" href="../../d6/d5/connect_8c.html#a0">ValidateConvList</a>(hConvListRet);
00392     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a7">LeaveDDECrit</a>;
00393     <span class="keywordflow">return</span> (hConvListRet);
00394 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a16" doxytag="connect.c::DdeDisconnect" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL DdeDisconnect           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HCONV&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>hConv</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d4/connect_8c-source.html#l01008">1008</a> of file <a class="el" href="../../d7/d4/connect_8c-source.html">connect.c</a>.
<p>
References <a class="el" href="../../d4/d7/handles_8c-source.html#l00336">BestSetLastDDEMLError()</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00059">CheckDDECritOut</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00048">EnterDDECrit</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00112">HINST_ANY</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00105">HTYPE_CLIENT_CONVERSATION</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00104">HTYPE_SERVER_CONVERSATION</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00049">LeaveDDECrit</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d4/d7/handles_8c-source.html#l00226">PciiFromHandle()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l01109">ShutdownConversation()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00219">tagCONV_INFO::state</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, and <a class="el" href="../../d4/d7/handles_8c-source.html#l00204">ValidateCHandle()</a>.
<p>
Referenced by <a class="el" href="../../d0/d3/ddemlcli_8c-source.html#l00196">DdeUninitialize()</a>.
<p>
<pre class="fragment"><div>01010 {
01011     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> fRet = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01012     <a class="code" href="../../d2/d1/structtagCONV__INFO.html">PCONV_INFO</a> pcoi;
01013     <a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html">PCL_INSTANCE_INFO</a> pcii;
01014 
01015     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a9">CheckDDECritOut</a>;
01016     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a6">EnterDDECrit</a>;
01017 
01018     pcoi = (<a class="code" href="../../d2/d1/structtagCONV__INFO.html">PCONV_INFO</a>)<a class="code" href="../../d3/d8/handles_8c.html#a10">ValidateCHandle</a>((HANDLE)hConv,
01019             HTYPE_CLIENT_CONVERSATION, HINST_ANY);
01020     <span class="keywordflow">if</span> (pcoi == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01021         pcoi = (<a class="code" href="../../d2/d1/structtagCONV__INFO.html">PCONV_INFO</a>)<a class="code" href="../../d3/d8/handles_8c.html#a10">ValidateCHandle</a>((HANDLE)hConv,
01022                 HTYPE_SERVER_CONVERSATION, HINST_ANY);
01023     }
01024     <span class="keywordflow">if</span> (pcoi == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01025         <a class="code" href="../../d3/d8/handles_8c.html#a14">BestSetLastDDEMLError</a>(DMLERR_INVALIDPARAMETER);
01026         <span class="keywordflow">goto</span> Exit;
01027     }
01028     pcii = <a class="code" href="../../d3/d8/handles_8c.html#a11">PciiFromHandle</a>((HANDLE)hConv);
01029     <span class="keywordflow">if</span> (pcii == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01030         <a class="code" href="../../d3/d8/handles_8c.html#a14">BestSetLastDDEMLError</a>(DMLERR_INVALIDPARAMETER);
01031         <span class="keywordflow">goto</span> Exit;
01032     }
01033     <span class="keywordflow">if</span> (pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o8">state</a> &amp; ST_CONNECTED) {
01034         <a class="code" href="../../d0/d4/ddemlcli_8h.html#a113">ShutdownConversation</a>(pcoi, FALSE);
01035     }
01036     fRet = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01037 
01038 Exit:
01039     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a7">LeaveDDECrit</a>;
01040     <span class="keywordflow">return</span> (fRet);
01041 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a17" doxytag="connect.c::DdeDisconnectList" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL DdeDisconnectList           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HCONVLIST&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>hConvList</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d4/connect_8c-source.html#l01053">1053</a> of file <a class="el" href="../../d7/d4/connect_8c-source.html">connect.c</a>.
<p>
References <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00242">tagCONVLIST::ahwnd</a>, <a class="el" href="../../d4/d7/handles_8c-source.html#l00336">BestSetLastDDEMLError()</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00059">CheckDDECritOut</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00241">tagCONVLIST::chwnd</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00018">DDEMLFree</a>, <a class="el" href="../../d4/d7/handles_8c-source.html#l00137">DestroyHandle()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00048">EnterDDECrit</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d6/d8/cltxt_8h-source.html#l00388">GetWindowLongPtr()</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00673">GWLP_PCI</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00112">HINST_ANY</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00106">HTYPE_CONVERSATION_LIST</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00049">LeaveDDECrit</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00211">tagCONV_INFO::next</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d4/d7/handles_8c-source.html#l00226">PciiFromHandle()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l01109">ShutdownConversation()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00219">tagCONV_INFO::state</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d4/d7/handles_8c-source.html#l00204">ValidateCHandle()</a>, and <a class="el" href="../../d7/d4/connect_8c-source.html#l00102">ValidateConvList</a>.
<p>
Referenced by <a class="el" href="../../d0/d3/ddemlcli_8c-source.html#l00196">DdeUninitialize()</a>.
<p>
<pre class="fragment"><div>01055 {
01056     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> fRet = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01057     <a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html">PCL_INSTANCE_INFO</a> pcii;
01058     <a class="code" href="../../d3/d1/structtagCONVLIST.html">PCONVLIST</a> pcl;
01059     <a class="code" href="../../d2/d1/structtagCONV__INFO.html">PCONV_INFO</a> pcoi, pcoiNext;
01060     <span class="keywordtype">int</span> i;
01061 
01062     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a9">CheckDDECritOut</a>;
01063     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a6">EnterDDECrit</a>;
01064 
01065     pcl = (<a class="code" href="../../d3/d1/structtagCONVLIST.html">PCONVLIST</a>)<a class="code" href="../../d3/d8/handles_8c.html#a10">ValidateCHandle</a>((HANDLE)hConvList,
01066             HTYPE_CONVERSATION_LIST, HINST_ANY);
01067     <span class="keywordflow">if</span> (pcl == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01068         <a class="code" href="../../d3/d8/handles_8c.html#a14">BestSetLastDDEMLError</a>(DMLERR_INVALIDPARAMETER);
01069         <span class="keywordflow">goto</span> Exit;
01070     }
01071     <a class="code" href="../../d6/d5/connect_8c.html#a0">ValidateConvList</a>(hConvList);
01072     pcii = <a class="code" href="../../d3/d8/handles_8c.html#a11">PciiFromHandle</a>((HANDLE)hConvList);
01073     <span class="keywordflow">if</span> (pcii == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01074         <a class="code" href="../../d3/d8/handles_8c.html#a14">BestSetLastDDEMLError</a>(DMLERR_INVALIDPARAMETER);
01075         <span class="keywordflow">goto</span> Exit;
01076     }
01077 
01078     <span class="keywordflow">for</span>(i = pcl-&gt;<a class="code" href="../../d3/d1/structtagCONVLIST.html#o0">chwnd</a> - 1; i &gt;= 0; i--) {
01079         pcoi = (<a class="code" href="../../d2/d1/structtagCONV__INFO.html">PCONV_INFO</a>)<a class="code" href="../../d5/d9/cltxt_8h.html#a11">GetWindowLongPtr</a>(pcl-&gt;<a class="code" href="../../d3/d1/structtagCONVLIST.html#o1">ahwnd</a>[i], GWLP_PCI);
01080         <span class="keywordflow">while</span> (pcoi != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> &amp;&amp; pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o8">state</a> &amp; ST_CONNECTED) {
01081             pcoiNext = pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o0">next</a>;
01082             <a class="code" href="../../d0/d4/ddemlcli_8h.html#a113">ShutdownConversation</a>(pcoi, FALSE);  <span class="comment">// may unlink pcoi!</span>
01083             pcoi = pcoiNext;
01084         }
01085     }
01086 
01087     <a class="code" href="../../d3/d8/handles_8c.html#a7">DestroyHandle</a>((HANDLE)hConvList);
01088     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a2">DDEMLFree</a>(pcl);
01089     fRet = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01090 
01091 Exit:
01092     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a7">LeaveDDECrit</a>;
01093     <span class="keywordflow">return</span> (fRet);
01094 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a15" doxytag="connect.c::DdeQueryNextServer" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HCONV DdeQueryNextServer           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HCONVLIST&nbsp;</td>
          <td class="mdname" nowrap> <em>hConvList</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HCONV&nbsp;</td>
          <td class="mdname" nowrap> <em>hConvPrev</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d4/connect_8c-source.html#l00906">906</a> of file <a class="el" href="../../d7/d4/connect_8c-source.html">connect.c</a>.
<p>
References <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00242">tagCONVLIST::ahwnd</a>, <a class="el" href="../../d4/d7/handles_8c-source.html#l00336">BestSetLastDDEMLError()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00241">tagCONVLIST::chwnd</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00231">tagCL_CONV_INFO::ci</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00048">EnterDDECrit</a>, <a class="el" href="../../d6/d8/cltxt_8h-source.html#l00388">GetWindowLongPtr()</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00673">GWLP_PCI</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00214">tagCONV_INFO::hConv</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00233">tagCL_CONV_INFO::hConvList</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00112">HINST_ANY</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00105">HTYPE_CLIENT_CONVERSATION</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00106">HTYPE_CONVERSATION_LIST</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00109">HTYPE_ZOMBIE_CONVERSATION</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00218">tagCONV_INFO::hwndConv</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00095">InstFromHandle</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00193">tagCL_INSTANCE_INFO::LastError</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00049">LeaveDDECrit</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00211">tagCONV_INFO::next</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d4/d7/handles_8c-source.html#l00226">PciiFromHandle()</a>, <a class="el" href="../../d1/d3/instance_8c-source.html#l00137">SetLastDDEMLError()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00094">TypeFromHandle</a>, and <a class="el" href="../../d4/d7/handles_8c-source.html#l00204">ValidateCHandle()</a>.
<p>
<pre class="fragment"><div>00909 {
00910     HCONV hConvRet = 0;
00911     <a class="code" href="../../d3/d1/structtagCONVLIST.html">PCONVLIST</a> pcl;
00912     HWND *phwnd;
00913     <span class="keywordtype">int</span> i;
00914     <a class="code" href="../../d1/d0/structtagCL__CONV__INFO.html">PCL_CONV_INFO</a> pci;
00915     <a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html">PCL_INSTANCE_INFO</a> pcii;
00916 
00917     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a6">EnterDDECrit</a>;
00918 
00919     pcl = (<a class="code" href="../../d3/d1/structtagCONVLIST.html">PCONVLIST</a>)<a class="code" href="../../d3/d8/handles_8c.html#a10">ValidateCHandle</a>((HANDLE)hConvList,
00920             HTYPE_CONVERSATION_LIST, HINST_ANY);
00921     <span class="keywordflow">if</span> (pcl == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00922         <a class="code" href="../../d3/d8/handles_8c.html#a14">BestSetLastDDEMLError</a>(DMLERR_INVALIDPARAMETER);
00923         <span class="keywordflow">goto</span> Exit;
00924     }
00925     <span class="keywordflow">if</span> (!pcl-&gt;<a class="code" href="../../d3/d1/structtagCONVLIST.html#o0">chwnd</a>) {      <span class="comment">// empty list</span>
00926         <span class="keywordflow">goto</span> Exit;
00927     }
00928     pcii = <a class="code" href="../../d3/d8/handles_8c.html#a11">PciiFromHandle</a>((HANDLE)hConvList);
00929     <span class="keywordflow">if</span> (pcii == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00930         <a class="code" href="../../d3/d8/handles_8c.html#a14">BestSetLastDDEMLError</a>(DMLERR_INVALIDPARAMETER);
00931         <span class="keywordflow">goto</span> Exit;
00932     }
00933 
00934     pcii-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o9">LastError</a> = DMLERR_NO_ERROR;
00935 
00936     <span class="keywordflow">do</span> {
00937 
00938         hConvRet = 0;
00939 
00940         <span class="keywordflow">if</span> (hConvPrev == 0) {
00941             pci = (<a class="code" href="../../d1/d0/structtagCL__CONV__INFO.html">PCL_CONV_INFO</a>)<a class="code" href="../../d5/d9/cltxt_8h.html#a11">GetWindowLongPtr</a>(pcl-&gt;<a class="code" href="../../d3/d1/structtagCONVLIST.html#o1">ahwnd</a>[0], GWLP_PCI);
00942             <span class="keywordflow">if</span> (pci == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00943                 <span class="keywordflow">goto</span> Exit;  <span class="comment">// Must have all conversations zombied.</span>
00944             }
00945             hConvPrev = hConvRet = pci-&gt;<a class="code" href="../../d1/d0/structtagCL__CONV__INFO.html#o0">ci</a>.<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o3">hConv</a>;
00946             <span class="keywordflow">continue</span>;
00947         }
00948 
00949         pci = (<a class="code" href="../../d1/d0/structtagCL__CONV__INFO.html">PCL_CONV_INFO</a>)<a class="code" href="../../d3/d8/handles_8c.html#a10">ValidateCHandle</a>((HANDLE)hConvPrev,
00950                 HTYPE_CLIENT_CONVERSATION, <a class="code" href="../../d0/d4/ddemlcli_8h.html#a28">InstFromHandle</a>(hConvList));
00951         <span class="keywordflow">if</span> (pci == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00952             pci = (<a class="code" href="../../d1/d0/structtagCL__CONV__INFO.html">PCL_CONV_INFO</a>)<a class="code" href="../../d3/d8/handles_8c.html#a10">ValidateCHandle</a>((HANDLE)hConvPrev,
00953                     HTYPE_ZOMBIE_CONVERSATION, <a class="code" href="../../d0/d4/ddemlcli_8h.html#a28">InstFromHandle</a>(hConvList));
00954             <span class="keywordflow">if</span> (pci == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00955                 <a class="code" href="../../d0/d4/instance_8c.html#a8">SetLastDDEMLError</a>(pcii, DMLERR_INVALIDPARAMETER);
00956                 <span class="keywordflow">break</span>;
00957             } <span class="keywordflow">else</span> {
00958                 <span class="keywordflow">goto</span> ZombieSkip;
00959             }
00960         }
00961 
00962         <span class="keywordflow">if</span> (pci-&gt;<a class="code" href="../../d1/d0/structtagCL__CONV__INFO.html#o2">hConvList</a> != hConvList) {
00963             <a class="code" href="../../d0/d4/instance_8c.html#a8">SetLastDDEMLError</a>(pcii, DMLERR_INVALIDPARAMETER);
00964             <span class="keywordflow">break</span>;
00965         }
00966 
00967 ZombieSkip:
00968 
00969         <span class="keywordflow">if</span> (pci-&gt;<a class="code" href="../../d1/d0/structtagCL__CONV__INFO.html#o0">ci</a>.<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o0">next</a> == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00970 
00971             <span class="comment">/*</span>
00972 <span class="comment">             * end of list for this window, go to next window</span>
00973 <span class="comment">             */</span>
00974             <span class="keywordflow">for</span> (phwnd = pcl-&gt;<a class="code" href="../../d3/d1/structtagCONVLIST.html#o1">ahwnd</a>, i = 0; (i + 1) &lt; pcl-&gt;<a class="code" href="../../d3/d1/structtagCONVLIST.html#o0">chwnd</a>; i++) {
00975                 <span class="keywordflow">if</span> (phwnd[i] == pci-&gt;<a class="code" href="../../d1/d0/structtagCL__CONV__INFO.html#o0">ci</a>.<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o7">hwndConv</a>) {
00976                     pci = (<a class="code" href="../../d1/d0/structtagCL__CONV__INFO.html">PCL_CONV_INFO</a>)<a class="code" href="../../d5/d9/cltxt_8h.html#a11">GetWindowLongPtr</a>(phwnd[i + 1], GWLP_PCI);
00977                     <span class="keywordflow">if</span> (pci == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00978                         <span class="keywordflow">break</span>;
00979                     }
00980                     hConvPrev = hConvRet = pci-&gt;<a class="code" href="../../d1/d0/structtagCL__CONV__INFO.html#o0">ci</a>.<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o3">hConv</a>;
00981                     <span class="keywordflow">break</span>;
00982                 }
00983             }
00984         } <span class="keywordflow">else</span> {
00985 
00986             hConvPrev = hConvRet = pci-&gt;<a class="code" href="../../d1/d0/structtagCL__CONV__INFO.html#o0">ci</a>.<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o0">next</a>-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o3">hConv</a>; <span class="comment">// next conv for this window.</span>
00987         }
00988 
00989     } <span class="keywordflow">while</span> (hConvRet &amp;&amp; <a class="code" href="../../d0/d4/ddemlcli_8h.html#a27">TypeFromHandle</a>(hConvRet) == <a class="code" href="../../d0/d4/ddemlcli_8h.html#a40">HTYPE_ZOMBIE_CONVERSATION</a>);
00990 Exit:
00991     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a7">LeaveDDECrit</a>;
00992     <span class="keywordflow">return</span> (hConvRet);
00993 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a11" doxytag="connect.c::DdeReconnect" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HCONV DdeReconnect           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HCONV&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>hConv</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d4/connect_8c-source.html#l00409">409</a> of file <a class="el" href="../../d7/d4/connect_8c-source.html">connect.c</a>.
<p>
References <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00225">tagCONV_INFO::aLinks</a>, <a class="el" href="../../d4/d7/handles_8c-source.html#l00336">BestSetLastDDEMLError()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00231">tagCL_CONV_INFO::ci</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00226">tagCONV_INFO::cLinks</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00680">CLST_SINGLE_INITIALIZING</a>, <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l00067">ClStartAdvise()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00607">ConnectConv()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00016">DDEMLAlloc</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00018">DDEMLFree</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00048">EnterDDECrit</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00130">tagXACT_INFO::flags</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00126">tagXACT_INFO::gaItem</a>, <a class="el" href="../../d1/d0/xact_8c-source.html#l00368">GetConvContext()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00214">tagCONV_INFO::hConv</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00112">HINST_ANY</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00105">HTYPE_CLIENT_CONVERSATION</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00218">tagCONV_INFO::hwndConv</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00232">tagCL_CONV_INFO::hwndReconnect</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00147">tagADVISE_LINK::laItem</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00215">tagCONV_INFO::laService</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00216">tagCONV_INFO::laTopic</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00049">LeaveDDECrit</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00438">LocalToGlobalAtom()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d0/d4/ddemlcli_8h.html#a62">PADVISE_LINK</a>, <a class="el" href="../../d4/d7/handles_8c-source.html#l00226">PciiFromHandle()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00122">tagXACT_INFO::pcoi</a>, <a class="el" href="../../d1/d3/instance_8c-source.html#l00137">SetLastDDEMLError()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00219">tagCONV_INFO::state</a>, <a class="el" href="../../d4/d7/handles_8c-source.html#l00204">ValidateCHandle()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00148">tagADVISE_LINK::wFmt</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00127">tagXACT_INFO::wFmt</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00149">tagADVISE_LINK::wType</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00128">tagXACT_INFO::wType</a>, <a class="el" href="../../d0/d4/ddemlcli_8h.html#a59">XACT_INFO</a>, and <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00138">XIF_ABANDONED</a>.
<p>
<pre class="fragment"><div>00411 {
00412     <a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html">PCL_INSTANCE_INFO</a> pcii;
00413     <a class="code" href="../../d1/d0/structtagCL__CONV__INFO.html">PCL_CONV_INFO</a> pci, pciNew;
00414     HCONV hConvRet = 0;
00415     CONVCONTEXT cc;
00416 
00417     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a6">EnterDDECrit</a>;
00418 
00419     pcii = <a class="code" href="../../d3/d8/handles_8c.html#a11">PciiFromHandle</a>((HANDLE)hConv);
00420     <span class="keywordflow">if</span> (pcii == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00421         <a class="code" href="../../d3/d8/handles_8c.html#a14">BestSetLastDDEMLError</a>(DMLERR_INVALIDPARAMETER);
00422         <span class="keywordflow">goto</span> Exit;
00423     }
00424     pci = (<a class="code" href="../../d1/d0/structtagCL__CONV__INFO.html">PCL_CONV_INFO</a>)<a class="code" href="../../d3/d8/handles_8c.html#a10">ValidateCHandle</a>((HANDLE)hConv,
00425             HTYPE_CLIENT_CONVERSATION, HINST_ANY);
00426     <span class="keywordflow">if</span> (pci == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00427         <a class="code" href="../../d0/d4/instance_8c.html#a8">SetLastDDEMLError</a>(pcii, DMLERR_INVALIDPARAMETER);
00428         <span class="keywordflow">goto</span> Exit;
00429     }
00430 
00431     <span class="keywordflow">if</span> (pci-&gt;<a class="code" href="../../d1/d0/structtagCL__CONV__INFO.html#o0">ci</a>.<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o8">state</a> &amp; ST_CONNECTED) {
00432         <span class="keywordflow">goto</span> Exit;
00433     }
00434 
00435     <a class="code" href="../../d0/d1/xact_8c.html#a1">GetConvContext</a>(pci-&gt;<a class="code" href="../../d1/d0/structtagCL__CONV__INFO.html#o0">ci</a>.<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o7">hwndConv</a>, (LONG *)&amp;cc);
00436     pciNew = <a class="code" href="../../d0/d4/ddemlcli_8h.html#a111">ConnectConv</a>(pcii, pci-&gt;<a class="code" href="../../d1/d0/structtagCL__CONV__INFO.html#o0">ci</a>.<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o4">laService</a>, pci-&gt;<a class="code" href="../../d1/d0/structtagCL__CONV__INFO.html#o0">ci</a>.<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o5">laTopic</a>,
00437             pci-&gt;<a class="code" href="../../d1/d0/structtagCL__CONV__INFO.html#o1">hwndReconnect</a>, 0, &amp;cc, 0, CLST_SINGLE_INITIALIZING);
00438     <span class="keywordflow">if</span> (pciNew == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00439         <a class="code" href="../../d0/d4/instance_8c.html#a8">SetLastDDEMLError</a>(pcii, DMLERR_NO_CONV_ESTABLISHED);
00440         <span class="keywordflow">goto</span> Exit;
00441     } <span class="keywordflow">else</span> {
00442         hConvRet = pciNew-&gt;<a class="code" href="../../d1/d0/structtagCL__CONV__INFO.html#o0">ci</a>.<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o3">hConv</a>;
00443         <span class="keywordflow">if</span> (pci-&gt;<a class="code" href="../../d1/d0/structtagCL__CONV__INFO.html#o0">ci</a>.<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o15">cLinks</a>) {
00444             <a class="code" href="../../d0/d0/structtagXACT__INFO.html">PXACT_INFO</a> pxi;
00445             <span class="keywordtype">int</span> iLink;
00446             <a class="code" href="../../d2/d8/structtagADVISE__LINK.html">PADVISE_LINK</a> paLink;
00447 
00448             <span class="comment">/*</span>
00449 <span class="comment">             * reestablish advise links</span>
00450 <span class="comment">             */</span>
00451 
00452             <span class="keywordflow">for</span> (paLink = pci-&gt;<a class="code" href="../../d1/d0/structtagCL__CONV__INFO.html#o0">ci</a>.<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o14">aLinks</a>, iLink = pci-&gt;<a class="code" href="../../d1/d0/structtagCL__CONV__INFO.html#o0">ci</a>.<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o15">cLinks</a>;
00453                     iLink; paLink++, iLink--) {
00454 
00455                 pxi = (<a class="code" href="../../d0/d0/structtagXACT__INFO.html">PXACT_INFO</a>)<a class="code" href="../../d0/d4/ddemlcli_8h.html#a0">DDEMLAlloc</a>(<span class="keyword">sizeof</span>(<a class="code" href="../../d0/d0/structtagXACT__INFO.html">XACT_INFO</a>));
00456                 <span class="keywordflow">if</span> (pxi == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00457                     <span class="keywordflow">break</span>;              <span class="comment">// abort relinking</span>
00458                 }
00459                 pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o1">pcoi</a> = (<a class="code" href="../../d2/d1/structtagCONV__INFO.html">PCONV_INFO</a>)pciNew;
00460                 pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o5">gaItem</a> = <a class="code" href="../../d4/d2/hsz_8c.html#a12">LocalToGlobalAtom</a>(paLink-&gt;<a class="code" href="../../d2/d8/structtagADVISE__LINK.html#o1">laItem</a>); <span class="comment">// pxi copy</span>
00461                 pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o6">wFmt</a> = paLink-&gt;<a class="code" href="../../d2/d8/structtagADVISE__LINK.html#o2">wFmt</a>;
00462                 pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o7">wType</a> = (WORD)((paLink-&gt;<a class="code" href="../../d2/d8/structtagADVISE__LINK.html#o3">wType</a> &gt;&gt; 12) | XTYP_ADVSTART);
00463                 <span class="keywordflow">if</span> (<a class="code" href="../../d2/d6/stdptcl_8c.html#a0">ClStartAdvise</a>(pxi)) {
00464                     pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o9">flags</a> |= <a class="code" href="../../d0/d4/ddemlcli_8h.html#a45">XIF_ABANDONED</a>;
00465                 } <span class="keywordflow">else</span> {
00466                     GlobalDeleteAtom(pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o5">gaItem</a>);
00467                     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a2">DDEMLFree</a>(pxi);
00468                 }
00469             }
00470         }
00471     }
00472 
00473 Exit:
00474     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a7">LeaveDDECrit</a>;
00475     <span class="keywordflow">return</span> (hConvRet);
00476 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a8" doxytag="connect.c::DisconnectConv" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID DisconnectConv           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d2/d1/structtagCONV__INFO.html">PCONV_INFO</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>pcoi</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d4/connect_8c-source.html#l00759">759</a> of file <a class="el" href="../../d7/d4/connect_8c-source.html">connect.c</a>.
<p>
References <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00211">tagCONV_INFO::next</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l01109">ShutdownConversation()</a>, and <a class="el" href="../../d2/d7/hal_8h.html#a212">VOID()</a>.
<p>
Referenced by <a class="el" href="../../d7/d4/connect_8c-source.html#l00195">DdeConnectList()</a>.
<p>
<pre class="fragment"><div>00761 {
00762     <a class="code" href="../../d2/d1/structtagCONV__INFO.html">PCONV_INFO</a> pcoiNext;
00763 
00764     <span class="keywordflow">for</span> (; pcoi; pcoi = pcoiNext) {
00765         pcoiNext = pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o0">next</a>;
00766         <a class="code" href="../../d0/d4/ddemlcli_8h.html#a113">ShutdownConversation</a>(pcoi, FALSE);
00767     }
00768 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a20" doxytag="connect.c::FreeConversationResources" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID FreeConversationResources           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d2/d1/structtagCONV__INFO.html">PCONV_INFO</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>pcoi</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d4/connect_8c-source.html#l01354">1354</a> of file <a class="el" href="../../d7/d4/connect_8c-source.html">connect.c</a>.
<p>
References <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00225">tagCONV_INFO::aLinks</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00058">CheckDDECritIn</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00226">tagCONV_INFO::cLinks</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00227">tagCONV_INFO::cLocks</a>, <a class="el" href="../../d4/d7/handles_8c-source.html#l00075">CreateHandle()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00018">DDEMLFree</a>, <a class="el" href="../../d3/d1/util_8c-source.html#l00123">DeleteLinkCount()</a>, <a class="el" href="../../d4/d7/handles_8c-source.html#l00137">DestroyHandle()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00223">tagCONV_INFO::dmqIn</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00224">tagCONV_INFO::dmqOut</a>, <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00714">DumpDDEMessage()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00130">tagXACT_INFO::flags</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00214">tagCONV_INFO::hConv</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00109">HTYPE_ZOMBIE_CONVERSATION</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00218">tagCONV_INFO::hwndConv</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00217">tagCONV_INFO::hwndPartner</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00095">InstFromHandle</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00147">tagADVISE_LINK::laItem</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00215">tagCONV_INFO::laService</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00220">tagCONV_INFO::laServiceRequested</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00216">tagCONV_INFO::laTopic</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00438">LocalToGlobalAtom()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00162">tagDDE_MESSAGE_QUEUE::lParam</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00031">MONLINK</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00161">tagDDE_MESSAGE_QUEUE::msg</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00121">tagXACT_INFO::next</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00159">tagDDE_MESSAGE_QUEUE::next</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00212">tagCONV_INFO::pcii</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00125">tagXACT_INFO::pfnResponse</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00146">tagADVISE_LINK::pLinkCount</a>, <a class="el" href="../../d1/d7/ntcftxt_8h-source.html#l00427">PostMessage()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00222">tagCONV_INFO::pxiOut</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00219">tagCONV_INFO::state</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00140">TID_TIMEOUT</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l01153">UnlinkConvFromOthers()</a>, <a class="el" href="../../d2/d7/hal_8h.html#a212">VOID()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00148">tagADVISE_LINK::wFmt</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00149">tagADVISE_LINK::wType</a>, and <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00136">XIF_SYNCHRONOUS</a>.
<p>
Referenced by <a class="el" href="../../d1/d0/xact_8c-source.html#l00024">DdeClientTransaction()</a>, <a class="el" href="../../d9/d3/w32_2ntuser_2client_2callback_8c-source.html#l00335">DdeEnableCallback()</a>, <a class="el" href="../../d1/d0/xact_8c-source.html#l00665">DdePostAdvise()</a>, <a class="el" href="../../d9/d3/w32_2ntuser_2client_2callback_8c-source.html#l00295">EnableEnumProc()</a>, <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00572">ProcessAsyncDDEMsg()</a>, <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00782">ProcessSyncDDEMessage()</a>, and <a class="el" href="../../d7/d4/connect_8c-source.html#l01109">ShutdownConversation()</a>.
<p>
<pre class="fragment"><div>01356 {
01357     <a class="code" href="../../d2/d8/structtagADVISE__LINK.html">PADVISE_LINK</a> paLink;
01358     <a class="code" href="../../d5/d2/structtagDDE__MESSAGE__QUEUE.html">PDDE_MESSAGE_QUEUE</a> pdmq;
01359     <a class="code" href="../../d0/d0/structtagXACT__INFO.html">PXACT_INFO</a> pxi;
01360 
01361     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a8">CheckDDECritIn</a>;
01362 
01363     <span class="comment">/*</span>
01364 <span class="comment">     * Don't free resources on locked conversations.</span>
01365 <span class="comment">     */</span>
01366     <span class="keywordflow">if</span> (pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o16">cLocks</a> &gt; 0) {
01367         pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o8">state</a> |= ST_FREE_CONV_RES_NOW;
01368         <span class="keywordflow">return</span>;
01369     }
01370 
01371     <span class="comment">/*</span>
01372 <span class="comment">     * Don't free resources if a synchronous transaction is in effect!</span>
01373 <span class="comment">     */</span>
01374     pxi = pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o11">pxiOut</a>;
01375     <span class="keywordflow">while</span> (pxi != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01376         <span class="keywordflow">if</span> (pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o9">flags</a> &amp; <a class="code" href="../../d0/d4/ddemlcli_8h.html#a43">XIF_SYNCHRONOUS</a>) {
01377             <span class="comment">/*</span>
01378 <span class="comment">             * This conversation is in a synchronous transaction.</span>
01379 <span class="comment">             * Shutdown the modal loop FIRST, then call this when</span>
01380 <span class="comment">             * the loop exits.</span>
01381 <span class="comment">             */</span>
01382             <a class="code" href="../../d0/d8/ntcftxt_8h.html#a20">PostMessage</a>(pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o7">hwndConv</a>, WM_TIMER, TID_TIMEOUT, 0);
01383             pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o8">state</a> |= ST_FREE_CONV_RES_NOW;
01384             <span class="keywordflow">return</span>;
01385         }
01386         pxi = pxi-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o0">next</a>;
01387     }
01388 
01389     <span class="comment">/*</span>
01390 <span class="comment">     * If this is an Intra-Process conversation that hasn't yet received</span>
01391 <span class="comment">     * a terminate message, make it a zombie.  We will call this routine</span>
01392 <span class="comment">     * again once the terminate arrives or when WaitForZombieTerminate() has</span>
01393 <span class="comment">     * timed out waiting.</span>
01394 <span class="comment">     */</span>
01395     <span class="keywordflow">if</span> (pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o8">state</a> &amp; ST_INTRA_PROCESS &amp;&amp; !(pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o8">state</a> &amp; ST_TERMINATE_RECEIVED)) {
01396         <a class="code" href="../../d3/d8/handles_8c.html#a7">DestroyHandle</a>((HANDLE)pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o3">hConv</a>);
01397         pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o3">hConv</a> = (HCONV)<a class="code" href="../../d3/d8/handles_8c.html#a6">CreateHandle</a>((ULONG_PTR)pcoi, HTYPE_ZOMBIE_CONVERSATION,
01398                 <a class="code" href="../../d0/d4/ddemlcli_8h.html#a28">InstFromHandle</a>(pcoi-&gt;hConv));
01399         <a class="code" href="../../d6/d5/connect_8c.html#a19">UnlinkConvFromOthers</a>(pcoi, TRUE);
01400         <span class="keywordflow">return</span>;
01401     }
01402 
01403     <span class="comment">/*</span>
01404 <span class="comment">     * remove any transactions left in progress</span>
01405 <span class="comment">     */</span>
01406     <span class="keywordflow">while</span> (pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o11">pxiOut</a> != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01407         (pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o11">pxiOut</a>-&gt;<a class="code" href="../../d0/d0/structtagXACT__INFO.html#o4">pfnResponse</a>)(pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o11">pxiOut</a>, 0, 0);
01408     }
01409 
01410     <span class="comment">/*</span>
01411 <span class="comment">     * Throw away any incoming queued DDE messages.</span>
01412 <span class="comment">     */</span>
01413     <span class="keywordflow">while</span> (pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o13">dmqOut</a> != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01414 
01415         pdmq = pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o13">dmqOut</a>;
01416         <a class="code" href="../../d3/d4/ddemlwp_8c.html#a7">DumpDDEMessage</a>(!(pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o8">state</a> &amp; ST_INTRA_PROCESS), pdmq-&gt;<a class="code" href="../../d5/d2/structtagDDE__MESSAGE__QUEUE.html#o2">msg</a>, pdmq-&gt;<a class="code" href="../../d5/d2/structtagDDE__MESSAGE__QUEUE.html#o3">lParam</a>);
01417         pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o13">dmqOut</a> = pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o13">dmqOut</a>-&gt;<a class="code" href="../../d5/d2/structtagDDE__MESSAGE__QUEUE.html#o0">next</a>;
01418         <span class="keywordflow">if</span> (pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o13">dmqOut</a> == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01419             pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o12">dmqIn</a> = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01420         }
01421         <a class="code" href="../../d0/d4/ddemlcli_8h.html#a2">DDEMLFree</a>(pdmq);
01422     }
01423 
01424     <span class="comment">//</span>
01425     <span class="comment">// Remove all link info</span>
01426     <span class="comment">//</span>
01427     paLink = pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o14">aLinks</a>;
01428     <span class="keywordflow">while</span> (pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o15">cLinks</a>) {
01429         <span class="keywordflow">if</span> (pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o8">state</a> &amp; ST_CLIENT) {
01430             <a class="code" href="../../d0/d4/ddemlcli_8h.html#a4">MONLINK</a>(pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o1">pcii</a>, FALSE, paLink-&gt;<a class="code" href="../../d2/d8/structtagADVISE__LINK.html#o3">wType</a> &amp; XTYPF_NODATA,
01431                     pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o4">laService</a>, pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o5">laTopic</a>,
01432                     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a106">LocalToGlobalAtom</a>(paLink-&gt;<a class="code" href="../../d2/d8/structtagADVISE__LINK.html#o1">laItem</a>),
01433                     paLink-&gt;<a class="code" href="../../d2/d8/structtagADVISE__LINK.html#o2">wFmt</a>, FALSE,
01434                     (HCONV)pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o6">hwndPartner</a>, (HCONV)pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o7">hwndConv</a>);
01435         } <span class="keywordflow">else</span> {
01436             <a class="code" href="../../d0/d4/ddemlcli_8h.html#a4">MONLINK</a>(pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o1">pcii</a>, FALSE, paLink-&gt;<a class="code" href="../../d2/d8/structtagADVISE__LINK.html#o3">wType</a> &amp; XTYPF_NODATA,
01437                     pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o4">laService</a>, pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o5">laTopic</a>,
01438                     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a106">LocalToGlobalAtom</a>(paLink-&gt;<a class="code" href="../../d2/d8/structtagADVISE__LINK.html#o1">laItem</a>),
01439                     paLink-&gt;<a class="code" href="../../d2/d8/structtagADVISE__LINK.html#o2">wFmt</a>, TRUE,
01440                     (HCONV)pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o7">hwndConv</a>, (HCONV)pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o6">hwndPartner</a>);
01441         }
01442         <span class="keywordflow">if</span> (!(pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o8">state</a> &amp; ST_CLIENT)) {
01443             <a class="code" href="../../d2/d2/util_8c.html#a1">DeleteLinkCount</a>(pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o1">pcii</a>, paLink-&gt;<a class="code" href="../../d2/d8/structtagADVISE__LINK.html#o0">pLinkCount</a>);
01444         }
01445         DeleteAtom(paLink-&gt;<a class="code" href="../../d2/d8/structtagADVISE__LINK.html#o1">laItem</a>); <span class="comment">// link structure copy</span>
01446         paLink++;
01447         pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o15">cLinks</a>--;
01448     }
01449     <span class="keywordflow">if</span> (pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o14">aLinks</a>) {
01450         <a class="code" href="../../d0/d4/ddemlcli_8h.html#a2">DDEMLFree</a>(pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o14">aLinks</a>);
01451     }
01452 
01453     <span class="comment">//</span>
01454     <span class="comment">// free atoms associated with this conv</span>
01455     <span class="comment">//</span>
01456     DeleteAtom(pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o4">laService</a>);
01457     DeleteAtom(pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o5">laTopic</a>);
01458     <span class="keywordflow">if</span> (pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o9">laServiceRequested</a>) {
01459         DeleteAtom(pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o9">laServiceRequested</a>);
01460     }
01461 
01462     <a class="code" href="../../d6/d5/connect_8c.html#a19">UnlinkConvFromOthers</a>(pcoi, FALSE);
01463 
01464     <span class="comment">/*</span>
01465 <span class="comment">     * invalidate app's conversation handle</span>
01466 <span class="comment">     */</span>
01467     <a class="code" href="../../d3/d8/handles_8c.html#a7">DestroyHandle</a>((HANDLE)pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o3">hConv</a>);
01468 
01469     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a2">DDEMLFree</a>(pcoi);
01470 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a7" doxytag="connect.c::InitiateEnumerationProc" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL InitiateEnumerationProc           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HWND&nbsp;</td>
          <td class="mdname" nowrap> <em>hwndTarget</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d6/d8/structtagINIT__ENUM.html">PINIT_ENUM</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pie</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d4/connect_8c-source.html#l00784">784</a> of file <a class="el" href="../../d7/d4/connect_8c-source.html">connect.c</a>.
<p>
References <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00242">tagCONVLIST::ahwnd</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00059">CheckDDECritOut</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00241">tagCONVLIST::chwnd</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00231">tagCL_CONV_INFO::ci</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00129">tagINIT_ENUM::clst</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00681">CLST_MULT_INITIALIZING</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00680">CLST_SINGLE_INITIALIZING</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00048">EnterDDECrit</a>, <a class="el" href="../../d6/d8/cltxt_8h-source.html#l00388">GetWindowLongPtr()</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00673">GWLP_PCI</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00128">tagINIT_ENUM::hConvList</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00112">HINST_ANY</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00106">HTYPE_CONVERSATION_LIST</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00123">tagINIT_ENUM::hwndClient</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00232">tagCL_CONV_INFO::hwndReconnect</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00124">tagINIT_ENUM::hwndSkip</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00516">IncLocalAtomCount()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00215">tagCONV_INFO::laService</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00220">tagCONV_INFO::laServiceRequested</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00126">tagINIT_ENUM::laServiceRequested</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00216">tagCONV_INFO::laTopic</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00127">tagINIT_ENUM::laTopic</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00049">LeaveDDECrit</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00125">tagINIT_ENUM::lParam</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00211">tagCONV_INFO::next</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d6/d8/cltxt_8h-source.html#l00652">SendMessage()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00219">tagCONV_INFO::state</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, and <a class="el" href="../../d4/d7/handles_8c-source.html#l00204">ValidateCHandle()</a>.
<p>
Referenced by <a class="el" href="../../d7/d4/connect_8c-source.html#l00607">ConnectConv()</a>.
<p>
<pre class="fragment"><div>00787 {
00788     <a class="code" href="../../d1/d0/structtagCL__CONV__INFO.html">PCL_CONV_INFO</a> pci;
00789 
00790     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a9">CheckDDECritOut</a>;
00791 
00792     <span class="keywordflow">if</span> (hwndTarget == pie-&gt;<a class="code" href="../../d6/d8/structtagINIT__ENUM.html#o1">hwndSkip</a>) {
00793         <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00794     }
00795 
00796     <span class="keywordflow">if</span> (pie-&gt;<a class="code" href="../../d6/d8/structtagINIT__ENUM.html#o5">hConvList</a> &amp;&amp; pie-&gt;<a class="code" href="../../d6/d8/structtagINIT__ENUM.html#o4">laTopic</a> &amp;&amp; pie-&gt;<a class="code" href="../../d6/d8/structtagINIT__ENUM.html#o3">laServiceRequested</a>) {
00797         <span class="comment">/*</span>
00798 <span class="comment">         * Head off duplicates BEFORE we send the WM_DDE_INITIATE messages!</span>
00799 <span class="comment">         */</span>
00800         <a class="code" href="../../d3/d1/structtagCONVLIST.html">PCONVLIST</a> pcl;
00801         <a class="code" href="../../d2/d1/structtagCONV__INFO.html">PCONV_INFO</a> pcoiExisting;
00802         <span class="keywordtype">int</span> i;
00803 
00804         <a class="code" href="../../d0/d4/ddemlcli_8h.html#a6">EnterDDECrit</a>;
00805         <span class="comment">/*</span>
00806 <span class="comment">         * We revalidate hConvList here because we left the critical section.</span>
00807 <span class="comment">         */</span>
00808         pcl = (<a class="code" href="../../d3/d1/structtagCONVLIST.html">PCONVLIST</a>)<a class="code" href="../../d3/d8/handles_8c.html#a10">ValidateCHandle</a>((HANDLE)pie-&gt;<a class="code" href="../../d6/d8/structtagINIT__ENUM.html#o5">hConvList</a>,
00809                 HTYPE_CONVERSATION_LIST, HINST_ANY);
00810         <span class="keywordflow">if</span> (pcl != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00811             <span class="keywordflow">for</span> (i = 0; i &lt; pcl-&gt;<a class="code" href="../../d3/d1/structtagCONVLIST.html#o0">chwnd</a>; i++) {
00812                 <span class="keywordflow">for</span> (pcoiExisting = (<a class="code" href="../../d2/d1/structtagCONV__INFO.html">PCONV_INFO</a>)<a class="code" href="../../d5/d9/cltxt_8h.html#a11">GetWindowLongPtr</a>(pcl-&gt;<a class="code" href="../../d3/d1/structtagCONVLIST.html#o1">ahwnd</a>[i], GWLP_PCI);
00813                         pcoiExisting != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00814                         pcoiExisting = pcoiExisting-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o0">next</a>) {
00815                     <span class="keywordflow">if</span> (pcoiExisting-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o8">state</a> &amp; ST_CONNECTED &amp;&amp;
00816                             ((<a class="code" href="../../d1/d0/structtagCL__CONV__INFO.html">PCL_CONV_INFO</a>)pcoiExisting)-&gt;hwndReconnect == hwndTarget &amp;&amp;
00817                             pcoiExisting-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o5">laTopic</a> == pie-&gt;<a class="code" href="../../d6/d8/structtagINIT__ENUM.html#o4">laTopic</a> &amp;&amp;
00818                             pcoiExisting-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o4">laService</a> == pie-&gt;<a class="code" href="../../d6/d8/structtagINIT__ENUM.html#o3">laServiceRequested</a>) {
00819                         <a class="code" href="../../d0/d4/ddemlcli_8h.html#a7">LeaveDDECrit</a>;
00820                         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00821                     }
00822                 }
00823             }
00824         }
00825         <a class="code" href="../../d0/d4/ddemlcli_8h.html#a7">LeaveDDECrit</a>;
00826     }
00827 
00828     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a9">CheckDDECritOut</a>;
00829 
00830     <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(hwndTarget, WM_DDE_INITIATE, (WPARAM)pie-&gt;<a class="code" href="../../d6/d8/structtagINIT__ENUM.html#o0">hwndClient</a>,
00831             pie-&gt;<a class="code" href="../../d6/d8/structtagINIT__ENUM.html#o2">lParam</a>);
00832 
00833     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a6">EnterDDECrit</a>;
00834 
00835     <span class="comment">//</span>
00836     <span class="comment">// During the initiate process, any acks received cause more pci's</span>
00837     <span class="comment">// to become linked together under the same hwndClient. Once</span>
00838     <span class="comment">// the SendMessage() returns, we set the parts of the new pci's</span>
00839     <span class="comment">// that hold initiate context information.</span>
00840     <span class="comment">//</span>
00841     pci = (<a class="code" href="../../d1/d0/structtagCL__CONV__INFO.html">PCL_CONV_INFO</a>)<a class="code" href="../../d5/d9/cltxt_8h.html#a11">GetWindowLongPtr</a>(pie-&gt;<a class="code" href="../../d6/d8/structtagINIT__ENUM.html#o0">hwndClient</a>, GWLP_PCI);
00842     <span class="keywordflow">if</span> (pci == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00843         <a class="code" href="../../d0/d4/ddemlcli_8h.html#a7">LeaveDDECrit</a>;
00844         <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00845     }
00846 
00847     <span class="keywordflow">while</span> (pci != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00848         <span class="keywordflow">if</span> (pci-&gt;<a class="code" href="../../d1/d0/structtagCL__CONV__INFO.html#o1">hwndReconnect</a> == 0) {  <span class="comment">// this one needs updating</span>
00849             pci-&gt;<a class="code" href="../../d1/d0/structtagCL__CONV__INFO.html#o1">hwndReconnect</a> = hwndTarget;
00850             <span class="keywordflow">if</span> (pie-&gt;<a class="code" href="../../d6/d8/structtagINIT__ENUM.html#o3">laServiceRequested</a>) {
00851                 pci-&gt;<a class="code" href="../../d1/d0/structtagCL__CONV__INFO.html#o0">ci</a>.<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o9">laServiceRequested</a> = pie-&gt;<a class="code" href="../../d6/d8/structtagINIT__ENUM.html#o3">laServiceRequested</a>;
00852                 <a class="code" href="../../d4/d2/hsz_8c.html#a15">IncLocalAtomCount</a>(pie-&gt;<a class="code" href="../../d6/d8/structtagINIT__ENUM.html#o3">laServiceRequested</a>); <span class="comment">// pci copy</span>
00853             }
00854         }
00855         <span class="keywordflow">if</span> (pie-&gt;<a class="code" href="../../d6/d8/structtagINIT__ENUM.html#o6">clst</a> == <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a158">CLST_SINGLE_INITIALIZING</a>) {
00856             <span class="keywordflow">break</span>;
00857         }
00858         pci = (<a class="code" href="../../d1/d0/structtagCL__CONV__INFO.html">PCL_CONV_INFO</a>)pci-&gt;<a class="code" href="../../d1/d0/structtagCL__CONV__INFO.html#o0">ci</a>.<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o0">next</a>;
00859     }
00860     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a7">LeaveDDECrit</a>;
00861     <span class="keywordflow">return</span> (pie-&gt;<a class="code" href="../../d6/d8/structtagINIT__ENUM.html#o6">clst</a> == <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a159">CLST_MULT_INITIALIZING</a>);
00862 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a14" doxytag="connect.c::SetCommonStateFlags" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID SetCommonStateFlags           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HWND&nbsp;</td>
          <td class="mdname" nowrap> <em>hwndUs</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HWND&nbsp;</td>
          <td class="mdname" nowrap> <em>hwndThem</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>PWORD&nbsp;</td>
          <td class="mdname" nowrap> <em>pwFlags</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d4/connect_8c-source.html#l00876">876</a> of file <a class="el" href="../../d7/d4/connect_8c-source.html">connect.c</a>.
<p>
References <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d4/d7/winmgrc_8c-source.html#l00251">GetWindowThreadProcessId()</a>, <a class="el" href="../../d4/d7/winmgrc_8c-source.html#l00533">IsWindowUnicode()</a>, and <a class="el" href="../../d2/d7/hal_8h.html#a212">VOID()</a>.
<p>
Referenced by <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00376">DDEMLClientWndProc()</a>, and <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00059">ProcessDDEMLInitiate()</a>.
<p>
<pre class="fragment"><div>00880 {
00881     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> pidUs, pidThem;
00882 
00883     <a class="code" href="../../d3/d8/winmgrc_8c.html#a18">GetWindowThreadProcessId</a>(hwndUs, &amp;pidUs);
00884     <a class="code" href="../../d3/d8/winmgrc_8c.html#a18">GetWindowThreadProcessId</a>(hwndThem, &amp;pidThem);
00885     <span class="keywordflow">if</span> (pidUs == pidThem) {
00886         *pwFlags |= ST_INTRA_PROCESS;
00887     }
00888 
00889     <span class="keywordflow">if</span> (<a class="code" href="../../d3/d8/winmgrc_8c.html#a27">IsWindowUnicode</a>(hwndUs) &amp;&amp; <a class="code" href="../../d3/d8/winmgrc_8c.html#a27">IsWindowUnicode</a>(hwndThem)) {
00890         *pwFlags |= ST_UNICODE_EXECUTE;
00891     }
00892 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a18" doxytag="connect.c::ShutdownConversation" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID ShutdownConversation           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d2/d1/structtagCONV__INFO.html">PCONV_INFO</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pcoi</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>BOOL&nbsp;</td>
          <td class="mdname" nowrap> <em>fMakeCallback</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d4/connect_8c-source.html#l01109">1109</a> of file <a class="el" href="../../d7/d4/connect_8c-source.html">connect.c</a>.
<p>
References <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00191">tagCL_INSTANCE_INFO::afCmd</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00058">CheckDDECritIn</a>, <a class="el" href="../../d9/d3/w32_2ntuser_2client_2callback_8c-source.html#l00024">DoCallback()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l01354">FreeConversationResources()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00214">tagCONV_INFO::hConv</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00218">tagCONV_INFO::hwndConv</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00217">tagCONV_INFO::hwndPartner</a>, <a class="el" href="../../d4/d8/client_2wow_8c-source.html#l00277">IsWindow()</a>, <a class="el" href="../../d3/d9/aw_8h-source.html#l00031">L</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00036">MONCONV</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00212">tagCONV_INFO::pcii</a>, <a class="el" href="../../d1/d7/ntcftxt_8h-source.html#l00427">PostMessage()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00219">tagCONV_INFO::state</a>, and <a class="el" href="../../d2/d7/hal_8h.html#a212">VOID()</a>.
<p>
Referenced by <a class="el" href="../../d7/d4/connect_8c-source.html#l00195">DdeConnectList()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l01008">DdeDisconnect()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l01053">DdeDisconnectList()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00759">DisconnectConv()</a>, <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00543">ProcessTerminateMsg()</a>, and <a class="el" href="../../d3/d5/stdptcl_8c-source.html#l01396">SpontaneousClientMessage()</a>.
<p>
<pre class="fragment"><div>01112 {
01113     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a8">CheckDDECritIn</a>;
01114 
01115     <span class="keywordflow">if</span> (pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o8">state</a> &amp; ST_CONNECTED) {
01116         pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o8">state</a> &amp;= ~ST_CONNECTED;
01117 
01118         <span class="keywordflow">if</span> (<a class="code" href="../../d3/d9/client_2wow_8c.html#a11">IsWindow</a>(pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o6">hwndPartner</a>)) {
01119             <a class="code" href="../../d0/d8/ntcftxt_8h.html#a20">PostMessage</a>(pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o6">hwndPartner</a>, WM_DDE_TERMINATE,
01120                     (WPARAM)pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o7">hwndConv</a>, 0);
01121         }
01122         <span class="keywordflow">if</span> (fMakeCallback &amp;&amp; !(pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o1">pcii</a>-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o7">afCmd</a> &amp; CBF_SKIP_DISCONNECTS)) {
01123             <a class="code" href="../../d0/d4/ddemlcli_8h.html#a127">DoCallback</a>(pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o1">pcii</a>, (WORD)XTYP_DISCONNECT, 0, pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o3">hConv</a>,
01124                     0, 0, 0, 0, (pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o8">state</a> &amp; ST_ISSELF) ? 1L : 0L);
01125         }
01126         <a class="code" href="../../d0/d4/ddemlcli_8h.html#a5">MONCONV</a>(pcoi, FALSE);
01127     }
01128 
01129     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a114">FreeConversationResources</a>(pcoi);
01130 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a19" doxytag="connect.c::UnlinkConvFromOthers" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID UnlinkConvFromOthers           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d2/d1/structtagCONV__INFO.html">PCONV_INFO</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>pcoi</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>BOOL&nbsp;</td>
          <td class="mdname" nowrap> <em>gGoingZombie</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d4/connect_8c-source.html#l01153">1153</a> of file <a class="el" href="../../d7/d4/connect_8c-source.html">connect.c</a>.
<p>
References <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00242">tagCONVLIST::ahwnd</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00197">tagCL_INSTANCE_INFO::aServerLookup</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00058">CheckDDECritIn</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00241">tagCONVLIST::chwnd</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00198">tagCL_INSTANCE_INFO::cServerLookupAlloc</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00018">DDEMLFree</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00048">EnterDDECrit</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d7/d2/queue_8c-source.html#l01033">GetAppCompatFlags2()</a>, <a class="el" href="../../d4/d7/handles_8c-source.html#l00165">GetHandleData()</a>, <a class="el" href="../../d6/d8/cltxt_8h-source.html#l00388">GetWindowLongPtr()</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00673">GWLP_PCI</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00214">tagCONV_INFO::hConv</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00109">HTYPE_ZOMBIE_CONVERSATION</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00218">tagCONV_INFO::hwndConv</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00170">tagSERVER_LOOKUP::hwndServer</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00168">tagSERVER_LOOKUP::laService</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00169">tagSERVER_LOOKUP::laTopic</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00049">LeaveDDECrit</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00211">tagCONV_INFO::next</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l04115">NtUserDestroyWindow()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d6/d5/connect_8c.html#a2">ORPATH</a>, <a class="el" href="../../d4/d2/dumpuser_8c-source.html#l00045">path</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00212">tagCONV_INFO::pcii</a>, <a class="el" href="../../d0/d4/ddemlcli_8h.html#a73">PCL_CONV_INFO</a>, <a class="el" href="../../d6/d8/cltxt_8h-source.html#l00408">SetWindowLongPtr()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00219">tagCONV_INFO::state</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00094">TypeFromHandle</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00103">ValidateAllConvLists</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00102">ValidateConvList</a>, and <a class="el" href="../../d2/d7/hal_8h.html#a212">VOID()</a>.
<p>
Referenced by <a class="el" href="../../d7/d4/connect_8c-source.html#l01354">FreeConversationResources()</a>.
<p>
<pre class="fragment"><div>01156 {
01157     <a class="code" href="../../d2/d1/structtagCONV__INFO.html">PCONV_INFO</a> pcoiPrev, pcoiFirst, pcoiNow;
01158     <a class="code" href="../../d3/d1/structtagCONVLIST.html">PCONVLIST</a> pcl;
01159     <span class="keywordtype">int</span> i, cActiveInList = 0;
01160 <span class="preprocessor">#ifdef TESTING</span>
01161 <span class="preprocessor"></span>    <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> <a class="code" href="../../d3/d3/dumpuser_8c.html#a14">path</a> = 0;
01162 <span class="preprocessor">#define ORPATH(x) path |= x;</span>
01163 <span class="preprocessor"></span><span class="preprocessor">#else</span>
01164 <span class="preprocessor"></span><span class="preprocessor">#define ORPATH(x)</span>
01165 <span class="preprocessor"></span><span class="preprocessor">#endif // TESTING</span>
01166 <span class="preprocessor"></span>
01167     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a8">CheckDDECritIn</a>;
01168 
01169     <span class="comment">/*</span>
01170 <span class="comment">     * Scan pcoi linked list to get key pointers.</span>
01171 <span class="comment">     */</span>
01172     pcoiPrev = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01173     pcoiFirst = pcoiNow = (<a class="code" href="../../d2/d1/structtagCONV__INFO.html">PCONV_INFO</a>)<a class="code" href="../../d5/d9/cltxt_8h.html#a11">GetWindowLongPtr</a>(pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o7">hwndConv</a>, GWLP_PCI);
01174 
01175 <span class="preprocessor">#ifdef TESTING</span>
01176 <span class="preprocessor"></span>    <span class="comment">/*</span>
01177 <span class="comment">     * verify that pcoi is in the conv list for this window.</span>
01178 <span class="comment">     */</span>
01179     <span class="keywordflow">while</span> (pcoiNow != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01180         <span class="keywordflow">if</span> (pcoiNow == pcoi) {
01181             <span class="keywordflow">goto</span> FoundIt;
01182         }
01183         pcoiNow = pcoiNow-&gt;next;
01184     }
01185     DebugBreak();
01186 FoundIt:
01187     pcoiNow = pcoiFirst;
01188 <span class="preprocessor">#endif // TESTING</span>
01189 <span class="preprocessor"></span>
01190     UserAssert(pcoiFirst);
01191     <span class="keywordflow">while</span> (pcoiNow != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01192         <span class="keywordflow">if</span> (<a class="code" href="../../d0/d4/ddemlcli_8h.html#a27">TypeFromHandle</a>(pcoiNow-&gt;hConv) != <a class="code" href="../../d0/d4/ddemlcli_8h.html#a40">HTYPE_ZOMBIE_CONVERSATION</a>) {
01193             <a class="code" href="../../d6/d5/connect_8c.html#a2">ORPATH</a>(1);
01194             cActiveInList++;
01195         }
01196         <span class="keywordflow">if</span> (pcoiNow-&gt;next == pcoi) {
01197             pcoiPrev = pcoiNow;
01198         }
01199         pcoiNow = pcoiNow-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o0">next</a>;
01200     }
01201 
01202     <a class="code" href="../../d6/d5/connect_8c.html#a1">ValidateAllConvLists</a>();
01203 
01204     <span class="comment">/*</span>
01205 <span class="comment">     * Unlink conversation unless its going Zombie.</span>
01206 <span class="comment">     */</span>
01207     <span class="keywordflow">if</span> (!gGoingZombie) {
01208         <a class="code" href="../../d6/d5/connect_8c.html#a2">ORPATH</a>(2);
01209         <span class="keywordflow">if</span> (<a class="code" href="../../d0/d4/ddemlcli_8h.html#a27">TypeFromHandle</a>(pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o3">hConv</a>) != <a class="code" href="../../d0/d4/ddemlcli_8h.html#a40">HTYPE_ZOMBIE_CONVERSATION</a>) {
01210             <a class="code" href="../../d6/d5/connect_8c.html#a2">ORPATH</a>(4);
01211             cActiveInList--;
01212         }
01213 
01214         <span class="keywordflow">if</span> (pcoiPrev == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01215             <a class="code" href="../../d6/d5/connect_8c.html#a2">ORPATH</a>(8);
01216             pcoiFirst = pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o0">next</a>;
01217             <a class="code" href="../../d5/d9/cltxt_8h.html#a12">SetWindowLongPtr</a>(pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o7">hwndConv</a>, GWLP_PCI, (LONG_PTR)pcoiFirst);
01218         } <span class="keywordflow">else</span> {
01219             pcoiPrev-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o0">next</a> = pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o0">next</a>;
01220         }
01221     }
01222 
01223     UserAssert(pcoiFirst != NULL || !cActiveInList);
01224 
01225     <span class="keywordflow">if</span> (cActiveInList == 0) {
01226         <a class="code" href="../../d6/d5/connect_8c.html#a2">ORPATH</a>(0x10);
01227         <span class="keywordflow">if</span> (pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o8">state</a> &amp; ST_CLIENT) {
01228             <a class="code" href="../../d6/d5/connect_8c.html#a2">ORPATH</a>(0x20);
01229             <span class="keywordflow">if</span> (((<a class="code" href="../../d1/d0/structtagCL__CONV__INFO.html">PCL_CONV_INFO</a>)pcoi)-&gt;hConvList) {
01230                 <span class="comment">/*</span>
01231 <span class="comment">                 * Remove pcoi's hwnd from its hConvList.</span>
01232 <span class="comment">                 */</span>
01233                 pcl = (<a class="code" href="../../d3/d1/structtagCONVLIST.html">PCONVLIST</a>)<a class="code" href="../../d3/d8/handles_8c.html#a8">GetHandleData</a>((HANDLE)((<a class="code" href="../../d1/d0/structtagCL__CONV__INFO.html">PCL_CONV_INFO</a>)pcoi)-&gt;hConvList);
01234                 <span class="keywordflow">for</span> (i = 0; i &lt; pcl-&gt;<a class="code" href="../../d3/d1/structtagCONVLIST.html#o0">chwnd</a>; i++) {
01235                     <span class="keywordflow">if</span> (pcl-&gt;<a class="code" href="../../d3/d1/structtagCONVLIST.html#o1">ahwnd</a>[i] == pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o7">hwndConv</a>) {
01236                         <a class="code" href="../../d6/d5/connect_8c.html#a2">ORPATH</a>(0x40);
01237                         pcl-&gt;<a class="code" href="../../d3/d1/structtagCONVLIST.html#o0">chwnd</a>--;
01238                         UserAssert(pcl-&gt;<a class="code" href="../../d3/d1/structtagCONVLIST.html#o1">ahwnd</a>[pcl-&gt;<a class="code" href="../../d3/d1/structtagCONVLIST.html#o0">chwnd</a>]);
01239                         pcl-&gt;<a class="code" href="../../d3/d1/structtagCONVLIST.html#o1">ahwnd</a>[i] = pcl-&gt;<a class="code" href="../../d3/d1/structtagCONVLIST.html#o1">ahwnd</a>[pcl-&gt;<a class="code" href="../../d3/d1/structtagCONVLIST.html#o0">chwnd</a>];
01240                         <a class="code" href="../../d6/d5/connect_8c.html#a0">ValidateConvList</a>(((<a class="code" href="../../d1/d0/structtagCL__CONV__INFO.html">PCL_CONV_INFO</a>)pcoi)-&gt;hConvList);
01241                         <span class="keywordflow">break</span>;
01242                     }
01243                 }
01244                 <a class="code" href="../../d6/d5/connect_8c.html#a2">ORPATH</a>(0x80);
01245             }
01246         } <span class="keywordflow">else</span> {  <span class="comment">// SERVER</span>
01247             <span class="comment">/*</span>
01248 <span class="comment">             * remove server window from the service/topic lookup table.</span>
01249 <span class="comment">             */</span>
01250             <a class="code" href="../../d6/d5/connect_8c.html#a2">ORPATH</a>(0x100);
01251             <span class="keywordflow">for</span> (i = 0; i &lt; pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o1">pcii</a>-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o14">cServerLookupAlloc</a>; i++) {
01252                 <span class="keywordflow">if</span> (pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o1">pcii</a>-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o13">aServerLookup</a>[i].<a class="code" href="../../d1/d6/structtagSERVER__LOOKUP.html#o2">hwndServer</a> == pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o7">hwndConv</a>) {
01253                     <a class="code" href="../../d6/d5/connect_8c.html#a2">ORPATH</a>(0x200);
01254                     
01255                     <span class="comment">/*</span>
01256 <span class="comment">                     * Check for appcompat hack</span>
01257 <span class="comment">                     */</span>
01258                     <span class="keywordflow">if</span> (<a class="code" href="../../d6/d3/queue_8c.html#a35">GetAppCompatFlags2</a>(VERMAX) &amp; GACF2_DDE) {
01259                         DeleteAtom(pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o1">pcii</a>-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o13">aServerLookup</a>[i].<a class="code" href="../../d1/d6/structtagSERVER__LOOKUP.html#o0">laService</a>); <span class="comment">// delete laService</span>
01260                         DeleteAtom(pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o1">pcii</a>-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o13">aServerLookup</a>[i].<a class="code" href="../../d1/d6/structtagSERVER__LOOKUP.html#o1">laTopic</a>);   <span class="comment">// delete laTopic</span>
01261                     }
01262                     
01263                     <span class="keywordflow">if</span> (--(pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o1">pcii</a>-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o14">cServerLookupAlloc</a>)) {
01264                         <a class="code" href="../../d6/d5/connect_8c.html#a2">ORPATH</a>(0x400);
01265                         pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o1">pcii</a>-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o13">aServerLookup</a>[i] =
01266                                 pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o1">pcii</a>-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o13">aServerLookup</a>[pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o1">pcii</a>-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o14">cServerLookupAlloc</a>];
01267                     } <span class="keywordflow">else</span> {
01268                         <a class="code" href="../../d0/d4/ddemlcli_8h.html#a2">DDEMLFree</a>(pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o1">pcii</a>-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o13">aServerLookup</a>);
01269                         pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o1">pcii</a>-&gt;<a class="code" href="../../d2/d0/structtagCL__INSTANCE__INFO.html#o13">aServerLookup</a> = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01270                     }
01271                     <span class="keywordflow">break</span>;
01272                 }
01273             }
01274         }
01275     }
01276 <span class="preprocessor">#ifdef TESTING</span>
01277 <span class="preprocessor"></span>      <span class="keywordflow">else</span> {
01278         <span class="comment">/*</span>
01279 <span class="comment">         * make sure at this point we have at least one non-zombie</span>
01280 <span class="comment">         */</span>
01281         pcoiNow = pcoiFirst;
01282         <span class="keywordflow">while</span> (pcoiNow != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01283             <span class="keywordflow">if</span> (<a class="code" href="../../d0/d4/ddemlcli_8h.html#a27">TypeFromHandle</a>(pcoiNow-&gt;hConv) != <a class="code" href="../../d0/d4/ddemlcli_8h.html#a40">HTYPE_ZOMBIE_CONVERSATION</a>) {
01284                 <span class="keywordflow">goto</span> Out;
01285             }
01286             pcoiNow = pcoiNow-&gt;next;
01287         }
01288         DebugBreak();
01289 Out:
01290         ;
01291     }
01292 <span class="preprocessor">#endif // TESTING</span>
01293 <span class="preprocessor"></span>
01294     <a class="code" href="../../d6/d5/connect_8c.html#a1">ValidateAllConvLists</a>();
01295     <a class="code" href="../../d6/d5/connect_8c.html#a2">ORPATH</a>(0x800);
01296 
01297     <span class="comment">/*</span>
01298 <span class="comment">     * In any case remove hConvList references from client conversation.</span>
01299 <span class="comment">     */</span>
01300     <span class="keywordflow">if</span> (pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o8">state</a> &amp; ST_CLIENT) {
01301 <span class="preprocessor">#ifdef TESTING</span>
01302 <span class="preprocessor"></span>        <span class="comment">/*</span>
01303 <span class="comment">         * Verify that the hConvList that is being removed, doesn't reference</span>
01304 <span class="comment">         * this window.</span>
01305 <span class="comment">         */</span>
01306         <span class="keywordflow">if</span> (((<a class="code" href="../../d1/d0/structtagCL__CONV__INFO.html">PCL_CONV_INFO</a>)pcoi)-&gt;hConvList &amp;&amp; !cActiveInList) {
01307             <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> fFound = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01308 
01309             pcl = (<a class="code" href="../../d3/d1/structtagCONVLIST.html">PCONVLIST</a>)<a class="code" href="../../d3/d8/handles_8c.html#a8">GetHandleData</a>((HANDLE)((<a class="code" href="../../d1/d0/structtagCL__CONV__INFO.html">PCL_CONV_INFO</a>)pcoi)-&gt;hConvList);
01310             <span class="keywordflow">for</span> (i = 0; i &lt; pcl-&gt;<a class="code" href="../../d3/d1/structtagCONVLIST.html#o0">chwnd</a>; i++) {
01311                 <span class="keywordflow">if</span> (pcl-&gt;<a class="code" href="../../d3/d1/structtagCONVLIST.html#o1">ahwnd</a>[i] == pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o7">hwndConv</a>) {
01312                     fFound = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01313                     <span class="keywordflow">break</span>;
01314                 }
01315             }
01316             UserAssert(!fFound);
01317         }
01318 <span class="preprocessor">#endif // TESTING</span>
01319 <span class="preprocessor"></span>        ((<a class="code" href="../../d1/d0/structtagCL__CONV__INFO.html">PCL_CONV_INFO</a>)pcoi)-&gt;hConvList = 0;
01320         pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o8">state</a> &amp;= ~ST_INLIST;
01321     }
01322 
01323     <span class="comment">/*</span>
01324 <span class="comment">     * last one out turns out the lights.</span>
01325 <span class="comment">     */</span>
01326     <span class="keywordflow">if</span> (pcoiFirst == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01327         <span class="comment">/*</span>
01328 <span class="comment">         * If the pcoi list is empty, this window can go away.</span>
01329 <span class="comment">         */</span>
01330         <a class="code" href="../../d0/d4/ddemlcli_8h.html#a7">LeaveDDECrit</a>;
01331         <a class="code" href="../../d9/d9/kernel_2ntstubs_8c.html#a159">NtUserDestroyWindow</a>(pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o7">hwndConv</a>);
01332         <a class="code" href="../../d0/d4/ddemlcli_8h.html#a6">EnterDDECrit</a>;
01333     }
01334 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a12" doxytag="connect.c::ValidateConnectParameters" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL ValidateConnectParameters           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HANDLE&nbsp;</td>
          <td class="mdname" nowrap> <em>hInst</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d2/d0/structtagCL__INSTANCE__INFO.html">PCL_INSTANCE_INFO</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>ppcii</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HSZ *&nbsp;</td>
          <td class="mdname" nowrap> <em>phszService</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HSZ&nbsp;</td>
          <td class="mdname" nowrap> <em>hszTopic</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d4/ddemlcli_8h.html#a51">LATOM</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>plaNormalSvcName</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>PCONVCONTEXT *&nbsp;</td>
          <td class="mdname" nowrap> <em>ppCC</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HWND *&nbsp;</td>
          <td class="mdname" nowrap> <em>phwndTarget</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HCONVLIST&nbsp;</td>
          <td class="mdname" nowrap> <em>hConvList</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d4/connect_8c-source.html#l00491">491</a> of file <a class="el" href="../../d7/d4/connect_8c-source.html">connect.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00107">DefConvContext</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d4/d7/aug98_2test_2main_8c-source.html#l00074">hInst</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00067">HSZT_INST_SPECIFIC</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00065">HSZT_INVALID</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00106">HTYPE_CONVERSATION_LIST</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00206">IIF_UNICODE</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00095">InstFromHandle</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00069">LATOM_FROM_HSZ</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00070">NORMAL_HSZ_FROM_LATOM</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00398">ParseInstSpecificAtom()</a>, <a class="el" href="../../d1/d3/instance_8c-source.html#l00137">SetLastDDEMLError()</a>, <a class="el" href="../../d7/d4/connect_8c-source.html#l00106">TempConvContext</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d4/d7/handles_8c-source.html#l00204">ValidateCHandle()</a>, <a class="el" href="../../d5/d1/hsz_8c-source.html#l00340">ValidateHSZ()</a>, and <a class="el" href="../../d1/d3/instance_8c-source.html#l00111">ValidateInstance()</a>.
<p>
Referenced by <a class="el" href="../../d7/d4/connect_8c-source.html#l00146">DdeConnect()</a>, and <a class="el" href="../../d7/d4/connect_8c-source.html#l00195">DdeConnectList()</a>.
<p>
<pre class="fragment"><div>00500 {
00501     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> hszType;
00502     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> fError = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00503 
00504     *ppcii = <a class="code" href="../../d0/d4/instance_8c.html#a7">ValidateInstance</a>(hInst);
00505     <span class="keywordflow">if</span> (*ppcii == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00506         <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00507     }
00508     hszType = <a class="code" href="../../d4/d2/hsz_8c.html#a9">ValidateHSZ</a>(*phszService);
00509     <span class="keywordflow">if</span> (hszType == <a class="code" href="../../d0/d4/ddemlcli_8h.html#a10">HSZT_INVALID</a> || <a class="code" href="../../d4/d2/hsz_8c.html#a9">ValidateHSZ</a>(hszTopic) == <a class="code" href="../../d0/d4/ddemlcli_8h.html#a10">HSZT_INVALID</a>) {
00510         <a class="code" href="../../d0/d4/instance_8c.html#a8">SetLastDDEMLError</a>(*ppcii, DMLERR_INVALIDPARAMETER);
00511         <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00512     }
00513     <span class="keywordflow">if</span> (hszType == <a class="code" href="../../d0/d4/ddemlcli_8h.html#a12">HSZT_INST_SPECIFIC</a>) {
00514         *phwndTarget = <a class="code" href="../../d4/d2/hsz_8c.html#a11">ParseInstSpecificAtom</a>(<a class="code" href="../../d0/d4/ddemlcli_8h.html#a13">LATOM_FROM_HSZ</a>(*phszService),
00515             plaNormalSvcName);
00516         <span class="keywordflow">if</span> (*plaNormalSvcName == 0) {
00517             <a class="code" href="../../d0/d4/instance_8c.html#a8">SetLastDDEMLError</a>(*ppcii, DMLERR_SYS_ERROR);
00518             <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00519         }
00520         *phszService = <a class="code" href="../../d0/d4/ddemlcli_8h.html#a14">NORMAL_HSZ_FROM_LATOM</a>(*plaNormalSvcName);
00521     }
00522     <span class="keywordflow">if</span> (*ppCC == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00523         *ppCC = &amp;<a class="code" href="../../d6/d5/connect_8c.html#a4">DefConvContext</a>;
00524         <span class="keywordflow">if</span> ((*ppcii)-&gt;flags &amp; <a class="code" href="../../d0/d4/ddemlcli_8h.html#a50">IIF_UNICODE</a>) {
00525             (*ppCC)-&gt;iCodePage = CP_WINUNICODE;
00526         } <span class="keywordflow">else</span> {
00527             (*ppCC)-&gt;iCodePage = CP_WINANSI;
00528         }
00529     } <span class="keywordflow">else</span> <span class="keywordflow">try</span> {
00530         <span class="keywordflow">if</span> ((*ppCC)-&gt;cb &gt; <span class="keyword">sizeof</span>(CONVCONTEXT)) {
00531             <a class="code" href="../../d0/d4/instance_8c.html#a8">SetLastDDEMLError</a>(*ppcii, DMLERR_INVALIDPARAMETER);
00532             fError = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00533         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((*ppCC)-&gt;cb &lt; <span class="keyword">sizeof</span>(CONVCONTEXT)) {
00534             <a class="code" href="../../d6/d5/connect_8c.html#a3">TempConvContext</a> = <a class="code" href="../../d6/d5/connect_8c.html#a4">DefConvContext</a>;
00535             <span class="comment">/*</span>
00536 <span class="comment">             * we can use this static temp because we are synchronized.</span>
00537 <span class="comment">             */</span>
00538             RtlCopyMemory(&amp;TempConvContext, *ppCC, (*ppCC)-&gt;cb);
00539             *ppCC = &amp;<a class="code" href="../../d6/d5/connect_8c.html#a3">TempConvContext</a>;
00540         }
00541     } except(W32ExceptionHandler(FALSE, RIP_WARNING)) {
00542         <a class="code" href="../../d0/d4/instance_8c.html#a8">SetLastDDEMLError</a>(*ppcii, DMLERR_INVALIDPARAMETER);
00543         fError = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00544     }
00545     <span class="keywordflow">if</span> (fError) {
00546         <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00547     }
00548     <span class="keywordflow">if</span> (hConvList != 0 &amp;&amp;
00549             !<a class="code" href="../../d3/d8/handles_8c.html#a10">ValidateCHandle</a>((HANDLE)hConvList, HTYPE_CONVERSATION_LIST,
00550             (DWORD)<a class="code" href="../../d0/d4/ddemlcli_8h.html#a28">InstFromHandle</a>((*ppcii)-&gt;hInstClient))) {
00551         <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00552     }
00553     <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00554 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a21" doxytag="connect.c::WaitForZombieTerminate" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL WaitForZombieTerminate           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HANDLE&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>hData</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d4/connect_8c-source.html#l01474">1474</a> of file <a class="el" href="../../d7/d4/connect_8c-source.html">connect.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00059">CheckDDECritOut</a>, <a class="el" href="../../d6/d8/cltxt_8h-source.html#l00874">DispatchMessage()</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00048">EnterDDECrit</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00109">HTYPE_ZOMBIE_CONVERSATION</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00218">tagCONV_INFO::hwndConv</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00217">tagCONV_INFO::hwndPartner</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00095">InstFromHandle</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00049">LeaveDDECrit</a>, <a class="el" href="../../d3/d0/userexts_8c-source.html#l01830">msg</a>, <a class="el" href="../../d4/d7/client_8c-source.html#l01486">MsgWaitForMultipleObjectsEx()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d6/d8/cltxt_8h-source.html#l00483">PeekMessage()</a>, <a class="el" href="../../d4/d3/ddemlwp_8c-source.html#l00543">ProcessTerminateMsg()</a>, <a class="el" href="../../d1/d3/ddemlcli_8h-source.html#l00219">tagCONV_INFO::state</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, and <a class="el" href="../../d4/d7/handles_8c-source.html#l00204">ValidateCHandle()</a>.
<p>
Referenced by <a class="el" href="../../d0/d3/ddemlcli_8c-source.html#l00196">DdeUninitialize()</a>.
<p>
<pre class="fragment"><div>01476 {
01477     <a class="code" href="../../d2/d1/structtagCONV__INFO.html">PCONV_INFO</a> pcoi;
01478     MSG <a class="code" href="../../d2/d1/userexts_8c.html#a129">msg</a>;
01479     HWND hwnd;
01480     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> fTerminated;
01481     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> fRet = 0;
01482 
01483     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a9">CheckDDECritOut</a>;
01484     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a6">EnterDDECrit</a>;
01485 
01486     fTerminated = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01487     <span class="keywordflow">while</span> ((pcoi = (<a class="code" href="../../d2/d1/structtagCONV__INFO.html">PCONV_INFO</a>)<a class="code" href="../../d3/d8/handles_8c.html#a10">ValidateCHandle</a>(hData,
01488             HTYPE_ZOMBIE_CONVERSATION, <a class="code" href="../../d0/d4/ddemlcli_8h.html#a28">InstFromHandle</a>(hData))) != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> &amp;&amp;
01489             !(pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o8">state</a> &amp; ST_TERMINATE_RECEIVED)) {
01490         hwnd = pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o7">hwndConv</a>;
01491         <a class="code" href="../../d0/d4/ddemlcli_8h.html#a7">LeaveDDECrit</a>;
01492         <span class="keywordflow">while</span> (<a class="code" href="../../d5/d9/cltxt_8h.html#a14">PeekMessage</a>(&amp;msg, hwnd, WM_DDE_FIRST, WM_DDE_LAST, PM_REMOVE)) {
01493             <a class="code" href="../../d5/d9/cltxt_8h.html#a24">DispatchMessage</a>(&amp;msg);
01494             <span class="keywordflow">if</span> (<a class="code" href="../../d2/d1/userexts_8c.html#a129">msg</a>.message == WM_DDE_TERMINATE) {
01495                 fTerminated = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01496             }
01497         }
01498         <span class="keywordflow">if</span> (!fTerminated) {
01499             fRet = <a class="code" href="../../d3/d8/client_8c.html#a58">MsgWaitForMultipleObjectsEx</a>(0, NULL, 100, QS_POSTMESSAGE, 0);
01500             <span class="keywordflow">if</span> (fRet == 0xFFFFFFFF) {
01501                 RIPMSG0(RIP_WARNING, <span class="stringliteral">"WaitForZombieTerminate: I give up - faking terminate."</span>);
01502                 <a class="code" href="../../d3/d4/ddemlwp_8c.html#a4">ProcessTerminateMsg</a>(pcoi, pcoi-&gt;<a class="code" href="../../d2/d1/structtagCONV__INFO.html#o6">hwndPartner</a>);
01503                 <a class="code" href="../../d0/d4/ddemlcli_8h.html#a6">EnterDDECrit</a>;
01504                 <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
01505             }
01506         }
01507         <a class="code" href="../../d0/d4/ddemlcli_8h.html#a6">EnterDDECrit</a>;
01508     }
01509     <a class="code" href="../../d0/d4/ddemlcli_8h.html#a7">LeaveDDECrit</a>;
01510     <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
01511 }
</div></pre>    </td>
  </tr>
</table>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="a4" doxytag="connect.c::DefConvContext" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> CONVCONTEXT <a class="el" href="../../d0/d4/ddemlcli_8h.html#a78">DefConvContext</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Initial value:</b><pre class="fragment"><div> {
    <span class="keyword">sizeof</span>(CONVCONTEXT),
    0,
    0,
    CP_WINANSI,
    0<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>,
    0<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>,
    {
        <span class="keyword">sizeof</span>(SECURITY_QUALITY_OF_SERVICE),
        SecurityImpersonation,
        SECURITY_STATIC_TRACKING,
        <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>
    }
}
</div></pre>
<p>
Definition at line <a class="el" href="../../d7/d4/connect_8c-source.html#l00107">107</a> of file <a class="el" href="../../d7/d4/connect_8c-source.html">connect.c</a>.
<p>
Referenced by <a class="el" href="../../d1/d0/xact_8c-source.html#l00411">DdeQueryConvInfo()</a>, and <a class="el" href="../../d7/d4/connect_8c-source.html#l00491">ValidateConnectParameters()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="connect.c::TempConvContext" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> CONVCONTEXT <a class="el" href="../../d6/d5/connect_8c.html#a3">TempConvContext</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d4/connect_8c-source.html#l00106">106</a> of file <a class="el" href="../../d7/d4/connect_8c-source.html">connect.c</a>.
<p>
Referenced by <a class="el" href="../../d7/d4/connect_8c-source.html#l00491">ValidateConnectParameters()</a>.    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:43:14 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
