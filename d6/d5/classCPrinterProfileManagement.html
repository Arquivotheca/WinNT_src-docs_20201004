<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: CPrinterProfileManagement class Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>CPrinterProfileManagement Class Reference</h1><code>#include &lt;<a class="el" href="../../d7/d6/devprop_8h-source.html">devprop.h</a>&gt;</code>
<p>
<p>Inheritance diagram for CPrinterProfileManagement:
<p><center><img src="d6/d5/classCPrinterProfileManagement.png" usemap="#CPrinterProfileManagement_map" border="0" alt=""></center>
<map name="CPrinterProfileManagement_map">
<area href="d2/d2/classCDeviceProfileManagement.html" alt="CDeviceProfileManagement" shape="rect" coords="0,112,170,136">
<area href="d9/d6/classCShellExtensionPage.html" alt="CShellExtensionPage" shape="rect" coords="0,56,170,80">
<area href="d2/d6/classCPropertyPage.html" alt="CPropertyPage" shape="rect" coords="0,0,170,24">
</map>
<a href="../../d2/d2/classCPrinterProfileManagement-members.html">List of all members.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d5/classCPrinterProfileManagement.html#a0">CPrinterProfileManagement</a> (LPCTSTR lpstrName, HINSTANCE hiWhere)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d5/classCPrinterProfileManagement.html#a1">~CPrinterProfileManagement</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>virtual <a class="el" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d5/classCPrinterProfileManagement.html#a2">OnInit</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>virtual BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d5/classCPrinterProfileManagement.html#a3">OnCommand</a> (WORD wNotifyCode, WORD wid, HWND hwndCtl)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>virtual BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d5/classCPrinterProfileManagement.html#a4">OnNotify</a> (int idCtrl, LPNMHDR pnmh)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>virtual BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d5/classCPrinterProfileManagement.html#a5">OnHelp</a> (LPHELPINFO pHelp)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>virtual BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d5/classCPrinterProfileManagement.html#a6">OnContextMenu</a> (HWND hwnd)</td></tr>

<tr><td colspan=2><br><h2>Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>virtual void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d5/classCPrinterProfileManagement.html#b0">InitList</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>virtual void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d5/classCPrinterProfileManagement.html#b1">FillList</a> (<a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> <a class="el" href="../../d3/d8/propapi_8h.html#a34">dwFlags</a>=0)</td></tr>

<tr><td colspan=2><br><h2>Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>unsigned&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d5/classCPrinterProfileManagement.html#p0">m_uDefault</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d5/classCPrinterProfileManagement.html#p1">m_bManualMode</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d5/classCPrinterProfileManagement.html#p2">m_bAdminAccess</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d5/classCPrinterProfileManagement.html#p3">m_bLocalPrinter</a></td></tr>

</table>
<hr><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" name="a0" doxytag="CPrinterProfileManagement::CPrinterProfileManagement" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> CPrinterProfileManagement::CPrinterProfileManagement           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">LPCTSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>lpstrName</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HINSTANCE&nbsp;</td>
          <td class="mdname" nowrap> <em>hiWhere</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00814">814</a> of file <a class="el" href="../../d6/d6/devprop_8cpp-source.html">devprop.cpp</a>.
<p>
References <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00814">CPrinterProfileManagement()</a>, and <a class="el" href="../../d3/d8/ntgdi_2icm_2icmui_2resource_8h-source.html#l00087">PrinterUI</a>.
<p>
Referenced by <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00814">CPrinterProfileManagement()</a>.
<p>
<pre class="fragment"><div>00815                                                                         :
00816     <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html">CDeviceProfileManagement</a>(lpstrName, hiWhere, PrinterUI, CLASS_PRINTER) {
00817 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="CPrinterProfileManagement::~CPrinterProfileManagement" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> CPrinterProfileManagement::~<a class="el" href="../../d6/d5/classCPrinterProfileManagement.html">CPrinterProfileManagement</a>           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [inline]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d6/devprop_8h-source.html#l00141">141</a> of file <a class="el" href="../../d7/d6/devprop_8h-source.html">devprop.h</a>.
<p>
<pre class="fragment"><div>00141 {}
</div></pre>    </td>
  </tr>
</table>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="b1" doxytag="CPrinterProfileManagement::FillList" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void CPrinterProfileManagement::FillList           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>dwFlags</em> = <code>0</code>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Reimplemented from <a class="el" href="../../d2/d2/classCDeviceProfileManagement.html#b1">CDeviceProfileManagement</a>.
<p>
Definition at line <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00741">741</a> of file <a class="el" href="../../d6/d6/devprop_8cpp-source.html">devprop.cpp</a>.
<p>
References <a class="el" href="../../d5/d6/stringar_8h-source.html#l00134">CUintArray::Count()</a>, <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00275">CProfileArray::Count()</a>, <a class="el" href="../../d3/d8/ntgdi_2icm_2icmui_2resource_8h-source.html#l00102">DefaultButton</a>, <a class="el" href="../../d3/d8/ntgdi_2icm_2icmui_2resource_8h-source.html#l00117">DefaultProfile</a>, <a class="el" href="../../d7/d6/devprop_8h-source.html#l00067">DEVLIST_NOSELECT</a>, <a class="el" href="../../d7/d6/devprop_8h-source.html#l00065">DEVLIST_ONINIT</a>, <a class="el" href="../../d4/d7/propapi_8h-source.html#l00043">dwFlags</a>, <a class="el" href="../../d4/d7/client_8c-source.html#l03016">EnableWindow()</a>, <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00741">FillList()</a>, <a class="el" href="../../d4/d8/client_2wow_8c-source.html#l00158">GetDlgItem()</a>, <a class="el" href="../../d4/d6/stringar_8cpp-source.html#l00189">CString::Load()</a>, <a class="el" href="../../d7/d6/devprop_8h-source.html#l00132">m_bAdminAccess</a>, <a class="el" href="../../d7/d6/devprop_8h-source.html#l00131">m_bManualMode</a>, <a class="el" href="../../d7/d6/devprop_8h-source.html#l00130">m_uDefault</a>, <a class="el" href="../../d3/d8/ntgdi_2icm_2icmui_2resource_8h-source.html#l00053">NoProfileString</a>, <a class="el" href="../../d6/d8/cltxt_8h-source.html#l00652">SendMessage()</a>, and <a class="el" href="../../d6/d8/cltxt_8h-source.html#l00768">SetDlgItemText()</a>.
<p>
Referenced by <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00741">FillList()</a>, <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00950">OnCommand()</a>, and <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l01075">OnNotify()</a>.
<p>
<pre class="fragment"><div>00741                                                          {
00742 
00743     <span class="comment">//  If we are initializing list box, we want to put focus on</span>
00744     <span class="comment">//  "default" profile. here we won't below FillList set focus</span>
00745     <span class="comment">//  to first one.</span>
00746 
00747     <span class="keywordflow">if</span> (<a class="code" href="../../d3/d8/propapi_8h.html#a34">dwFlags</a> &amp; <a class="code" href="../../d6/d7/devprop_8h.html#a1">DEVLIST_ONINIT</a>) {
00748         <a class="code" href="../../d3/d8/propapi_8h.html#a34">dwFlags</a> |= <a class="code" href="../../d6/d7/devprop_8h.html#a3">DEVLIST_NOSELECT</a>;
00749     }
00750 
00751     <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#b1">CDeviceProfileManagement::FillList</a>(dwFlags);
00752 
00753     <span class="comment">//  There is either no default profile, an existing profile is the</span>
00754     <span class="comment">//  default, or a newly selected one is.  Some people just like the</span>
00755     <span class="comment">//  selection operator.</span>
00756 
00757     <span class="comment">//  if there is only 1 profile in list box, we treat it as default profile.</span>
00758         
00759     <span class="keywordflow">if</span> (<a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(m_hwndList,LB_GETCOUNT,0,0) == 1) {
00760         <a class="code" href="../../d6/d5/classCPrinterProfileManagement.html#p0">m_uDefault</a> = (<span class="keywordtype">unsigned</span>)<a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(m_hwndList, LB_GETITEMDATA, 0, 0);
00761     }
00762 
00763     <span class="keywordflow">if</span> (<a class="code" href="../../d6/d5/classCPrinterProfileManagement.html#p0">m_uDefault</a> == -1) {
00764 
00765         <span class="comment">// There is no profile associated for this device.</span>
00766 
00767         <a class="code" href="../../d1/d7/classCString.html">CString</a> csNoProfile;
00768         csNoProfile.<a class="code" href="../../d1/d7/classCString.html#a16">Load</a>(NoProfileString);
00769         <a class="code" href="../../d5/d9/cltxt_8h.html#a20">SetDlgItemText</a>(m_hwnd, DefaultProfile, csNoProfile);            
00770 
00771     } <span class="keywordflow">else</span> {
00772 
00773         <span class="comment">// If the default has been deleted, set default as last in list.</span>
00774 
00775         <span class="keywordflow">if</span> (<a class="code" href="../../d6/d5/classCPrinterProfileManagement.html#p0">m_uDefault</a> &gt;= (<a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p2">m_cpaProfile</a>.<a class="code" href="../../d8/d5/classCProfileArray.html#a2">Count</a>() + <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p1">m_cpaAdds</a>.<a class="code" href="../../d8/d5/classCProfileArray.html#a2">Count</a>())) {
00776 
00777             <a class="code" href="../../d6/d5/classCPrinterProfileManagement.html#p0">m_uDefault</a> = (<a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p2">m_cpaProfile</a>.<a class="code" href="../../d8/d5/classCProfileArray.html#a2">Count</a>() + <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p1">m_cpaAdds</a>.<a class="code" href="../../d8/d5/classCProfileArray.html#a2">Count</a>()) - 1;
00778         }
00779 
00780         <span class="comment">// Put default profile name in UI.</span>
00781 
00782         <a class="code" href="../../d7/d5/classCProfile.html">CProfile</a> *pcpDefault = (<a class="code" href="../../d6/d5/classCPrinterProfileManagement.html#p0">m_uDefault</a> &lt; <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p2">m_cpaProfile</a>.<a class="code" href="../../d8/d5/classCProfileArray.html#a2">Count</a>()) ? \
00783                                            <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p2">m_cpaProfile</a>[<a class="code" href="../../d6/d5/classCPrinterProfileManagement.html#p0">m_uDefault</a>] : \
00784                                            <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p1">m_cpaAdds</a>[<a class="code" href="../../d6/d5/classCPrinterProfileManagement.html#p0">m_uDefault</a> - <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p2">m_cpaProfile</a>.<a class="code" href="../../d8/d5/classCProfileArray.html#a2">Count</a>()];
00785 
00786         <a class="code" href="../../d5/d9/cltxt_8h.html#a20">SetDlgItemText</a>(m_hwnd, DefaultProfile, pcpDefault -&gt; GetName());
00787 
00788         LRESULT idSelect = <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(m_hwndList, LB_FINDSTRINGEXACT,
00789                                    (WPARAM) -1, (LPARAM) (LPCTSTR) pcpDefault -&gt; GetName());
00790 
00791         <span class="comment">// if could not find, just select first item.</span>
00792 
00793         <span class="keywordflow">if</span> (idSelect == LB_ERR) {
00794             idSelect = 0;
00795         }
00796 
00797         <span class="comment">// Select it.</span>
00798 
00799         <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(m_hwndList, LB_SETCURSEL, idSelect, 0);
00800     }
00801 
00802     <span class="comment">//  03-08-1997  Bob_Kjelgaard@Prodigy.Net   Memphis RAID 18420</span>
00803     <span class="comment">//  Disable the Default button if there aren't any profiles</span>
00804 
00805     <span class="keywordflow">if</span> (<a class="code" href="../../d6/d5/classCPrinterProfileManagement.html#p1">m_bManualMode</a> &amp;&amp; <a class="code" href="../../d6/d5/classCPrinterProfileManagement.html#p2">m_bAdminAccess</a>) {
00806         <a class="code" href="../../d3/d8/client_8c.html#a98">EnableWindow</a>(<a class="code" href="../../d3/d9/client_2wow_8c.html#a6">GetDlgItem</a>(m_hwnd, DefaultButton),
00807                      <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p1">m_cpaAdds</a>.<a class="code" href="../../d8/d5/classCProfileArray.html#a2">Count</a>() + <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p2">m_cpaProfile</a>.<a class="code" href="../../d8/d5/classCProfileArray.html#a2">Count</a>() - <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p0">m_cuaRemovals</a>.<a class="code" href="../../d3/d7/classCUintArray.html#a2">Count</a>());
00808     }
00809 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="b0" doxytag="CPrinterProfileManagement::InitList" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void CPrinterProfileManagement::InitList           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [protected, virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Reimplemented from <a class="el" href="../../d2/d2/classCDeviceProfileManagement.html#b0">CDeviceProfileManagement</a>.
<p>
Definition at line <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00732">732</a> of file <a class="el" href="../../d6/d6/devprop_8cpp-source.html">devprop.cpp</a>.
<p>
References <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00275">CProfileArray::Count()</a>, <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00105">CDeviceProfileManagement::InitList()</a>, and <a class="el" href="../../d7/d6/devprop_8h-source.html#l00130">m_uDefault</a>.
<p>
Referenced by <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l01075">OnNotify()</a>.
<p>
<pre class="fragment"><div>00732                                             {
00733 
00734     <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#b0">CDeviceProfileManagement::InitList</a>();
00735 
00736     <a class="code" href="../../d6/d5/classCPrinterProfileManagement.html#p0">m_uDefault</a> = <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p2">m_cpaProfile</a>.<a class="code" href="../../d8/d5/classCProfileArray.html#a2">Count</a>() ? 0 : (<span class="keywordtype">unsigned</span>) -1;
00737 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="CPrinterProfileManagement::OnCommand" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL CPrinterProfileManagement::OnCommand           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">WORD&nbsp;</td>
          <td class="mdname" nowrap> <em>wNotifyCode</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>WORD&nbsp;</td>
          <td class="mdname" nowrap> <em>wid</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>HWND&nbsp;</td>
          <td class="mdname" nowrap> <em>hwndCtl</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Reimplemented from <a class="el" href="../../d2/d2/classCDeviceProfileManagement.html#a3">CDeviceProfileManagement</a>.
<p>
Definition at line <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00950">950</a> of file <a class="el" href="../../d6/d6/devprop_8cpp-source.html">devprop.cpp</a>.
<p>
References <a class="el" href="../../d3/d8/ntgdi_2icm_2icmui_2resource_8h-source.html#l00077">AskRemoveDefault</a>, <a class="el" href="../../d3/d8/ntgdi_2icm_2icmui_2resource_8h-source.html#l00103">AutoSelButton</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00275">CProfileArray::Count()</a>, <a class="el" href="../../d3/d8/ntgdi_2icm_2icmui_2resource_8h-source.html#l00102">DefaultButton</a>, <a class="el" href="../../d7/d6/devprop_8h-source.html#l00066">DEVLIST_CHANGED</a>, <a class="el" href="../../d8/d7/proppage_8h-source.html#l00061">CPropertyPage::EnableApplyButton()</a>, <a class="el" href="../../d4/d7/client_8c-source.html#l03016">EnableWindow()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00741">FillList()</a>, <a class="el" href="../../d4/d8/client_2wow_8c-source.html#l00158">GetDlgItem()</a>, <a class="el" href="../../d7/d6/devprop_8h-source.html#l00131">m_bManualMode</a>, <a class="el" href="../../d7/d6/devprop_8h-source.html#l00130">m_uDefault</a>, <a class="el" href="../../d3/d8/ntgdi_2icm_2icmui_2resource_8h-source.html#l00104">ManualSelButton</a>, <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00950">OnCommand()</a>, <a class="el" href="../../d3/d8/ntgdi_2icm_2icmui_2resource_8h-source.html#l00101">RemoveButton</a>, <a class="el" href="../../d6/d8/cltxt_8h-source.html#l00652">SendMessage()</a>, <a class="el" href="../../d8/d7/proppage_8h-source.html#l00069">CPropertyPage::SettingChanged()</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00950">OnCommand()</a>.
<p>
<pre class="fragment"><div>00951                                                            {
00952 
00953     <span class="keywordflow">switch</span>  (wNotifyCode) {
00954 
00955         <span class="keywordflow">case</span>    LBN_DBLCLK: {
00956 
00957             <span class="comment">//  Retrieve the ID of the new default profile                      </span>
00958             <span class="comment">//  only accept dblclk changes if the dialog</span>
00959             <span class="comment">//  is not read only - i.e. user is admin</span>
00960 
00961             <span class="keywordflow">if</span>  (<a class="code" href="../../d6/d5/classCPrinterProfileManagement.html#p1">m_bManualMode</a>) {
00962 
00963                 <span class="keywordtype">int</span> <span class="keywordtype">id</span> = (<span class="keywordtype">int</span>)<a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(m_hwndList, LB_GETCURSEL, 0, 0);
00964                 <a class="code" href="../../d6/d5/classCPrinterProfileManagement.html#p0">m_uDefault</a> = (<span class="keywordtype">unsigned</span>)<a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(m_hwndList, LB_GETITEMDATA, <span class="keywordtype">id</span>, 0);
00965 
00966                 <span class="comment">//  Change has been made, update the list</span>
00967 
00968                 <a class="code" href="../../d6/d5/classCPrinterProfileManagement.html#b1">FillList</a>(DEVLIST_CHANGED);
00969             }
00970 
00971             <span class="keywordflow">return</span>  <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00972         }
00973 
00974         <span class="keywordflow">case</span>    BN_CLICKED:
00975 
00976             <span class="keywordflow">switch</span>  (wid) {
00977 
00978                 <span class="keywordflow">case</span>    <a class="code" href="../../d2/d9/ntgdi_2icm_2icmui_2resource_8h.html#a60">AutoSelButton</a>:
00979                 <span class="keywordflow">case</span>    <a class="code" href="../../d2/d9/ntgdi_2icm_2icmui_2resource_8h.html#a61">ManualSelButton</a>: {
00980 
00981                     <span class="comment">// How many profile in listbox ?</span>
00982 
00983                     LRESULT itemCount = <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(m_hwndList, LB_GETCOUNT, 0, 0);
00984                     <span class="keywordflow">if</span> (itemCount == LB_ERR) itemCount = 0;
00985 
00986                     <a class="code" href="../../d6/d5/classCPrinterProfileManagement.html#p1">m_bManualMode</a> = (wid == <a class="code" href="../../d2/d9/ntgdi_2icm_2icmui_2resource_8h.html#a61">ManualSelButton</a>) ? <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> : <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00987 
00988                     <span class="comment">//  Only with manual mode, these controls are enabled.</span>
00989 
00990                     <a class="code" href="../../d3/d8/client_8c.html#a98">EnableWindow</a>(<a class="code" href="../../d3/d9/client_2wow_8c.html#a6">GetDlgItem</a>(m_hwnd, DefaultButton), m_bManualMode &amp;&amp; itemCount);
00991 
00992                     <span class="comment">//  Configuarion has been changed, enable apply button.</span>
00993 
00994                     <a class="code" href="../../d2/d6/classCPropertyPage.html#a3">EnableApplyButton</a>();
00995                     <a class="code" href="../../d2/d6/classCPropertyPage.html#a5">SettingChanged</a>(TRUE);
00996 
00997                     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00998                 }
00999 
01000                 <span class="keywordflow">case</span>    <a class="code" href="../../d2/d9/ntgdi_2icm_2icmui_2resource_8h.html#a58">RemoveButton</a>: {
01001 
01002                     <span class="comment">//  Make sure we've tracked the default profile correctly</span>
01003                     <span class="comment">//  when a profile is removed.</span>
01004                     <span class="comment">//  All cases break, because we then want the base class to</span>
01005                     <span class="comment">//  process this message.</span>
01006 
01007                     LRESULT <span class="keywordtype">id</span> = <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(m_hwndList, LB_GETCURSEL, 0, 0);
01008 
01009                     <span class="keywordtype">unsigned</span> uTarget = (<span class="keywordtype">unsigned</span>)<a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(m_hwndList, LB_GETITEMDATA,
01010                         <span class="keywordtype">id</span>, 0);
01011 
01012                     <span class="keywordflow">if</span>  (uTarget &gt; <a class="code" href="../../d6/d5/classCPrinterProfileManagement.html#p0">m_uDefault</a> || <a class="code" href="../../d6/d5/classCPrinterProfileManagement.html#p0">m_uDefault</a> == (<span class="keywordtype">unsigned</span>) -1)
01013                         <span class="keywordflow">break</span>;  <span class="comment">//  Nothing here to worry about</span>
01014 
01015                     <span class="keywordflow">if</span>  (<a class="code" href="../../d6/d5/classCPrinterProfileManagement.html#p0">m_uDefault</a> == uTarget) {
01016 
01017                         <span class="keywordflow">if</span> (<a class="code" href="../../d0/d3/classCGlobals.html#e7">CGlobals::ReportEx</a>(AskRemoveDefault, m_hwnd, FALSE,
01018                                                MB_YESNO|MB_ICONEXCLAMATION,0) == IDYES) {
01019 
01020                             <span class="comment">//  The default has been deleted- the profile</span>
01021                             <span class="comment">//  at the top of monitor profile list will be</span>
01022                             <span class="comment">//  made the default profile, if we have</span>
01023 
01024                             LRESULT itemCount = <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(m_hwndList, LB_GETCOUNT, 0, 0);
01025 
01026                             <span class="keywordflow">if</span> ((itemCount != LB_ERR) &amp;&amp; (itemCount &gt; 1)) {
01027                                 <a class="code" href="../../d6/d5/classCPrinterProfileManagement.html#p0">m_uDefault</a> = (<span class="keywordtype">unsigned</span>)<a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(m_hwndList, LB_GETITEMDATA, 0, 0);
01028                                 <span class="keywordflow">if</span> (<a class="code" href="../../d6/d5/classCPrinterProfileManagement.html#p0">m_uDefault</a> == uTarget) {
01029                                     <a class="code" href="../../d6/d5/classCPrinterProfileManagement.html#p0">m_uDefault</a> = (<span class="keywordtype">unsigned</span>)<a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(m_hwndList, LB_GETITEMDATA, 1, 0);
01030                                 }
01031                             } <span class="keywordflow">else</span> {
01032                                 <a class="code" href="../../d6/d5/classCPrinterProfileManagement.html#p0">m_uDefault</a> = -1;
01033                             }
01034 
01035                             <span class="keywordflow">break</span>;
01036                         } <span class="keywordflow">else</span> {
01037                             <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>; <span class="comment">// opration cancelled.</span>
01038                         }
01039                     }
01040 
01041                     <span class="keywordflow">if</span>  (uTarget &lt; <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p2">m_cpaProfile</a>.<a class="code" href="../../d8/d5/classCProfileArray.html#a2">Count</a>())
01042                         <span class="keywordflow">break</span>;  <span class="comment">// We're fine</span>
01043 
01044                     <span class="comment">//  Must be an added profile below us in the list was</span>
01045                     <span class="comment">//  zapped- we need to decrement ourselves.</span>
01046 
01047                     <a class="code" href="../../d6/d5/classCPrinterProfileManagement.html#p0">m_uDefault</a>--;
01048                     <span class="keywordflow">break</span>;
01049                 }
01050 
01051                 <span class="keywordflow">case</span>    <a class="code" href="../../d2/d9/ntgdi_2icm_2icmui_2resource_8h.html#a59">DefaultButton</a>: {
01052 
01053                     LRESULT <span class="keywordtype">id</span> = <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(m_hwndList, LB_GETCURSEL, 0, 0);
01054 
01055                     <a class="code" href="../../d6/d5/classCPrinterProfileManagement.html#p0">m_uDefault</a> = (<span class="keywordtype">unsigned</span>)<a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(m_hwndList, LB_GETITEMDATA, <span class="keywordtype">id</span>, 0);
01056 
01057                     <span class="comment">//  Change has been made, update the list</span>
01058 
01059                     <a class="code" href="../../d6/d5/classCPrinterProfileManagement.html#b1">FillList</a>(DEVLIST_CHANGED);
01060 
01061                     <span class="keywordflow">return</span>  <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01062                 }
01063             }
01064 
01065         <span class="comment">//  Deliberate fall-through (use a break if you add a case here)</span>
01066     }
01067 
01068     <span class="comment">//  Use common command handling if not handled above</span>
01069 
01070     <span class="keywordflow">return</span>  <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#a3">CDeviceProfileManagement::OnCommand</a>(wNotifyCode, wid, hwndCtl);
01071 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a6" doxytag="CPrinterProfileManagement::OnContextMenu" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL CPrinterProfileManagement::OnContextMenu           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HWND&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>hwnd</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Reimplemented from <a class="el" href="../../d2/d6/classCPropertyPage.html#a12">CPropertyPage</a>.
<p>
Definition at line <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l01186">1186</a> of file <a class="el" href="../../d6/d6/devprop_8cpp-source.html">devprop.cpp</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l01186">OnContextMenu()</a>, <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00710">PrinterUIHelpIds</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, and <a class="el" href="../../d4/d8/icmuihlp_8h-source.html#l00010">WINDOWS_HELP_FILE</a>.
<p>
Referenced by <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l01186">OnContextMenu()</a>.
<p>
<pre class="fragment"><div>01186                                                           {
01187 
01188     WinHelp(hwnd, WINDOWS_HELP_FILE,
01189             HELP_CONTEXTMENU, (ULONG_PTR) (LPSTR) PrinterUIHelpIds);
01190 
01191     <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
01192 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a5" doxytag="CPrinterProfileManagement::OnHelp" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL CPrinterProfileManagement::OnHelp           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">LPHELPINFO&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>pHelp</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Reimplemented from <a class="el" href="../../d2/d6/classCPropertyPage.html#a11">CPropertyPage</a>.
<p>
Definition at line <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l01176">1176</a> of file <a class="el" href="../../d6/d6/devprop_8cpp-source.html">devprop.cpp</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l01176">OnHelp()</a>, <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00710">PrinterUIHelpIds</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, and <a class="el" href="../../d4/d8/icmuihlp_8h-source.html#l00010">WINDOWS_HELP_FILE</a>.
<p>
Referenced by <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l01176">OnHelp()</a>.
<p>
<pre class="fragment"><div>01176                                                           {
01177 
01178     <span class="keywordflow">if</span> (pHelp-&gt;iContextType == HELPINFO_WINDOW) {
01179         WinHelp((HWND) pHelp-&gt;hItemHandle, WINDOWS_HELP_FILE,
01180                 HELP_WM_HELP, (ULONG_PTR) (LPSTR) PrinterUIHelpIds);
01181     }
01182 
01183     <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
01184 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a2" doxytag="CPrinterProfileManagement::OnInit" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL CPrinterProfileManagement::OnInit           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Reimplemented from <a class="el" href="../../d2/d2/classCDeviceProfileManagement.html#a2">CDeviceProfileManagement</a>.
<p>
Definition at line <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00822">822</a> of file <a class="el" href="../../d6/d6/devprop_8cpp-source.html">devprop.cpp</a>.
<p>
References <a class="el" href="../../d3/d8/ntgdi_2icm_2icmui_2resource_8h-source.html#l00100">AddButton</a>, <a class="el" href="../../d3/d8/ntgdi_2icm_2icmui_2resource_8h-source.html#l00103">AutoSelButton</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d0/d7/halvprnt_8c-source.html#l00031">BYTE</a>, <a class="el" href="../../d5/d8/nt6_2dlgmgr_8c-source.html#l00306">CheckDlgButton()</a>, <a class="el" href="../../d3/d8/ntgdi_2icm_2icmui_2resource_8h-source.html#l00102">DefaultButton</a>, <a class="el" href="../../d3/d8/ntgdi_2icm_2icmui_2resource_8h-source.html#l00117">DefaultProfile</a>, <a class="el" href="../../d3/d8/ntgdi_2icm_2icmui_2resource_8h-source.html#l00118">DefaultProfileText</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d4/d7/client_8c-source.html#l03016">EnableWindow()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d4/d8/client_2wow_8c-source.html#l00158">GetDlgItem()</a>, <a class="el" href="../../d0/d7/profman_8c-source.html#l05961">InternalGetDeviceConfig()</a>, <a class="el" href="../../d7/d6/devprop_8h-source.html#l00132">m_bAdminAccess</a>, <a class="el" href="../../d7/d6/devprop_8h-source.html#l00133">m_bLocalPrinter</a>, <a class="el" href="../../d7/d6/devprop_8h-source.html#l00131">m_bManualMode</a>, <a class="el" href="../../d3/d8/ntgdi_2icm_2icmui_2resource_8h-source.html#l00104">ManualSelButton</a>, <a class="el" href="../../d4/d8/arcinst_8c-source.html#l00065">MAX_PATH</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00337">CDeviceProfileManagement::OnInit()</a>, <a class="el" href="../../d0/d7/halvprnt_8c-source.html#l00031">PBYTE</a>, <a class="el" href="../../d4/d7/aug98_2test_2main_8c-source.html#l00106">pd</a>, <a class="el" href="../../d3/d8/ntgdi_2icm_2icmui_2resource_8h-source.html#l00101">RemoveButton</a>, <a class="el" href="../../d6/d8/cltxt_8h-source.html#l00652">SendMessage()</a>, <a class="el" href="../../d4/d9/user32_8def-source.html#l00348">SetFocus</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
<pre class="fragment"><div>00822                                           {
00823 
00824     <span class="comment">//  Call the base class routine first, as it does most of the work...</span>
00825 
00826     <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#a2">CDeviceProfileManagement::OnInit</a>();
00827 
00828     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> dwSize = <span class="keyword">sizeof</span>(<a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>);
00829 
00830     <span class="comment">//  Query current mode.</span>
00831 
00832     <span class="keywordflow">if</span> (!<a class="code" href="../../d9/d7/profman_8c.html#a97">InternalGetDeviceConfig</a>((LPCTSTR)m_csDevice, CLASS_PRINTER,
00833                                  MSCMS_PROFILE_ENUM_MODE, &amp;m_bManualMode, &amp;dwSize)) {
00834 
00835         <span class="comment">//  Auto selection mode as default.</span>
00836 
00837         <a class="code" href="../../d6/d5/classCPrinterProfileManagement.html#p1">m_bManualMode</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00838     }
00839 
00840     <span class="comment">//  Now, see if we have sufficient authority to administer the printer</span>
00841 
00842     HANDLE  hPrinter;
00843     PRINTER_DEFAULTS    <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a26">pd</a> = {<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>, <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>, PRINTER_ACCESS_ADMINISTER};
00844 
00845     <a class="code" href="../../d6/d5/classCPrinterProfileManagement.html#p2">m_bAdminAccess</a>  = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00846     <a class="code" href="../../d6/d5/classCPrinterProfileManagement.html#p3">m_bLocalPrinter</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00847 
00848     <span class="keywordflow">if</span>  (OpenPrinter(const_cast&lt;LPTSTR&gt; ((LPCTSTR) m_csDevice), &amp;hPrinter, &amp;pd)) {
00849 
00850         <span class="comment">//  We can administer the printer- proceed in the normal way.</span>
00851 
00852 <span class="preprocessor">#if !defined(_WIN95_)</span>
00853 <span class="preprocessor"></span>
00854         <span class="comment">//  If the printer is "Network Printer", we don't allow user to install</span>
00855         <span class="comment">//  or uninstall color profile.</span>
00856 
00857         <a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a>  StackPrinterData[<span class="keyword">sizeof</span>(PRINTER_INFO_4)+<a class="code" href="../../d3/d9/arcinst_8c.html#a6">MAX_PATH</a>*2];
00858         <a class="code" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a> pPrinterData = StackPrinterData;
00859         <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>  bSuccess = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00860         <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> dwReturned;
00861 
00862         <span class="keywordflow">if</span> (!GetPrinter(hPrinter, 4, pPrinterData, <span class="keyword">sizeof</span>(StackPrinterData), &amp;dwReturned)) {
00863 
00864             <span class="keywordflow">if</span> ((GetLastError() == ERROR_INSUFFICIENT_BUFFER) &amp;&amp;
00865                 (pPrinterData = (<a class="code" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a>) LocalAlloc(LPTR, dwReturned))) {
00866 
00867                 <span class="keywordflow">if</span> (GetPrinter(hPrinter, 4, pPrinterData, dwReturned, &amp;dwReturned)) {
00868 
00869                     bSuccess = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00870 
00871                 }
00872             }
00873 
00874         } <span class="keywordflow">else</span> {
00875 
00876             bSuccess = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00877         }
00878        
00879         <span class="keywordflow">if</span> (bSuccess)
00880         {
00881             <a class="code" href="../../d6/d5/classCPrinterProfileManagement.html#p3">m_bLocalPrinter</a> = ((PRINTER_INFO_4 *)pPrinterData)-&gt;pServerName ? <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a> : <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00882         }
00883         <span class="keywordflow">else</span>
00884         {
00885             <a class="code" href="../../d6/d5/classCPrinterProfileManagement.html#p2">m_bAdminAccess</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00886         }
00887 
00888         <span class="keywordflow">if</span> (pPrinterData &amp;&amp; (pPrinterData != StackPrinterData))
00889         {
00890             LocalFree(pPrinterData);
00891         }
00892 
00893 <span class="preprocessor">#endif // !defined(_WIN95_)</span>
00894 <span class="preprocessor"></span>
00895         ClosePrinter(hPrinter);
00896 
00897     } <span class="keywordflow">else</span> {
00898 
00899         <a class="code" href="../../d6/d5/classCPrinterProfileManagement.html#p2">m_bAdminAccess</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00900     }
00901 
00902     <span class="comment">// How many profile in listbox ?</span>
00903 
00904     LRESULT itemCount = <a class="code" href="../../d5/d9/cltxt_8h.html#a16">SendMessage</a>(m_hwndList, LB_GETCOUNT, 0, 0);
00905     <span class="keywordflow">if</span> (itemCount == LB_ERR) itemCount = 0;
00906 
00907     <span class="comment">//  make sure the ancestor list code behaves correctly.</span>
00908     <span class="comment">//  You need Admin Access and a Local Printer to be able to add/remove profiles</span>
00909 
00910     <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p6">m_bReadOnly</a> = !(<a class="code" href="../../d6/d5/classCPrinterProfileManagement.html#p2">m_bAdminAccess</a> &amp;&amp; <a class="code" href="../../d6/d5/classCPrinterProfileManagement.html#p3">m_bLocalPrinter</a>);
00911 
00912     <span class="comment">//  Enable/Disable the controls (if needed)</span>
00913 
00914     <a class="code" href="../../d4/d9/nt6_2dlgmgr_8c.html#a15">CheckDlgButton</a>(m_hwnd, AutoSelButton, m_bManualMode ? BST_UNCHECKED : BST_CHECKED);
00915     <a class="code" href="../../d4/d9/nt6_2dlgmgr_8c.html#a15">CheckDlgButton</a>(m_hwnd, ManualSelButton, m_bManualMode ? BST_CHECKED : BST_UNCHECKED);
00916 
00917     <span class="comment">//  Only administrator can change 'auto','manual' configuration.</span>
00918 
00919     <a class="code" href="../../d3/d8/client_8c.html#a98">EnableWindow</a>(<a class="code" href="../../d3/d9/client_2wow_8c.html#a6">GetDlgItem</a>(m_hwnd, AutoSelButton), m_bAdminAccess &amp;&amp; m_bLocalPrinter);
00920     <a class="code" href="../../d3/d8/client_8c.html#a98">EnableWindow</a>(<a class="code" href="../../d3/d9/client_2wow_8c.html#a6">GetDlgItem</a>(m_hwnd, ManualSelButton), m_bAdminAccess &amp;&amp; m_bLocalPrinter);
00921 
00922     <span class="comment">//  Only administrator and printer is at local, can install/uninstall color profile.</span>
00923 
00924     <a class="code" href="../../d3/d8/client_8c.html#a98">EnableWindow</a>(<a class="code" href="../../d3/d9/client_2wow_8c.html#a6">GetDlgItem</a>(m_hwnd, AddButton), m_bAdminAccess &amp;&amp; m_bLocalPrinter);
00925     <a class="code" href="../../d3/d8/client_8c.html#a98">EnableWindow</a>(<a class="code" href="../../d3/d9/client_2wow_8c.html#a6">GetDlgItem</a>(m_hwnd, RemoveButton), m_bAdminAccess &amp;&amp; m_bLocalPrinter &amp;&amp; itemCount);
00926 
00927     <a class="code" href="../../d3/d8/client_8c.html#a98">EnableWindow</a>(m_hwndList, m_bAdminAccess);
00928     <a class="code" href="../../d3/d8/client_8c.html#a98">EnableWindow</a>(<a class="code" href="../../d3/d9/client_2wow_8c.html#a6">GetDlgItem</a>(m_hwnd, DefaultProfileText), m_bAdminAccess);
00929     <a class="code" href="../../d3/d8/client_8c.html#a98">EnableWindow</a>(<a class="code" href="../../d3/d9/client_2wow_8c.html#a6">GetDlgItem</a>(m_hwnd, DefaultProfile), m_bAdminAccess);
00930 
00931     <span class="comment">//  Only with manual mode, these controls are enabled.</span>
00932 
00933     <a class="code" href="../../d3/d8/client_8c.html#a98">EnableWindow</a>(<a class="code" href="../../d3/d9/client_2wow_8c.html#a6">GetDlgItem</a>(m_hwnd, DefaultButton), m_bAdminAccess &amp;&amp; m_bManualMode
00934                                                          &amp;&amp; m_bLocalPrinter &amp;&amp; itemCount);
00935 
00936     <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d5/classCPrinterProfileManagement.html#p2">m_bAdminAccess</a>) {
00937 
00938         <span class="comment">//  Set the focus to the OK button</span>
00939 
00940         <a class="code" href="../../d3/d0/user32_8def.html#a43">SetFocus</a>(<a class="code" href="../../d3/d9/client_2wow_8c.html#a6">GetDlgItem</a>(m_hwndSheet, IDOK));
00941         <span class="keywordflow">return</span>  <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;  <span class="comment">//  Because we moved the focus!</span>
00942     }
00943 
00944     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00945 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a4" doxytag="CPrinterProfileManagement::OnNotify" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL CPrinterProfileManagement::OnNotify           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>idCtrl</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPNMHDR&nbsp;</td>
          <td class="mdname" nowrap> <em>pnmh</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Reimplemented from <a class="el" href="../../d2/d2/classCDeviceProfileManagement.html#a4">CDeviceProfileManagement</a>.
<p>
Definition at line <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l01075">1075</a> of file <a class="el" href="../../d6/d6/devprop_8cpp-source.html">devprop.cpp</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d5/d6/stringar_8h-source.html#l00134">CUintArray::Count()</a>, <a class="el" href="../../d4/d6/icmui_2profile_8h-source.html#l00275">CProfileArray::Count()</a>, <a class="el" href="../../d8/d7/proppage_8h-source.html#l00065">CPropertyPage::DisableApplyButton()</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00741">FillList()</a>, <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00732">InitList()</a>, <a class="el" href="../../d0/d7/profman_8c-source.html#l06030">InternalSetDeviceConfig()</a>, <a class="el" href="../../d7/d6/devprop_8h-source.html#l00131">m_bManualMode</a>, <a class="el" href="../../d7/d6/devprop_8h-source.html#l00130">m_uDefault</a>, <a class="el" href="../../d3/d8/ntgdi_2icm_2icmui_2resource_8h-source.html#l00052">NoDefaultProfile</a>, <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l01075">OnNotify()</a>, <a class="el" href="../../d8/d7/proppage_8h-source.html#l00069">CPropertyPage::SettingChanged()</a>, <a class="el" href="../../d6/d8/cltxt_8h-source.html#l00408">SetWindowLongPtr()</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l01075">OnNotify()</a>.
<p>
<pre class="fragment"><div>01075                                                                     {
01076 
01077     <span class="keywordflow">switch</span>  (pnmh -&gt; code) {
01078 
01079         <span class="keywordflow">case</span>    PSN_APPLY: {
01080 
01081             <a class="code" href="../../d2/d6/classCPropertyPage.html#a4">DisableApplyButton</a>();
01082 
01083             <span class="comment">//  If nothing changed, nothing need to do.</span>
01084 
01085             <span class="keywordflow">if</span> (!<a class="code" href="../../d2/d6/classCPropertyPage.html#a5">SettingChanged</a>())
01086                 <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01087 
01088             <span class="keywordflow">if</span> (<a class="code" href="../../d6/d5/classCPrinterProfileManagement.html#p1">m_bManualMode</a>) {
01089 
01090                 <span class="comment">//  If the user hasn't selected a default, and we have</span>
01091                 <span class="comment">//  associated profiles, then we can't allow this.</span>
01092 
01093                 <span class="comment">//  03-08-1997  A-RobKj Fix for Memphis RAID 18416- if there's</span>
01094                 <span class="comment">//  only one profile left, then it must be the default.</span>
01095 
01096                 <span class="keywordflow">if</span>  (<a class="code" href="../../d6/d5/classCPrinterProfileManagement.html#p0">m_uDefault</a> == (<span class="keywordtype">unsigned</span>) -1 &amp;&amp; (<a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p1">m_cpaAdds</a>.<a class="code" href="../../d8/d5/classCProfileArray.html#a2">Count</a>() +
01097                      <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p2">m_cpaProfile</a>.<a class="code" href="../../d8/d5/classCProfileArray.html#a2">Count</a>() - <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p0">m_cuaRemovals</a>.<a class="code" href="../../d3/d7/classCUintArray.html#a2">Count</a>()) &gt; 1) {
01098 
01099                     <a class="code" href="../../d0/d3/classCGlobals.html#e6">CGlobals::Report</a>(NoDefaultProfile, m_hwndSheet);
01100                     <a class="code" href="../../d5/d9/cltxt_8h.html#a12">SetWindowLongPtr</a>(m_hwnd, DWLP_MSGRESULT, PSNRET_INVALID_NOCHANGEPAGE);
01101                     <span class="keywordflow">break</span>;
01102                 }
01103 
01104                 <span class="comment">//  !!! This behavior is hardly depend on EnumColorProfiles() API !!!</span>
01105 
01106                 <span class="comment">//  OK, if the default profile has changed, we have to delete default</span>
01107                 <span class="comment">//  profile associations, and do the association for default profile</span>
01108                 <span class="comment">//  in "last".</span>
01109 
01110                 <span class="comment">//  Let the base class handle the cases where the default hasn't</span>
01111                 <span class="comment">//  changed, or we started with no profiles and still have none.</span>
01112                 <span class="comment">//</span>
01113                 <span class="comment">//  03-08-1997  Sleazy code note.  The case where no default is</span>
01114                 <span class="comment">//  selected but only one is assigned will now fall here.  Since the</span>
01115                 <span class="comment">//  default happens to be the "last", and there only is one, letting</span>
01116                 <span class="comment">//  the base class handle it is not a problem.  The list filling</span>
01117                 <span class="comment">//  code will take care of the rest for us.</span>
01118 
01119                 <span class="keywordflow">if</span>  (<a class="code" href="../../d6/d5/classCPrinterProfileManagement.html#p0">m_uDefault</a> == (<span class="keywordtype">unsigned</span>) -1) <span class="keywordflow">break</span>;
01120 
01121                 <span class="comment">//  Remove default first (if default is associated), then associate later.</span>
01122 
01123                 <span class="keywordflow">if</span>  (<a class="code" href="../../d6/d5/classCPrinterProfileManagement.html#p0">m_uDefault</a> &lt; <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p2">m_cpaProfile</a>.<a class="code" href="../../d8/d5/classCProfileArray.html#a2">Count</a>())
01124                     <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p2">m_cpaProfile</a>[<a class="code" href="../../d6/d5/classCPrinterProfileManagement.html#p0">m_uDefault</a>] -&gt; Dissociate(m_csDevice);
01125 
01126                 <span class="comment">//  Now do the other removals (actually just dissociations)</span>
01127 
01128                 <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> u = 0; u &lt; <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p0">m_cuaRemovals</a>.<a class="code" href="../../d3/d7/classCUintArray.html#a2">Count</a>(); u++) {
01129                     <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p2">m_cpaProfile</a>[<a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p0">m_cuaRemovals</a>[u]] -&gt; Dissociate(m_csDevice);
01130                 }
01131 
01132                 <span class="comment">//  Add in the new ones</span>
01133 
01134                 <span class="keywordflow">for</span> (u = 0; u &lt; <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p1">m_cpaAdds</a>.<a class="code" href="../../d8/d5/classCProfileArray.html#a2">Count</a>(); u++) {
01135                     <span class="keywordflow">if</span>  (<a class="code" href="../../d6/d5/classCPrinterProfileManagement.html#p0">m_uDefault</a> &gt;= <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p2">m_cpaProfile</a>.<a class="code" href="../../d8/d5/classCProfileArray.html#a2">Count</a>())
01136                         <span class="keywordflow">if</span>  (u == (<a class="code" href="../../d6/d5/classCPrinterProfileManagement.html#p0">m_uDefault</a> - <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p2">m_cpaProfile</a>.<a class="code" href="../../d8/d5/classCProfileArray.html#a2">Count</a>()))
01137                             <span class="keywordflow">continue</span>;   <span class="comment">// this is default, will be done later</span>
01138 
01139                     <span class="comment">//  OK, add it back in...</span>
01140                     <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p1">m_cpaAdds</a>[u] -&gt; Associate(m_csDevice);
01141                 }
01142 
01143                 <span class="comment">//  Finally, associate back default profile.</span>
01144 
01145                 <span class="keywordflow">if</span>  (<a class="code" href="../../d6/d5/classCPrinterProfileManagement.html#p0">m_uDefault</a> &lt; <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p2">m_cpaProfile</a>.<a class="code" href="../../d8/d5/classCProfileArray.html#a2">Count</a>())
01146                     <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p2">m_cpaProfile</a>[<a class="code" href="../../d6/d5/classCPrinterProfileManagement.html#p0">m_uDefault</a>] -&gt; Associate(m_csDevice);
01147                 <span class="keywordflow">else</span>
01148                     <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p1">m_cpaAdds</a>[<a class="code" href="../../d6/d5/classCPrinterProfileManagement.html#p0">m_uDefault</a> - <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#p2">m_cpaProfile</a>.<a class="code" href="../../d8/d5/classCProfileArray.html#a2">Count</a>()] -&gt; Associate(m_csDevice);
01149 
01150                 <span class="comment">//  Update the various working structures...</span>
01151 
01152                 <a class="code" href="../../d6/d5/classCPrinterProfileManagement.html#b0">InitList</a>();
01153                 <a class="code" href="../../d6/d5/classCPrinterProfileManagement.html#b1">FillList</a>();
01154 
01155                 <a class="code" href="../../d5/d9/cltxt_8h.html#a12">SetWindowLongPtr</a>(m_hwnd, DWLP_MSGRESULT, PSNRET_NOERROR);
01156 
01157                 <span class="comment">//  Now, we have updated settings.</span>
01158 
01159                 <a class="code" href="../../d2/d6/classCPropertyPage.html#a5">SettingChanged</a>(FALSE);
01160             }
01161 
01162             <span class="comment">// Update "auto/manual" status.</span>
01163 
01164             <a class="code" href="../../d9/d7/profman_8c.html#a98">InternalSetDeviceConfig</a>((LPCTSTR)m_csDevice, CLASS_PRINTER,
01165                                     MSCMS_PROFILE_ENUM_MODE, &amp;m_bManualMode, <span class="keyword">sizeof</span>(DWORD));
01166         }
01167     }
01168 
01169     <span class="comment">//  Let the base class handle everything else</span>
01170 
01171     <span class="keywordflow">return</span>  <a class="code" href="../../d2/d2/classCDeviceProfileManagement.html#a4">CDeviceProfileManagement::OnNotify</a>(idCtrl, pnmh);
01172 }
</div></pre>    </td>
  </tr>
</table>
<hr><h2>Member Data Documentation</h2>
<a class="anchor" name="p2" doxytag="CPrinterProfileManagement::m_bAdminAccess" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL <a class="el" href="../../d6/d5/classCPrinterProfileManagement.html#p2">CPrinterProfileManagement::m_bAdminAccess</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d6/devprop_8h-source.html#l00132">132</a> of file <a class="el" href="../../d7/d6/devprop_8h-source.html">devprop.h</a>.
<p>
Referenced by <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00741">FillList()</a>, and <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00822">OnInit()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="p3" doxytag="CPrinterProfileManagement::m_bLocalPrinter" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL <a class="el" href="../../d6/d5/classCPrinterProfileManagement.html#p3">CPrinterProfileManagement::m_bLocalPrinter</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d6/devprop_8h-source.html#l00133">133</a> of file <a class="el" href="../../d7/d6/devprop_8h-source.html">devprop.h</a>.
<p>
Referenced by <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00822">OnInit()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="p1" doxytag="CPrinterProfileManagement::m_bManualMode" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL <a class="el" href="../../d6/d5/classCPrinterProfileManagement.html#p1">CPrinterProfileManagement::m_bManualMode</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d6/devprop_8h-source.html#l00131">131</a> of file <a class="el" href="../../d7/d6/devprop_8h-source.html">devprop.h</a>.
<p>
Referenced by <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00741">FillList()</a>, <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00950">OnCommand()</a>, <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00822">OnInit()</a>, and <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l01075">OnNotify()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="p0" doxytag="CPrinterProfileManagement::m_uDefault" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> unsigned <a class="el" href="../../d6/d5/classCPrinterProfileManagement.html#p0">CPrinterProfileManagement::m_uDefault</a><code> [protected]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d6/devprop_8h-source.html#l00130">130</a> of file <a class="el" href="../../d7/d6/devprop_8h-source.html">devprop.h</a>.
<p>
Referenced by <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00741">FillList()</a>, <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00732">InitList()</a>, <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l00950">OnCommand()</a>, and <a class="el" href="../../d6/d6/devprop_8cpp-source.html#l01075">OnNotify()</a>.    </td>
  </tr>
</table>
<hr>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="../../d7/d6/devprop_8h-source.html">devprop.h</a><li><a class="el" href="../../d6/d6/devprop_8cpp-source.html">devprop.cpp</a></ul>
<hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:46:27 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
