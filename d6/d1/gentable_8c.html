<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: gentable.c File Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>gentable.c File Reference</h1><code>#include &lt;nt.h&gt;</code><br>
<code>#include &lt;ntrtl.h&gt;</code><br>

<p>
<a href="../../d7/d0/gentable_8c-source.html">Go to the source code of this file.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Classes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d8/struct__TABLE__ENTRY__HEADER.html">_TABLE_ENTRY_HEADER</a></td></tr>

<tr><td colspan=2><br><h2>Typedefs</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d3/d8/struct__TABLE__ENTRY__HEADER.html">_TABLE_ENTRY_HEADER</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d1/gentable_8c.html#a0">TABLE_ENTRY_HEADER</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d3/d8/struct__TABLE__ENTRY__HEADER.html">_TABLE_ENTRY_HEADER</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d1/gentable_8c.html#a1">PTABLE_ENTRY_HEADER</a></td></tr>

<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>TABLE_SEARCH_RESULT&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d1/gentable_8c.html#a2">FindNodeOrParent</a> (IN PRTL_GENERIC_TABLE Table, IN PVOID <a class="el" href="../../d8/d6/ttri_8c.html#a3">Buffer</a>, OUT PRTL_SPLAY_LINKS *NodeOrParent)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d1/gentable_8c.html#a3">RtlInitializeGenericTable</a> (IN PRTL_GENERIC_TABLE Table, IN PRTL_GENERIC_COMPARE_ROUTINE CompareRoutine, IN PRTL_GENERIC_ALLOCATE_ROUTINE AllocateRoutine, IN PRTL_GENERIC_FREE_ROUTINE FreeRoutine, IN PVOID TableContext)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>PVOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d1/gentable_8c.html#a4">RtlInsertElementGenericTable</a> (IN PRTL_GENERIC_TABLE Table, IN PVOID <a class="el" href="../../d8/d6/ttri_8c.html#a3">Buffer</a>, IN CLONG <a class="el" href="../../d7/d2/rtqval_8c.html#a7">BufferSize</a>, OUT PBOOLEAN NewElement OPTIONAL)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>PVOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d1/gentable_8c.html#a5">RtlInsertElementGenericTableFull</a> (IN PRTL_GENERIC_TABLE Table, IN PVOID <a class="el" href="../../d8/d6/ttri_8c.html#a3">Buffer</a>, IN CLONG <a class="el" href="../../d7/d2/rtqval_8c.html#a7">BufferSize</a>, OUT PBOOLEAN NewElement OPTIONAL, PVOID NodeOrParent, TABLE_SEARCH_RESULT SearchResult)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d1/gentable_8c.html#a6">RtlDeleteElementGenericTable</a> (IN PRTL_GENERIC_TABLE Table, IN PVOID <a class="el" href="../../d8/d6/ttri_8c.html#a3">Buffer</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>PVOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d1/gentable_8c.html#a7">RtlLookupElementGenericTable</a> (IN PRTL_GENERIC_TABLE Table, IN PVOID <a class="el" href="../../d8/d6/ttri_8c.html#a3">Buffer</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>PVOID NTAPI&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d1/gentable_8c.html#a8">RtlLookupElementGenericTableFull</a> (PRTL_GENERIC_TABLE Table, PVOID <a class="el" href="../../d8/d6/ttri_8c.html#a3">Buffer</a>, OUT PVOID *NodeOrParent, OUT TABLE_SEARCH_RESULT *SearchResult)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>PVOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d1/gentable_8c.html#a9">RtlEnumerateGenericTable</a> (IN PRTL_GENERIC_TABLE Table, IN BOOLEAN Restart)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d1/gentable_8c.html#a10">RtlIsGenericTableEmpty</a> (IN PRTL_GENERIC_TABLE Table)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>PVOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d1/gentable_8c.html#a11">RtlGetElementGenericTable</a> (IN PRTL_GENERIC_TABLE Table, IN ULONG I)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d1/gentable_8c.html#a12">RtlNumberGenericTableElements</a> (IN PRTL_GENERIC_TABLE Table)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>PVOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d1/gentable_8c.html#a13">RtlEnumerateGenericTableWithoutSplaying</a> (IN PRTL_GENERIC_TABLE Table, IN PVOID *RestartKey)</td></tr>

</table>
<hr><h2>Typedef Documentation</h2>
<a class="anchor" name="a1" doxytag="gentable.c::PTABLE_ENTRY_HEADER" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d3/d8/struct__TABLE__ENTRY__HEADER.html">_TABLE_ENTRY_HEADER</a> * <a class="el" href="../../d3/d8/struct__TABLE__ENTRY__HEADER.html">PTABLE_ENTRY_HEADER</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d7/d0/gentable_8c-source.html#l00064">FindNodeOrParent()</a>, <a class="el" href="../../d7/d0/gentable_8c-source.html#l00532">RtlDeleteElementGenericTable()</a>, <a class="el" href="../../d7/d0/gentable_8c-source.html#l00738">RtlEnumerateGenericTable()</a>, <a class="el" href="../../d7/d0/gentable_8c-source.html#l01110">RtlEnumerateGenericTableWithoutSplaying()</a>, <a class="el" href="../../d7/d0/gentable_8c-source.html#l00884">RtlGetElementGenericTable()</a>, <a class="el" href="../../d7/d0/gentable_8c-source.html#l00357">RtlInsertElementGenericTableFull()</a>, and <a class="el" href="../../d7/d0/gentable_8c-source.html#l00669">RtlLookupElementGenericTableFull()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a0" doxytag="gentable.c::TABLE_ENTRY_HEADER" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d3/d8/struct__TABLE__ENTRY__HEADER.html">_TABLE_ENTRY_HEADER</a>  <a class="el" href="../../d3/d8/struct__TABLE__ENTRY__HEADER.html">TABLE_ENTRY_HEADER</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a2" doxytag="gentable.c::FindNodeOrParent" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> TABLE_SEARCH_RESULT FindNodeOrParent           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PRTL_GENERIC_TABLE&nbsp;</td>
          <td class="mdname" nowrap> <em>Table</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>Buffer</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT PRTL_SPLAY_LINKS *&nbsp;</td>
          <td class="mdname" nowrap> <em>NodeOrParent</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [static]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d0/gentable_8c-source.html#l00064">64</a> of file <a class="el" href="../../d7/d0/gentable_8c-source.html">gentable.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d7/d1/rtqkey_8c-source.html#l00042">Buffer</a>, <a class="el" href="../../d6/d1/gentable_8c.html#a1">PTABLE_ENTRY_HEADER</a>, <a class="el" href="../../d7/d0/gentable_8c-source.html#l00851">RtlIsGenericTableEmpty()</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d7/d0/gentable_8c-source.html#l00532">RtlDeleteElementGenericTable()</a>, <a class="el" href="../../d7/d0/gentable_8c-source.html#l00271">RtlInsertElementGenericTable()</a>, and <a class="el" href="../../d7/d0/gentable_8c-source.html#l00669">RtlLookupElementGenericTableFull()</a>.
<p>
<pre class="fragment"><div>00072                    :
00073 
00074     This routine <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> used by all of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a24">routines</a> of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> generic
00075     table <span class="keyword">package </span>to locate the a node in the tree.  It will
00076     find and return (via the NodeOrParent parameter) the node
00077     with the given key, or if that node is not in the tree it
00078     will return (via the NodeOrParent parameter) a pointer to
00079     the parent.
00080 
00081 Arguments:
00082 
00083     Table - The generic table to search for the key.
00084 
00085     Buffer - Pointer to a buffer holding the key.  The table
00086              package doesn't examine the key itself.  It leaves
00087              this up to the user supplied compare routine.
00088 
00089     NodeOrParent - Will be set to point to the node containing the
00090                    the key or what should be the parent of the node
00091                    if it were in the tree.  Note that this will *NOT*
00092                    be set if the search result is TableEmptyTree.
00093 
00094 Return Value:
00095 
00096     TABLE_SEARCH_RESULT - TableEmptyTree: The tree was empty.  NodeOrParent
00097                                           is *not* altered.
00098 
00099                           TableFoundNode: A node with the key is in the tree.
00100                                           NodeOrParent points to that node.
00101 
00102                           TableInsertAsLeft: Node with key was not found.
00103                                              NodeOrParent points to what would be
00104                                              parent.  The node would be the left
00105                                              child.
00106 
00107                           TableInsertAsRight: Node with key was not found.
00108                                               NodeOrParent points to what would be
00109                                               parent.  The node would be the right
00110                                               child.
00111 
00112 --*/
00113 
00114 
00115 
00116 {
00117 
00118     if (RtlIsGenericTableEmpty(Table)) {
00119 
00120         return TableEmptyTree;
00121 
00122     } <span class="keywordflow">else</span> {
00123 
00124         <span class="comment">//</span>
00125         <span class="comment">// Used as the iteration variable while stepping through</span>
00126         <span class="comment">// the generic table.</span>
00127         <span class="comment">//</span>
00128         PRTL_SPLAY_LINKS NodeToExamine = Table-&gt;TableRoot;
00129 
00130         <span class="comment">//</span>
00131         <span class="comment">// Just a temporary.  Hopefully a good compiler will get</span>
00132         <span class="comment">// rid of it.</span>
00133         <span class="comment">//</span>
00134         PRTL_SPLAY_LINKS Child;
00135 
00136         <span class="comment">//</span>
00137         <span class="comment">// Holds the value of the comparasion.</span>
00138         <span class="comment">//</span>
00139         RTL_GENERIC_COMPARE_RESULTS Result;
00140 
00141         <span class="keywordflow">while</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>) {
00142 
00143             <span class="comment">//</span>
00144             <span class="comment">// Compare the buffer with the key in the tree element.</span>
00145             <span class="comment">//</span>
00146 
00147             Result = Table-&gt;CompareRoutine(
00148                          Table,
00149                          Buffer,
00150                          &amp;((<a class="code" href="../../d3/d8/struct__TABLE__ENTRY__HEADER.html">PTABLE_ENTRY_HEADER</a>) NodeToExamine)-&gt;UserData
00151                          );
00152 
00153             <span class="keywordflow">if</span> (Result == GenericLessThan) {
00154 
00155                 <span class="keywordflow">if</span> (Child = RtlLeftChild(NodeToExamine)) {
00156 
00157                     NodeToExamine = Child;
00158 
00159                 } <span class="keywordflow">else</span> {
00160 
00161                     <span class="comment">//</span>
00162                     <span class="comment">// Node is not in the tree.  Set the output</span>
00163                     <span class="comment">// parameter to point to what would be its</span>
00164                     <span class="comment">// parent and return which child it would be.</span>
00165                     <span class="comment">//</span>
00166 
00167                     *NodeOrParent = NodeToExamine;
00168                     <span class="keywordflow">return</span> TableInsertAsLeft;
00169 
00170                 }
00171 
00172             } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Result == GenericGreaterThan) {
00173 
00174                 <span class="keywordflow">if</span> (Child = RtlRightChild(NodeToExamine)) {
00175 
00176                     NodeToExamine = Child;
00177 
00178                 } <span class="keywordflow">else</span> {
00179 
00180                     <span class="comment">//</span>
00181                     <span class="comment">// Node is not in the tree.  Set the output</span>
00182                     <span class="comment">// parameter to point to what would be its</span>
00183                     <span class="comment">// parent and return which child it would be.</span>
00184                     <span class="comment">//</span>
00185 
00186                     *NodeOrParent = NodeToExamine;
00187                     <span class="keywordflow">return</span> TableInsertAsRight;
00188 
00189                 }
00190 
00191 
00192             } <span class="keywordflow">else</span> {
00193 
00194                 <span class="comment">//</span>
00195                 <span class="comment">// Node is in the tree (or it better be because of the</span>
00196                 <span class="comment">// assert).  Set the output parameter to point to</span>
00197                 <span class="comment">// the node and tell the caller that we found the node.</span>
00198                 <span class="comment">//</span>
00199 
00200                 <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(Result == GenericEqual);
00201                 *NodeOrParent = NodeToExamine;
00202                 <span class="keywordflow">return</span> TableFoundNode;
00203 
00204             }
00205 
00206         }
00207 
00208     }
00209 
00210 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a6" doxytag="gentable.c::RtlDeleteElementGenericTable" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN RtlDeleteElementGenericTable           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PRTL_GENERIC_TABLE&nbsp;</td>
          <td class="mdname" nowrap> <em>Table</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>Buffer</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d0/gentable_8c-source.html#l00532">532</a> of file <a class="el" href="../../d7/d0/gentable_8c-source.html">gentable.c</a>.
<p>
References <a class="el" href="../../d7/d1/rtqkey_8c-source.html#l00042">Buffer</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d7/d0/gentable_8c-source.html#l00064">FindNodeOrParent()</a>, <a class="el" href="../../d6/d1/gentable_8c.html#a1">PTABLE_ENTRY_HEADER</a>, <a class="el" href="../../d4/d3/splay_8c-source.html#l00385">RtlDelete()</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
<pre class="fragment"><div>00539                    :
00540 
00541     The function DeleteElementGenericTable will find and <span class="keyword">delete</span> an element
00542     from a generic table.  If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> element <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> located and deleted <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <span class="keywordflow">return</span>
00543     value <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>, otherwise <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> element <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> not located <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <span class="keywordflow">return</span> value
00544     <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>.  The user supplied input buffer <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <a class="code" href="../../d3/d0/imm32_8def.html#a1">only</a> used as a key in
00545     locating <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> element in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> table.
00546 
00547 Arguments:
00548 
00549     Table - Pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> table in which to (possibly) delete the
00550             memory accessed by the key buffer.
00551 
00552     Buffer - Passed to the user comparasion routine.  Its contents are
00553              up to the user but one could imagine that it contains some
00554              sort of key value.
00555 
00556 Return Value:
00557 
00558     BOOLEAN - If the table contained the key then true, otherwise false.
00559 
00560 --*/
00561 
00562 {
00563 
00564     <span class="comment">//</span>
00565     <span class="comment">// Holds a pointer to the node in the table or what would be the</span>
00566     <span class="comment">// parent of the node.</span>
00567     <span class="comment">//</span>
00568     PRTL_SPLAY_LINKS NodeOrParent;
00569 
00570     <span class="comment">//</span>
00571     <span class="comment">// Holds the result of the table lookup.</span>
00572     <span class="comment">//</span>
00573     TABLE_SEARCH_RESULT Lookup;
00574 
00575     Lookup = <a class="code" href="../../d6/d1/gentable_8c.html#a2">FindNodeOrParent</a>(
00576                  Table,
00577                  Buffer,
00578                  &amp;NodeOrParent
00579                  );
00580 
00581     <span class="keywordflow">if</span> ((Lookup == TableEmptyTree) || (Lookup != TableFoundNode)) {
00582 
00583         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00584 
00585     } <span class="keywordflow">else</span> {
00586 
00587         <span class="comment">//</span>
00588         <span class="comment">// Delete the node from the splay tree.</span>
00589         <span class="comment">//</span>
00590 
00591         Table-&gt;TableRoot = <a class="code" href="../../d3/d4/splay_8c.html#a4">RtlDelete</a>(NodeOrParent);
00592 
00593         <span class="comment">//</span>
00594         <span class="comment">// Delete the element from the linked list.</span>
00595         <span class="comment">//</span>
00596 
00597         RemoveEntryList(&amp;((<a class="code" href="../../d3/d8/struct__TABLE__ENTRY__HEADER.html">PTABLE_ENTRY_HEADER</a>) NodeOrParent)-&gt;ListEntry);
00598         Table-&gt;NumberGenericTableElements--;
00599         Table-&gt;WhichOrderedElement = 0;
00600         Table-&gt;OrderedPointer = &amp;Table-&gt;InsertOrderList;
00601 
00602         <span class="comment">//</span>
00603         <span class="comment">// The node has been deleted from the splay table.</span>
00604         <span class="comment">// Now give the node to the user deletion routine.</span>
00605         <span class="comment">// NOTE: We are giving the deletion routine a pointer</span>
00606         <span class="comment">// to the splay links rather then the user data.  It</span>
00607         <span class="comment">// is assumed that the deallocation is rather stupid.</span>
00608         <span class="comment">//</span>
00609 
00610         Table-&gt;FreeRoutine(Table,NodeOrParent);
00611         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00612 
00613     }
00614 
00615 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a9" doxytag="gentable.c::RtlEnumerateGenericTable" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PVOID RtlEnumerateGenericTable           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PRTL_GENERIC_TABLE&nbsp;</td>
          <td class="mdname" nowrap> <em>Table</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>Restart</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d0/gentable_8c-source.html#l00738">738</a> of file <a class="el" href="../../d7/d0/gentable_8c-source.html">gentable.c</a>.
<p>
References <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d6/d1/gentable_8c.html#a1">PTABLE_ENTRY_HEADER</a>, <a class="el" href="../../d7/d0/gentable_8c-source.html#l00851">RtlIsGenericTableEmpty()</a>, <a class="el" href="../../d4/d3/splay_8c-source.html#l00759">RtlRealSuccessor()</a>, and <a class="el" href="../../d4/d3/splay_8c-source.html#l00051">RtlSplay()</a>.
<p>
<pre class="fragment"><div>00745                    :
00746 
00747     The function EnumerateGenericTable will <span class="keywordflow">return</span> to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> caller one-by-one
00748     <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> elements of of a table.  The <span class="keywordflow">return</span> value <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> a pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> user
00749     defined structure associated with <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> element.  The input parameter
00750     Restart indicates <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> enumeration should start from <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> beginning
00751     or should <span class="keywordflow">return</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> next element.  If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> are no more <span class="keyword">new</span> elements to
00752     <span class="keywordflow">return</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <span class="keywordflow">return</span> value <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>.  As an example of its use, to enumerate
00753     all of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> elements in a table <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> user would write:
00754 
00755         <span class="keywordflow">for</span> (ptr = EnumerateGenericTable(Table,TRUE);
00756              ptr != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00757              ptr = EnumerateGenericTable(Table, FALSE)) {
00758                 :
00759         }
00760 
00761 Arguments:
00762 
00763     Table - Pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> generic table to enumerate.
00764 
00765     Restart - Flag that <span class="keywordflow">if</span> <span class="keyword">true</span> we should start with <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> least
00766               element in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> tree otherwise, <span class="keywordflow">return</span> we <span class="keywordflow">return</span>
00767               a pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> user data <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> root and make
00768               <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> real successor to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> root <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <span class="keyword">new</span> root.
00769 
00770 Return Value:
00771 
00772     PVOID - Pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> user data.
00773 
00774 --*/
00775 
00776 {
00777 
00778     <span class="keywordflow">if</span> (<a class="code" href="../../d6/d1/gentable_8c.html#a10">RtlIsGenericTableEmpty</a>(Table)) {
00779 
00780         <span class="comment">//</span>
00781         <span class="comment">// Nothing to do if the table is empty.</span>
00782         <span class="comment">//</span>
00783 
00784         <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00785 
00786     } <span class="keywordflow">else</span> {
00787 
00788         <span class="comment">//</span>
00789         <span class="comment">// Will be used as the "iteration" through the tree.</span>
00790         <span class="comment">//</span>
00791         PRTL_SPLAY_LINKS NodeToReturn;
00792 
00793         <span class="comment">//</span>
00794         <span class="comment">// If the restart flag is true then go to the least element</span>
00795         <span class="comment">// in the tree.</span>
00796         <span class="comment">//</span>
00797 
00798         <span class="keywordflow">if</span> (Restart) {
00799 
00800             <span class="comment">//</span>
00801             <span class="comment">// We just loop until we find the leftmost child of the root.</span>
00802             <span class="comment">//</span>
00803 
00804             <span class="keywordflow">for</span> (
00805                 NodeToReturn = Table-&gt;TableRoot;
00806                 RtlLeftChild(NodeToReturn);
00807                 NodeToReturn = RtlLeftChild(NodeToReturn)
00808                 ) {
00809                 ;
00810             }
00811 
00812             Table-&gt;TableRoot = <a class="code" href="../../d3/d4/splay_8c.html#a3">RtlSplay</a>(NodeToReturn);
00813 
00814         } <span class="keywordflow">else</span> {
00815 
00816             <span class="comment">//</span>
00817             <span class="comment">// The assumption here is that the root of the</span>
00818             <span class="comment">// tree is the last node that we returned.  We</span>
00819             <span class="comment">// find the real successor to the root and return</span>
00820             <span class="comment">// it as next element of the enumeration.  The</span>
00821             <span class="comment">// node that is to be returned is splayed (thereby</span>
00822             <span class="comment">// making it the root of the tree).  Note that we</span>
00823             <span class="comment">// need to take care when there are no more elements.</span>
00824             <span class="comment">//</span>
00825 
00826             NodeToReturn = <a class="code" href="../../d3/d4/splay_8c.html#a8">RtlRealSuccessor</a>(Table-&gt;TableRoot);
00827 
00828             <span class="keywordflow">if</span> (NodeToReturn) {
00829 
00830                 Table-&gt;TableRoot = <a class="code" href="../../d3/d4/splay_8c.html#a3">RtlSplay</a>(NodeToReturn);
00831 
00832             }
00833 
00834         }
00835 
00836         <span class="comment">//</span>
00837         <span class="comment">// If there actually is a next element in the enumeration</span>
00838         <span class="comment">// then the pointer to return is right after the list links.</span>
00839         <span class="comment">//</span>
00840 
00841         <span class="keywordflow">return</span> ((NodeToReturn)?
00842                    ((PVOID)&amp;((<a class="code" href="../../d3/d8/struct__TABLE__ENTRY__HEADER.html">PTABLE_ENTRY_HEADER</a>)NodeToReturn)-&gt;UserData)
00843                   :((PVOID)(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)));
00844 
00845     }
00846 
00847 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a13" doxytag="gentable.c::RtlEnumerateGenericTableWithoutSplaying" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PVOID RtlEnumerateGenericTableWithoutSplaying           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PRTL_GENERIC_TABLE&nbsp;</td>
          <td class="mdname" nowrap> <em>Table</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PVOID *&nbsp;</td>
          <td class="mdname" nowrap> <em>RestartKey</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d0/gentable_8c-source.html#l01110">1110</a> of file <a class="el" href="../../d7/d0/gentable_8c-source.html">gentable.c</a>.
<p>
References <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d6/d1/gentable_8c.html#a1">PTABLE_ENTRY_HEADER</a>, <a class="el" href="../../d7/d0/gentable_8c-source.html#l00851">RtlIsGenericTableEmpty()</a>, and <a class="el" href="../../d4/d3/splay_8c-source.html#l00759">RtlRealSuccessor()</a>.
<p>
Referenced by <a class="el" href="../../d0/d7/udfs_2strucsup_8c-source.html#l01997">UdfGetNextFcb()</a>.
<p>
<pre class="fragment"><div>01117                    :
01118 
01119     The function EnumerateGenericTableWithoutSplaying will <span class="keywordflow">return</span> to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
01120     caller one-by-one <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> elements of of a table.  The <span class="keywordflow">return</span> value <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> a
01121     pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> user defined structure associated with <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> element.
01122     The input parameter RestartKey indicates <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> enumeration should
01123     start from <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> beginning or should <span class="keywordflow">return</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> next element.  If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
01124     are no more <span class="keyword">new</span> elements to <span class="keywordflow">return</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <span class="keywordflow">return</span> value <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>.  As an
01125     example of its use, to enumerate all of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> elements in a table <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
01126     user would write:
01127 
01128         *RestartKey = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01129 
01130         <span class="keywordflow">for</span> (ptr = EnumerateGenericTableWithoutSplaying(Table, &amp;RestartKey);
01131              ptr != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01132              ptr = EnumerateGenericTableWithoutSplaying(Table, &amp;RestartKey)) {
01133                 :
01134         }
01135 
01136 Arguments:
01137 
01138     Table - Pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> generic table to enumerate.
01139 
01140     RestartKey - Pointer that indicates <span class="keywordflow">if</span> we should restart or <span class="keywordflow">return</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> next
01141                 element.  If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> contents of RestartKey <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>, <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> search
01142                 will be started from <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> beginning.
01143 
01144 Return Value:
01145 
01146     PVOID - Pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> user data.
01147 
01148 --*/
01149 
01150 {
01151 
01152     <span class="keywordflow">if</span> (<a class="code" href="../../d6/d1/gentable_8c.html#a10">RtlIsGenericTableEmpty</a>(Table)) {
01153 
01154         <span class="comment">//</span>
01155         <span class="comment">// Nothing to do if the table is empty.</span>
01156         <span class="comment">//</span>
01157 
01158         <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01159 
01160     } <span class="keywordflow">else</span> {
01161 
01162         <span class="comment">//</span>
01163         <span class="comment">// Will be used as the "iteration" through the tree.</span>
01164         <span class="comment">//</span>
01165         PRTL_SPLAY_LINKS NodeToReturn;
01166 
01167         <span class="comment">//</span>
01168         <span class="comment">// If the restart flag is true then go to the least element</span>
01169         <span class="comment">// in the tree.</span>
01170         <span class="comment">//</span>
01171 
01172         <span class="keywordflow">if</span> (*RestartKey == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01173 
01174             <span class="comment">//</span>
01175             <span class="comment">// We just loop until we find the leftmost child of the root.</span>
01176             <span class="comment">//</span>
01177 
01178             <span class="keywordflow">for</span> (
01179                 NodeToReturn = Table-&gt;TableRoot;
01180                 RtlLeftChild(NodeToReturn);
01181                 NodeToReturn = RtlLeftChild(NodeToReturn)
01182                 ) {
01183                 ;
01184             }
01185 
01186             *RestartKey = NodeToReturn;
01187 
01188         } <span class="keywordflow">else</span> {
01189 
01190             <span class="comment">//</span>
01191             <span class="comment">// The caller has passed in the previous entry found</span>
01192             <span class="comment">// in the table to enable us to continue the search.  We call</span>
01193             <span class="comment">// RtlRealSuccessor to step to the next element in the tree.</span>
01194             <span class="comment">//</span>
01195 
01196             NodeToReturn = <a class="code" href="../../d3/d4/splay_8c.html#a8">RtlRealSuccessor</a>(*RestartKey);
01197 
01198             <span class="keywordflow">if</span> (NodeToReturn) {
01199 
01200                 *RestartKey = NodeToReturn;
01201 
01202             }
01203 
01204         }
01205 
01206         <span class="comment">//</span>
01207         <span class="comment">// If there actually is a next element in the enumeration</span>
01208         <span class="comment">// then the pointer to return is right after the list links.</span>
01209         <span class="comment">//</span>
01210 
01211         <span class="keywordflow">return</span> ((NodeToReturn)?
01212                    ((PVOID)&amp;((<a class="code" href="../../d3/d8/struct__TABLE__ENTRY__HEADER.html">PTABLE_ENTRY_HEADER</a>)NodeToReturn)-&gt;UserData)
01213                   :((PVOID)(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)));
01214 
01215     }
01216 
01217 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a11" doxytag="gentable.c::RtlGetElementGenericTable" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PVOID RtlGetElementGenericTable           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PRTL_GENERIC_TABLE&nbsp;</td>
          <td class="mdname" nowrap> <em>Table</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>I</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d0/gentable_8c-source.html#l00884">884</a> of file <a class="el" href="../../d7/d0/gentable_8c-source.html">gentable.c</a>.
<p>
References <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, and <a class="el" href="../../d6/d1/gentable_8c.html#a1">PTABLE_ENTRY_HEADER</a>.
<p>
<pre class="fragment"><div>00891                    :
00892 
00893 
00894     The function GetElementGenericTable will <span class="keywordflow">return</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> i'th element
00895     inserted in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> generic table.  I = 0 implies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> first element,
00896     I = (<a class="code" href="../../d6/d1/gentable_8c.html#a12">RtlNumberGenericTableElements</a>(Table)-1) will <span class="keywordflow">return</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> last element
00897     inserted into <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> generic table.  The <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> of I <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> ULONG.  Values
00898     of I &gt; than (NumberGenericTableElements(Table)-1) will return NULL.  If
00899     an arbitrary element is deleted from the generic table it will cause
00900     all elements inserted after the deleted element to "move up".
00901 
00902 Arguments:
00903 
00904     Table - Pointer to the generic table from which to get the ith element.
00905 
00906     I - Which element to get.
00907 
00908 
00909 Return Value:
00910 
00911     PVOID - Pointer to the user data.
00912 
00913 --*/
00914 
00915 {
00916 
00917     <span class="comment">//</span>
00918     <span class="comment">// Current location in the table.</span>
00919     <span class="comment">//</span>
00920     ULONG CurrentLocation = Table-&gt;WhichOrderedElement;
00921 
00922     <span class="comment">//</span>
00923     <span class="comment">// Hold the number of elements in the table.</span>
00924     <span class="comment">//</span>
00925     ULONG NumberInTable = Table-&gt;NumberGenericTableElements;
00926 
00927     <span class="comment">//</span>
00928     <span class="comment">// Holds the value of I+1.</span>
00929     <span class="comment">//</span>
00930     <span class="comment">// Note that we don't care if this value overflows.</span>
00931     <span class="comment">// If we end up accessing it we know that it didn't.</span>
00932     <span class="comment">//</span>
00933     ULONG NormalizedI = I + 1;
00934 
00935     <span class="comment">//</span>
00936     <span class="comment">// Will hold distances to travel to the desired node;</span>
00937     <span class="comment">//</span>
00938     ULONG ForwardDistance,BackwardDistance;
00939 
00940     <span class="comment">//</span>
00941     <span class="comment">// Will point to the current element in the linked list.</span>
00942     <span class="comment">//</span>
00943     PLIST_ENTRY CurrentNode = Table-&gt;OrderedPointer;
00944 
00945 
00946     <span class="comment">//</span>
00947     <span class="comment">// If it's out of bounds get out quick.</span>
00948     <span class="comment">//</span>
00949 
00950     <span class="keywordflow">if</span> ((I == MAXULONG) || (NormalizedI &gt; NumberInTable)) <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00951 
00952     <span class="comment">//</span>
00953     <span class="comment">// If we're already at the node then return it.</span>
00954     <span class="comment">//</span>
00955 
00956     <span class="keywordflow">if</span> (NormalizedI == CurrentLocation) {
00957 
00958         <span class="keywordflow">return</span> &amp;((<a class="code" href="../../d3/d8/struct__TABLE__ENTRY__HEADER.html">PTABLE_ENTRY_HEADER</a>) CONTAINING_RECORD(CurrentNode, <a class="code" href="../../d3/d8/struct__TABLE__ENTRY__HEADER.html">TABLE_ENTRY_HEADER</a>, ListEntry))-&gt;UserData;
00959     }
00960 
00961     <span class="comment">//</span>
00962     <span class="comment">// Calculate the forward and backward distance to the node.</span>
00963     <span class="comment">//</span>
00964 
00965     <span class="keywordflow">if</span> (CurrentLocation &gt; NormalizedI) {
00966 
00967         <span class="comment">//</span>
00968         <span class="comment">// When CurrentLocation is greater than where we want to go,</span>
00969         <span class="comment">// if moving forward gets us there quicker than moving backward</span>
00970         <span class="comment">// then it follows that moving forward from the listhead is</span>
00971         <span class="comment">// going to take fewer steps. (This is because, moving forward</span>
00972         <span class="comment">// in this case must move *through* the listhead.)</span>
00973         <span class="comment">//</span>
00974         <span class="comment">// The work here is to figure out if moving backward would be quicker.</span>
00975         <span class="comment">//</span>
00976         <span class="comment">// Moving backward would be quicker only if the location we wish  to</span>
00977         <span class="comment">// go to is more than half way between the listhead and where we</span>
00978         <span class="comment">// currently are.</span>
00979         <span class="comment">//</span>
00980 
00981         <span class="keywordflow">if</span> (NormalizedI &gt; (CurrentLocation/2)) {
00982 
00983             <span class="comment">//</span>
00984             <span class="comment">// Where we want to go is more than half way from the listhead</span>
00985             <span class="comment">// We can traval backwards from our current location.</span>
00986             <span class="comment">//</span>
00987 
00988             <span class="keywordflow">for</span> (
00989                 BackwardDistance = CurrentLocation - NormalizedI;
00990                 BackwardDistance;
00991                 BackwardDistance--
00992                 ) {
00993 
00994                 CurrentNode = CurrentNode-&gt;Blink;
00995 
00996             }
00997         } <span class="keywordflow">else</span> {
00998 
00999             <span class="comment">//</span>
01000             <span class="comment">// Where we want to go is less than halfway between the start</span>
01001             <span class="comment">// and where we currently are.  Start from the listhead.</span>
01002             <span class="comment">//</span>
01003 
01004             <span class="keywordflow">for</span> (
01005                 CurrentNode = &amp;Table-&gt;InsertOrderList;
01006                 NormalizedI;
01007                 NormalizedI--
01008                 ) {
01009 
01010                 CurrentNode = CurrentNode-&gt;Flink;
01011 
01012             }
01013 
01014         }
01015 
01016     } <span class="keywordflow">else</span> {
01017 
01018 
01019         <span class="comment">//</span>
01020         <span class="comment">// When CurrentLocation is less than where we want to go,</span>
01021         <span class="comment">// if moving backwards gets us there quicker than moving forwards</span>
01022         <span class="comment">// then it follows that moving backwards from the listhead is</span>
01023         <span class="comment">// going to take fewer steps. (This is because, moving backwards</span>
01024         <span class="comment">// in this case must move *through* the listhead.)</span>
01025         <span class="comment">//</span>
01026 
01027         ForwardDistance = NormalizedI - CurrentLocation;
01028 
01029         <span class="comment">//</span>
01030         <span class="comment">// Do the backwards calculation as if we are starting from the</span>
01031         <span class="comment">// listhead.</span>
01032         <span class="comment">//</span>
01033 
01034         BackwardDistance = (NumberInTable - NormalizedI) + 1;
01035 
01036         <span class="keywordflow">if</span> (ForwardDistance &lt;= BackwardDistance) {
01037 
01038             <span class="keywordflow">for</span> (
01039                 ;
01040                 ForwardDistance;
01041                 ForwardDistance--
01042                 ) {
01043 
01044                 CurrentNode = CurrentNode-&gt;Flink;
01045 
01046             }
01047 
01048 
01049         } <span class="keywordflow">else</span> {
01050 
01051             <span class="keywordflow">for</span> (
01052                 CurrentNode = &amp;Table-&gt;InsertOrderList;
01053                 BackwardDistance;
01054                 BackwardDistance--
01055                 ) {
01056 
01057                 CurrentNode = CurrentNode-&gt;Blink;
01058 
01059             }
01060 
01061         }
01062 
01063     }
01064 
01065     <span class="comment">//</span>
01066     <span class="comment">// We're where we want to be.  Save our current location and return</span>
01067     <span class="comment">// a pointer to the data to the user.</span>
01068     <span class="comment">//</span>
01069 
01070     Table-&gt;OrderedPointer = CurrentNode;
01071     Table-&gt;WhichOrderedElement = I+1;
01072 
01073     <span class="keywordflow">return</span> &amp;((<a class="code" href="../../d3/d8/struct__TABLE__ENTRY__HEADER.html">PTABLE_ENTRY_HEADER</a>) CONTAINING_RECORD(CurrentNode, <a class="code" href="../../d3/d8/struct__TABLE__ENTRY__HEADER.html">TABLE_ENTRY_HEADER</a>, ListEntry))-&gt;UserData;
01074 
01075 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="gentable.c::RtlInitializeGenericTable" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID RtlInitializeGenericTable           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PRTL_GENERIC_TABLE&nbsp;</td>
          <td class="mdname" nowrap> <em>Table</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PRTL_GENERIC_COMPARE_ROUTINE&nbsp;</td>
          <td class="mdname" nowrap> <em>CompareRoutine</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PRTL_GENERIC_ALLOCATE_ROUTINE&nbsp;</td>
          <td class="mdname" nowrap> <em>AllocateRoutine</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PRTL_GENERIC_FREE_ROUTINE&nbsp;</td>
          <td class="mdname" nowrap> <em>FreeRoutine</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>TableContext</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d0/gentable_8c-source.html#l00213">213</a> of file <a class="el" href="../../d7/d0/gentable_8c-source.html">gentable.c</a>.
<p>
References <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>.
<p>
Referenced by <a class="el" href="../../d0/d7/udfs_2strucsup_8c-source.html#l00331">UdfInitializeVcb()</a>, and <a class="el" href="../../d7/d5/vmcbsup_8c-source.html#l00219">UdfInitializeVmcb()</a>.
<p>
<pre class="fragment"><div>00223                    :
00224 
00225     The <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a69">procedure</a> InitializeGenericTable takes as input an uninitialized
00226     generic table variable and pointers to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> three user supplied <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a24">routines</a>.
00227     This must be called <span class="keywordflow">for</span> every individual generic table variable before
00228     <a class="code" href="../../d1/d9/icmui_8def.html#a4">it</a> can be used.
00229 
00230 Arguments:
00231 
00232     Table - Pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> generic table to be initialized.
00233 
00234     CompareRoutine - User routine to be used to compare to keys in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00235                      table.
00236 
00237     AllocateRoutine - User routine to call to allocate memory <span class="keywordflow">for</span> a <span class="keyword">new</span>
00238                       node in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> generic table.
00239 
00240     FreeRoutine - User routine to call to deallocate memory <span class="keywordflow">for</span>
00241                         a node in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> generic table.
00242 
00243     TableContext - Supplies user supplied context <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> table.
00244 
00245 Return Value:
00246 
00247     None.
00248 
00249 --*/
00250 
00251 {
00252 
00253     <span class="comment">//</span>
00254     <span class="comment">// Initialize each field of the Table parameter.</span>
00255     <span class="comment">//</span>
00256 
00257     Table-&gt;TableRoot = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00258     InitializeListHead(&amp;Table-&gt;InsertOrderList);
00259     Table-&gt;NumberGenericTableElements = 0;
00260     Table-&gt;OrderedPointer = &amp;Table-&gt;InsertOrderList;
00261     Table-&gt;WhichOrderedElement = 0;
00262     Table-&gt;CompareRoutine = CompareRoutine;
00263     Table-&gt;AllocateRoutine = AllocateRoutine;
00264     Table-&gt;FreeRoutine = FreeRoutine;
00265     Table-&gt;TableContext = TableContext;
00266 
00267 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a4" doxytag="gentable.c::RtlInsertElementGenericTable" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PVOID RtlInsertElementGenericTable           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PRTL_GENERIC_TABLE&nbsp;</td>
          <td class="mdname" nowrap> <em>Table</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>Buffer</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN CLONG&nbsp;</td>
          <td class="mdname" nowrap> <em>BufferSize</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT PBOOLEAN NewElement&nbsp;</td>
          <td class="mdname" nowrap> <em>OPTIONAL</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d0/gentable_8c-source.html#l00271">271</a> of file <a class="el" href="../../d7/d0/gentable_8c-source.html">gentable.c</a>.
<p>
References <a class="el" href="../../d7/d1/rtqkey_8c-source.html#l00042">Buffer</a>, <a class="el" href="../../d7/d1/rtqkey_8c-source.html#l00045">BufferSize</a>, <a class="el" href="../../d7/d0/gentable_8c-source.html#l00064">FindNodeOrParent()</a>, and <a class="el" href="../../d7/d0/gentable_8c-source.html#l00357">RtlInsertElementGenericTableFull()</a>.
<p>
<pre class="fragment"><div>00280                    :
00281 
00282     The function InsertElementGenericTable will insert a <span class="keyword">new</span> element
00283     in a table.  It does <span class="keyword">this</span> by allocating space <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <span class="keyword">new</span> element
00284     (<span class="keyword">this</span> includes splay links), inserting <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> element in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> table, and
00285     then returning to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> user a pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <span class="keyword">new</span> element (which is
00286     the first available space after the splay links).  If an element
00287     with <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> same key already exists in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> table <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <span class="keywordflow">return</span> value <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> a pointer
00288     to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> old element.  The optional output parameter NewElement <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> used
00289     to indicate <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> element previously existed in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> table.  Note: <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> user
00290     supplied <a class="code" href="../../d6/d2/rtqkey_8c.html#a3">Buffer</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <a class="code" href="../../d3/d0/imm32_8def.html#a1">only</a> used <span class="keywordflow">for</span> searching <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> table, upon insertion its
00291     contents are copied to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> newly created element.  This means that
00292     pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> input buffer will not point to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <span class="keyword">new</span> element.
00293 
00294 Arguments:
00295 
00296     Table - Pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> table in which to (possibly) insert the
00297             key buffer.
00298 
00299     Buffer - Passed to the user comparasion routine.  Its contents are
00300              up to the user but one could imagine that it contains some
00301              sort of key value.
00302 
00303     BufferSize - The amount of space to allocate when the (possible)
00304                  insertion is made.  Note that if we actually do
00305                  not find the node and we do allocate space then we
00306                  will add the size of the SPLAY_LINKS to this buffer
00307                  size.  The user should really take care not to depend
00308                  on anything in the first sizeof(SPLAY_LINKS) bytes
00309                  of the memory allocated via the memory allocation
00310                  routine.
00311 
00312     NewElement - Optional Flag.  If present then it will be set to
00313                  TRUE if the buffer was not "found" in the generic
00314                  table.
00315 
00316 Return Value:
00317 
00318     PVOID - Pointer to the user defined data.
00319 
00320 --*/
00321 
00322 {
00323 
00324     <span class="comment">//</span>
00325     <span class="comment">// Holds a pointer to the node in the table or what would be the</span>
00326     <span class="comment">// parent of the node.</span>
00327     <span class="comment">//</span>
00328     PRTL_SPLAY_LINKS NodeOrParent;
00329 
00330     <span class="comment">//</span>
00331     <span class="comment">// Holds the result of the table lookup.</span>
00332     <span class="comment">//</span>
00333     TABLE_SEARCH_RESULT Lookup;
00334 
00335     Lookup = <a class="code" href="../../d6/d1/gentable_8c.html#a2">FindNodeOrParent</a>(
00336                  Table,
00337                  Buffer,
00338                  &amp;NodeOrParent
00339                  );
00340 
00341     <span class="comment">//</span>
00342     <span class="comment">//  Call the full routine to do the real work.</span>
00343     <span class="comment">//</span>
00344 
00345     <span class="keywordflow">return</span> <a class="code" href="../../d6/d1/gentable_8c.html#a5">RtlInsertElementGenericTableFull</a>(
00346                 Table,
00347                 Buffer,
00348                 BufferSize,
00349                 NewElement,
00350                 NodeOrParent,
00351                 Lookup
00352                 );
00353 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a5" doxytag="gentable.c::RtlInsertElementGenericTableFull" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PVOID RtlInsertElementGenericTableFull           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PRTL_GENERIC_TABLE&nbsp;</td>
          <td class="mdname" nowrap> <em>Table</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>Buffer</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN CLONG&nbsp;</td>
          <td class="mdname" nowrap> <em>BufferSize</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT PBOOLEAN NewElement&nbsp;</td>
          <td class="mdname" nowrap> <em>OPTIONAL</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>NodeOrParent</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>TABLE_SEARCH_RESULT&nbsp;</td>
          <td class="mdname" nowrap> <em>SearchResult</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d0/gentable_8c-source.html#l00357">357</a> of file <a class="el" href="../../d7/d0/gentable_8c-source.html">gentable.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d7/d1/rtqkey_8c-source.html#l00042">Buffer</a>, <a class="el" href="../../d7/d1/rtqkey_8c-source.html#l00045">BufferSize</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d6/d1/gentable_8c.html#a1">PTABLE_ENTRY_HEADER</a>, <a class="el" href="../../d4/d3/splay_8c-source.html#l00051">RtlSplay()</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d7/d0/gentable_8c-source.html#l00271">RtlInsertElementGenericTable()</a>.
<p>
<pre class="fragment"><div>00368                    :
00369 
00370     The function InsertElementGenericTableFull will insert a <span class="keyword">new</span> element
00371     in a table.  It does <span class="keyword">this</span> by allocating space <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <span class="keyword">new</span> element
00372     (<span class="keyword">this</span> includes splay links), inserting <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> element in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> table, and
00373     then returning to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> user a pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <span class="keyword">new</span> element.  If an element
00374     with <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> same key already exists in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> table <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <span class="keywordflow">return</span> value <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> a pointer
00375     to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> old element.  The optional output parameter NewElement <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> used
00376     to indicate <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> element previously existed in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> table.  Note: <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> user
00377     supplied <a class="code" href="../../d6/d2/rtqkey_8c.html#a3">Buffer</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <a class="code" href="../../d3/d0/imm32_8def.html#a1">only</a> used <span class="keywordflow">for</span> searching <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> table, upon insertion its
00378     contents are copied to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> newly created element.  This means that
00379     pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> input buffer will not point to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <span class="keyword">new</span> element.
00380     This routine <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> passed <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> NodeOrParent and SearchResult from a
00381     previous <a class="code" href="../../d6/d1/gentable_8c.html#a8">RtlLookupElementGenericTableFull</a>.
00382 
00383 Arguments:
00384 
00385     Table - Pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> table in which to (possibly) insert the
00386             key buffer.
00387 
00388     Buffer - Passed to the user comparasion routine.  Its contents are
00389              up to the user but one could imagine that it contains some
00390              sort of key value.
00391 
00392     BufferSize - The amount of space to allocate when the (possible)
00393                  insertion is made.  Note that if we actually do
00394                  not find the node and we do allocate space then we
00395                  will add the size of the SPLAY_LINKS to this buffer
00396                  size.  The user should really take care not to depend
00397                  on anything in the first sizeof(SPLAY_LINKS) bytes
00398                  of the memory allocated via the memory allocation
00399                  routine.
00400 
00401     NewElement - Optional Flag.  If present then it will be set to
00402                  TRUE if the buffer was not "found" in the generic
00403                  table.
00404 
00405    NodeOrParent - Result of prior RtlLookupElementGenericTableFull.
00406 
00407    SearchResult - Result of prior RtlLookupElementGenericTableFull.
00408 
00409 Return Value:
00410 
00411     PVOID - Pointer to the user defined data.
00412 
00413 --*/
00414 
00415 {
00416     <span class="comment">//</span>
00417     <span class="comment">// Node will point to the splay links of what</span>
00418     <span class="comment">// will be returned to the user.</span>
00419     <span class="comment">//</span>
00420 
00421     PRTL_SPLAY_LINKS NodeToReturn;
00422 
00423     <span class="keywordflow">if</span> (SearchResult != TableFoundNode) {
00424 
00425         <span class="comment">//</span>
00426         <span class="comment">// We just check that the table isn't getting</span>
00427         <span class="comment">// too big.</span>
00428         <span class="comment">//</span>
00429 
00430         <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(Table-&gt;NumberGenericTableElements != (MAXULONG-1));
00431 
00432         <span class="comment">//</span>
00433         <span class="comment">// The node wasn't in the (possibly empty) tree.</span>
00434         <span class="comment">// Call the user allocation routine to get space</span>
00435         <span class="comment">// for the new node.</span>
00436         <span class="comment">//</span>
00437 
00438         NodeToReturn = Table-&gt;AllocateRoutine(
00439                            Table,
00440                            BufferSize+FIELD_OFFSET( <a class="code" href="../../d3/d8/struct__TABLE__ENTRY__HEADER.html">TABLE_ENTRY_HEADER</a>, UserData )
00441                            );
00442 
00443         <span class="comment">//</span>
00444         <span class="comment">// If the return is NULL, return NULL from here to indicate that</span>
00445         <span class="comment">// the entry could not be added.</span>
00446         <span class="comment">//</span>
00447 
00448         <span class="keywordflow">if</span> (NodeToReturn == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00449 
00450             <span class="keywordflow">if</span> (ARGUMENT_PRESENT(NewElement)) {
00451 
00452                 *NewElement = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00453             }
00454 
00455             <span class="keywordflow">return</span>(<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>);
00456         }
00457 
00458         RtlInitializeSplayLinks(NodeToReturn);
00459 
00460         <span class="comment">//</span>
00461         <span class="comment">// Insert the new node at the end of the ordered linked list.</span>
00462         <span class="comment">//</span>
00463 
00464         InsertTailList(
00465             &amp;Table-&gt;InsertOrderList,
00466             &amp;((<a class="code" href="../../d3/d8/struct__TABLE__ENTRY__HEADER.html">PTABLE_ENTRY_HEADER</a>) NodeToReturn)-&gt;ListEntry
00467             );
00468 
00469         Table-&gt;NumberGenericTableElements++;
00470 
00471         <span class="comment">//</span>
00472         <span class="comment">// Insert the new node in the tree.</span>
00473         <span class="comment">//</span>
00474 
00475         <span class="keywordflow">if</span> (SearchResult == TableEmptyTree) {
00476 
00477             Table-&gt;TableRoot = NodeToReturn;
00478 
00479         } <span class="keywordflow">else</span> {
00480 
00481             <span class="keywordflow">if</span> (SearchResult == TableInsertAsLeft) {
00482 
00483                 RtlInsertAsLeftChild(
00484                     NodeOrParent,
00485                     NodeToReturn
00486                     );
00487 
00488             } <span class="keywordflow">else</span> {
00489 
00490                 RtlInsertAsRightChild(
00491                     NodeOrParent,
00492                     NodeToReturn
00493                     );
00494             }
00495         }
00496 
00497         <span class="comment">//</span>
00498         <span class="comment">// Copy the users buffer into the user data area of the table.</span>
00499         <span class="comment">//</span>
00500 
00501         RtlCopyMemory(
00502             &amp;((<a class="code" href="../../d3/d8/struct__TABLE__ENTRY__HEADER.html">PTABLE_ENTRY_HEADER</a>) NodeToReturn)-&gt;UserData,
00503             Buffer,
00504             BufferSize
00505             );
00506 
00507     } <span class="keywordflow">else</span> {
00508 
00509         NodeToReturn = NodeOrParent;
00510     }
00511 
00512     <span class="comment">//</span>
00513     <span class="comment">// Always splay the (possibly) new node.</span>
00514     <span class="comment">//</span>
00515 
00516     Table-&gt;TableRoot = <a class="code" href="../../d3/d4/splay_8c.html#a3">RtlSplay</a>(NodeToReturn);
00517 
00518     <span class="keywordflow">if</span> (ARGUMENT_PRESENT(NewElement)) {
00519 
00520         *NewElement = ((SearchResult == TableFoundNode)?(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>):(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>));
00521     }
00522 
00523     <span class="comment">//</span>
00524     <span class="comment">// Insert the element on the ordered list;</span>
00525     <span class="comment">//</span>
00526 
00527     <span class="keywordflow">return</span> &amp;((<a class="code" href="../../d3/d8/struct__TABLE__ENTRY__HEADER.html">PTABLE_ENTRY_HEADER</a>) NodeToReturn)-&gt;UserData;
00528 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a10" doxytag="gentable.c::RtlIsGenericTableEmpty" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN RtlIsGenericTableEmpty           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PRTL_GENERIC_TABLE&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Table</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d0/gentable_8c-source.html#l00851">851</a> of file <a class="el" href="../../d7/d0/gentable_8c-source.html">gentable.c</a>.
<p>
References <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d7/d0/gentable_8c-source.html#l00064">FindNodeOrParent()</a>, <a class="el" href="../../d7/d0/gentable_8c-source.html#l00738">RtlEnumerateGenericTable()</a>, and <a class="el" href="../../d7/d0/gentable_8c-source.html#l01110">RtlEnumerateGenericTableWithoutSplaying()</a>.
<p>
<pre class="fragment"><div>00857                    :
00858 
00859     The function IsGenericTableEmpty will <span class="keywordflow">return</span> to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> caller <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> <span class="keywordflow">if</span>
00860     <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> input table <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> empty (i.e., does not contain any elements) and
00861     <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a> otherwise.
00862 
00863 Arguments:
00864 
00865     Table - Supplies a pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> Generic Table.
00866 
00867 Return Value:
00868 
00869     BOOLEAN - <span class="keywordflow">if</span> enabled <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> tree <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> empty.
00870 
00871 --*/
00872 
00873 {
00874 
00875     <span class="comment">//</span>
00876     <span class="comment">// Table is empty if the root pointer is null.</span>
00877     <span class="comment">//</span>
00878 
00879     <span class="keywordflow">return</span> ((Table-&gt;TableRoot)?(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>):(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>));
00880 
00881 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a7" doxytag="gentable.c::RtlLookupElementGenericTable" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PVOID RtlLookupElementGenericTable           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PRTL_GENERIC_TABLE&nbsp;</td>
          <td class="mdname" nowrap> <em>Table</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>Buffer</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d0/gentable_8c-source.html#l00619">619</a> of file <a class="el" href="../../d7/d0/gentable_8c-source.html">gentable.c</a>.
<p>
References <a class="el" href="../../d7/d1/rtqkey_8c-source.html#l00042">Buffer</a>, and <a class="el" href="../../d7/d0/gentable_8c-source.html#l00669">RtlLookupElementGenericTableFull()</a>.
<p>
Referenced by <a class="el" href="../../d0/d7/udfs_2strucsup_8c-source.html#l01949">UdfLookupFcbTable()</a>.
<p>
<pre class="fragment"><div>00626                    :
00627 
00628     The function LookupElementGenericTable will find an element in a generic
00629     table.  If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> element <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> located <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <span class="keywordflow">return</span> value <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> a pointer to
00630     <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> user defined structure associated with <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> element, otherwise <span class="keywordflow">if</span>
00631     <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> element <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> not located <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <span class="keywordflow">return</span> value <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>.  The user supplied
00632     input buffer <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <a class="code" href="../../d3/d0/imm32_8def.html#a1">only</a> used as a key in locating <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> element in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> table.
00633 
00634 Arguments:
00635 
00636     Table - Pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> users Generic table to search <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> key.
00637 
00638     <a class="code" href="../../d6/d2/rtqkey_8c.html#a3">Buffer</a> - Used <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> comparasion.
00639 
00640 Return Value:
00641 
00642     PVOID - returns a pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> user data.
00643 
00644 --*/
00645 
00646 {
00647     <span class="comment">//</span>
00648     <span class="comment">// Holds a pointer to the node in the table or what would be the</span>
00649     <span class="comment">// parent of the node.</span>
00650     <span class="comment">//</span>
00651     PRTL_SPLAY_LINKS NodeOrParent;
00652 
00653     <span class="comment">//</span>
00654     <span class="comment">// Holds the result of the table lookup.</span>
00655     <span class="comment">//</span>
00656     TABLE_SEARCH_RESULT Lookup;
00657 
00658     <span class="keywordflow">return</span> <a class="code" href="../../d6/d1/gentable_8c.html#a8">RtlLookupElementGenericTableFull</a>(
00659                 Table,
00660                 Buffer,
00661                 &amp;NodeOrParent,
00662                 &amp;Lookup
00663                 );
00664 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a8" doxytag="gentable.c::RtlLookupElementGenericTableFull" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PVOID NTAPI RtlLookupElementGenericTableFull           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">PRTL_GENERIC_TABLE&nbsp;</td>
          <td class="mdname" nowrap> <em>Table</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>Buffer</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT PVOID *&nbsp;</td>
          <td class="mdname" nowrap> <em>NodeOrParent</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT TABLE_SEARCH_RESULT *&nbsp;</td>
          <td class="mdname" nowrap> <em>SearchResult</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d0/gentable_8c-source.html#l00669">669</a> of file <a class="el" href="../../d7/d0/gentable_8c-source.html">gentable.c</a>.
<p>
References <a class="el" href="../../d7/d1/rtqkey_8c-source.html#l00042">Buffer</a>, <a class="el" href="../../d7/d0/gentable_8c-source.html#l00064">FindNodeOrParent()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d6/d1/gentable_8c.html#a1">PTABLE_ENTRY_HEADER</a>, and <a class="el" href="../../d4/d3/splay_8c-source.html#l00051">RtlSplay()</a>.
<p>
Referenced by <a class="el" href="../../d7/d0/gentable_8c-source.html#l00619">RtlLookupElementGenericTable()</a>.
<p>
<pre class="fragment"><div>00678                    :
00679 
00680     The function LookupElementGenericTableFull will find an element in a generic
00681     table.  If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> element <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> located <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <span class="keywordflow">return</span> value <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> a pointer to
00682     <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> user defined structure associated with <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> element.  If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> element <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> not
00683     located then a pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> parent <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> insert location <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned.  The
00684     user must look at <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> SearchResult value to determine which <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> being returned.
00685     The user can use <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> SearchResult and parent <span class="keywordflow">for</span> a subsequent FullInsertElement
00686     call to optimize <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> insert.
00687 
00688 Arguments:
00689 
00690     Table - Pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> users Generic table to search <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> key.
00691 
00692     <a class="code" href="../../d6/d2/rtqkey_8c.html#a3">Buffer</a> - Used <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> comparasion.
00693 
00694     NodeOrParent - Address to store <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> desired Node or parent of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> desired node.
00695 
00696     SearchResult - Describes <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> relationship of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> NodeOrParent with <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> desired Node.
00697 
00698 Return Value:
00699 
00700     PVOID - returns a pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> user data.
00701 
00702 --*/
00703 
00704 {
00705 
00706     <span class="comment">//</span>
00707     <span class="comment">//  Lookup the element and save the result.</span>
00708     <span class="comment">//</span>
00709 
00710     *SearchResult = <a class="code" href="../../d6/d1/gentable_8c.html#a2">FindNodeOrParent</a>(
00711                         Table,
00712                         Buffer,
00713                         (PRTL_SPLAY_LINKS *)NodeOrParent
00714                         );
00715 
00716     <span class="keywordflow">if</span> ((*SearchResult == TableEmptyTree) || (*SearchResult != TableFoundNode)) {
00717 
00718         <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00719 
00720     } <span class="keywordflow">else</span> {
00721 
00722         <span class="comment">//</span>
00723         <span class="comment">// Splay the tree with this node.</span>
00724         <span class="comment">//</span>
00725 
00726         Table-&gt;TableRoot = <a class="code" href="../../d3/d4/splay_8c.html#a3">RtlSplay</a>(*NodeOrParent);
00727 
00728         <span class="comment">//</span>
00729         <span class="comment">// Return a pointer to the user data.</span>
00730         <span class="comment">//</span>
00731 
00732         <span class="keywordflow">return</span> &amp;((<a class="code" href="../../d3/d8/struct__TABLE__ENTRY__HEADER.html">PTABLE_ENTRY_HEADER</a>)*NodeOrParent)-&gt;UserData;
00733     }
00734 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a12" doxytag="gentable.c::RtlNumberGenericTableElements" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG RtlNumberGenericTableElements           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PRTL_GENERIC_TABLE&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Table</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d0/gentable_8c-source.html#l01079">1079</a> of file <a class="el" href="../../d7/d0/gentable_8c-source.html">gentable.c</a>.
<p>
<pre class="fragment"><div>01085                    :
01086 
01087     The function NumberGenericTableElements returns a ULONG value
01088     which <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> number of generic table elements currently inserted
01089     in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> generic table.
01090 
01091 Arguments:
01092 
01093     Table - Pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> generic table from which to find <a class="code" href="../../d6/d0/wsprintf_8c.html#a0">out</a> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> number
01094     of elements.
01095 
01096 
01097 Return Value:
01098 
01099     ULONG - The number of elements in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> generic table.
01100 
01101 --*/
01102 {
01103 
01104     <span class="keywordflow">return</span> Table-&gt;NumberGenericTableElements;
01105 
01106 }

</div></pre>    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:43:51 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
