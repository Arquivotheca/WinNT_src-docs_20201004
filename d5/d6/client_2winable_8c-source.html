<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: winable.c Source File</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>winable.c</h1><a href="../../d4/d7/client_2winable_8c.html">Go to the documentation of this file.</a><pre class="fragment"><div>00001 <span class="comment">/****************************** Module Header ******************************\</span>
00002 <span class="comment">* Module Name: winable.c</span>
00003 <span class="comment">*</span>
00004 <span class="comment">* Copyright (c) 1985 - 1999, Microsoft Corporation</span>
00005 <span class="comment">*</span>
00006 <span class="comment">* This module contains</span>
00007 <span class="comment">*</span>
00008 <span class="comment">* History:</span>
00009 <span class="comment">* 20-Feb-1992 DarrinM   Pulled functions from user\server.</span>
00010 <span class="comment">\***************************************************************************/</span>
00011 
00012 <span class="preprocessor">#include "<a class="code" href="../../d7/d3/w32_2ntuser_2client_2precomp_8h.html">precomp.h</a>"</span>
00013 <span class="preprocessor">#pragma hdrstop</span>
00014 <span class="preprocessor"></span>
00015 <span class="comment">/***************************************************************************\</span>
00016 <span class="comment">*</span>
00017 <span class="comment">* GetWindowInfo()</span>
00018 <span class="comment">* PRIVATE</span>
00019 <span class="comment">*</span>
00020 <span class="comment">* Gets information about a window in one self-consistent big block.</span>
00021 <span class="comment">*</span>
00022 <span class="comment">\***************************************************************************/</span>
00023 <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a> WINAPI
<a name="l00024"></a><a class="code" href="../../d4/d7/client_2winable_8c.html#a0">00024</a> <a class="code" href="../../d4/d7/client_2winable_8c.html#a0">GetWindowInfo</a>(HWND hwnd, PWINDOWINFO pwi)
00025 {
00026     <a class="code" href="../../d6/d9/structtagWND.html">PWND</a> pwnd;
00027     <a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a> cBorders;
00028     <a class="code" href="../../d7/d0/structtagCLS.html">PCLS</a> pclsT;
00029 
00030     <span class="keywordflow">if</span> (pwi-&gt;cbSize != <span class="keyword">sizeof</span>(WINDOWINFO)) {
00031         RIPERR1(ERROR_INVALID_PARAMETER, RIP_WARNING, <span class="stringliteral">"WINDOWINFO.cbSize %d is wrong"</span>, pwi-&gt;cbSize);
00032     }
00033     <span class="comment">/*</span>
00034 <span class="comment">     * Validate the window</span>
00035 <span class="comment">     */</span>
00036     pwnd = <a class="code" href="../../d4/d0/immcli_8h.html#a4">ValidateHwnd</a>(hwnd);
00037 
00038     <span class="keywordflow">if</span> (pwnd == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00039         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00040     }
00041 
00042     <span class="keywordflow">try</span> {
00043         <span class="comment">// Window rect</span>
00044         pwi-&gt;rcWindow = pwnd-&gt;<a class="code" href="../../d6/d9/structtagWND.html#o6">rcWindow</a>;
00045 
00046         <span class="comment">// Client rect</span>
00047         pwi-&gt;rcClient = pwnd-&gt;<a class="code" href="../../d6/d9/structtagWND.html#o7">rcClient</a>;
00048 
00049         <span class="comment">// Style</span>
00050         pwi-&gt;dwStyle = pwnd-&gt;style;
00051         pwi-&gt;dwExStyle = pwnd-&gt;ExStyle;
00052         pwi-&gt;dwWindowStatus = 0;
00053         <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a731">TestWF</a>(pwnd, <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a557">WFFRAMEON</a>))
00054             pwi-&gt;dwWindowStatus |= WS_ACTIVECAPTION;
00055 
00056         <span class="comment">// Borders</span>
00057         cBorders = <a class="code" href="../../d2/d8/rtl_2winmgr_8c.html#a7">GetWindowBorders</a>(pwnd-&gt;style, pwnd-&gt;ExStyle, <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>, <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00058         pwi-&gt;cxWindowBorders = cBorders * <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(CXBORDER);
00059         pwi-&gt;cyWindowBorders = cBorders * <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a18">SYSMET</a>(CYBORDER);
00060 
00061         <span class="comment">// Type</span>
00062         pclsT = (<a class="code" href="../../d7/d0/structtagCLS.html">PCLS</a>)<a class="code" href="../../d6/d0/usercli_8h.html#a24">REBASEALWAYS</a>(pwnd, pcls);
00063         pwi-&gt;atomWindowType = pclsT-&gt;<a class="code" href="../../d7/d0/structtagCLS.html#o1">atomClassName</a>;
00064 
00065         <span class="comment">// Version</span>
00066         <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a731">TestWF</a>(pwnd, <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a594">WFWIN50COMPAT</a>)) {
00067             pwi-&gt;wCreatorVersion = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a100">VER50</a>;
00068         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a731">TestWF</a>(pwnd, <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a593">WFWIN40COMPAT</a>)) {
00069             pwi-&gt;wCreatorVersion = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a101">VER40</a>;
00070         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a731">TestWF</a>(pwnd, <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a592">WFWIN31COMPAT</a>)) {
00071             pwi-&gt;wCreatorVersion = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a102">VER31</a>;
00072         } <span class="keywordflow">else</span> {
00073             pwi-&gt;wCreatorVersion = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a103">VER30</a>;
00074         }
00075     } except (W32ExceptionHandler(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>, RIP_WARNING)) {
00076         RIPERR1(ERROR_INVALID_WINDOW_HANDLE,
00077                 RIP_WARNING,
00078                 <span class="stringliteral">"Window %x no longer valid"</span>,
00079                 hwnd);
00080         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00081     }
00082 
00083     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00084 }
</div></pre><hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:42:24 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
