<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: tsevars.c Source File</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>tsevars.c</h1><a href="../../d4/d6/tsevars_8c.html">Go to the documentation of this file.</a><pre class="fragment"><div>00001 <span class="comment">/*++</span>
00002 <span class="comment"></span>
00003 <span class="comment">Copyright (c) 1989  Microsoft Corporation</span>
00004 <span class="comment"></span>
00005 <span class="comment">Module Name:</span>
00006 <span class="comment"></span>
00007 <span class="comment">    tsevars.c</span>
00008 <span class="comment"></span>
00009 <span class="comment">Abstract:</span>
00010 <span class="comment"></span>
00011 <span class="comment">    This Module contains variables used in security test routines.</span>
00012 <span class="comment"></span>
00013 <span class="comment"></span>
00014 <span class="comment">Author:</span>
00015 <span class="comment"></span>
00016 <span class="comment">    Jim Kelly       (JimK)     23-Mar-1990</span>
00017 <span class="comment"></span>
00018 <span class="comment">Environment:</span>
00019 <span class="comment"></span>
00020 <span class="comment">    Test.</span>
00021 <span class="comment"></span>
00022 <span class="comment">Revision History:</span>
00023 <span class="comment"></span>
00024 <span class="comment">--*/</span>
00025 
00026 <span class="preprocessor">#include "<a class="code" href="../../d2/d6/tsecomm_8c.html">tsecomm.c</a>"</span>    <span class="comment">// Mode dependent macros and routines.</span>
00027 
00028 
00029 <span class="preprocessor">#ifndef _TSEVARS_</span>
00030 <span class="preprocessor"></span><span class="preprocessor">#define _TSEVARS_</span>
00031 <span class="preprocessor"></span>
00032 
00033 
00034 
<a name="l00035"></a><a class="code" href="../../d4/d6/tsevars_8c.html#a66">00035</a> <span class="keyword">typedef</span> <span class="keyword">enum</span> <a class="code" href="../../d4/d6/tsevars_8c.html#a66">_USERS</a> {
00036     <a class="code" href="../../d4/d6/tsevars_8c.html#a66a58">Fred</a>,
00037     <a class="code" href="../../d4/d6/tsevars_8c.html#a66a59">Wilma</a>,
00038     <a class="code" href="../../d4/d6/tsevars_8c.html#a66a60">Pebbles</a>,
00039     <a class="code" href="../../d4/d6/tsevars_8c.html#a66a61">Barney</a>,
00040     <a class="code" href="../../d4/d6/tsevars_8c.html#a66a62">Betty</a>,
00041     <a class="code" href="../../d4/d6/tsevars_8c.html#a66a63">Bambam</a>,
00042     <a class="code" href="../../d4/d6/tsevars_8c.html#a66a64">Dino</a>
00043 } <a class="code" href="../../d4/d6/tsevars_8c.html#a16">USERS</a>;
00044 
00045 
00046 
00047 <span class="comment">//</span>
00048 <span class="comment">// Define the Bedrock domain and its inhabitants</span>
00049 <span class="comment">//</span>
00050 <span class="comment">//     Bedrock Domain      S-1-39824-21-3-17</span>
00051 <span class="comment">//     Fred                S-1-39824-21-3-17-2</span>
00052 <span class="comment">//     Wilma               S-1-39824-21-3-17-3</span>
00053 <span class="comment">//     Pebbles             S-1-39824-21-3-17-4</span>
00054 <span class="comment">//     Dino                S-1-39824-21-3-17-5</span>
00055 <span class="comment">//     Barney              S-1-39824-21-3-17-6</span>
00056 <span class="comment">//     Betty               S-1-39824-21-3-17-7</span>
00057 <span class="comment">//     Bambam              S-1-39824-21-3-17-8</span>
00058 <span class="comment">//     Flintstone          S-1-39824-21-3-17-9</span>
00059 <span class="comment">//     Rubble              S-1-39824-21-3-17-10</span>
00060 <span class="comment">//     Adult               S-1-39824-21-3-17-11</span>
00061 <span class="comment">//     Child               S-1-39824-21-3-17-12</span>
00062 <span class="comment">//     Neanderthol         S-1-39824-21-3-17-13</span>
00063 <span class="comment">//</span>
00064 
<a name="l00065"></a><a class="code" href="../../d4/d6/tsevars_8c.html#a0">00065</a> <span class="preprocessor">#define BEDROCK_AUTHORITY               {0,0,0,0,155,144}</span>
<a name="l00066"></a><a class="code" href="../../d4/d6/tsevars_8c.html#a1">00066</a> <span class="preprocessor"></span><span class="preprocessor">#define BEDROCK_SUBAUTHORITY_0          0x00000015L</span>
<a name="l00067"></a><a class="code" href="../../d4/d6/tsevars_8c.html#a2">00067</a> <span class="preprocessor"></span><span class="preprocessor">#define BEDROCK_SUBAUTHORITY_1          0x00000003L</span>
<a name="l00068"></a><a class="code" href="../../d4/d6/tsevars_8c.html#a3">00068</a> <span class="preprocessor"></span><span class="preprocessor">#define BEDROCK_SUBAUTHORITY_2          0x00000011L</span>
00069 <span class="preprocessor"></span>
<a name="l00070"></a><a class="code" href="../../d4/d6/tsevars_8c.html#a4">00070</a> <span class="preprocessor">#define FRED_RID                        0x00000002L</span>
<a name="l00071"></a><a class="code" href="../../d4/d6/tsevars_8c.html#a5">00071</a> <span class="preprocessor"></span><span class="preprocessor">#define WILMA_RID                       0x00000003L</span>
<a name="l00072"></a><a class="code" href="../../d4/d6/tsevars_8c.html#a6">00072</a> <span class="preprocessor"></span><span class="preprocessor">#define PEBBLES_RID                     0x00000004L</span>
<a name="l00073"></a><a class="code" href="../../d4/d6/tsevars_8c.html#a7">00073</a> <span class="preprocessor"></span><span class="preprocessor">#define DINO_RID                        0x00000005L</span>
00074 <span class="preprocessor"></span>
<a name="l00075"></a><a class="code" href="../../d4/d6/tsevars_8c.html#a8">00075</a> <span class="preprocessor">#define BARNEY_RID                      0x00000006L</span>
<a name="l00076"></a><a class="code" href="../../d4/d6/tsevars_8c.html#a9">00076</a> <span class="preprocessor"></span><span class="preprocessor">#define BETTY_RID                       0x00000007L</span>
<a name="l00077"></a><a class="code" href="../../d4/d6/tsevars_8c.html#a10">00077</a> <span class="preprocessor"></span><span class="preprocessor">#define BAMBAM_RID                      0x00000008L</span>
00078 <span class="preprocessor"></span>
<a name="l00079"></a><a class="code" href="../../d4/d6/tsevars_8c.html#a11">00079</a> <span class="preprocessor">#define FLINTSTONE_RID                  0x00000009L</span>
<a name="l00080"></a><a class="code" href="../../d4/d6/tsevars_8c.html#a12">00080</a> <span class="preprocessor"></span><span class="preprocessor">#define RUBBLE_RID                      0x0000000AL</span>
00081 <span class="preprocessor"></span>
<a name="l00082"></a><a class="code" href="../../d4/d6/tsevars_8c.html#a13">00082</a> <span class="preprocessor">#define ADULT_RID                       0x0000000BL</span>
<a name="l00083"></a><a class="code" href="../../d4/d6/tsevars_8c.html#a14">00083</a> <span class="preprocessor"></span><span class="preprocessor">#define CHILD_RID                       0x0000000CL</span>
00084 <span class="preprocessor"></span>
<a name="l00085"></a><a class="code" href="../../d4/d6/tsevars_8c.html#a15">00085</a> <span class="preprocessor">#define NEANDERTHOL_RID                 0x0000000DL</span>
00086 <span class="preprocessor"></span>
00087 
<a name="l00088"></a><a class="code" href="../../d4/d6/tsevars_8c.html#a17">00088</a> PSID <a class="code" href="../../d4/d6/tsevars_8c.html#a17">BedrockDomainSid</a>;
00089 
00090 
<a name="l00091"></a><a class="code" href="../../d4/d6/tsevars_8c.html#a18">00091</a> PSID  <a class="code" href="../../d4/d6/tsevars_8c.html#a18">FredSid</a>;
<a name="l00092"></a><a class="code" href="../../d4/d6/tsevars_8c.html#a19">00092</a> PSID  <a class="code" href="../../d4/d6/tsevars_8c.html#a19">WilmaSid</a>;
<a name="l00093"></a><a class="code" href="../../d4/d6/tsevars_8c.html#a20">00093</a> PSID  <a class="code" href="../../d4/d6/tsevars_8c.html#a20">PebblesSid</a>;
<a name="l00094"></a><a class="code" href="../../d4/d6/tsevars_8c.html#a21">00094</a> PSID  <a class="code" href="../../d4/d6/tsevars_8c.html#a21">DinoSid</a>;
00095 
<a name="l00096"></a><a class="code" href="../../d4/d6/tsevars_8c.html#a22">00096</a> PSID  <a class="code" href="../../d4/d6/tsevars_8c.html#a22">BarneySid</a>;
<a name="l00097"></a><a class="code" href="../../d4/d6/tsevars_8c.html#a23">00097</a> PSID  <a class="code" href="../../d4/d6/tsevars_8c.html#a23">BettySid</a>;
<a name="l00098"></a><a class="code" href="../../d4/d6/tsevars_8c.html#a24">00098</a> PSID  <a class="code" href="../../d4/d6/tsevars_8c.html#a24">BambamSid</a>;
00099 
<a name="l00100"></a><a class="code" href="../../d4/d6/tsevars_8c.html#a25">00100</a> PSID  <a class="code" href="../../d4/d6/tsevars_8c.html#a25">FlintstoneSid</a>;
<a name="l00101"></a><a class="code" href="../../d4/d6/tsevars_8c.html#a26">00101</a> PSID  <a class="code" href="../../d4/d6/tsevars_8c.html#a26">RubbleSid</a>;
00102 
<a name="l00103"></a><a class="code" href="../../d4/d6/tsevars_8c.html#a27">00103</a> PSID  <a class="code" href="../../d4/d6/tsevars_8c.html#a27">AdultSid</a>;
<a name="l00104"></a><a class="code" href="../../d4/d6/tsevars_8c.html#a28">00104</a> PSID  <a class="code" href="../../d4/d6/tsevars_8c.html#a28">ChildSid</a>;
00105 
<a name="l00106"></a><a class="code" href="../../d4/d6/tsevars_8c.html#a29">00106</a> PSID  <a class="code" href="../../d4/d6/tsevars_8c.html#a29">NeandertholSid</a>;
00107 
00108 
00109 <span class="comment">//</span>
00110 <span class="comment">// Universal well known SIDs</span>
00111 <span class="comment">//</span>
00112 
<a name="l00113"></a><a class="code" href="../../d4/d6/tsevars_8c.html#a30">00113</a> PSID  <a class="code" href="../../d4/d1/rtdmpsec_8c.html#a7">NullSid</a>;
<a name="l00114"></a><a class="code" href="../../d4/d6/tsevars_8c.html#a31">00114</a> PSID  <a class="code" href="../../d4/d1/rtdmpsec_8c.html#a8">WorldSid</a>;
<a name="l00115"></a><a class="code" href="../../d4/d6/tsevars_8c.html#a32">00115</a> PSID  <a class="code" href="../../d4/d1/rtdmpsec_8c.html#a9">LocalSid</a>;
<a name="l00116"></a><a class="code" href="../../d4/d6/tsevars_8c.html#a33">00116</a> PSID  <a class="code" href="../../d4/d6/tsevars_8c.html#a33">CreatorSid</a>;
00117 
00118 <span class="comment">//</span>
00119 <span class="comment">// Sids defined by NT</span>
00120 <span class="comment">//</span>
00121 
<a name="l00122"></a><a class="code" href="../../d4/d6/tsevars_8c.html#a34">00122</a> PSID <a class="code" href="../../d4/d1/rtdmpsec_8c.html#a11">NtAuthoritySid</a>;
00123 
<a name="l00124"></a><a class="code" href="../../d4/d6/tsevars_8c.html#a35">00124</a> PSID <a class="code" href="../../d4/d1/rtdmpsec_8c.html#a12">DialupSid</a>;
<a name="l00125"></a><a class="code" href="../../d4/d6/tsevars_8c.html#a36">00125</a> PSID <a class="code" href="../../d4/d1/rtdmpsec_8c.html#a13">NetworkSid</a>;
<a name="l00126"></a><a class="code" href="../../d4/d6/tsevars_8c.html#a37">00126</a> PSID <a class="code" href="../../d4/d1/rtdmpsec_8c.html#a14">BatchSid</a>;
<a name="l00127"></a><a class="code" href="../../d4/d6/tsevars_8c.html#a38">00127</a> PSID <a class="code" href="../../d4/d1/rtdmpsec_8c.html#a15">InteractiveSid</a>;
<a name="l00128"></a><a class="code" href="../../d4/d6/tsevars_8c.html#a39">00128</a> PSID <a class="code" href="../../d4/d1/rtdmpsec_8c.html#a16">LocalSystemSid</a>;
00129 
00130 
00131 
00132 
00133 
00135 <span class="comment">//                                                                    //</span>
00136 <span class="comment">//         Define the well known privileges                           //</span>
00137 <span class="comment">//                                                                    //</span>
00139 <span class="comment"></span>
00140 
<a name="l00141"></a><a class="code" href="../../d4/d6/tsevars_8c.html#a40">00141</a> LUID <a class="code" href="../../d4/d6/tsevars_8c.html#a40">CreateTokenPrivilege</a>;
<a name="l00142"></a><a class="code" href="../../d4/d6/tsevars_8c.html#a41">00142</a> LUID <a class="code" href="../../d4/d6/tsevars_8c.html#a41">AssignPrimaryTokenPrivilege</a>;
<a name="l00143"></a><a class="code" href="../../d4/d6/tsevars_8c.html#a42">00143</a> LUID <a class="code" href="../../d4/d6/tsevars_8c.html#a42">LockMemoryPrivilege</a>;
<a name="l00144"></a><a class="code" href="../../d4/d6/tsevars_8c.html#a43">00144</a> LUID <a class="code" href="../../d4/d6/tsevars_8c.html#a43">IncreaseQuotaPrivilege</a>;
<a name="l00145"></a><a class="code" href="../../d4/d6/tsevars_8c.html#a44">00145</a> LUID <a class="code" href="../../d4/d6/tsevars_8c.html#a44">UnsolicitedInputPrivilege</a>;
<a name="l00146"></a><a class="code" href="../../d4/d6/tsevars_8c.html#a45">00146</a> LUID <a class="code" href="../../d4/d6/tsevars_8c.html#a45">TcbPrivilege</a>;
<a name="l00147"></a><a class="code" href="../../d4/d6/tsevars_8c.html#a46">00147</a> LUID <a class="code" href="../../d4/d6/tsevars_8c.html#a46">SecurityPrivilege</a>;
00148 
<a name="l00149"></a><a class="code" href="../../d4/d6/tsevars_8c.html#a47">00149</a> LUID <a class="code" href="../../d4/d6/tsevars_8c.html#a47">TakeOwnershipPrivilege</a>;
<a name="l00150"></a><a class="code" href="../../d4/d6/tsevars_8c.html#a48">00150</a> LUID <a class="code" href="../../d4/d6/tsevars_8c.html#a48">CreatePagefilePrivilege</a>;
<a name="l00151"></a><a class="code" href="../../d4/d6/tsevars_8c.html#a49">00151</a> LUID <a class="code" href="../../d4/d6/tsevars_8c.html#a49">IncreaseBasePriorityPrivilege</a>;
<a name="l00152"></a><a class="code" href="../../d4/d6/tsevars_8c.html#a50">00152</a> LUID <a class="code" href="../../d4/d6/tsevars_8c.html#a50">SystemProfilePrivilege</a>;
<a name="l00153"></a><a class="code" href="../../d4/d6/tsevars_8c.html#a51">00153</a> LUID <a class="code" href="../../d4/d6/tsevars_8c.html#a51">SystemtimePrivilege</a>;
<a name="l00154"></a><a class="code" href="../../d4/d6/tsevars_8c.html#a52">00154</a> LUID <a class="code" href="../../d4/d6/tsevars_8c.html#a52">ProfileSingleProcessPrivilege</a>;
00155 
<a name="l00156"></a><a class="code" href="../../d4/d6/tsevars_8c.html#a53">00156</a> LUID <a class="code" href="../../d4/d6/tsevars_8c.html#a53">RestorePrivilege</a>;
<a name="l00157"></a><a class="code" href="../../d4/d6/tsevars_8c.html#a54">00157</a> LUID <a class="code" href="../../d4/d6/tsevars_8c.html#a54">BackupPrivilege</a>;
<a name="l00158"></a><a class="code" href="../../d4/d6/tsevars_8c.html#a55">00158</a> LUID <a class="code" href="../../d4/d6/tsevars_8c.html#a55">CreatePermanentPrivilege</a>;
<a name="l00159"></a><a class="code" href="../../d4/d6/tsevars_8c.html#a56">00159</a> LUID <a class="code" href="../../d4/d6/tsevars_8c.html#a56">ShutdownPrivilege</a>;
<a name="l00160"></a><a class="code" href="../../d4/d6/tsevars_8c.html#a57">00160</a> LUID <a class="code" href="../../d4/d6/tsevars_8c.html#a57">DebugPrivilege</a>;
00161 
00162 
00163 
00164 
00165 
00166 BOOLEAN
<a name="l00167"></a><a class="code" href="../../d4/d6/tsevars_8c.html#a65">00167</a> <a class="code" href="../../d4/d6/tsevars_8c.html#a65">TSeVariableInitialization</a>()
00168 <span class="comment">/*++</span>
00169 <span class="comment"></span>
00170 <span class="comment">Routine Description:</span>
00171 <span class="comment"></span>
00172 <span class="comment">    This function initializes the global variables used in security</span>
00173 <span class="comment">    tests.</span>
00174 <span class="comment"></span>
00175 <span class="comment">Arguments:</span>
00176 <span class="comment"></span>
00177 <span class="comment">    None.</span>
00178 <span class="comment"></span>
00179 <span class="comment">Return Value:</span>
00180 <span class="comment"></span>
00181 <span class="comment">    TRUE if variables successfully initialized.</span>
00182 <span class="comment">    FALSE if not successfully initialized.</span>
00183 <span class="comment"></span>
00184 <span class="comment">--*/</span>
00185 {
00186     ULONG SidWithZeroSubAuthorities;
00187     ULONG SidWithOneSubAuthority;
00188     ULONG SidWithThreeSubAuthorities;
00189     ULONG SidWithFourSubAuthorities;
00190 
00191     SID_IDENTIFIER_AUTHORITY NullSidAuthority    = SECURITY_NULL_SID_AUTHORITY;
00192     SID_IDENTIFIER_AUTHORITY WorldSidAuthority   = SECURITY_WORLD_SID_AUTHORITY;
00193     SID_IDENTIFIER_AUTHORITY LocalSidAuthority   = SECURITY_LOCAL_SID_AUTHORITY;
00194     SID_IDENTIFIER_AUTHORITY CreatorSidAuthority = SECURITY_CREATOR_SID_AUTHORITY;
00195 
00196     SID_IDENTIFIER_AUTHORITY NtAuthority = SECURITY_NT_AUTHORITY;
00197 
00198 
00199     SID_IDENTIFIER_AUTHORITY BedrockAuthority = <a class="code" href="../../d4/d6/tsevars_8c.html#a0">BEDROCK_AUTHORITY</a>;
00200 
00201 
00202     <span class="comment">//</span>
00203     <span class="comment">//  The following SID sizes need to be allocated</span>
00204     <span class="comment">//</span>
00205 
00206     SidWithZeroSubAuthorities  = <a class="code" href="../../d8/d6/sertl_8c.html#a38">RtlLengthRequiredSid</a>( 0 );
00207     SidWithOneSubAuthority     = <a class="code" href="../../d8/d6/sertl_8c.html#a38">RtlLengthRequiredSid</a>( 1 );
00208     SidWithThreeSubAuthorities = <a class="code" href="../../d8/d6/sertl_8c.html#a38">RtlLengthRequiredSid</a>( 3 );
00209     SidWithFourSubAuthorities  = <a class="code" href="../../d8/d6/sertl_8c.html#a38">RtlLengthRequiredSid</a>( 4 );
00210 
00211     <span class="comment">//</span>
00212     <span class="comment">//  Allocate and initialize the universal SIDs</span>
00213     <span class="comment">//</span>
00214 
00215     <a class="code" href="../../d4/d1/rtdmpsec_8c.html#a7">NullSid</a>    = (PSID)TstAllocatePool(<a class="code" href="../../d5/d8/ex_8h.html#a329a174">PagedPool</a>,SidWithOneSubAuthority);
00216     <a class="code" href="../../d4/d1/rtdmpsec_8c.html#a8">WorldSid</a>   = (PSID)TstAllocatePool(<a class="code" href="../../d5/d8/ex_8h.html#a329a174">PagedPool</a>,SidWithOneSubAuthority);
00217     <a class="code" href="../../d4/d1/rtdmpsec_8c.html#a9">LocalSid</a>   = (PSID)TstAllocatePool(<a class="code" href="../../d5/d8/ex_8h.html#a329a174">PagedPool</a>,SidWithOneSubAuthority);
00218     <a class="code" href="../../d4/d6/tsevars_8c.html#a33">CreatorSid</a> = (PSID)TstAllocatePool(<a class="code" href="../../d5/d8/ex_8h.html#a329a174">PagedPool</a>,SidWithOneSubAuthority);
00219 
00220     <a class="code" href="../../d8/d6/sertl_8c.html#a40">RtlInitializeSid</a>( <a class="code" href="../../d4/d1/rtdmpsec_8c.html#a7">NullSid</a>,    &amp;NullSidAuthority, 1 );
00221     <a class="code" href="../../d8/d6/sertl_8c.html#a40">RtlInitializeSid</a>( <a class="code" href="../../d4/d1/rtdmpsec_8c.html#a8">WorldSid</a>,   &amp;WorldSidAuthority, 1 );
00222     <a class="code" href="../../d8/d6/sertl_8c.html#a40">RtlInitializeSid</a>( <a class="code" href="../../d4/d1/rtdmpsec_8c.html#a9">LocalSid</a>,   &amp;LocalSidAuthority, 1 );
00223     <a class="code" href="../../d8/d6/sertl_8c.html#a40">RtlInitializeSid</a>( <a class="code" href="../../d4/d6/tsevars_8c.html#a33">CreatorSid</a>, &amp;CreatorSidAuthority, 1 );
00224 
00225     *(<a class="code" href="../../d8/d6/sertl_8c.html#a43">RtlSubAuthoritySid</a>( <a class="code" href="../../d4/d1/rtdmpsec_8c.html#a7">NullSid</a>, 0 ))    = SECURITY_NULL_RID;
00226     *(<a class="code" href="../../d8/d6/sertl_8c.html#a43">RtlSubAuthoritySid</a>( <a class="code" href="../../d4/d1/rtdmpsec_8c.html#a8">WorldSid</a>, 0 ))   = SECURITY_WORLD_RID;
00227     *(<a class="code" href="../../d8/d6/sertl_8c.html#a43">RtlSubAuthoritySid</a>( <a class="code" href="../../d4/d1/rtdmpsec_8c.html#a9">LocalSid</a>, 0 ))   = SECURITY_LOCAL_RID;
00228     *(<a class="code" href="../../d8/d6/sertl_8c.html#a43">RtlSubAuthoritySid</a>( <a class="code" href="../../d4/d6/tsevars_8c.html#a33">CreatorSid</a>, 0 )) = SECURITY_CREATOR_OWNER_RID;
00229 
00230     <span class="comment">//</span>
00231     <span class="comment">// Allocate and initialize the NT defined SIDs</span>
00232     <span class="comment">//</span>
00233 
00234     <a class="code" href="../../d4/d1/rtdmpsec_8c.html#a11">NtAuthoritySid</a>  = (PSID)TstAllocatePool(<a class="code" href="../../d5/d8/ex_8h.html#a329a174">PagedPool</a>,SidWithZeroSubAuthorities);
00235     <a class="code" href="../../d4/d1/rtdmpsec_8c.html#a12">DialupSid</a>       = (PSID)TstAllocatePool(<a class="code" href="../../d5/d8/ex_8h.html#a329a174">PagedPool</a>,SidWithOneSubAuthority);
00236     <a class="code" href="../../d4/d1/rtdmpsec_8c.html#a13">NetworkSid</a>      = (PSID)TstAllocatePool(<a class="code" href="../../d5/d8/ex_8h.html#a329a174">PagedPool</a>,SidWithOneSubAuthority);
00237     <a class="code" href="../../d4/d1/rtdmpsec_8c.html#a14">BatchSid</a>        = (PSID)TstAllocatePool(<a class="code" href="../../d5/d8/ex_8h.html#a329a174">PagedPool</a>,SidWithOneSubAuthority);
00238     <a class="code" href="../../d4/d1/rtdmpsec_8c.html#a15">InteractiveSid</a>  = (PSID)TstAllocatePool(<a class="code" href="../../d5/d8/ex_8h.html#a329a174">PagedPool</a>,SidWithOneSubAuthority);
00239     <a class="code" href="../../d4/d1/rtdmpsec_8c.html#a16">LocalSystemSid</a>  = (PSID)TstAllocatePool(<a class="code" href="../../d5/d8/ex_8h.html#a329a174">PagedPool</a>,SidWithOneSubAuthority);
00240 
00241     <a class="code" href="../../d8/d6/sertl_8c.html#a40">RtlInitializeSid</a>( <a class="code" href="../../d4/d1/rtdmpsec_8c.html#a11">NtAuthoritySid</a>,   &amp;NtAuthority, 0 );
00242     <a class="code" href="../../d8/d6/sertl_8c.html#a40">RtlInitializeSid</a>( <a class="code" href="../../d4/d1/rtdmpsec_8c.html#a12">DialupSid</a>,        &amp;NtAuthority, 1 );
00243     <a class="code" href="../../d8/d6/sertl_8c.html#a40">RtlInitializeSid</a>( <a class="code" href="../../d4/d1/rtdmpsec_8c.html#a13">NetworkSid</a>,       &amp;NtAuthority, 1 );
00244     <a class="code" href="../../d8/d6/sertl_8c.html#a40">RtlInitializeSid</a>( <a class="code" href="../../d4/d1/rtdmpsec_8c.html#a14">BatchSid</a>,         &amp;NtAuthority, 1 );
00245     <a class="code" href="../../d8/d6/sertl_8c.html#a40">RtlInitializeSid</a>( <a class="code" href="../../d4/d1/rtdmpsec_8c.html#a15">InteractiveSid</a>,   &amp;NtAuthority, 1 );
00246     <a class="code" href="../../d8/d6/sertl_8c.html#a40">RtlInitializeSid</a>( <a class="code" href="../../d4/d1/rtdmpsec_8c.html#a16">LocalSystemSid</a>,   &amp;NtAuthority, 1 );
00247 
00248     *(<a class="code" href="../../d8/d6/sertl_8c.html#a43">RtlSubAuthoritySid</a>( <a class="code" href="../../d4/d1/rtdmpsec_8c.html#a12">DialupSid</a>,       0 )) = SECURITY_DIALUP_RID;
00249     *(<a class="code" href="../../d8/d6/sertl_8c.html#a43">RtlSubAuthoritySid</a>( <a class="code" href="../../d4/d1/rtdmpsec_8c.html#a13">NetworkSid</a>,      0 )) = SECURITY_NETWORK_RID;
00250     *(<a class="code" href="../../d8/d6/sertl_8c.html#a43">RtlSubAuthoritySid</a>( <a class="code" href="../../d4/d1/rtdmpsec_8c.html#a14">BatchSid</a>,        0 )) = SECURITY_BATCH_RID;
00251     *(<a class="code" href="../../d8/d6/sertl_8c.html#a43">RtlSubAuthoritySid</a>( <a class="code" href="../../d4/d1/rtdmpsec_8c.html#a15">InteractiveSid</a>,  0 )) = SECURITY_INTERACTIVE_RID;
00252     *(<a class="code" href="../../d8/d6/sertl_8c.html#a43">RtlSubAuthoritySid</a>( <a class="code" href="../../d4/d1/rtdmpsec_8c.html#a16">LocalSystemSid</a>,  0 )) = SECURITY_LOCAL_SYSTEM_RID;
00253 
00254 
00255 
00256     <span class="comment">//</span>
00257     <span class="comment">// Allocate and initialize the Bedrock SIDs</span>
00258     <span class="comment">//</span>
00259 
00260     <a class="code" href="../../d4/d6/tsevars_8c.html#a17">BedrockDomainSid</a>  = (PSID)TstAllocatePool(<a class="code" href="../../d5/d8/ex_8h.html#a329a174">PagedPool</a>,SidWithThreeSubAuthorities);
00261 
00262     <a class="code" href="../../d4/d6/tsevars_8c.html#a18">FredSid</a>           = (PSID)TstAllocatePool(<a class="code" href="../../d5/d8/ex_8h.html#a329a174">PagedPool</a>,SidWithFourSubAuthorities);
00263     <a class="code" href="../../d4/d6/tsevars_8c.html#a19">WilmaSid</a>          = (PSID)TstAllocatePool(<a class="code" href="../../d5/d8/ex_8h.html#a329a174">PagedPool</a>,SidWithFourSubAuthorities);
00264     <a class="code" href="../../d4/d6/tsevars_8c.html#a20">PebblesSid</a>        = (PSID)TstAllocatePool(<a class="code" href="../../d5/d8/ex_8h.html#a329a174">PagedPool</a>,SidWithFourSubAuthorities);
00265     <a class="code" href="../../d4/d6/tsevars_8c.html#a21">DinoSid</a>           = (PSID)TstAllocatePool(<a class="code" href="../../d5/d8/ex_8h.html#a329a174">PagedPool</a>,SidWithFourSubAuthorities);
00266 
00267     <a class="code" href="../../d4/d6/tsevars_8c.html#a22">BarneySid</a>         = (PSID)TstAllocatePool(<a class="code" href="../../d5/d8/ex_8h.html#a329a174">PagedPool</a>,SidWithFourSubAuthorities);
00268     <a class="code" href="../../d4/d6/tsevars_8c.html#a23">BettySid</a>          = (PSID)TstAllocatePool(<a class="code" href="../../d5/d8/ex_8h.html#a329a174">PagedPool</a>,SidWithFourSubAuthorities);
00269     <a class="code" href="../../d4/d6/tsevars_8c.html#a24">BambamSid</a>         = (PSID)TstAllocatePool(<a class="code" href="../../d5/d8/ex_8h.html#a329a174">PagedPool</a>,SidWithFourSubAuthorities);
00270 
00271     <a class="code" href="../../d4/d6/tsevars_8c.html#a25">FlintstoneSid</a>     = (PSID)TstAllocatePool(<a class="code" href="../../d5/d8/ex_8h.html#a329a174">PagedPool</a>,SidWithFourSubAuthorities);
00272     <a class="code" href="../../d4/d6/tsevars_8c.html#a26">RubbleSid</a>         = (PSID)TstAllocatePool(<a class="code" href="../../d5/d8/ex_8h.html#a329a174">PagedPool</a>,SidWithFourSubAuthorities);
00273 
00274     <a class="code" href="../../d4/d6/tsevars_8c.html#a27">AdultSid</a>          = (PSID)TstAllocatePool(<a class="code" href="../../d5/d8/ex_8h.html#a329a174">PagedPool</a>,SidWithFourSubAuthorities);
00275     <a class="code" href="../../d4/d6/tsevars_8c.html#a28">ChildSid</a>          = (PSID)TstAllocatePool(<a class="code" href="../../d5/d8/ex_8h.html#a329a174">PagedPool</a>,SidWithFourSubAuthorities);
00276 
00277     <a class="code" href="../../d4/d6/tsevars_8c.html#a29">NeandertholSid</a>    = (PSID)TstAllocatePool(<a class="code" href="../../d5/d8/ex_8h.html#a329a174">PagedPool</a>,SidWithFourSubAuthorities);
00278 
00279     <a class="code" href="../../d8/d6/sertl_8c.html#a40">RtlInitializeSid</a>( <a class="code" href="../../d4/d6/tsevars_8c.html#a17">BedrockDomainSid</a>,   &amp;BedrockAuthority, 3 );
00280     *(<a class="code" href="../../d8/d6/sertl_8c.html#a43">RtlSubAuthoritySid</a>( <a class="code" href="../../d4/d6/tsevars_8c.html#a17">BedrockDomainSid</a>, 0)) = <a class="code" href="../../d4/d6/tsevars_8c.html#a1">BEDROCK_SUBAUTHORITY_0</a>;
00281     *(<a class="code" href="../../d8/d6/sertl_8c.html#a43">RtlSubAuthoritySid</a>( <a class="code" href="../../d4/d6/tsevars_8c.html#a17">BedrockDomainSid</a>, 1)) = <a class="code" href="../../d4/d6/tsevars_8c.html#a2">BEDROCK_SUBAUTHORITY_1</a>;
00282     *(<a class="code" href="../../d8/d6/sertl_8c.html#a43">RtlSubAuthoritySid</a>( <a class="code" href="../../d4/d6/tsevars_8c.html#a17">BedrockDomainSid</a>, 2)) = <a class="code" href="../../d4/d6/tsevars_8c.html#a3">BEDROCK_SUBAUTHORITY_2</a>;
00283 
00284     <a class="code" href="../../d8/d6/sertl_8c.html#a46">RtlCopySid</a>( SidWithFourSubAuthorities, <a class="code" href="../../d4/d6/tsevars_8c.html#a18">FredSid</a>, <a class="code" href="../../d4/d6/tsevars_8c.html#a17">BedrockDomainSid</a>);
00285     *(<a class="code" href="../../d8/d6/sertl_8c.html#a44">RtlSubAuthorityCountSid</a>( <a class="code" href="../../d4/d6/tsevars_8c.html#a18">FredSid</a> )) += 1;
00286     *(<a class="code" href="../../d8/d6/sertl_8c.html#a43">RtlSubAuthoritySid</a>( <a class="code" href="../../d4/d6/tsevars_8c.html#a18">FredSid</a>, 3)) = <a class="code" href="../../d4/d6/tsevars_8c.html#a4">FRED_RID</a>;
00287 
00288     <a class="code" href="../../d8/d6/sertl_8c.html#a46">RtlCopySid</a>( SidWithFourSubAuthorities, <a class="code" href="../../d4/d6/tsevars_8c.html#a19">WilmaSid</a>, <a class="code" href="../../d4/d6/tsevars_8c.html#a17">BedrockDomainSid</a>);
00289     *(<a class="code" href="../../d8/d6/sertl_8c.html#a44">RtlSubAuthorityCountSid</a>( <a class="code" href="../../d4/d6/tsevars_8c.html#a19">WilmaSid</a> )) += 1;
00290     *(<a class="code" href="../../d8/d6/sertl_8c.html#a43">RtlSubAuthoritySid</a>( <a class="code" href="../../d4/d6/tsevars_8c.html#a19">WilmaSid</a>, 3)) = <a class="code" href="../../d4/d6/tsevars_8c.html#a5">WILMA_RID</a>;
00291 
00292     <a class="code" href="../../d8/d6/sertl_8c.html#a46">RtlCopySid</a>( SidWithFourSubAuthorities, <a class="code" href="../../d4/d6/tsevars_8c.html#a20">PebblesSid</a>, <a class="code" href="../../d4/d6/tsevars_8c.html#a17">BedrockDomainSid</a>);
00293     *(<a class="code" href="../../d8/d6/sertl_8c.html#a44">RtlSubAuthorityCountSid</a>( <a class="code" href="../../d4/d6/tsevars_8c.html#a20">PebblesSid</a> )) += 1;
00294     *(<a class="code" href="../../d8/d6/sertl_8c.html#a43">RtlSubAuthoritySid</a>( <a class="code" href="../../d4/d6/tsevars_8c.html#a20">PebblesSid</a>, 3)) = <a class="code" href="../../d4/d6/tsevars_8c.html#a6">PEBBLES_RID</a>;
00295 
00296     <a class="code" href="../../d8/d6/sertl_8c.html#a46">RtlCopySid</a>( SidWithFourSubAuthorities, <a class="code" href="../../d4/d6/tsevars_8c.html#a21">DinoSid</a>, <a class="code" href="../../d4/d6/tsevars_8c.html#a17">BedrockDomainSid</a>);
00297     *(<a class="code" href="../../d8/d6/sertl_8c.html#a44">RtlSubAuthorityCountSid</a>( <a class="code" href="../../d4/d6/tsevars_8c.html#a21">DinoSid</a> )) += 1;
00298     *(<a class="code" href="../../d8/d6/sertl_8c.html#a43">RtlSubAuthoritySid</a>( <a class="code" href="../../d4/d6/tsevars_8c.html#a21">DinoSid</a>, 3)) = <a class="code" href="../../d4/d6/tsevars_8c.html#a7">DINO_RID</a>;
00299 
00300     <a class="code" href="../../d8/d6/sertl_8c.html#a46">RtlCopySid</a>( SidWithFourSubAuthorities, <a class="code" href="../../d4/d6/tsevars_8c.html#a22">BarneySid</a>, <a class="code" href="../../d4/d6/tsevars_8c.html#a17">BedrockDomainSid</a>);
00301     *(<a class="code" href="../../d8/d6/sertl_8c.html#a44">RtlSubAuthorityCountSid</a>( <a class="code" href="../../d4/d6/tsevars_8c.html#a22">BarneySid</a> )) += 1;
00302     *(<a class="code" href="../../d8/d6/sertl_8c.html#a43">RtlSubAuthoritySid</a>( <a class="code" href="../../d4/d6/tsevars_8c.html#a22">BarneySid</a>, 3)) = <a class="code" href="../../d4/d6/tsevars_8c.html#a8">BARNEY_RID</a>;
00303 
00304     <a class="code" href="../../d8/d6/sertl_8c.html#a46">RtlCopySid</a>( SidWithFourSubAuthorities, <a class="code" href="../../d4/d6/tsevars_8c.html#a23">BettySid</a>, <a class="code" href="../../d4/d6/tsevars_8c.html#a17">BedrockDomainSid</a>);
00305     *(<a class="code" href="../../d8/d6/sertl_8c.html#a44">RtlSubAuthorityCountSid</a>( <a class="code" href="../../d4/d6/tsevars_8c.html#a23">BettySid</a> )) += 1;
00306     *(<a class="code" href="../../d8/d6/sertl_8c.html#a43">RtlSubAuthoritySid</a>( <a class="code" href="../../d4/d6/tsevars_8c.html#a23">BettySid</a>, 3)) = <a class="code" href="../../d4/d6/tsevars_8c.html#a9">BETTY_RID</a>;
00307 
00308     <a class="code" href="../../d8/d6/sertl_8c.html#a46">RtlCopySid</a>( SidWithFourSubAuthorities, <a class="code" href="../../d4/d6/tsevars_8c.html#a24">BambamSid</a>, <a class="code" href="../../d4/d6/tsevars_8c.html#a17">BedrockDomainSid</a>);
00309     *(<a class="code" href="../../d8/d6/sertl_8c.html#a44">RtlSubAuthorityCountSid</a>( <a class="code" href="../../d4/d6/tsevars_8c.html#a24">BambamSid</a> )) += 1;
00310     *(<a class="code" href="../../d8/d6/sertl_8c.html#a43">RtlSubAuthoritySid</a>( <a class="code" href="../../d4/d6/tsevars_8c.html#a24">BambamSid</a>, 3)) = <a class="code" href="../../d4/d6/tsevars_8c.html#a10">BAMBAM_RID</a>;
00311 
00312     <a class="code" href="../../d8/d6/sertl_8c.html#a46">RtlCopySid</a>( SidWithFourSubAuthorities, <a class="code" href="../../d4/d6/tsevars_8c.html#a25">FlintstoneSid</a>, <a class="code" href="../../d4/d6/tsevars_8c.html#a17">BedrockDomainSid</a>);
00313     *(<a class="code" href="../../d8/d6/sertl_8c.html#a44">RtlSubAuthorityCountSid</a>( <a class="code" href="../../d4/d6/tsevars_8c.html#a25">FlintstoneSid</a> )) += 1;
00314     *(<a class="code" href="../../d8/d6/sertl_8c.html#a43">RtlSubAuthoritySid</a>( <a class="code" href="../../d4/d6/tsevars_8c.html#a25">FlintstoneSid</a>, 3)) = <a class="code" href="../../d4/d6/tsevars_8c.html#a11">FLINTSTONE_RID</a>;
00315 
00316     <a class="code" href="../../d8/d6/sertl_8c.html#a46">RtlCopySid</a>( SidWithFourSubAuthorities, <a class="code" href="../../d4/d6/tsevars_8c.html#a26">RubbleSid</a>, <a class="code" href="../../d4/d6/tsevars_8c.html#a17">BedrockDomainSid</a>);
00317     *(<a class="code" href="../../d8/d6/sertl_8c.html#a44">RtlSubAuthorityCountSid</a>( <a class="code" href="../../d4/d6/tsevars_8c.html#a26">RubbleSid</a> )) += 1;
00318     *(<a class="code" href="../../d8/d6/sertl_8c.html#a43">RtlSubAuthoritySid</a>( <a class="code" href="../../d4/d6/tsevars_8c.html#a26">RubbleSid</a>, 3)) = <a class="code" href="../../d4/d6/tsevars_8c.html#a12">RUBBLE_RID</a>;
00319 
00320     <a class="code" href="../../d8/d6/sertl_8c.html#a46">RtlCopySid</a>( SidWithFourSubAuthorities, <a class="code" href="../../d4/d6/tsevars_8c.html#a27">AdultSid</a>, <a class="code" href="../../d4/d6/tsevars_8c.html#a17">BedrockDomainSid</a>);
00321     *(<a class="code" href="../../d8/d6/sertl_8c.html#a44">RtlSubAuthorityCountSid</a>( <a class="code" href="../../d4/d6/tsevars_8c.html#a27">AdultSid</a> )) += 1;
00322     *(<a class="code" href="../../d8/d6/sertl_8c.html#a43">RtlSubAuthoritySid</a>( <a class="code" href="../../d4/d6/tsevars_8c.html#a27">AdultSid</a>, 3)) = <a class="code" href="../../d4/d6/tsevars_8c.html#a13">ADULT_RID</a>;
00323 
00324     <a class="code" href="../../d8/d6/sertl_8c.html#a46">RtlCopySid</a>( SidWithFourSubAuthorities, <a class="code" href="../../d4/d6/tsevars_8c.html#a28">ChildSid</a>, <a class="code" href="../../d4/d6/tsevars_8c.html#a17">BedrockDomainSid</a>);
00325     *(<a class="code" href="../../d8/d6/sertl_8c.html#a44">RtlSubAuthorityCountSid</a>( <a class="code" href="../../d4/d6/tsevars_8c.html#a28">ChildSid</a> )) += 1;
00326     *(<a class="code" href="../../d8/d6/sertl_8c.html#a43">RtlSubAuthoritySid</a>( <a class="code" href="../../d4/d6/tsevars_8c.html#a28">ChildSid</a>, 3)) = <a class="code" href="../../d4/d6/tsevars_8c.html#a14">CHILD_RID</a>;
00327 
00328     <a class="code" href="../../d8/d6/sertl_8c.html#a46">RtlCopySid</a>( SidWithFourSubAuthorities, <a class="code" href="../../d4/d6/tsevars_8c.html#a29">NeandertholSid</a>, <a class="code" href="../../d4/d6/tsevars_8c.html#a17">BedrockDomainSid</a>);
00329     *(<a class="code" href="../../d8/d6/sertl_8c.html#a44">RtlSubAuthorityCountSid</a>( <a class="code" href="../../d4/d6/tsevars_8c.html#a29">NeandertholSid</a> )) += 1;
00330     *(<a class="code" href="../../d8/d6/sertl_8c.html#a43">RtlSubAuthoritySid</a>( <a class="code" href="../../d4/d6/tsevars_8c.html#a29">NeandertholSid</a>, 3)) = <a class="code" href="../../d4/d6/tsevars_8c.html#a15">NEANDERTHOL_RID</a>;
00331 
00332 
00333     <a class="code" href="../../d4/d6/tsevars_8c.html#a40">CreateTokenPrivilege</a> =
00334         RtlConvertLongToLuid(SE_CREATE_TOKEN_PRIVILEGE);
00335     <a class="code" href="../../d4/d6/tsevars_8c.html#a41">AssignPrimaryTokenPrivilege</a> =
00336         RtlConvertLongToLuid(SE_ASSIGNPRIMARYTOKEN_PRIVILEGE);
00337     <a class="code" href="../../d4/d6/tsevars_8c.html#a42">LockMemoryPrivilege</a> =
00338         RtlConvertLongToLuid(SE_LOCK_MEMORY_PRIVILEGE);
00339     <a class="code" href="../../d4/d6/tsevars_8c.html#a43">IncreaseQuotaPrivilege</a> =
00340         RtlConvertLongToLuid(SE_INCREASE_QUOTA_PRIVILEGE);
00341     <a class="code" href="../../d4/d6/tsevars_8c.html#a44">UnsolicitedInputPrivilege</a> =
00342         RtlConvertLongToLuid(SE_UNSOLICITED_INPUT_PRIVILEGE);
00343     <a class="code" href="../../d4/d6/tsevars_8c.html#a45">TcbPrivilege</a> =
00344         RtlConvertLongToLuid(SE_TCB_PRIVILEGE);
00345     <a class="code" href="../../d4/d6/tsevars_8c.html#a46">SecurityPrivilege</a> =
00346         RtlConvertLongToLuid(SE_SECURITY_PRIVILEGE);
00347     <a class="code" href="../../d4/d6/tsevars_8c.html#a47">TakeOwnershipPrivilege</a> =
00348         RtlConvertLongToLuid(SE_TAKE_OWNERSHIP_PRIVILEGE);
00349     <a class="code" href="../../d4/d6/tsevars_8c.html#a48">CreatePagefilePrivilege</a> =
00350         RtlConvertLongToLuid(SE_CREATE_PAGEFILE_PRIVILEGE);
00351     <a class="code" href="../../d4/d6/tsevars_8c.html#a49">IncreaseBasePriorityPrivilege</a> =
00352         RtlConvertLongToLuid(SE_INC_BASE_PRIORITY_PRIVILEGE);
00353     <a class="code" href="../../d4/d6/tsevars_8c.html#a50">SystemProfilePrivilege</a> =
00354         RtlConvertLongToLuid(SE_SYSTEM_PROFILE_PRIVILEGE);
00355     <a class="code" href="../../d4/d6/tsevars_8c.html#a51">SystemtimePrivilege</a> =
00356         RtlConvertLongToLuid(SE_SYSTEMTIME_PRIVILEGE);
00357     <a class="code" href="../../d4/d6/tsevars_8c.html#a52">ProfileSingleProcessPrivilege</a> =
00358         RtlConvertLongToLuid(SE_PROF_SINGLE_PROCESS_PRIVILEGE);
00359     <a class="code" href="../../d4/d6/tsevars_8c.html#a55">CreatePermanentPrivilege</a> =
00360         RtlConvertLongToLuid(SE_CREATE_PERMANENT_PRIVILEGE);
00361     <a class="code" href="../../d4/d6/tsevars_8c.html#a54">BackupPrivilege</a> =
00362         RtlConvertLongToLuid(SE_BACKUP_PRIVILEGE);
00363     <a class="code" href="../../d4/d6/tsevars_8c.html#a53">RestorePrivilege</a> =
00364         RtlConvertLongToLuid(SE_RESTORE_PRIVILEGE);
00365     <a class="code" href="../../d4/d6/tsevars_8c.html#a56">ShutdownPrivilege</a> =
00366         RtlConvertLongToLuid(SE_SHUTDOWN_PRIVILEGE);
00367     <a class="code" href="../../d4/d6/tsevars_8c.html#a57">DebugPrivilege</a> =
00368         RtlConvertLongToLuid(SE_DEBUG_PRIVILEGE);
00369 
00370 
00371     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00372 
00373 }
00374 <span class="preprocessor">#endif  // _TSEVARS_</span>
</div></pre><hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:42:05 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
