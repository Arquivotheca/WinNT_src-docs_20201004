<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: ob.h Source File</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>ob.h</h1><a href="../../d4/d0/ob_8h.html">Go to the documentation of this file.</a><pre class="fragment"><div>00001 <span class="comment">/*++ BUILD Version: 0002    // Increment this if a change has global effects</span>
00002 <span class="comment"></span>
00003 <span class="comment">Copyright (c) 1989  Microsoft Corporation</span>
00004 <span class="comment"></span>
00005 <span class="comment">Module Name:</span>
00006 <span class="comment"></span>
00007 <span class="comment">    ob.h</span>
00008 <span class="comment"></span>
00009 <span class="comment">Abstract:</span>
00010 <span class="comment"></span>
00011 <span class="comment">    This module contains the object manager structure public data</span>
00012 <span class="comment">    structures and procedure prototypes to be used within the NT</span>
00013 <span class="comment">    system.</span>
00014 <span class="comment"></span>
00015 <span class="comment">Author:</span>
00016 <span class="comment"></span>
00017 <span class="comment">    Steve Wood (stevewo) 28-Mar-1989</span>
00018 <span class="comment"></span>
00019 <span class="comment">Revision History:</span>
00020 <span class="comment"></span>
00021 <span class="comment">--*/</span>
00022 
00023 <span class="preprocessor">#ifndef _OB_</span>
00024 <span class="preprocessor"></span><span class="preprocessor">#define _OB_</span>
00025 <span class="preprocessor"></span>
00026 <span class="comment">//</span>
00027 <span class="comment">// System Initialization procedure for OB subcomponent of NTOS</span>
00028 <span class="comment">//</span>
00029 BOOLEAN
00030 <a class="code" href="../../d0/d1/obinit_8c.html#a17">ObInitSystem</a>( VOID );
00031 
00032 
00033 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
00034 <a class="code" href="../../d0/d1/obinit_8c.html#a20">ObInitProcess</a>(
00035     <a class="code" href="../../d0/d4/struct__EPROCESS.html">PEPROCESS</a> ParentProcess OPTIONAL,
00036     <a class="code" href="../../d0/d4/struct__EPROCESS.html">PEPROCESS</a> NewProcess
00037     );
00038 
00039 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00040 <a class="code" href="../../d0/d1/obinit_8c.html#a21">ObInitProcess2</a>(
00041     <a class="code" href="../../d0/d4/struct__EPROCESS.html">PEPROCESS</a> NewProcess
00042     );
00043 
00044 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00045 <a class="code" href="../../d0/d1/obinit_8c.html#a23">ObKillProcess</a>(
00046     BOOLEAN AcquireLock,
00047     <a class="code" href="../../d0/d4/struct__EPROCESS.html">PEPROCESS</a> Process
00048     );
00049 
00050 <span class="comment">// begin_ntddk begin_wdm begin_nthal begin_ntifs</span>
00051 <span class="comment">//</span>
00052 <span class="comment">// Object Manager types</span>
00053 <span class="comment">//</span>
00054 
<a name="l00055"></a><a class="code" href="../../d3/d5/struct__OBJECT__HANDLE__INFORMATION.html">00055</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d3/d5/struct__OBJECT__HANDLE__INFORMATION.html">_OBJECT_HANDLE_INFORMATION</a> {
<a name="l00056"></a><a class="code" href="../../d3/d5/struct__OBJECT__HANDLE__INFORMATION.html#o0">00056</a>     ULONG <a class="code" href="../../d3/d5/struct__OBJECT__HANDLE__INFORMATION.html#o0">HandleAttributes</a>;
<a name="l00057"></a><a class="code" href="../../d3/d5/struct__OBJECT__HANDLE__INFORMATION.html#o1">00057</a>     ACCESS_MASK <a class="code" href="../../d3/d5/struct__OBJECT__HANDLE__INFORMATION.html#o1">GrantedAccess</a>;
00058 } <a class="code" href="../../d3/d5/struct__OBJECT__HANDLE__INFORMATION.html">OBJECT_HANDLE_INFORMATION</a>, *<a class="code" href="../../d3/d5/struct__OBJECT__HANDLE__INFORMATION.html">POBJECT_HANDLE_INFORMATION</a>;
00059 
00060 <span class="comment">// end_ntddk end_wdm end_nthal end_ntifs</span>
00061 
<a name="l00062"></a><a class="code" href="../../d0/d5/struct__OBJECT__DUMP__CONTROL.html">00062</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d0/d5/struct__OBJECT__DUMP__CONTROL.html">_OBJECT_DUMP_CONTROL</a> {
<a name="l00063"></a><a class="code" href="../../d0/d5/struct__OBJECT__DUMP__CONTROL.html#o0">00063</a>     PVOID <a class="code" href="../../d0/d5/struct__OBJECT__DUMP__CONTROL.html#o0">Stream</a>;
<a name="l00064"></a><a class="code" href="../../d0/d5/struct__OBJECT__DUMP__CONTROL.html#o1">00064</a>     ULONG <a class="code" href="../../d0/d5/struct__OBJECT__DUMP__CONTROL.html#o1">Detail</a>;
00065 } <a class="code" href="../../d0/d5/struct__OBJECT__DUMP__CONTROL.html">OB_DUMP_CONTROL</a>, *<a class="code" href="../../d0/d5/struct__OBJECT__DUMP__CONTROL.html">POB_DUMP_CONTROL</a>;
00066 
<a name="l00067"></a><a class="code" href="../../d4/d0/ob_8h.html#a20">00067</a> <span class="keyword">typedef</span> <a class="code" href="../../d0/d6/iop_8h.html#a145">VOID</a> (*<a class="code" href="../../d4/d0/ob_8h.html#a20">OB_DUMP_METHOD</a>)(
00068     IN PVOID Object,
00069     IN <a class="code" href="../../d4/d0/ob_8h.html#a19">POB_DUMP_CONTROL</a> Control OPTIONAL
00070     );
00071 
<a name="l00072"></a><a class="code" href="../../d4/d0/ob_8h.html#a100">00072</a> <span class="keyword">typedef</span> <span class="keyword">enum</span> <a class="code" href="../../d4/d0/ob_8h.html#a100">_OB_OPEN_REASON</a> {
00073     <a class="code" href="../../d4/d0/ob_8h.html#a100a58">ObCreateHandle</a>,
00074     <a class="code" href="../../d4/d0/ob_8h.html#a100a59">ObOpenHandle</a>,
00075     <a class="code" href="../../d4/d0/ob_8h.html#a100a60">ObDuplicateHandle</a>,
00076     <a class="code" href="../../d4/d0/ob_8h.html#a100a61">ObInheritHandle</a>,
00077     <a class="code" href="../../d4/d0/ob_8h.html#a100a62">ObMaxOpenReason</a>
00078 } <a class="code" href="../../d4/d0/ob_8h.html#a21">OB_OPEN_REASON</a>;
00079 
00080 
<a name="l00081"></a><a class="code" href="../../d4/d0/ob_8h.html#a22">00081</a> <span class="keyword">typedef</span> <a class="code" href="../../d0/d6/iop_8h.html#a145">VOID</a> (*<a class="code" href="../../d4/d0/ob_8h.html#a22">OB_OPEN_METHOD</a>)(
00082     IN <a class="code" href="../../d4/d0/ob_8h.html#a21">OB_OPEN_REASON</a> OpenReason,
00083     IN <a class="code" href="../../d0/d4/struct__EPROCESS.html">PEPROCESS</a> Process OPTIONAL,
00084     IN PVOID Object,
00085     IN ACCESS_MASK GrantedAccess,
00086     IN ULONG HandleCount
00087     );
00088 
<a name="l00089"></a><a class="code" href="../../d4/d0/ob_8h.html#a23">00089</a> <span class="keyword">typedef</span> BOOLEAN (*<a class="code" href="../../d4/d0/ob_8h.html#a23">OB_OKAYTOCLOSE_METHOD</a>)(
00090     IN <a class="code" href="../../d0/d4/struct__EPROCESS.html">PEPROCESS</a> Process OPTIONAL,
00091     IN PVOID Object,
00092     IN HANDLE <a class="code" href="../../d7/d0/cmdat2_8c.html#a19">Handle</a>
00093     );
00094 
<a name="l00095"></a><a class="code" href="../../d4/d0/ob_8h.html#a24">00095</a> <span class="keyword">typedef</span> <a class="code" href="../../d0/d6/iop_8h.html#a145">VOID</a> (*<a class="code" href="../../d4/d0/ob_8h.html#a24">OB_CLOSE_METHOD</a>)(
00096     IN <a class="code" href="../../d0/d4/struct__EPROCESS.html">PEPROCESS</a> Process OPTIONAL,
00097     IN PVOID Object,
00098     IN ACCESS_MASK GrantedAccess,
00099     IN ULONG ProcessHandleCount,
00100     IN ULONG SystemHandleCount
00101     );
00102 
<a name="l00103"></a><a class="code" href="../../d4/d0/ob_8h.html#a25">00103</a> <span class="keyword">typedef</span> <a class="code" href="../../d0/d6/iop_8h.html#a145">VOID</a> (*<a class="code" href="../../d4/d0/ob_8h.html#a25">OB_DELETE_METHOD</a>)(
00104     IN PVOID Object
00105     );
00106 
<a name="l00107"></a><a class="code" href="../../d4/d0/ob_8h.html#a26">00107</a> <span class="keyword">typedef</span> <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> (*OB_PARSE_METHOD)(
00108     IN PVOID ParseObject,
00109     IN PVOID ObjectType,
00110     IN OUT <a class="code" href="../../d2/d5/struct__ACCESS__STATE.html">PACCESS_STATE</a> AccessState,
00111     IN <a class="code" href="../../d0/d9/ntosdef_8h.html#a39">KPROCESSOR_MODE</a> AccessMode,
00112     IN ULONG Attributes,
00113     IN OUT PUNICODE_STRING CompleteName,
00114     IN OUT PUNICODE_STRING RemainingName,
00115     IN OUT PVOID Context OPTIONAL,
00116     IN PSECURITY_QUALITY_OF_SERVICE <a class="code" href="../../d7/d0/ctlnpqos_8c.html#a14">SecurityQos</a> OPTIONAL,
00117     OUT PVOID *Object
00118     );
00119 
<a name="l00120"></a><a class="code" href="../../d4/d0/ob_8h.html#a27">00120</a> <span class="keyword">typedef</span> <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> (*OB_SECURITY_METHOD)(
00121     IN PVOID Object,
00122     IN <a class="code" href="../../d0/d5/se_8h.html#a19">SECURITY_OPERATION_CODE</a> OperationCode,
00123     IN PSECURITY_INFORMATION SecurityInformation,
00124     IN OUT PSECURITY_DESCRIPTOR SecurityDescriptor,
00125     IN OUT PULONG CapturedLength,
00126     IN OUT PSECURITY_DESCRIPTOR *ObjectsSecurityDescriptor,
00127     IN <a class="code" href="../../d5/d8/ex_8h.html#a96">POOL_TYPE</a> PoolType,
00128     IN PGENERIC_MAPPING GenericMapping
00129     );
00130 
<a name="l00131"></a><a class="code" href="../../d4/d0/ob_8h.html#a28">00131</a> <span class="keyword">typedef</span> <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> (*OB_QUERYNAME_METHOD)(
00132     IN PVOID Object,
00133     IN BOOLEAN HasObjectName,
00134     OUT POBJECT_NAME_INFORMATION ObjectNameInfo,
00135     IN ULONG Length,
00136     OUT PULONG ReturnLength
00137     );
00138 
00139 <span class="comment">/*</span>
00140 <span class="comment"></span>
00141 <span class="comment">    A security method and its caller must obey the following w.r.t.</span>
00142 <span class="comment">    capturing and probing parameters:</span>
00143 <span class="comment"></span>
00144 <span class="comment">    For a query operation, the caller must pass a kernel space address for</span>
00145 <span class="comment">    CapturedLength.  The caller should be able to assume that it points to</span>
00146 <span class="comment">    valid data that will not change.  In addition, the SecurityDescriptor</span>
00147 <span class="comment">    parameter (which will receive the result of the query operation) must</span>
00148 <span class="comment">    be probed for write up to the length given in CapturedLength.  The</span>
00149 <span class="comment">    security method itself must always write to the SecurityDescriptor</span>
00150 <span class="comment">    buffer in a try clause in case the caller de-allocates it.</span>
00151 <span class="comment"></span>
00152 <span class="comment">    For a set operation, the SecurityDescriptor parameter must have</span>
00153 <span class="comment">    been captured via SeCaptureSecurityDescriptor.  This parameter is</span>
00154 <span class="comment">    not optional, and therefore may not be NULL.</span>
00155 <span class="comment"></span>
00156 <span class="comment">*/</span>
00157 
00158 
00159 <span class="comment">//</span>
00160 <span class="comment">// Object Type Structure</span>
00161 <span class="comment">//</span>
00162 
<a name="l00163"></a><a class="code" href="../../d5/d6/struct__OBJECT__TYPE__INITIALIZER.html">00163</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d5/d6/struct__OBJECT__TYPE__INITIALIZER.html">_OBJECT_TYPE_INITIALIZER</a> {
<a name="l00164"></a><a class="code" href="../../d5/d6/struct__OBJECT__TYPE__INITIALIZER.html#o0">00164</a>     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a> Length;
<a name="l00165"></a><a class="code" href="../../d5/d6/struct__OBJECT__TYPE__INITIALIZER.html#o1">00165</a>     BOOLEAN <a class="code" href="../../d5/d6/struct__OBJECT__TYPE__INITIALIZER.html#o1">UseDefaultObject</a>;
<a name="l00166"></a><a class="code" href="../../d5/d6/struct__OBJECT__TYPE__INITIALIZER.html#o2">00166</a>     BOOLEAN <a class="code" href="../../d5/d6/struct__OBJECT__TYPE__INITIALIZER.html#o2">Reserved</a>;
<a name="l00167"></a><a class="code" href="../../d5/d6/struct__OBJECT__TYPE__INITIALIZER.html#o3">00167</a>     ULONG <a class="code" href="../../d5/d6/struct__OBJECT__TYPE__INITIALIZER.html#o3">InvalidAttributes</a>;
<a name="l00168"></a><a class="code" href="../../d5/d6/struct__OBJECT__TYPE__INITIALIZER.html#o4">00168</a>     GENERIC_MAPPING <a class="code" href="../../d5/d6/struct__OBJECT__TYPE__INITIALIZER.html#o4">GenericMapping</a>;
<a name="l00169"></a><a class="code" href="../../d5/d6/struct__OBJECT__TYPE__INITIALIZER.html#o5">00169</a>     ULONG <a class="code" href="../../d5/d6/struct__OBJECT__TYPE__INITIALIZER.html#o5">ValidAccessMask</a>;
<a name="l00170"></a><a class="code" href="../../d5/d6/struct__OBJECT__TYPE__INITIALIZER.html#o6">00170</a>     BOOLEAN <a class="code" href="../../d5/d6/struct__OBJECT__TYPE__INITIALIZER.html#o6">SecurityRequired</a>;
<a name="l00171"></a><a class="code" href="../../d5/d6/struct__OBJECT__TYPE__INITIALIZER.html#o7">00171</a>     BOOLEAN <a class="code" href="../../d5/d6/struct__OBJECT__TYPE__INITIALIZER.html#o7">MaintainHandleCount</a>;
<a name="l00172"></a><a class="code" href="../../d5/d6/struct__OBJECT__TYPE__INITIALIZER.html#o8">00172</a>     BOOLEAN <a class="code" href="../../d5/d6/struct__OBJECT__TYPE__INITIALIZER.html#o8">MaintainTypeList</a>;
<a name="l00173"></a><a class="code" href="../../d5/d6/struct__OBJECT__TYPE__INITIALIZER.html#o9">00173</a>     <a class="code" href="../../d5/d8/ex_8h.html#a96">POOL_TYPE</a> PoolType;
<a name="l00174"></a><a class="code" href="../../d5/d6/struct__OBJECT__TYPE__INITIALIZER.html#o10">00174</a>     ULONG <a class="code" href="../../d5/d6/struct__OBJECT__TYPE__INITIALIZER.html#o10">DefaultPagedPoolCharge</a>;
<a name="l00175"></a><a class="code" href="../../d5/d6/struct__OBJECT__TYPE__INITIALIZER.html#o11">00175</a>     ULONG <a class="code" href="../../d5/d6/struct__OBJECT__TYPE__INITIALIZER.html#o11">DefaultNonPagedPoolCharge</a>;
<a name="l00176"></a><a class="code" href="../../d5/d6/struct__OBJECT__TYPE__INITIALIZER.html#o12">00176</a>     <a class="code" href="../../d4/d0/ob_8h.html#a20">OB_DUMP_METHOD</a> <a class="code" href="../../d5/d6/struct__OBJECT__TYPE__INITIALIZER.html#o12">DumpProcedure</a>;
<a name="l00177"></a><a class="code" href="../../d5/d6/struct__OBJECT__TYPE__INITIALIZER.html#o13">00177</a>     <a class="code" href="../../d4/d0/ob_8h.html#a22">OB_OPEN_METHOD</a> <a class="code" href="../../d5/d6/struct__OBJECT__TYPE__INITIALIZER.html#o13">OpenProcedure</a>;
<a name="l00178"></a><a class="code" href="../../d5/d6/struct__OBJECT__TYPE__INITIALIZER.html#o14">00178</a>     <a class="code" href="../../d4/d0/ob_8h.html#a24">OB_CLOSE_METHOD</a> <a class="code" href="../../d5/d6/struct__OBJECT__TYPE__INITIALIZER.html#o14">CloseProcedure</a>;
<a name="l00179"></a><a class="code" href="../../d5/d6/struct__OBJECT__TYPE__INITIALIZER.html#o15">00179</a>     <a class="code" href="../../d4/d0/ob_8h.html#a25">OB_DELETE_METHOD</a> <a class="code" href="../../d5/d6/struct__OBJECT__TYPE__INITIALIZER.html#o15">DeleteProcedure</a>;
<a name="l00180"></a><a class="code" href="../../d5/d6/struct__OBJECT__TYPE__INITIALIZER.html#o16">00180</a>     <a class="code" href="../../d4/d0/ob_8h.html#a26">OB_PARSE_METHOD</a> <a class="code" href="../../d5/d6/struct__OBJECT__TYPE__INITIALIZER.html#o16">ParseProcedure</a>;
<a name="l00181"></a><a class="code" href="../../d5/d6/struct__OBJECT__TYPE__INITIALIZER.html#o17">00181</a>     <a class="code" href="../../d4/d0/ob_8h.html#a27">OB_SECURITY_METHOD</a> <a class="code" href="../../d5/d6/struct__OBJECT__TYPE__INITIALIZER.html#o17">SecurityProcedure</a>;
<a name="l00182"></a><a class="code" href="../../d5/d6/struct__OBJECT__TYPE__INITIALIZER.html#o18">00182</a>     <a class="code" href="../../d4/d0/ob_8h.html#a28">OB_QUERYNAME_METHOD</a> <a class="code" href="../../d5/d6/struct__OBJECT__TYPE__INITIALIZER.html#o18">QueryNameProcedure</a>;
<a name="l00183"></a><a class="code" href="../../d5/d6/struct__OBJECT__TYPE__INITIALIZER.html#o19">00183</a>     <a class="code" href="../../d4/d0/ob_8h.html#a23">OB_OKAYTOCLOSE_METHOD</a> <a class="code" href="../../d5/d6/struct__OBJECT__TYPE__INITIALIZER.html#o19">OkayToCloseProcedure</a>;
00184 } <a class="code" href="../../d5/d6/struct__OBJECT__TYPE__INITIALIZER.html">OBJECT_TYPE_INITIALIZER</a>, *<a class="code" href="../../d5/d6/struct__OBJECT__TYPE__INITIALIZER.html">POBJECT_TYPE_INITIALIZER</a>;
00185 
<a name="l00186"></a><a class="code" href="../../d3/d6/struct__OBJECT__TYPE.html">00186</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d3/d6/struct__OBJECT__TYPE.html">_OBJECT_TYPE</a> {
<a name="l00187"></a><a class="code" href="../../d3/d6/struct__OBJECT__TYPE.html#o0">00187</a>     <a class="code" href="../../d6/d4/struct__ERESOURCE.html">ERESOURCE</a> <a class="code" href="../../d3/d6/struct__OBJECT__TYPE.html#o0">Mutex</a>;
<a name="l00188"></a><a class="code" href="../../d3/d6/struct__OBJECT__TYPE.html#o1">00188</a>     LIST_ENTRY <a class="code" href="../../d3/d6/struct__OBJECT__TYPE.html#o1">TypeList</a>;
<a name="l00189"></a><a class="code" href="../../d3/d6/struct__OBJECT__TYPE.html#o2">00189</a>     UNICODE_STRING <a class="code" href="../../d3/d6/struct__OBJECT__TYPE.html#o2">Name</a>;            <span class="comment">// Copy from object header for convenience</span>
<a name="l00190"></a><a class="code" href="../../d3/d6/struct__OBJECT__TYPE.html#o3">00190</a>     PVOID <a class="code" href="../../d3/d6/struct__OBJECT__TYPE.html#o3">DefaultObject</a>;
<a name="l00191"></a><a class="code" href="../../d3/d6/struct__OBJECT__TYPE.html#o4">00191</a>     ULONG <a class="code" href="../../d3/d6/struct__OBJECT__TYPE.html#o4">Index</a>;
<a name="l00192"></a><a class="code" href="../../d3/d6/struct__OBJECT__TYPE.html#o5">00192</a>     ULONG <a class="code" href="../../d3/d6/struct__OBJECT__TYPE.html#o5">TotalNumberOfObjects</a>;
<a name="l00193"></a><a class="code" href="../../d3/d6/struct__OBJECT__TYPE.html#o6">00193</a>     ULONG <a class="code" href="../../d3/d6/struct__OBJECT__TYPE.html#o6">TotalNumberOfHandles</a>;
<a name="l00194"></a><a class="code" href="../../d3/d6/struct__OBJECT__TYPE.html#o7">00194</a>     ULONG <a class="code" href="../../d3/d6/struct__OBJECT__TYPE.html#o7">HighWaterNumberOfObjects</a>;
<a name="l00195"></a><a class="code" href="../../d3/d6/struct__OBJECT__TYPE.html#o8">00195</a>     ULONG <a class="code" href="../../d3/d6/struct__OBJECT__TYPE.html#o8">HighWaterNumberOfHandles</a>;
<a name="l00196"></a><a class="code" href="../../d3/d6/struct__OBJECT__TYPE.html#o9">00196</a>     <a class="code" href="../../d5/d6/struct__OBJECT__TYPE__INITIALIZER.html">OBJECT_TYPE_INITIALIZER</a> <a class="code" href="../../d3/d6/struct__OBJECT__TYPE.html#o9">TypeInfo</a>;
00197 <span class="preprocessor">#ifdef POOL_TAGGING</span>
00198 <span class="preprocessor"></span>    ULONG <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a51">Key</a>;
00199 <span class="preprocessor">#endif //POOL_TAGGING</span>
00200 <span class="preprocessor"></span>} <a class="code" href="../../d3/d6/struct__OBJECT__TYPE.html">OBJECT_TYPE</a>, *<a class="code" href="../../d3/d6/struct__OBJECT__TYPE.html">POBJECT_TYPE</a>;
00201 
00202 <span class="comment">//</span>
00203 <span class="comment">// Object Directory Structure</span>
00204 <span class="comment">//</span>
00205 
<a name="l00206"></a><a class="code" href="../../d4/d0/ob_8h.html#a0">00206</a> <span class="preprocessor">#define NUMBER_HASH_BUCKETS 37</span>
00207 <span class="preprocessor"></span>
<a name="l00208"></a><a class="code" href="../../d8/d4/struct__OBJECT__DIRECTORY.html">00208</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d8/d4/struct__OBJECT__DIRECTORY.html">_OBJECT_DIRECTORY</a> {
<a name="l00209"></a><a class="code" href="../../d8/d4/struct__OBJECT__DIRECTORY.html#o0">00209</a>     <span class="keyword">struct </span><a class="code" href="../../d9/d4/struct__OBJECT__DIRECTORY__ENTRY.html">_OBJECT_DIRECTORY_ENTRY</a> *<a class="code" href="../../d8/d4/struct__OBJECT__DIRECTORY.html#o0">HashBuckets</a>[ <a class="code" href="../../d4/d0/ob_8h.html#a0">NUMBER_HASH_BUCKETS</a> ];
<a name="l00210"></a><a class="code" href="../../d8/d4/struct__OBJECT__DIRECTORY.html#o1">00210</a>     <span class="keyword">struct </span><a class="code" href="../../d9/d4/struct__OBJECT__DIRECTORY__ENTRY.html">_OBJECT_DIRECTORY_ENTRY</a> **<a class="code" href="../../d8/d4/struct__OBJECT__DIRECTORY.html#o1">LookupBucket</a>;
<a name="l00211"></a><a class="code" href="../../d8/d4/struct__OBJECT__DIRECTORY.html#o2">00211</a>     BOOLEAN <a class="code" href="../../d8/d4/struct__OBJECT__DIRECTORY.html#o2">LookupFound</a>;
<a name="l00212"></a><a class="code" href="../../d8/d4/struct__OBJECT__DIRECTORY.html#o3">00212</a>     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a> <a class="code" href="../../d8/d4/struct__OBJECT__DIRECTORY.html#o3">SymbolicLinkUsageCount</a>;
<a name="l00213"></a><a class="code" href="../../d8/d4/struct__OBJECT__DIRECTORY.html#o4">00213</a>     <span class="keyword">struct </span><a class="code" href="../../d2/d4/struct__DEVICE__MAP.html">_DEVICE_MAP</a> *<a class="code" href="../../d8/d4/struct__OBJECT__DIRECTORY.html#o4">DeviceMap</a>;
00214 } <a class="code" href="../../d8/d4/struct__OBJECT__DIRECTORY.html">OBJECT_DIRECTORY</a>, *<a class="code" href="../../d8/d4/struct__OBJECT__DIRECTORY.html">POBJECT_DIRECTORY</a>;
00215 
00216 <span class="comment">//</span>
00217 <span class="comment">// Object Directory Entry Structure</span>
00218 <span class="comment">//</span>
<a name="l00219"></a><a class="code" href="../../d9/d4/struct__OBJECT__DIRECTORY__ENTRY.html">00219</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d9/d4/struct__OBJECT__DIRECTORY__ENTRY.html">_OBJECT_DIRECTORY_ENTRY</a> {
<a name="l00220"></a><a class="code" href="../../d9/d4/struct__OBJECT__DIRECTORY__ENTRY.html#o0">00220</a>     <span class="keyword">struct </span><a class="code" href="../../d9/d4/struct__OBJECT__DIRECTORY__ENTRY.html">_OBJECT_DIRECTORY_ENTRY</a> *<a class="code" href="../../d9/d4/struct__OBJECT__DIRECTORY__ENTRY.html#o0">ChainLink</a>;
<a name="l00221"></a><a class="code" href="../../d9/d4/struct__OBJECT__DIRECTORY__ENTRY.html#o1">00221</a>     PVOID Object;
00222 } <a class="code" href="../../d9/d4/struct__OBJECT__DIRECTORY__ENTRY.html">OBJECT_DIRECTORY_ENTRY</a>, *<a class="code" href="../../d9/d4/struct__OBJECT__DIRECTORY__ENTRY.html">POBJECT_DIRECTORY_ENTRY</a>;
00223 
00224 
00225 <span class="comment">//</span>
00226 <span class="comment">// Symbolic Link Object Structure</span>
00227 <span class="comment">//</span>
00228 
<a name="l00229"></a><a class="code" href="../../d2/d6/struct__OBJECT__SYMBOLIC__LINK.html">00229</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d2/d6/struct__OBJECT__SYMBOLIC__LINK.html">_OBJECT_SYMBOLIC_LINK</a> {
<a name="l00230"></a><a class="code" href="../../d2/d6/struct__OBJECT__SYMBOLIC__LINK.html#o0">00230</a>     LARGE_INTEGER <a class="code" href="../../d2/d6/struct__OBJECT__SYMBOLIC__LINK.html#o0">CreationTime</a>;
<a name="l00231"></a><a class="code" href="../../d2/d6/struct__OBJECT__SYMBOLIC__LINK.html#o1">00231</a>     UNICODE_STRING <a class="code" href="../../d2/d6/struct__OBJECT__SYMBOLIC__LINK.html#o1">LinkTarget</a>;
<a name="l00232"></a><a class="code" href="../../d2/d6/struct__OBJECT__SYMBOLIC__LINK.html#o2">00232</a>     UNICODE_STRING <a class="code" href="../../d2/d6/struct__OBJECT__SYMBOLIC__LINK.html#o2">LinkTargetRemaining</a>;
<a name="l00233"></a><a class="code" href="../../d2/d6/struct__OBJECT__SYMBOLIC__LINK.html#o3">00233</a>     PVOID <a class="code" href="../../d2/d6/struct__OBJECT__SYMBOLIC__LINK.html#o3">LinkTargetObject</a>;
<a name="l00234"></a><a class="code" href="../../d2/d6/struct__OBJECT__SYMBOLIC__LINK.html#o4">00234</a>     ULONG <a class="code" href="../../d2/d6/struct__OBJECT__SYMBOLIC__LINK.html#o4">DosDeviceDriveIndex</a>;  <span class="comment">// 1-based index into KUSER_SHARED_DATA.DosDeviceDriveType</span>
00235 } <a class="code" href="../../d2/d6/struct__OBJECT__SYMBOLIC__LINK.html">OBJECT_SYMBOLIC_LINK</a>, *<a class="code" href="../../d2/d6/struct__OBJECT__SYMBOLIC__LINK.html">POBJECT_SYMBOLIC_LINK</a>;
00236 
00237 
00238 <span class="comment">//</span>
00239 <span class="comment">// Device Map Structure</span>
00240 <span class="comment">//</span>
00241 
<a name="l00242"></a><a class="code" href="../../d2/d4/struct__DEVICE__MAP.html">00242</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d2/d4/struct__DEVICE__MAP.html">_DEVICE_MAP</a> {
<a name="l00243"></a><a class="code" href="../../d2/d4/struct__DEVICE__MAP.html#o0">00243</a>     ULONG <a class="code" href="../../d2/d4/struct__DEVICE__MAP.html#o0">ReferenceCount</a>;
<a name="l00244"></a><a class="code" href="../../d2/d4/struct__DEVICE__MAP.html#o1">00244</a>     <a class="code" href="../../d4/d0/ob_8h.html#a34">POBJECT_DIRECTORY</a> <a class="code" href="../../d2/d4/struct__DEVICE__MAP.html#o1">DosDevicesDirectory</a>;
<a name="l00245"></a><a class="code" href="../../d2/d4/struct__DEVICE__MAP.html#o2">00245</a>     ULONG <a class="code" href="../../d2/d4/struct__DEVICE__MAP.html#o2">DriveMap</a>;
<a name="l00246"></a><a class="code" href="../../d2/d4/struct__DEVICE__MAP.html#o3">00246</a>     UCHAR <a class="code" href="../../d2/d4/struct__DEVICE__MAP.html#o3">DriveType</a>[ 32 ];
00247 } <a class="code" href="../../d2/d4/struct__DEVICE__MAP.html">DEVICE_MAP</a>, *<a class="code" href="../../d2/d4/struct__DEVICE__MAP.html">PDEVICE_MAP</a>;
00248 
<a name="l00249"></a><a class="code" href="../../d4/d0/ob_8h.html#a41">00249</a> <span class="keyword">extern</span> <a class="code" href="../../d4/d0/ob_8h.html#a40">PDEVICE_MAP</a> <a class="code" href="../../d4/d0/ob_8h.html#a41">ObSystemDeviceMap</a>;
00250 
00251 <span class="comment">//</span>
00252 <span class="comment">// Object Handle Count Database</span>
00253 <span class="comment">//</span>
00254 
<a name="l00255"></a><a class="code" href="../../d2/d5/struct__OBJECT__HANDLE__COUNT__ENTRY.html">00255</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d2/d5/struct__OBJECT__HANDLE__COUNT__ENTRY.html">_OBJECT_HANDLE_COUNT_ENTRY</a> {
<a name="l00256"></a><a class="code" href="../../d2/d5/struct__OBJECT__HANDLE__COUNT__ENTRY.html#o0">00256</a>     <a class="code" href="../../d0/d4/struct__EPROCESS.html">PEPROCESS</a> <a class="code" href="../../d2/d5/struct__OBJECT__HANDLE__COUNT__ENTRY.html#o0">Process</a>;
<a name="l00257"></a><a class="code" href="../../d2/d5/struct__OBJECT__HANDLE__COUNT__ENTRY.html#o1">00257</a>     ULONG <a class="code" href="../../d2/d5/struct__OBJECT__HANDLE__COUNT__ENTRY.html#o1">HandleCount</a>;
00258 } <a class="code" href="../../d2/d5/struct__OBJECT__HANDLE__COUNT__ENTRY.html">OBJECT_HANDLE_COUNT_ENTRY</a>, *<a class="code" href="../../d2/d5/struct__OBJECT__HANDLE__COUNT__ENTRY.html">POBJECT_HANDLE_COUNT_ENTRY</a>;
00259 
<a name="l00260"></a><a class="code" href="../../d1/d5/struct__OBJECT__HANDLE__COUNT__DATABASE.html">00260</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d1/d5/struct__OBJECT__HANDLE__COUNT__DATABASE.html">_OBJECT_HANDLE_COUNT_DATABASE</a> {
<a name="l00261"></a><a class="code" href="../../d1/d5/struct__OBJECT__HANDLE__COUNT__DATABASE.html#o0">00261</a>     ULONG <a class="code" href="../../d1/d5/struct__OBJECT__HANDLE__COUNT__DATABASE.html#o0">CountEntries</a>;
<a name="l00262"></a><a class="code" href="../../d1/d5/struct__OBJECT__HANDLE__COUNT__DATABASE.html#o1">00262</a>     <a class="code" href="../../d2/d5/struct__OBJECT__HANDLE__COUNT__ENTRY.html">OBJECT_HANDLE_COUNT_ENTRY</a> <a class="code" href="../../d1/d5/struct__OBJECT__HANDLE__COUNT__DATABASE.html#o1">HandleCountEntries</a>[ 1 ];
00263 } <a class="code" href="../../d1/d5/struct__OBJECT__HANDLE__COUNT__DATABASE.html">OBJECT_HANDLE_COUNT_DATABASE</a>, *<a class="code" href="../../d1/d5/struct__OBJECT__HANDLE__COUNT__DATABASE.html">POBJECT_HANDLE_COUNT_DATABASE</a>;
00264 
00265 <span class="comment">//</span>
00266 <span class="comment">// Object Header Structure</span>
00267 <span class="comment">//</span>
00268 <span class="comment">// The SecurityQuotaCharged is the amount of quota charged to cover</span>
00269 <span class="comment">// the GROUP and DISCRETIONARY ACL fields of the security descriptor</span>
00270 <span class="comment">// only.  The OWNER and SYSTEM ACL fields get charged for at a fixed</span>
00271 <span class="comment">// rate that may be less than or greater than the amount actually used.</span>
00272 <span class="comment">//</span>
00273 <span class="comment">// If the object has no security, then the SecurityQuotaCharged and the</span>
00274 <span class="comment">// SecurityQuotaInUse fields are set to zero.</span>
00275 <span class="comment">//</span>
00276 <span class="comment">// Modification of the OWNER and SYSTEM ACL fields should never fail</span>
00277 <span class="comment">// due to quota exceeded problems.  Modifications to the GROUP and</span>
00278 <span class="comment">// DISCRETIONARY ACL fields may fail due to quota exceeded problems.</span>
00279 <span class="comment">//</span>
00280 <span class="comment">//</span>
00281 
00282 
<a name="l00283"></a><a class="code" href="../../d7/d4/struct__OBJECT__CREATE__INFORMATION.html">00283</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d7/d4/struct__OBJECT__CREATE__INFORMATION.html">_OBJECT_CREATE_INFORMATION</a> {
<a name="l00284"></a><a class="code" href="../../d7/d4/struct__OBJECT__CREATE__INFORMATION.html#o0">00284</a>     ULONG Attributes;
<a name="l00285"></a><a class="code" href="../../d7/d4/struct__OBJECT__CREATE__INFORMATION.html#o1">00285</a>     HANDLE <a class="code" href="../../d7/d4/struct__OBJECT__CREATE__INFORMATION.html#o1">RootDirectory</a>;
<a name="l00286"></a><a class="code" href="../../d7/d4/struct__OBJECT__CREATE__INFORMATION.html#o2">00286</a>     PVOID <a class="code" href="../../d7/d4/struct__OBJECT__CREATE__INFORMATION.html#o2">ParseContext</a>;
<a name="l00287"></a><a class="code" href="../../d7/d4/struct__OBJECT__CREATE__INFORMATION.html#o3">00287</a>     <a class="code" href="../../d0/d9/ntosdef_8h.html#a39">KPROCESSOR_MODE</a> <a class="code" href="../../d7/d4/struct__OBJECT__CREATE__INFORMATION.html#o3">ProbeMode</a>;
<a name="l00288"></a><a class="code" href="../../d7/d4/struct__OBJECT__CREATE__INFORMATION.html#o4">00288</a>     ULONG <a class="code" href="../../d7/d4/struct__OBJECT__CREATE__INFORMATION.html#o4">PagedPoolCharge</a>;
<a name="l00289"></a><a class="code" href="../../d7/d4/struct__OBJECT__CREATE__INFORMATION.html#o5">00289</a>     ULONG <a class="code" href="../../d7/d4/struct__OBJECT__CREATE__INFORMATION.html#o5">NonPagedPoolCharge</a>;
<a name="l00290"></a><a class="code" href="../../d7/d4/struct__OBJECT__CREATE__INFORMATION.html#o6">00290</a>     ULONG <a class="code" href="../../d7/d4/struct__OBJECT__CREATE__INFORMATION.html#o6">SecurityDescriptorCharge</a>;
<a name="l00291"></a><a class="code" href="../../d7/d4/struct__OBJECT__CREATE__INFORMATION.html#o7">00291</a>     PSECURITY_DESCRIPTOR SecurityDescriptor;
<a name="l00292"></a><a class="code" href="../../d7/d4/struct__OBJECT__CREATE__INFORMATION.html#o8">00292</a>     PSECURITY_QUALITY_OF_SERVICE <a class="code" href="../../d7/d4/struct__OBJECT__CREATE__INFORMATION.html#o8">SecurityQos</a>;
<a name="l00293"></a><a class="code" href="../../d7/d4/struct__OBJECT__CREATE__INFORMATION.html#o9">00293</a>     SECURITY_QUALITY_OF_SERVICE <a class="code" href="../../d7/d4/struct__OBJECT__CREATE__INFORMATION.html#o9">SecurityQualityOfService</a>;
00294 } <a class="code" href="../../d7/d4/struct__OBJECT__CREATE__INFORMATION.html">OBJECT_CREATE_INFORMATION</a>, *<a class="code" href="../../d7/d4/struct__OBJECT__CREATE__INFORMATION.html">POBJECT_CREATE_INFORMATION</a>;
00295 
<a name="l00296"></a><a class="code" href="../../d4/d5/struct__OBJECT__HEADER.html">00296</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d4/d5/struct__OBJECT__HEADER.html">_OBJECT_HEADER</a> {
<a name="l00297"></a><a class="code" href="../../d4/d5/struct__OBJECT__HEADER.html#o0">00297</a>     LONG <a class="code" href="../../d4/d5/struct__OBJECT__HEADER.html#o0">PointerCount</a>;
00298     <span class="keyword">union </span>{
<a name="l00299"></a><a class="code" href="../../d4/d5/struct__OBJECT__HEADER.html#o1">00299</a>         LONG <a class="code" href="../../d4/d5/struct__OBJECT__HEADER.html#o1">HandleCount</a>;
<a name="l00300"></a><a class="code" href="../../d4/d5/struct__OBJECT__HEADER.html#o2">00300</a>         PSINGLE_LIST_ENTRY <a class="code" href="../../d4/d5/struct__OBJECT__HEADER.html#o2">SEntry</a>;
00301     };
<a name="l00302"></a><a class="code" href="../../d4/d5/struct__OBJECT__HEADER.html#o3">00302</a>     <a class="code" href="../../d4/d0/ob_8h.html#a32">POBJECT_TYPE</a> <a class="code" href="../../d4/d5/struct__OBJECT__HEADER.html#o3">Type</a>;
<a name="l00303"></a><a class="code" href="../../d4/d5/struct__OBJECT__HEADER.html#o4">00303</a>     UCHAR <a class="code" href="../../d4/d5/struct__OBJECT__HEADER.html#o4">NameInfoOffset</a>;
<a name="l00304"></a><a class="code" href="../../d4/d5/struct__OBJECT__HEADER.html#o5">00304</a>     UCHAR <a class="code" href="../../d4/d5/struct__OBJECT__HEADER.html#o5">HandleInfoOffset</a>;
<a name="l00305"></a><a class="code" href="../../d4/d5/struct__OBJECT__HEADER.html#o6">00305</a>     UCHAR <a class="code" href="../../d4/d5/struct__OBJECT__HEADER.html#o6">QuotaInfoOffset</a>;
<a name="l00306"></a><a class="code" href="../../d4/d5/struct__OBJECT__HEADER.html#o7">00306</a>     UCHAR <a class="code" href="../../d4/d5/struct__OBJECT__HEADER.html#o7">Flags</a>;
00307     <span class="keyword">union </span>{
<a name="l00308"></a><a class="code" href="../../d4/d5/struct__OBJECT__HEADER.html#o8">00308</a>         <a class="code" href="../../d4/d0/ob_8h.html#a47">POBJECT_CREATE_INFORMATION</a> <a class="code" href="../../d4/d5/struct__OBJECT__HEADER.html#o8">ObjectCreateInfo</a>;
<a name="l00309"></a><a class="code" href="../../d4/d5/struct__OBJECT__HEADER.html#o9">00309</a>         PVOID <a class="code" href="../../d4/d5/struct__OBJECT__HEADER.html#o9">QuotaBlockCharged</a>;
00310     };
00311 
<a name="l00312"></a><a class="code" href="../../d4/d5/struct__OBJECT__HEADER.html#o10">00312</a>     PSECURITY_DESCRIPTOR SecurityDescriptor;
<a name="l00313"></a><a class="code" href="../../d4/d5/struct__OBJECT__HEADER.html#o11">00313</a>     QUAD <a class="code" href="../../d4/d5/struct__OBJECT__HEADER.html#o11">Body</a>;
00314 } <a class="code" href="../../d4/d5/struct__OBJECT__HEADER.html">OBJECT_HEADER</a>, *<a class="code" href="../../d4/d5/struct__OBJECT__HEADER.html">POBJECT_HEADER</a>;
00315 
<a name="l00316"></a><a class="code" href="../../d1/d6/struct__OBJECT__HEADER__QUOTA__INFO.html">00316</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d1/d6/struct__OBJECT__HEADER__QUOTA__INFO.html">_OBJECT_HEADER_QUOTA_INFO</a> {
<a name="l00317"></a><a class="code" href="../../d1/d6/struct__OBJECT__HEADER__QUOTA__INFO.html#o0">00317</a>     ULONG <a class="code" href="../../d1/d6/struct__OBJECT__HEADER__QUOTA__INFO.html#o0">PagedPoolCharge</a>;
<a name="l00318"></a><a class="code" href="../../d1/d6/struct__OBJECT__HEADER__QUOTA__INFO.html#o1">00318</a>     ULONG <a class="code" href="../../d1/d6/struct__OBJECT__HEADER__QUOTA__INFO.html#o1">NonPagedPoolCharge</a>;
<a name="l00319"></a><a class="code" href="../../d1/d6/struct__OBJECT__HEADER__QUOTA__INFO.html#o2">00319</a>     ULONG <a class="code" href="../../d1/d6/struct__OBJECT__HEADER__QUOTA__INFO.html#o2">SecurityDescriptorCharge</a>;
<a name="l00320"></a><a class="code" href="../../d1/d6/struct__OBJECT__HEADER__QUOTA__INFO.html#o3">00320</a>     <a class="code" href="../../d0/d4/struct__EPROCESS.html">PEPROCESS</a> <a class="code" href="../../d1/d6/struct__OBJECT__HEADER__QUOTA__INFO.html#o3">ExclusiveProcess</a>;
00321 } <a class="code" href="../../d1/d6/struct__OBJECT__HEADER__QUOTA__INFO.html">OBJECT_HEADER_QUOTA_INFO</a>, *<a class="code" href="../../d1/d6/struct__OBJECT__HEADER__QUOTA__INFO.html">POBJECT_HEADER_QUOTA_INFO</a>;
00322 
<a name="l00323"></a><a class="code" href="../../d8/d5/struct__OBJECT__HEADER__HANDLE__INFO.html">00323</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d8/d5/struct__OBJECT__HEADER__HANDLE__INFO.html">_OBJECT_HEADER_HANDLE_INFO</a> {
00324     <span class="keyword">union </span>{
<a name="l00325"></a><a class="code" href="../../d8/d5/struct__OBJECT__HEADER__HANDLE__INFO.html#o0">00325</a>         <a class="code" href="../../d4/d0/ob_8h.html#a45">POBJECT_HANDLE_COUNT_DATABASE</a> <a class="code" href="../../d8/d5/struct__OBJECT__HEADER__HANDLE__INFO.html#o0">HandleCountDataBase</a>;
<a name="l00326"></a><a class="code" href="../../d8/d5/struct__OBJECT__HEADER__HANDLE__INFO.html#o1">00326</a>         <a class="code" href="../../d2/d5/struct__OBJECT__HANDLE__COUNT__ENTRY.html">OBJECT_HANDLE_COUNT_ENTRY</a> <a class="code" href="../../d8/d5/struct__OBJECT__HEADER__HANDLE__INFO.html#o1">SingleEntry</a>;
00327     };
00328 } <a class="code" href="../../d8/d5/struct__OBJECT__HEADER__HANDLE__INFO.html">OBJECT_HEADER_HANDLE_INFO</a>, *<a class="code" href="../../d8/d5/struct__OBJECT__HEADER__HANDLE__INFO.html">POBJECT_HEADER_HANDLE_INFO</a>;
00329 
<a name="l00330"></a><a class="code" href="../../d0/d6/struct__OBJECT__HEADER__NAME__INFO.html">00330</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d0/d6/struct__OBJECT__HEADER__NAME__INFO.html">_OBJECT_HEADER_NAME_INFO</a> {
<a name="l00331"></a><a class="code" href="../../d0/d6/struct__OBJECT__HEADER__NAME__INFO.html#o0">00331</a>     <a class="code" href="../../d4/d0/ob_8h.html#a34">POBJECT_DIRECTORY</a> <a class="code" href="../../d0/d6/struct__OBJECT__HEADER__NAME__INFO.html#o0">Directory</a>;
<a name="l00332"></a><a class="code" href="../../d0/d6/struct__OBJECT__HEADER__NAME__INFO.html#o1">00332</a>     UNICODE_STRING <a class="code" href="../../d0/d6/struct__OBJECT__HEADER__NAME__INFO.html#o1">Name</a>;
<a name="l00333"></a><a class="code" href="../../d0/d6/struct__OBJECT__HEADER__NAME__INFO.html#o2">00333</a>     ULONG <a class="code" href="../../d0/d6/struct__OBJECT__HEADER__NAME__INFO.html#o2">Reserved</a>;
00334 <span class="preprocessor">#if DBG</span>
00335 <span class="preprocessor"></span>    ULONG <a class="code" href="../../d1/d9/arc_8h.html#a313a160">Reserved2</a> ;
00336     LONG DbgDereferenceCount ;
00337 <span class="preprocessor">#endif</span>
00338 <span class="preprocessor"></span>} <a class="code" href="../../d0/d6/struct__OBJECT__HEADER__NAME__INFO.html">OBJECT_HEADER_NAME_INFO</a>, *<a class="code" href="../../d0/d6/struct__OBJECT__HEADER__NAME__INFO.html">POBJECT_HEADER_NAME_INFO</a>;
00339 
<a name="l00340"></a><a class="code" href="../../d7/d5/struct__OBJECT__HEADER__CREATOR__INFO.html">00340</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d7/d5/struct__OBJECT__HEADER__CREATOR__INFO.html">_OBJECT_HEADER_CREATOR_INFO</a> {
<a name="l00341"></a><a class="code" href="../../d7/d5/struct__OBJECT__HEADER__CREATOR__INFO.html#o0">00341</a>     LIST_ENTRY <a class="code" href="../../d7/d5/struct__OBJECT__HEADER__CREATOR__INFO.html#o0">TypeList</a>;
<a name="l00342"></a><a class="code" href="../../d7/d5/struct__OBJECT__HEADER__CREATOR__INFO.html#o1">00342</a>     HANDLE <a class="code" href="../../d7/d5/struct__OBJECT__HEADER__CREATOR__INFO.html#o1">CreatorUniqueProcess</a>;
<a name="l00343"></a><a class="code" href="../../d7/d5/struct__OBJECT__HEADER__CREATOR__INFO.html#o2">00343</a>     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a> <a class="code" href="../../d7/d5/struct__OBJECT__HEADER__CREATOR__INFO.html#o2">CreatorBackTraceIndex</a>;
<a name="l00344"></a><a class="code" href="../../d7/d5/struct__OBJECT__HEADER__CREATOR__INFO.html#o3">00344</a>     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a> <a class="code" href="../../d7/d5/struct__OBJECT__HEADER__CREATOR__INFO.html#o3">Reserved</a>;
00345 } <a class="code" href="../../d7/d5/struct__OBJECT__HEADER__CREATOR__INFO.html">OBJECT_HEADER_CREATOR_INFO</a>, *<a class="code" href="../../d7/d5/struct__OBJECT__HEADER__CREATOR__INFO.html">POBJECT_HEADER_CREATOR_INFO</a>;
00346 
<a name="l00347"></a><a class="code" href="../../d4/d0/ob_8h.html#a1">00347</a> <span class="preprocessor">#define OB_FLAG_NEW_OBJECT              0x01</span>
<a name="l00348"></a><a class="code" href="../../d4/d0/ob_8h.html#a2">00348</a> <span class="preprocessor"></span><span class="preprocessor">#define OB_FLAG_KERNEL_OBJECT           0x02</span>
<a name="l00349"></a><a class="code" href="../../d4/d0/ob_8h.html#a3">00349</a> <span class="preprocessor"></span><span class="preprocessor">#define OB_FLAG_CREATOR_INFO            0x04</span>
<a name="l00350"></a><a class="code" href="../../d4/d0/ob_8h.html#a4">00350</a> <span class="preprocessor"></span><span class="preprocessor">#define OB_FLAG_EXCLUSIVE_OBJECT        0x08</span>
<a name="l00351"></a><a class="code" href="../../d4/d0/ob_8h.html#a5">00351</a> <span class="preprocessor"></span><span class="preprocessor">#define OB_FLAG_PERMANENT_OBJECT        0x10</span>
<a name="l00352"></a><a class="code" href="../../d4/d0/ob_8h.html#a6">00352</a> <span class="preprocessor"></span><span class="preprocessor">#define OB_FLAG_DEFAULT_SECURITY_QUOTA  0x20</span>
<a name="l00353"></a><a class="code" href="../../d4/d0/ob_8h.html#a7">00353</a> <span class="preprocessor"></span><span class="preprocessor">#define OB_FLAG_SINGLE_HANDLE_ENTRY     0x40</span>
00354 <span class="preprocessor"></span>
<a name="l00355"></a><a class="code" href="../../d4/d0/ob_8h.html#a8">00355</a> <span class="preprocessor">#define OBJECT_TO_OBJECT_HEADER( o ) \</span>
00356 <span class="preprocessor">    CONTAINING_RECORD( (o), OBJECT_HEADER, Body )</span>
00357 <span class="preprocessor"></span>
<a name="l00358"></a><a class="code" href="../../d4/d0/ob_8h.html#a9">00358</a> <span class="preprocessor">#define OBJECT_HEADER_TO_EXCLUSIVE_PROCESS( oh ) ((oh-&gt;Flags &amp; OB_FLAG_EXCLUSIVE_OBJECT) == 0 ? \</span>
00359 <span class="preprocessor">    NULL : (((POBJECT_HEADER_QUOTA_INFO)((PCHAR)(oh) - (oh)-&gt;QuotaInfoOffset))-&gt;ExclusiveProcess))</span>
00360 <span class="preprocessor"></span>
00361 
<a name="l00362"></a><a class="code" href="../../d4/d0/ob_8h.html#a10">00362</a> <span class="preprocessor">#define OBJECT_HEADER_TO_QUOTA_INFO( oh ) ((POBJECT_HEADER_QUOTA_INFO) \</span>
00363 <span class="preprocessor">    ((oh)-&gt;QuotaInfoOffset == 0 ? NULL : ((PCHAR)(oh) - (oh)-&gt;QuotaInfoOffset)))</span>
00364 <span class="preprocessor"></span>
<a name="l00365"></a><a class="code" href="../../d4/d0/ob_8h.html#a11">00365</a> <span class="preprocessor">#define OBJECT_HEADER_TO_HANDLE_INFO( oh ) ((POBJECT_HEADER_HANDLE_INFO) \</span>
00366 <span class="preprocessor">    ((oh)-&gt;HandleInfoOffset == 0 ? NULL : ((PCHAR)(oh) - (oh)-&gt;HandleInfoOffset)))</span>
00367 <span class="preprocessor"></span>
<a name="l00368"></a><a class="code" href="../../d4/d0/ob_8h.html#a12">00368</a> <span class="preprocessor">#define OBJECT_HEADER_TO_NAME_INFO( oh ) ((POBJECT_HEADER_NAME_INFO) \</span>
00369 <span class="preprocessor">    ((oh)-&gt;NameInfoOffset == 0 ? NULL : ((PCHAR)(oh) - (oh)-&gt;NameInfoOffset)))</span>
00370 <span class="preprocessor"></span>
<a name="l00371"></a><a class="code" href="../../d4/d0/ob_8h.html#a13">00371</a> <span class="preprocessor">#define OBJECT_HEADER_TO_CREATOR_INFO( oh ) ((POBJECT_HEADER_CREATOR_INFO) \</span>
00372 <span class="preprocessor">    (((oh)-&gt;Flags &amp; OB_FLAG_CREATOR_INFO) == 0 ? NULL : ((PCHAR)(oh) - sizeof(OBJECT_HEADER_CREATOR_INFO))))</span>
00373 <span class="preprocessor"></span>
00374 
00375 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
00376 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
00377 <a class="code" href="../../d0/d2/obtype_8c.html#a2">ObCreateObjectType</a>(
00378     IN PUNICODE_STRING TypeName,
00379     IN POBJECT_TYPE_INITIALIZER ObjectTypeInitializer,
00380     IN PSECURITY_DESCRIPTOR SecurityDescriptor OPTIONAL,
00381     OUT POBJECT_TYPE *ObjectType
00382     );
00383 
00384 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00385 <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a0">FASTCALL</a>
00386 <a class="code" href="../../d6/d0/obcreate_8c.html#a13">ObFreeObjectCreateInfoBuffer</a>(
00387     IN POBJECT_CREATE_INFORMATION ObjectCreateInfo
00388     );
00389 
00390 <span class="comment">// begin_nthal</span>
00391 
00392 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
00393 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00394 <a class="code" href="../../d6/d0/obcreate_8c.html#a10">ObDeleteCapturedInsertInfo</a>(
00395     IN PVOID Object
00396     );
00397 
00398 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
00399 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
00400 <a class="code" href="../../d6/d0/obcreate_8c.html#a5">ObCreateObject</a>(
00401     IN KPROCESSOR_MODE ProbeMode,
00402     IN POBJECT_TYPE ObjectType,
00403     IN POBJECT_ATTRIBUTES ObjectAttributes OPTIONAL,
00404     IN KPROCESSOR_MODE OwnershipMode,
00405     IN OUT PVOID ParseContext OPTIONAL,
00406     IN ULONG ObjectBodySize,
00407     IN ULONG PagedPoolCharge,
00408     IN ULONG NonPagedPoolCharge,
00409     OUT PVOID *Object
00410     );
00411 
00412 
00413 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
00414 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
00415 <a class="code" href="../../d1/d1/obinsert_8c.html#a0">ObInsertObject</a>(
00416     IN PVOID Object,
00417     IN <a class="code" href="../../d2/d5/struct__ACCESS__STATE.html">PACCESS_STATE</a> PassedAccessState OPTIONAL,
00418     IN ACCESS_MASK DesiredAccess OPTIONAL,
00419     IN ULONG ObjectPointerBias,
00420     OUT PVOID *NewObject OPTIONAL,
00421     OUT PHANDLE Handle
00422     );
00423 
00424 <span class="comment">// end_nthal</span>
00425 
00426 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>                                                     <span class="comment">// ntddk wdm nthal ntifs</span>
00427 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>                                                        <span class="comment">// ntddk wdm nthal ntifs</span>
00428 <a class="code" href="../../d7/d1/obref_8c.html#a4">ObReferenceObjectByHandle</a>(                                      <span class="comment">// ntddk wdm nthal ntifs</span>
00429     IN HANDLE Handle,                                           <span class="comment">// ntddk wdm nthal ntifs</span>
00430     IN ACCESS_MASK DesiredAccess,                               <span class="comment">// ntddk wdm nthal ntifs</span>
00431     IN POBJECT_TYPE ObjectType OPTIONAL,                        <span class="comment">// ntddk wdm nthal ntifs</span>
00432     IN KPROCESSOR_MODE AccessMode,                              <span class="comment">// ntddk wdm nthal ntifs</span>
00433     OUT PVOID *Object,                                          <span class="comment">// ntddk wdm nthal ntifs</span>
00434     OUT POBJECT_HANDLE_INFORMATION HandleInformation OPTIONAL   <span class="comment">// ntddk wdm nthal ntifs</span>
00435     );                                                          <span class="comment">// ntddk wdm nthal ntifs</span>
00436 
00437 
00438 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
00439 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
00440 <a class="code" href="../../d7/d1/obref_8c.html#a2">ObOpenObjectByName</a>(
00441     IN POBJECT_ATTRIBUTES ObjectAttributes,
00442     IN POBJECT_TYPE ObjectType,
00443     IN KPROCESSOR_MODE AccessMode,
00444     IN OUT <a class="code" href="../../d2/d5/struct__ACCESS__STATE.html">PACCESS_STATE</a> PassedAccessState OPTIONAL,
00445     IN ACCESS_MASK DesiredAccess OPTIONAL,
00446     IN OUT PVOID ParseContext OPTIONAL,
00447     OUT PHANDLE Handle
00448     );
00449 
00450 
00451 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>                                                     <span class="comment">// ntifs</span>
00452 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>                                                        <span class="comment">// ntifs</span>
00453 <a class="code" href="../../d7/d1/obref_8c.html#a3">ObOpenObjectByPointer</a>(                                          <span class="comment">// ntifs</span>
00454     IN PVOID Object,                                            <span class="comment">// ntifs</span>
00455     IN ULONG HandleAttributes,                                  <span class="comment">// ntifs</span>
00456     IN <a class="code" href="../../d2/d5/struct__ACCESS__STATE.html">PACCESS_STATE</a> PassedAccessState OPTIONAL,                <span class="comment">// ntifs</span>
00457     IN ACCESS_MASK DesiredAccess OPTIONAL,                      <span class="comment">// ntifs</span>
00458     IN POBJECT_TYPE ObjectType OPTIONAL,                        <span class="comment">// ntifs</span>
00459     IN KPROCESSOR_MODE AccessMode,                              <span class="comment">// ntifs</span>
00460     OUT PHANDLE Handle                                          <span class="comment">// ntifs</span>
00461     );                                                          <span class="comment">// ntifs</span>
00462 
00463 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
00464 <a class="code" href="../../d7/d1/obref_8c.html#a5">ObReferenceObjectByName</a>(
00465     IN PUNICODE_STRING ObjectName,
00466     IN ULONG Attributes,
00467     IN <a class="code" href="../../d2/d5/struct__ACCESS__STATE.html">PACCESS_STATE</a> PassedAccessState OPTIONAL,
00468     IN ACCESS_MASK DesiredAccess OPTIONAL,
00469     IN POBJECT_TYPE ObjectType,
00470     IN KPROCESSOR_MODE AccessMode,
00471     IN OUT PVOID ParseContext OPTIONAL,
00472     OUT PVOID *Object
00473     );
00474 
00475 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>                                                     <span class="comment">// ntifs</span>
00476 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>                                                            <span class="comment">// ntifs</span>
00477 <a class="code" href="../../d5/d0/obclose_8c.html#a3">ObMakeTemporaryObject</a>(                                          <span class="comment">// ntifs</span>
00478     IN PVOID Object                                             <span class="comment">// ntifs</span>
00479     );                                                          <span class="comment">// ntifs</span>
00480 
00481 
00482 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
00483 BOOLEAN
00484 <a class="code" href="../../d0/d1/obinit_8c.html#a25">ObFindHandleForObject</a>(
00485     IN <a class="code" href="../../d0/d4/struct__EPROCESS.html">PEPROCESS</a> Process,
00486     IN PVOID Object,
00487     IN POBJECT_TYPE ObjectType OPTIONAL,
00488     IN POBJECT_HANDLE_INFORMATION MatchCriteria OPTIONAL,
00489     OUT PHANDLE Handle
00490     );
00491 
00492 <span class="comment">// begin_ntddk begin_wdm begin_nthal begin_ntifs</span>
00493 
<a name="l00494"></a><a class="code" href="../../d4/d0/ob_8h.html#a14">00494</a> <span class="preprocessor">#define ObDereferenceObject(a)                                     \</span>
00495 <span class="preprocessor">        ObfDereferenceObject(a)</span>
00496 <span class="preprocessor"></span>
00497 <span class="comment">//  end_wdm end_ntddk end_nthal end_ntifs</span>
00498 
00499 <span class="preprocessor">#if defined(_NTDDK_) || defined(_NTIFS_) || defined(_NTSRV_) || defined(_NTHAL_)</span>
00500 <span class="preprocessor"></span>
00501 <span class="comment">//  begin_wdm begin_ntddk begin_nthal begin_ntifs</span>
00502 <span class="preprocessor">#define ObReferenceObject(Object) ObfReferenceObject(Object)</span>
00503 <span class="preprocessor"></span>
00504 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
00505 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00506 <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a0">FASTCALL</a>
00507 <a class="code" href="../../d7/d1/obref_8c.html#a7">ObfReferenceObject</a>(
00508     IN PVOID Object
00509     );
00510 
00511 <span class="comment">//  end_wdm end_ntddk end_nthal end_ntifs</span>
00512 <span class="preprocessor">#else</span>
00513 <span class="preprocessor"></span>
<a name="l00514"></a><a class="code" href="../../d4/d0/ob_8h.html#a15">00514</a> <span class="preprocessor">#define ObReferenceObject(Object) {                                \</span>
00515 <span class="preprocessor">    POBJECT_HEADER ObjectHeader = OBJECT_TO_OBJECT_HEADER(Object); \</span>
00516 <span class="preprocessor">    InterlockedIncrement(&amp;ObjectHeader-&gt;PointerCount);             \</span>
00517 <span class="preprocessor">}</span>
00518 <span class="preprocessor"></span>
00519 <span class="preprocessor">#endif</span>
00520 <span class="preprocessor"></span>
00521 <span class="comment">//  begin_wdm begin_ntddk begin_nthal begin_ntifs</span>
00522 
00523 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
00524 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
00525 <a class="code" href="../../d7/d1/obref_8c.html#a6">ObReferenceObjectByPointer</a>(
00526     IN PVOID Object,
00527     IN ACCESS_MASK DesiredAccess,
00528     IN POBJECT_TYPE ObjectType,
00529     IN KPROCESSOR_MODE AccessMode
00530     );
00531 
00532 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
00533 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00534 <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a0">FASTCALL</a>
00535 <a class="code" href="../../d7/d1/obref_8c.html#a8">ObfDereferenceObject</a>(
00536     IN PVOID Object
00537     );
00538 
00539 <span class="comment">// end_ntddk end_wdm end_nthal end_ntifs</span>
00540 
00541 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
00542 <a class="code" href="../../d1/d2/obwait_8c.html#a6">ObWaitForSingleObject</a>(
00543     IN HANDLE Handle,
00544     IN BOOLEAN Alertable,
00545     IN PLARGE_INTEGER Timeout OPTIONAL
00546     );
00547 
00548 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>                                                     <span class="comment">// ntifs</span>
00549 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>                                                        <span class="comment">// ntifs</span>
00550 <a class="code" href="../../d6/d1/obquery_8c.html#a7">ObQueryNameString</a>(                                              <span class="comment">// ntifs</span>
00551     IN PVOID Object,                                            <span class="comment">// ntifs</span>
00552     OUT POBJECT_NAME_INFORMATION ObjectNameInfo,                <span class="comment">// ntifs</span>
00553     IN ULONG Length,                                            <span class="comment">// ntifs</span>
00554     OUT PULONG ReturnLength                                     <span class="comment">// ntifs</span>
00555     );                                                          <span class="comment">// ntifs</span>
00556                                                                 <span class="comment">// ntifs</span>
00557 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>                                                     <span class="comment">// ntifs</span>
00558 ULONG                                                           <span class="comment">// ntifs</span>
00559 <a class="code" href="../../d7/d1/obref_8c.html#a1">ObGetObjectPointerCount</a>(                                        <span class="comment">// ntifs</span>
00560     IN PVOID Object                                             <span class="comment">// ntifs</span>
00561     );                                                          <span class="comment">// ntifs</span>
00562 
00563 <span class="preprocessor">#if DBG</span>
00564 <span class="preprocessor"></span>PUNICODE_STRING
00565 ObGetObjectName(
00566     IN PVOID Object
00567     );
00568 <span class="preprocessor">#endif // DBG</span>
00569 <span class="preprocessor"></span>
00570 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
00571 <a class="code" href="../../d6/d1/obquery_8c.html#a8">ObQueryTypeName</a>(
00572     IN PVOID Object,
00573     PUNICODE_STRING ObjectTypeName,
00574     IN ULONG Length,
00575     OUT PULONG ReturnLength
00576     );
00577 
00578 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
00579 <a class="code" href="../../d6/d1/obquery_8c.html#a9">ObQueryTypeInfo</a>(
00580     IN POBJECT_TYPE ObjectType,
00581     OUT POBJECT_TYPE_INFORMATION ObjectTypeInfo,
00582     IN ULONG Length,
00583     OUT PULONG ReturnLength
00584     );
00585 
00586 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
00587 <a class="code" href="../../d4/d0/ob_8h.html#a85">ObDumpObjectByHandle</a>(
00588     IN HANDLE Handle,
00589     IN POB_DUMP_CONTROL Control OPTIONAL
00590     );
00591 
00592 
00593 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
00594 <a class="code" href="../../d4/d0/ob_8h.html#a86">ObDumpObjectByPointer</a>(
00595     IN PVOID Object,
00596     IN POB_DUMP_CONTROL Control OPTIONAL
00597     );
00598 
00599 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
00600 <a class="code" href="../../d7/d0/obdevmap_8c.html#a0">ObSetDeviceMap</a>(
00601     IN <a class="code" href="../../d0/d4/struct__EPROCESS.html">PEPROCESS</a> TargetProcess,
00602     IN HANDLE DirectoryHandle
00603     );
00604 
00605 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
00606 <a class="code" href="../../d7/d0/obdevmap_8c.html#a1">ObQueryDeviceMapInformation</a>(
00607     IN <a class="code" href="../../d0/d4/struct__EPROCESS.html">PEPROCESS</a> TargetProcess,
00608     OUT PPROCESS_DEVICEMAP_INFORMATION DeviceMapInformation
00609     );
00610 
00611 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00612 <a class="code" href="../../d7/d0/obdevmap_8c.html#a2">ObInheritDeviceMap</a>(
00613     IN <a class="code" href="../../d0/d4/struct__EPROCESS.html">PEPROCESS</a> NewProcess,
00614     IN <a class="code" href="../../d0/d4/struct__EPROCESS.html">PEPROCESS</a> ParentProcess
00615     );
00616 
00617 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00618 <a class="code" href="../../d7/d0/obdevmap_8c.html#a3">ObDereferenceDeviceMap</a>(
00619     IN <a class="code" href="../../d0/d4/struct__EPROCESS.html">PEPROCESS</a> Process
00620     );
00621 
00622 <span class="comment">// begin_ntsrv begin_ntddk</span>
00623 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
00624 <a class="code" href="../../d9/d1/obse_8c.html#a8">ObGetObjectSecurity</a>(
00625     IN PVOID Object,
00626     OUT PSECURITY_DESCRIPTOR *SecurityDescriptor,
00627     OUT PBOOLEAN MemoryAllocated
00628     );
00629 
00630 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00631 <a class="code" href="../../d9/d1/obse_8c.html#a9">ObReleaseObjectSecurity</a>(
00632     IN PSECURITY_DESCRIPTOR SecurityDescriptor,
00633     IN BOOLEAN MemoryAllocated
00634     );
00635 <span class="comment">// end_ntsrv end_ntddk</span>
00636 
00637 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
00638 <a class="code" href="../../d9/d1/obse_8c.html#a7">ObAssignObjectSecurityDescriptor</a>(
00639     IN PVOID Object,
00640     IN PSECURITY_DESCRIPTOR SecurityDescriptor OPTIONAL,
00641     IN POOL_TYPE PoolType
00642     );
00643 
00644 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
00645 <a class="code" href="../../d9/d1/obse_8c.html#a10">ObValidateSecurityQuota</a>(
00646     IN PVOID Object,
00647     IN ULONG NewSize
00648     );
00649 
00650 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
00651 BOOLEAN
00652 <a class="code" href="../../d9/d1/obse_8c.html#a6">ObCheckCreateObjectAccess</a>(
00653     IN PVOID DirectoryObject,
00654     IN ACCESS_MASK CreateAccess,
00655     IN <a class="code" href="../../d2/d5/struct__ACCESS__STATE.html">PACCESS_STATE</a> AccessState OPTIONAL,
00656     IN PUNICODE_STRING ComponentName,
00657     IN BOOLEAN TypeMutexLocked,
00658     IN KPROCESSOR_MODE PreviousMode,
00659     OUT PNTSTATUS AccessStatus
00660    );
00661 
00662 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
00663 BOOLEAN
00664 <a class="code" href="../../d9/d1/obse_8c.html#a3">ObCheckObjectAccess</a>(
00665     IN PVOID Object,
00666     IN <a class="code" href="../../d2/d5/struct__ACCESS__STATE.html">PACCESS_STATE</a> AccessState,
00667     IN BOOLEAN TypeMutexLocked,
00668     IN KPROCESSOR_MODE AccessMode,
00669     OUT PNTSTATUS AccessStatus
00670     );
00671 
00672 
00673 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
00674 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
00675 <a class="code" href="../../d9/d1/obse_8c.html#a11">ObAssignSecurity</a>(
00676     IN <a class="code" href="../../d2/d5/struct__ACCESS__STATE.html">PACCESS_STATE</a> AccessState,
00677     IN PSECURITY_DESCRIPTOR ParentDescriptor OPTIONAL,
00678     IN PVOID Object,
00679     IN POBJECT_TYPE ObjectType
00680     );
00681 
00682 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>                                                        <span class="comment">// ntifs</span>
00683 <a class="code" href="../../d6/d1/obquery_8c.html#a10">ObQueryObjectAuditingByHandle</a>(                                  <span class="comment">// ntifs</span>
00684     IN HANDLE Handle,                                           <span class="comment">// ntifs</span>
00685     OUT PBOOLEAN GenerateOnClose                                <span class="comment">// ntifs</span>
00686     );                                                          <span class="comment">// ntifs</span>
00687 
00688 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
00689 <a class="code" href="../../d9/d1/obse_8c.html#a1">ObSetSecurityObjectByPointer</a> (
00690     IN PVOID Object,
00691     IN SECURITY_INFORMATION SecurityInformation,
00692     IN PSECURITY_DESCRIPTOR SecurityDescriptor
00693     );
00694 
00695 <span class="preprocessor">#if DEVL</span>
00696 <span class="preprocessor"></span>
00697 <span class="keyword">typedef</span> BOOLEAN (*OB_ENUM_OBJECT_TYPE_ROUTINE)(
00698     IN PVOID Object,
00699     IN PUNICODE_STRING ObjectName,
00700     IN ULONG HandleCount,
00701     IN ULONG PointerCount,
00702     IN PVOID Parameter
00703     );
00704 
00705 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
00706 <a class="code" href="../../d0/d2/obtype_8c.html#a3">ObEnumerateObjectsByType</a>(
00707     IN POBJECT_TYPE ObjectType,
00708     IN OB_ENUM_OBJECT_TYPE_ROUTINE EnumerationRoutine,
00709     IN PVOID Parameter
00710     );
00711 
00712 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
00713 <a class="code" href="../../d9/d0/obhandle_8c.html#a5">ObGetHandleInformation</a>(
00714     OUT PSYSTEM_HANDLE_INFORMATION HandleInformation,
00715     IN ULONG Length,
00716     OUT PULONG ReturnLength OPTIONAL
00717     );
00718 
00719 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
00720 <a class="code" href="../../d0/d2/obtype_8c.html#a6">ObGetObjectInformation</a>(
00721     IN PCHAR UserModeBufferAddress,
00722     OUT PSYSTEM_OBJECTTYPE_INFORMATION ObjectInformation,
00723     IN ULONG Length,
00724     OUT PULONG ReturnLength OPTIONAL
00725     );
00726 
00727 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
00728 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
00729 <a class="code" href="../../d9/d1/obse_8c.html#a13">ObSetSecurityDescriptorInfo</a>(
00730     IN PVOID Object,
00731     IN PSECURITY_INFORMATION SecurityInformation,
00732     IN OUT PSECURITY_DESCRIPTOR SecurityDescriptor,
00733     IN OUT PSECURITY_DESCRIPTOR *ObjectsSecurityDescriptor,
00734     IN POOL_TYPE PoolType,
00735     IN PGENERIC_MAPPING GenericMapping
00736     );
00737 
00738 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
00739 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
00740 <a class="code" href="../../d9/d1/obse_8c.html#a12">ObQuerySecurityDescriptorInfo</a>(
00741     IN PSECURITY_INFORMATION SecurityInformation,
00742     OUT PSECURITY_DESCRIPTOR SecurityDescriptor,
00743     IN OUT PULONG Length,
00744     IN PSECURITY_DESCRIPTOR *ObjectsSecurityDescriptor
00745     );
00746 
00747 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
00748 <a class="code" href="../../d8/d1/obsdata_8c.html#a19">ObDeassignSecurity</a> (
00749     IN OUT PSECURITY_DESCRIPTOR *SecurityDescriptor
00750     );
00751 
00752 <span class="preprocessor">#endif // DEVL</span>
00753 <span class="preprocessor"></span>
00754 <span class="preprocessor">#endif // _OB_</span>
</div></pre><hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:41:04 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
