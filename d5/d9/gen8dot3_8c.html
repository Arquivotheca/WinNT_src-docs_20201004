<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: gen8dot3.c File Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>gen8dot3.c File Reference</h1><code>#include "<a class="el" href="../../d6/d8/ntrtlp_8h-source.html">ntrtlp.h</a>"</code><br>
<code>#include &lt;stdio.h&gt;</code><br>

<p>
<a href="../../d6/d8/gen8dot3_8c-source.html">Go to the source code of this file.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d9/gen8dot3_8c.html#a0">IsDbcsCharacter</a>(WC)</td></tr>

<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>WCHAR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d9/gen8dot3_8c.html#a9">GetNextWchar</a> (IN PUNICODE_STRING <a class="el" href="../../d9/d3/rules_8c.html#a6">Name</a>, IN PULONG CurrentIndex, IN BOOLEAN SkipDots, IN BOOLEAN AllowExtendedCharacters)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a14">USHORT</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d9/gen8dot3_8c.html#a10">RtlComputeLfnChecksum</a> (PUNICODE_STRING <a class="el" href="../../d9/d3/rules_8c.html#a6">Name</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d9/gen8dot3_8c.html#a11">RtlGenerate8dot3Name</a> (IN PUNICODE_STRING <a class="el" href="../../d9/d3/rules_8c.html#a6">Name</a>, IN BOOLEAN AllowExtendedCharacters, IN OUT PGENERATE_NAME_CONTEXT Context, OUT PUNICODE_STRING Name8dot3)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d9/gen8dot3_8c.html#a12">RtlIsValidOemCharacter</a> (IN PWCHAR Char)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d9/gen8dot3_8c.html#a13">RtlIsNameLegalDOS8Dot3</a> (IN PUNICODE_STRING <a class="el" href="../../d9/d3/rules_8c.html#a6">Name</a>, IN OUT POEM_STRING OemName OPTIONAL, OUT PBOOLEAN NameContainsSpaces OPTIONAL)</td></tr>

<tr><td colspan=2><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a22">PUSHORT</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d9/gen8dot3_8c.html#a1">NlsUnicodeToMbOemData</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a22">PUSHORT</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d9/gen8dot3_8c.html#a2">NlsOemToUnicodeData</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>PCH&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d9/gen8dot3_8c.html#a3">NlsUnicodeToOemData</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a22">PUSHORT</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d9/gen8dot3_8c.html#a4">NlsMbOemCodePageTables</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d9/gen8dot3_8c.html#a5">NlsMbOemCodePageTag</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a22">PUSHORT</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d9/gen8dot3_8c.html#a6">NlsOemLeadByteInfo</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a14">USHORT</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d9/gen8dot3_8c.html#a7">OemDefaultChar</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>const ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d9/gen8dot3_8c.html#a8">RtlFatIllegalTable</a> []</td></tr>

</table>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="a0" doxytag="gen8dot3.c::IsDbcsCharacter" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define IsDbcsCharacter          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">WC&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div>(             \
    ((WC) &gt; 127) &amp;&amp;                       \
    (<a class="code" href="../../d5/d9/ntrtlp_8h.html#a5">HIBYTE</a>(NlsUnicodeToMbOemData[(WC)])) \
)
</div></pre>
<p>
Definition at line <a class="el" href="../../d6/d8/gen8dot3_8c-source.html#l00066">66</a> of file <a class="el" href="../../d6/d8/gen8dot3_8c-source.html">gen8dot3.c</a>.
<p>
Referenced by <a class="el" href="../../d6/d8/gen8dot3_8c-source.html#l00081">RtlGenerate8dot3Name()</a>.    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a9" doxytag="gen8dot3.c::GetNextWchar" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> WCHAR GetNextWchar           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PUNICODE_STRING&nbsp;</td>
          <td class="mdname" nowrap> <em>Name</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>CurrentIndex</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>SkipDots</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>AllowExtendedCharacters</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d8/gen8dot3_8c-source.html#l00555">555</a> of file <a class="el" href="../../d6/d8/gen8dot3_8c-source.html">gen8dot3.c</a>.
<p>
References <a class="el" href="../../d3/d9/aw_8h-source.html#l00031">L</a>, <a class="el" href="../../d9/d9/geninst_8c-source.html#l00154">Name</a>, <a class="el" href="../../d6/d8/gen8dot3_8c-source.html#l00041">RtlFatIllegalTable</a>, and <a class="el" href="../../d6/d8/gen8dot3_8c-source.html#l00459">RtlIsValidOemCharacter()</a>.
<p>
Referenced by <a class="el" href="../../d6/d8/gen8dot3_8c-source.html#l00081">RtlGenerate8dot3Name()</a>.
<p>
<pre class="fragment"><div>00564                    :
00565 
00566     This routine scans <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> input name starting at <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> current index and
00567     returns <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> next valid character <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <span class="keywordtype">long</span> name to 8.3 generation
00568     algorithm.  It also updates <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> current index to point to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00569     next character to examine.
00570 
00571     The user can specify <span class="keywordflow">if</span> dots are skipped over or passed back.  The
00572     filtering done by <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a69">procedure</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a>:
00573 
00574     1. Skip characters less then blanks, and larger than 127 <span class="keywordflow">if</span>
00575        AllowExtendedCharacters <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>
00576     2. Optionally skip over dots
00577     3. translate <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> special 7 characters : + , ; = [ ] into underscores
00578 
00579 Arguments:
00580 
00581     <a class="code" href="../../d8/d0/geninst_8c.html#a20">Name</a> - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> name being examined
00582 
00583     CurrentIndex - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> index to start our examination and also
00584         receives <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> index of one beyond <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> character we <span class="keywordflow">return</span>.
00585 
00586     SkipDots - Indicates whether <span class="keyword">this</span> routine will also skip over periods
00587 
00588     AllowExtendedCharacters - Tell whether charaacters &gt;= 127 are valid.
00589 
00590 Return Value:
00591 
00592     WCHAR - returns <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> next wchar in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> name string
00593 
00594 --*/
00595 
00596 {
00597     WCHAR wc;
00598 
00599     <span class="comment">//</span>
00600     <span class="comment">//  Until we find out otherwise the character we are going to return</span>
00601     <span class="comment">//  is 0</span>
00602     <span class="comment">//</span>
00603 
00604     wc = 0;
00605 
00606     <span class="comment">//</span>
00607     <span class="comment">//  Now loop through updating the current index until we either have a character to</span>
00608     <span class="comment">//  return or until we exhaust the name buffer</span>
00609     <span class="comment">//</span>
00610 
00611     <span class="keywordflow">while</span> (*CurrentIndex &lt; (ULONG)(<a class="code" href="../../d8/d0/geninst_8c.html#a20">Name</a>-&gt;Length/2)) {
00612 
00613         <span class="comment">//</span>
00614         <span class="comment">//  Get the next character in the buffer</span>
00615         <span class="comment">//</span>
00616 
00617         wc = <a class="code" href="../../d8/d0/geninst_8c.html#a20">Name</a>-&gt;Buffer[*CurrentIndex];
00618         *CurrentIndex += 1;
00619 
00620         <span class="comment">//</span>
00621         <span class="comment">//  If the character is to be skipped over then reset wc to 0</span>
00622         <span class="comment">//</span>
00623 
00624         <span class="keywordflow">if</span> ((wc &lt;= <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="charliteral">' '</span>) ||
00625             ((wc &gt;= 127) &amp;&amp; (!AllowExtendedCharacters || !<a class="code" href="../../d5/d9/gen8dot3_8c.html#a12">RtlIsValidOemCharacter</a>(&amp;wc))) ||
00626             ((wc == <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="charliteral">'.'</span>) &amp;&amp; SkipDots)) {
00627 
00628             wc = 0;
00629 
00630         } <span class="keywordflow">else</span> {
00631 
00632             <span class="comment">//</span>
00633             <span class="comment">//  We have a character to return, but first translate the character is necessary</span>
00634             <span class="comment">//</span>
00635 
00636             <span class="keywordflow">if</span> ((wc &lt; 0x80) &amp;&amp; (<a class="code" href="../../d5/d9/gen8dot3_8c.html#a8">RtlFatIllegalTable</a>[wc/32] &amp; (1 &lt;&lt; (wc%32)))) {
00637 
00638                 wc = <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="charliteral">'_'</span>;
00639             }
00640 
00641             <span class="comment">//</span>
00642             <span class="comment">//  Do an a-z upcase.</span>
00643             <span class="comment">//</span>
00644 
00645             <span class="keywordflow">if</span> ((wc &gt;= <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="charliteral">'a'</span>) &amp;&amp; (wc &lt;= <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="charliteral">'z'</span>)) {
00646 
00647                 wc -= <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="charliteral">'a'</span> - <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="charliteral">'A'</span>;
00648             }
00649 
00650             <span class="comment">//</span>
00651             <span class="comment">//  And break out of the loop to return to our caller</span>
00652             <span class="comment">//</span>
00653 
00654             <span class="keywordflow">break</span>;
00655         }
00656     }
00657 
00658     <span class="comment">//DebugTrace( 0, Dbg, "GetNextWchar -&gt; %08x\n", wc);</span>
00659 
00660     <span class="keywordflow">return</span> wc;
00661 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a10" doxytag="gen8dot3.c::RtlComputeLfnChecksum" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a14">USHORT</a> RtlComputeLfnChecksum           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">PUNICODE_STRING&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Name</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d8/gen8dot3_8c-source.html#l00669">669</a> of file <a class="el" href="../../d6/d8/gen8dot3_8c-source.html">gen8dot3.c</a>.
<p>
References <a class="el" href="../../d9/d9/geninst_8c-source.html#l00154">Name</a>, <a class="el" href="../../d6/d8/ntrtlp_8h-source.html#l00246">RTL_PAGED_CODE</a>, and <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00064">USHORT</a>.
<p>
Referenced by <a class="el" href="../../d6/d8/gen8dot3_8c-source.html#l00081">RtlGenerate8dot3Name()</a>.
<p>
<pre class="fragment"><div>00675                    :
00676 
00677     This routine computes <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> Chicago <span class="keywordtype">long</span> <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a9">file</a> name checksum.
00678 
00679 Arguments:
00680 
00681     <a class="code" href="../../d8/d0/geninst_8c.html#a20">Name</a> - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> name to compute <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> checksum on.  Note that one
00682         character names don'<a class="code" href="../../d4/d1/genmips_8c.html#a17">t</a> have interesting checksums.
00683 
00684 Return Value:
00685 
00686     The checksum.
00687 
00688 --*/
00689 
00690 {
00691     ULONG i;
00692     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a> Checksum;
00693 
00694     <a class="code" href="../../d5/d9/ntrtlp_8h.html#a12">RTL_PAGED_CODE</a>();
00695 
00696     <span class="keywordflow">if</span> (<a class="code" href="../../d8/d0/geninst_8c.html#a20">Name</a>-&gt;Length == <span class="keyword">sizeof</span>(WCHAR)) {
00697 
00698         <span class="keywordflow">return</span> <a class="code" href="../../d8/d0/geninst_8c.html#a20">Name</a>-&gt;Buffer[0];
00699     }
00700 
00701     Checksum = ((<a class="code" href="../../d8/d0/geninst_8c.html#a20">Name</a>-&gt;Buffer[0] &lt;&lt; 8) + <a class="code" href="../../d8/d0/geninst_8c.html#a20">Name</a>-&gt;Buffer[1]) &amp; 0xffff;
00702 
00703     <span class="comment">//</span>
00704     <span class="comment">//  This checksum is kinda strange because we want to still have</span>
00705     <span class="comment">//  a good range even if all the characters are &lt; 0x00ff.</span>
00706     <span class="comment">//</span>
00707 
00708     <span class="keywordflow">for</span> (i=2; i &lt; <a class="code" href="../../d8/d0/geninst_8c.html#a20">Name</a>-&gt;Length / <span class="keyword">sizeof</span>(WCHAR); i+=2) {
00709 
00710         Checksum = (Checksum &amp; 1 ? 0x8000 : 0) +
00711                    (Checksum &gt;&gt; 1) +
00712                    (<a class="code" href="../../d8/d0/geninst_8c.html#a20">Name</a>-&gt;Buffer[i] &lt;&lt; 8);
00713 
00714         <span class="comment">//</span>
00715         <span class="comment">//  Be carefull to not walk off the end of the string.</span>
00716         <span class="comment">//</span>
00717 
00718         <span class="keywordflow">if</span> (i+1 &lt; <a class="code" href="../../d8/d0/geninst_8c.html#a20">Name</a>-&gt;Length / <span class="keyword">sizeof</span>(WCHAR)) {
00719 
00720             Checksum += <a class="code" href="../../d8/d0/geninst_8c.html#a20">Name</a>-&gt;Buffer[i+1] &amp; 0xffff;
00721         }
00722     }
00723 
00724     <span class="keywordflow">return</span> Checksum;
00725 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a11" doxytag="gen8dot3.c::RtlGenerate8dot3Name" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID RtlGenerate8dot3Name           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PUNICODE_STRING&nbsp;</td>
          <td class="mdname" nowrap> <em>Name</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>AllowExtendedCharacters</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN OUT PGENERATE_NAME_CONTEXT&nbsp;</td>
          <td class="mdname" nowrap> <em>Context</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT PUNICODE_STRING&nbsp;</td>
          <td class="mdname" nowrap> <em>Name8dot3</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d8/gen8dot3_8c-source.html#l00081">81</a> of file <a class="el" href="../../d6/d8/gen8dot3_8c-source.html">gen8dot3.c</a>.
<p>
References <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d5/d7/fsrtlpc_8c-source.html#l00062">FsRtlSafeExtensions</a>, <a class="el" href="../../d6/d8/gen8dot3_8c-source.html#l00555">GetNextWchar()</a>, <a class="el" href="../../d6/d8/gen8dot3_8c-source.html#l00066">IsDbcsCharacter</a>, <a class="el" href="../../d3/d9/aw_8h-source.html#l00031">L</a>, <a class="el" href="../../d9/d9/geninst_8c-source.html#l00154">Name</a>, <a class="el" href="../../d6/d8/gen8dot3_8c-source.html#l00032">NlsMbOemCodePageTag</a>, <a class="el" href="../../d6/d8/gen8dot3_8c-source.html#l00669">RtlComputeLfnChecksum()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, and <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00064">USHORT</a>.
<p>
<pre class="fragment"><div>00090                    :
00091 
00092     This routine <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> used to generate an 8.3 name from a <span class="keywordtype">long</span> name.  It can
00093     be called repeatedly to generate different 8.3 name variations <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00094     same <span class="keywordtype">long</span> name.  This <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> necessary <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> gernerated 8.3 name conflicts
00095     with an existing 8.3 name.
00096 
00097 Arguments:
00098 
00099     <a class="code" href="../../d8/d0/geninst_8c.html#a20">Name</a> - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> original <span class="keywordtype">long</span> name that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> being translated from.
00100 
00101     AllowExtendedCharacters - If <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>, then extended characters, including
00102         DBCS characters, are allowed in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> basis of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <span class="keywordtype">short</span> name <span class="keywordflow">if</span> they
00103         map to an upcased Oem character.
00104 
00105     Context - Supplies a context <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a46">translation</a>.  This <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> a <span class="keyword">private</span> structure
00106         needed by <span class="keyword">this</span> routine to <a class="code" href="../../d7/d4/conexts_8c.html#a23">help</a> enumerate <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> different <span class="keywordtype">long</span> name
00107         possibilities.  The caller <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> responsible with providing a <span class="stringliteral">"zeroed out"</span>
00108         context structure on <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> first call <span class="keywordflow">for</span> each given input name.
00109 
00110     Name8dot3 - Receives <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <span class="keyword">new</span> 8.3 name.  Pool <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> buffer must be allocated
00111         by <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> caller and should be 12 characters wide (i.e., 24 bytes).
00112 
00113 Return Value:
00114 
00115     None.
00116 
00117 --*/
00118 
00119 {
00120     BOOLEAN DbcsAware;
00121     BOOLEAN IndexAll9s = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00122     ULONG OemLength;
00123     ULONG IndexLength;
00124     WCHAR IndexBuffer[8];
00125     ULONG i;
00126 
00127 <span class="preprocessor">#ifdef NTOS_KERNEL_RUNTIME</span>
00128 <span class="preprocessor"></span>    <span class="keyword">extern</span> BOOLEAN <a class="code" href="../../d4/d8/fsrtlpc_8c.html#a11">FsRtlSafeExtensions</a>;
00129 <span class="preprocessor">#else</span>
00130 <span class="preprocessor"></span>    BOOLEAN <a class="code" href="../../d4/d8/fsrtlpc_8c.html#a11">FsRtlSafeExtensions</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00131 <span class="preprocessor">#endif</span>
00132 <span class="preprocessor"></span>
00133     DbcsAware = AllowExtendedCharacters &amp;&amp; <a class="code" href="../../d5/d9/gen8dot3_8c.html#a5">NlsMbOemCodePageTag</a>;
00134 
00135     <span class="comment">//</span>
00136     <span class="comment">//  Check if this is the first time we are being called, and if so then</span>
00137     <span class="comment">//  initialize the context fields.</span>
00138     <span class="comment">//</span>
00139 
00140     <span class="keywordflow">if</span> (Context-&gt;NameLength == 0) {
00141 
00142         ULONG LastDotIndex;
00143 
00144         ULONG CurrentIndex;
00145         BOOLEAN SkipDots;
00146         WCHAR wc;
00147 
00148         <span class="comment">//</span>
00149         <span class="comment">//  Skip down the name remembering the index of the last dot we</span>
00150         <span class="comment">//  will skip over the first dot provided the name starts with</span>
00151         <span class="comment">//  a dot.</span>
00152         <span class="comment">//</span>
00153 
00154         LastDotIndex = MAXULONG;
00155 
00156         CurrentIndex = 0;
00157         SkipDots = ((<a class="code" href="../../d8/d0/geninst_8c.html#a20">Name</a>-&gt;Length &gt; 0) &amp;&amp; (<a class="code" href="../../d8/d0/geninst_8c.html#a20">Name</a>-&gt;Buffer[0] == <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="charliteral">'.'</span>));
00158 
00159         <span class="keywordflow">while</span> ((wc = <a class="code" href="../../d5/d9/gen8dot3_8c.html#a9">GetNextWchar</a>( Name,
00160                                    &amp;CurrentIndex,
00161                                    SkipDots,
00162                                    AllowExtendedCharacters )) != 0) {
00163 
00164             SkipDots = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00165             <span class="keywordflow">if</span> (wc == <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="charliteral">'.'</span>) { LastDotIndex = CurrentIndex; }
00166         }
00167 
00168         <span class="comment">//</span>
00169         <span class="comment">//  If the LastDotIndex is the last character in the name,</span>
00170         <span class="comment">//  then there really isn't an extension, so reset LastDotIndex.</span>
00171         <span class="comment">//</span>
00172 
00173         <span class="keywordflow">if</span> (LastDotIndex == <a class="code" href="../../d8/d0/geninst_8c.html#a20">Name</a>-&gt;Length/<span class="keyword">sizeof</span>(WCHAR)) {
00174 
00175             LastDotIndex = MAXULONG;
00176         }
00177 
00178         <span class="comment">//</span>
00179         <span class="comment">//  Build up the name part. This can be at most 6 characters</span>
00180         <span class="comment">//  (because of the ~# appeneded on the end) and we skip over</span>
00181         <span class="comment">//  dots, except the last dot, which terminates the loop.</span>
00182         <span class="comment">//</span>
00183         <span class="comment">//  We exit the loop if:</span>
00184         <span class="comment">//</span>
00185         <span class="comment">//  - The input Name has been exhausted</span>
00186         <span class="comment">//  - We have consumed the input name up to the last dot</span>
00187         <span class="comment">//  - We have filled 6 characters of short name basis</span>
00188         <span class="comment">//</span>
00189 
00190         CurrentIndex = 0;
00191         OemLength = 0;
00192         Context-&gt;NameLength = 0;
00193 
00194         <span class="keywordflow">while</span> ((wc = <a class="code" href="../../d5/d9/gen8dot3_8c.html#a9">GetNextWchar</a>( Name, &amp;CurrentIndex, TRUE, AllowExtendedCharacters)) &amp;&amp;
00195                (CurrentIndex &lt; LastDotIndex) &amp;&amp;
00196                (Context-&gt;NameLength &lt; 6)) {
00197 
00198             <span class="comment">//</span>
00199             <span class="comment">//  If we are on a multi-byte code page we have to be careful</span>
00200             <span class="comment">//  here because the short name (when converted to Oem) must</span>
00201             <span class="comment">//  be 8.3 compliant.  Note that if AllowExtendedCharacters</span>
00202             <span class="comment">//  is FALSE, then GetNextWchar will never return a DBCS</span>
00203             <span class="comment">//  character, so we don't care what kind of code page we</span>
00204             <span class="comment">//  are on.</span>
00205             <span class="comment">//</span>
00206 
00207             <span class="keywordflow">if</span> (DbcsAware) {
00208 
00209                 OemLength += <a class="code" href="../../d5/d9/gen8dot3_8c.html#a0">IsDbcsCharacter</a>(wc) ? 2 : 1;
00210 
00211                 <span class="keywordflow">if</span> (OemLength &gt; 6) { <span class="keywordflow">break</span>; }
00212             }
00213 
00214             <span class="comment">//</span>
00215             <span class="comment">//  Copy the UNICODE character into the name buffer</span>
00216             <span class="comment">//</span>
00217 
00218             Context-&gt;NameBuffer[Context-&gt;NameLength++] = wc;
00219         }
00220 
00221         <span class="comment">//</span>
00222         <span class="comment">//  Now if the name part of the basis is 2 or less bytes (when</span>
00223         <span class="comment">//  represented in Oem) then append a four character checksum</span>
00224         <span class="comment">//  to make the short name space less sparse.</span>
00225         <span class="comment">//</span>
00226 
00227         <span class="keywordflow">if</span> ((DbcsAware ? OemLength : Context-&gt;NameLength) &lt;= 2) {
00228 
00229             <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a> Checksum;
00230             WCHAR Nibble;
00231 
00232             Checksum =
00233             Context-&gt;Checksum = <a class="code" href="../../d5/d9/gen8dot3_8c.html#a10">RtlComputeLfnChecksum</a>( Name );
00234 
00235             <span class="keywordflow">for</span> (i = 0; i &lt; 4; i++, Checksum &gt;&gt;= 4) {
00236 
00237                 Nibble = Checksum &amp; 0xf;
00238                 Nibble += Nibble &lt;= 9 ? <span class="charliteral">'0'</span> : <span class="charliteral">'A'</span> - 10;
00239 
00240                 Context-&gt;NameBuffer[ Context-&gt;NameLength + i ] = Nibble;
00241             }
00242 
00243             Context-&gt;NameLength += 4;
00244             Context-&gt;ChecksumInserted = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00245         }
00246 
00247         <span class="comment">//</span>
00248         <span class="comment">//  Now process the last extension (if there is one).</span>
00249         <span class="comment">//  If the last dot index is not MAXULONG then we</span>
00250         <span class="comment">//  have located the last dot in the name</span>
00251         <span class="comment">//</span>
00252 
00253         <span class="keywordflow">if</span> (LastDotIndex != MAXULONG) {
00254 
00255             <span class="comment">//</span>
00256             <span class="comment">//  Put in the "."</span>
00257             <span class="comment">//</span>
00258 
00259             Context-&gt;ExtensionBuffer[0] = <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="charliteral">'.'</span>;
00260 
00261             <span class="comment">//</span>
00262             <span class="comment">//  Process the extension similar to how we processed the name</span>
00263             <span class="comment">//</span>
00264             <span class="comment">//  We exit the loop if:</span>
00265             <span class="comment">//</span>
00266             <span class="comment">//  - The input Name has been exhausted</span>
00267             <span class="comment">//  - We have filled . + 3 characters of extension</span>
00268             <span class="comment">//</span>
00269 
00270             OemLength = 1;
00271             Context-&gt;ExtensionLength = 1;
00272 
00273             <span class="keywordflow">while</span> ((wc = <a class="code" href="../../d5/d9/gen8dot3_8c.html#a9">GetNextWchar</a>( Name, &amp;LastDotIndex, TRUE, AllowExtendedCharacters)) &amp;&amp;
00274                    (Context-&gt;ExtensionLength &lt; 4)) {
00275 
00276                 <span class="keywordflow">if</span> (DbcsAware) {
00277 
00278                     OemLength += <a class="code" href="../../d5/d9/gen8dot3_8c.html#a0">IsDbcsCharacter</a>(wc) ? 2 : 1;
00279 
00280                     <span class="keywordflow">if</span> (OemLength &gt; 4) { <span class="keywordflow">break</span>; }
00281                 }
00282 
00283                 Context-&gt;ExtensionBuffer[Context-&gt;ExtensionLength++] = wc;
00284             }
00285 
00286             <span class="comment">//</span>
00287             <span class="comment">//  If we had to truncate the extension (i.e. input name was not</span>
00288             <span class="comment">//  exhausted), change the last char of the truncated extension</span>
00289             <span class="comment">//  to a ~ is user has selected safe extensions.</span>
00290             <span class="comment">//</span>
00291 
00292             <span class="keywordflow">if</span> (wc &amp;&amp; <a class="code" href="../../d4/d8/fsrtlpc_8c.html#a11">FsRtlSafeExtensions</a>) {
00293 
00294                 Context-&gt;ExtensionBuffer[Context-&gt;ExtensionLength - 1] = <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="charliteral">'~'</span>;
00295             }
00296 
00297         } <span class="keywordflow">else</span> {
00298 
00299             Context-&gt;ExtensionLength = 0;
00300         }
00301     }
00302 
00303     <span class="comment">//</span>
00304     <span class="comment">//  In all cases we add one to the index value and this is the value</span>
00305     <span class="comment">//  of the index we are going to generate this time around</span>
00306     <span class="comment">//</span>
00307 
00308     Context-&gt;LastIndexValue += 1;
00309 
00310     <span class="comment">//</span>
00311     <span class="comment">//  Now if the new index value is greater than 4 then we've had too</span>
00312     <span class="comment">//  many collisions and we should alter our basis if possible</span>
00313     <span class="comment">//</span>
00314 
00315     <span class="keywordflow">if</span> ((Context-&gt;LastIndexValue &gt; 4) &amp;&amp; !Context-&gt;ChecksumInserted) {
00316 
00317         <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a> Checksum;
00318         WCHAR Nibble;
00319 
00320         <span class="comment">//</span>
00321         <span class="comment">// 'XX' is represented A DBCS character.</span>
00322         <span class="comment">//</span>
00323         <span class="comment">// LongName       -&gt; ShortName  | DbcsBias  Oem  Unicode</span>
00324         <span class="comment">// -----------------------------+------------------------</span>
00325         <span class="comment">// XXXXThisisapen -&gt; XX1234     |    1       6      5</span>
00326         <span class="comment">// XXThisisapen   -&gt; XX1234     |    1       6      5</span>
00327         <span class="comment">// aXXThisisapen  -&gt; a1234      |    1       5      5</span>
00328         <span class="comment">// aaThisisapen   -&gt; aa1234     |    0       6      6</span>
00329         <span class="comment">//</span>
00330 
00331         ULONG DbcsBias;
00332 
00333         <span class="keywordflow">if</span> (DbcsAware) {
00334 
00335               DbcsBias = ((<a class="code" href="../../d5/d9/gen8dot3_8c.html#a0">IsDbcsCharacter</a>(Context-&gt;NameBuffer[0]) ? 1 : 0) |
00336                           (<a class="code" href="../../d5/d9/gen8dot3_8c.html#a0">IsDbcsCharacter</a>(Context-&gt;NameBuffer[1]) ? 1 : 0));
00337 
00338         } <span class="keywordflow">else</span> {
00339 
00340               DbcsBias = 0;
00341         }
00342 
00343         Checksum =
00344         Context-&gt;Checksum = <a class="code" href="../../d5/d9/gen8dot3_8c.html#a10">RtlComputeLfnChecksum</a>( Name );
00345 
00346         <span class="keywordflow">for</span> (i = (2-DbcsBias); i &lt; (6-DbcsBias); i++, Checksum &gt;&gt;= 4) {
00347 
00348             Nibble = Checksum &amp; 0xf;
00349             Nibble += Nibble &lt;= 9 ? <span class="charliteral">'0'</span> : <span class="charliteral">'A'</span> - 10;
00350 
00351             Context-&gt;NameBuffer[ i ] = Nibble;
00352         }
00353 
00354         Context-&gt;NameLength = (UCHAR)(6-DbcsBias);
00355         Context-&gt;LastIndexValue = 1;
00356         Context-&gt;ChecksumInserted = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00357     }
00358 
00359     <span class="comment">//</span>
00360     <span class="comment">//  Now build the index buffer from high index to low index because we</span>
00361     <span class="comment">//  use a mod &amp; div operation to build the string from the index value.</span>
00362     <span class="comment">//</span>
00363     <span class="comment">//  We also want to remember is we are about to rollover in base 10.</span>
00364     <span class="comment">//</span>
00365 
00366     <span class="keywordflow">for</span> (IndexLength = 1, i = Context-&gt;LastIndexValue;
00367          (IndexLength &lt;= 7) &amp;&amp; (i &gt; 0);
00368          IndexLength += 1, i /= 10) {
00369 
00370         <span class="keywordflow">if</span> ((IndexBuffer[ 8 - IndexLength] = (WCHAR)(<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="charliteral">'0'</span> + (i % 10))) != <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="charliteral">'9'</span>) {
00371 
00372             IndexAll9s = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00373         }
00374     }
00375 
00376     <span class="comment">//</span>
00377     <span class="comment">//  And tack on the preceding dash</span>
00378     <span class="comment">//</span>
00379 
00380     IndexBuffer[ 8 - IndexLength ] = <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a><span class="charliteral">'~'</span>;
00381 
00382     <span class="comment">//</span>
00383     <span class="comment">//  At this point everything is set up to copy to the output buffer.  First</span>
00384     <span class="comment">//  copy over the name and then only copy the index and extension if they exist</span>
00385     <span class="comment">//</span>
00386 
00387     <span class="keywordflow">if</span> (Context-&gt;NameLength != 0) {
00388 
00389         RtlCopyMemory( &amp;Name8dot3-&gt;Buffer[0],
00390                        &amp;Context-&gt;NameBuffer[0],
00391                        Context-&gt;NameLength * 2 );
00392 
00393         Name8dot3-&gt;Length = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)(Context-&gt;NameLength * 2);
00394 
00395     } <span class="keywordflow">else</span> {
00396 
00397         Name8dot3-&gt;Length = 0;
00398     }
00399 
00400     <span class="comment">//</span>
00401     <span class="comment">//  Now do the index.</span>
00402     <span class="comment">//</span>
00403 
00404     RtlCopyMemory( &amp;Name8dot3-&gt;Buffer[ Name8dot3-&gt;Length/2 ],
00405                    &amp;IndexBuffer[ 8 - IndexLength ],
00406                    IndexLength * 2 );
00407 
00408     Name8dot3-&gt;Length += (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>) (IndexLength * 2);
00409 
00410     <span class="comment">//</span>
00411     <span class="comment">//  Now conditionally do the extension</span>
00412     <span class="comment">//</span>
00413 
00414     <span class="keywordflow">if</span> (Context-&gt;ExtensionLength != 0) {
00415 
00416         RtlCopyMemory( &amp;Name8dot3-&gt;Buffer[ Name8dot3-&gt;Length/2 ],
00417                        &amp;Context-&gt;ExtensionBuffer[0],
00418                        Context-&gt;ExtensionLength * 2 );
00419 
00420         Name8dot3-&gt;Length += (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>) (Context-&gt;ExtensionLength * 2);
00421     }
00422 
00423     <span class="comment">//</span>
00424     <span class="comment">//  If current index value is all 9s, then the next value will cause the</span>
00425     <span class="comment">//  index string to grow from it's current size.  In this case recompute</span>
00426     <span class="comment">//  Context-&gt;NameLength so that is will be correct for next time.</span>
00427     <span class="comment">//</span>
00428 
00429     <span class="keywordflow">if</span> (IndexAll9s) {
00430 
00431         <span class="keywordflow">if</span> (DbcsAware) {
00432 
00433             <span class="keywordflow">for</span> (i = 0, OemLength = 0; i &lt; Context-&gt;NameLength; i++) {
00434 
00435                 OemLength += <a class="code" href="../../d5/d9/gen8dot3_8c.html#a0">IsDbcsCharacter</a>(Context-&gt;NameBuffer[i]) ? 2 : 1;
00436 
00437                 <span class="keywordflow">if</span> (OemLength &gt;= 8 - (IndexLength + 1)) {
00438                     <span class="keywordflow">break</span>;
00439                 }
00440             }
00441 
00442             Context-&gt;NameLength = (UCHAR)i;
00443 
00444         } <span class="keywordflow">else</span> {
00445 
00446             Context-&gt;NameLength -= 1;
00447         }
00448     }
00449 
00450     <span class="comment">//</span>
00451     <span class="comment">//  And return to our caller</span>
00452     <span class="comment">//</span>
00453 
00454     <span class="keywordflow">return</span>;
00455 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a13" doxytag="gen8dot3.c::RtlIsNameLegalDOS8Dot3" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN RtlIsNameLegalDOS8Dot3           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PUNICODE_STRING&nbsp;</td>
          <td class="mdname" nowrap> <em>Name</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN OUT POEM_STRING OemName&nbsp;</td>
          <td class="mdname" nowrap> <em>OPTIONAL</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT PBOOLEAN NameContainsSpaces&nbsp;</td>
          <td class="mdname" nowrap> <em>OPTIONAL</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d8/gen8dot3_8c-source.html#l00729">729</a> of file <a class="el" href="../../d6/d8/gen8dot3_8c-source.html">gen8dot3.c</a>.
<p>
References <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d2/d9/cmchek_8c-source.html#l00095">Index</a>, <a class="el" href="../../d9/d9/geninst_8c-source.html#l00154">Name</a>, <a class="el" href="../../d6/d8/gen8dot3_8c-source.html#l00032">NlsMbOemCodePageTag</a>, <a class="el" href="../../d6/d8/gen8dot3_8c-source.html#l00033">NlsOemLeadByteInfo</a>, <a class="el" href="../../d6/d5/stierr_8h-source.html#l00030">NT_SUCCESS</a>, <a class="el" href="../../d6/d8/gen8dot3_8c-source.html#l00041">RtlFatIllegalTable</a>, <a class="el" href="../../d7/d5/nls_8c-source.html#l00927">RtlUpcaseUnicodeStringToCountedOemString()</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d1/d1/lboxctl3_8c-source.html#l01071">LB_CreateLBLine()</a>.
<p>
<pre class="fragment"><div>00736                    :
00737 
00738     This routine takes an input string and gives a definitive answer
00739     on whether <span class="keyword">this</span> name can successfully be used to create a <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a9">file</a>
00740     on <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> FAT <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a9">file</a> system.
00741 
00742     This routine can therefore also be used to determine <span class="keywordflow">if</span> a name <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a>
00743     appropriate to be passed back to a Win31 or DOS app, i.e. whether
00744     <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> downlevel APP will understand <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> name.
00745 
00746     Note: an important part of <span class="keyword">this</span> test <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> mapping from UNICODE
00747     to Oem, which <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> why <a class="code" href="../../d1/d9/icmui_8def.html#a4">it</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> important that <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> input parameter be
00748     received in UNICODE.
00749 
00750 Arguments:
00751 
00752     <a class="code" href="../../d8/d0/geninst_8c.html#a20">Name</a> - The UNICODE name to test <span class="keywordflow">for</span> conformance to 8.3 symantics.
00753 
00754     OemName - If specified, will receive <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> Oem name corresponding
00755         to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> passed in <a class="code" href="../../d8/d0/geninst_8c.html#a20">Name</a>.  Storage must be provided by <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> caller.
00756         The name <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> undefined <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> routine returns <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>.
00757 
00758     NameContainsSpaces - If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> function returns <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>, then <span class="keyword">this</span>
00759         parameter will indicate <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> names contains spaces.  If
00760         <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> function returns <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>, <span class="keyword">this</span> parameter <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> undefined. In
00761         many instances, <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> alternate name <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> more appropriate to
00762         use <span class="keywordflow">if</span> spaces are present in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> principle name, even <span class="keywordflow">if</span>
00763         <a class="code" href="../../d1/d9/icmui_8def.html#a4">it</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> 8.3 compliant.
00764 
00765 Return Value:
00766 
00767     BOOLEAN - <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> passed in UNICODE name forms a valid 8.3
00768         FAT name when upcased to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> current Oem code page.
00769 
00770 --*/
00771 
00772 {
00773     ULONG <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>;
00774     BOOLEAN ExtensionPresent = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00775     BOOLEAN SpacesPresent = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00776     OEM_STRING LocalOemName;
00777     UCHAR Char;
00778     UCHAR OemBuffer[12];
00779 
00780     <span class="comment">//</span>
00781     <span class="comment">//  If the name is more than 12 chars, bail.</span>
00782     <span class="comment">//</span>
00783 
00784     <span class="keywordflow">if</span> (<a class="code" href="../../d8/d0/geninst_8c.html#a20">Name</a>-&gt;Length &gt; 12*<span class="keyword">sizeof</span>(WCHAR)) {
00785         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00786     }
00787 
00788     <span class="comment">//</span>
00789     <span class="comment">//  Now upcase this name to Oem.  If anything goes wrong,</span>
00790     <span class="comment">//  return FALSE.</span>
00791     <span class="comment">//</span>
00792 
00793     <span class="keywordflow">if</span> (!ARGUMENT_PRESENT(OemName)) {
00794 
00795         OemName = &amp;LocalOemName;
00796 
00797         OemName-&gt;Buffer = &amp;OemBuffer[0];
00798         OemName-&gt;Length = 0;
00799         OemName-&gt;MaximumLength = 12;
00800     }
00801 
00802     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(<a class="code" href="../../d6/d6/nls_8c.html#a30">RtlUpcaseUnicodeStringToCountedOemString</a>(OemName, Name, FALSE))) {
00803         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00804     }
00805 
00806     <span class="comment">//</span>
00807     <span class="comment">//  Special case . and ..</span>
00808     <span class="comment">//</span>
00809 
00810     <span class="keywordflow">if</span> (((OemName-&gt;Length == 1) &amp;&amp; (OemName-&gt;Buffer[0] == <span class="charliteral">'.'</span>)) ||
00811         ((OemName-&gt;Length == 2) &amp;&amp; (OemName-&gt;Buffer[0] == <span class="charliteral">'.'</span>) &amp;&amp; (OemName-&gt;Buffer[1] == <span class="charliteral">'.'</span>))) {
00812 
00813         <span class="keywordflow">if</span> (ARGUMENT_PRESENT(NameContainsSpaces)) {
00814             *NameContainsSpaces = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00815         }
00816         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00817     }
00818 
00819     <span class="comment">//</span>
00820     <span class="comment">//  Now we are going to walk through the string looking for</span>
00821     <span class="comment">//  illegal characters and/or incorrect syntax.</span>
00822     <span class="comment">//</span>
00823 
00824     <span class="keywordflow">for</span> ( <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> = 0; <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> &lt; OemName-&gt;Length; <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> += 1 ) {
00825 
00826         Char = OemName-&gt;Buffer[ <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> ];
00827 
00828         <span class="comment">//</span>
00829         <span class="comment">//  Skip over and Dbcs chacters</span>
00830         <span class="comment">//</span>
00831 
00832         <span class="keywordflow">if</span> (<a class="code" href="../../d5/d9/gen8dot3_8c.html#a5">NlsMbOemCodePageTag</a> &amp;&amp; <a class="code" href="../../d5/d9/gen8dot3_8c.html#a6">NlsOemLeadByteInfo</a>[Char]) {
00833 
00834             <span class="comment">//</span>
00835             <span class="comment">//  1) if we're looking at base part ( !ExtensionPresent ) and the 8th byte</span>
00836             <span class="comment">//     is in the dbcs leading byte range, it's error ( Index == 7 ). If the</span>
00837             <span class="comment">//     length of base part is more than 8 ( Index &gt; 7 ), it's definitely error.</span>
00838             <span class="comment">//</span>
00839             <span class="comment">//  2) if the last byte ( Index == DbcsName.Length - 1 ) is in the dbcs leading</span>
00840             <span class="comment">//     byte range, it's error</span>
00841             <span class="comment">//</span>
00842 
00843             <span class="keywordflow">if</span> ((!ExtensionPresent &amp;&amp; (<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> &gt;= 7)) ||
00844                 (<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> == (ULONG)(OemName-&gt;Length - 1))) {
00845                 <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00846             }
00847 
00848             <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> += 1;
00849 
00850             <span class="keywordflow">continue</span>;
00851         }
00852 
00853         <span class="comment">//</span>
00854         <span class="comment">//  Make sure this character is legal.</span>
00855         <span class="comment">//</span>
00856 
00857         <span class="keywordflow">if</span> ((Char &lt; 0x80) &amp;&amp;
00858             (<a class="code" href="../../d5/d9/gen8dot3_8c.html#a8">RtlFatIllegalTable</a>[Char/32] &amp; (1 &lt;&lt; (Char%32)))) {
00859             <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00860         }
00861 
00862         <span class="comment">//</span>
00863         <span class="comment">//  Remember if there was a space.</span>
00864         <span class="comment">//</span>
00865 
00866         <span class="keywordflow">if</span> (Char == <span class="charliteral">' '</span>) {
00867             SpacesPresent = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00868         }
00869 
00870         <span class="keywordflow">if</span> (Char == <span class="charliteral">'.'</span>) {
00871 
00872             <span class="comment">//</span>
00873             <span class="comment">//  We stepped onto a period.  We require the following things:</span>
00874             <span class="comment">//</span>
00875             <span class="comment">//      - There can only be one</span>
00876             <span class="comment">//      - It can't be the first character</span>
00877             <span class="comment">//      - The previous character can't be a space.</span>
00878             <span class="comment">//      - There can't be more than 3 bytes following</span>
00879             <span class="comment">//</span>
00880 
00881             <span class="keywordflow">if</span> (ExtensionPresent ||
00882                 (<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> == 0) ||
00883                 (OemName-&gt;Buffer[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> - 1] == <span class="charliteral">' '</span>) ||
00884                 (OemName-&gt;Length - (<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> + 1) &gt; 3)) {
00885 
00886                 <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00887             }
00888 
00889             ExtensionPresent = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00890         }
00891 
00892         <span class="comment">//</span>
00893         <span class="comment">//  The base part of the name can't be more than 8 characters long.</span>
00894         <span class="comment">//</span>
00895 
00896         <span class="keywordflow">if</span> ((<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> &gt;= 8) &amp;&amp; !ExtensionPresent) { <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>; }
00897     }
00898 
00899     <span class="comment">//</span>
00900     <span class="comment">//  The name cannot end in a space or a period.</span>
00901     <span class="comment">//</span>
00902 
00903     <span class="keywordflow">if</span> ((Char == <span class="charliteral">' '</span>) || (Char == <span class="charliteral">'.'</span>)) { <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>; }
00904 
00905     <span class="keywordflow">if</span> (ARGUMENT_PRESENT(NameContainsSpaces)) {
00906         *NameContainsSpaces = SpacesPresent;
00907     }
00908     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00909 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a12" doxytag="gen8dot3.c::RtlIsValidOemCharacter" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN RtlIsValidOemCharacter           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PWCHAR&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Char</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d8/gen8dot3_8c-source.html#l00459">459</a> of file <a class="el" href="../../d6/d8/gen8dot3_8c-source.html">gen8dot3.c</a>.
<p>
References <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d6/d8/ntrtlp_8h-source.html#l00184">HIBYTE</a>, <a class="el" href="../../d6/d8/ntrtlp_8h-source.html#l00183">LOBYTE</a>, <a class="el" href="../../d6/d8/ntrtlp_8h-source.html#l00219">NLS_UPCASE</a>, <a class="el" href="../../d6/d8/gen8dot3_8c-source.html#l00031">NlsMbOemCodePageTables</a>, <a class="el" href="../../d6/d8/gen8dot3_8c-source.html#l00032">NlsMbOemCodePageTag</a>, <a class="el" href="../../d6/d8/gen8dot3_8c-source.html#l00033">NlsOemLeadByteInfo</a>, <a class="el" href="../../d6/d8/gen8dot3_8c-source.html#l00029">NlsOemToUnicodeData</a>, <a class="el" href="../../d6/d8/gen8dot3_8c-source.html#l00028">NlsUnicodeToMbOemData</a>, <a class="el" href="../../d6/d8/gen8dot3_8c-source.html#l00030">NlsUnicodeToOemData</a>, <a class="el" href="../../d6/d8/gen8dot3_8c-source.html#l00034">OemDefaultChar</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, and <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00064">USHORT</a>.
<p>
Referenced by <a class="el" href="../../d6/d8/gen8dot3_8c-source.html#l00555">GetNextWchar()</a>.
<p>
<pre class="fragment"><div>00465                    :
00466 
00467     This routine determines <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> best-fitted and upcased version of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00468     input unicode <span class="keywordtype">char</span> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> a valid Oem character.
00469 
00470 Arguments:
00471 
00472     Char - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a96">Unicode</a> <span class="keywordtype">char</span> and receives <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> best-fitted and
00473         upcased version <span class="keywordflow">if</span> <a class="code" href="../../d1/d9/icmui_8def.html#a4">it</a> was indeed valid.
00474 
00475 Return Value:
00476 
00477     <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> character was valid.
00478 
00479 --*/
00480 
00481 {
00482     WCHAR UniTmp;
00483     WCHAR OemChar;
00484 
00485     <span class="comment">//</span>
00486     <span class="comment">//  First try to make a round trip from Unicode-&gt;Oem-&gt;Unicode.</span>
00487     <span class="comment">//</span>
00488 
00489     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d9/gen8dot3_8c.html#a5">NlsMbOemCodePageTag</a>) {
00490 
00491         UniTmp = (WCHAR)<a class="code" href="../../d5/d9/ntrtlp_8h.html#a10">NLS_UPCASE</a>(NlsOemToUnicodeData[(UCHAR)NlsUnicodeToOemData[*Char]]);
00492         OemChar = <a class="code" href="../../d5/d9/gen8dot3_8c.html#a3">NlsUnicodeToOemData</a>[UniTmp];
00493 
00494     } <span class="keywordflow">else</span> {
00495 
00496         <span class="comment">//</span>
00497         <span class="comment">// Convert to OEM and back to Unicode before upper casing</span>
00498         <span class="comment">// to ensure the visual best fits are converted and</span>
00499         <span class="comment">// upper cased properly.</span>
00500         <span class="comment">//</span>
00501 
00502         OemChar = <a class="code" href="../../d5/d9/gen8dot3_8c.html#a1">NlsUnicodeToMbOemData</a>[ *Char ];
00503 
00504         <span class="keywordflow">if</span> (<a class="code" href="../../d5/d9/gen8dot3_8c.html#a6">NlsOemLeadByteInfo</a>[<a class="code" href="../../d5/d9/ntrtlp_8h.html#a5">HIBYTE</a>(OemChar)]) {
00505 
00506             <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a> Entry;
00507 
00508             <span class="comment">//</span>
00509             <span class="comment">// Lead byte - translate the trail byte using the table</span>
00510             <span class="comment">// that corresponds to this lead byte.</span>
00511             <span class="comment">//</span>
00512 
00513             Entry = <a class="code" href="../../d5/d9/gen8dot3_8c.html#a6">NlsOemLeadByteInfo</a>[<a class="code" href="../../d5/d9/ntrtlp_8h.html#a5">HIBYTE</a>(OemChar)];
00514             UniTmp = (WCHAR)<a class="code" href="../../d5/d9/gen8dot3_8c.html#a4">NlsMbOemCodePageTables</a>[ Entry + <a class="code" href="../../d5/d9/ntrtlp_8h.html#a4">LOBYTE</a>(OemChar) ];
00515 
00516         } <span class="keywordflow">else</span> {
00517 
00518             <span class="comment">//</span>
00519             <span class="comment">// Single byte character.</span>
00520             <span class="comment">//</span>
00521 
00522             UniTmp = <a class="code" href="../../d5/d9/gen8dot3_8c.html#a2">NlsOemToUnicodeData</a>[<a class="code" href="../../d5/d9/ntrtlp_8h.html#a4">LOBYTE</a>(OemChar)];
00523         }
00524 
00525         <span class="comment">//</span>
00526         <span class="comment">//  Now upcase this UNICODE character, and convert it to Oem.</span>
00527         <span class="comment">//</span>
00528 
00529         UniTmp = (WCHAR)<a class="code" href="../../d5/d9/ntrtlp_8h.html#a10">NLS_UPCASE</a>(UniTmp);
00530         OemChar = <a class="code" href="../../d5/d9/gen8dot3_8c.html#a1">NlsUnicodeToMbOemData</a>[UniTmp];
00531     }
00532 
00533     <span class="comment">//</span>
00534     <span class="comment">//  Now if the final OemChar is the default one, then there was no</span>
00535     <span class="comment">//  mapping for this UNICODE character.</span>
00536     <span class="comment">//</span>
00537 
00538     <span class="keywordflow">if</span> (OemChar == <a class="code" href="../../d5/d9/gen8dot3_8c.html#a7">OemDefaultChar</a>) {
00539 
00540         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00541 
00542     } <span class="keywordflow">else</span> {
00543 
00544         *Char = UniTmp;
00545         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00546     }
00547 }

</div></pre>    </td>
  </tr>
</table>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="a4" doxytag="gen8dot3.c::NlsMbOemCodePageTables" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a22">PUSHORT</a> <a class="el" href="../../d9/d6/nlsxlat_8c.html#a22">NlsMbOemCodePageTables</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d8/gen8dot3_8c-source.html#l00031">31</a> of file <a class="el" href="../../d6/d8/gen8dot3_8c-source.html">gen8dot3.c</a>.
<p>
Referenced by <a class="el" href="../../d6/d8/gen8dot3_8c-source.html#l00459">RtlIsValidOemCharacter()</a>, <a class="el" href="../../d0/d6/nlsxlat_8c-source.html#l00576">RtlOemToUnicodeN()</a>, <a class="el" href="../../d0/d6/nlsxlat_8c-source.html#l02454">RtlResetRtlTranslations()</a>, and <a class="el" href="../../d0/d6/nlsxlat_8c-source.html#l01433">RtlUpcaseUnicodeToOemN()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a5" doxytag="gen8dot3.c::NlsMbOemCodePageTag" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN <a class="el" href="../../d9/d6/nlsxlat_8c.html#a26">NlsMbOemCodePageTag</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d8/gen8dot3_8c-source.html#l00032">32</a> of file <a class="el" href="../../d6/d8/gen8dot3_8c-source.html">gen8dot3.c</a>.
<p>
Referenced by <a class="el" href="../../d2/d2/dbcsname_8c-source.html#l00771">FsRtlIsDbcsInExpression()</a>, <a class="el" href="../../d6/d8/gen8dot3_8c-source.html#l00081">RtlGenerate8dot3Name()</a>, <a class="el" href="../../d6/d8/gen8dot3_8c-source.html#l00729">RtlIsNameLegalDOS8Dot3()</a>, <a class="el" href="../../d6/d8/gen8dot3_8c-source.html#l00459">RtlIsValidOemCharacter()</a>, <a class="el" href="../../d0/d6/nlsxlat_8c-source.html#l00576">RtlOemToUnicodeN()</a>, <a class="el" href="../../d0/d6/nlsxlat_8c-source.html#l01665">RtlpDidUnicodeToOemWork()</a>, <a class="el" href="../../d0/d6/nlsxlat_8c-source.html#l02454">RtlResetRtlTranslations()</a>, <a class="el" href="../../d0/d6/nlsxlat_8c-source.html#l01277">RtlUnicodeToOemN()</a>, and <a class="el" href="../../d0/d6/nlsxlat_8c-source.html#l01433">RtlUpcaseUnicodeToOemN()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a6" doxytag="gen8dot3.c::NlsOemLeadByteInfo" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a22">PUSHORT</a> <a class="el" href="../../d9/d6/nlsxlat_8c.html#a21">NlsOemLeadByteInfo</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d8/gen8dot3_8c-source.html#l00033">33</a> of file <a class="el" href="../../d6/d8/gen8dot3_8c-source.html">gen8dot3.c</a>.
<p>
Referenced by <a class="el" href="../../d6/d8/gen8dot3_8c-source.html#l00729">RtlIsNameLegalDOS8Dot3()</a>, <a class="el" href="../../d6/d8/gen8dot3_8c-source.html#l00459">RtlIsValidOemCharacter()</a>, <a class="el" href="../../d0/d6/nlsxlat_8c-source.html#l00576">RtlOemToUnicodeN()</a>, <a class="el" href="../../d0/d6/nlsxlat_8c-source.html#l01665">RtlpDidUnicodeToOemWork()</a>, <a class="el" href="../../d0/d6/nlsxlat_8c-source.html#l02454">RtlResetRtlTranslations()</a>, and <a class="el" href="../../d0/d6/nlsxlat_8c-source.html#l01433">RtlUpcaseUnicodeToOemN()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a2" doxytag="gen8dot3.c::NlsOemToUnicodeData" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a22">PUSHORT</a> <a class="el" href="../../d9/d6/nlsxlat_8c.html#a23">NlsOemToUnicodeData</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d8/gen8dot3_8c-source.html#l00029">29</a> of file <a class="el" href="../../d6/d8/gen8dot3_8c-source.html">gen8dot3.c</a>.
<p>
Referenced by <a class="el" href="../../d6/d8/gen8dot3_8c-source.html#l00459">RtlIsValidOemCharacter()</a>, <a class="el" href="../../d0/d6/nlsxlat_8c-source.html#l00576">RtlOemToUnicodeN()</a>, <a class="el" href="../../d0/d6/nlsxlat_8c-source.html#l02454">RtlResetRtlTranslations()</a>, and <a class="el" href="../../d0/d6/nlsxlat_8c-source.html#l01433">RtlUpcaseUnicodeToOemN()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="gen8dot3.c::NlsUnicodeToMbOemData" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a22">PUSHORT</a> <a class="el" href="../../d9/d6/nlsxlat_8c.html#a25">NlsUnicodeToMbOemData</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d8/gen8dot3_8c-source.html#l00028">28</a> of file <a class="el" href="../../d6/d8/gen8dot3_8c-source.html">gen8dot3.c</a>.
<p>
Referenced by <a class="el" href="../../d6/d8/gen8dot3_8c-source.html#l00459">RtlIsValidOemCharacter()</a>, <a class="el" href="../../d0/d6/nlsxlat_8c-source.html#l02454">RtlResetRtlTranslations()</a>, <a class="el" href="../../d0/d6/nlsxlat_8c-source.html#l01277">RtlUnicodeToOemN()</a>, and <a class="el" href="../../d0/d6/nlsxlat_8c-source.html#l01433">RtlUpcaseUnicodeToOemN()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="gen8dot3.c::NlsUnicodeToOemData" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PCH <a class="el" href="../../d9/d6/nlsxlat_8c.html#a24">NlsUnicodeToOemData</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d8/gen8dot3_8c-source.html#l00030">30</a> of file <a class="el" href="../../d6/d8/gen8dot3_8c-source.html">gen8dot3.c</a>.
<p>
Referenced by <a class="el" href="../../d6/d8/gen8dot3_8c-source.html#l00459">RtlIsValidOemCharacter()</a>, <a class="el" href="../../d0/d6/nlsxlat_8c-source.html#l02454">RtlResetRtlTranslations()</a>, <a class="el" href="../../d0/d6/nlsxlat_8c-source.html#l01277">RtlUnicodeToOemN()</a>, and <a class="el" href="../../d0/d6/nlsxlat_8c-source.html#l01433">RtlUpcaseUnicodeToOemN()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a7" doxytag="gen8dot3.c::OemDefaultChar" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a14">USHORT</a> <a class="el" href="../../d9/d6/nlsxlat_8c.html#a28">OemDefaultChar</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d8/gen8dot3_8c-source.html#l00034">34</a> of file <a class="el" href="../../d6/d8/gen8dot3_8c-source.html">gen8dot3.c</a>.
<p>
Referenced by <a class="el" href="../../d6/d8/gen8dot3_8c-source.html#l00459">RtlIsValidOemCharacter()</a>, <a class="el" href="../../d0/d6/nlsxlat_8c-source.html#l01665">RtlpDidUnicodeToOemWork()</a>, and <a class="el" href="../../d0/d6/nlsxlat_8c-source.html#l02454">RtlResetRtlTranslations()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a8" doxytag="gen8dot3.c::RtlFatIllegalTable" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> const ULONG <a class="el" href="../../d5/d9/gen8dot3_8c.html#a8">RtlFatIllegalTable</a>[]          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Initial value:</b><pre class="fragment"><div> { 0xffffffff,
                               0xfc009c04,
                               0x38000000,
                               0x10000000 }
</div></pre>
<p>
Definition at line <a class="el" href="../../d6/d8/gen8dot3_8c-source.html#l00041">41</a> of file <a class="el" href="../../d6/d8/gen8dot3_8c-source.html">gen8dot3.c</a>.
<p>
Referenced by <a class="el" href="../../d6/d8/gen8dot3_8c-source.html#l00555">GetNextWchar()</a>, and <a class="el" href="../../d6/d8/gen8dot3_8c-source.html#l00729">RtlIsNameLegalDOS8Dot3()</a>.    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:43:48 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
