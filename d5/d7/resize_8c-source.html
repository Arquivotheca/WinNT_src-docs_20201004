<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: resize.c Source File</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>resize.c</h1><a href="../../d4/d8/resize_8c.html">Go to the documentation of this file.</a><pre class="fragment"><div>00001 <span class="comment">/*++</span>
00002 <span class="comment"></span>
00003 <span class="comment">Copyright (c) 1985 - 1999, Microsoft Corporation</span>
00004 <span class="comment"></span>
00005 <span class="comment">Module Name:</span>
00006 <span class="comment"></span>
00007 <span class="comment">    resize.c</span>
00008 <span class="comment"></span>
00009 <span class="comment">Abstract:</span>
00010 <span class="comment"></span>
00011 <span class="comment">        This file implements window resizing.</span>
00012 <span class="comment"></span>
00013 <span class="comment">Author:</span>
00014 <span class="comment"></span>
00015 <span class="comment">    Therese Stowell (thereses) 6-Oct-1991</span>
00016 <span class="comment"></span>
00017 <span class="comment">Revision History:</span>
00018 <span class="comment"></span>
00019 <span class="comment">Notes:</span>
00020 <span class="comment"></span>
00021 <span class="comment">--*/</span>
00022 
00023 <span class="preprocessor">#include "<a class="code" href="../../d6/d3/w32_2ntcon_2server_2precomp_8h.html">precomp.h</a>"</span>
00024 <span class="preprocessor">#pragma hdrstop</span>
00025 <span class="preprocessor"></span>
00026 
00027 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00028 <a class="code" href="../../d4/d8/resize_8c.html#a0">CalculateNewSize</a>(
00029     IN PBOOLEAN MaximizedX,
00030     IN PBOOLEAN MaximizedY,
00031     IN OUT PSHORT DeltaX,
00032     IN OUT PSHORT DeltaY,
00033     IN SHORT WindowSizeX,
00034     IN SHORT WindowSizeY,
00035     IN COORD ScreenBufferSize,
00036     IN COORD FontSize
00037     );
00038 
00039 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
<a name="l00040"></a><a class="code" href="../../d4/d8/resize_8c.html#a1">00040</a> <a class="code" href="../../d4/d8/resize_8c.html#a1">ProcessResizeWindow</a>(
00041     IN <a class="code" href="../../d7/d8/struct__SCREEN__INFORMATION.html">PSCREEN_INFORMATION</a> ScreenInfo,
00042     IN <a class="code" href="../../d1/d3/struct__CONSOLE__INFORMATION.html">PCONSOLE_INFORMATION</a> Console,
00043     IN LPWINDOWPOS WindowPos
00044     )
00045 {
00046     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a> DeltaX,DeltaY;
00047     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a> PixelDeltaX,PixelDeltaY;
00048     <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> Flags=0;
00049     COORD FontSize;
00050 
00051 <span class="preprocessor">#ifdef THERESES_DEBUG</span>
00052 <span class="preprocessor"></span><a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"WM_WINDOWPOSCHANGING message "</span>);
00053 <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"  WindowSize is %d %d\n"</span>,<a class="code" href="../../d7/d2/output_8h.html#a17">CONSOLE_WINDOW_SIZE_X</a>(ScreenInfo),<a class="code" href="../../d7/d2/output_8h.html#a18">CONSOLE_WINDOW_SIZE_Y</a>(ScreenInfo));
00054 <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"  WindowRect is %d %d %d %d\n"</span>,Console-&gt;WindowRect.left,
00055                                          Console-&gt;WindowRect.top,
00056                                          Console-&gt;WindowRect.right,
00057                                          Console-&gt;WindowRect.bottom);
00058 <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"  window pos is %d %d %d %d\n"</span>,WindowPos-&gt;x,
00059                                          WindowPos-&gt;y,
00060                                          WindowPos-&gt;cx,
00061                                          WindowPos-&gt;cy);
00062 <span class="preprocessor">#endif</span>
00063 <span class="preprocessor"></span>
00064     <span class="comment">//</span>
00065     <span class="comment">// If the window is not being resized, don't do anything</span>
00066     <span class="comment">//</span>
00067 
00068     <span class="keywordflow">if</span> (WindowPos-&gt;flags &amp; SWP_NOSIZE) {
00069         <span class="keywordflow">return</span>;
00070     }
00071 
00072     <span class="keywordflow">if</span> (ScreenInfo-&gt;Flags &amp; <a class="code" href="../../d7/d2/output_8h.html#a0">CONSOLE_TEXTMODE_BUFFER</a>) {
00073         FontSize = <a class="code" href="../../d8/d5/consrv_8h.html#a66">SCR_FONTSIZE</a>(ScreenInfo);
00074     } <span class="keywordflow">else</span> {
00075         FontSize.X = 1;
00076         FontSize.Y = 1;
00077     }
00078 
00079     <span class="comment">//</span>
00080     <span class="comment">// If the frame changed, update the system metrics</span>
00081     <span class="comment">//</span>
00082 
00083     <span class="keywordflow">if</span> (WindowPos-&gt;flags &amp; SWP_FRAMECHANGED) {
00084 
00085         <a class="code" href="../../d6/d2/output_8c.html#a38">InitializeSystemMetrics</a>();
00086         <span class="keywordflow">if</span> (Console-&gt;VerticalClientToWindow != <a class="code" href="../../d6/d6/ntcon_2server_2globals_8h.html#a19">VerticalClientToWindow</a> ||
00087             Console-&gt;HorizontalClientToWindow != <a class="code" href="../../d6/d6/ntcon_2server_2globals_8h.html#a20">HorizontalClientToWindow</a>) {
00088 
00089             Console-&gt;VerticalClientToWindow = <a class="code" href="../../d6/d6/ntcon_2server_2globals_8h.html#a19">VerticalClientToWindow</a>;
00090             Console-&gt;HorizontalClientToWindow = <a class="code" href="../../d6/d6/ntcon_2server_2globals_8h.html#a20">HorizontalClientToWindow</a>;
00091             Console-&gt;WindowRect.left = WindowPos-&gt;x;
00092             Console-&gt;WindowRect.top = WindowPos-&gt;y;
00093             Console-&gt;WindowRect.right = WindowPos-&gt;x + WindowPos-&gt;cx;
00094             Console-&gt;WindowRect.bottom = WindowPos-&gt;y + WindowPos-&gt;cy;
00095             <span class="keywordflow">return</span>;
00096         }
00097     }
00098 
00099     PixelDeltaX = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a>)(WindowPos-&gt;cx - (Console-&gt;WindowRect.right - Console-&gt;WindowRect.left));
00100     PixelDeltaY = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a>)(WindowPos-&gt;cy - (Console-&gt;WindowRect.bottom - Console-&gt;WindowRect.top));
00101 
00102     <span class="keywordflow">if</span> (WindowPos-&gt;cx &gt;= (ScreenInfo-&gt;ScreenBufferSize.X * FontSize.X + <a class="code" href="../../d6/d6/ntcon_2server_2globals_8h.html#a19">VerticalClientToWindow</a>) &amp;&amp;
00103         WindowPos-&gt;cy &gt;= (ScreenInfo-&gt;ScreenBufferSize.Y * FontSize.Y + <a class="code" href="../../d6/d6/ntcon_2server_2globals_8h.html#a20">HorizontalClientToWindow</a>)) {
00104 
00105         <span class="comment">//</span>
00106         <span class="comment">// handle maximized case</span>
00107         <span class="comment">//</span>
00108 
00109         ScreenInfo-&gt;WindowMaximizedX = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00110         ScreenInfo-&gt;WindowMaximizedY = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00111         DeltaX = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a>)(ScreenInfo-&gt;ScreenBufferSize.X - <a class="code" href="../../d7/d2/output_8h.html#a17">CONSOLE_WINDOW_SIZE_X</a>(ScreenInfo));
00112         DeltaY = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a>)(ScreenInfo-&gt;ScreenBufferSize.Y - <a class="code" href="../../d7/d2/output_8h.html#a18">CONSOLE_WINDOW_SIZE_Y</a>(ScreenInfo));
00113     } <span class="keywordflow">else</span> {
00114 
00115         DeltaX = PixelDeltaX / FontSize.X;
00116         DeltaY = PixelDeltaY / FontSize.Y;
00117 
00118         <span class="comment">//</span>
00119         <span class="comment">// the only time we will get a WM_WINDOWPOSCHANGING message to grow the</span>
00120         <span class="comment">// window larger than the maximum window size is when another app calls</span>
00121         <span class="comment">// SetWindowPos for our window.  the program manager does that when</span>
00122         <span class="comment">// the user requests Tiling.</span>
00123         <span class="comment">//</span>
00124 
00125         <a class="code" href="../../d4/d8/resize_8c.html#a0">CalculateNewSize</a>(&amp;ScreenInfo-&gt;WindowMaximizedX,
00126                          &amp;ScreenInfo-&gt;WindowMaximizedY,
00127                          &amp;DeltaX,
00128                          &amp;DeltaY,
00129                          (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a>)(<a class="code" href="../../d7/d2/output_8h.html#a17">CONSOLE_WINDOW_SIZE_X</a>(ScreenInfo)),
00130                          (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a>)(<a class="code" href="../../d7/d2/output_8h.html#a18">CONSOLE_WINDOW_SIZE_Y</a>(ScreenInfo)),
00131                          ScreenInfo-&gt;ScreenBufferSize,
00132                          FontSize
00133                         );
00134 <span class="preprocessor">#ifdef THERESES_DEBUG</span>
00135 <span class="preprocessor"></span><a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"Delta X Y is now %d %d\n"</span>,DeltaX,DeltaY);
00136 <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"Maximized X Y is now %d %d\n"</span>,ScreenInfo-&gt;WindowMaximizedX,ScreenInfo-&gt;WindowMaximizedY);
00137 <span class="preprocessor">#endif</span>
00138 <span class="preprocessor"></span>    }
00139 
00140     <span class="comment">//</span>
00141     <span class="comment">// don't move window when resizing less than a column or row.</span>
00142     <span class="comment">//</span>
00143 
00144     <span class="keywordflow">if</span> (!DeltaX &amp;&amp; !DeltaY &amp;&amp; (PixelDeltaX || PixelDeltaY)) {
00145         COORD OriginDifference;
00146 
00147         <span class="comment">//</span>
00148         <span class="comment">// handle tiling case.  tiling can move the window without resizing, but using</span>
00149         <span class="comment">// a size message. we detect this by checking for the window origin changed by</span>
00150         <span class="comment">// more than one character.</span>
00151         <span class="comment">//</span>
00152 
00153         OriginDifference.X = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a>)(WindowPos-&gt;x - Console-&gt;WindowRect.left);
00154         OriginDifference.Y = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a>)(WindowPos-&gt;y - Console-&gt;WindowRect.top);
00155         <span class="keywordflow">if</span> (OriginDifference.X &lt; FontSize.X &amp;&amp; OriginDifference.X &gt; -FontSize.X &amp;&amp;
00156             OriginDifference.Y &lt; FontSize.Y &amp;&amp; OriginDifference.Y &gt; -FontSize.Y) {
00157             WindowPos-&gt;x = Console-&gt;WindowRect.left;
00158             WindowPos-&gt;y = Console-&gt;WindowRect.top;
00159             WindowPos-&gt;cx = Console-&gt;WindowRect.right - Console-&gt;WindowRect.left;
00160             WindowPos-&gt;cy = Console-&gt;WindowRect.bottom - Console-&gt;WindowRect.top;
00161             <span class="keywordflow">return</span>;
00162         }
00163     }
00164 
00165     Flags |= <a class="code" href="../../d1/d7/server_8h.html#a41">RESIZE_SCROLL_BARS</a>;
00166     WindowPos-&gt;cx = (DeltaX + <a class="code" href="../../d7/d2/output_8h.html#a17">CONSOLE_WINDOW_SIZE_X</a>(ScreenInfo)) * FontSize.X + (!ScreenInfo-&gt;WindowMaximizedY * <a class="code" href="../../d6/d6/ntcon_2server_2globals_8h.html#a17">VerticalScrollSize</a>) + <a class="code" href="../../d6/d6/ntcon_2server_2globals_8h.html#a19">VerticalClientToWindow</a>;
00167     WindowPos-&gt;cy = (DeltaY + <a class="code" href="../../d7/d2/output_8h.html#a18">CONSOLE_WINDOW_SIZE_Y</a>(ScreenInfo)) * FontSize.Y + (!ScreenInfo-&gt;WindowMaximizedX * <a class="code" href="../../d6/d6/ntcon_2server_2globals_8h.html#a18">HorizontalScrollSize</a>) + <a class="code" href="../../d6/d6/ntcon_2server_2globals_8h.html#a20">HorizontalClientToWindow</a>;
00168 
00169     <span class="comment">//</span>
00170     <span class="comment">// reflect the new window size in the</span>
00171     <span class="comment">// console window structure</span>
00172     <span class="comment">//</span>
00173 
00174     {
00175     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a> ScrollRange,ScrollPos;
00176 
00177     <span class="comment">//</span>
00178     <span class="comment">// PercentFromTop = ScrollPos / ScrollRange;</span>
00179     <span class="comment">// PercentFromBottom = (ScrollRange - ScrollPos) / ScrollRange;</span>
00180     <span class="comment">//</span>
00181     <span class="comment">// if drag top border up</span>
00182     <span class="comment">//     Window.Top -= NumLines * PercentFromBottom;</span>
00183     <span class="comment">//     Window.Bottom +=  NumLines - (NumLines * PercentFromBottom);</span>
00184     <span class="comment">//</span>
00185     <span class="comment">// if drag top border down</span>
00186     <span class="comment">//     Window.Top += NumLines * PercentFromBottom;</span>
00187     <span class="comment">//     Window.Bottom -=  NumLines - (NumLines * PercentFromBottom);</span>
00188     <span class="comment">//</span>
00189     <span class="comment">// if drag bottom border up</span>
00190     <span class="comment">//     Window.Top -= NumLines * PercentFromTop;</span>
00191     <span class="comment">//     Window.Bottom +=  NumLines - (NumLines * PercentFromTop);</span>
00192     <span class="comment">//</span>
00193     <span class="comment">// if drag bottom border down</span>
00194     <span class="comment">//     Window.Top += NumLines * PercentFromTop;</span>
00195     <span class="comment">//     Window.Bottom -=  NumLines - (NumLines * PercentFromTop);</span>
00196     <span class="comment">//</span>
00197 
00198     ScrollRange = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a>)(ScreenInfo-&gt;ScreenBufferSize.X - <a class="code" href="../../d7/d2/output_8h.html#a17">CONSOLE_WINDOW_SIZE_X</a>(ScreenInfo));
00199     ScrollPos = ScreenInfo-&gt;Window.Left;
00200 
00201     <span class="keywordflow">if</span> (WindowPos-&gt;x != Console-&gt;WindowRect.left) {
00202         <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a> NumLinesFromRight;
00203         <span class="keywordflow">if</span> (ScrollRange) {
00204             NumLinesFromRight = DeltaX * (ScrollRange - ScrollPos) / ScrollRange;
00205         } <span class="keywordflow">else</span> {
00206             NumLinesFromRight = DeltaX; <span class="comment">// have scroll pos at left edge</span>
00207         }
00208         ScreenInfo-&gt;Window.Left -= DeltaX - NumLinesFromRight;
00209         ScreenInfo-&gt;Window.Right += NumLinesFromRight;
00210     } <span class="keywordflow">else</span> {
00211         <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a> NumLinesFromLeft;
00212         <span class="keywordflow">if</span> (ScrollRange) {
00213             NumLinesFromLeft = DeltaX * ScrollPos / ScrollRange;
00214         } <span class="keywordflow">else</span> {
00215             NumLinesFromLeft = 0;   <span class="comment">// have scroll pos at left edge</span>
00216         }
00217         ScreenInfo-&gt;Window.Left -= NumLinesFromLeft;
00218         ScreenInfo-&gt;Window.Right += DeltaX - NumLinesFromLeft;
00219     }
00220 
00221     ScrollRange = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a>)(ScreenInfo-&gt;ScreenBufferSize.Y - <a class="code" href="../../d7/d2/output_8h.html#a18">CONSOLE_WINDOW_SIZE_Y</a>(ScreenInfo));
00222     ScrollPos = ScreenInfo-&gt;Window.Top;
00223     <span class="keywordflow">if</span> (WindowPos-&gt;y != Console-&gt;WindowRect.top) {
00224         <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a> NumLinesFromBottom;
00225         <span class="keywordflow">if</span> (ScrollRange) {
00226             NumLinesFromBottom = DeltaY * (ScrollRange - ScrollPos) / ScrollRange;
00227         } <span class="keywordflow">else</span> {
00228             NumLinesFromBottom = DeltaY; <span class="comment">// have scroll pos at top edge</span>
00229         }
00230         ScreenInfo-&gt;Window.Top -= DeltaY - NumLinesFromBottom;
00231         ScreenInfo-&gt;Window.Bottom += NumLinesFromBottom;
00232     } <span class="keywordflow">else</span> {
00233         <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a> NumLinesFromTop;
00234         <span class="keywordflow">if</span> (ScrollRange) {
00235             NumLinesFromTop = DeltaY * ScrollPos / ScrollRange;
00236         } <span class="keywordflow">else</span> {
00237             NumLinesFromTop = 0;   <span class="comment">// have scroll pos at top edge</span>
00238         }
00239         ScreenInfo-&gt;Window.Top -= NumLinesFromTop;
00240         ScreenInfo-&gt;Window.Bottom += DeltaY - NumLinesFromTop;
00241     }
00242     }
00243 
00244     <span class="keywordflow">if</span> (ScreenInfo-&gt;WindowMaximizedX)
00245         <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a> (<a class="code" href="../../d7/d2/output_8h.html#a17">CONSOLE_WINDOW_SIZE_X</a>(ScreenInfo) == ScreenInfo-&gt;ScreenBufferSize.X);
00246     <span class="keywordflow">if</span> (ScreenInfo-&gt;WindowMaximizedY)
00247         <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a> (<a class="code" href="../../d7/d2/output_8h.html#a18">CONSOLE_WINDOW_SIZE_Y</a>(ScreenInfo) == ScreenInfo-&gt;ScreenBufferSize.Y);
00248 <span class="preprocessor">#ifdef THERESES_DEBUG</span>
00249 <span class="preprocessor"></span><a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"  WindowSize is now %d %d\n"</span>,<a class="code" href="../../d7/d2/output_8h.html#a17">CONSOLE_WINDOW_SIZE_X</a>(ScreenInfo),<a class="code" href="../../d7/d2/output_8h.html#a18">CONSOLE_WINDOW_SIZE_Y</a>(ScreenInfo));
00250 <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"  window pos is now %d %d %d %d\n"</span>,WindowPos-&gt;x,
00251                                          WindowPos-&gt;y,
00252                                          WindowPos-&gt;cx,
00253                                          WindowPos-&gt;cy);
00254 <span class="preprocessor">#endif</span>
00255 <span class="preprocessor"></span>    Console-&gt;ResizeFlags = Flags | (Console-&gt;ResizeFlags &amp; <a class="code" href="../../d1/d7/server_8h.html#a44">SCREEN_BUFFER_CHANGE</a>);
00256 }
00257 
00258 
00259 
00260 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
<a name="l00261"></a><a class="code" href="../../d4/d8/resize_8c.html#a0">00261</a> <a class="code" href="../../d4/d8/resize_8c.html#a0">CalculateNewSize</a>(
00262     IN PBOOLEAN MaximizedX,
00263     IN PBOOLEAN MaximizedY,
00264     IN OUT PSHORT DeltaX,
00265     IN OUT PSHORT DeltaY,
00266     IN SHORT WindowSizeX,
00267     IN SHORT WindowSizeY,
00268     IN COORD ScreenBufferSize,
00269     IN COORD FontSize
00270     )
00271 {
00272     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a> MaxDeltaX = ScreenBufferSize.X - WindowSizeX;
00273     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a> MaxDeltaY = ScreenBufferSize.Y - WindowSizeY;
00274     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a> MinDeltaX = 1 - WindowSizeX;
00275     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a> MinDeltaY = 1 - WindowSizeY;
00276 
00277     <span class="keywordflow">while</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>) {
00278 
00279         <span class="comment">/*</span>
00280 <span class="comment">         * Do we need to remove a horizontal scroll bar?</span>
00281 <span class="comment">         */</span>
00282         <span class="keywordflow">if</span> (!*MaximizedX &amp;&amp; *DeltaX &gt;= MaxDeltaX) {
00283             *MaximizedX = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00284             *DeltaY += (<a class="code" href="../../d6/d6/ntcon_2server_2globals_8h.html#a17">VerticalScrollSize</a>+FontSize.Y-1) / FontSize.Y;
00285         }
00286 
00287         <span class="comment">/*</span>
00288 <span class="comment">         * Do we need to remove a vertical scroll bar?</span>
00289 <span class="comment">         */</span>
00290         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!*MaximizedY &amp;&amp; *DeltaY &gt;= MaxDeltaY) {
00291             *MaximizedY = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00292             *DeltaX += (<a class="code" href="../../d6/d6/ntcon_2server_2globals_8h.html#a18">HorizontalScrollSize</a>+FontSize.X-1) / FontSize.X;
00293         }
00294 
00295         <span class="comment">/*</span>
00296 <span class="comment">         * Do we need to add a horizontal scroll bar?</span>
00297 <span class="comment">         */</span>
00298         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (*MaximizedX &amp;&amp; *DeltaX &lt; MaxDeltaX) {
00299             *MaximizedX = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00300             *DeltaY -= (<a class="code" href="../../d6/d6/ntcon_2server_2globals_8h.html#a17">VerticalScrollSize</a>+FontSize.Y-1) / FontSize.Y;
00301         }
00302 
00303         <span class="comment">/*</span>
00304 <span class="comment">         * Do we need to add a vertical scroll bar?</span>
00305 <span class="comment">         */</span>
00306         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (*MaximizedY &amp;&amp; *DeltaY &lt; MaxDeltaY) {
00307             *MaximizedY = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00308             *DeltaX -= (<a class="code" href="../../d6/d6/ntcon_2server_2globals_8h.html#a18">HorizontalScrollSize</a>+FontSize.X-1) / FontSize.X;
00309         }
00310 
00311         <span class="comment">/*</span>
00312 <span class="comment">         * Everything is done, so get out.</span>
00313 <span class="comment">         */</span>
00314         <span class="keywordflow">else</span> {
00315             <span class="keywordflow">if</span> (*DeltaX &gt; MaxDeltaX)
00316                 *DeltaX = MaxDeltaX;
00317             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (*DeltaX &lt; MinDeltaX)
00318                 *DeltaX = MinDeltaX;
00319             <span class="keywordflow">if</span> (*DeltaY &gt; MaxDeltaY)
00320                 *DeltaY = MaxDeltaY;
00321             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (*DeltaY &lt; MinDeltaY)
00322                 *DeltaY = MinDeltaY;
00323             <span class="keywordflow">return</span>;
00324         }
00325     }
00326 }
</div></pre><hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:41:39 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
