<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: ex.h File Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>ex.h File Reference</h1>
<p>
<a href="../../d6/d7/ex_8h-source.html">Go to the source code of this file.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Classes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d6/struct__CALL__HASH__ENTRY.html">_CALL_HASH_ENTRY</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d6/struct__CALL__PERFORMANCE__DATA.html">_CALL_PERFORMANCE_DATA</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d2/struct__EEVENT__PAIR.html">_EEVENT_PAIR</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d9/struct__FAST__MUTEX.html">_FAST_MUTEX</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d1/struct__GENERAL__LOOKASIDE.html">_GENERAL_LOOKASIDE</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d4/struct__NPAGED__LOOKASIDE__LIST.html">_NPAGED_LOOKASIDE_LIST</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d8/struct__PAGED__LOOKASIDE__LIST.html">_PAGED_LOOKASIDE_LIST</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d9/struct__WORK__QUEUE__ITEM.html">_WORK_QUEUE_ITEM</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d8/d7/struct__EX__WORK__QUEUE.html">_EX_WORK_QUEUE</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d1/d0/struct__ZONE__SEGMENT__HEADER.html">_ZONE_SEGMENT_HEADER</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d0/d0/struct__ZONE__HEADER.html">_ZONE_HEADER</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d7/struct__OWNER__ENTRY.html">_OWNER_ENTRY</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d4/struct__ERESOURCE.html">_ERESOURCE</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d4/struct__RESOURCE__HASH__ENTRY.html">_RESOURCE_HASH_ENTRY</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d4/struct__RESOURCE__PERFORMANCE__DATA.html">_RESOURCE_PERFORMANCE_DATA</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d3/d4/struct__NTDDK__ERESOURCE.html">_NTDDK_ERESOURCE</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d8/struct__EXHANDLE.html">_EXHANDLE</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d7/d3/struct__HANDLE__TABLE__ENTRY.html">_HANDLE_TABLE_ENTRY</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d3/struct__HANDLE__TABLE.html">_HANDLE_TABLE</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d6/d7/struct__EX__DEBUG__LOG__TAG.html">_EX_DEBUG_LOG_TAG</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d7/struct__EX__DEBUG__LOG__EVENT.html">_EX_DEBUG_LOG_EVENT</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d7/struct__EX__DEBUG__LOG.html">_EX_DEBUG_LOG</a></td></tr>

<tr><td colspan=2><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a0">CALL_HASH_TABLE_SIZE</a>&nbsp;&nbsp;&nbsp;64</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a1">RECORD_CALL_DATA</a>(Table)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a2">POOL_QUOTA_FAIL_INSTEAD_OF_RAISE</a>&nbsp;&nbsp;&nbsp;8</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a3">POOL_RAISE_IF_ALLOCATION_FAILURE</a>&nbsp;&nbsp;&nbsp;16</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a4">ExAllocatePoolWithTag</a>(a, b, <a class="el" href="../../d7/d1/genuedef_8c.html#a8">c</a>)&nbsp;&nbsp;&nbsp;ExAllocatePool(a,b)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a5">ExAllocatePoolWithQuotaTag</a>(a, b, <a class="el" href="../../d7/d1/genuedef_8c.html#a8">c</a>)&nbsp;&nbsp;&nbsp;ExAllocatePoolWithQuota(a,b)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a6">PROTECTED_POOL</a>&nbsp;&nbsp;&nbsp;0x80000000</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a7">ExFreePoolWithTag</a>(a, b)&nbsp;&nbsp;&nbsp;ExFreePool(a)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a8">ExInitializeFastMutex</a>(_FastMutex)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a9">ExInitializeSListHead</a>(_listhead_)&nbsp;&nbsp;&nbsp;(_listhead_)-&gt;Alignment = 0</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a10">ExQueryDepthSList</a>(_listhead_)&nbsp;&nbsp;&nbsp;(<a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a14">USHORT</a>)(_listhead_)-&gt;Depth</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a11">ProbeForRead</a>(Address, Length, Alignment)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a12">ProbeAndReadBoolean</a>(Address)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a13">ProbeAndReadChar</a>(Address)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a14">ProbeAndReadUchar</a>(Address)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a15">ProbeAndReadShort</a>(Address)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a16">ProbeAndReadUshort</a>(Address)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a17">ProbeAndReadHandle</a>(Address)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a18">ProbeAndReadPointer</a>(Address)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a19">ProbeAndReadLong</a>(Address)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a20">ProbeAndReadUlong</a>(Address)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a21">ProbeAndReadUlong_ptr</a>(Address)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a22">ProbeAndReadQuad</a>(Address)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a23">ProbeAndReadUquad</a>(Address)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a24">ProbeAndReadLargeInteger</a>(Source)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a25">ProbeAndReadUlargeInteger</a>(Source)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a26">ProbeAndReadUnicodeString</a>(Source)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a27">ProbeAndReadStructure</a>(Source, STRUCTURE)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a28">ProbeForWriteBoolean</a>(Address)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a29">ProbeForWriteChar</a>(Address)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a30">ProbeForWriteUchar</a>(Address)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a31">ProbeForWriteIoStatus</a>(Address)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a32">ProbeForWriteIoStatusEx</a>(Address, Cookie)&nbsp;&nbsp;&nbsp;ProbeForWriteIoStatus(Address)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a33">ProbeForWriteShort</a>(Address)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a34">ProbeForWriteUshort</a>(Address)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a35">ProbeForWriteHandle</a>(Address)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a36">ProbeAndZeroHandle</a>(Address)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a37">ProbeForWritePointer</a>(Address)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a38">ProbeAndNullPointer</a>(Address)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a39">ProbeForWriteLong</a>(Address)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a40">ProbeForWriteUlong</a>(Address)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a41">ProbeForWriteUlong_ptr</a>(Address)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a42">ProbeForWriteQuad</a>(Address)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a43">ProbeForWriteUquad</a>(Address)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a44">ProbeAndWriteBoolean</a>(Address, Value)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a45">ProbeAndWriteChar</a>(Address, Value)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a46">ProbeAndWriteUchar</a>(Address, Value)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a47">ProbeAndWriteShort</a>(Address, Value)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a48">ProbeAndWriteUshort</a>(Address, Value)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a49">ProbeAndWriteHandle</a>(Address, Value)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a50">ProbeAndWriteLong</a>(Address, Value)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a51">ProbeAndWriteUlong</a>(Address, Value)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a52">ProbeAndWriteQuad</a>(Address, Value)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a53">ProbeAndWriteUquad</a>(Address, Value)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a54">ProbeAndWriteStructure</a>(Address, Value, STRUCTURE)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a55">ExInitializeWorkItem</a>(Item, Routine, Context)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a56">ExAllocateFromZone</a>(Zone)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a57">ExFreeToZone</a>(Zone, Block)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a58">ExIsFullZone</a>(Zone)&nbsp;&nbsp;&nbsp;( (Zone)-&gt;FreeList.Next == (PSINGLE_LIST_ENTRY)NULL )</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a59">ExInterlockedAllocateFromZone</a>(Zone, Lock)&nbsp;&nbsp;&nbsp;(PVOID) ExInterlockedPopEntryList( &amp;(Zone)-&gt;FreeList, Lock )</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a60">ExInterlockedFreeToZone</a>(Zone, Block, Lock)&nbsp;&nbsp;&nbsp;ExInterlockedPushEntryList( &amp;(Zone)-&gt;FreeList, ((PSINGLE_LIST_ENTRY) (Block)), Lock )</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a61">ExIsObjectInFirstZoneSegment</a>(Zone, Object)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a62">ResourceNeverExclusive</a>&nbsp;&nbsp;&nbsp;0x10</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a63">ResourceReleaseByOtherThread</a>&nbsp;&nbsp;&nbsp;0x20</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a64">ResourceOwnedExclusive</a>&nbsp;&nbsp;&nbsp;0x80</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a65">RESOURCE_HASH_TABLE_SIZE</a>&nbsp;&nbsp;&nbsp;64</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a66">ExReleaseResource</a>(R)&nbsp;&nbsp;&nbsp;(ExReleaseResourceLite(R))</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a67">ExGetCurrentResourceThread</a>()&nbsp;&nbsp;&nbsp;((ULONG_PTR)PsGetCurrentThread())</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a68">ExInitializeResource</a>&nbsp;&nbsp;&nbsp;ExInitializeResourceLite</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a69">ExAcquireResourceShared</a>&nbsp;&nbsp;&nbsp;ExAcquireResourceSharedLite</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a70">ExAcquireResourceExclusive</a>&nbsp;&nbsp;&nbsp;ExAcquireResourceExclusiveLite</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a71">ExReleaseResourceForThread</a>&nbsp;&nbsp;&nbsp;ExReleaseResourceForThreadLite</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a72">ExConvertExclusiveToShared</a>&nbsp;&nbsp;&nbsp;ExConvertExclusiveToSharedLite</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a73">ExDeleteResource</a>&nbsp;&nbsp;&nbsp;ExDeleteResourceLite</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a74">ExIsResourceAcquiredExclusive</a>&nbsp;&nbsp;&nbsp;ExIsResourceAcquiredExclusiveLite</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a75">ExIsResourceAcquiredShared</a>&nbsp;&nbsp;&nbsp;ExIsResourceAcquiredSharedLite</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a76">ExDisableResourceBoost</a>&nbsp;&nbsp;&nbsp;ExDisableResourceBoostLite</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a77">ExSetHandleTableOwner</a>(ht, id)&nbsp;&nbsp;&nbsp;{(ht)-&gt;UniqueProcessId = (id);}</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a78">ExSetHandleTableOrder</a>(ht, or)&nbsp;&nbsp;&nbsp;{NOTHING;}</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a79">ExAllocateLocallyUniqueId</a>(Luid)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a80">EX_DEBUG_LOG_FORMAT_NONE</a>&nbsp;&nbsp;&nbsp;(UCHAR)0</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a81">EX_DEBUG_LOG_FORMAT_ULONG</a>&nbsp;&nbsp;&nbsp;(UCHAR)1</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a82">EX_DEBUG_LOG_FORMAT_PSZ</a>&nbsp;&nbsp;&nbsp;(UCHAR)2</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a83">EX_DEBUG_LOG_FORMAT_PWSZ</a>&nbsp;&nbsp;&nbsp;(UCHAR)3</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a84">EX_DEBUG_LOG_FORMAT_STRING</a>&nbsp;&nbsp;&nbsp;(UCHAR)4</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a85">EX_DEBUG_LOG_FORMAT_USTRING</a>&nbsp;&nbsp;&nbsp;(UCHAR)5</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a86">EX_DEBUG_LOG_FORMAT_OBJECT</a>&nbsp;&nbsp;&nbsp;(UCHAR)6</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a87">EX_DEBUG_LOG_FORMAT_HANDLE</a>&nbsp;&nbsp;&nbsp;(UCHAR)7</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a88">EX_DEBUG_LOG_NUMBER_OF_DATA_VALUES</a>&nbsp;&nbsp;&nbsp;4</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a89">EX_DEBUG_LOG_NUMBER_OF_BACK_TRACES</a>&nbsp;&nbsp;&nbsp;4</td></tr>

<tr><td colspan=2><br><h2>Typedefs</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d7/d6/struct__CALL__HASH__ENTRY.html">_CALL_HASH_ENTRY</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a90">CALL_HASH_ENTRY</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d7/d6/struct__CALL__HASH__ENTRY.html">_CALL_HASH_ENTRY</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a91">PCALL_HASH_ENTRY</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d8/d6/struct__CALL__PERFORMANCE__DATA.html">_CALL_PERFORMANCE_DATA</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a92">CALL_PERFORMANCE_DATA</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d8/d6/struct__CALL__PERFORMANCE__DATA.html">_CALL_PERFORMANCE_DATA</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a93">PCALL_PERFORMANCE_DATA</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d0/d2/struct__EEVENT__PAIR.html">_EEVENT_PAIR</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a94">EEVENT_PAIR</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d0/d2/struct__EEVENT__PAIR.html">_EEVENT_PAIR</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a95">PEEVENT_PAIR</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef enum <a class="el" href="../../d5/d8/ex_8h.html#a329">_POOL_TYPE</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a96">POOL_TYPE</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef enum <a class="el" href="../../d5/d8/ex_8h.html#a330">_EX_POOL_PRIORITY</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a97">EX_POOL_PRIORITY</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d6/d9/struct__FAST__MUTEX.html">_FAST_MUTEX</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a98">FAST_MUTEX</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d6/d9/struct__FAST__MUTEX.html">_FAST_MUTEX</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a99">PFAST_MUTEX</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef PVOID(*&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a100">PALLOCATE_FUNCTION</a> )(IN <a class="el" href="../../d5/d8/ex_8h.html#a96">POOL_TYPE</a> PoolType, IN SIZE_T NumberOfBytes, IN ULONG Tag)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef VOID(*&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a101">PFREE_FUNCTION</a> )(IN PVOID <a class="el" href="../../d8/d6/ttri_8c.html#a3">Buffer</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d6/d1/struct__GENERAL__LOOKASIDE.html">_GENERAL_LOOKASIDE</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a102">GENERAL_LOOKASIDE</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d6/d1/struct__GENERAL__LOOKASIDE.html">_GENERAL_LOOKASIDE</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a103">PGENERAL_LOOKASIDE</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d1/d4/struct__NPAGED__LOOKASIDE__LIST.html">_NPAGED_LOOKASIDE_LIST</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a104">NPAGED_LOOKASIDE_LIST</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d1/d4/struct__NPAGED__LOOKASIDE__LIST.html">_NPAGED_LOOKASIDE_LIST</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a105">PNPAGED_LOOKASIDE_LIST</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d1/d8/struct__PAGED__LOOKASIDE__LIST.html">_PAGED_LOOKASIDE_LIST</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a106">PAGED_LOOKASIDE_LIST</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d1/d8/struct__PAGED__LOOKASIDE__LIST.html">_PAGED_LOOKASIDE_LIST</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a107">PPAGED_LOOKASIDE_LIST</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef enum <a class="el" href="../../d5/d8/ex_8h.html#a331">_PP_NPAGED_LOOKASIDE_NUMBER</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a108">PP_NPAGED_LOOKASIDE_NUMBER</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef enum <a class="el" href="../../d5/d8/ex_8h.html#a331">_PP_NPAGED_LOOKASIDE_NUMBER</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a109">PPP_NPAGED_LOOKASIDE_NUMBER</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef enum <a class="el" href="../../d5/d8/ex_8h.html#a332">_WORK_QUEUE_TYPE</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a110">WORK_QUEUE_TYPE</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef VOID(*&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a111">PWORKER_THREAD_ROUTINE</a> )(IN PVOID Parameter)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d7/d9/struct__WORK__QUEUE__ITEM.html">_WORK_QUEUE_ITEM</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a112">WORK_QUEUE_ITEM</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d7/d9/struct__WORK__QUEUE__ITEM.html">_WORK_QUEUE_ITEM</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a113">PWORK_QUEUE_ITEM</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d8/d7/struct__EX__WORK__QUEUE.html">_EX_WORK_QUEUE</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a114">EX_WORK_QUEUE</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d8/d7/struct__EX__WORK__QUEUE.html">_EX_WORK_QUEUE</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a115">PEX_WORK_QUEUE</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d1/d0/struct__ZONE__SEGMENT__HEADER.html">_ZONE_SEGMENT_HEADER</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a117">ZONE_SEGMENT_HEADER</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d1/d0/struct__ZONE__SEGMENT__HEADER.html">_ZONE_SEGMENT_HEADER</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a118">PZONE_SEGMENT_HEADER</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d0/d0/struct__ZONE__HEADER.html">_ZONE_HEADER</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a119">ZONE_HEADER</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d0/d0/struct__ZONE__HEADER.html">_ZONE_HEADER</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a120">PZONE_HEADER</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef ULONG_PTR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a121">ERESOURCE_THREAD</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d5/d8/ex_8h.html#a121">ERESOURCE_THREAD</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a122">PERESOURCE_THREAD</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d6/d7/struct__OWNER__ENTRY.html">_OWNER_ENTRY</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a123">OWNER_ENTRY</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d6/d7/struct__OWNER__ENTRY.html">_OWNER_ENTRY</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a124">POWNER_ENTRY</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d6/d4/struct__ERESOURCE.html">_ERESOURCE</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a125">ERESOURCE</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d6/d4/struct__ERESOURCE.html">_ERESOURCE</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a126">PERESOURCE</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d3/d4/struct__RESOURCE__HASH__ENTRY.html">_RESOURCE_HASH_ENTRY</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a127">RESOURCE_HASH_ENTRY</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d3/d4/struct__RESOURCE__HASH__ENTRY.html">_RESOURCE_HASH_ENTRY</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a128">PRESOURCE_HASH_ENTRY</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d4/d4/struct__RESOURCE__PERFORMANCE__DATA.html">_RESOURCE_PERFORMANCE_DATA</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a129">RESOURCE_PERFORMANCE_DATA</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d4/d4/struct__RESOURCE__PERFORMANCE__DATA.html">_RESOURCE_PERFORMANCE_DATA</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a130">PRESOURCE_PERFORMANCE_DATA</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d3/d4/struct__NTDDK__ERESOURCE.html">_NTDDK_ERESOURCE</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a131">NTDDK_ERESOURCE</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d3/d4/struct__NTDDK__ERESOURCE.html">NTDDK_ERESOURCE</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a132">PNTDDK_ERESOURCE</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d7/d8/struct__EXHANDLE.html">_EXHANDLE</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a133">EXHANDLE</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d7/d8/struct__EXHANDLE.html">_EXHANDLE</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a134">PEXHANDLE</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d7/d3/struct__HANDLE__TABLE__ENTRY.html">_HANDLE_TABLE_ENTRY</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a135">HANDLE_TABLE_ENTRY</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d7/d3/struct__HANDLE__TABLE__ENTRY.html">_HANDLE_TABLE_ENTRY</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a136">PHANDLE_TABLE_ENTRY</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d6/d3/struct__HANDLE__TABLE.html">_HANDLE_TABLE</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a137">HANDLE_TABLE</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d6/d3/struct__HANDLE__TABLE.html">_HANDLE_TABLE</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a138">PHANDLE_TABLE</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef VOID(*&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a139">EX_DESTROY_HANDLE_ROUTINE</a> )(IN HANDLE <a class="el" href="../../d5/d6/w98_2lh__open_2pi__basic_8h.html#a29">Handle</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef BOOLEAN(*&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a140">EX_ENUMERATE_HANDLE_ROUTINE</a> )(IN <a class="el" href="../../d7/d3/struct__HANDLE__TABLE__ENTRY.html">PHANDLE_TABLE_ENTRY</a> HandleTableEntry, IN HANDLE <a class="el" href="../../d5/d6/w98_2lh__open_2pi__basic_8h.html#a29">Handle</a>, IN PVOID EnumParameter)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef BOOLEAN(*&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a141">EX_DUPLICATE_HANDLE_ROUTINE</a> )(IN struct <a class="el" href="../../d0/d4/struct__EPROCESS.html">_EPROCESS</a> *Process OPTIONAL, IN <a class="el" href="../../d7/d3/struct__HANDLE__TABLE__ENTRY.html">PHANDLE_TABLE_ENTRY</a> HandleTableEntry)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef NTSTATUS(*&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a142">PEX_SNAPSHOT_HANDLE_ENTRY</a> )(IN OUT PSYSTEM_HANDLE_TABLE_ENTRY_INFO *HandleEntryInfo, IN HANDLE UniqueProcessId, IN <a class="el" href="../../d7/d3/struct__HANDLE__TABLE__ENTRY.html">PHANDLE_TABLE_ENTRY</a> HandleEntry, IN HANDLE <a class="el" href="../../d5/d6/w98_2lh__open_2pi__basic_8h.html#a29">Handle</a>, IN ULONG Length, IN OUT PULONG RequiredLength)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef BOOLEAN(*&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a143">PEX_CHANGE_HANDLE_ROUTINE</a> )(IN OUT <a class="el" href="../../d7/d3/struct__HANDLE__TABLE__ENTRY.html">PHANDLE_TABLE_ENTRY</a> HandleTableEntry, IN ULONG_PTR Parameter)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d6/d7/struct__EX__DEBUG__LOG__TAG.html">_EX_DEBUG_LOG_TAG</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a150">EX_DEBUG_LOG_TAG</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d6/d7/struct__EX__DEBUG__LOG__TAG.html">_EX_DEBUG_LOG_TAG</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a151">PEX_DEBUG_LOG_TAG</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d5/d7/struct__EX__DEBUG__LOG__EVENT.html">_EX_DEBUG_LOG_EVENT</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a152">EX_DEBUG_LOG_EVENT</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d5/d7/struct__EX__DEBUG__LOG__EVENT.html">_EX_DEBUG_LOG_EVENT</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a153">PEX_DEBUG_LOG_EVENT</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d4/d7/struct__EX__DEBUG__LOG.html">_EX_DEBUG_LOG</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a154">EX_DEBUG_LOG</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d4/d7/struct__EX__DEBUG__LOG.html">_EX_DEBUG_LOG</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a155">PEX_DEBUG_LOG</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d9/d6/struct__CALLBACK__OBJECT.html">_CALLBACK_OBJECT</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a156">PCALLBACK_OBJECT</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef VOID(*&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a157">PCALLBACK_FUNCTION</a> )(IN PVOID CallbackContext, IN PVOID Argument1, IN PVOID Argument2)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef PVOID(*&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a170">PKWIN32_GLOBALATOMTABLE_CALLOUT</a> )(void)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef GUID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a172">UUID</a></td></tr>

<tr><td colspan=2><br><h2>Enumerations</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>enum &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a329">_POOL_TYPE</a> { <br>
&nbsp;&nbsp;<a class="el" href="../../d5/d8/ex_8h.html#a329a173">NonPagedPool</a>, 
<a class="el" href="../../d5/d8/ex_8h.html#a329a174">PagedPool</a>, 
<a class="el" href="../../d5/d8/ex_8h.html#a329a175">NonPagedPoolMustSucceed</a>, 
<a class="el" href="../../d5/d8/ex_8h.html#a329a176">DontUseThisType</a>, 
<br>
&nbsp;&nbsp;<a class="el" href="../../d5/d8/ex_8h.html#a329a177">NonPagedPoolCacheAligned</a>, 
<a class="el" href="../../d5/d8/ex_8h.html#a329a178">PagedPoolCacheAligned</a>, 
<a class="el" href="../../d5/d8/ex_8h.html#a329a179">NonPagedPoolCacheAlignedMustS</a>, 
<a class="el" href="../../d5/d8/ex_8h.html#a329a180">MaxPoolType</a>, 
<br>
&nbsp;&nbsp;<a class="el" href="../../d5/d8/ex_8h.html#a329a181">NonPagedPoolSession</a> =  32, 
<a class="el" href="../../d5/d8/ex_8h.html#a329a182">PagedPoolSession</a> =  NonPagedPoolSession + 1, 
<a class="el" href="../../d5/d8/ex_8h.html#a329a183">NonPagedPoolMustSucceedSession</a> =  PagedPoolSession + 1, 
<a class="el" href="../../d5/d8/ex_8h.html#a329a184">DontUseThisTypeSession</a> =  NonPagedPoolMustSucceedSession + 1, 
<br>
&nbsp;&nbsp;<a class="el" href="../../d5/d8/ex_8h.html#a329a185">NonPagedPoolCacheAlignedSession</a> =  DontUseThisTypeSession + 1, 
<a class="el" href="../../d5/d8/ex_8h.html#a329a186">PagedPoolCacheAlignedSession</a> =  NonPagedPoolCacheAlignedSession + 1, 
<a class="el" href="../../d5/d8/ex_8h.html#a329a187">NonPagedPoolCacheAlignedMustSSession</a> =  PagedPoolCacheAlignedSession + 1
<br>
 }</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>enum &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a330">_EX_POOL_PRIORITY</a> { <br>
&nbsp;&nbsp;<a class="el" href="../../d5/d8/ex_8h.html#a330a188">LowPoolPriority</a>, 
<a class="el" href="../../d5/d8/ex_8h.html#a330a189">LowPoolPrioritySpecialPoolOverrun</a> =  8, 
<a class="el" href="../../d5/d8/ex_8h.html#a330a190">LowPoolPrioritySpecialPoolUnderrun</a> =  9, 
<a class="el" href="../../d5/d8/ex_8h.html#a330a191">NormalPoolPriority</a> =  16, 
<br>
&nbsp;&nbsp;<a class="el" href="../../d5/d8/ex_8h.html#a330a192">NormalPoolPrioritySpecialPoolOverrun</a> =  24, 
<a class="el" href="../../d5/d8/ex_8h.html#a330a193">NormalPoolPrioritySpecialPoolUnderrun</a> =  25, 
<a class="el" href="../../d5/d8/ex_8h.html#a330a194">HighPoolPriority</a> =  32, 
<a class="el" href="../../d5/d8/ex_8h.html#a330a195">HighPoolPrioritySpecialPoolOverrun</a> =  40, 
<br>
&nbsp;&nbsp;<a class="el" href="../../d5/d8/ex_8h.html#a330a196">HighPoolPrioritySpecialPoolUnderrun</a> =  41
<br>
 }</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>enum &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a331">_PP_NPAGED_LOOKASIDE_NUMBER</a> { <br>
&nbsp;&nbsp;<a class="el" href="../../d5/d8/ex_8h.html#a331a197">LookasideSmallIrpList</a>, 
<a class="el" href="../../d5/d8/ex_8h.html#a331a198">LookasideLargeIrpList</a>, 
<a class="el" href="../../d5/d8/ex_8h.html#a331a199">LookasideMdlList</a>, 
<a class="el" href="../../d5/d8/ex_8h.html#a331a200">LookasideCreateInfoList</a>, 
<br>
&nbsp;&nbsp;<a class="el" href="../../d5/d8/ex_8h.html#a331a201">LookasideNameBufferList</a>, 
<a class="el" href="../../d5/d8/ex_8h.html#a331a202">LookasideTwilightList</a>, 
<a class="el" href="../../d5/d8/ex_8h.html#a331a203">LookasideCompletionList</a>, 
<a class="el" href="../../d5/d8/ex_8h.html#a331a204">LookasideMaximumList</a>
<br>
 }</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>enum &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a332">_WORK_QUEUE_TYPE</a> { <a class="el" href="../../d5/d8/ex_8h.html#a332a205">CriticalWorkQueue</a>, 
<a class="el" href="../../d5/d8/ex_8h.html#a332a206">DelayedWorkQueue</a>, 
<a class="el" href="../../d5/d8/ex_8h.html#a332a207">HyperCriticalWorkQueue</a>, 
<a class="el" href="../../d5/d8/ex_8h.html#a332a208">MaximumWorkQueue</a>
 }</td></tr>

<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a209">ExInitializeCallData</a> (IN <a class="el" href="../../d8/d6/struct__CALL__PERFORMANCE__DATA.html">PCALL_PERFORMANCE_DATA</a> CallData)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a210">ExRecordCallerInHashTable</a> (IN <a class="el" href="../../d8/d6/struct__CALL__PERFORMANCE__DATA.html">PCALL_PERFORMANCE_DATA</a> CallData, IN PVOID CallersAddress, IN PVOID CallersCaller)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a211">ExInitSystem</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a212">ExInitSystemPhase2</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a213">ExInitPoolLookasidePointers</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a214">ExComputeTickCountMultiplier</a> (IN ULONG TimeIncrement)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a215">InitializePool</a> (IN <a class="el" href="../../d5/d8/ex_8h.html#a96">POOL_TYPE</a> PoolType, IN ULONG Threshold)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a216">ExInsertPoolTag</a> (ULONG Tag, PVOID Va, SIZE_T NumberOfBytes, <a class="el" href="../../d5/d8/ex_8h.html#a96">POOL_TYPE</a> PoolType)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a217">ExAllocatePoolSanityChecks</a> (IN <a class="el" href="../../d5/d8/ex_8h.html#a96">POOL_TYPE</a> PoolType, IN SIZE_T NumberOfBytes)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a218">ExFreePoolSanityChecks</a> (IN PVOID P)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI PVOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a219">ExAllocatePool</a> (IN <a class="el" href="../../d5/d8/ex_8h.html#a96">POOL_TYPE</a> PoolType, IN SIZE_T NumberOfBytes)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI PVOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a220">ExAllocatePoolWithQuota</a> (IN <a class="el" href="../../d5/d8/ex_8h.html#a96">POOL_TYPE</a> PoolType, IN SIZE_T NumberOfBytes)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI PVOID NTAPI&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a221">ExAllocatePoolWithTag</a> (IN <a class="el" href="../../d5/d8/ex_8h.html#a96">POOL_TYPE</a> PoolType, IN SIZE_T NumberOfBytes, IN ULONG Tag)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI PVOID NTAPI&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a222">ExAllocatePoolWithTagPriority</a> (IN <a class="el" href="../../d5/d8/ex_8h.html#a96">POOL_TYPE</a> PoolType, IN SIZE_T NumberOfBytes, IN ULONG Tag, IN <a class="el" href="../../d5/d8/ex_8h.html#a97">EX_POOL_PRIORITY</a> Priority)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI PVOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a223">ExAllocatePoolWithQuotaTag</a> (IN <a class="el" href="../../d5/d8/ex_8h.html#a96">POOL_TYPE</a> PoolType, IN SIZE_T NumberOfBytes, IN ULONG Tag)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI VOID NTAPI&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a224">ExFreePool</a> (IN PVOID P)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a225">ExFreePoolWithTag</a> (IN PVOID P, IN ULONG Tag)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI KIRQL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a226">ExLockPool</a> (IN <a class="el" href="../../d5/d8/ex_8h.html#a96">POOL_TYPE</a> PoolType)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a227">ExUnlockPool</a> (IN <a class="el" href="../../d5/d8/ex_8h.html#a96">POOL_TYPE</a> PoolType, IN KIRQL LockHandle)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a228">ExQueryPoolBlockSize</a> (IN PVOID PoolBlock, OUT PBOOLEAN QuotaCharged)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a229">ExQueryPoolUsage</a> (OUT PULONG PagedPoolPages, OUT PULONG NonPagedPoolPages, OUT PULONG PagedPoolAllocs, OUT PULONG PagedPoolFrees, OUT PULONG PagedPoolLookasideHits, OUT PULONG NonPagedPoolAllocs, OUT PULONG NonPagedPoolFrees, OUT PULONG NonPagedPoolLookasideHits)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a230">ExReturnPoolQuota</a> (IN PVOID P)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI VOID FASTCALL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a231">ExAcquireFastMutexUnsafe</a> (IN <a class="el" href="../../d6/d9/struct__FAST__MUTEX.html">PFAST_MUTEX</a> FastMutex)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI VOID FASTCALL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a232">ExReleaseFastMutexUnsafe</a> (IN <a class="el" href="../../d6/d9/struct__FAST__MUTEX.html">PFAST_MUTEX</a> FastMutex)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI VOID FASTCALL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a233">ExInterlockedAddLargeStatistic</a> (IN PLARGE_INTEGER Addend, IN ULONG Increment)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI LARGE_INTEGER&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a234">ExInterlockedAddLargeInteger</a> (IN PLARGE_INTEGER Addend, IN LARGE_INTEGER Increment, IN PKSPIN_LOCK Lock)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI ULONG FASTCALL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a235">ExInterlockedAddUlong</a> (IN PULONG Addend, IN ULONG Increment, IN PKSPIN_LOCK Lock)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI LONGLONG FASTCALL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a236">ExInterlockedCompareExchange64</a> (IN PLONGLONG Destination, IN PLONGLONG Exchange, IN PLONGLONG Comperand, IN PKSPIN_LOCK Lock)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI PLIST_ENTRY FASTCALL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a237">ExInterlockedInsertHeadList</a> (IN PLIST_ENTRY ListHead, IN PLIST_ENTRY ListEntry, IN PKSPIN_LOCK Lock)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI PLIST_ENTRY FASTCALL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a238">ExInterlockedInsertTailList</a> (IN PLIST_ENTRY ListHead, IN PLIST_ENTRY ListEntry, IN PKSPIN_LOCK Lock)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI PLIST_ENTRY FASTCALL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a239">ExInterlockedRemoveHeadList</a> (IN PLIST_ENTRY ListHead, IN PKSPIN_LOCK Lock)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI PSINGLE_LIST_ENTRY <br>
FASTCALL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a240">ExInterlockedPopEntryList</a> (IN PSINGLE_LIST_ENTRY ListHead, IN PKSPIN_LOCK Lock)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI PSINGLE_LIST_ENTRY <br>
FASTCALL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a241">ExInterlockedPushEntryList</a> (IN PSINGLE_LIST_ENTRY ListHead, IN PSINGLE_LIST_ENTRY ListEntry, IN PKSPIN_LOCK Lock)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI PSINGLE_LIST_ENTRY <br>
FASTCALL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a242">ExInterlockedPopEntrySList</a> (IN <a class="el" href="../../d9/d3/union__SLIST__HEADER.html">PSLIST_HEADER</a> ListHead, IN PKSPIN_LOCK Lock)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI PSINGLE_LIST_ENTRY <br>
FASTCALL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a243">ExInterlockedPushEntrySList</a> (IN <a class="el" href="../../d9/d3/union__SLIST__HEADER.html">PSLIST_HEADER</a> ListHead, IN PSINGLE_LIST_ENTRY ListEntry, IN PKSPIN_LOCK Lock)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI PSINGLE_LIST_ENTRY <br>
FASTCALL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a244">ExInterlockedFlushSList</a> (IN <a class="el" href="../../d9/d3/union__SLIST__HEADER.html">PSLIST_HEADER</a> ListHead)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a245">ExAdjustLookasideDepth</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a246">ExInitializeNPagedLookasideList</a> (IN <a class="el" href="../../d1/d4/struct__NPAGED__LOOKASIDE__LIST.html">PNPAGED_LOOKASIDE_LIST</a> Lookaside, IN <a class="el" href="../../d5/d8/ex_8h.html#a100">PALLOCATE_FUNCTION</a> Allocate, IN <a class="el" href="../../d5/d8/ex_8h.html#a101">PFREE_FUNCTION</a> Free, IN ULONG Flags, IN SIZE_T <a class="el" href="../../d9/d7/w98_2lh__open_2pi__mem_8h.html#a0">Size</a>, IN ULONG Tag, IN <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a14">USHORT</a> Depth)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a247">ExDeleteNPagedLookasideList</a> (IN <a class="el" href="../../d1/d4/struct__NPAGED__LOOKASIDE__LIST.html">PNPAGED_LOOKASIDE_LIST</a> Lookaside)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>__inline PVOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a248">ExAllocateFromNPagedLookasideList</a> (IN <a class="el" href="../../d1/d4/struct__NPAGED__LOOKASIDE__LIST.html">PNPAGED_LOOKASIDE_LIST</a> Lookaside)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>__inline VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a249">ExFreeToNPagedLookasideList</a> (IN <a class="el" href="../../d1/d4/struct__NPAGED__LOOKASIDE__LIST.html">PNPAGED_LOOKASIDE_LIST</a> Lookaside, IN PVOID Entry)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a250">ExInitializePagedLookasideList</a> (IN <a class="el" href="../../d1/d8/struct__PAGED__LOOKASIDE__LIST.html">PPAGED_LOOKASIDE_LIST</a> Lookaside, IN <a class="el" href="../../d5/d8/ex_8h.html#a100">PALLOCATE_FUNCTION</a> Allocate, IN <a class="el" href="../../d5/d8/ex_8h.html#a101">PFREE_FUNCTION</a> Free, IN ULONG Flags, IN SIZE_T <a class="el" href="../../d9/d7/w98_2lh__open_2pi__mem_8h.html#a0">Size</a>, IN ULONG Tag, IN <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a14">USHORT</a> Depth)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a251">ExDeletePagedLookasideList</a> (IN <a class="el" href="../../d1/d8/struct__PAGED__LOOKASIDE__LIST.html">PPAGED_LOOKASIDE_LIST</a> Lookaside)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>__inline PVOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a252">ExAllocateFromPagedLookasideList</a> (IN <a class="el" href="../../d1/d8/struct__PAGED__LOOKASIDE__LIST.html">PPAGED_LOOKASIDE_LIST</a> Lookaside)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>__inline VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a253">ExFreeToPagedLookasideList</a> (IN <a class="el" href="../../d1/d8/struct__PAGED__LOOKASIDE__LIST.html">PPAGED_LOOKASIDE_LIST</a> Lookaside, IN PVOID Entry)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>__inline PVOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a254">ExAllocateFromPPNPagedLookasideList</a> (IN <a class="el" href="../../d5/d8/ex_8h.html#a108">PP_NPAGED_LOOKASIDE_NUMBER</a> Number)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>__inline VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a255">ExFreeToPPNPagedLookasideList</a> (IN <a class="el" href="../../d5/d8/ex_8h.html#a108">PP_NPAGED_LOOKASIDE_NUMBER</a> Number, IN PVOID Entry)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI PVOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a256">ExLockUserBuffer</a> (IN PVOID <a class="el" href="../../d8/d6/ttri_8c.html#a3">Buffer</a>, IN ULONG Length, OUT PVOID *LockVariable)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a257">ExUnlockUserBuffer</a> (IN PVOID LockVariable)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI VOID NTAPI&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a258">ProbeForRead</a> (IN CONST VOID *Address, IN ULONG Length, IN ULONG Alignment)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI VOID NTAPI&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a259">ProbeForWrite</a> (IN PVOID Address, IN ULONG Length, IN ULONG Alignment)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a260">ExTimerRundown</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a261">ExQueueWorkItem</a> (IN <a class="el" href="../../d7/d9/struct__WORK__QUEUE__ITEM.html">PWORK_QUEUE_ITEM</a> WorkItem, IN <a class="el" href="../../d5/d8/ex_8h.html#a110">WORK_QUEUE_TYPE</a> QueueType)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a262">ExIsProcessorFeaturePresent</a> (ULONG ProcessorFeature)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a263">ExInitializeZone</a> (IN <a class="el" href="../../d0/d0/struct__ZONE__HEADER.html">PZONE_HEADER</a> Zone, IN ULONG BlockSize, IN PVOID InitialSegment, IN ULONG InitialSegmentSize)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a264">ExExtendZone</a> (IN <a class="el" href="../../d0/d0/struct__ZONE__HEADER.html">PZONE_HEADER</a> Zone, IN PVOID Segment, IN ULONG SegmentSize)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a265">ExInterlockedExtendZone</a> (IN <a class="el" href="../../d0/d0/struct__ZONE__HEADER.html">PZONE_HEADER</a> Zone, IN PVOID Segment, IN ULONG SegmentSize, IN PKSPIN_LOCK Lock)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a266">ExInitializeResourceLite</a> (IN <a class="el" href="../../d6/d4/struct__ERESOURCE.html">PERESOURCE</a> <a class="el" href="../../d4/d0/tex_8c.html#a21">Resource</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a267">ExReinitializeResourceLite</a> (IN <a class="el" href="../../d6/d4/struct__ERESOURCE.html">PERESOURCE</a> <a class="el" href="../../d4/d0/tex_8c.html#a21">Resource</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a268">ExAcquireResourceSharedLite</a> (IN <a class="el" href="../../d6/d4/struct__ERESOURCE.html">PERESOURCE</a> <a class="el" href="../../d4/d0/tex_8c.html#a21">Resource</a>, IN BOOLEAN Wait)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a269">ExAcquireResourceExclusiveLite</a> (IN <a class="el" href="../../d6/d4/struct__ERESOURCE.html">PERESOURCE</a> <a class="el" href="../../d4/d0/tex_8c.html#a21">Resource</a>, IN BOOLEAN Wait)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a270">ExAcquireSharedStarveExclusive</a> (IN <a class="el" href="../../d6/d4/struct__ERESOURCE.html">PERESOURCE</a> <a class="el" href="../../d4/d0/tex_8c.html#a21">Resource</a>, IN BOOLEAN Wait)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a271">ExAcquireSharedWaitForExclusive</a> (IN <a class="el" href="../../d6/d4/struct__ERESOURCE.html">PERESOURCE</a> <a class="el" href="../../d4/d0/tex_8c.html#a21">Resource</a>, IN BOOLEAN Wait)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a272">ExTryToAcquireResourceExclusiveLite</a> (IN <a class="el" href="../../d6/d4/struct__ERESOURCE.html">PERESOURCE</a> <a class="el" href="../../d4/d0/tex_8c.html#a21">Resource</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI VOID FASTCALL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a273">ExReleaseResourceLite</a> (IN <a class="el" href="../../d6/d4/struct__ERESOURCE.html">PERESOURCE</a> <a class="el" href="../../d4/d0/tex_8c.html#a21">Resource</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a274">ExReleaseResourceForThreadLite</a> (IN <a class="el" href="../../d6/d4/struct__ERESOURCE.html">PERESOURCE</a> <a class="el" href="../../d4/d0/tex_8c.html#a21">Resource</a>, IN <a class="el" href="../../d5/d8/ex_8h.html#a121">ERESOURCE_THREAD</a> ResourceThreadId)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a275">ExSetResourceOwnerPointer</a> (IN <a class="el" href="../../d6/d4/struct__ERESOURCE.html">PERESOURCE</a> <a class="el" href="../../d4/d0/tex_8c.html#a21">Resource</a>, IN PVOID OwnerPointer)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a276">ExConvertExclusiveToSharedLite</a> (IN <a class="el" href="../../d6/d4/struct__ERESOURCE.html">PERESOURCE</a> <a class="el" href="../../d4/d0/tex_8c.html#a21">Resource</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a277">ExDeleteResourceLite</a> (IN <a class="el" href="../../d6/d4/struct__ERESOURCE.html">PERESOURCE</a> <a class="el" href="../../d4/d0/tex_8c.html#a21">Resource</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a278">ExGetExclusiveWaiterCount</a> (IN <a class="el" href="../../d6/d4/struct__ERESOURCE.html">PERESOURCE</a> <a class="el" href="../../d4/d0/tex_8c.html#a21">Resource</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a279">ExGetSharedWaiterCount</a> (IN <a class="el" href="../../d6/d4/struct__ERESOURCE.html">PERESOURCE</a> <a class="el" href="../../d4/d0/tex_8c.html#a21">Resource</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a280">ExDisableResourceBoostLite</a> (IN <a class="el" href="../../d6/d4/struct__ERESOURCE.html">PERESOURCE</a> <a class="el" href="../../d4/d0/tex_8c.html#a21">Resource</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a281">ExIsResourceAcquiredExclusiveLite</a> (IN <a class="el" href="../../d6/d4/struct__ERESOURCE.html">PERESOURCE</a> <a class="el" href="../../d4/d0/tex_8c.html#a21">Resource</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a282">ExIsResourceAcquiredSharedLite</a> (IN <a class="el" href="../../d6/d4/struct__ERESOURCE.html">PERESOURCE</a> <a class="el" href="../../d4/d0/tex_8c.html#a21">Resource</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a283">ExLockHandleTableShared</a> (<a class="el" href="../../d6/d3/struct__HANDLE__TABLE.html">PHANDLE_TABLE</a> HandleTable)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a284">ExLockHandleTableExclusive</a> (<a class="el" href="../../d6/d3/struct__HANDLE__TABLE.html">PHANDLE_TABLE</a> HandleTable)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a285">ExUnlockHandleTableShared</a> (<a class="el" href="../../d6/d3/struct__HANDLE__TABLE.html">PHANDLE_TABLE</a> HandleTable)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a286">ExUnlockHandleTableExclusive</a> (<a class="el" href="../../d6/d3/struct__HANDLE__TABLE.html">PHANDLE_TABLE</a> HandleTable)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a287">ExLockHandleTableEntry</a> (<a class="el" href="../../d6/d3/struct__HANDLE__TABLE.html">PHANDLE_TABLE</a> HandleTable, <a class="el" href="../../d7/d3/struct__HANDLE__TABLE__ENTRY.html">PHANDLE_TABLE_ENTRY</a> HandleTableEntry)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a288">ExUnlockHandleTableEntry</a> (<a class="el" href="../../d6/d3/struct__HANDLE__TABLE.html">PHANDLE_TABLE</a> HandleTable, <a class="el" href="../../d7/d3/struct__HANDLE__TABLE__ENTRY.html">PHANDLE_TABLE_ENTRY</a> HandleTableEntry)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a289">ExInitializeHandleTablePackage</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI <a class="el" href="../../d6/d3/struct__HANDLE__TABLE.html">PHANDLE_TABLE</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a290">ExCreateHandleTable</a> (IN struct <a class="el" href="../../d0/d4/struct__EPROCESS.html">_EPROCESS</a> *Process OPTIONAL)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a291">ExRemoveHandleTable</a> (IN <a class="el" href="../../d6/d3/struct__HANDLE__TABLE.html">PHANDLE_TABLE</a> HandleTable)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a292">ExDestroyHandleTable</a> (IN <a class="el" href="../../d6/d3/struct__HANDLE__TABLE.html">PHANDLE_TABLE</a> HandleTable, IN <a class="el" href="../../d5/d8/ex_8h.html#a139">EX_DESTROY_HANDLE_ROUTINE</a> DestroyHandleProcedure)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a293">ExEnumHandleTable</a> (IN <a class="el" href="../../d6/d3/struct__HANDLE__TABLE.html">PHANDLE_TABLE</a> HandleTable, IN <a class="el" href="../../d5/d8/ex_8h.html#a140">EX_ENUMERATE_HANDLE_ROUTINE</a> EnumHandleProcedure, IN PVOID EnumParameter, OUT PHANDLE <a class="el" href="../../d5/d6/w98_2lh__open_2pi__basic_8h.html#a29">Handle</a> OPTIONAL)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI <a class="el" href="../../d6/d3/struct__HANDLE__TABLE.html">PHANDLE_TABLE</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a294">ExDupHandleTable</a> (IN struct <a class="el" href="../../d0/d4/struct__EPROCESS.html">_EPROCESS</a> *Process OPTIONAL, IN <a class="el" href="../../d6/d3/struct__HANDLE__TABLE.html">PHANDLE_TABLE</a> OldHandleTable, IN <a class="el" href="../../d5/d8/ex_8h.html#a141">EX_DUPLICATE_HANDLE_ROUTINE</a> DupHandleProcedure OPTIONAL)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a295">ExSnapShotHandleTables</a> (IN <a class="el" href="../../d5/d8/ex_8h.html#a142">PEX_SNAPSHOT_HANDLE_ENTRY</a> SnapShotHandleEntry, IN OUT PSYSTEM_HANDLE_INFORMATION HandleInformation, IN ULONG Length, IN OUT PULONG RequiredLength)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI HANDLE&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a296">ExCreateHandle</a> (IN <a class="el" href="../../d6/d3/struct__HANDLE__TABLE.html">PHANDLE_TABLE</a> HandleTable, IN <a class="el" href="../../d7/d3/struct__HANDLE__TABLE__ENTRY.html">PHANDLE_TABLE_ENTRY</a> HandleTableEntry)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a297">ExDestroyHandle</a> (IN <a class="el" href="../../d6/d3/struct__HANDLE__TABLE.html">PHANDLE_TABLE</a> HandleTable, IN HANDLE <a class="el" href="../../d5/d6/w98_2lh__open_2pi__basic_8h.html#a29">Handle</a>, IN <a class="el" href="../../d7/d3/struct__HANDLE__TABLE__ENTRY.html">PHANDLE_TABLE_ENTRY</a> HandleTableEntry OPTIONAL)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a298">ExChangeHandle</a> (IN <a class="el" href="../../d6/d3/struct__HANDLE__TABLE.html">PHANDLE_TABLE</a> HandleTable, IN HANDLE <a class="el" href="../../d5/d6/w98_2lh__open_2pi__basic_8h.html#a29">Handle</a>, IN <a class="el" href="../../d5/d8/ex_8h.html#a143">PEX_CHANGE_HANDLE_ROUTINE</a> ChangeRoutine, IN ULONG_PTR Parameter)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI <a class="el" href="../../d7/d3/struct__HANDLE__TABLE__ENTRY.html">PHANDLE_TABLE_ENTRY</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a299">ExMapHandleToPointer</a> (IN <a class="el" href="../../d6/d3/struct__HANDLE__TABLE.html">PHANDLE_TABLE</a> HandleTable, IN HANDLE <a class="el" href="../../d5/d6/w98_2lh__open_2pi__basic_8h.html#a29">Handle</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a300">ExLuidInitialization</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI <a class="el" href="../../d0/d9/ntosdef_8h.html#a39">KPROCESSOR_MODE</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a301">ExGetPreviousMode</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI VOID NTAPI&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a302">ExRaiseException</a> (PEXCEPTION_RECORD ExceptionRecord)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI VOID NTAPI&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a303">ExRaiseStatus</a> (IN NTSTATUS <a class="el" href="../../d2/d1/cttoken_8c.html#a18">Status</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a304">ExRaiseDatatypeMisalignment</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a305">ExRaiseAccessViolation</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a306">ExRaiseHardError</a> (IN NTSTATUS ErrorStatus, IN ULONG NumberOfParameters, IN ULONG UnicodeStringParameterMask, IN PULONG_PTR Parameters, IN ULONG ValidResponseOptions, OUT PULONG Response)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>int&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a307">ExSystemExceptionFilter</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI <a class="el" href="../../d4/d7/struct__EX__DEBUG__LOG.html">PEX_DEBUG_LOG</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a308">ExCreateDebugLog</a> (IN UCHAR MaximumNumberOfTags, IN ULONG MaximumNumberOfEvents)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI UCHAR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a309">ExCreateDebugLogTag</a> (IN <a class="el" href="../../d4/d7/struct__EX__DEBUG__LOG.html">PEX_DEBUG_LOG</a> Log, IN PCHAR <a class="el" href="../../d9/d3/rules_8c.html#a6">Name</a>, IN UCHAR Format1, IN UCHAR Format2, IN UCHAR Format3, IN UCHAR Format4)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a310">ExDebugLogEvent</a> (IN <a class="el" href="../../d4/d7/struct__EX__DEBUG__LOG.html">PEX_DEBUG_LOG</a> Log, IN UCHAR Tag, IN ULONG Data1, IN ULONG Data2, IN ULONG Data3, IN ULONG Data4)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a311">ExShutdownSystem</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a312">ExAcquireTimeRefreshLock</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a313">ExReleaseTimeRefreshLock</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a314">ExUpdateSystemTimeFromCmos</a> (IN BOOLEAN UpdateInterruptTime, IN ULONG MaxSepInSeconds)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a315">ExGetNextWakeTime</a> (OUT PULONGLONG DueTime, OUT PTIME_FIELDS <a class="el" href="../../d6/d6/ttime_8c.html#a13">TimeFields</a>, OUT PVOID *TimerObject)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a316">ExSetTimerResolution</a> (IN ULONG DesiredTime, IN BOOLEAN SetResolution)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a317">ExSystemTimeToLocalTime</a> (IN PLARGE_INTEGER SystemTime, OUT PLARGE_INTEGER LocalTime)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a318">ExLocalTimeToSystemTime</a> (IN PLARGE_INTEGER LocalTime, OUT PLARGE_INTEGER SystemTime)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a319">ExInitializeTimeRefresh</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a320">ExCreateCallback</a> (OUT <a class="el" href="../../d9/d6/struct__CALLBACK__OBJECT.html">PCALLBACK_OBJECT</a> *CallbackObject, IN POBJECT_ATTRIBUTES <a class="el" href="../../d8/d0/ctlpcqos_8c.html#a1">ObjectAttributes</a>, IN BOOLEAN Create, IN BOOLEAN AllowMultipleCallbacks)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI PVOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a321">ExRegisterCallback</a> (IN <a class="el" href="../../d9/d6/struct__CALLBACK__OBJECT.html">PCALLBACK_OBJECT</a> CallbackObject, IN <a class="el" href="../../d5/d8/ex_8h.html#a157">PCALLBACK_FUNCTION</a> CallbackFunction, IN PVOID CallbackContext)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a322">ExUnregisterCallback</a> (IN PVOID CallbackRegistration)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a323">ExNotifyCallback</a> (IN PVOID CallbackObject, IN PVOID Argument1, IN PVOID Argument2)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a324">ExUuidCreate</a> (OUT <a class="el" href="../../d5/d8/ex_8h.html#a172">UUID</a> *Uuid)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a325">ExVerifySuite</a> (SUITE_TYPE SuiteType)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI ULONG FASTCALL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a326">ExInterlockedSetBits</a> (IN OUT PULONG Flags, IN ULONG Flag)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI ULONG FASTCALL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a327">ExInterlockedClearBits</a> (IN OUT PULONG Flags, IN ULONG Flag)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTKERNELAPI ULONG FASTCALL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a328">ExInterlockedSetClearBits</a> (IN OUT PULONG Flags, IN ULONG sFlag, IN ULONG cFlag)</td></tr>

<tr><td colspan=2><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d8/d7/struct__EX__WORK__QUEUE.html">EX_WORK_QUEUE</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a116">ExWorkerQueue</a> []</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>LARGE_INTEGER&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a144">ExpLuid</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>LARGE_INTEGER&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a145">ExpLuidIncrement</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>KSPIN_LOCK&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a146">ExpLuidLock</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a147">ExReadyForErrors</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a148">EvPrSetHigh</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a149">EvPrSetLow</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>LARGE_INTEGER&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a158">ExpTimeZoneBias</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>LONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a159">ExpLastTimeZoneBias</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>LONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a160">ExpAltTimeZoneBias</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a161">ExpCurrentTimeZoneId</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a162">ExpRealTimeIsUniversal</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a163">ExCriticalWorkerThreads</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a164">ExDelayedWorkerThreads</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a165">ExpTickCountMultiplier</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>PVOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a166">ExPageLockHandle</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d9/d6/struct__CALLBACK__OBJECT.html">PCALLBACK_OBJECT</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a167">ExCbSetSystemTime</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d9/d6/struct__CALLBACK__OBJECT.html">PCALLBACK_OBJECT</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a168">ExCbSetSystemState</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d9/d6/struct__CALLBACK__OBJECT.html">PCALLBACK_OBJECT</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a169">ExCbPowerState</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d5/d8/ex_8h.html#a170">PKWIN32_GLOBALATOMTABLE_CALLOUT</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d8/ex_8h.html#a171">ExGlobalAtomTableCallout</a></td></tr>

</table>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="a0" doxytag="ex.h::CALL_HASH_TABLE_SIZE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define CALL_HASH_TABLE_SIZE&nbsp;&nbsp;&nbsp;64          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l00028">28</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.
<p>
Referenced by <a class="el" href="../../d0/d4/callperf_8c-source.html#l00028">ExInitializeCallData()</a>, and <a class="el" href="../../d0/d4/callperf_8c-source.html#l00065">ExRecordCallerInHashTable()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a87" doxytag="ex.h::EX_DEBUG_LOG_FORMAT_HANDLE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define EX_DEBUG_LOG_FORMAT_HANDLE&nbsp;&nbsp;&nbsp;(UCHAR)7          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l03125">3125</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a80" doxytag="ex.h::EX_DEBUG_LOG_FORMAT_NONE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define EX_DEBUG_LOG_FORMAT_NONE&nbsp;&nbsp;&nbsp;(UCHAR)0          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l03118">3118</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a86" doxytag="ex.h::EX_DEBUG_LOG_FORMAT_OBJECT" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define EX_DEBUG_LOG_FORMAT_OBJECT&nbsp;&nbsp;&nbsp;(UCHAR)6          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l03124">3124</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a82" doxytag="ex.h::EX_DEBUG_LOG_FORMAT_PSZ" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define EX_DEBUG_LOG_FORMAT_PSZ&nbsp;&nbsp;&nbsp;(UCHAR)2          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l03120">3120</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a83" doxytag="ex.h::EX_DEBUG_LOG_FORMAT_PWSZ" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define EX_DEBUG_LOG_FORMAT_PWSZ&nbsp;&nbsp;&nbsp;(UCHAR)3          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l03121">3121</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a84" doxytag="ex.h::EX_DEBUG_LOG_FORMAT_STRING" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define EX_DEBUG_LOG_FORMAT_STRING&nbsp;&nbsp;&nbsp;(UCHAR)4          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l03122">3122</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a81" doxytag="ex.h::EX_DEBUG_LOG_FORMAT_ULONG" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define EX_DEBUG_LOG_FORMAT_ULONG&nbsp;&nbsp;&nbsp;(UCHAR)1          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l03119">3119</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a85" doxytag="ex.h::EX_DEBUG_LOG_FORMAT_USTRING" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define EX_DEBUG_LOG_FORMAT_USTRING&nbsp;&nbsp;&nbsp;(UCHAR)5          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l03123">3123</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a89" doxytag="ex.h::EX_DEBUG_LOG_NUMBER_OF_BACK_TRACES" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define EX_DEBUG_LOG_NUMBER_OF_BACK_TRACES&nbsp;&nbsp;&nbsp;4          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l03128">3128</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a88" doxytag="ex.h::EX_DEBUG_LOG_NUMBER_OF_DATA_VALUES" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define EX_DEBUG_LOG_NUMBER_OF_DATA_VALUES&nbsp;&nbsp;&nbsp;4          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l03127">3127</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a70" doxytag="ex.h::ExAcquireResourceExclusive" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ExAcquireResourceExclusive&nbsp;&nbsp;&nbsp;ExAcquireResourceExclusiveLite          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l02475">2475</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.
<p>
Referenced by <a class="el" href="../../d7/d1/cachesub_8c-source.html#l02861">CcAcquireByteRangeForWrite()</a>, <a class="el" href="../../d7/d1/cachesub_8c-source.html#l00116">CcPinFileData()</a>, <a class="el" href="../../d7/d1/cachesub_8c-source.html#l05143">CcUnpinRepinnedBcb()</a>, <a class="el" href="../../d1/d2/cmsubs3_8c-source.html#l00081">CmpLockRegistryExclusive()</a>, <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l00146">ExLockHandleTableExclusive()</a>, <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l01475">ExpAllocateHandleTable()</a>, <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l00501">ExRemoveHandleTable()</a>, <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l00984">ExSnapShotHandleTables()</a>, <a class="el" href="../../d4/d0/fastio_8c-source.html#l02555">FsRtlAcquireFileExclusive()</a>, <a class="el" href="../../d4/d0/fastio_8c-source.html#l02402">FsRtlAcquireFileForCcFlush()</a>, <a class="el" href="../../d4/d0/fastio_8c-source.html#l02064">FsRtlAcquireFileForModWrite()</a>, <a class="el" href="../../d4/d0/fastio_8c-source.html#l00330">FsRtlCopyWrite()</a>, <a class="el" href="../../d4/d0/fastio_8c-source.html#l01474">FsRtlPrepareMdlWriteDev()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l04946">IoGetDeviceInterfaceAlias()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l00373">IoGetDeviceProperty()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l03624">IoOpenDeviceInterfaceRegistryKey()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l00810">IoOpenDeviceRegistryKey()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l09046">IopBootLog()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l09284">IopBootLogToFile()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l09157">IopCopyBootLogRegistryToFile()</a>, <a class="el" href="../../d4/d9/pnpdel_8c-source.html#l00232">IopDeleteLockedDeviceNode()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l03708">IopDeviceInterfaceKeysFromSymbolicLink()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l09866">IopDoDeferredSetInterfaceState()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l02707">IopGetDeviceInterfaces()</a>, <a class="el" href="../../d8/d9/pnpinit_8c-source.html#l00680">IopGetRootDevices()</a>, <a class="el" href="../../d4/d0/objsup_8c-source.html#l00975">IopGetSetSecurityObject()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l08928">IopInitializeBootLogging()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l03929">IopRegisterDeviceInterface()</a>, <a class="el" href="../../d4/d0/objsup_8c-source.html#l00877">IopSetDeviceSecurityDescriptors()</a>, <a class="el" href="../../d4/d9/pnpdel_8c-source.html#l01572">IopUnlockDeviceRemovalRelations()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l04140">IopUnregisterDeviceInterface()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l09324">IoRegisterFileSystem()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l09422">IoRegisterFsRegistrationChange()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l03563">IoSetDeviceInterfaceState()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l11106">IoUnregisterFileSystem()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l11178">IoUnregisterFsRegistrationChange()</a>, <a class="el" href="../../d6/d0/mminit_8c-source.html#l02735">MiEnablePagingTheExecutive()</a>, <a class="el" href="../../d6/d0/mminit_8c-source.html#l02474">MiFindInitializationCode()</a>, <a class="el" href="../../d9/d7/sysload_8c-source.html#l00443">MiLoadSystemImage()</a>, <a class="el" href="../../d5/d6/sessload_8c-source.html#l01273">MiLookupPsLoadedModule()</a>, <a class="el" href="../../d4/d4/mapview_8c-source.html#l01567">MiMapViewOfImageSection()</a>, <a class="el" href="../../d9/d9/extsect_8c-source.html#l00201">MmExtendSection()</a>, <a class="el" href="../../d6/d0/mminit_8c-source.html#l00184">MmInitSystem()</a>, <a class="el" href="../../d9/d7/sysload_8c-source.html#l02896">MmUnloadSystemImage()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l00266">NtAssignProcessToJobObject()</a>, <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l00941">NtQuerySystemInformation()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l01323">NtSetInformationJobObject()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l02358">NtTerminateJobObject()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l07905">NtUserUserHandleGrantAccess()</a>, <a class="el" href="../../d9/d0/obsdata_8c-source.html#l00886">ObpAcquireDescriptorCacheWriteLock()</a>, <a class="el" href="../../d4/d1/i386_2psvdm_8c-source.html#l00869">Ps386GetVdmIoHandler()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l02396">PsEnforceExecutionTimeLimits()</a>, <a class="el" href="../../d4/d1/i386_2psvdm_8c-source.html#l00730">Psp386CreateVdmIoListHead()</a>, <a class="el" href="../../d4/d1/i386_2psvdm_8c-source.html#l00477">Psp386InstallIoHandler()</a>, <a class="el" href="../../d4/d1/i386_2psvdm_8c-source.html#l00280">Psp386RemoveIoHandler()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l00439">PspAddProcessToJob()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l00608">PspExitProcessFromJob()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l00709">PspJobClose()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l00636">PspJobDelete()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l00579">PspRemoveProcessFromJob()</a>, <a class="el" href="../../d5/d8/smbtrsup_8c-source.html#l00551">SmbTraceStart()</a>, <a class="el" href="../../d5/d8/smbtrsup_8c-source.html#l01050">SmbTraceStop()</a>, <a class="el" href="../../d5/d8/resrcsup_8c-source.html#l00267">UdfAcquireForCreateSection()</a>, <a class="el" href="../../d5/d8/resrcsup_8c-source.html#l00047">UdfAcquireResource()</a>, <a class="el" href="../../d5/d9/tex_8c-source.html#l01606">Writer()</a>, and <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l02882">xxxUserProcessCallout()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a69" doxytag="ex.h::ExAcquireResourceShared" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ExAcquireResourceShared&nbsp;&nbsp;&nbsp;ExAcquireResourceSharedLite          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l02474">2474</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.
<p>
Referenced by <a class="el" href="../../d1/d2/cmsubs3_8c-source.html#l00044">CmpLockRegistry()</a>, <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l00114">ExLockHandleTableShared()</a>, <a class="el" href="../../d4/d0/fastio_8c-source.html#l02402">FsRtlAcquireFileForCcFlush()</a>, <a class="el" href="../../d4/d0/fastio_8c-source.html#l00054">FsRtlCopyRead()</a>, <a class="el" href="../../d4/d0/fastio_8c-source.html#l00330">FsRtlCopyWrite()</a>, <a class="el" href="../../d4/d0/fastio_8c-source.html#l01064">FsRtlMdlReadDev()</a>, <a class="el" href="../../d4/d0/fastio_8c-source.html#l01474">FsRtlPrepareMdlWriteDev()</a>, <a class="el" href="../../d0/d1/pnpsubs_8c-source.html#l00091">IopCreateMadeupNode()</a>, <a class="el" href="../../d0/d1/pnpsubs_8c-source.html#l05453">IopDeleteLegacyKey()</a>, <a class="el" href="../../d7/d9/pnpenum_8c-source.html#l00307">IopDeviceActionWorker()</a>, <a class="el" href="../../d0/d1/pnpsubs_8c-source.html#l02779">IopDriverLoadingFailed()</a>, <a class="el" href="../../d3/d9/pnpdd_8c-source.html#l01411">IopGetDriverDeviceList()</a>, <a class="el" href="../../d4/d0/objsup_8c-source.html#l00975">IopGetSetSecurityObject()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l08928">IopInitializeBootLogging()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l04710">IopInvalidateVolumesForDevice()</a>, <a class="el" href="../../d3/d9/pnpdd_8c-source.html#l02009">IopIsFirmwareDisabled()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l03200">IopLoadDriver()</a>, <a class="el" href="../../d1/d0/pnpirp_8c-source.html#l01891">IopMakeGloballyUniqueId()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l04282">IopMountVolume()</a>, <a class="el" href="../../d5/d2/parse_8c-source.html#l00202">IopParseDevice()</a>, <a class="el" href="../../d0/d1/pnpsubs_8c-source.html#l00753">IopPrepareDriverLoading()</a>, <a class="el" href="../../d3/d9/pnpdd_8c-source.html#l01185">IopProcessAssignResources()</a>, <a class="el" href="../../d7/d9/pnpenum_8c-source.html#l01538">IopProcessNewDeviceNode()</a>, <a class="el" href="../../d7/d9/pnpenum_8c-source.html#l00821">IopProcessStartDevices()</a>, <a class="el" href="../../d7/d9/pnpenum_8c-source.html#l00912">IopProcessStartDevicesWorker()</a>, <a class="el" href="../../d6/d0/pnpres_8c-source.html#l07470">IopReallocateResources()</a>, <a class="el" href="../../d3/d9/pnpdd_8c-source.html#l00263">IopReleaseDeviceResources()</a>, <a class="el" href="../../d7/d9/pnpenum_8c-source.html#l00994">IopStartAndEnumerateDevice()</a>, <a class="el" href="../../d3/d9/pnpdd_8c-source.html#l01931">IopWriteAllocatedResourcesToRegistry()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l01548">IoReportDetectedDevice()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l10359">IoShutdownSystem()</a>, <a class="el" href="../../d6/d5/iosup_8c-source.html#l06991">MiLookupDataTableEntry()</a>, <a class="el" href="../../d6/d5/iosup_8c-source.html#l06797">MmGetSectionRange()</a>, <a class="el" href="../../d9/d7/sysload_8c-source.html#l06808">MmGetSystemRoutineAddress()</a>, <a class="el" href="../../d6/d5/iosup_8c-source.html#l06864">MmLockPagableDataSection()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l00814">NtQueryInformationJobObject()</a>, <a class="el" href="../../d0/d1/psquery_8c-source.html#l01510">NtSetInformationProcess()</a>, <a class="el" href="../../d9/d0/obsdata_8c-source.html#l00914">ObpAcquireDescriptorCacheReadLock()</a>, <a class="el" href="../../d0/d1/psquery_8c-source.html#l01211">PspSetQuotaLimits()</a>, <a class="el" href="../../d5/d9/tex_8c-source.html#l01567">Reader()</a>, <a class="el" href="../../d5/d9/tex_8c-source.html#l01646">ReaderTurnedWriter()</a>, <a class="el" href="../../d5/d8/resrcsup_8c-source.html#l00136">UdfAcquireForCache()</a>, <a class="el" href="../../d5/d8/resrcsup_8c-source.html#l00047">UdfAcquireResource()</a>, <a class="el" href="../../d5/d2/fileinfo_8c-source.html#l00496">UdfFastQueryBasicInfo()</a>, <a class="el" href="../../d5/d2/fileinfo_8c-source.html#l00740">UdfFastQueryNetworkInfo()</a>, and <a class="el" href="../../d5/d2/fileinfo_8c-source.html#l00614">UdfFastQueryStdInfo()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a56" doxytag="ex.h::ExAllocateFromZone" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ExAllocateFromZone          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">Zone&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div>(PVOID)((Zone)-&gt;FreeList.Next); \
    <span class="keywordflow">if</span> ( (Zone)-&gt;FreeList.Next ) (Zone)-&gt;FreeList.Next = (Zone)-&gt;FreeList.Next-&gt;Next
</div></pre>
<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l02100">2100</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.
<p>
Referenced by <a class="el" href="../../d7/d1/cachesub_8c-source.html#l05541">CcAllocateInitializeBcb()</a>, <a class="el" href="../../d5/d9/tex_8c-source.html#l01510">DoZoneTest()</a>, and <a class="el" href="../../d4/d6/lpcqueue_8c-source.html#l00558">LpcpAllocateFromPortZone()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a79" doxytag="ex.h::ExAllocateLocallyUniqueId" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ExAllocateLocallyUniqueId          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">Luid&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div>{                                                                   \
    LARGE_INTEGER _TempLi;                                              \
                                                                        \
    _TempLi = ExInterlockedExchangeAddLargeInteger(&amp;ExpLuid,            \
                                                   ExpLuidIncrement,    \
                                                   &amp;ExpLuidLock);       \
    (Luid)-&gt;LowPart = _TempLi.LowPart;                                  \
    (Luid)-&gt;HighPart = _TempLi.HighPart;                                \
    }
</div></pre>
<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l03024">3024</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.
<p>
Referenced by <a class="el" href="../../d1/d7/luid_8c-source.html#l00081">NtAllocateLocallyUniqueId()</a>, <a class="el" href="../../d3/d4/seastate_8c-source.html#l00180">SeCreateAccessState()</a>, <a class="el" href="../../d4/d4/seaudit_8c-source.html#l01050">SepAccessCheckAndAuditAlarm()</a>, <a class="el" href="../../d5/d2/token_8c-source.html#l02213">SepCreateToken()</a>, <a class="el" href="../../d7/d2/tokendup_8c-source.html#l00362">SepDuplicateToken()</a>, and <a class="el" href="../../d7/d2/tokendup_8c-source.html#l01939">SepFilterToken()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a5" doxytag="ex.h::ExAllocatePoolWithQuotaTag" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ExAllocatePoolWithQuotaTag          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">a,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>b,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d7/d1/genuedef_8c.html#a8">c</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;ExAllocatePoolWithQuota(a,b)</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l00265">265</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.
<p>
Referenced by <a class="el" href="../../d1/d1/cmnotify_8c-source.html#l01378">CmpNotifyChangeKey()</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l02550">ExAllocatePoolWithQuota()</a>, <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l02995">ExLockUserBuffer()</a>, <a class="el" href="../../d8/d2/fsrtl_2filter_8c-source.html#l00169">FsRtlAllocatePoolWithQuota()</a>, <a class="el" href="../../d8/d2/fsrtl_2filter_8c-source.html#l00260">FsRtlAllocatePoolWithQuotaTag()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l04502">IoCreateFile()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l00662">IopAllocateIrpPrivate()</a>, <a class="el" href="../../d6/d3/complete_8c-source.html#l00671">IoSetIoCompletion()</a>, <a class="el" href="../../d3/d9/psctx_8c-source.html#l00056">NtQueueApcThread()</a>, <a class="el" href="../../d8/d6/ntapi_8c-source.html#l02672">NtSetValueKey()</a>, <a class="el" href="../../d4/d3/vdm_2vdm_8c-source.html#l00087">VdmQueryDirectoryFile()</a>, and <a class="el" href="../../d0/d5/verifier_8c-source.html#l01059">VerifierAllocatePoolWithQuotaTag()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a4" doxytag="ex.h::ExAllocatePoolWithTag" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ExAllocatePoolWithTag          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">a,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>b,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d7/d1/genuedef_8c.html#a8">c</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;ExAllocatePool(a,b)</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l00253">253</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.
<p>
Referenced by <a class="el" href="../../d9/d7/arbiter_8c-source.html#l03028">ArbAddOrdering()</a>, <a class="el" href="../../d9/d7/arbiter_8c-source.html#l02971">ArbCopyOrderingList()</a>, <a class="el" href="../../d9/d7/arbiter_8c-source.html#l00192">ArbInitializeArbiterInstance()</a>, <a class="el" href="../../d9/d7/arbiter_8c-source.html#l02927">ArbInitializeOrderingList()</a>, <a class="el" href="../../d9/d7/arbiter_8c-source.html#l00786">ArbpBuildAllocationStack()</a>, <a class="el" href="../../d9/d7/arbiter_8c-source.html#l02824">ArbpGetRegistryValue()</a>, <a class="el" href="../../d9/d7/arbiter_8c-source.html#l03120">ArbPruneOrdering()</a>, <a class="el" href="../../d9/d7/arbiter_8c-source.html#l03695">ArbQueryConflict()</a>, <a class="el" href="../../d7/d1/cachesub_8c-source.html#l05541">CcAllocateInitializeBcb()</a>, <a class="el" href="../../d6/d2/vacbsup_8c-source.html#l01208">CcCreateVacbArray()</a>, <a class="el" href="../../d6/d6/copysup_8c-source.html#l01982">CcDeferWrite()</a>, <a class="el" href="../../d7/d1/cachesub_8c-source.html#l01996">CcFindBitmapRangeToDirty()</a>, <a class="el" href="../../d6/d7/fssup_8c-source.html#l00069">CcInitializeCacheManager()</a>, <a class="el" href="../../d6/d7/fssup_8c-source.html#l00387">CcInitializeCacheMap()</a>, <a class="el" href="../../d6/d2/vacbsup_8c-source.html#l01931">CcPrefillVacbLevelZone()</a>, <a class="el" href="../../d6/d2/vacbsup_8c-source.html#l01062">CcWaitOnActiveCount()</a>, <a class="el" href="../../d7/d1/cachesub_8c-source.html#l03880">CcWriteBehind()</a>, <a class="el" href="../../d6/d7/fssup_8c-source.html#l02952">CcZeroData()</a>, <a class="el" href="../../d2/d2/cmsysini_8c-source.html#l00293">CmInitSystem1()</a>, <a class="el" href="../../d3/d1/cmparse_8c-source.html#l02056">CmpAddInfoAfterParseFailure()</a>, <a class="el" href="../../d8/d2/cmwrapr_8c-source.html#l00062">CmpAllocate()</a>, <a class="el" href="../../d6/d2/parseini_8c-source.html#l00383">CmpAppendLine()</a>, <a class="el" href="../../d6/d2/parseini_8c-source.html#l00219">CmpAppendSection()</a>, <a class="el" href="../../d9/d9/geninst_8c-source.html#l01392">CmpAppendStringToMultiSz()</a>, <a class="el" href="../../d6/d2/parseini_8c-source.html#l00462">CmpAppendValue()</a>, <a class="el" href="../../d9/d1/cmsubs_8c-source.html#l00699">CmpConstructName()</a>, <a class="el" href="../../d9/d1/cmsubs_8c-source.html#l00824">CmpCreateKeyControlBlock()</a>, <a class="el" href="../../d0/d3/rules_8c-source.html#l02430">CmpFindRSDTTable()</a>, <a class="el" href="../../d9/d9/geninst_8c-source.html#l00987">CmpGetAddRegInfData()</a>, <a class="el" href="../../d9/d1/cmsubs_8c-source.html#l00368">CmpGetNameControlBlock()</a>, <a class="el" href="../../d0/d3/rules_8c-source.html#l02635">CmpGetRegistryValue()</a>, <a class="el" href="../../d6/d2/parseini_8c-source.html#l00537">CmpGetToken()</a>, <a class="el" href="../../d0/d2/cmsubs2_8c-source.html#l00403">CmpGetValueDataFromCache()</a>, <a class="el" href="../../d5/d2/cmtree_8c-source.html#l00200">CmpGetValueKeyFromCache()</a>, <a class="el" href="../../d5/d2/cmtree_8c-source.html#l00115">CmpGetValueListFromCache()</a>, <a class="el" href="../../d9/d1/cmsubs_8c-source.html#l01512">CmpInitializeCache()</a>, <a class="el" href="../../d9/d0/cminit_8c-source.html#l00471">CmpInitializeHive()</a>, <a class="el" href="../../d9/d9/geninst_8c-source.html#l01264">CmpOpenRegKey()</a>, <a class="el" href="../../d6/d2/parseini_8c-source.html#l00744">CmpParseInfBuffer()</a>, <a class="el" href="../../d9/d9/geninst_8c-source.html#l00776">CmpProcessBitRegLine()</a>, <a class="el" href="../../d9/d8/cmapi_8c-source.html#l01383">CmpSetValueKeyExisting()</a>, <a class="el" href="../../d7/d6/fs__rec_8c-source.html#l00067">DriverEntry()</a>, <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l00762">ExAcquireResourceSharedLite()</a>, <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l01014">ExAcquireSharedStarveExclusive()</a>, <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l01165">ExAcquireSharedWaitForExclusive()</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00910">ExAllocatePool()</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l02607">ExAllocatePoolWithQuotaTag()</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00993">ExAllocatePoolWithTagPriority()</a>, <a class="el" href="../../d5/d4/logger_8c-source.html#l00030">ExCreateDebugLog()</a>, <a class="el" href="../../d5/d4/logger_8c-source.html#l00062">ExCreateDebugLogTag()</a>, <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l02005">ExDeleteResourceLite()</a>, <a class="el" href="../../d0/d5/ex_2lookasid_8c-source.html#l00408">ExInitializeNPagedLookasideList()</a>, <a class="el" href="../../d0/d5/ex_2lookasid_8c-source.html#l00543">ExInitializePagedLookasideList()</a>, <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l00410">ExpAcquireResourceExclusiveLite()</a>, <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l01475">ExpAllocateHandleTable()</a>, <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l01825">ExpAllocateHandleTableEntry()</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00389">ExpAllocateStringRoutine()</a>, <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l02683">ExpFindCurrentThread()</a>, <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l04104">ExpGetPoolTagInfo()</a>, <a class="el" href="../../d7/d7/ex_2harderr_8c-source.html#l00064">ExpSystemErrorHandler()</a>, <a class="el" href="../../d0/d4/callperf_8c-source.html#l00065">ExRecordCallerInHashTable()</a>, <a class="el" href="../../d3/d3/ex_2callback_8c-source.html#l00378">ExRegisterCallback()</a>, <a class="el" href="../../d7/d6/fs__rec_8c-source.html#l00907">FsRecReadBlock()</a>, <a class="el" href="../../d2/d6/tunnel_8c-source.html#l00584">FsRtlAddToTunnelCache()</a>, <a class="el" href="../../d8/d2/fsrtl_2filter_8c-source.html#l00124">FsRtlAllocatePool()</a>, <a class="el" href="../../d8/d2/fsrtl_2filter_8c-source.html#l00214">FsRtlAllocatePoolWithTag()</a>, <a class="el" href="../../d5/d7/fsrtlpc_8c-source.html#l00323">FsRtlGetCompatibilityModeValue()</a>, <a class="el" href="../../d2/d6/tunnel_8c-source.html#l01371">FsRtlGetTunnelParameterValue()</a>, <a class="el" href="../../d6/d8/unc_8c-source.html#l00104">FsRtlpRegisterProviderWithMUP()</a>, <a class="el" href="../../d6/d8/unc_8c-source.html#l00247">FsRtlRegisterUncProvider()</a>, <a class="el" href="../../d2/d4/translate_8c-source.html#l00291">FstubTranslateRequirement()</a>, <a class="el" href="../../d8/d1/drivesup_8c-source.html#l03735">HalpGetFullGeometry()</a>, <a class="el" href="../../d8/d1/drivesup_8c-source.html#l00851">HalpNextMountLetter()</a>, <a class="el" href="../../d8/d1/drivesup_8c-source.html#l01078">HalpSetMountLetter()</a>, <a class="el" href="../../d8/d9/hivebin_8c-source.html#l00046">HvpAddBin()</a>, <a class="el" href="../../d7/d0/hiveload_8c-source.html#l00847">HvpRecoverData()</a>, <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l01322">InitCreateUserCrit()</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00677">InitializePool()</a>, <a class="el" href="../../d8/d6/io_2remlock_8c-source.html#l00114">IoAcquireRemoveLockEx()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l00328">IoAllocateDriverObjectExtension()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l00805">IoAllocateMdl()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l01360">IoBuildAsynchronousFsdRequest()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l01552">IoBuildDeviceIoControlRequest()</a>, <a class="el" href="../../d5/d0/pnppower_8c-source.html#l00048">IoBuildPoDeviceNotifyList()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l03665">IoConnectInterrupt()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l04502">IoCreateFile()</a>, <a class="el" href="../../d8/d4/ioerr_8c-source.html#l00612">IoepFireWMIEvent()</a>, <a class="el" href="../../d8/d4/ioerr_8c-source.html#l01200">IoepGetErrCaseDB()</a>, <a class="el" href="../../d8/d4/ioerr_8c-source.html#l00936">IoepGetErrMessage()</a>, <a class="el" href="../../d8/d4/ioerr_8c-source.html#l00680">IoepHandleErrCase()</a>, <a class="el" href="../../d8/d4/ioerr_8c-source.html#l00039">IoepInitErrLog()</a>, <a class="el" href="../../d8/d4/ioerr_8c-source.html#l00255">IoepLogErr()</a>, <a class="el" href="../../d8/d4/ioerr_8c-source.html#l00186">IoepNewErrThread()</a>, <a class="el" href="../../d5/d4/ioeapi_8c-source.html#l00452">IoErrGetErrData()</a>, <a class="el" href="../../d5/d4/ioeapi_8c-source.html#l00383">IoErrRegisterErrHandlers()</a>, <a class="el" href="../../d5/d4/ioeapi_8c-source.html#l00538">IoErrSaveErrData()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l07543">IoInitializeTimer()</a>, <a class="el" href="../../d0/d5/ioinit_8c-source.html#l00270">IoInitSystem()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l07705">IoIsValidNameGraftingBuffer()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l08338">IoMakeAssociatedIrp()</a>, <a class="el" href="../../d5/d6/devnode_8c-source.html#l00056">IopAllocateDeviceNode()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l00542">IopAllocateErrorLogEntry()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l00336">IopAllocateIrpMustSucceed()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l00662">IopAllocateIrpPrivate()</a>, <a class="el" href="../../d5/d0/pnppower_8c-source.html#l00386">IopCaptureObjectName()</a>, <a class="el" href="../../d3/d2/dumpctl_8c-source.html#l04746">IopConfigureCrashDump()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l12098">IopCreateDefaultDeviceSecurityDescriptor()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l04053">IopCreateVpb()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l06037">IopDeleteSessionSymLinks()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l08130">IopDoNameTransmogrify()</a>, <a class="el" href="../../d3/d2/dumpctl_8c-source.html#l00384">IopGetDumpStack()</a>, <a class="el" href="../../d3/d2/dumpctl_8c-source.html#l04580">IopInitializeDCB()</a>, <a class="el" href="../../d3/d2/dumpctl_8c-source.html#l00954">IopLoadDumpDriver()</a>, <a class="el" href="../../d5/d2/parse_8c-source.html#l00202">IopParseDevice()</a>, <a class="el" href="../../d5/d2/parse_8c-source.html#l01811">IopQueryName()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l06672">IopRequestHwProfileChangeNotification()</a>, <a class="el" href="../../d5/d5/netboot_8c-source.html#l04017">IopSetDefaultGateway()</a>, <a class="el" href="../../d5/d5/netboot_8c-source.html#l00770">IopStartNetworkForRemoteBoot()</a>, <a class="el" href="../../d5/d5/netboot_8c-source.html#l04458">IopTCPSetInformationEx()</a>, <a class="el" href="../../d3/d2/io_2query_8c-source.html#l00070">IoQueryDeviceDescription()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l08769">IoRaiseHardError()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l08909">IoRaiseInformationalHardError()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l09200">IoRegisterBootDriverReinitialization()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l09262">IoRegisterDriverReinitialization()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l09422">IoRegisterFsRegistrationChange()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l09487">IoRegisterLastChanceShutdownNotification()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l09550">IoRegisterShutdownNotification()</a>, <a class="el" href="../../d6/d3/complete_8c-source.html#l00671">IoSetIoCompletion()</a>, <a class="el" href="../../d9/d3/trackirp_8c-source.html#l01693">IovpCompleteRequest3()</a>, <a class="el" href="../../d6/d6/sessnirp_8c-source.html#l00027">IovpSessionDataCreate()</a>, <a class="el" href="../../d9/d7/hashirp_8c-source.html#l00122">IovpTrackingDataCreateAndLock()</a>, <a class="el" href="../../d4/d0/biosc_8c-source.html#l00060">Ke386CallBios()</a>, <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00170">KeI386GetLid()</a>, <a class="el" href="../../d3/d9/ke_2i386_2misc_8c-source.html#l00133">KeSaveFloatingPointState()</a>, <a class="el" href="../../d6/d5/i386_2allproc_8c-source.html#l00075">KeStartAllProcessors()</a>, <a class="el" href="../../d1/d7/profobj_8c-source.html#l00289">KeStartProfile()</a>, <a class="el" href="../../d9/d3/mtrr_8c-source.html#l00992">KiAddRange()</a>, <a class="el" href="../../d6/d5/i386_2allproc_8c-source.html#l00375">KiCloneDescriptor()</a>, <a class="el" href="../../d7/d8/kernlini_8c-source.html#l00246">KiInitializeKernel()</a>, <a class="el" href="../../d9/d3/mtrr_8c-source.html#l00275">KiInitializeMTRR()</a>, <a class="el" href="../../d9/d3/mtrr_8c-source.html#l01060">KiStartEffectiveRangeChange()</a>, <a class="el" href="../../d9/d6/lfs_2strucsup_8c-source.html#l00315">LfsAllocateLbcb()</a>, <a class="el" href="../../d9/d6/lfs_2strucsup_8c-source.html#l00463">LfsAllocateLcb()</a>, <a class="el" href="../../d9/d6/lfs_2strucsup_8c-source.html#l00041">LfsAllocateLfcb()</a>, <a class="el" href="../../d4/d6/lpcqueue_8c-source.html#l00397">LpcpExtendPortZone()</a>, <a class="el" href="../../d4/d6/lpcqueue_8c-source.html#l00037">LpcpInitializePortQueue()</a>, <a class="el" href="../../d4/d6/lpcqueue_8c-source.html#l00287">LpcpInitializePortZone()</a>, <a class="el" href="../../d6/d5/memprint_8c-source.html#l00124">MemPrintInitialize()</a>, <a class="el" href="../../d6/d5/iosup_8c-source.html#l00879">MiAddMdlTracker()</a>, <a class="el" href="../../d6/d5/iosup_8c-source.html#l04107">MiAllocateContiguousMemory()</a>, <a class="el" href="../../d5/d4/procsup_8c-source.html#l05659">MiAllocateVad()</a>, <a class="el" href="../../d0/d5/verifier_8c-source.html#l03448">MiApplyDriverVerifier()</a>, <a class="el" href="../../d9/d7/sysload_8c-source.html#l03326">MiBuildImportsForBootDrivers()</a>, <a class="el" href="../../d9/d5/forksup_8c-source.html#l00100">MiCloneProcessAddressSpace()</a>, <a class="el" href="../../d7/d2/modwrite_8c-source.html#l01864">MiContractPagingFiles()</a>, <a class="el" href="../../d1/d7/creasect_8c-source.html#l03553">MiCreateDataFileMap()</a>, <a class="el" href="../../d1/d7/creasect_8c-source.html#l01424">MiCreateImageFileMap()</a>, <a class="el" href="../../d1/d7/creasect_8c-source.html#l04018">MiCreatePagingFileMap()</a>, <a class="el" href="../../d5/d4/procsup_8c-source.html#l04202">MiCreatePebOrTeb()</a>, <a class="el" href="../../d0/d5/readwrt_8c-source.html#l00758">MiDoPoolCopy()</a>, <a class="el" href="../../d6/d4/sectsup_8c-source.html#l02377">MiGetEventCounter()</a>, <a class="el" href="../../d9/d1/pagfault_8c-source.html#l04152">MiGetInPageSupportBlock()</a>, <a class="el" href="../../d6/d2/queryvm_8c-source.html#l00890">MiGetWorkingSetInfo()</a>, <a class="el" href="../../d0/d5/verifier_8c-source.html#l03121">MiInitializeDriverVerifierList()</a>, <a class="el" href="../../d9/d7/sysload_8c-source.html#l06591">MiInitializeLoadedModuleList()</a>, <a class="el" href="../../d4/d4/mapview_8c-source.html#l03967">MiInitializeSystemSpaceMap()</a>, <a class="el" href="../../d3/d0/inialpha_8c-source.html#l00041">MiInitMachineDependent()</a>, <a class="el" href="../../d4/d4/mapview_8c-source.html#l03757">MiInsertInSystemSpace()</a>, <a class="el" href="../../d9/d7/sysload_8c-source.html#l00443">MiLoadSystemImage()</a>, <a class="el" href="../../d6/d5/iosup_8c-source.html#l02785">MiMapLockedPagesInUserSpace()</a>, <a class="el" href="../../d4/d4/mapview_8c-source.html#l02256">MiMapViewOfDataSection()</a>, <a class="el" href="../../d4/d4/mapview_8c-source.html#l01567">MiMapViewOfImageSection()</a>, <a class="el" href="../../d4/d4/mapview_8c-source.html#l01028">MiMapViewOfPhysicalSection()</a>, <a class="el" href="../../d7/d2/modwrite_8c-source.html#l02669">MiModifiedPageWriter()</a>, <a class="el" href="../../d9/d7/sysload_8c-source.html#l02740">MiRememberUnloadedDriver()</a>, <a class="el" href="../../d9/d7/sysload_8c-source.html#l03953">MiResolveImageReferences()</a>, <a class="el" href="../../d6/d4/sectsup_8c-source.html#l00768">MiSectionInitialization()</a>, <a class="el" href="../../d5/d6/sessload_8c-source.html#l00381">MiSessionInsertImage()</a>, <a class="el" href="../../d5/d6/sessload_8c-source.html#l00683">MiSessionWideInsertImageAddress()</a>, <a class="el" href="../../d9/d7/sysload_8c-source.html#l04464">MiSnapThunk()</a>, <a class="el" href="../../d0/d3/dynmem_8c-source.html#l00043">MmAddPhysicalMemory()</a>, <a class="el" href="../../d0/d5/verifier_8c-source.html#l03846">MmAddVerifierThunks()</a>, <a class="el" href="../../d6/d5/iosup_8c-source.html#l04270">MmAllocatePagesForMdl()</a>, <a class="el" href="../../d9/d7/sysload_8c-source.html#l06717">MmCallDllInitialize()</a>, <a class="el" href="../../d6/d5/iosup_8c-source.html#l05852">MmCreateMdl()</a>, <a class="el" href="../../d1/d7/creasect_8c-source.html#l00390">MmCreateSection()</a>, <a class="el" href="../../d9/d9/extsect_8c-source.html#l00201">MmExtendSection()</a>, <a class="el" href="../../d6/d4/sectsup_8c-source.html#l01721">MmGetFileNameForSection()</a>, <a class="el" href="../../d0/d3/dynmem_8c-source.html#l01032">MmGetPhysicalMemoryRanges()</a>, <a class="el" href="../../d5/d4/procsup_8c-source.html#l00911">MmInitializeProcessAddressSpace()</a>, <a class="el" href="../../d6/d0/mminit_8c-source.html#l00184">MmInitSystem()</a>, <a class="el" href="../../d6/d5/iosup_8c-source.html#l03415">MmMapIoSpace()</a>, <a class="el" href="../../d6/d5/iosup_8c-source.html#l02058">MmMapLockedPagesSpecifyCache()</a>, <a class="el" href="../../d6/d5/iosup_8c-source.html#l07516">MmMapVideoDisplay()</a>, <a class="el" href="../../d0/d3/dynmem_8c-source.html#l00437">MmRemovePhysicalMemory()</a>, <a class="el" href="../../d4/d4/mapview_8c-source.html#l04177">MmSecureVirtualMemory()</a>, <a class="el" href="../../d6/d5/iosup_8c-source.html#l07311">MmSetBankedSection()</a>, <a class="el" href="../../d7/d7/exatom_8c-source.html#l00045">NtAddAtom()</a>, <a class="el" href="../../d9/d4/physical_8c-source.html#l00970">NtAllocateUserPhysicalPages()</a>, <a class="el" href="../../d4/d5/allocvm_8c-source.html#l00075">NtAllocateVirtualMemory()</a>, <a class="el" href="../../d4/d4/seaudit_8c-source.html#l02492">NtCloseObjectAuditAlarm()</a>, <a class="el" href="../../d7/d2/modwrite_8c-source.html#l00297">NtCreatePagingFile()</a>, <a class="el" href="../../d5/d0/oblink_8c-source.html#l00052">NtCreateSymbolicLinkObject()</a>, <a class="el" href="../../d4/d4/seaudit_8c-source.html#l02627">NtDeleteObjectAuditAlarm()</a>, <a class="el" href="../../d7/d7/exatom_8c-source.html#l00152">NtFindAtom()</a>, <a class="el" href="../../d4/d6/freevm_8c-source.html#l00066">NtFreeVirtualMemory()</a>, <a class="el" href="../../d9/d4/physical_8c-source.html#l00085">NtMapUserPhysicalPages()</a>, <a class="el" href="../../d9/d4/physical_8c-source.html#l00498">NtMapUserPhysicalPagesScatter()</a>, <a class="el" href="../../d4/d4/seaudit_8c-source.html#l02072">NtOpenObjectAuditAlarm()</a>, <a class="el" href="../../d4/d4/seaudit_8c-source.html#l00731">NtPrivilegedServiceAuditAlarm()</a>, <a class="el" href="../../d4/d4/seaudit_8c-source.html#l00406">NtPrivilegeObjectAuditAlarm()</a>, <a class="el" href="../../d9/d9/obdir_8c-source.html#l00229">NtQueryDirectoryObject()</a>, <a class="el" href="../../d6/d7/sysenv_8c-source.html#l00045">NtQuerySystemEnvironmentValue()</a>, <a class="el" href="../../d7/d7/ex_2harderr_8c-source.html#l00532">NtRaiseHardError()</a>, <a class="el" href="../../d0/d2/qsinfo_8c-source.html#l00849">NtSetInformationFile()</a>, <a class="el" href="../../d6/d7/sysenv_8c-source.html#l00305">NtSetSystemEnvironmentValue()</a>, <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l02264">NtSetSystemInformation()</a>, <a class="el" href="../../d0/d6/ex_2profile_8c-source.html#l00517">NtStartProfile()</a>, <a class="el" href="../../d2/d1/obwait_8c-source.html#l00406">NtWaitForMultipleObjects()</a>, <a class="el" href="../../d1/d1/obtype_8c-source.html#l00069">ObCreateObjectType()</a>, <a class="el" href="../../d0/d1/obse_8c-source.html#l01258">ObGetObjectSecurity()</a>, <a class="el" href="../../d1/d0/obinit_8c-source.html#l00117">ObInitSystem()</a>, <a class="el" href="../../d7/d9/obcreate_8c-source.html#l00761">ObpAllocateObject()</a>, <a class="el" href="../../d7/d9/obcreate_8c-source.html#l00583">ObpAllocateObjectNameBuffer()</a>, <a class="el" href="../../d9/d0/obsdata_8c-source.html#l00491">ObpCreateCacheEntry()</a>, <a class="el" href="../../d1/d1/obtype_8c-source.html#l00607">ObpCreateTypeArray()</a>, <a class="el" href="../../d9/d0/obsdata_8c-source.html#l00118">ObpInitSecurityDescriptorCache()</a>, <a class="el" href="../../d9/d9/obdir_8c-source.html#l00903">ObpInsertDirectoryEntry()</a>, <a class="el" href="../../d0/d0/obhandle_8c-source.html#l00908">ObpInsertHandleCount()</a>, <a class="el" href="../../d9/d9/obdir_8c-source.html#l01081">ObpLookupObjectName()</a>, <a class="el" href="../../d5/d0/oblink_8c-source.html#l00501">ObpParseSymbolicLink()</a>, <a class="el" href="../../d8/d9/obdevmap_8c-source.html#l00030">ObSetDeviceMap()</a>, <a class="el" href="../../d3/d2/io_2query_8c-source.html#l00223">pIoQueryBusDescription()</a>, <a class="el" href="../../d7/d4/ps_2security_8c-source.html#l00650">PsImpersonateClient()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l02210">PspApplyJobLimitsToProcessSet()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l02680">PspCaptureTokenFilter()</a>, <a class="el" href="../../d9/d6/rtl_2remlock_8c-source.html#l00091">RtlAcquireRemoveLockEx()</a>, <a class="el" href="../../d9/d6/rtl_2remlock_8c-source.html#l00050">RtlAllocateRemoveLock()</a>, <a class="el" href="../../d4/d8/excptdbg_8c-source.html#l00029">RtlInitializeExceptionLog()</a>, <a class="el" href="../../d1/d9/rtl_2atom_8c-source.html#l00029">RtlpAllocateAtom()</a>, <a class="el" href="../../d5/d6/rtl_2regutil_8c-source.html#l00679">RtlpAllocDeallocQueryBuffer()</a>, <a class="el" href="../../d9/d5/sertl_8c-source.html#l06266">RtlpComputeMergedAcl()</a>, <a class="el" href="../../d9/d5/sertl_8c-source.html#l07461">RtlpConvertAclToAutoInherit()</a>, <a class="el" href="../../d9/d5/sertl_8c-source.html#l06520">RtlpConvertToAutoInheritSecurityObject()</a>, <a class="el" href="../../d9/d5/sertl_8c-source.html#l08588">RtlpCreateServerAcl()</a>, <a class="el" href="../../d9/d5/sertl_8c-source.html#l05153">RtlpInheritAcl()</a>, <a class="el" href="../../d9/d5/sertl_8c-source.html#l09057">RtlpNewSecurityObject()</a>, <a class="el" href="../../d9/d5/sertl_8c-source.html#l10195">RtlpSetSecurityObject()</a>, <a class="el" href="../../d1/d3/accessck_8c-source.html#l02704">SeAccessCheckByType()</a>, <a class="el" href="../../d3/d4/seastate_8c-source.html#l00434">SeAppendPrivileges()</a>, <a class="el" href="../../d3/d4/se_2capture_8c-source.html#l01370">SeCaptureAcl()</a>, <a class="el" href="../../d3/d4/se_2capture_8c-source.html#l01608">SeCaptureLuidAndAttributesArray()</a>, <a class="el" href="../../d1/d3/accessck_8c-source.html#l00144">SeCaptureObjectTypeList()</a>, <a class="el" href="../../d3/d4/se_2capture_8c-source.html#l00053">SeCaptureSecurityDescriptor()</a>, <a class="el" href="../../d3/d4/se_2capture_8c-source.html#l01141">SeCaptureSid()</a>, <a class="el" href="../../d3/d4/se_2capture_8c-source.html#l01850">SeCaptureSidAndAttributesArray()</a>, <a class="el" href="../../d5/d2/token_8c-source.html#l01010">SeMakeAnonymousLogonToken()</a>, <a class="el" href="../../d5/d2/token_8c-source.html#l00536">SeMakeSystemToken()</a>, <a class="el" href="../../d4/d4/seaudit_8c-source.html#l01050">SepAccessCheckAndAuditAlarm()</a>, <a class="el" href="../../d1/d4/adtlog_8c-source.html#l00052">SepAdtLogAuditRecord()</a>, <a class="el" href="../../d1/d4/adtlog_8c-source.html#l00264">SepAdtMarshallAuditRecord()</a>, <a class="el" href="../../d8/d5/sepaudit_8c-source.html#l00571">SepAdtOpenObjectAuditAlarm()</a>, <a class="el" href="../../d9/d4/seglobal_8c-source.html#l01071">SepAssemblePrivileges()</a>, <a class="el" href="../../d3/d4/se_2capture_8c-source.html#l00681">SepCopyProxyData()</a>, <a class="el" href="../../d0/d9/rmlogon_8c-source.html#l00541">SepCreateLogonSessionTrack()</a>, <a class="el" href="../../d5/d2/token_8c-source.html#l02213">SepCreateToken()</a>, <a class="el" href="../../d7/d2/tokendup_8c-source.html#l00362">SepDuplicateToken()</a>, <a class="el" href="../../d7/d2/tokendup_8c-source.html#l01939">SepFilterToken()</a>, <a class="el" href="../../d0/d9/rmlogon_8c-source.html#l01049">SepInformFileSystemsOfDeletedLogon()</a>, <a class="el" href="../../d0/d9/rmlogon_8c-source.html#l00777">SepInformLsaOfDeletedLogon()</a>, <a class="el" href="../../d9/d4/seglobal_8c-source.html#l01019">SepInitializePrivilegeSets()</a>, <a class="el" href="../../d9/d4/seglobal_8c-source.html#l00651">SepInitSystemDacls()</a>, <a class="el" href="../../d4/d4/seaudit_8c-source.html#l00259">SepProbeAndCaptureString_U()</a>, <a class="el" href="../../d8/d5/sepaudit_8c-source.html#l02324">SepQueryNameString()</a>, <a class="el" href="../../d8/d5/sepaudit_8c-source.html#l02400">SepQueryTypeString()</a>, <a class="el" href="../../d1/d3/accessck_8c-source.html#l03652">SePrivilegePolicyCheck()</a>, <a class="el" href="../../d3/d9/rmvars_8c-source.html#l00095">SepRmDbInitialization()</a>, <a class="el" href="../../d9/d4/seglobal_8c-source.html#l00307">SepVariableInitialization()</a>, <a class="el" href="../../d0/d9/rmlogon_8c-source.html#l00849">SeRegisterLogonSessionTerminatedRoutine()</a>, <a class="el" href="../../d1/d9/rmmain_8c-source.html#l00060">SeRmInitPhase1()</a>, <a class="el" href="../../d5/d8/smbtrsup_8c-source.html#l01456">SmbTraceCompleteRdr()</a>, <a class="el" href="../../d5/d8/smbtrsup_8c-source.html#l01242">SmbTraceCompleteSrv()</a>, <a class="el" href="../../d5/d8/smbtrsup_8c-source.html#l01794">SmbTraceDereferenceHeap()</a>, <a class="el" href="../../d5/d8/smbtrsup_8c-source.html#l00438">SmbTraceInitialize()</a>, <a class="el" href="../../d9/d4/udfs_2verfysup_8c-source.html#l00365">UdfDismountVcb()</a>, <a class="el" href="../../d0/d7/udfs_2fsctrl_8c-source.html#l01271">UdfInvalidateVolumes()</a>, <a class="el" href="../../d0/d4/vdmints_8c-source.html#l01235">VdmpDelayInterrupt()</a>, <a class="el" href="../../d8/d3/vdminit_8c-source.html#l00019">VdmpInitialize()</a>, <a class="el" href="../../d0/d5/verifier_8c-source.html#l00965">VerifierAllocatePoolWithTag()</a>, <a class="el" href="../../d8/d1/drivesup_8c-source.html#l00190">xHalExamineMBR()</a>, <a class="el" href="../../d8/d1/drivesup_8c-source.html#l00382">xHalGetPartialGeometry()</a>, <a class="el" href="../../d8/d1/drivesup_8c-source.html#l01243">xHalIoAssignDriveLetters()</a>, <a class="el" href="../../d8/d1/drivesup_8c-source.html#l03486">xHalIoClearPartitionTable()</a>, <a class="el" href="../../d8/d1/drivesup_8c-source.html#l01739">xHalIoReadPartitionTable()</a>, <a class="el" href="../../d8/d1/drivesup_8c-source.html#l02485">xHalIoSetPartitionInformation()</a>, and <a class="el" href="../../d8/d1/drivesup_8c-source.html#l02879">xHalIoWritePartitionTable()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a72" doxytag="ex.h::ExConvertExclusiveToShared" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ExConvertExclusiveToShared&nbsp;&nbsp;&nbsp;ExConvertExclusiveToSharedLite          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l02477">2477</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.
<p>
Referenced by <a class="el" href="../../d4/d0/fastio_8c-source.html#l02064">FsRtlAcquireFileForModWrite()</a>, and <a class="el" href="../../d5/d9/tex_8c-source.html#l01646">ReaderTurnedWriter()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a73" doxytag="ex.h::ExDeleteResource" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ExDeleteResource&nbsp;&nbsp;&nbsp;ExDeleteResourceLite          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l02478">2478</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.
<p>
Referenced by <a class="el" href="../../d7/d1/cachesub_8c-source.html#l05694">CcDeallocateBcb()</a>, <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l01667">ExpFreeHandleTable()</a>, <a class="el" href="../../d9/d6/lfs_2strucsup_8c-source.html#l00188">LfsDeallocateLfcb()</a>, <a class="el" href="../../d1/d6/lfs_2registry_8c-source.html#l01063">LfsDeleteLogHandle()</a>, <a class="el" href="../../d4/d6/session_8c-source.html#l01544">MiDereferenceSession()</a>, <a class="el" href="../../d5/d9/wslist_8c-source.html#l01881">MiSessionInitializeWorkingSetList()</a>, <a class="el" href="../../d4/d1/i386_2psvdm_8c-source.html#l00203">PspDeleteVdmObjects()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l00636">PspJobDelete()</a>, <a class="el" href="../../d5/d8/smbtrsup_8c-source.html#l00438">SmbTraceInitialize()</a>, <a class="el" href="../../d5/d8/smbtrsup_8c-source.html#l00509">SmbTraceTerminate()</a>, <a class="el" href="../../d0/d7/udfs_2strucsup_8c-source.html#l04317">UdfDeleteFcbNonpaged()</a>, <a class="el" href="../../d0/d7/udfs_2strucsup_8c-source.html#l01210">UdfDeleteVcb()</a>, and <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l00097">Win32kNtUserCleanup()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a76" doxytag="ex.h::ExDisableResourceBoost" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ExDisableResourceBoost&nbsp;&nbsp;&nbsp;ExDisableResourceBoostLite          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l02482">2482</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.
<p>
Referenced by <a class="el" href="../../d7/d1/cachesub_8c-source.html#l05541">CcAllocateInitializeBcb()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a7" doxytag="ex.h::ExFreePoolWithTag" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ExFreePoolWithTag          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">a,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>b&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;ExFreePool(a)</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l00291">291</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.
<p>
Referenced by <a class="el" href="../../d3/d1/cmparse_8c-source.html#l02056">CmpAddInfoAfterParseFailure()</a>, <a class="el" href="../../d9/d1/cmsubs_8c-source.html#l00629">CmpCleanUpKcbCacheWithLock()</a>, <a class="el" href="../../d9/d1/cmsubs_8c-source.html#l00537">CmpCleanUpSubKeyInfo()</a>, <a class="el" href="../../d9/d1/cmsubs_8c-source.html#l00824">CmpCreateKeyControlBlock()</a>, <a class="el" href="../../d9/d1/cmsubs_8c-source.html#l00503">CmpDereferenceNameControlBlockWithLock()</a>, <a class="el" href="../../d3/d1/cmparse_8c-source.html#l01476">CmpGetSymbolicLink()</a>, <a class="el" href="../../d7/d1/cmsavres_8c-source.html#l00484">CmpLoadHiveVolatile()</a>, <a class="el" href="../../d6/d1/cmquery_8c-source.html#l00028">CmpQueryKeyName()</a>, <a class="el" href="../../d9/d8/cmapi_8c-source.html#l00647">CmQueryKey()</a>, <a class="el" href="../../d7/d1/cmsavres_8c-source.html#l00097">CmRestoreKey()</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l02751">ExFreePool()</a>, <a class="el" href="../../d1/d1/obtype_8c-source.html#l00738">ObpDestroyTypeArray()</a>, <a class="el" href="../../d7/d9/obcreate_8c-source.html#l01098">ObpFreeObject()</a>, and <a class="el" href="../../d0/d5/verifier_8c-source.html#l02143">VerifierFreePoolWithTag()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a57" doxytag="ex.h::ExFreeToZone" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ExFreeToZone          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">Zone,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>Block&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div>( ((PSINGLE_LIST_ENTRY)(Block))-&gt;Next = (Zone)-&gt;FreeList.Next,  \
      (Zone)-&gt;FreeList.Next = ((PSINGLE_LIST_ENTRY)(Block)),        \
      ((PSINGLE_LIST_ENTRY)(Block))-&gt;Next                           \
    )
</div></pre>
<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l02133">2133</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.
<p>
Referenced by <a class="el" href="../../d7/d1/cachesub_8c-source.html#l05694">CcDeallocateBcb()</a>, <a class="el" href="../../d5/d9/tex_8c-source.html#l01510">DoZoneTest()</a>, and <a class="el" href="../../d4/d6/lpcqueue_8c-source.html#l00642">LpcpFreeToPortZone()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a67" doxytag="ex.h::ExGetCurrentResourceThread" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ExGetCurrentResourceThread          </td>
          <td class="md" valign="top">(&nbsp;</td>
&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;((ULONG_PTR)PsGetCurrentThread())</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l02455">2455</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.
<p>
Referenced by <a class="el" href="../../d8/d3/ddkresrc_8c-source.html#l00249">ExAcquireResourceExclusive()</a>, <a class="el" href="../../d1/d0/pnpirp_8c-source.html#l01604">IopQueryDeviceRelations()</a>, <a class="el" href="../../d1/d0/pnpirp_8c-source.html#l00510">IopStartDevice()</a>, <a class="el" href="../../d7/d4/logpgsup_8c-source.html#l00113">LfsAllocateSpanningBuffer()</a>, <a class="el" href="../../d8/d1/lfs_2cachesup_8c-source.html#l00551">LfsFlushLfcb()</a>, <a class="el" href="../../d7/d4/logpgsup_8c-source.html#l00297">LfsFreeSpanningBuffer()</a>, <a class="el" href="../../d8/d0/lbcbsup_8c-source.html#l00311">LfsGetLbcb()</a>, and <a class="el" href="../../d8/d4/udfs_2read_8c-source.html#l00068">UdfCommonRead()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a8" doxytag="ex.h::ExInitializeFastMutex" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ExInitializeFastMutex          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">_FastMutex&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div>(_FastMutex)-&gt;Count = 1;                                         \
    (_FastMutex)-&gt;Contention = 0;                                    \
    <a class="code" href="../../d4/d9/ke_8h.html#a20">KeInitializeEvent</a>(&amp;(_FastMutex)-&gt;Event,                          \
                      SynchronizationEvent,                          \
                      FALSE);
</div></pre>
<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l00367">367</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.
<p>
Referenced by <a class="el" href="../../d2/d2/cmsysini_8c-source.html#l00293">CmInitSystem1()</a>, <a class="el" href="../../d9/d0/cminit_8c-source.html#l00471">CmpInitializeHive()</a>, <a class="el" href="../../d0/d5/ex_2lookasid_8c-source.html#l00543">ExInitializePagedLookasideList()</a>, <a class="el" href="../../d4/d2/uuid_8c-source.html#l00340">ExpUuidInitialization()</a>, <a class="el" href="../../d6/d1/oplock_8c-source.html#l01221">FsRtlAllocateOplock()</a>, <a class="el" href="../../d6/d2/filelock_8c-source.html#l00744">FsRtlInitializeFileLocks()</a>, <a class="el" href="../../d2/d0/largemcb_8c-source.html#l00572">FsRtlInitializeLargeMcb()</a>, <a class="el" href="../../d2/d6/tunnel_8c-source.html#l00517">FsRtlInitializeTunnelCache()</a>, <a class="el" href="../../d3/d6/notify_8c-source.html#l00371">FsRtlNotifyInitializeSync()</a>, <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l01322">InitCreateUserCrit()</a>, <a class="el" href="../../d6/d8/w32_2ntuser_2kernel_2pnp_8c-source.html#l00119">InitializeMediaChange()</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00677">InitializePool()</a>, <a class="el" href="../../d8/d1/power_8c-source.html#l00180">InitializePowerRequestList()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l06511">IopInitializePlugPlayNotification()</a>, <a class="el" href="../../d8/d9/pnpinit_8c-source.html#l00093">IopInitializePlugPlayServices()</a>, <a class="el" href="../../d9/d6/lfs_2strucsup_8c-source.html#l00041">LfsAllocateLfcb()</a>, <a class="el" href="../../d8/d7/sysinit_8c-source.html#l00040">LfsInitializeLogFileService()</a>, <a class="el" href="../../d0/d5/verifier_8c-source.html#l03121">MiInitializeDriverVerifierList()</a>, <a class="el" href="../../d4/d6/session_8c-source.html#l00350">MiInitializeSessionIds()</a>, <a class="el" href="../../d2/d5/allocpag_8c-source.html#l04222">MiInitializeSessionPool()</a>, <a class="el" href="../../d4/d4/mapview_8c-source.html#l03967">MiInitializeSystemSpaceMap()</a>, <a class="el" href="../../d5/d4/procsup_8c-source.html#l00911">MmInitializeProcessAddressSpace()</a>, <a class="el" href="../../d6/d0/mminit_8c-source.html#l00184">MmInitSystem()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l00048">NtCreateJobObject()</a>, <a class="el" href="../../d3/d7/ps_2create_8c-source.html#l00969">PspCreateProcess()</a>, <a class="el" href="../../d1/d0/psinit_8c-source.html#l00181">PspInitPhase0()</a>, <a class="el" href="../../d1/d9/rtl_2atom_8c-source.html#l00056">RtlpInitializeLockAtomTable()</a>, <a class="el" href="../../d0/d7/udfs_2strucsup_8c-source.html#l04269">UdfCreateFcbNonPaged()</a>, <a class="el" href="../../d3/d7/udfinit_8c-source.html#l00183">UdfInitializeGlobalData()</a>, <a class="el" href="../../d0/d7/udfs_2strucsup_8c-source.html#l00331">UdfInitializeVcb()</a>, and <a class="el" href="../../d8/d3/vdminit_8c-source.html#l00019">VdmpInitialize()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a68" doxytag="ex.h::ExInitializeResource" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ExInitializeResource&nbsp;&nbsp;&nbsp;ExInitializeResourceLite          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l02473">2473</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.
<p>
Referenced by <a class="el" href="../../d7/d1/cachesub_8c-source.html#l05541">CcAllocateInitializeBcb()</a>, <a class="el" href="../../d2/d2/cmsysini_8c-source.html#l00293">CmInitSystem1()</a>, <a class="el" href="../../d5/d9/tex_8c-source.html#l01706">DoResourceTest()</a>, <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l00422">ExInitializeHandleTablePackage()</a>, <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l01475">ExpAllocateHandleTable()</a>, <a class="el" href="../../d5/d7/fsrtlpc_8c-source.html#l00215">FsRtlInitSystem()</a>, <a class="el" href="../../d0/d5/ioinit_8c-source.html#l00270">IoInitSystem()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l08928">IopInitializeBootLogging()</a>, <a class="el" href="../../d8/d9/pnpinit_8c-source.html#l00093">IopInitializePlugPlayServices()</a>, <a class="el" href="../../d9/d6/lfs_2strucsup_8c-source.html#l00041">LfsAllocateLfcb()</a>, <a class="el" href="../../d9/d7/sysload_8c-source.html#l06591">MiInitializeLoadedModuleList()</a>, <a class="el" href="../../d5/d9/wslist_8c-source.html#l01881">MiSessionInitializeWorkingSetList()</a>, <a class="el" href="../../d6/d0/mminit_8c-source.html#l00184">MmInitSystem()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l00048">NtCreateJobObject()</a>, <a class="el" href="../../d9/d0/obsdata_8c-source.html#l00118">ObpInitSecurityDescriptorCache()</a>, <a class="el" href="../../d4/d1/i386_2psvdm_8c-source.html#l00730">Psp386CreateVdmIoListHead()</a>, <a class="el" href="../../d4/d1/i386_2psvdm_8c-source.html#l00987">PspVdmInitialize()</a>, <a class="el" href="../../d9/d4/seglobal_8c-source.html#l01152">SepInitializeWorkList()</a>, <a class="el" href="../../d3/d9/rmvars_8c-source.html#l00095">SepRmDbInitialization()</a>, <a class="el" href="../../d5/d2/token_8c-source.html#l01460">SepTokenInitialization()</a>, <a class="el" href="../../d5/d8/smbtrsup_8c-source.html#l00438">SmbTraceInitialize()</a>, <a class="el" href="../../d0/d7/udfs_2strucsup_8c-source.html#l04269">UdfCreateFcbNonPaged()</a>, <a class="el" href="../../d3/d7/udfinit_8c-source.html#l00183">UdfInitializeGlobalData()</a>, and <a class="el" href="../../d0/d7/udfs_2strucsup_8c-source.html#l00331">UdfInitializeVcb()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a9" doxytag="ex.h::ExInitializeSListHead" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ExInitializeSListHead          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">_listhead_&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;(_listhead_)-&gt;Alignment = 0</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l00611">611</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.
<p>
Referenced by <a class="el" href="../../d0/d5/ex_2lookasid_8c-source.html#l00408">ExInitializeNPagedLookasideList()</a>, <a class="el" href="../../d0/d5/ex_2lookasid_8c-source.html#l00543">ExInitializePagedLookasideList()</a>, and <a class="el" href="../../d7/d5/ex_2region_8c-source.html#l00024">ExInitializeRegion()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a55" doxytag="ex.h::ExInitializeWorkItem" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ExInitializeWorkItem          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">Item,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>Routine,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>Context&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div>(Item)-&gt;WorkerRoutine = (Routine);               \
    (Item)-&gt;Parameter = (Context);                   \
    (Item)-&gt;List.Flink = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
</div></pre>
<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l01961">1961</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.
<p>
Referenced by <a class="el" href="../../d6/d7/fssup_8c-source.html#l00069">CcInitializeCacheManager()</a>, <a class="el" href="../../d6/d0/cmgquota_8c-source.html#l00204">CmpClaimGlobalQuota()</a>, <a class="el" href="../../d6/d2/cmworker_8c-source.html#l00556">CmpDiskFullWarning()</a>, <a class="el" href="../../d6/d2/cmworker_8c-source.html#l00115">CmpWorker()</a>, <a class="el" href="../../d5/d4/stackovf_8c-source.html#l00215">FsRtlpPostStackOverflow()</a>, <a class="el" href="../../d2/d9/io_2misc_8c-source.html#l00891">IoAllocateWorkItem()</a>, <a class="el" href="../../d0/d5/ioinit_8c-source.html#l00270">IoInitSystem()</a>, <a class="el" href="../../d4/d9/pnpdel_8c-source.html#l00084">IopChainDereferenceComplete()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l00657">IopCompleteUnloadOrDelete()</a>, <a class="el" href="../../d1/d0/pnpirp_8c-source.html#l00896">IopDeviceEjectComplete()</a>, <a class="el" href="../../d1/d0/pnpirp_8c-source.html#l00730">IopEjectDevice()</a>, <a class="el" href="../../d8/d6/errorlog_8c-source.html#l00660">IopErrorLogDpc()</a>, <a class="el" href="../../d7/d9/pnpenum_8c-source.html#l05034">IopProcessNewProfile()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l06327">IopQueueDeviceWorkItem()</a>, <a class="el" href="../../d7/d9/pnpenum_8c-source.html#l00207">IopRequestDeviceAction()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l06127">IopSendMessageToTrackService()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l08769">IoRaiseHardError()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l06118">IoReportTargetDeviceChangeAsynchronous()</a>, <a class="el" href="../../d9/d3/trackirp_8c-source.html#l02555">IovpInternalDeferredCompletion()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l11556">IoWriteErrorLogEntry()</a>, <a class="el" href="../../d5/d5/kdinit_8c-source.html#l00036">KdInitSystem()</a>, <a class="el" href="../../d0/d8/mips_2kdtrap_8c-source.html#l00079">KdpTrap()</a>, <a class="el" href="../../d7/d2/modwrite_8c-source.html#l01095">MiCheckForCrashDump()</a>, <a class="el" href="../../d9/d3/loadunld_8c-source.html#l00035">NtLoadDriver()</a>, <a class="el" href="../../d9/d3/loadunld_8c-source.html#l00244">NtUnloadDriver()</a>, <a class="el" href="../../d8/d0/obref_8c-source.html#l01124">ObfDereferenceObject()</a>, <a class="el" href="../../d1/d0/psinit_8c-source.html#l00181">PspInitPhase0()</a>, <a class="el" href="../../d0/d9/rmlogon_8c-source.html#l01049">SepInformFileSystemsOfDeletedLogon()</a>, <a class="el" href="../../d1/d4/adtlog_8c-source.html#l00600">SepQueueWorkItem()</a>, <a class="el" href="../../d5/d8/smbtrsup_8c-source.html#l01794">SmbTraceDereferenceHeap()</a>, <a class="el" href="../../d3/d8/workque_8c-source.html#l00316">UdfAddToWorkque()</a>, and <a class="el" href="../../d3/d7/udfinit_8c-source.html#l00183">UdfInitializeGlobalData()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a59" doxytag="ex.h::ExInterlockedAllocateFromZone" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ExInterlockedAllocateFromZone          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">Zone,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>Lock&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;(PVOID) ExInterlockedPopEntryList( &amp;(Zone)-&gt;FreeList, Lock )</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l02193">2193</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a60" doxytag="ex.h::ExInterlockedFreeToZone" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ExInterlockedFreeToZone          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">Zone,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>Block,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>Lock&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;ExInterlockedPushEntryList( &amp;(Zone)-&gt;FreeList, ((PSINGLE_LIST_ENTRY) (Block)), Lock )</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l02230">2230</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a58" doxytag="ex.h::ExIsFullZone" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ExIsFullZone          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">Zone&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;( (Zone)-&gt;FreeList.Next == (PSINGLE_LIST_ENTRY)NULL )</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l02161">2161</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a61" doxytag="ex.h::ExIsObjectInFirstZoneSegment" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ExIsObjectInFirstZoneSegment          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">Zone,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>Object&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div>((BOOLEAN)     \
    (((PUCHAR)(Object) &gt;= (PUCHAR)(Zone)-&gt;SegmentList.Next) &amp;&amp;   \
     ((PUCHAR)(Object) &lt; (PUCHAR)(Zone)-&gt;SegmentList.Next +      \
                         (Zone)-&gt;TotalSegmentSize))              \
)
</div></pre>
<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l02259">2259</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a74" doxytag="ex.h::ExIsResourceAcquiredExclusive" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ExIsResourceAcquiredExclusive&nbsp;&nbsp;&nbsp;ExIsResourceAcquiredExclusiveLite          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l02479">2479</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a75" doxytag="ex.h::ExIsResourceAcquiredShared" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ExIsResourceAcquiredShared&nbsp;&nbsp;&nbsp;ExIsResourceAcquiredSharedLite          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l02480">2480</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.
<p>
Referenced by <a class="el" href="../../d4/d0/fastio_8c-source.html#l02402">FsRtlAcquireFileForCcFlush()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a10" doxytag="ex.h::ExQueryDepthSList" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ExQueryDepthSList          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">_listhead_&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;(<a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a14">USHORT</a>)(_listhead_)-&gt;Depth</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l00637">637</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.
<p>
Referenced by <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l02760">ExFreePoolWithTag()</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l00821">ExFreeToNPagedLookasideList()</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l00947">ExFreeToPagedLookasideList()</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l01077">ExFreeToPPNPagedLookasideList()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l06641">IopFreeIrp()</a>, and <a class="el" href="../../d6/d3/complete_8c-source.html#l00797">IopFreeMiniPacket()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a66" doxytag="ex.h::ExReleaseResource" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ExReleaseResource          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">R&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;(ExReleaseResourceLite(R))</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l02393">2393</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.
<p>
Referenced by <a class="el" href="../../d7/d1/cachesub_8c-source.html#l00974">CcUnpinFileData()</a>, <a class="el" href="../../d8/d2/validate_8c-source.html#l00887">ChangeAcquireResourceType()</a>, <a class="el" href="../../d1/d2/cmsubs3_8c-source.html#l00116">CmpUnlockRegistry()</a>, <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l01475">ExpAllocateHandleTable()</a>, <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l00501">ExRemoveHandleTable()</a>, <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l00984">ExSnapShotHandleTables()</a>, <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l00209">ExUnlockHandleTableExclusive()</a>, <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l00178">ExUnlockHandleTableShared()</a>, <a class="el" href="../../d4/d0/fastio_8c-source.html#l02064">FsRtlAcquireFileForModWrite()</a>, <a class="el" href="../../d4/d0/fastio_8c-source.html#l00054">FsRtlCopyRead()</a>, <a class="el" href="../../d4/d0/fastio_8c-source.html#l00330">FsRtlCopyWrite()</a>, <a class="el" href="../../d4/d0/fastio_8c-source.html#l01064">FsRtlMdlReadDev()</a>, <a class="el" href="../../d4/d0/fastio_8c-source.html#l01474">FsRtlPrepareMdlWriteDev()</a>, <a class="el" href="../../d4/d0/fastio_8c-source.html#l02628">FsRtlReleaseFile()</a>, <a class="el" href="../../d4/d0/fastio_8c-source.html#l02483">FsRtlReleaseFileForCcFlush()</a>, <a class="el" href="../../d4/d0/fastio_8c-source.html#l02342">FsRtlReleaseFileForModWrite()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l04946">IoGetDeviceInterfaceAlias()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l00373">IoGetDeviceProperty()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l03624">IoOpenDeviceInterfaceRegistryKey()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l00810">IoOpenDeviceRegistryKey()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l09046">IopBootLog()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l09284">IopBootLogToFile()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l09157">IopCopyBootLogRegistryToFile()</a>, <a class="el" href="../../d0/d1/pnpsubs_8c-source.html#l00091">IopCreateMadeupNode()</a>, <a class="el" href="../../d0/d1/pnpsubs_8c-source.html#l05453">IopDeleteLegacyKey()</a>, <a class="el" href="../../d4/d9/pnpdel_8c-source.html#l00232">IopDeleteLockedDeviceNode()</a>, <a class="el" href="../../d7/d9/pnpenum_8c-source.html#l00307">IopDeviceActionWorker()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l03708">IopDeviceInterfaceKeysFromSymbolicLink()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l09866">IopDoDeferredSetInterfaceState()</a>, <a class="el" href="../../d0/d1/pnpsubs_8c-source.html#l02779">IopDriverLoadingFailed()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l02707">IopGetDeviceInterfaces()</a>, <a class="el" href="../../d3/d9/pnpdd_8c-source.html#l01411">IopGetDriverDeviceList()</a>, <a class="el" href="../../d8/d9/pnpinit_8c-source.html#l00680">IopGetRootDevices()</a>, <a class="el" href="../../d4/d0/objsup_8c-source.html#l00975">IopGetSetSecurityObject()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l08928">IopInitializeBootLogging()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l04710">IopInvalidateVolumesForDevice()</a>, <a class="el" href="../../d3/d9/pnpdd_8c-source.html#l02009">IopIsFirmwareDisabled()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l03200">IopLoadDriver()</a>, <a class="el" href="../../d1/d0/pnpirp_8c-source.html#l01891">IopMakeGloballyUniqueId()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l04282">IopMountVolume()</a>, <a class="el" href="../../d5/d2/parse_8c-source.html#l00202">IopParseDevice()</a>, <a class="el" href="../../d0/d1/pnpsubs_8c-source.html#l00753">IopPrepareDriverLoading()</a>, <a class="el" href="../../d3/d9/pnpdd_8c-source.html#l01185">IopProcessAssignResources()</a>, <a class="el" href="../../d7/d9/pnpenum_8c-source.html#l01538">IopProcessNewDeviceNode()</a>, <a class="el" href="../../d7/d9/pnpenum_8c-source.html#l00821">IopProcessStartDevices()</a>, <a class="el" href="../../d7/d9/pnpenum_8c-source.html#l00912">IopProcessStartDevicesWorker()</a>, <a class="el" href="../../d6/d0/pnpres_8c-source.html#l07470">IopReallocateResources()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l03929">IopRegisterDeviceInterface()</a>, <a class="el" href="../../d3/d9/pnpdd_8c-source.html#l00263">IopReleaseDeviceResources()</a>, <a class="el" href="../../d4/d0/objsup_8c-source.html#l00877">IopSetDeviceSecurityDescriptors()</a>, <a class="el" href="../../d7/d9/pnpenum_8c-source.html#l00994">IopStartAndEnumerateDevice()</a>, <a class="el" href="../../d4/d9/pnpdel_8c-source.html#l01572">IopUnlockDeviceRemovalRelations()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l04140">IopUnregisterDeviceInterface()</a>, <a class="el" href="../../d3/d9/pnpdd_8c-source.html#l01931">IopWriteAllocatedResourcesToRegistry()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l09324">IoRegisterFileSystem()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l09422">IoRegisterFsRegistrationChange()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l01548">IoReportDetectedDevice()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l03563">IoSetDeviceInterfaceState()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l11106">IoUnregisterFileSystem()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l11178">IoUnregisterFsRegistrationChange()</a>, <a class="el" href="../../d8/d2/validate_8c-source.html#l00846">LeaveCrit()</a>, <a class="el" href="../../d6/d0/mminit_8c-source.html#l02735">MiEnablePagingTheExecutive()</a>, <a class="el" href="../../d6/d0/mminit_8c-source.html#l02474">MiFindInitializationCode()</a>, <a class="el" href="../../d9/d7/sysload_8c-source.html#l00443">MiLoadSystemImage()</a>, <a class="el" href="../../d6/d5/iosup_8c-source.html#l06991">MiLookupDataTableEntry()</a>, <a class="el" href="../../d5/d6/sessload_8c-source.html#l01273">MiLookupPsLoadedModule()</a>, <a class="el" href="../../d4/d4/mapview_8c-source.html#l01567">MiMapViewOfImageSection()</a>, <a class="el" href="../../d9/d9/extsect_8c-source.html#l00201">MmExtendSection()</a>, <a class="el" href="../../d6/d5/iosup_8c-source.html#l06797">MmGetSectionRange()</a>, <a class="el" href="../../d9/d7/sysload_8c-source.html#l06808">MmGetSystemRoutineAddress()</a>, <a class="el" href="../../d6/d0/mminit_8c-source.html#l00184">MmInitSystem()</a>, <a class="el" href="../../d6/d5/iosup_8c-source.html#l06864">MmLockPagableDataSection()</a>, <a class="el" href="../../d9/d7/sysload_8c-source.html#l02896">MmUnloadSystemImage()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l00266">NtAssignProcessToJobObject()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l00814">NtQueryInformationJobObject()</a>, <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l00941">NtQuerySystemInformation()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l01323">NtSetInformationJobObject()</a>, <a class="el" href="../../d0/d1/psquery_8c-source.html#l01510">NtSetInformationProcess()</a>, <a class="el" href="../../d3/d2/dbgctrl_8c-source.html#l00036">NtSystemDebugControl()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l02358">NtTerminateJobObject()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l07905">NtUserUserHandleGrantAccess()</a>, <a class="el" href="../../d9/d0/obsdata_8c-source.html#l00942">ObpReleaseDescriptorCacheLock()</a>, <a class="el" href="../../d4/d1/i386_2psvdm_8c-source.html#l00869">Ps386GetVdmIoHandler()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l02396">PsEnforceExecutionTimeLimits()</a>, <a class="el" href="../../d4/d1/i386_2psvdm_8c-source.html#l00730">Psp386CreateVdmIoListHead()</a>, <a class="el" href="../../d4/d1/i386_2psvdm_8c-source.html#l00477">Psp386InstallIoHandler()</a>, <a class="el" href="../../d4/d1/i386_2psvdm_8c-source.html#l00280">Psp386RemoveIoHandler()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l00439">PspAddProcessToJob()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l00608">PspExitProcessFromJob()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l00709">PspJobClose()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l00636">PspJobDelete()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l00579">PspRemoveProcessFromJob()</a>, <a class="el" href="../../d0/d1/psquery_8c-source.html#l01211">PspSetQuotaLimits()</a>, <a class="el" href="../../d5/d9/tex_8c-source.html#l01567">Reader()</a>, <a class="el" href="../../d5/d9/tex_8c-source.html#l01646">ReaderTurnedWriter()</a>, <a class="el" href="../../d5/d8/smbtrsup_8c-source.html#l00551">SmbTraceStart()</a>, <a class="el" href="../../d5/d8/smbtrsup_8c-source.html#l01050">SmbTraceStop()</a>, <a class="el" href="../../d5/d2/fileinfo_8c-source.html#l00496">UdfFastQueryBasicInfo()</a>, <a class="el" href="../../d5/d2/fileinfo_8c-source.html#l00740">UdfFastQueryNetworkInfo()</a>, <a class="el" href="../../d5/d2/fileinfo_8c-source.html#l00614">UdfFastQueryStdInfo()</a>, <a class="el" href="../../d5/d8/resrcsup_8c-source.html#l00302">UdfReleaseForCreateSection()</a>, <a class="el" href="../../d5/d8/resrcsup_8c-source.html#l00172">UdfReleaseFromCache()</a>, <a class="el" href="../../d5/d9/tex_8c-source.html#l01606">Writer()</a>, and <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l02882">xxxUserProcessCallout()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a71" doxytag="ex.h::ExReleaseResourceForThread" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ExReleaseResourceForThread&nbsp;&nbsp;&nbsp;ExReleaseResourceForThreadLite          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l02476">2476</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.
<p>
Referenced by <a class="el" href="../../d3/d8/pinsup_8c-source.html#l01142">CcUnpinDataForThread()</a>, <a class="el" href="../../d4/d6/deviosup_8c-source.html#l01863">UdfMultiAsyncCompletionRoutine()</a>, and <a class="el" href="../../d4/d6/deviosup_8c-source.html#l02039">UdfSingleAsyncCompletionRoutine()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a78" doxytag="ex.h::ExSetHandleTableOrder" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ExSetHandleTableOrder          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">ht,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>or&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;{NOTHING;}</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l02975">2975</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.
<p>
Referenced by <a class="el" href="../../d1/d0/obinit_8c-source.html#l00953">ObInitProcess2()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a77" doxytag="ex.h::ExSetHandleTableOwner" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ExSetHandleTableOwner          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">ht,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>id&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;{(ht)-&gt;UniqueProcessId = (id);}</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l02973">2973</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.
<p>
Referenced by <a class="el" href="../../d3/d7/ps_2create_8c-source.html#l00262">PspCreateThread()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a2" doxytag="ex.h::POOL_QUOTA_FAIL_INSTEAD_OF_RAISE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define POOL_QUOTA_FAIL_INSTEAD_OF_RAISE&nbsp;&nbsp;&nbsp;8          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l00143">143</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.
<p>
Referenced by <a class="el" href="../../d1/d1/cmnotify_8c-source.html#l01378">CmpNotifyChangeKey()</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l02607">ExAllocatePoolWithQuotaTag()</a>, <a class="el" href="../../d4/d5/kernel_2sendmsg_8c-source.html#l00137">InitSMSLookaside()</a>, <a class="el" href="../../d3/d9/psctx_8c-source.html#l00056">NtQueueApcThread()</a>, <a class="el" href="../../d0/d5/verifier_8c-source.html#l01003">VerifierAllocatePoolWithQuota()</a>, and <a class="el" href="../../d0/d5/verifier_8c-source.html#l01059">VerifierAllocatePoolWithQuotaTag()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="ex.h::POOL_RAISE_IF_ALLOCATION_FAILURE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define POOL_RAISE_IF_ALLOCATION_FAILURE&nbsp;&nbsp;&nbsp;16          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l00144">144</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.
<p>
Referenced by <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l01104">ExAllocatePoolWithTag()</a>, <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l01475">ExpAllocateHandleTable()</a>, <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l01825">ExpAllocateHandleTableEntry()</a>, <a class="el" href="../../d2/d0/largemcb_8c-source.html#l00521">FsRtlInitializeLargeMcbs()</a>, <a class="el" href="../../d9/d4/seglobal_8c-source.html#l01071">SepAssemblePrivileges()</a>, <a class="el" href="../../d9/d4/seglobal_8c-source.html#l01019">SepInitializePrivilegeSets()</a>, <a class="el" href="../../d9/d4/seglobal_8c-source.html#l00651">SepInitSystemDacls()</a>, <a class="el" href="../../d9/d4/seglobal_8c-source.html#l00307">SepVariableInitialization()</a>, and <a class="el" href="../../d0/d5/verifier_8c-source.html#l01812">VeAllocatePoolWithTagPriority()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a38" doxytag="ex.h::ProbeAndNullPointer" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ProbeAndNullPointer          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">Address&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div>{                                       \
    <span class="keywordflow">if</span> ((PVOID *)(Address) &gt;= (PVOID * <span class="keyword">const</span>)MM_USER_PROBE_ADDRESS) {        \
        *(<span class="keyword">volatile</span> PVOID * <span class="keyword">const</span>)MM_USER_PROBE_ADDRESS = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;               \
    }                                                                        \
                                                                             \
    *(<span class="keyword">volatile</span> PVOID *)(Address) = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;                                     \
}
</div></pre>
<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l01615">1615</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.
<p>
Referenced by <a class="el" href="../../d5/d5/channel_8c-source.html#l00236">NtListenChannel()</a>, <a class="el" href="../../d5/d5/channel_8c-source.html#l00525">NtReplyWaitSendChannel()</a>, and <a class="el" href="../../d5/d5/channel_8c-source.html#l00807">NtSendWaitReplyChannel()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a12" doxytag="ex.h::ProbeAndReadBoolean" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ProbeAndReadBoolean          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">Address&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div>(((Address) &gt;= (BOOLEAN * <span class="keyword">const</span>)MM_USER_PROBE_ADDRESS) ? \
        (*(<span class="keyword">volatile</span> BOOLEAN * <span class="keyword">const</span>)MM_USER_PROBE_ADDRESS) : (*(<span class="keyword">volatile</span> BOOLEAN *)(Address)))
</div></pre>
<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l01235">1235</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a13" doxytag="ex.h::ProbeAndReadChar" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ProbeAndReadChar          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">Address&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div>(((Address) &gt;= (<a class="code" href="../../d1/d1/bench_8c.html#a16">CHAR</a> * <span class="keyword">const</span>)MM_USER_PROBE_ADDRESS) ? \
        (*(<span class="keyword">volatile</span> <a class="code" href="../../d1/d1/bench_8c.html#a16">CHAR</a> * <span class="keyword">const</span>)MM_USER_PROBE_ADDRESS) : (*(<span class="keyword">volatile</span> <a class="code" href="../../d1/d1/bench_8c.html#a16">CHAR</a> *)(Address)))
</div></pre>
<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l01248">1248</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.
<p>
Referenced by <a class="el" href="../../d4/d4/i386_2trapc_8c-source.html#l00090">Ki386CheckDivideByZeroTrap()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a17" doxytag="ex.h::ProbeAndReadHandle" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ProbeAndReadHandle          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">Address&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div>(((Address) &gt;= (HANDLE * <span class="keyword">const</span>)MM_USER_PROBE_ADDRESS) ? \
        (*(<span class="keyword">volatile</span> HANDLE * <span class="keyword">const</span>)MM_USER_PROBE_ADDRESS) : (*(<span class="keyword">volatile</span> HANDLE *)(Address)))
</div></pre>
<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l01300">1300</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a24" doxytag="ex.h::ProbeAndReadLargeInteger" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ProbeAndReadLargeInteger          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">Source&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div>(((Source) &gt;= (LARGE_INTEGER * <span class="keyword">const</span>)MM_USER_PROBE_ADDRESS) ? \
        (*(<span class="keyword">volatile</span> LARGE_INTEGER * <span class="keyword">const</span>)MM_USER_PROBE_ADDRESS) : (*(<span class="keyword">volatile</span> LARGE_INTEGER *)(Source)))
</div></pre>
<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l01391">1391</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.
<p>
Referenced by <a class="el" href="../../d6/d3/complete_8c-source.html#l00485">NtRemoveIoCompletion()</a>, <a class="el" href="../../d5/d6/lpcrecv_8c-source.html#l00635">NtReplyWaitReceivePortEx()</a>, <a class="el" href="../../d8/d6/ntapi_8c-source.html#l03235">NtSetInformationKey()</a>, <a class="el" href="../../d2/d1/obwait_8c-source.html#l00038">NtSignalAndWaitForSingleObject()</a>, <a class="el" href="../../d2/d1/obwait_8c-source.html#l00406">NtWaitForMultipleObjects()</a>, and <a class="el" href="../../d2/d1/obwait_8c-source.html#l00282">NtWaitForSingleObject()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a19" doxytag="ex.h::ProbeAndReadLong" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ProbeAndReadLong          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">Address&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div>(((Address) &gt;= (LONG * <span class="keyword">const</span>)MM_USER_PROBE_ADDRESS) ? \
        (*(<span class="keyword">volatile</span> LONG * <span class="keyword">const</span>)MM_USER_PROBE_ADDRESS) : (*(<span class="keyword">volatile</span> LONG *)(Address)))
</div></pre>
<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l01326">1326</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.
<p>
Referenced by <a class="el" href="../../d0/d1/psquery_8c-source.html#l03103">NtSetInformationThread()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a18" doxytag="ex.h::ProbeAndReadPointer" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ProbeAndReadPointer          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">Address&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div>(((Address) &gt;= (PVOID * <span class="keyword">const</span>)MM_USER_PROBE_ADDRESS) ? \
        (*(<span class="keyword">volatile</span> PVOID * <span class="keyword">const</span>)MM_USER_PROBE_ADDRESS) : (*(<span class="keyword">volatile</span> PVOID *)(Address)))
</div></pre>
<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l01313">1313</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a22" doxytag="ex.h::ProbeAndReadQuad" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ProbeAndReadQuad          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">Address&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div>(((Address) &gt;= (QUAD * <span class="keyword">const</span>)MM_USER_PROBE_ADDRESS) ? \
        (*(<span class="keyword">volatile</span> QUAD * <span class="keyword">const</span>)MM_USER_PROBE_ADDRESS) : (*(<span class="keyword">volatile</span> QUAD *)(Address)))
</div></pre>
<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l01365">1365</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a15" doxytag="ex.h::ProbeAndReadShort" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ProbeAndReadShort          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">Address&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div>(((Address) &gt;= (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a> * <span class="keyword">const</span>)MM_USER_PROBE_ADDRESS) ? \
        (*(<span class="keyword">volatile</span> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a> * <span class="keyword">const</span>)MM_USER_PROBE_ADDRESS) : (*(<span class="keyword">volatile</span> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a> *)(Address)))
</div></pre>
<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l01274">1274</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a27" doxytag="ex.h::ProbeAndReadStructure" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ProbeAndReadStructure          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">Source,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>STRUCTURE&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div>(((Source) &gt;= (STRUCTURE * <span class="keyword">const</span>)MM_USER_PROBE_ADDRESS) ? \
        (*(STRUCTURE * <span class="keyword">const</span>)MM_USER_PROBE_ADDRESS) : (*(STRUCTURE *)(Source)))
</div></pre>
<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l01431">1431</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.
<p>
Referenced by <a class="el" href="../../d6/d7/ntimm_8c-source.html#l01503">ImeCanDestroyDefIME()</a>, <a class="el" href="../../d6/d7/ntimm_8c-source.html#l01687">ImeCanDestroyDefIMEforChild()</a>, <a class="el" href="../../d7/d5/lpccreat_8c-source.html#l00136">LpcpCreatePort()</a>, <a class="el" href="../../d5/d5/lpccompl_8c-source.html#l00040">NtAcceptConnectPort()</a>, <a class="el" href="../../d6/d5/lpcconn_8c-source.html#l00084">NtSecureConnectPort()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l00891">NtUserCreateWindowStation()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l04369">NtUserDdeSetQualityOfService()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l13325">NtUserFlashWindowEx()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l06914">NtUserGetMouseMovePointsEx()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l01028">NtUserOpenWindowStation()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l09119">NtUserRegisterClassExWOW()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l02040">NtUserSetClassLongPtr()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l02400">NtUserSystemParametersInfo()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l07662">NtUserTestForInteractiveUser()</a>, <a class="el" href="../../d6/d7/ntimm_8c-source.html#l02375">xxxCheckImeShowStatus()</a>, <a class="el" href="../../d6/d7/ntimm_8c-source.html#l02544">xxxNotifyImeShowStatus()</a>, and <a class="el" href="../../d6/d7/ntimm_8c-source.html#l02461">xxxSendMessageToUI()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a14" doxytag="ex.h::ProbeAndReadUchar" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ProbeAndReadUchar          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">Address&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div>(((Address) &gt;= (UCHAR * <span class="keyword">const</span>)MM_USER_PROBE_ADDRESS) ? \
        (*(<span class="keyword">volatile</span> UCHAR * <span class="keyword">const</span>)MM_USER_PROBE_ADDRESS) : (*(<span class="keyword">volatile</span> UCHAR *)(Address)))
</div></pre>
<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l01261">1261</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.
<p>
Referenced by <a class="el" href="../../d4/d4/i386_2trapc_8c-source.html#l00090">Ki386CheckDivideByZeroTrap()</a>, <a class="el" href="../../d4/d4/i386_2trapc_8c-source.html#l00277">KiNextIStreamByte()</a>, <a class="el" href="../../d1/d2/qsquota_8c-source.html#l00035">NtQueryQuotaInformationFile()</a>, <a class="el" href="../../d3/d4/se_2capture_8c-source.html#l00053">SeCaptureSecurityDescriptor()</a>, <a class="el" href="../../d3/d4/se_2capture_8c-source.html#l01141">SeCaptureSid()</a>, and <a class="el" href="../../d3/d4/se_2capture_8c-source.html#l01850">SeCaptureSidAndAttributesArray()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a25" doxytag="ex.h::ProbeAndReadUlargeInteger" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ProbeAndReadUlargeInteger          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">Source&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div>(((Source) &gt;= (ULARGE_INTEGER * <span class="keyword">const</span>)MM_USER_PROBE_ADDRESS) ? \
        (*(<span class="keyword">volatile</span> ULARGE_INTEGER * <span class="keyword">const</span>)MM_USER_PROBE_ADDRESS) : (*(<span class="keyword">volatile</span> ULARGE_INTEGER *)(Source)))
</div></pre>
<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l01404">1404</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a20" doxytag="ex.h::ProbeAndReadUlong" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ProbeAndReadUlong          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">Address&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div>(((Address) &gt;= (ULONG * <span class="keyword">const</span>)MM_USER_PROBE_ADDRESS) ? \
        (*(<span class="keyword">volatile</span> ULONG * <span class="keyword">const</span>)MM_USER_PROBE_ADDRESS) : (*(<span class="keyword">volatile</span> ULONG *)(Address)))
</div></pre>
<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l01339">1339</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.
<p>
Referenced by <a class="el" href="../../d1/d4/ntuser_2kernel_2getset_8c-source.html#l00133">_SetWindowWord()</a>, <a class="el" href="../../d4/d4/i386_2trapc_8c-source.html#l00090">Ki386CheckDivideByZeroTrap()</a>, <a class="el" href="../../d9/d4/trigger_8c-source.html#l00244">KiLocateTriggerPc()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l10687">MESSAGECALL()</a>, <a class="el" href="../../d5/d5/lpccompl_8c-source.html#l00040">NtAcceptConnectPort()</a>, <a class="el" href="../../d3/d9/psctx_8c-source.html#l00151">NtGetContextThread()</a>, <a class="el" href="../../d8/d1/qsea_8c-source.html#l00035">NtQueryEaFile()</a>, <a class="el" href="../../d8/d6/ntapi_8c-source.html#l03461">NtQueryMultipleValueKey()</a>, <a class="el" href="../../d7/d4/io_2read_8c-source.html#l00036">NtReadFile()</a>, <a class="el" href="../../d7/d4/io_2read_8c-source.html#l00730">NtReadFileScatter()</a>, <a class="el" href="../../d6/d5/lpcconn_8c-source.html#l00084">NtSecureConnectPort()</a>, <a class="el" href="../../d3/d9/psctx_8c-source.html#l00352">NtSetContextThread()</a>, <a class="el" href="../../d1/d9/io_2write_8c-source.html#l00035">NtWriteFile()</a>, <a class="el" href="../../d1/d9/io_2write_8c-source.html#l00801">NtWriteFileGather()</a>, <a class="el" href="../../d6/d7/ntimm_8c-source.html#l02154">ProbeAndCaptureSoftKbdData()</a>, <a class="el" href="../../d1/d3/accessck_8c-source.html#l02704">SeAccessCheckByType()</a>, and <a class="el" href="../../d6/d7/ntimm_8c-source.html#l02461">xxxSendMessageToUI()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a21" doxytag="ex.h::ProbeAndReadUlong_ptr" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ProbeAndReadUlong_ptr          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">Address&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div>(((Address) &gt;= (ULONG_PTR * <span class="keyword">const</span>)MM_USER_PROBE_ADDRESS) ? \
        (*(<span class="keyword">volatile</span> ULONG_PTR * <span class="keyword">const</span>)MM_USER_PROBE_ADDRESS) : (*(<span class="keyword">volatile</span> ULONG_PTR *)(Address)))
</div></pre>
<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l01352">1352</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a26" doxytag="ex.h::ProbeAndReadUnicodeString" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ProbeAndReadUnicodeString          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">Source&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div>(((Source) &gt;= (UNICODE_STRING * <span class="keyword">const</span>)MM_USER_PROBE_ADDRESS) ? \
        (*(<span class="keyword">volatile</span> UNICODE_STRING * <span class="keyword">const</span>)MM_USER_PROBE_ADDRESS) : (*(<span class="keyword">volatile</span> UNICODE_STRING *)(Source)))
</div></pre>
<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l01417">1417</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.
<p>
Referenced by <a class="el" href="../../d1/d7/dir_8c-source.html#l00057">BuildQueryDirectoryIrp()</a>, <a class="el" href="../../d8/d6/ntapi_8c-source.html#l03603">CmpNameFromAttributes()</a>, <a class="el" href="../../d9/d8/cmapi_8c-source.html#l00940">CmQueryMultipleValueKey()</a>, <a class="el" href="../../d3/d3/libmgmt_8c-source.html#l00053">GetHmodTableIndex()</a>, <a class="el" href="../../d8/d6/ntapi_8c-source.html#l00166">NtCreateKey()</a>, <a class="el" href="../../d8/d6/ntapi_8c-source.html#l00504">NtDeleteValueKey()</a>, <a class="el" href="../../d9/d3/loadunld_8c-source.html#l00035">NtLoadDriver()</a>, <a class="el" href="../../d8/d6/ntapi_8c-source.html#l02881">NtLoadKey2()</a>, <a class="el" href="../../d8/d6/ntapi_8c-source.html#l01870">NtOpenKey()</a>, <a class="el" href="../../d8/d6/ntapi_8c-source.html#l02187">NtQueryValueKey()</a>, <a class="el" href="../../d8/d6/ntapi_8c-source.html#l02672">NtSetValueKey()</a>, <a class="el" href="../../d9/d3/loadunld_8c-source.html#l00244">NtUnloadDriver()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l00891">NtUserCreateWindowStation()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l09490">NtUserDrawCaptionTemp()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l07243">NtUserFindExistingCursorIcon()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l08767">NtUserFindWindowEx()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l08817">NtUserGetClassInfo()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l08904">NtUserGetClassName()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l01593">NtUserGetIconInfo()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l09022">NtUserGetKeyboardLayoutName()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l03023">NtUserGetWOWClass()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l03098">NtUserInitTask()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l08449">NtUserLoadKeyboardLayoutEx()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l01028">NtUserOpenWindowStation()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l09119">NtUserRegisterClassExWOW()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l09173">NtUserRegisterWindowMessage()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l01365">NtUserResolveDesktop()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l01303">NtUserResolveDesktopForWOW()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l02040">NtUserSetClassLongPtr()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l07305">NtUserSetCursorIconData()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l02400">NtUserSystemParametersInfo()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l04663">NtUserThunkedMenuItemInfo()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l09243">NtUserUnregisterClass()</a>, <a class="el" href="../../d7/d9/obcreate_8c-source.html#l00438">ObpCaptureObjectName()</a>, <a class="el" href="../../d4/d4/seaudit_8c-source.html#l00259">SepProbeAndCaptureString_U()</a>, <a class="el" href="../../d7/d2/queue_8c-source.html#l00814">SetAppCompatFlags()</a>, and <a class="el" href="../../d4/d3/vdm_2vdm_8c-source.html#l00087">VdmQueryDirectoryFile()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a23" doxytag="ex.h::ProbeAndReadUquad" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ProbeAndReadUquad          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">Address&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div>(((Address) &gt;= (UQUAD * <span class="keyword">const</span>)MM_USER_PROBE_ADDRESS) ? \
        (*(<span class="keyword">volatile</span> UQUAD * <span class="keyword">const</span>)MM_USER_PROBE_ADDRESS) : (*(<span class="keyword">volatile</span> UQUAD *)(Address)))
</div></pre>
<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l01378">1378</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a16" doxytag="ex.h::ProbeAndReadUshort" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ProbeAndReadUshort          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">Address&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div>(((Address) &gt;= (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a> * <span class="keyword">const</span>)MM_USER_PROBE_ADDRESS) ? \
        (*(<span class="keyword">volatile</span> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a> * <span class="keyword">const</span>)MM_USER_PROBE_ADDRESS) : (*(<span class="keyword">volatile</span> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a> *)(Address)))
</div></pre>
<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l01287">1287</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.
<p>
Referenced by <a class="el" href="../../d4/d4/i386_2trapc_8c-source.html#l00090">Ki386CheckDivideByZeroTrap()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l11344">MESSAGECALL()</a>, <a class="el" href="../../d3/d4/se_2capture_8c-source.html#l01370">SeCaptureAcl()</a>, and <a class="el" href="../../d3/d4/se_2capture_8c-source.html#l00053">SeCaptureSecurityDescriptor()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a44" doxytag="ex.h::ProbeAndWriteBoolean" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ProbeAndWriteBoolean          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">Address,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>Value&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div>{                               \
    <span class="keywordflow">if</span> ((Address) &gt;= (BOOLEAN * <span class="keyword">const</span>)MM_USER_PROBE_ADDRESS) {               \
        *(<span class="keyword">volatile</span> BOOLEAN * <span class="keyword">const</span>)MM_USER_PROBE_ADDRESS = 0;                \
    }                                                                        \
                                                                             \
    *(Address) = (Value);                                                    \
}
</div></pre>
<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l01721">1721</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a45" doxytag="ex.h::ProbeAndWriteChar" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ProbeAndWriteChar          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">Address,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>Value&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div>{                                  \
    <span class="keywordflow">if</span> ((Address) &gt;= (<a class="code" href="../../d1/d1/bench_8c.html#a16">CHAR</a> * <span class="keyword">const</span>)MM_USER_PROBE_ADDRESS) {                  \
        *(<span class="keyword">volatile</span> <a class="code" href="../../d1/d1/bench_8c.html#a16">CHAR</a> * <span class="keyword">const</span>)MM_USER_PROBE_ADDRESS = 0;                   \
    }                                                                        \
                                                                             \
    *(Address) = (Value);                                                    \
}
</div></pre>
<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l01739">1739</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a49" doxytag="ex.h::ProbeAndWriteHandle" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ProbeAndWriteHandle          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">Address,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>Value&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div>{                                \
    <span class="keywordflow">if</span> ((Address) &gt;= (HANDLE * <span class="keyword">const</span>)MM_USER_PROBE_ADDRESS) {                \
        *(<span class="keyword">volatile</span> HANDLE * <span class="keyword">const</span>)MM_USER_PROBE_ADDRESS = 0;                 \
    }                                                                        \
                                                                             \
    *(Address) = (Value);                                                    \
}
</div></pre>
<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l01811">1811</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.
<p>
Referenced by <a class="el" href="../../d5/d5/iosubs_8c-source.html#l04502">IoCreateFile()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l02888">NtUserDdeInitialize()</a>, and <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l01365">NtUserResolveDesktop()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a50" doxytag="ex.h::ProbeAndWriteLong" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ProbeAndWriteLong          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">Address,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>Value&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div>{                                  \
    <span class="keywordflow">if</span> ((Address) &gt;= (LONG * <span class="keyword">const</span>)MM_USER_PROBE_ADDRESS) {                  \
        *(<span class="keyword">volatile</span> LONG * <span class="keyword">const</span>)MM_USER_PROBE_ADDRESS = 0;                   \
    }                                                                        \
                                                                             \
    *(Address) = (Value);                                                    \
}
</div></pre>
<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l01829">1829</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.
<p>
Referenced by <a class="el" href="../../d0/d1/psquery_8c-source.html#l03103">NtSetInformationThread()</a>, and <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l01669">NtUserGetIconSize()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a52" doxytag="ex.h::ProbeAndWriteQuad" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ProbeAndWriteQuad          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">Address,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>Value&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div>{                                  \
    <span class="keywordflow">if</span> ((Address) &gt;= (QUAD * <span class="keyword">const</span>)MM_USER_PROBE_ADDRESS) {                  \
        *(<span class="keyword">volatile</span> LONG * <span class="keyword">const</span>)MM_USER_PROBE_ADDRESS = 0;                   \
    }                                                                        \
                                                                             \
    *(Address) = (Value);                                                    \
}
</div></pre>
<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l01865">1865</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a47" doxytag="ex.h::ProbeAndWriteShort" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ProbeAndWriteShort          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">Address,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>Value&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div>{                                 \
    <span class="keywordflow">if</span> ((Address) &gt;= (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a> * <span class="keyword">const</span>)MM_USER_PROBE_ADDRESS) {                 \
        *(<span class="keyword">volatile</span> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a> * <span class="keyword">const</span>)MM_USER_PROBE_ADDRESS = 0;                  \
    }                                                                        \
                                                                             \
    *(Address) = (Value);                                                    \
}
</div></pre>
<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l01775">1775</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a54" doxytag="ex.h::ProbeAndWriteStructure" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ProbeAndWriteStructure          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">Address,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>Value,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>STRUCTURE&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div>{                   \
    <span class="keywordflow">if</span> ((STRUCTURE * <span class="keyword">const</span>)(Address) &gt;= (STRUCTURE * <span class="keyword">const</span>)MM_USER_PROBE_ADDRESS) {    \
        *(<span class="keyword">volatile</span> ULONG * <span class="keyword">const</span>)MM_USER_PROBE_ADDRESS = 0;                  \
    }                                                                        \
                                                                             \
    *(Address) = (Value);                                                    \
}
</div></pre>
<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l01902">1902</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.
<p>
Referenced by <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l10947">MESSAGECALL()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l06520">NtUserBeginPaint()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l04050">NtUserGetClipboardData()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l07381">NtUserGetMenuItemRect()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l01888">NtUserGetMessage()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l05245">NtUserGetUpdateRect()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l05432">NtUserMNDragOver()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l05514">NtUserPeekMessage()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l06824">NtUserScrollDC()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l05740">NtUserScrollWindowEx()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l02040">NtUserSetClassLongPtr()</a>, and <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l09243">NtUserUnregisterClass()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a46" doxytag="ex.h::ProbeAndWriteUchar" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ProbeAndWriteUchar          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">Address,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>Value&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div>{                                 \
    <span class="keywordflow">if</span> ((Address) &gt;= (UCHAR * <span class="keyword">const</span>)MM_USER_PROBE_ADDRESS) {                 \
        *(<span class="keyword">volatile</span> UCHAR * <span class="keyword">const</span>)MM_USER_PROBE_ADDRESS = 0;                  \
    }                                                                        \
                                                                             \
    *(Address) = (Value);                                                    \
}
</div></pre>
<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l01757">1757</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a51" doxytag="ex.h::ProbeAndWriteUlong" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ProbeAndWriteUlong          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">Address,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>Value&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div>{                                 \
    <span class="keywordflow">if</span> ((Address) &gt;= (ULONG * <span class="keyword">const</span>)MM_USER_PROBE_ADDRESS) {                 \
        *(<span class="keyword">volatile</span> ULONG * <span class="keyword">const</span>)MM_USER_PROBE_ADDRESS = 0;                  \
    }                                                                        \
                                                                             \
    *(Address) = (Value);                                                    \
}
</div></pre>
<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l01847">1847</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.
<p>
Referenced by <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l09856">MESSAGECALL()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l03336">NtUserCreateLocalMemHandle()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l02888">NtUserDdeInitialize()</a>, and <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l05481">NtUserOpenClipboard()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a53" doxytag="ex.h::ProbeAndWriteUquad" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ProbeAndWriteUquad          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">Address,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>Value&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div>{                                 \
    <span class="keywordflow">if</span> ((Address) &gt;= (UQUAD * <span class="keyword">const</span>)MM_USER_PROBE_ADDRESS) {                 \
        *(<span class="keyword">volatile</span> ULONG * <span class="keyword">const</span>)MM_USER_PROBE_ADDRESS = 0;                  \
    }                                                                        \
                                                                             \
    *(Address) = (Value);                                                    \
}
</div></pre>
<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l01883">1883</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a48" doxytag="ex.h::ProbeAndWriteUshort" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ProbeAndWriteUshort          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">Address,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>Value&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div>{                                \
    <span class="keywordflow">if</span> ((Address) &gt;= (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a> * <span class="keyword">const</span>)MM_USER_PROBE_ADDRESS) {                \
        *(<span class="keyword">volatile</span> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a> * <span class="keyword">const</span>)MM_USER_PROBE_ADDRESS = 0;                 \
    }                                                                        \
                                                                             \
    *(Address) = (Value);                                                    \
}
</div></pre>
<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l01793">1793</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.
<p>
Referenced by <a class="el" href="../../d4/d4/i386_2trapc_8c-source.html#l00309">Ki386CheckDelayedNpxTrap()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a36" doxytag="ex.h::ProbeAndZeroHandle" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ProbeAndZeroHandle          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">Address&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div>{                                        \
    <span class="keywordflow">if</span> ((Address) &gt;= (HANDLE * <span class="keyword">const</span>)MM_USER_PROBE_ADDRESS) {                \
        *(<span class="keyword">volatile</span> HANDLE * <span class="keyword">const</span>)MM_USER_PROBE_ADDRESS = 0;                 \
    }                                                                        \
                                                                             \
    *(<span class="keyword">volatile</span> HANDLE *)(Address) = 0;                                       \
}
</div></pre>
<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l01581">1581</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.
<p>
Referenced by <a class="el" href="../../d5/d5/channel_8c-source.html#l00101">NtCreateChannel()</a>, <a class="el" href="../../d8/d6/ntapi_8c-source.html#l00166">NtCreateKey()</a>, <a class="el" href="../../d5/d5/channel_8c-source.html#l00348">NtOpenChannel()</a>, and <a class="el" href="../../d8/d6/ntapi_8c-source.html#l01870">NtOpenKey()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a11" doxytag="ex.h::ProbeForRead" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ProbeForRead          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">Address,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>Length,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>Alignment&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div><a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(((Alignment) == 1) || ((Alignment) == 2) ||                       \
           ((Alignment) == 4) || ((Alignment) == 8) ||                       \
           ((Alignment) == 16));                                             \
                                                                             \
    <span class="keywordflow">if</span> ((Length) != 0) {                                                     \
        <span class="keywordflow">if</span> (((ULONG_PTR)(Address) &amp; ((Alignment) - 1)) != 0) {                   \
            <a class="code" href="../../d9/d3/raise_8c.html#a1">ExRaiseDatatypeMisalignment</a>();                                   \
                                                                             \
        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((((ULONG_PTR)(Address) + (Length)) &lt; (ULONG_PTR)(Address)) ||                                  \
                   (((ULONG_PTR)(Address) + (Length)) &gt; (ULONG_PTR)MM_USER_PROBE_ADDRESS)) { \
            <a class="code" href="../../d9/d3/raise_8c.html#a0">ExRaiseAccessViolation</a>();                                        \
        }                                                                    \
    }
</div></pre>
<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l01209">1209</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.
<p>
Referenced by <a class="el" href="../../d7/d6/winable2_8c-source.html#l00778">_GetComboBoxInfo()</a>, <a class="el" href="../../d7/d6/winable2_8c-source.html#l00946">_GetListBoxInfo()</a>, <a class="el" href="../../d1/d7/dir_8c-source.html#l00057">BuildQueryDirectoryIrp()</a>, <a class="el" href="../../d8/d6/ntapi_8c-source.html#l03603">CmpNameFromAttributes()</a>, <a class="el" href="../../d9/d8/cmapi_8c-source.html#l00940">CmQueryMultipleValueKey()</a>, <a class="el" href="../../d4/d4/ssend_8c-source.html#l00922">CopyOutputString()</a>, <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l02743">InitAnsiOem()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l04502">IoCreateFile()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l06326">IopSetEaOrQuotaInformationFile()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l08084">IopXxxControlFile()</a>, <a class="el" href="../../d9/d7/i386_2kdtrap_8c-source.html#l00038">KdpTrap()</a>, <a class="el" href="../../d6/d3/raisexcp_8c-source.html#l00037">KiContinuePreviousModeUser()</a>, <a class="el" href="../../d3/d1/byteem_8c-source.html#l00049">KiEmulateByteWord()</a>, <a class="el" href="../../d5/d4/alpha_2alignem_8c-source.html#l00160">KiEmulateReference()</a>, <a class="el" href="../../d6/d3/raisexcp_8c-source.html#l00208">KiRaiseException()</a>, <a class="el" href="../../d6/d6/lpcreply_8c-source.html#l00915">LpcpCopyRequestData()</a>, <a class="el" href="../../d7/d5/lpccreat_8c-source.html#l00136">LpcpCreatePort()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l09976">MESSAGECALL()</a>, <a class="el" href="../../d6/d2/acceschk_8c-source.html#l00194">MiCheckForUserStackOverflow()</a>, <a class="el" href="../../d0/d5/readwrt_8c-source.html#l00529">MiDoMappedCopy()</a>, <a class="el" href="../../d0/d5/readwrt_8c-source.html#l00758">MiDoPoolCopy()</a>, <a class="el" href="../../d5/d4/procsup_8c-source.html#l04631">MmCreatePeb()</a>, <a class="el" href="../../d5/d5/lpccompl_8c-source.html#l00040">NtAcceptConnectPort()</a>, <a class="el" href="../../d7/d7/exatom_8c-source.html#l00045">NtAddAtom()</a>, <a class="el" href="../../d6/d2/tokenadj_8c-source.html#l00432">NtAdjustGroupsToken()</a>, <a class="el" href="../../d6/d2/tokenadj_8c-source.html#l00046">NtAdjustPrivilegesToken()</a>, <a class="el" href="../../d8/d6/ntapi_8c-source.html#l00166">NtCreateKey()</a>, <a class="el" href="../../d2/d7/io_2create_8c-source.html#l00285">NtCreateMailslotFile()</a>, <a class="el" href="../../d2/d7/io_2create_8c-source.html#l00125">NtCreateNamedPipeFile()</a>, <a class="el" href="../../d7/d2/modwrite_8c-source.html#l00297">NtCreatePagingFile()</a>, <a class="el" href="../../d1/d7/creasect_8c-source.html#l00134">NtCreateSection()</a>, <a class="el" href="../../d5/d0/oblink_8c-source.html#l00052">NtCreateSymbolicLinkObject()</a>, <a class="el" href="../../d3/d7/ps_2create_8c-source.html#l00067">NtCreateThread()</a>, <a class="el" href="../../d5/d2/token_8c-source.html#l01690">NtCreateToken()</a>, <a class="el" href="../../d8/d5/delay_8c-source.html#l00033">NtDelayExecution()</a>, <a class="el" href="../../d8/d6/ntapi_8c-source.html#l00504">NtDeleteValueKey()</a>, <a class="el" href="../../d7/d2/tokendup_8c-source.html#l01306">NtFilterToken()</a>, <a class="el" href="../../d7/d7/exatom_8c-source.html#l00152">NtFindAtom()</a>, <a class="el" href="../../d6/d4/flushbuf_8c-source.html#l00142">NtFlushInstructionCache()</a>, <a class="el" href="../../d9/d4/physical_8c-source.html#l01624">NtFreeUserPhysicalPages()</a>, <a class="el" href="../../d2/d6/lpcpriv_8c-source.html#l00032">NtImpersonateClientOfPort()</a>, <a class="el" href="../../d0/d0/psimpers_8c-source.html#l00026">NtImpersonateThread()</a>, <a class="el" href="../../d9/d3/loadunld_8c-source.html#l00035">NtLoadDriver()</a>, <a class="el" href="../../d8/d6/ntapi_8c-source.html#l02881">NtLoadKey2()</a>, <a class="el" href="../../d2/d4/lock_8c-source.html#l00035">NtLockFile()</a>, <a class="el" href="../../d9/d4/physical_8c-source.html#l00085">NtMapUserPhysicalPages()</a>, <a class="el" href="../../d9/d4/physical_8c-source.html#l00498">NtMapUserPhysicalPagesScatter()</a>, <a class="el" href="../../d8/d6/ntapi_8c-source.html#l01870">NtOpenKey()</a>, <a class="el" href="../../d4/d4/seaudit_8c-source.html#l02072">NtOpenObjectAuditAlarm()</a>, <a class="el" href="../../d8/d0/psopen_8c-source.html#l00030">NtOpenProcess()</a>, <a class="el" href="../../d8/d0/psopen_8c-source.html#l00280">NtOpenThread()</a>, <a class="el" href="../../d4/d4/seaudit_8c-source.html#l00731">NtPrivilegedServiceAuditAlarm()</a>, <a class="el" href="../../d4/d4/seaudit_8c-source.html#l00406">NtPrivilegeObjectAuditAlarm()</a>, <a class="el" href="../../d8/d1/qsea_8c-source.html#l00035">NtQueryEaFile()</a>, <a class="el" href="../../d1/d2/qsquota_8c-source.html#l00035">NtQueryQuotaInformationFile()</a>, <a class="el" href="../../d5/d0/oblink_8c-source.html#l00333">NtQuerySymbolicLinkObject()</a>, <a class="el" href="../../d6/d7/sysenv_8c-source.html#l00045">NtQuerySystemEnvironmentValue()</a>, <a class="el" href="../../d8/d6/ntapi_8c-source.html#l02187">NtQueryValueKey()</a>, <a class="el" href="../../d7/d7/ex_2harderr_8c-source.html#l00532">NtRaiseHardError()</a>, <a class="el" href="../../d7/d4/io_2read_8c-source.html#l00036">NtReadFile()</a>, <a class="el" href="../../d7/d4/io_2read_8c-source.html#l00730">NtReadFileScatter()</a>, <a class="el" href="../../d6/d6/lpcreply_8c-source.html#l00044">NtReplyPort()</a>, <a class="el" href="../../d5/d6/lpcrecv_8c-source.html#l00029">NtReplyWaitReceivePort()</a>, <a class="el" href="../../d5/d6/lpcrecv_8c-source.html#l00635">NtReplyWaitReceivePortEx()</a>, <a class="el" href="../../d5/d5/channel_8c-source.html#l00525">NtReplyWaitSendChannel()</a>, <a class="el" href="../../d7/d6/lpcsend_8c-source.html#l00032">NtRequestPort()</a>, <a class="el" href="../../d7/d6/lpcsend_8c-source.html#l00395">NtRequestWaitReplyPort()</a>, <a class="el" href="../../d5/d5/channel_8c-source.html#l00807">NtSendWaitReplyChannel()</a>, <a class="el" href="../../d3/d9/psctx_8c-source.html#l00352">NtSetContextThread()</a>, <a class="el" href="../../d8/d1/qsea_8c-source.html#l00652">NtSetEaFile()</a>, <a class="el" href="../../d0/d2/qsinfo_8c-source.html#l00849">NtSetInformationFile()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l01323">NtSetInformationJobObject()</a>, <a class="el" href="../../d7/d0/obquery_8c-source.html#l00545">NtSetInformationObject()</a>, <a class="el" href="../../d0/d1/psquery_8c-source.html#l01510">NtSetInformationProcess()</a>, <a class="el" href="../../d0/d1/psquery_8c-source.html#l03103">NtSetInformationThread()</a>, <a class="el" href="../../d1/d3/tokenset_8c-source.html#l00037">NtSetInformationToken()</a>, <a class="el" href="../../d6/d7/sysenv_8c-source.html#l00305">NtSetSystemEnvironmentValue()</a>, <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l02264">NtSetSystemInformation()</a>, <a class="el" href="../../d3/d1/timer_8c-source.html#l00960">NtSetTimer()</a>, <a class="el" href="../../d4/d2/uuid_8c-source.html#l00532">NtSetUuidSeed()</a>, <a class="el" href="../../d8/d6/ntapi_8c-source.html#l02672">NtSetValueKey()</a>, <a class="el" href="../../d9/d1/qsfs_8c-source.html#l00492">NtSetVolumeInformationFile()</a>, <a class="el" href="../../d3/d2/dbgctrl_8c-source.html#l00036">NtSystemDebugControl()</a>, <a class="el" href="../../d9/d3/loadunld_8c-source.html#l00244">NtUnloadDriver()</a>, <a class="el" href="../../d2/d4/lock_8c-source.html#l00458">NtUnlockFile()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l03310">NtUserConvertMemHandle()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l01173">NtUserCreateDesktop()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l08087">NtUserCreateWindowEx()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l00615">NtUserCtxDisplayIOCtl()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l07490">NtUserDefSetText()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l09490">NtUserDrawCaptionTemp()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l02956">NtUserEvent()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l12075">NtUserfnHkINLPCBTCREATESTRUCT()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l12235">NtUserfnHkINLPDEBUGHOOKSTRUCT()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l01508">NtUserInitializeClientPfnArrays()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l08449">NtUserLoadKeyboardLayoutEx()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l13179">NtUserQueryUserCounters()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l09119">NtUserRegisterClassExWOW()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l00521">NtUserRemoteConnect()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l09719">NtUserSBGetParms()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l07305">NtUserSetCursorIconData()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l12800">NtUserSetImeInfoEx()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l07606">NtUserSetInformationProcess()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l07575">NtUserSetInformationThread()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l02160">NtUserSetKeyboardState()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l00831">NtUserSetObjectInformation()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l07110">NtUserSetWindowStationUser()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l02400">NtUserSystemParametersInfo()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l06953">NtUserToUnicodeEx()</a>, <a class="el" href="../../d6/d3/vdmentry_8c-source.html#l00051">NtVdmControl()</a>, <a class="el" href="../../d2/d1/obwait_8c-source.html#l00406">NtWaitForMultipleObjects()</a>, <a class="el" href="../../d1/d9/io_2write_8c-source.html#l00035">NtWriteFile()</a>, <a class="el" href="../../d1/d9/io_2write_8c-source.html#l00801">NtWriteFileGather()</a>, <a class="el" href="../../d7/d9/obcreate_8c-source.html#l00248">ObpCaptureObjectCreateInformation()</a>, <a class="el" href="../../d7/d9/obcreate_8c-source.html#l00438">ObpCaptureObjectName()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l02680">PspCaptureTokenFilter()</a>, <a class="el" href="../../d9/d9/psdelete_8c-source.html#l00690">PspExitThread()</a>, <a class="el" href="../../d6/d9/psctxi64_8c-source.html#l00304">PspSetContext()</a>, <a class="el" href="../../d1/d3/accessck_8c-source.html#l02704">SeAccessCheckByType()</a>, <a class="el" href="../../d3/d4/se_2capture_8c-source.html#l01370">SeCaptureAcl()</a>, <a class="el" href="../../d3/d4/se_2capture_8c-source.html#l01608">SeCaptureLuidAndAttributesArray()</a>, <a class="el" href="../../d1/d3/accessck_8c-source.html#l00144">SeCaptureObjectTypeList()</a>, <a class="el" href="../../d3/d4/se_2capture_8c-source.html#l00053">SeCaptureSecurityDescriptor()</a>, <a class="el" href="../../d3/d4/se_2capture_8c-source.html#l00953">SeCaptureSecurityQos()</a>, <a class="el" href="../../d3/d4/se_2capture_8c-source.html#l01141">SeCaptureSid()</a>, <a class="el" href="../../d3/d4/se_2capture_8c-source.html#l01850">SeCaptureSidAndAttributesArray()</a>, <a class="el" href="../../d4/d4/seaudit_8c-source.html#l01050">SepAccessCheckAndAuditAlarm()</a>, <a class="el" href="../../d3/d4/se_2capture_8c-source.html#l00773">SepProbeAndCaptureQosData()</a>, <a class="el" href="../../d4/d4/seaudit_8c-source.html#l00259">SepProbeAndCaptureString_U()</a>, <a class="el" href="../../d7/d2/queue_8c-source.html#l00814">SetAppCompatFlags()</a>, <a class="el" href="../../d0/d4/vdmints_8c-source.html#l01235">VdmpDelayInterrupt()</a>, <a class="el" href="../../d8/d3/vdminit_8c-source.html#l00019">VdmpInitialize()</a>, <a class="el" href="../../d5/d4/vdmprint_8c-source.html#l00388">VdmpPrinterDirectIoClose()</a>, and <a class="el" href="../../d4/d3/vdm_2vdm_8c-source.html#l00087">VdmQueryDirectoryFile()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a28" doxytag="ex.h::ProbeForWriteBoolean" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ProbeForWriteBoolean          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">Address&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div>{                                      \
    <span class="keywordflow">if</span> ((Address) &gt;= (BOOLEAN * <span class="keyword">const</span>)MM_USER_PROBE_ADDRESS) {               \
        *(<span class="keyword">volatile</span> BOOLEAN * <span class="keyword">const</span>)MM_USER_PROBE_ADDRESS = 0;                \
    }                                                                        \
                                                                             \
    *(<span class="keyword">volatile</span> BOOLEAN *)(Address) = *(<span class="keyword">volatile</span> BOOLEAN *)(Address);         \
}
</div></pre>
<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l01447">1447</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.
<p>
Referenced by <a class="el" href="../../d3/d1/timer_8c-source.html#l00679">NtCancelTimer()</a>, <a class="el" href="../../d4/d4/seaudit_8c-source.html#l02072">NtOpenObjectAuditAlarm()</a>, <a class="el" href="../../d9/d3/privileg_8c-source.html#l00231">NtPrivilegeCheck()</a>, <a class="el" href="../../d3/d1/timer_8c-source.html#l00960">NtSetTimer()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l07532">NtUserQueryInformationThread()</a>, <a class="el" href="../../d6/d3/vdmentry_8c-source.html#l00051">NtVdmControl()</a>, and <a class="el" href="../../d4/d4/seaudit_8c-source.html#l01050">SepAccessCheckAndAuditAlarm()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a29" doxytag="ex.h::ProbeForWriteChar" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ProbeForWriteChar          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">Address&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div>{                                         \
    <span class="keywordflow">if</span> ((Address) &gt;= (<a class="code" href="../../d1/d1/bench_8c.html#a16">CHAR</a> * <span class="keyword">const</span>)MM_USER_PROBE_ADDRESS) {                  \
        *(<span class="keyword">volatile</span> <a class="code" href="../../d1/d1/bench_8c.html#a16">CHAR</a> * <span class="keyword">const</span>)MM_USER_PROBE_ADDRESS = 0;                   \
    }                                                                        \
                                                                             \
    *(<span class="keyword">volatile</span> <a class="code" href="../../d1/d1/bench_8c.html#a16">CHAR</a> *)(Address) = *(<span class="keyword">volatile</span> <a class="code" href="../../d1/d1/bench_8c.html#a16">CHAR</a> *)(Address);               \
}
</div></pre>
<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l01464">1464</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.
<p>
Referenced by <a class="el" href="../../d6/d5/iosup_8c-source.html#l00238">MmProbeAndLockPages()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a35" doxytag="ex.h::ProbeForWriteHandle" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ProbeForWriteHandle          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">Address&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div>{                                       \
    <span class="keywordflow">if</span> ((Address) &gt;= (HANDLE * <span class="keyword">const</span>)MM_USER_PROBE_ADDRESS) {                \
        *(<span class="keyword">volatile</span> HANDLE * <span class="keyword">const</span>)MM_USER_PROBE_ADDRESS = 0;                 \
    }                                                                        \
                                                                             \
    *(<span class="keyword">volatile</span> HANDLE *)(Address) = *(<span class="keyword">volatile</span> HANDLE *)(Address);           \
}
</div></pre>
<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l01564">1564</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.
<p>
Referenced by <a class="el" href="../../d7/d5/lpccreat_8c-source.html#l00136">LpcpCreatePort()</a>, <a class="el" href="../../d5/d5/lpccompl_8c-source.html#l00040">NtAcceptConnectPort()</a>, <a class="el" href="../../d9/d9/obdir_8c-source.html#l00032">NtCreateDirectoryObject()</a>, <a class="el" href="../../d1/d7/ex_2event_8c-source.html#l00180">NtCreateEvent()</a>, <a class="el" href="../../d4/d7/eventpr_8c-source.html#l00131">NtCreateEventPair()</a>, <a class="el" href="../../d6/d3/complete_8c-source.html#l00051">NtCreateIoCompletion()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l00048">NtCreateJobObject()</a>, <a class="el" href="../../d3/d4/mutant_8c-source.html#l00156">NtCreateMutant()</a>, <a class="el" href="../../d3/d7/ps_2create_8c-source.html#l00843">NtCreateProcess()</a>, <a class="el" href="../../d0/d6/ex_2profile_8c-source.html#l00199">NtCreateProfile()</a>, <a class="el" href="../../d1/d7/creasect_8c-source.html#l00134">NtCreateSection()</a>, <a class="el" href="../../d3/d5/semphore_8c-source.html#l00123">NtCreateSemaphore()</a>, <a class="el" href="../../d2/d7/super_8c-source.html#l00056">NtCreateSuperSection()</a>, <a class="el" href="../../d5/d0/oblink_8c-source.html#l00052">NtCreateSymbolicLinkObject()</a>, <a class="el" href="../../d3/d7/ps_2create_8c-source.html#l00067">NtCreateThread()</a>, <a class="el" href="../../d3/d1/timer_8c-source.html#l00444">NtCreateTimer()</a>, <a class="el" href="../../d5/d2/token_8c-source.html#l01690">NtCreateToken()</a>, <a class="el" href="../../d0/d0/obhandle_8c-source.html#l00163">NtDuplicateObject()</a>, <a class="el" href="../../d7/d2/tokendup_8c-source.html#l00046">NtDuplicateToken()</a>, <a class="el" href="../../d7/d2/tokendup_8c-source.html#l01306">NtFilterToken()</a>, <a class="el" href="../../d9/d9/obdir_8c-source.html#l00144">NtOpenDirectoryObject()</a>, <a class="el" href="../../d1/d7/ex_2event_8c-source.html#l00313">NtOpenEvent()</a>, <a class="el" href="../../d4/d7/eventpr_8c-source.html#l00251">NtOpenEventPair()</a>, <a class="el" href="../../d6/d3/complete_8c-source.html#l00178">NtOpenIoCompletion()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l00188">NtOpenJobObject()</a>, <a class="el" href="../../d3/d4/mutant_8c-source.html#l00280">NtOpenMutant()</a>, <a class="el" href="../../d8/d0/psopen_8c-source.html#l00030">NtOpenProcess()</a>, <a class="el" href="../../d8/d2/tokenopn_8c-source.html#l00178">NtOpenProcessToken()</a>, <a class="el" href="../../d1/d7/creasect_8c-source.html#l04250">NtOpenSection()</a>, <a class="el" href="../../d3/d5/semphore_8c-source.html#l00260">NtOpenSemaphore()</a>, <a class="el" href="../../d2/d7/super_8c-source.html#l00237">NtOpenSuperSection()</a>, <a class="el" href="../../d5/d0/oblink_8c-source.html#l00247">NtOpenSymbolicLinkObject()</a>, <a class="el" href="../../d8/d0/psopen_8c-source.html#l00280">NtOpenThread()</a>, <a class="el" href="../../d8/d2/tokenopn_8c-source.html#l00458">NtOpenThreadToken()</a>, <a class="el" href="../../d3/d1/timer_8c-source.html#l00581">NtOpenTimer()</a>, <a class="el" href="../../d6/d5/lpcconn_8c-source.html#l00084">NtSecureConnectPort()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l12826">NtUserGetImeHotKey()</a>, and <a class="el" href="../../d8/d3/vdminit_8c-source.html#l00019">VdmpInitialize()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a31" doxytag="ex.h::ProbeForWriteIoStatus" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ProbeForWriteIoStatus          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">Address&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div>{                                     \
    <span class="keywordflow">if</span> ((Address) &gt;= (IO_STATUS_BLOCK * <span class="keyword">const</span>)MM_USER_PROBE_ADDRESS) {       \
        *(<span class="keyword">volatile</span> ULONG * <span class="keyword">const</span>)MM_USER_PROBE_ADDRESS = 0;                  \
    }                                                                        \
                                                                             \
    *(<span class="keyword">volatile</span> IO_STATUS_BLOCK *)(Address) = *(<span class="keyword">volatile</span> IO_STATUS_BLOCK *)(Address); \
}
</div></pre>
<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l01498">1498</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.
<p>
Referenced by <a class="el" href="../../d5/d5/iosubs_8c-source.html#l04502">IoCreateFile()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l06326">IopSetEaOrQuotaInformationFile()</a>, <a class="el" href="../../d2/d9/io_2misc_8c-source.html#l00049">NtCancelIoFile()</a>, <a class="el" href="../../d2/d9/io_2misc_8c-source.html#l00386">NtFlushBuffersFile()</a>, <a class="el" href="../../d7/d4/flushsec_8c-source.html#l00055">NtFlushVirtualMemory()</a>, <a class="el" href="../../d8/d1/qsea_8c-source.html#l00035">NtQueryEaFile()</a>, <a class="el" href="../../d0/d2/qsinfo_8c-source.html#l00101">NtQueryInformationFile()</a>, <a class="el" href="../../d1/d2/qsquota_8c-source.html#l00035">NtQueryQuotaInformationFile()</a>, <a class="el" href="../../d9/d1/qsfs_8c-source.html#l00037">NtQueryVolumeInformationFile()</a>, <a class="el" href="../../d6/d3/complete_8c-source.html#l00485">NtRemoveIoCompletion()</a>, <a class="el" href="../../d8/d1/qsea_8c-source.html#l00652">NtSetEaFile()</a>, <a class="el" href="../../d0/d2/qsinfo_8c-source.html#l00849">NtSetInformationFile()</a>, <a class="el" href="../../d9/d1/qsfs_8c-source.html#l00492">NtSetVolumeInformationFile()</a>, and <a class="el" href="../../d2/d4/lock_8c-source.html#l00458">NtUnlockFile()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a32" doxytag="ex.h::ProbeForWriteIoStatusEx" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ProbeForWriteIoStatusEx          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">Address,         <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>Cookie&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;ProbeForWriteIoStatus(Address)</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l01518">1518</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.
<p>
Referenced by <a class="el" href="../../d1/d7/dir_8c-source.html#l00057">BuildQueryDirectoryIrp()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l08084">IopXxxControlFile()</a>, <a class="el" href="../../d2/d4/lock_8c-source.html#l00035">NtLockFile()</a>, <a class="el" href="../../d1/d7/dir_8c-source.html#l00821">NtNotifyChangeDirectoryFile()</a>, <a class="el" href="../../d7/d4/io_2read_8c-source.html#l00036">NtReadFile()</a>, <a class="el" href="../../d7/d4/io_2read_8c-source.html#l00730">NtReadFileScatter()</a>, <a class="el" href="../../d1/d9/io_2write_8c-source.html#l00035">NtWriteFile()</a>, and <a class="el" href="../../d1/d9/io_2write_8c-source.html#l00801">NtWriteFileGather()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a39" doxytag="ex.h::ProbeForWriteLong" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ProbeForWriteLong          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">Address&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div>{                                        \
    <span class="keywordflow">if</span> ((Address) &gt;= (LONG * <span class="keyword">const</span>)MM_USER_PROBE_ADDRESS) {                 \
        *(<span class="keyword">volatile</span> LONG * <span class="keyword">const</span>)MM_USER_PROBE_ADDRESS = 0;                  \
    }                                                                       \
                                                                            \
    *(<span class="keyword">volatile</span> LONG *)(Address) = *(<span class="keyword">volatile</span> LONG *)(Address);              \
}
</div></pre>
<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l01632">1632</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.
<p>
Referenced by <a class="el" href="../../d1/d7/ex_2event_8c-source.html#l00412">NtPulseEvent()</a>, <a class="el" href="../../d3/d4/mutant_8c-source.html#l00521">NtReleaseMutant()</a>, <a class="el" href="../../d3/d5/semphore_8c-source.html#l00494">NtReleaseSemaphore()</a>, <a class="el" href="../../d1/d7/ex_2event_8c-source.html#l00648">NtResetEvent()</a>, <a class="el" href="../../d1/d7/ex_2event_8c-source.html#l00748">NtSetEvent()</a>, and <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l07184">NtUserGetCursorFrameInfo()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a37" doxytag="ex.h::ProbeForWritePointer" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ProbeForWritePointer          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">Address&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div>{                                      \
    <span class="keywordflow">if</span> ((PVOID *)(Address) &gt;= (PVOID * <span class="keyword">const</span>)MM_USER_PROBE_ADDRESS) {        \
        *(<span class="keyword">volatile</span> PVOID * <span class="keyword">const</span>)MM_USER_PROBE_ADDRESS = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;               \
    }                                                                        \
                                                                             \
    *(<span class="keyword">volatile</span> PVOID *)(Address) = *(<span class="keyword">volatile</span> PVOID *)(Address);             \
}
</div></pre>
<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l01598">1598</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.
<p>
Referenced by <a class="el" href="../../d9/d4/physical_8c-source.html#l00970">NtAllocateUserPhysicalPages()</a>, <a class="el" href="../../d4/d5/allocvm_8c-source.html#l00075">NtAllocateVirtualMemory()</a>, <a class="el" href="../../d7/d4/flushsec_8c-source.html#l00055">NtFlushVirtualMemory()</a>, <a class="el" href="../../d9/d4/physical_8c-source.html#l01624">NtFreeUserPhysicalPages()</a>, <a class="el" href="../../d4/d6/freevm_8c-source.html#l00066">NtFreeVirtualMemory()</a>, <a class="el" href="../../d4/d4/lockvm_8c-source.html#l00033">NtLockVirtualMemory()</a>, <a class="el" href="../../d4/d4/mapview_8c-source.html#l00199">NtMapViewOfSection()</a>, <a class="el" href="../../d1/d8/protect_8c-source.html#l00069">NtProtectVirtualMemory()</a>, and <a class="el" href="../../d4/d4/lockvm_8c-source.html#l00605">NtUnlockVirtualMemory()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a42" doxytag="ex.h::ProbeForWriteQuad" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ProbeForWriteQuad          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">Address&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div>{                                         \
    <span class="keywordflow">if</span> ((Address) &gt;= (QUAD * <span class="keyword">const</span>)MM_USER_PROBE_ADDRESS) {                  \
        *(<span class="keyword">volatile</span> LONG * <span class="keyword">const</span>)MM_USER_PROBE_ADDRESS = 0;                   \
    }                                                                        \
                                                                             \
    *(<span class="keyword">volatile</span> QUAD *)(Address) = *(<span class="keyword">volatile</span> QUAD *)(Address);               \
}
</div></pre>
<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l01683">1683</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a33" doxytag="ex.h::ProbeForWriteShort" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ProbeForWriteShort          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">Address&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div>{                                        \
    <span class="keywordflow">if</span> ((Address) &gt;= (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a> * <span class="keyword">const</span>)MM_USER_PROBE_ADDRESS) {                 \
        *(<span class="keyword">volatile</span> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a> * <span class="keyword">const</span>)MM_USER_PROBE_ADDRESS = 0;                  \
    }                                                                        \
                                                                             \
    *(<span class="keyword">volatile</span> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a> *)(Address) = *(<span class="keyword">volatile</span> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a> *)(Address);             \
}
</div></pre>
<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l01530">1530</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a30" doxytag="ex.h::ProbeForWriteUchar" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ProbeForWriteUchar          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">Address&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div>{                                        \
    <span class="keywordflow">if</span> ((Address) &gt;= (UCHAR * <span class="keyword">const</span>)MM_USER_PROBE_ADDRESS) {                 \
        *(<span class="keyword">volatile</span> UCHAR * <span class="keyword">const</span>)MM_USER_PROBE_ADDRESS = 0;                  \
    }                                                                        \
                                                                             \
    *(<span class="keyword">volatile</span> UCHAR *)(Address) = *(<span class="keyword">volatile</span> UCHAR *)(Address);             \
}
</div></pre>
<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l01481">1481</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a40" doxytag="ex.h::ProbeForWriteUlong" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ProbeForWriteUlong          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">Address&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div>{                                        \
    <span class="keywordflow">if</span> ((Address) &gt;= (ULONG * <span class="keyword">const</span>)MM_USER_PROBE_ADDRESS) {                 \
        *(<span class="keyword">volatile</span> ULONG * <span class="keyword">const</span>)MM_USER_PROBE_ADDRESS = 0;                  \
    }                                                                        \
                                                                             \
    *(<span class="keyword">volatile</span> ULONG *)(Address) = *(<span class="keyword">volatile</span> ULONG *)(Address);             \
}
</div></pre>
<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l01649">1649</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.
<p>
Referenced by <a class="el" href="../../d6/d6/lpcreply_8c-source.html#l00915">LpcpCopyRequestData()</a>, <a class="el" href="../../d6/d2/tokenadj_8c-source.html#l00432">NtAdjustGroupsToken()</a>, <a class="el" href="../../d6/d2/tokenadj_8c-source.html#l00046">NtAdjustPrivilegesToken()</a>, <a class="el" href="../../d2/d1/psspnd_8c-source.html#l00267">NtAlertResumeThread()</a>, <a class="el" href="../../d8/d6/ntapi_8c-source.html#l00166">NtCreateKey()</a>, <a class="el" href="../../d3/d7/ps_2create_8c-source.html#l00067">NtCreateThread()</a>, <a class="el" href="../../d8/d6/ntapi_8c-source.html#l00610">NtEnumerateKey()</a>, <a class="el" href="../../d8/d6/ntapi_8c-source.html#l00756">NtEnumerateValueKey()</a>, <a class="el" href="../../d2/d7/super_8c-source.html#l00311">NtMapViewOfSuperSection()</a>, <a class="el" href="../../d1/d8/protect_8c-source.html#l00069">NtProtectVirtualMemory()</a>, <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l00220">NtQueryDefaultLocale()</a>, <a class="el" href="../../d9/d9/obdir_8c-source.html#l00229">NtQueryDirectoryObject()</a>, <a class="el" href="../../d1/d7/ex_2event_8c-source.html#l00514">NtQueryEvent()</a>, <a class="el" href="../../d7/d7/exatom_8c-source.html#l00294">NtQueryInformationAtom()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l00814">NtQueryInformationJobObject()</a>, <a class="el" href="../../d3/d6/lpcquery_8c-source.html#l00030">NtQueryInformationPort()</a>, <a class="el" href="../../d0/d1/psquery_8c-source.html#l00531">NtQueryInformationProcess()</a>, <a class="el" href="../../d0/d1/psquery_8c-source.html#l02706">NtQueryInformationThread()</a>, <a class="el" href="../../d0/d3/tokenqry_8c-source.html#l00034">NtQueryInformationToken()</a>, <a class="el" href="../../d0/d6/ex_2profile_8c-source.html#l00788">NtQueryIntervalProfile()</a>, <a class="el" href="../../d6/d3/complete_8c-source.html#l00282">NtQueryIoCompletion()</a>, <a class="el" href="../../d8/d6/ntapi_8c-source.html#l02018">NtQueryKey()</a>, <a class="el" href="../../d8/d6/ntapi_8c-source.html#l03461">NtQueryMultipleValueKey()</a>, <a class="el" href="../../d3/d4/mutant_8c-source.html#l00380">NtQueryMutant()</a>, <a class="el" href="../../d7/d0/obquery_8c-source.html#l00058">NtQueryObject()</a>, <a class="el" href="../../d8/d6/ntapi_8c-source.html#l04090">NtQueryOpenSubKeys()</a>, <a class="el" href="../../d5/d2/querysec_8c-source.html#l00031">NtQuerySection()</a>, <a class="el" href="../../d0/d1/obse_8c-source.html#l00255">NtQuerySecurityObject()</a>, <a class="el" href="../../d3/d5/semphore_8c-source.html#l00360">NtQuerySemaphore()</a>, <a class="el" href="../../d5/d0/oblink_8c-source.html#l00333">NtQuerySymbolicLinkObject()</a>, <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l00941">NtQuerySystemInformation()</a>, <a class="el" href="../../d3/d1/timer_8c-source.html#l00822">NtQueryTimer()</a>, <a class="el" href="../../d8/d6/ntapi_8c-source.html#l02187">NtQueryValueKey()</a>, <a class="el" href="../../d6/d2/queryvm_8c-source.html#l00061">NtQueryVirtualMemory()</a>, <a class="el" href="../../d7/d7/ex_2harderr_8c-source.html#l00532">NtRaiseHardError()</a>, <a class="el" href="../../d0/d5/readwrt_8c-source.html#l00102">NtReadVirtualMemory()</a>, <a class="el" href="../../d5/d6/lpcrecv_8c-source.html#l00029">NtReplyWaitReceivePort()</a>, <a class="el" href="../../d5/d6/lpcrecv_8c-source.html#l00635">NtReplyWaitReceivePortEx()</a>, <a class="el" href="../../d2/d1/psspnd_8c-source.html#l00138">NtResumeThread()</a>, <a class="el" href="../../d6/d5/lpcconn_8c-source.html#l00084">NtSecureConnectPort()</a>, <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l02264">NtSetSystemInformation()</a>, <a class="el" href="../../d2/d1/psspnd_8c-source.html#l00033">NtSuspendThread()</a>, <a class="el" href="../../d3/d2/dbgctrl_8c-source.html#l00036">NtSystemDebugControl()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l12710">NtUserBuildHimcList()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l08222">NtUserBuildHwndList()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l08365">NtUserBuildNameList()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l08333">NtUserBuildPropList()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l08817">NtUserGetClassInfo()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l07184">NtUserGetCursorFrameInfo()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l12826">NtUserGetImeHotKey()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l00662">NtUserGetObjectInformation()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l07532">NtUserQueryInformationThread()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l02400">NtUserSystemParametersInfo()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l02929">NtUserUpdateInstance()</a>, <a class="el" href="../../d4/d3/ke_2alpha_2callback_8c-source.html#l00143">NtW32Call()</a>, <a class="el" href="../../d0/d5/readwrt_8c-source.html#l00231">NtWriteVirtualMemory()</a>, <a class="el" href="../../d1/d3/accessck_8c-source.html#l02704">SeAccessCheckByType()</a>, <a class="el" href="../../d4/d4/seaudit_8c-source.html#l01050">SepAccessCheckAndAuditAlarm()</a>, <a class="el" href="../../d0/d4/vdmints_8c-source.html#l01235">VdmpDelayInterrupt()</a>, and <a class="el" href="../../d8/d3/vdminit_8c-source.html#l00019">VdmpInitialize()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a41" doxytag="ex.h::ProbeForWriteUlong_ptr" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ProbeForWriteUlong_ptr          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">Address&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div>{                                    \
    <span class="keywordflow">if</span> ((Address) &gt;= (ULONG_PTR * <span class="keyword">const</span>)MM_USER_PROBE_ADDRESS) {             \
        *(<span class="keyword">volatile</span> ULONG_PTR * <span class="keyword">const</span>)MM_USER_PROBE_ADDRESS = 0;              \
    }                                                                        \
                                                                             \
    *(<span class="keyword">volatile</span> ULONG_PTR *)(Address) = *(<span class="keyword">volatile</span> ULONG_PTR *)(Address);     \
}
</div></pre>
<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l01666">1666</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.
<p>
Referenced by <a class="el" href="../../d4/d5/allocvm_8c-source.html#l00075">NtAllocateVirtualMemory()</a>, <a class="el" href="../../d7/d4/flushsec_8c-source.html#l00055">NtFlushVirtualMemory()</a>, <a class="el" href="../../d4/d6/freevm_8c-source.html#l00066">NtFreeVirtualMemory()</a>, <a class="el" href="../../d4/d4/lockvm_8c-source.html#l00033">NtLockVirtualMemory()</a>, <a class="el" href="../../d4/d4/mapview_8c-source.html#l00199">NtMapViewOfSection()</a>, <a class="el" href="../../d1/d8/protect_8c-source.html#l00069">NtProtectVirtualMemory()</a>, <a class="el" href="../../d6/d3/complete_8c-source.html#l00485">NtRemoveIoCompletion()</a>, and <a class="el" href="../../d4/d4/lockvm_8c-source.html#l00605">NtUnlockVirtualMemory()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a43" doxytag="ex.h::ProbeForWriteUquad" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ProbeForWriteUquad          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">Address&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div>{                                        \
    <span class="keywordflow">if</span> ((Address) &gt;= (QUAD * <span class="keyword">const</span>)MM_USER_PROBE_ADDRESS) {                  \
        *(<span class="keyword">volatile</span> ULONG * <span class="keyword">const</span>)MM_USER_PROBE_ADDRESS = 0;                  \
    }                                                                        \
                                                                             \
    *(<span class="keyword">volatile</span> UQUAD *)(Address) = *(<span class="keyword">volatile</span> UQUAD *)(Address);             \
}
</div></pre>
<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l01700">1700</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a34" doxytag="ex.h::ProbeForWriteUshort" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ProbeForWriteUshort          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">Address&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div>{                                       \
    <span class="keywordflow">if</span> ((Address) &gt;= (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a> * <span class="keyword">const</span>)MM_USER_PROBE_ADDRESS) {                \
        *(<span class="keyword">volatile</span> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a> * <span class="keyword">const</span>)MM_USER_PROBE_ADDRESS = 0;                 \
    }                                                                        \
                                                                             \
    *(<span class="keyword">volatile</span> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a> *)(Address) = *(<span class="keyword">volatile</span> <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a> *)(Address);           \
}
</div></pre>
<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l01547">1547</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.
<p>
Referenced by <a class="el" href="../../d7/d7/exatom_8c-source.html#l00045">NtAddAtom()</a>, <a class="el" href="../../d7/d7/exatom_8c-source.html#l00152">NtFindAtom()</a>, <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l00447">NtQueryDefaultUILanguage()</a>, <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l00416">NtQueryInstallUILanguage()</a>, <a class="el" href="../../d5/d0/oblink_8c-source.html#l00333">NtQuerySymbolicLinkObject()</a>, and <a class="el" href="../../d6/d7/sysenv_8c-source.html#l00045">NtQuerySystemEnvironmentValue()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a6" doxytag="ex.h::PROTECTED_POOL" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define PROTECTED_POOL&nbsp;&nbsp;&nbsp;0x80000000          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l00281">281</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.
<p>
Referenced by <a class="el" href="../../d3/d1/cmparse_8c-source.html#l02056">CmpAddInfoAfterParseFailure()</a>, <a class="el" href="../../d9/d1/cmsubs_8c-source.html#l00629">CmpCleanUpKcbCacheWithLock()</a>, <a class="el" href="../../d9/d1/cmsubs_8c-source.html#l00537">CmpCleanUpSubKeyInfo()</a>, <a class="el" href="../../d9/d1/cmsubs_8c-source.html#l00699">CmpConstructName()</a>, <a class="el" href="../../d9/d1/cmsubs_8c-source.html#l00824">CmpCreateKeyControlBlock()</a>, <a class="el" href="../../d9/d1/cmsubs_8c-source.html#l00503">CmpDereferenceNameControlBlockWithLock()</a>, <a class="el" href="../../d9/d1/cmsubs_8c-source.html#l00368">CmpGetNameControlBlock()</a>, <a class="el" href="../../d3/d1/cmparse_8c-source.html#l01476">CmpGetSymbolicLink()</a>, <a class="el" href="../../d7/d1/cmsavres_8c-source.html#l00484">CmpLoadHiveVolatile()</a>, <a class="el" href="../../d6/d1/cmquery_8c-source.html#l00028">CmpQueryKeyName()</a>, <a class="el" href="../../d9/d8/cmapi_8c-source.html#l00647">CmQueryKey()</a>, <a class="el" href="../../d7/d1/cmsavres_8c-source.html#l00097">CmRestoreKey()</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l02760">ExFreePoolWithTag()</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00853">ExpCheckSingleFilter()</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l02000">ExpInsertPoolTracker()</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l02231">ExpRemovePoolTracker()</a>, <a class="el" href="../../d7/d9/obcreate_8c-source.html#l00761">ObpAllocateObject()</a>, and <a class="el" href="../../d7/d9/obcreate_8c-source.html#l01098">ObpFreeObject()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="ex.h::RECORD_CALL_DATA" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define RECORD_CALL_DATA          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">Table&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Value:</b><pre class="fragment"><div>{                                                                      \
        PVOID CallersAddress;                                              \
        PVOID CallersCaller;                                               \
        <a class="code" href="../../d2/d2/alpha_2getcalr_8c.html#a0">RtlGetCallersAddress</a>(&amp;CallersAddress, &amp;CallersCaller);             \
        <a class="code" href="../../d9/d4/callperf_8c.html#a1">ExRecordCallerInHashTable</a>((Table), CallersAddress, CallersCaller); \
    }
</div></pre>
<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l00054">54</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.
<p>
Referenced by <a class="el" href="../../d1/d5/ppc_2flushtb_8c-source.html#l00188">KeFlushSingleTb()</a>, <a class="el" href="../../d3/d7/eventobj_8c-source.html#l00343">KeSetEvent()</a>, and <a class="el" href="../../d2/d6/wait_8c-source.html#l00810">KeWaitForSingleObject()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a65" doxytag="ex.h::RESOURCE_HASH_TABLE_SIZE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define RESOURCE_HASH_TABLE_SIZE&nbsp;&nbsp;&nbsp;64          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l02313">2313</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.
<p>
Referenced by <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l02005">ExDeleteResourceLite()</a>, and <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l00150">ExpResourceInitialization()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a62" doxytag="ex.h::ResourceNeverExclusive" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ResourceNeverExclusive&nbsp;&nbsp;&nbsp;0x10          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l02309">2309</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.
<p>
Referenced by <a class="el" href="../../d7/d1/cachesub_8c-source.html#l05541">CcAllocateInitializeBcb()</a>, <a class="el" href="../../d8/d3/ddkresrc_8c-source.html#l00249">ExAcquireResourceExclusive()</a>, <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l00492">ExAcquireResourceExclusiveLite()</a>, and <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l00598">ExTryToAcquireResourceExclusiveLite()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a64" doxytag="ex.h::ResourceOwnedExclusive" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ResourceOwnedExclusive&nbsp;&nbsp;&nbsp;0x80          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l02311">2311</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.
<p>
Referenced by <a class="el" href="../../d8/d3/ddkresrc_8c-source.html#l00249">ExAcquireResourceExclusive()</a>, <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l00492">ExAcquireResourceExclusiveLite()</a>, <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l01942">ExConvertExclusiveToSharedLite()</a>, <a class="el" href="../../d8/d3/ddkresrc_8c-source.html#l00342">ExReleaseResourceForThread()</a>, <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l01607">ExReleaseResourceForThreadLite()</a>, <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l01389">ExReleaseResourceLite()</a>, and <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l00598">ExTryToAcquireResourceExclusiveLite()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a63" doxytag="ex.h::ResourceReleaseByOtherThread" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ResourceReleaseByOtherThread&nbsp;&nbsp;&nbsp;0x20          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l02310">2310</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.    </td>
  </tr>
</table>
<hr><h2>Typedef Documentation</h2>
<a class="anchor" name="a90" doxytag="ex.h::CALL_HASH_ENTRY" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d7/d6/struct__CALL__HASH__ENTRY.html">_CALL_HASH_ENTRY</a>  <a class="el" href="../../d7/d6/struct__CALL__HASH__ENTRY.html">CALL_HASH_ENTRY</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d0/d4/callperf_8c-source.html#l00065">ExRecordCallerInHashTable()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a92" doxytag="ex.h::CALL_PERFORMANCE_DATA" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d8/d6/struct__CALL__PERFORMANCE__DATA.html">_CALL_PERFORMANCE_DATA</a>  <a class="el" href="../../d8/d6/struct__CALL__PERFORMANCE__DATA.html">CALL_PERFORMANCE_DATA</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a94" doxytag="ex.h::EEVENT_PAIR" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d0/d2/struct__EEVENT__PAIR.html">_EEVENT_PAIR</a>  <a class="el" href="../../d0/d2/struct__EEVENT__PAIR.html">EEVENT_PAIR</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d4/d7/eventpr_8c-source.html#l00070">ExpEventPairInitialization()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a125" doxytag="ex.h::ERESOURCE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d6/d4/struct__ERESOURCE.html">_ERESOURCE</a>  <a class="el" href="../../d6/d4/struct__ERESOURCE.html">ERESOURCE</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l01322">InitCreateUserCrit()</a>, and <a class="el" href="../../d5/d8/smbtrsup_8c-source.html#l00438">SmbTraceInitialize()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a121" doxytag="ex.h::ERESOURCE_THREAD" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef ULONG_PTR <a class="el" href="../../d5/d8/ex_8h.html#a121">ERESOURCE_THREAD</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l02274">2274</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.
<p>
Referenced by <a class="el" href="../../d8/d3/ddkresrc_8c-source.html#l00249">ExAcquireResourceExclusive()</a>, <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l00492">ExAcquireResourceExclusiveLite()</a>, <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l00762">ExAcquireResourceSharedLite()</a>, <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l01014">ExAcquireSharedStarveExclusive()</a>, <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l01165">ExAcquireSharedWaitForExclusive()</a>, <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l01942">ExConvertExclusiveToSharedLite()</a>, <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l02187">ExIsResourceAcquiredExclusiveLite()</a>, <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l02245">ExIsResourceAcquiredSharedLite()</a>, <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l00410">ExpAcquireResourceExclusiveLite()</a>, <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l01389">ExReleaseResourceLite()</a>, <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l01820">ExSetResourceOwnerPointer()</a>, <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l00598">ExTryToAcquireResourceExclusiveLite()</a>, <a class="el" href="../../d3/d6/notify_8c-source.html#l00371">FsRtlNotifyInitializeSync()</a>, <a class="el" href="../../d1/d0/pnpirp_8c-source.html#l01496">IopDeviceRelationsComplete()</a>, <a class="el" href="../../d1/d0/pnpirp_8c-source.html#l01370">IopDeviceStartComplete()</a>, <a class="el" href="../../d7/d4/logpgsup_8c-source.html#l00113">LfsAllocateSpanningBuffer()</a>, <a class="el" href="../../d7/d4/logpgsup_8c-source.html#l00297">LfsFreeSpanningBuffer()</a>, and <a class="el" href="../../d8/d0/lbcbsup_8c-source.html#l00311">LfsGetLbcb()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a154" doxytag="ex.h::EX_DEBUG_LOG" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d4/d7/struct__EX__DEBUG__LOG.html">_EX_DEBUG_LOG</a>  <a class="el" href="../../d4/d7/struct__EX__DEBUG__LOG.html">EX_DEBUG_LOG</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a152" doxytag="ex.h::EX_DEBUG_LOG_EVENT" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d5/d7/struct__EX__DEBUG__LOG__EVENT.html">_EX_DEBUG_LOG_EVENT</a>  <a class="el" href="../../d5/d7/struct__EX__DEBUG__LOG__EVENT.html">EX_DEBUG_LOG_EVENT</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a150" doxytag="ex.h::EX_DEBUG_LOG_TAG" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d6/d7/struct__EX__DEBUG__LOG__TAG.html">_EX_DEBUG_LOG_TAG</a>  <a class="el" href="../../d6/d7/struct__EX__DEBUG__LOG__TAG.html">EX_DEBUG_LOG_TAG</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a139" doxytag="ex.h::EX_DESTROY_HANDLE_ROUTINE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef VOID(* <a class="el" href="../../d5/d8/ex_8h.html#a139">EX_DESTROY_HANDLE_ROUTINE</a>)(IN HANDLE <a class="el" href="../../d5/d6/w98_2lh__open_2pi__basic_8h.html#a29">Handle</a>)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l02849">2849</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a141" doxytag="ex.h::EX_DUPLICATE_HANDLE_ROUTINE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef BOOLEAN(* <a class="el" href="../../d5/d8/ex_8h.html#a141">EX_DUPLICATE_HANDLE_ROUTINE</a>)(IN struct <a class="el" href="../../d0/d4/struct__EPROCESS.html">_EPROCESS</a> *Process OPTIONAL, IN <a class="el" href="../../d7/d3/struct__HANDLE__TABLE__ENTRY.html">PHANDLE_TABLE_ENTRY</a> HandleTableEntry)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l02884">2884</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a140" doxytag="ex.h::EX_ENUMERATE_HANDLE_ROUTINE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef BOOLEAN(* <a class="el" href="../../d5/d8/ex_8h.html#a140">EX_ENUMERATE_HANDLE_ROUTINE</a>)(IN <a class="el" href="../../d7/d3/struct__HANDLE__TABLE__ENTRY.html">PHANDLE_TABLE_ENTRY</a> HandleTableEntry, IN HANDLE <a class="el" href="../../d5/d6/w98_2lh__open_2pi__basic_8h.html#a29">Handle</a>, IN PVOID EnumParameter)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l02865">2865</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a97" doxytag="ex.h::EX_POOL_PRIORITY" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef enum <a class="el" href="../../d5/d8/ex_8h.html#a330">_EX_POOL_PRIORITY</a>  <a class="el" href="../../d5/d8/ex_8h.html#a97">EX_POOL_PRIORITY</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d2/d5/allocpag_8c-source.html#l00589">MmResourcesAvailable()</a>, and <a class="el" href="../../d0/d5/verifier_8c-source.html#l01812">VeAllocatePoolWithTagPriority()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a114" doxytag="ex.h::EX_WORK_QUEUE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d8/d7/struct__EX__WORK__QUEUE.html">_EX_WORK_QUEUE</a>  <a class="el" href="../../d8/d7/struct__EX__WORK__QUEUE.html">EX_WORK_QUEUE</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a133" doxytag="ex.h::EXHANDLE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d7/d8/struct__EXHANDLE.html">_EXHANDLE</a>  <a class="el" href="../../d7/d8/struct__EXHANDLE.html">EXHANDLE</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d1/d9/rtl_2atom_8c-source.html#l00152">RtlpAtomMapAtomToHandleEntry()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a98" doxytag="ex.h::FAST_MUTEX" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d6/d9/struct__FAST__MUTEX.html">_FAST_MUTEX</a>  <a class="el" href="../../d6/d9/struct__FAST__MUTEX.html">FAST_MUTEX</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a102" doxytag="ex.h::GENERAL_LOOKASIDE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d6/d1/struct__GENERAL__LOOKASIDE.html">_GENERAL_LOOKASIDE</a>  <a class="el" href="../../d6/d1/struct__GENERAL__LOOKASIDE.html">GENERAL_LOOKASIDE</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a137" doxytag="ex.h::HANDLE_TABLE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d6/d3/struct__HANDLE__TABLE.html">_HANDLE_TABLE</a>  <a class="el" href="../../d6/d3/struct__HANDLE__TABLE.html">HANDLE_TABLE</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l01475">ExpAllocateHandleTable()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a135" doxytag="ex.h::HANDLE_TABLE_ENTRY" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d7/d3/struct__HANDLE__TABLE__ENTRY.html">_HANDLE_TABLE_ENTRY</a>  <a class="el" href="../../d7/d3/struct__HANDLE__TABLE__ENTRY.html">HANDLE_TABLE_ENTRY</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l01475">ExpAllocateHandleTable()</a>, <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l01825">ExpAllocateHandleTableEntry()</a>, and <a class="el" href="../../d1/d9/rtl_2atom_8c-source.html#l00187">RtlpCreateHandleForAtom()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a104" doxytag="ex.h::NPAGED_LOOKASIDE_LIST" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d1/d4/struct__NPAGED__LOOKASIDE__LIST.html">_NPAGED_LOOKASIDE_LIST</a>  <a class="el" href="../../d1/d4/struct__NPAGED__LOOKASIDE__LIST.html">NPAGED_LOOKASIDE_LIST</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d0/d5/ioinit_8c-source.html#l00270">IoInitSystem()</a>, and <a class="el" href="../../d1/d0/obinit_8c-source.html#l00117">ObInitSystem()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a131" doxytag="ex.h::NTDDK_ERESOURCE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d3/d4/struct__NTDDK__ERESOURCE.html">_NTDDK_ERESOURCE</a>  <a class="el" href="../../d3/d4/struct__NTDDK__ERESOURCE.html">NTDDK_ERESOURCE</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a123" doxytag="ex.h::OWNER_ENTRY" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d6/d7/struct__OWNER__ENTRY.html">_OWNER_ENTRY</a>  <a class="el" href="../../d6/d7/struct__OWNER__ENTRY.html">OWNER_ENTRY</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l02683">ExpFindCurrentThread()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a106" doxytag="ex.h::PAGED_LOOKASIDE_LIST" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d1/d8/struct__PAGED__LOOKASIDE__LIST.html">_PAGED_LOOKASIDE_LIST</a>  <a class="el" href="../../d1/d8/struct__PAGED__LOOKASIDE__LIST.html">PAGED_LOOKASIDE_LIST</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d7/d2/queue_8c-source.html#l03169">InitQEntryLookaside()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a100" doxytag="ex.h::PALLOCATE_FUNCTION" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef PVOID(* <a class="el" href="../../d5/d8/ex_8h.html#a100">PALLOCATE_FUNCTION</a>)(IN <a class="el" href="../../d5/d8/ex_8h.html#a96">POOL_TYPE</a> PoolType, IN SIZE_T NumberOfBytes, IN ULONG Tag)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l00711">711</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a91" doxytag="ex.h::PCALL_HASH_ENTRY" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d7/d6/struct__CALL__HASH__ENTRY.html">_CALL_HASH_ENTRY</a> * <a class="el" href="../../d7/d6/struct__CALL__HASH__ENTRY.html">PCALL_HASH_ENTRY</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d0/d4/callperf_8c-source.html#l00065">ExRecordCallerInHashTable()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a93" doxytag="ex.h::PCALL_PERFORMANCE_DATA" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d8/d6/struct__CALL__PERFORMANCE__DATA.html">_CALL_PERFORMANCE_DATA</a> * <a class="el" href="../../d8/d6/struct__CALL__PERFORMANCE__DATA.html">PCALL_PERFORMANCE_DATA</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d0/d4/callperf_8c-source.html#l00028">ExInitializeCallData()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a157" doxytag="ex.h::PCALLBACK_FUNCTION" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef VOID(* <a class="el" href="../../d5/d8/ex_8h.html#a157">PCALLBACK_FUNCTION</a>)(IN PVOID CallbackContext, IN PVOID Argument1, IN PVOID Argument2)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l03264">3264</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.
<p>
Referenced by <a class="el" href="../../d3/d3/ex_2callback_8c-source.html#l00378">ExRegisterCallback()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a156" doxytag="ex.h::PCALLBACK_OBJECT" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d9/d6/struct__CALLBACK__OBJECT.html">_CALLBACK_OBJECT</a>* <a class="el" href="../../d9/d6/struct__CALLBACK__OBJECT.html">PCALLBACK_OBJECT</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l03262">3262</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a95" doxytag="ex.h::PEEVENT_PAIR" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d0/d2/struct__EEVENT__PAIR.html">_EEVENT_PAIR</a> * <a class="el" href="../../d0/d2/struct__EEVENT__PAIR.html">PEEVENT_PAIR</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d4/d7/eventpr_8c-source.html#l00131">NtCreateEventPair()</a>, and <a class="el" href="../../d0/d1/psquery_8c-source.html#l03103">NtSetInformationThread()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a126" doxytag="ex.h::PERESOURCE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d6/d4/struct__ERESOURCE.html">_ERESOURCE</a> * <a class="el" href="../../d6/d4/struct__ERESOURCE.html">PERESOURCE</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a122" doxytag="ex.h::PERESOURCE_THREAD" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef <a class="el" href="../../d5/d8/ex_8h.html#a121">ERESOURCE_THREAD</a>* <a class="el" href="../../d5/d8/ex_8h.html#a122">PERESOURCE_THREAD</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l02275">2275</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a143" doxytag="ex.h::PEX_CHANGE_HANDLE_ROUTINE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef BOOLEAN(* <a class="el" href="../../d5/d8/ex_8h.html#a143">PEX_CHANGE_HANDLE_ROUTINE</a>)(IN OUT <a class="el" href="../../d7/d3/struct__HANDLE__TABLE__ENTRY.html">PHANDLE_TABLE_ENTRY</a> HandleTableEntry, IN ULONG_PTR Parameter)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l02942">2942</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a155" doxytag="ex.h::PEX_DEBUG_LOG" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d4/d7/struct__EX__DEBUG__LOG.html">_EX_DEBUG_LOG</a> * <a class="el" href="../../d4/d7/struct__EX__DEBUG__LOG.html">PEX_DEBUG_LOG</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a153" doxytag="ex.h::PEX_DEBUG_LOG_EVENT" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d5/d7/struct__EX__DEBUG__LOG__EVENT.html">_EX_DEBUG_LOG_EVENT</a> * <a class="el" href="../../d5/d7/struct__EX__DEBUG__LOG__EVENT.html">PEX_DEBUG_LOG_EVENT</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a151" doxytag="ex.h::PEX_DEBUG_LOG_TAG" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d6/d7/struct__EX__DEBUG__LOG__TAG.html">_EX_DEBUG_LOG_TAG</a> * <a class="el" href="../../d6/d7/struct__EX__DEBUG__LOG__TAG.html">PEX_DEBUG_LOG_TAG</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a142" doxytag="ex.h::PEX_SNAPSHOT_HANDLE_ENTRY" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef NTSTATUS(* <a class="el" href="../../d5/d8/ex_8h.html#a142">PEX_SNAPSHOT_HANDLE_ENTRY</a>)(IN OUT PSYSTEM_HANDLE_TABLE_ENTRY_INFO *HandleEntryInfo, IN HANDLE UniqueProcessId, IN <a class="el" href="../../d7/d3/struct__HANDLE__TABLE__ENTRY.html">PHANDLE_TABLE_ENTRY</a> HandleEntry, IN HANDLE <a class="el" href="../../d5/d6/w98_2lh__open_2pi__basic_8h.html#a29">Handle</a>, IN ULONG Length, IN OUT PULONG RequiredLength)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l02902">2902</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a115" doxytag="ex.h::PEX_WORK_QUEUE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d8/d7/struct__EX__WORK__QUEUE.html">_EX_WORK_QUEUE</a> * <a class="el" href="../../d8/d7/struct__EX__WORK__QUEUE.html">PEX_WORK_QUEUE</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d2/d8/worker_8c-source.html#l00159">ExpNewThreadNecessary()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a134" doxytag="ex.h::PEXHANDLE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d7/d8/struct__EXHANDLE.html">_EXHANDLE</a> * <a class="el" href="../../d7/d8/struct__EXHANDLE.html">PEXHANDLE</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d0/d6/desktop_8c-source.html#l04464">CheckHandleFlag()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a99" doxytag="ex.h::PFAST_MUTEX" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d6/d9/struct__FAST__MUTEX.html">_FAST_MUTEX</a> * <a class="el" href="../../d6/d9/struct__FAST__MUTEX.html">PFAST_MUTEX</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a101" doxytag="ex.h::PFREE_FUNCTION" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef VOID(* <a class="el" href="../../d5/d8/ex_8h.html#a101">PFREE_FUNCTION</a>)(IN PVOID <a class="el" href="../../d8/d6/ttri_8c.html#a3">Buffer</a>)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l00719">719</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a103" doxytag="ex.h::PGENERAL_LOOKASIDE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d6/d1/struct__GENERAL__LOOKASIDE.html">_GENERAL_LOOKASIDE</a> * <a class="el" href="../../d6/d1/struct__GENERAL__LOOKASIDE.html">PGENERAL_LOOKASIDE</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a138" doxytag="ex.h::PHANDLE_TABLE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d6/d3/struct__HANDLE__TABLE.html">_HANDLE_TABLE</a> * <a class="el" href="../../d6/d3/struct__HANDLE__TABLE.html">PHANDLE_TABLE</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a136" doxytag="ex.h::PHANDLE_TABLE_ENTRY" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d7/d3/struct__HANDLE__TABLE__ENTRY.html">_HANDLE_TABLE_ENTRY</a> * <a class="el" href="../../d7/d3/struct__HANDLE__TABLE__ENTRY.html">PHANDLE_TABLE_ENTRY</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d1/d9/rtl_2atom_8c-source.html#l00152">RtlpAtomMapAtomToHandleEntry()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a170" doxytag="ex.h::PKWIN32_GLOBALATOMTABLE_CALLOUT" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef PVOID(* <a class="el" href="../../d5/d8/ex_8h.html#a170">PKWIN32_GLOBALATOMTABLE_CALLOUT</a>)(void)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l03334">3334</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a105" doxytag="ex.h::PNPAGED_LOOKASIDE_LIST" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d1/d4/struct__NPAGED__LOOKASIDE__LIST.html">_NPAGED_LOOKASIDE_LIST</a> * <a class="el" href="../../d1/d4/struct__NPAGED__LOOKASIDE__LIST.html">PNPAGED_LOOKASIDE_LIST</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d6/d7/ex_8h-source.html#l01011">ExAllocateFromPPNPagedLookasideList()</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l01077">ExFreeToPPNPagedLookasideList()</a>, and <a class="el" href="../../d6/d3/complete_8c-source.html#l00671">IoSetIoCompletion()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a132" doxytag="ex.h::PNTDDK_ERESOURCE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef <a class="el" href="../../d3/d4/struct__NTDDK__ERESOURCE.html">NTDDK_ERESOURCE</a>* <a class="el" href="../../d3/d4/struct__NTDDK__ERESOURCE.html">PNTDDK_ERESOURCE</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l02555">2555</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.
<p>
Referenced by <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l02335">ExQuerySystemLockInformation()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a96" doxytag="ex.h::POOL_TYPE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef enum <a class="el" href="../../d5/d8/ex_8h.html#a329">_POOL_TYPE</a>  <a class="el" href="../../d5/d8/ex_8h.html#a96">POOL_TYPE</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d6/d1/poolhack_8c-source.html#l01467">DumpAllocatedPool()</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l02607">ExAllocatePoolWithQuotaTag()</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l01104">ExAllocatePoolWithTag()</a>, <a class="el" href="../../d6/d1/poolhack_8c-source.html#l00970">ExFreePool()</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l03892">ExFreePoolSanityChecks()</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l02760">ExFreePoolWithTag()</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l03480">ExReturnPoolQuota()</a>, <a class="el" href="../../d6/d1/poolhack_8c-source.html#l00325">InitializePool()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l08084">IopXxxControlFile()</a>, <a class="el" href="../../d2/d5/allocpag_8c-source.html#l01778">MiFreePoolPages()</a>, <a class="el" href="../../d2/d5/allocpag_8c-source.html#l03742">MmFreeSpecialPool()</a>, <a class="el" href="../../d1/d1/obtype_8c-source.html#l00069">ObCreateObjectType()</a>, and <a class="el" href="../../d7/d9/obcreate_8c-source.html#l00761">ObpAllocateObject()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a124" doxytag="ex.h::POWNER_ENTRY" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d6/d7/struct__OWNER__ENTRY.html">_OWNER_ENTRY</a> * <a class="el" href="../../d6/d7/struct__OWNER__ENTRY.html">POWNER_ENTRY</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a108" doxytag="ex.h::PP_NPAGED_LOOKASIDE_NUMBER" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef enum <a class="el" href="../../d5/d8/ex_8h.html#a331">_PP_NPAGED_LOOKASIDE_NUMBER</a>  <a class="el" href="../../d5/d8/ex_8h.html#a108">PP_NPAGED_LOOKASIDE_NUMBER</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d5/d5/iosubs_8c-source.html#l08338">IoMakeAssociatedIrp()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l00662">IopAllocateIrpPrivate()</a>, and <a class="el" href="../../d5/d5/iosubs_8c-source.html#l06641">IopFreeIrp()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a107" doxytag="ex.h::PPAGED_LOOKASIDE_LIST" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d1/d8/struct__PAGED__LOOKASIDE__LIST.html">_PAGED_LOOKASIDE_LIST</a> * <a class="el" href="../../d1/d8/struct__PAGED__LOOKASIDE__LIST.html">PPAGED_LOOKASIDE_LIST</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a109" doxytag="ex.h::PPP_NPAGED_LOOKASIDE_NUMBER" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef enum <a class="el" href="../../d5/d8/ex_8h.html#a331">_PP_NPAGED_LOOKASIDE_NUMBER</a> * <a class="el" href="../../d5/d8/ex_8h.html#a109">PPP_NPAGED_LOOKASIDE_NUMBER</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a128" doxytag="ex.h::PRESOURCE_HASH_ENTRY" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d3/d4/struct__RESOURCE__HASH__ENTRY.html">_RESOURCE_HASH_ENTRY</a> * <a class="el" href="../../d3/d4/struct__RESOURCE__HASH__ENTRY.html">PRESOURCE_HASH_ENTRY</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l02005">ExDeleteResourceLite()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a130" doxytag="ex.h::PRESOURCE_PERFORMANCE_DATA" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d4/d4/struct__RESOURCE__PERFORMANCE__DATA.html">_RESOURCE_PERFORMANCE_DATA</a> * <a class="el" href="../../d4/d4/struct__RESOURCE__PERFORMANCE__DATA.html">PRESOURCE_PERFORMANCE_DATA</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a113" doxytag="ex.h::PWORK_QUEUE_ITEM" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d7/d9/struct__WORK__QUEUE__ITEM.html">_WORK_QUEUE_ITEM</a> * <a class="el" href="../../d7/d9/struct__WORK__QUEUE__ITEM.html">PWORK_QUEUE_ITEM</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d6/d0/cmgquota_8c-source.html#l00204">CmpClaimGlobalQuota()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a111" doxytag="ex.h::PWORKER_THREAD_ROUTINE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef VOID(* <a class="el" href="../../d5/d8/ex_8h.html#a111">PWORKER_THREAD_ROUTINE</a>)(IN PVOID Parameter)          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l01950">1950</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.
<p>
Referenced by <a class="el" href="../../d2/d8/worker_8c-source.html#l00538">ExpWorkerThread()</a>, <a class="el" href="../../d0/d8/mips_2kdtrap_8c-source.html#l00079">KdpTrap()</a>, <a class="el" href="../../d0/d9/rmlogon_8c-source.html#l01049">SepInformFileSystemsOfDeletedLogon()</a>, <a class="el" href="../../d1/d4/adtlog_8c-source.html#l00600">SepQueueWorkItem()</a>, and <a class="el" href="../../d3/d7/udfinit_8c-source.html#l00183">UdfInitializeGlobalData()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a120" doxytag="ex.h::PZONE_HEADER" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d0/d0/struct__ZONE__HEADER.html">_ZONE_HEADER</a> * <a class="el" href="../../d0/d0/struct__ZONE__HEADER.html">PZONE_HEADER</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d2/d1/rtlinit_8c-source.html#l00221">InitLookaside()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a118" doxytag="ex.h::PZONE_SEGMENT_HEADER" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d1/d0/struct__ZONE__SEGMENT__HEADER.html">_ZONE_SEGMENT_HEADER</a> * <a class="el" href="../../d1/d0/struct__ZONE__SEGMENT__HEADER.html">PZONE_SEGMENT_HEADER</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a127" doxytag="ex.h::RESOURCE_HASH_ENTRY" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d3/d4/struct__RESOURCE__HASH__ENTRY.html">_RESOURCE_HASH_ENTRY</a>  <a class="el" href="../../d3/d4/struct__RESOURCE__HASH__ENTRY.html">RESOURCE_HASH_ENTRY</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l02005">ExDeleteResourceLite()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a129" doxytag="ex.h::RESOURCE_PERFORMANCE_DATA" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d4/d4/struct__RESOURCE__PERFORMANCE__DATA.html">_RESOURCE_PERFORMANCE_DATA</a>  <a class="el" href="../../d4/d4/struct__RESOURCE__PERFORMANCE__DATA.html">RESOURCE_PERFORMANCE_DATA</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a172" doxytag="ex.h::UUID" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef GUID <a class="el" href="../../d5/d8/ex_8h.html#a172">UUID</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l03344">3344</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.
<p>
Referenced by <a class="el" href="../../d7/d1/hwprofil_8c-source.html#l01869">CmpCloneHwProfile()</a>, and <a class="el" href="../../d4/d2/uuid_8c-source.html#l00841">ExUuidCreate()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a112" doxytag="ex.h::WORK_QUEUE_ITEM" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d7/d9/struct__WORK__QUEUE__ITEM.html">_WORK_QUEUE_ITEM</a>  <a class="el" href="../../d7/d9/struct__WORK__QUEUE__ITEM.html">WORK_QUEUE_ITEM</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a110" doxytag="ex.h::WORK_QUEUE_TYPE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef enum <a class="el" href="../../d5/d8/ex_8h.html#a332">_WORK_QUEUE_TYPE</a>  <a class="el" href="../../d5/d8/ex_8h.html#a110">WORK_QUEUE_TYPE</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d2/d8/worker_8c-source.html#l00806">ExpCheckDynamicThreadCount()</a>, <a class="el" href="../../d2/d8/worker_8c-source.html#l01097">ExpCheckForWorker()</a>, <a class="el" href="../../d2/d8/worker_8c-source.html#l00220">ExpWorkerInitialization()</a>, <a class="el" href="../../d2/d8/worker_8c-source.html#l00538">ExpWorkerThread()</a>, and <a class="el" href="../../d8/d6/ntapi_8c-source.html#l01319">NtNotifyChangeMultipleKeys()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a119" doxytag="ex.h::ZONE_HEADER" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d0/d0/struct__ZONE__HEADER.html">_ZONE_HEADER</a>  <a class="el" href="../../d0/d0/struct__ZONE__HEADER.html">ZONE_HEADER</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a117" doxytag="ex.h::ZONE_SEGMENT_HEADER" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d1/d0/struct__ZONE__SEGMENT__HEADER.html">_ZONE_SEGMENT_HEADER</a>  <a class="el" href="../../d1/d0/struct__ZONE__SEGMENT__HEADER.html">ZONE_SEGMENT_HEADER</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d2/d1/rtlinit_8c-source.html#l00221">InitLookaside()</a>.    </td>
  </tr>
</table>
<hr><h2>Enumeration Type Documentation</h2>
<a class="anchor" name="a330" doxytag="ex.h::_EX_POOL_PRIORITY" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> enum <a class="el" href="../../d5/d8/ex_8h.html#a330">_EX_POOL_PRIORITY</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<dl compact><dt><b>Enumeration values: </b></dt><dd>
<table border=0 cellspacing=2 cellpadding=0>
<tr><td valign=top><em><a class="anchor" name="a330a188" doxytag="LowPoolPriority" ></a>LowPoolPriority</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a330a189" doxytag="LowPoolPrioritySpecialPoolOverrun" ></a>LowPoolPrioritySpecialPoolOverrun</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a330a190" doxytag="LowPoolPrioritySpecialPoolUnderrun" ></a>LowPoolPrioritySpecialPoolUnderrun</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a330a191" doxytag="NormalPoolPriority" ></a>NormalPoolPriority</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a330a192" doxytag="NormalPoolPrioritySpecialPoolOverrun" ></a>NormalPoolPrioritySpecialPoolOverrun</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a330a193" doxytag="NormalPoolPrioritySpecialPoolUnderrun" ></a>NormalPoolPrioritySpecialPoolUnderrun</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a330a194" doxytag="HighPoolPriority" ></a>HighPoolPriority</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a330a195" doxytag="HighPoolPrioritySpecialPoolOverrun" ></a>HighPoolPrioritySpecialPoolOverrun</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a330a196" doxytag="HighPoolPrioritySpecialPoolUnderrun" ></a>HighPoolPrioritySpecialPoolUnderrun</em>&nbsp;</td><td>
</td></tr>
</table>
</dl>

<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l00227">227</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.
<p>
<pre class="fragment"><div>00227                                {
00228     <a class="code" href="../../d5/d8/ex_8h.html#a330a188">LowPoolPriority</a>,
00229     <a class="code" href="../../d5/d8/ex_8h.html#a330a189">LowPoolPrioritySpecialPoolOverrun</a> = 8,
00230     <a class="code" href="../../d5/d8/ex_8h.html#a330a190">LowPoolPrioritySpecialPoolUnderrun</a> = 9,
00231     <a class="code" href="../../d5/d8/ex_8h.html#a330a191">NormalPoolPriority</a> = 16,
00232     <a class="code" href="../../d5/d8/ex_8h.html#a330a192">NormalPoolPrioritySpecialPoolOverrun</a> = 24,
00233     <a class="code" href="../../d5/d8/ex_8h.html#a330a193">NormalPoolPrioritySpecialPoolUnderrun</a> = 25,
00234     <a class="code" href="../../d5/d8/ex_8h.html#a330a194">HighPoolPriority</a> = 32,
00235     <a class="code" href="../../d5/d8/ex_8h.html#a330a195">HighPoolPrioritySpecialPoolOverrun</a> = 40,
00236     <a class="code" href="../../d5/d8/ex_8h.html#a330a196">HighPoolPrioritySpecialPoolUnderrun</a> = 41
00237 
00238     } <a class="code" href="../../d5/d8/ex_8h.html#a97">EX_POOL_PRIORITY</a>;
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a329" doxytag="ex.h::_POOL_TYPE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> enum <a class="el" href="../../d5/d8/ex_8h.html#a329">_POOL_TYPE</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<dl compact><dt><b>Enumeration values: </b></dt><dd>
<table border=0 cellspacing=2 cellpadding=0>
<tr><td valign=top><em><a class="anchor" name="a329a173" doxytag="NonPagedPool" ></a>NonPagedPool</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a329a174" doxytag="PagedPool" ></a>PagedPool</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a329a175" doxytag="NonPagedPoolMustSucceed" ></a>NonPagedPoolMustSucceed</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a329a176" doxytag="DontUseThisType" ></a>DontUseThisType</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a329a177" doxytag="NonPagedPoolCacheAligned" ></a>NonPagedPoolCacheAligned</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a329a178" doxytag="PagedPoolCacheAligned" ></a>PagedPoolCacheAligned</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a329a179" doxytag="NonPagedPoolCacheAlignedMustS" ></a>NonPagedPoolCacheAlignedMustS</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a329a180" doxytag="MaxPoolType" ></a>MaxPoolType</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a329a181" doxytag="NonPagedPoolSession" ></a>NonPagedPoolSession</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a329a182" doxytag="PagedPoolSession" ></a>PagedPoolSession</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a329a183" doxytag="NonPagedPoolMustSucceedSession" ></a>NonPagedPoolMustSucceedSession</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a329a184" doxytag="DontUseThisTypeSession" ></a>DontUseThisTypeSession</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a329a185" doxytag="NonPagedPoolCacheAlignedSession" ></a>NonPagedPoolCacheAlignedSession</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a329a186" doxytag="PagedPoolCacheAlignedSession" ></a>PagedPoolCacheAlignedSession</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a329a187" doxytag="NonPagedPoolCacheAlignedMustSSession" ></a>NonPagedPoolCacheAlignedMustSSession</em>&nbsp;</td><td>
</td></tr>
</table>
</dl>

<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l00107">107</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.
<p>
<pre class="fragment"><div>00107                         {
00108     <a class="code" href="../../d5/d8/ex_8h.html#a329a173">NonPagedPool</a>,
00109     <a class="code" href="../../d5/d8/ex_8h.html#a329a174">PagedPool</a>,
00110     <a class="code" href="../../d5/d8/ex_8h.html#a329a175">NonPagedPoolMustSucceed</a>,
00111     <a class="code" href="../../d5/d8/ex_8h.html#a329a176">DontUseThisType</a>,
00112     <a class="code" href="../../d5/d8/ex_8h.html#a329a177">NonPagedPoolCacheAligned</a>,
00113     <a class="code" href="../../d5/d8/ex_8h.html#a329a178">PagedPoolCacheAligned</a>,
00114     <a class="code" href="../../d5/d8/ex_8h.html#a329a179">NonPagedPoolCacheAlignedMustS</a>,
00115     <a class="code" href="../../d5/d8/ex_8h.html#a329a180">MaxPoolType</a>
00116 
00117     <span class="comment">// end_wdm</span>
00118     ,
00119     <span class="comment">//</span>
00120     <span class="comment">// Note these per session types are carefully chosen so that the appropriate</span>
00121     <span class="comment">// masking still applies as well as MaxPoolType above.</span>
00122     <span class="comment">//</span>
00123 
00124     <a class="code" href="../../d5/d8/ex_8h.html#a329a181">NonPagedPoolSession</a> = 32,
00125     <a class="code" href="../../d5/d8/ex_8h.html#a329a182">PagedPoolSession</a> = <a class="code" href="../../d5/d8/ex_8h.html#a329a181">NonPagedPoolSession</a> + 1,
00126     <a class="code" href="../../d5/d8/ex_8h.html#a329a183">NonPagedPoolMustSucceedSession</a> = <a class="code" href="../../d5/d8/ex_8h.html#a329a182">PagedPoolSession</a> + 1,
00127     <a class="code" href="../../d5/d8/ex_8h.html#a329a184">DontUseThisTypeSession</a> = <a class="code" href="../../d5/d8/ex_8h.html#a329a183">NonPagedPoolMustSucceedSession</a> + 1,
00128     <a class="code" href="../../d5/d8/ex_8h.html#a329a185">NonPagedPoolCacheAlignedSession</a> = <a class="code" href="../../d5/d8/ex_8h.html#a329a184">DontUseThisTypeSession</a> + 1,
00129     <a class="code" href="../../d5/d8/ex_8h.html#a329a186">PagedPoolCacheAlignedSession</a> = <a class="code" href="../../d5/d8/ex_8h.html#a329a185">NonPagedPoolCacheAlignedSession</a> + 1,
00130     <a class="code" href="../../d5/d8/ex_8h.html#a329a187">NonPagedPoolCacheAlignedMustSSession</a> = <a class="code" href="../../d5/d8/ex_8h.html#a329a186">PagedPoolCacheAlignedSession</a> + 1,
00131 
00132     <span class="comment">// begin_wdm</span>
00133 
00134     } <a class="code" href="../../d5/d8/ex_8h.html#a96">POOL_TYPE</a>;
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a331" doxytag="ex.h::_PP_NPAGED_LOOKASIDE_NUMBER" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> enum <a class="el" href="../../d5/d8/ex_8h.html#a331">_PP_NPAGED_LOOKASIDE_NUMBER</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<dl compact><dt><b>Enumeration values: </b></dt><dd>
<table border=0 cellspacing=2 cellpadding=0>
<tr><td valign=top><em><a class="anchor" name="a331a197" doxytag="LookasideSmallIrpList" ></a>LookasideSmallIrpList</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a331a198" doxytag="LookasideLargeIrpList" ></a>LookasideLargeIrpList</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a331a199" doxytag="LookasideMdlList" ></a>LookasideMdlList</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a331a200" doxytag="LookasideCreateInfoList" ></a>LookasideCreateInfoList</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a331a201" doxytag="LookasideNameBufferList" ></a>LookasideNameBufferList</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a331a202" doxytag="LookasideTwilightList" ></a>LookasideTwilightList</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a331a203" doxytag="LookasideCompletionList" ></a>LookasideCompletionList</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a331a204" doxytag="LookasideMaximumList" ></a>LookasideMaximumList</em>&nbsp;</td><td>
</td></tr>
</table>
</dl>

<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l00996">996</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.
<p>
<pre class="fragment"><div>00996                                          {
00997     <a class="code" href="../../d5/d8/ex_8h.html#a331a197">LookasideSmallIrpList</a>,
00998     <a class="code" href="../../d5/d8/ex_8h.html#a331a198">LookasideLargeIrpList</a>,
00999     <a class="code" href="../../d5/d8/ex_8h.html#a331a199">LookasideMdlList</a>,
01000     <a class="code" href="../../d5/d8/ex_8h.html#a331a200">LookasideCreateInfoList</a>,
01001     <a class="code" href="../../d5/d8/ex_8h.html#a331a201">LookasideNameBufferList</a>,
01002     <a class="code" href="../../d5/d8/ex_8h.html#a331a202">LookasideTwilightList</a>,
01003     <a class="code" href="../../d5/d8/ex_8h.html#a331a203">LookasideCompletionList</a>,
01004     <a class="code" href="../../d5/d8/ex_8h.html#a331a204">LookasideMaximumList</a>
01005 } <a class="code" href="../../d5/d8/ex_8h.html#a108">PP_NPAGED_LOOKASIDE_NUMBER</a>, *<a class="code" href="../../d5/d8/ex_8h.html#a109">PPP_NPAGED_LOOKASIDE_NUMBER</a>;
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a332" doxytag="ex.h::_WORK_QUEUE_TYPE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> enum <a class="el" href="../../d5/d8/ex_8h.html#a332">_WORK_QUEUE_TYPE</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<dl compact><dt><b>Enumeration values: </b></dt><dd>
<table border=0 cellspacing=2 cellpadding=0>
<tr><td valign=top><em><a class="anchor" name="a332a205" doxytag="CriticalWorkQueue" ></a>CriticalWorkQueue</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a332a206" doxytag="DelayedWorkQueue" ></a>DelayedWorkQueue</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a332a207" doxytag="HyperCriticalWorkQueue" ></a>HyperCriticalWorkQueue</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="a332a208" doxytag="MaximumWorkQueue" ></a>MaximumWorkQueue</em>&nbsp;</td><td>
</td></tr>
</table>
</dl>

<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l01941">1941</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.
<p>
<pre class="fragment"><div>01941                               {
01942     <a class="code" href="../../d5/d8/ex_8h.html#a332a205">CriticalWorkQueue</a>,
01943     <a class="code" href="../../d5/d8/ex_8h.html#a332a206">DelayedWorkQueue</a>,
01944     <a class="code" href="../../d5/d8/ex_8h.html#a332a207">HyperCriticalWorkQueue</a>,
01945     <a class="code" href="../../d5/d8/ex_8h.html#a332a208">MaximumWorkQueue</a>
01946 } <a class="code" href="../../d5/d8/ex_8h.html#a110">WORK_QUEUE_TYPE</a>;
</div></pre>    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a231" doxytag="ex.h::ExAcquireFastMutexUnsafe" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI VOID FASTCALL ExAcquireFastMutexUnsafe           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d6/d9/struct__FAST__MUTEX.html">PFAST_MUTEX</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>FastMutex</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d6/d8/w32_2ntuser_2kernel_2pnp_8c-source.html#l00142">EnterMediaCrit()</a>, <a class="el" href="../../d8/d1/power_8c-source.html#l00038">EnterPowerCrit()</a>, <a class="el" href="../../d4/d2/uuid_8c-source.html#l00841">ExUuidCreate()</a>, <a class="el" href="../../d6/d1/oplock_8c-source.html#l01678">FsRtlAcknowledgeOplockBreak()</a>, <a class="el" href="../../d6/d1/oplock_8c-source.html#l01937">FsRtlOpBatchBreakClosePending()</a>, <a class="el" href="../../d6/d1/oplock_8c-source.html#l02111">FsRtlOplockBreakNotify()</a>, <a class="el" href="../../d6/d1/oplock_8c-source.html#l02454">FsRtlOplockBreakToII()</a>, <a class="el" href="../../d6/d1/oplock_8c-source.html#l02690">FsRtlOplockBreakToNone()</a>, <a class="el" href="../../d6/d1/oplock_8c-source.html#l02249">FsRtlOplockCleanup()</a>, <a class="el" href="../../d6/d1/oplock_8c-source.html#l01299">FsRtlRequestExclusiveOplock()</a>, <a class="el" href="../../d6/d1/oplock_8c-source.html#l01514">FsRtlRequestOplockII()</a>, <a class="el" href="../../d6/d1/oplock_8c-source.html#l00413">FsRtlUninitializeOplock()</a>, <a class="el" href="../../d4/d4/mapview_8c-source.html#l02256">MiMapViewOfDataSection()</a>, <a class="el" href="../../d1/d8/protect_8c-source.html#l00344">MiProtectVirtualMemory()</a>, <a class="el" href="../../d5/d8/umapview_8c-source.html#l00265">MiRemoveMappedView()</a>, <a class="el" href="../../d4/d2/uuid_8c-source.html#l00617">NtAllocateUuids()</a>, <a class="el" href="../../d4/d5/allocvm_8c-source.html#l00075">NtAllocateVirtualMemory()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l00814">NtQueryInformationJobObject()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l01323">NtSetInformationJobObject()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l02823">PsChangeJobMemoryUsage()</a>, <a class="el" href="../../d3/d7/ps_2create_8c-source.html#l01966">PsLockProcess()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l00439">PspAddProcessToJob()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l02262">PspApplyJobLimitsToProcess()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l00709">PspJobClose()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l02901">PsReportProcessMemoryLimitViolation()</a>, <a class="el" href="../../d3/d7/ps_2create_8c-source.html#l02250">PsUnlockProcess()</a>, and <a class="el" href="../../d0/d5/verifier_8c-source.html#l02841">VerifierExAcquireFastMutexUnsafe()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a269" doxytag="ex.h::ExAcquireResourceExclusiveLite" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI BOOLEAN ExAcquireResourceExclusiveLite           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d6/d4/struct__ERESOURCE.html">PERESOURCE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Resource</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>Wait</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l00492">492</a> of file <a class="el" href="../../d9/d7/ex_2resource_8c-source.html">ex/resource.c</a>.
<p>
References <a class="el" href="../../d6/d7/ex_8h-source.html#l02289">_ERESOURCE::ActiveCount</a>, <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d8/d3/ddkresrc_8c-source.html#l00070">ASSERT_RESOURCE</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02274">ERESOURCE_THREAD</a>, <a class="el" href="../../d9/d8/client_2ntstubs_8c-source.html#l00086">Event()</a>, <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l00410">ExpAcquireResourceExclusiveLite()</a>, <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l00134">ExpIncrementCounter</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02290">_ERESOURCE::Flag</a>, <a class="el" href="../../d8/d3/ddkresrc_8c-source.html#l00091">IsOwnedExclusive</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02280">_OWNER_ENTRY::OwnerCount</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02278">_OWNER_ENTRY::OwnerThread</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02293">_ERESOURCE::OwnerThreads</a>, <a class="el" href="../../d2/d8/ps_8h-source.html#l00645">PsGetCurrentThread</a>, <a class="el" href="../../d5/d9/tex_8c-source.html#l01561">Resource</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02309">ResourceNeverExclusive</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02311">ResourceOwnedExclusive</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02302">_ERESOURCE::SpinLock</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d8/d2/validate_8c-source.html#l00887">ChangeAcquireResourceType()</a>, <a class="el" href="../../d8/d2/validate_8c-source.html#l00798">EnterCrit()</a>, <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l00410">ExpAcquireResourceExclusiveLite()</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l07239">LeaveMouseCrit()</a>, and <a class="el" href="../../d0/d5/verifier_8c-source.html#l02182">VerifierExAcquireResourceExclusive()</a>.
<p>
<pre class="fragment"><div>00499                    :
00500 
00501     The routine acquires <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified resource <span class="keywordflow">for</span> exclusive access.
00502 
00503     N.B. This routine uses fast locking.
00504 
00505 Arguments:
00506 
00507     <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a> - Supplies a pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> resource that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> acquired
00508         <span class="keywordflow">for</span> exclusive access.
00509 
00510     Wait - <a class="code" href="../../d2/d1/bench_8h.html#a5">A</a> <span class="keywordtype">boolean</span> value that specifies whether to wait <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00511         resource to become available <span class="keywordflow">if</span> access cannot be granted
00512         immediately.
00513 
00514 Return Value:
00515 
00516     BOOLEAN - <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> resource <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> acquired and <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a> otherwise.
00517 
00518 --*/
00519 
00520 {
00521 
00522     <a class="code" href="../../d5/d8/ex_8h.html#a121">ERESOURCE_THREAD</a> CurrentThread;
00523     <a class="code" href="../../d2/d6/struct__KEVENT.html">PKEVENT</a> <a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a5">Event</a>;
00524     KIRQL OldIrql = 0;
00525     BOOLEAN Result;
00526 
00527     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>((<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o3">Flag</a> &amp; ResourceNeverExclusive) == 0);
00528 
00529     <span class="comment">//</span>
00530     <span class="comment">// Acquire exclusive access to the specified resource.</span>
00531     <span class="comment">//</span>
00532 
00533     CurrentThread = (<a class="code" href="../../d5/d8/ex_8h.html#a121">ERESOURCE_THREAD</a>)<a class="code" href="../../d1/d9/ps_8h.html#a20">PsGetCurrentThread</a>();
00534     ExAcquireFastLock(&amp;<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o12">SpinLock</a>, &amp;OldIrql);
00535 
00536     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(KeIsExecutingDpc() == FALSE);
00537     <a class="code" href="../../d7/d4/ddkresrc_8c.html#a0">ASSERT_RESOURCE</a>(Resource);
00538 
00539     <span class="comment">//</span>
00540     <span class="comment">// If the active count of the resource is zero, then there is neither</span>
00541     <span class="comment">// an exclusive owner nor a shared owner and access to the resource can</span>
00542     <span class="comment">// be immediately granted. Otherwise, there is either a shared owner or</span>
00543     <span class="comment">// an exclusive owner.</span>
00544     <span class="comment">//</span>
00545 
00546     <a class="code" href="../../d8/d8/ex_2resource_8c.html#a6">ExpIncrementCounter</a>(ExclusiveAcquire);
00547     <span class="keywordflow">if</span> (<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o2">ActiveCount</a> != 0) {
00548 
00549         <span class="comment">//</span>
00550         <span class="comment">// The resource is either owned exclusive or shared.</span>
00551         <span class="comment">//</span>
00552         <span class="comment">// If the resource is owned exclusive and the current thread is the</span>
00553         <span class="comment">// owner, then increment the recursion count.</span>
00554         <span class="comment">//</span>
00555 
00556         <span class="keywordflow">if</span> (<a class="code" href="../../d7/d4/ddkresrc_8c.html#a6">IsOwnedExclusive</a>(Resource) &amp;&amp;
00557             (<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o6">OwnerThreads</a>[0].<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o0">OwnerThread</a> == CurrentThread)) {
00558             <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o6">OwnerThreads</a>[0].<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o1">OwnerCount</a> += 1;
00559             Result = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00560 
00561         } <span class="keywordflow">else</span> {
00562 
00563             <span class="comment">//</span>
00564             <span class="comment">// The resource is either owned exclusive by some other thread,</span>
00565             <span class="comment">// or owned shared.</span>
00566             <span class="comment">//</span>
00567             <span class="comment">// If wait is not specified, then return that the resource was</span>
00568             <span class="comment">// not acquired. Otherwise, wait for exclusive access to the</span>
00569             <span class="comment">// resource to be granted.</span>
00570             <span class="comment">//</span>
00571 
00572             <span class="keywordflow">if</span> (Wait == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
00573                 Result = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00574 
00575             } <span class="keywordflow">else</span> {
00576                 <span class="keywordflow">return</span> <a class="code" href="../../d8/d8/ex_2resource_8c.html#a17">ExpAcquireResourceExclusiveLite</a>(Resource, OldIrql);
00577             }
00578         }
00579 
00580     } <span class="keywordflow">else</span> {
00581 
00582         <span class="comment">//</span>
00583         <span class="comment">// The resource is not owned.</span>
00584         <span class="comment">//</span>
00585 
00586         <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o3">Flag</a> |= <a class="code" href="../../d5/d8/ex_8h.html#a64">ResourceOwnedExclusive</a>;
00587         <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o6">OwnerThreads</a>[0].<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o0">OwnerThread</a> = CurrentThread;
00588         <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o6">OwnerThreads</a>[0].<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o1">OwnerCount</a> = 1;
00589         <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o2">ActiveCount</a> = 1;
00590         Result = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00591     }
00592 
00593     ExReleaseFastLock(&amp;<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o12">SpinLock</a>, OldIrql);
00594     <span class="keywordflow">return</span> Result;
00595 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a268" doxytag="ex.h::ExAcquireResourceSharedLite" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI BOOLEAN ExAcquireResourceSharedLite           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d6/d4/struct__ERESOURCE.html">PERESOURCE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Resource</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>Wait</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l00762">762</a> of file <a class="el" href="../../d9/d7/ex_2resource_8c-source.html">ex/resource.c</a>.
<p>
References <a class="el" href="../../d6/d7/ex_8h-source.html#l02289">_ERESOURCE::ActiveCount</a>, <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d8/d3/ddkresrc_8c-source.html#l00070">ASSERT_RESOURCE</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02274">ERESOURCE_THREAD</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l00253">ExAllocatePoolWithTag</a>, <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l02683">ExpFindCurrentThread()</a>, <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l00134">ExpIncrementCounter</a>, <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l02506">ExpWaitForResource()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d8/d3/ddkresrc_8c-source.html#l00089">IsExclusiveWaiting</a>, <a class="el" href="../../d8/d3/ddkresrc_8c-source.html#l00091">IsOwnedExclusive</a>, <a class="el" href="../../d2/d5/semphobj_8c-source.html#l00039">KeInitializeSemaphore()</a>, <a class="el" href="../../d5/d8/ex_8h.html#a329a175">NonPagedPoolMustSucceed</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02295">_ERESOURCE::NumberOfSharedWaiters</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02280">_OWNER_ENTRY::OwnerCount</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02278">_OWNER_ENTRY::OwnerThread</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02293">_ERESOURCE::OwnerThreads</a>, <a class="el" href="../../d2/d8/ps_8h-source.html#l00645">PsGetCurrentThread</a>, <a class="el" href="../../d5/d9/tex_8c-source.html#l01561">Resource</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02291">_ERESOURCE::SharedWaiters</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02302">_ERESOURCE::SpinLock</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d8/d2/validate_8c-source.html#l00833">EnterSharedCrit()</a>.
<p>
<pre class="fragment"><div>00769                    :
00770 
00771     The routine acquires <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified resource <span class="keywordflow">for</span> shared access.
00772 
00773 Arguments:
00774 
00775     <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a> - Supplies a pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> resource that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> acquired
00776         <span class="keywordflow">for</span> shared access.
00777 
00778     Wait - <a class="code" href="../../d2/d1/bench_8h.html#a5">A</a> <span class="keywordtype">boolean</span> value that specifies whether to wait <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00779         resource to become available <span class="keywordflow">if</span> access cannot be granted
00780         immediately.
00781 
00782 Return Value:
00783 
00784     BOOLEAN - <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> resource <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> acquired and <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a> otherwise
00785 
00786 --*/
00787 
00788 {
00789 
00790     <a class="code" href="../../d5/d8/ex_8h.html#a121">ERESOURCE_THREAD</a> CurrentThread;
00791     KIRQL OldIrql;
00792     <a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html">POWNER_ENTRY</a> OwnerEntry;
00793     <a class="code" href="../../d8/d7/struct__KSEMAPHORE.html">PKSEMAPHORE</a> Semaphore;
00794 
00795     <span class="comment">//</span>
00796     <span class="comment">// Acquire exclusive access to the specified resource.</span>
00797     <span class="comment">//</span>
00798 
00799     CurrentThread = (<a class="code" href="../../d5/d8/ex_8h.html#a121">ERESOURCE_THREAD</a>)<a class="code" href="../../d1/d9/ps_8h.html#a20">PsGetCurrentThread</a>();
00800     ExAcquireSpinLock(&amp;<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o12">SpinLock</a>, &amp;OldIrql);
00801 
00802     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(KeIsExecutingDpc() == FALSE);
00803     <a class="code" href="../../d7/d4/ddkresrc_8c.html#a0">ASSERT_RESOURCE</a>(Resource);
00804 
00805     <a class="code" href="../../d8/d8/ex_2resource_8c.html#a6">ExpIncrementCounter</a>(SharedSecondLevel);
00806 
00807     <span class="comment">//</span>
00808     <span class="comment">// If the active count of the resource is zero, then there is neither</span>
00809     <span class="comment">// an exclusive owner nor a shared owner and access to the resource can</span>
00810     <span class="comment">// be immediately granted.</span>
00811     <span class="comment">//</span>
00812 
00813     <span class="keywordflow">if</span> (<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o2">ActiveCount</a> == 0) {
00814         <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o6">OwnerThreads</a>[1].<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o0">OwnerThread</a> = CurrentThread;
00815         <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o6">OwnerThreads</a>[1].<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o1">OwnerCount</a> = 1;
00816         <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o2">ActiveCount</a> = 1;
00817         ExReleaseSpinLock(&amp;<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o12">SpinLock</a>, OldIrql);
00818         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00819     }
00820 
00821     <span class="comment">//</span>
00822     <span class="comment">// The resource is either owned exclusive or shared.</span>
00823     <span class="comment">//</span>
00824     <span class="comment">// If the resource is owned exclusive and the current thread is the</span>
00825     <span class="comment">// owner, then treat the shared request as an exclusive request and</span>
00826     <span class="comment">// increment the recursion count. Otherwise, it is owned shared.</span>
00827     <span class="comment">//</span>
00828 
00829     <span class="keywordflow">if</span> (<a class="code" href="../../d7/d4/ddkresrc_8c.html#a6">IsOwnedExclusive</a>(Resource)) {
00830         <span class="keywordflow">if</span> (<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o6">OwnerThreads</a>[0].<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o0">OwnerThread</a> == CurrentThread) {
00831             <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o6">OwnerThreads</a>[0].<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o1">OwnerCount</a> += 1;
00832             ExReleaseSpinLock(&amp;<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o12">SpinLock</a>, OldIrql);
00833             <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00834         }
00835 
00836         <span class="comment">//</span>
00837         <span class="comment">// Find an empty entry in the thread array.</span>
00838         <span class="comment">//</span>
00839 
00840         OwnerEntry = <a class="code" href="../../d8/d8/ex_2resource_8c.html#a12">ExpFindCurrentThread</a>(Resource, 0);
00841 
00842     } <span class="keywordflow">else</span> {
00843 
00844         <span class="comment">//</span>
00845         <span class="comment">// The resource is owned shared.</span>
00846         <span class="comment">//</span>
00847         <span class="comment">// If the current thread already has acquired the resource for</span>
00848         <span class="comment">// shared access, then increment the recursion count. Otherwise</span>
00849         <span class="comment">// grant shared access if there are no exclusive waiters.</span>
00850         <span class="comment">//</span>
00851 
00852         OwnerEntry = <a class="code" href="../../d8/d8/ex_2resource_8c.html#a12">ExpFindCurrentThread</a>(Resource, CurrentThread);
00853         <span class="keywordflow">if</span> (OwnerEntry-&gt;<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o0">OwnerThread</a> == CurrentThread) {
00854             OwnerEntry-&gt;<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o1">OwnerCount</a> += 1;
00855 
00856             <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(OwnerEntry-&gt;<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o1">OwnerCount</a> != 0);
00857 
00858             ExReleaseSpinLock(&amp;<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o12">SpinLock</a>, OldIrql);
00859             <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00860         }
00861 
00862         <span class="comment">//</span>
00863         <span class="comment">// If there are no exclusive waiters, then grant shared access</span>
00864         <span class="comment">// to the resource. Otherwise, wait for the resource to become</span>
00865         <span class="comment">// available.</span>
00866         <span class="comment">//</span>
00867 
00868         <span class="keywordflow">if</span> (<a class="code" href="../../d7/d4/ddkresrc_8c.html#a5">IsExclusiveWaiting</a>(Resource) == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
00869             OwnerEntry-&gt;<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o0">OwnerThread</a> = CurrentThread;
00870             OwnerEntry-&gt;<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o1">OwnerCount</a> = 1;
00871             <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o2">ActiveCount</a> += 1;
00872             ExReleaseSpinLock(&amp;<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o12">SpinLock</a>, OldIrql);
00873             <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00874         }
00875     }
00876 
00877     <span class="comment">//</span>
00878     <span class="comment">// The resource is either owned exclusive by some other thread, or</span>
00879     <span class="comment">// owned shared by some other threads, but there is an exclusive</span>
00880     <span class="comment">// waiter and the current thread does not already have shared access</span>
00881     <span class="comment">// to the resource.</span>
00882     <span class="comment">//</span>
00883     <span class="comment">// If wait is not specified, then return that the resource was</span>
00884     <span class="comment">// not acquired.</span>
00885     <span class="comment">//</span>
00886 
00887     <span class="keywordflow">if</span> (Wait == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
00888         ExReleaseSpinLock(&amp;<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o12">SpinLock</a>, OldIrql);
00889         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00890     }
00891 
00892     <span class="comment">//</span>
00893     <span class="comment">// If the shared wait semaphore has not yet been allocated, then allocate</span>
00894     <span class="comment">// and initialize it.</span>
00895     <span class="comment">//</span>
00896 
00897     <span class="keywordflow">if</span> (<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o4">SharedWaiters</a> == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00898         Semaphore = <a class="code" href="../../d5/d8/ex_8h.html#a4">ExAllocatePoolWithTag</a>(NonPagedPoolMustSucceed,
00899                                           <span class="keyword">sizeof</span>(<a class="code" href="../../d8/d7/struct__KSEMAPHORE.html">KSEMAPHORE</a>),
00900                                           'eSeR');
00901 
00902         <a class="code" href="../../d1/d6/semphobj_8c.html#a1">KeInitializeSemaphore</a>(Semaphore, 0, MAXLONG);
00903         <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o4">SharedWaiters</a> = Semaphore;
00904     }
00905 
00906     <span class="comment">//</span>
00907     <span class="comment">// Wait for shared access to the resource to be granted and increment</span>
00908     <span class="comment">// the recursion count.</span>
00909     <span class="comment">//</span>
00910 
00911     OwnerEntry-&gt;<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o0">OwnerThread</a> = CurrentThread;
00912     OwnerEntry-&gt;<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o1">OwnerCount</a> = 1;
00913     <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o8">NumberOfSharedWaiters</a> += 1;
00914     ExReleaseSpinLock(&amp;<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o12">SpinLock</a>, OldIrql);
00915     <a class="code" href="../../d8/d8/ex_2resource_8c.html#a11">ExpWaitForResource</a>(Resource, <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o4">SharedWaiters</a>);
00916     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00917 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a270" doxytag="ex.h::ExAcquireSharedStarveExclusive" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI BOOLEAN ExAcquireSharedStarveExclusive           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d6/d4/struct__ERESOURCE.html">PERESOURCE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Resource</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>Wait</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l01014">1014</a> of file <a class="el" href="../../d9/d7/ex_2resource_8c-source.html">ex/resource.c</a>.
<p>
References <a class="el" href="../../d6/d7/ex_8h-source.html#l02289">_ERESOURCE::ActiveCount</a>, <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d8/d3/ddkresrc_8c-source.html#l00070">ASSERT_RESOURCE</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02274">ERESOURCE_THREAD</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l00253">ExAllocatePoolWithTag</a>, <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l02683">ExpFindCurrentThread()</a>, <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l00134">ExpIncrementCounter</a>, <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l02506">ExpWaitForResource()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d8/d3/ddkresrc_8c-source.html#l00091">IsOwnedExclusive</a>, <a class="el" href="../../d2/d5/semphobj_8c-source.html#l00039">KeInitializeSemaphore()</a>, <a class="el" href="../../d5/d8/ex_8h.html#a329a175">NonPagedPoolMustSucceed</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02295">_ERESOURCE::NumberOfSharedWaiters</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02280">_OWNER_ENTRY::OwnerCount</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02278">_OWNER_ENTRY::OwnerThread</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02293">_ERESOURCE::OwnerThreads</a>, <a class="el" href="../../d2/d8/ps_8h-source.html#l00645">PsGetCurrentThread</a>, <a class="el" href="../../d5/d9/tex_8c-source.html#l01561">Resource</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02291">_ERESOURCE::SharedWaiters</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02302">_ERESOURCE::SpinLock</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d7/d1/cachesub_8c-source.html#l00116">CcPinFileData()</a>, <a class="el" href="../../d3/d8/pinsup_8c-source.html#l00271">CcPinMappedData()</a>, and <a class="el" href="../../d5/d8/resrcsup_8c-source.html#l00047">UdfAcquireResource()</a>.
<p>
<pre class="fragment"><div>01020                    :
01021 
01022     This routine acquires <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified resource <span class="keywordflow">for</span> shared access and
01023     does not wait <span class="keywordflow">for</span> any pending exclusive owners.
01024 
01025 Arguments:
01026 
01027     <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a> - Supplies a pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> resource that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> acquired
01028         <span class="keywordflow">for</span> shared access.
01029 
01030     Wait - <a class="code" href="../../d2/d1/bench_8h.html#a5">A</a> <span class="keywordtype">boolean</span> value that specifies whether to wait <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
01031         resource to become available <span class="keywordflow">if</span> access cannot be granted
01032         immediately.
01033 
01034 Return Value:
01035 
01036     BOOLEAN - <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> resource <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> acquired and <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a> otherwise
01037 
01038 --*/
01039 
01040 {
01041 
01042     <a class="code" href="../../d5/d8/ex_8h.html#a121">ERESOURCE_THREAD</a> CurrentThread;
01043     KIRQL OldIrql;
01044     <a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html">POWNER_ENTRY</a> OwnerEntry;
01045     <a class="code" href="../../d8/d7/struct__KSEMAPHORE.html">PKSEMAPHORE</a> Semaphore;
01046 
01047     <span class="comment">//</span>
01048     <span class="comment">// Acquire exclusive access to the specified resource.</span>
01049     <span class="comment">//</span>
01050 
01051     CurrentThread = (<a class="code" href="../../d5/d8/ex_8h.html#a121">ERESOURCE_THREAD</a>)<a class="code" href="../../d1/d9/ps_8h.html#a20">PsGetCurrentThread</a>();
01052     ExAcquireSpinLock(&amp;<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o12">SpinLock</a>, &amp;OldIrql);
01053 
01054     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(KeIsExecutingDpc() == FALSE);
01055     <a class="code" href="../../d7/d4/ddkresrc_8c.html#a0">ASSERT_RESOURCE</a>(Resource);
01056 
01057     <a class="code" href="../../d8/d8/ex_2resource_8c.html#a6">ExpIncrementCounter</a>(StarveSecondLevel);
01058 
01059     <span class="comment">//</span>
01060     <span class="comment">// If the active count of the resource is zero, then there is neither</span>
01061     <span class="comment">// an exclusive owner nor a shared owner and access to the resource can</span>
01062     <span class="comment">// be immediately granted.</span>
01063     <span class="comment">//</span>
01064 
01065     <span class="keywordflow">if</span> (<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o2">ActiveCount</a> == 0) {
01066         <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o6">OwnerThreads</a>[1].<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o0">OwnerThread</a> = CurrentThread;
01067         <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o6">OwnerThreads</a>[1].<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o1">OwnerCount</a> = 1;
01068         <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o2">ActiveCount</a> = 1;
01069         ExReleaseSpinLock(&amp;<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o12">SpinLock</a>, OldIrql);
01070         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01071     }
01072 
01073     <span class="comment">//</span>
01074     <span class="comment">// The resource is either owned exclusive or shared.</span>
01075     <span class="comment">//</span>
01076     <span class="comment">// If the resource is owned exclusive and the current thread is the</span>
01077     <span class="comment">// owner, then treat the shared request as an exclusive request and</span>
01078     <span class="comment">// increment the recursion count. Otherwise, it is owned shared.</span>
01079     <span class="comment">//</span>
01080 
01081     <span class="keywordflow">if</span> (<a class="code" href="../../d7/d4/ddkresrc_8c.html#a6">IsOwnedExclusive</a>(Resource)) {
01082         <span class="keywordflow">if</span> (<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o6">OwnerThreads</a>[0].<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o0">OwnerThread</a> == CurrentThread) {
01083             <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o6">OwnerThreads</a>[0].<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o1">OwnerCount</a> += 1;
01084             ExReleaseSpinLock(&amp;<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o12">SpinLock</a>, OldIrql);
01085             <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01086         }
01087 
01088         <span class="comment">//</span>
01089         <span class="comment">// Find an empty entry in the thread array.</span>
01090         <span class="comment">//</span>
01091 
01092         OwnerEntry = <a class="code" href="../../d8/d8/ex_2resource_8c.html#a12">ExpFindCurrentThread</a>(Resource, 0);
01093 
01094     } <span class="keywordflow">else</span> {
01095 
01096         <span class="comment">//</span>
01097         <span class="comment">// The resource is owned shared.</span>
01098         <span class="comment">//</span>
01099         <span class="comment">// If the current thread already has acquired the resource for</span>
01100         <span class="comment">// shared access, then increment the recursion count. Otherwise</span>
01101         <span class="comment">// grant shared access to the current thread</span>
01102         <span class="comment">//</span>
01103 
01104         OwnerEntry = <a class="code" href="../../d8/d8/ex_2resource_8c.html#a12">ExpFindCurrentThread</a>(Resource, CurrentThread);
01105         <span class="keywordflow">if</span> (OwnerEntry-&gt;<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o0">OwnerThread</a> == CurrentThread) {
01106             OwnerEntry-&gt;<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o1">OwnerCount</a> += 1;
01107 
01108             <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(OwnerEntry-&gt;<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o1">OwnerCount</a> != 0);
01109 
01110             ExReleaseSpinLock(&amp;<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o12">SpinLock</a>, OldIrql);
01111             <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01112         }
01113 
01114         <span class="comment">//</span>
01115         <span class="comment">// Grant the current thread shared access to the resource.</span>
01116         <span class="comment">//</span>
01117 
01118         OwnerEntry-&gt;<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o0">OwnerThread</a> = CurrentThread;
01119         OwnerEntry-&gt;<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o1">OwnerCount</a> = 1;
01120         <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o2">ActiveCount</a> += 1;
01121         ExReleaseSpinLock(&amp;<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o12">SpinLock</a>, OldIrql);
01122         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01123     }
01124 
01125     <span class="comment">//</span>
01126     <span class="comment">// The resource is owned exclusive by some other thread.</span>
01127     <span class="comment">//</span>
01128     <span class="comment">// If wait is not specified, then return that the resource was</span>
01129     <span class="comment">// not acquired.</span>
01130     <span class="comment">//</span>
01131 
01132     <span class="keywordflow">if</span> (Wait == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
01133         ExReleaseSpinLock(&amp;<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o12">SpinLock</a>, OldIrql);
01134         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01135     }
01136 
01137     <span class="comment">//</span>
01138     <span class="comment">// If the shared wait semaphore has not yet been allocated, then allocate</span>
01139     <span class="comment">// and initialize it.</span>
01140     <span class="comment">//</span>
01141 
01142     <span class="keywordflow">if</span> (<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o4">SharedWaiters</a> == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01143         Semaphore = <a class="code" href="../../d5/d8/ex_8h.html#a4">ExAllocatePoolWithTag</a>(NonPagedPoolMustSucceed,
01144                                           <span class="keyword">sizeof</span>(<a class="code" href="../../d8/d7/struct__KSEMAPHORE.html">KSEMAPHORE</a>),
01145                                           'eSeR');
01146 
01147         <a class="code" href="../../d1/d6/semphobj_8c.html#a1">KeInitializeSemaphore</a>(Semaphore, 0, MAXLONG);
01148         <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o4">SharedWaiters</a> = Semaphore;
01149     }
01150 
01151     <span class="comment">//</span>
01152     <span class="comment">// Wait for shared access to the resource to be granted and increment</span>
01153     <span class="comment">// the recursion count.</span>
01154     <span class="comment">//</span>
01155 
01156     OwnerEntry-&gt;<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o0">OwnerThread</a> = CurrentThread;
01157     OwnerEntry-&gt;<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o1">OwnerCount</a> = 1;
01158     <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o8">NumberOfSharedWaiters</a> += 1;
01159     ExReleaseSpinLock(&amp;<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o12">SpinLock</a>, OldIrql);
01160     <a class="code" href="../../d8/d8/ex_2resource_8c.html#a11">ExpWaitForResource</a>(Resource, <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o4">SharedWaiters</a>);
01161     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01162 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a271" doxytag="ex.h::ExAcquireSharedWaitForExclusive" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI BOOLEAN ExAcquireSharedWaitForExclusive           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d6/d4/struct__ERESOURCE.html">PERESOURCE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Resource</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>Wait</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l01165">1165</a> of file <a class="el" href="../../d9/d7/ex_2resource_8c-source.html">ex/resource.c</a>.
<p>
References <a class="el" href="../../d6/d7/ex_8h-source.html#l02289">_ERESOURCE::ActiveCount</a>, <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d8/d3/ddkresrc_8c-source.html#l00070">ASSERT_RESOURCE</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02274">ERESOURCE_THREAD</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l00253">ExAllocatePoolWithTag</a>, <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l02683">ExpFindCurrentThread()</a>, <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l00134">ExpIncrementCounter</a>, <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l02506">ExpWaitForResource()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d8/d3/ddkresrc_8c-source.html#l00089">IsExclusiveWaiting</a>, <a class="el" href="../../d8/d3/ddkresrc_8c-source.html#l00091">IsOwnedExclusive</a>, <a class="el" href="../../d2/d5/semphobj_8c-source.html#l00039">KeInitializeSemaphore()</a>, <a class="el" href="../../d5/d8/ex_8h.html#a329a175">NonPagedPoolMustSucceed</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02295">_ERESOURCE::NumberOfSharedWaiters</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02280">_OWNER_ENTRY::OwnerCount</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02278">_OWNER_ENTRY::OwnerThread</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02293">_ERESOURCE::OwnerThreads</a>, <a class="el" href="../../d2/d8/ps_8h-source.html#l00645">PsGetCurrentThread</a>, <a class="el" href="../../d5/d9/tex_8c-source.html#l01561">Resource</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02291">_ERESOURCE::SharedWaiters</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02302">_ERESOURCE::SpinLock</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d4/d0/fastio_8c-source.html#l02064">FsRtlAcquireFileForModWrite()</a>.
<p>
<pre class="fragment"><div>01171                    :
01172 
01173     This routine acquires <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified resource <span class="keywordflow">for</span> shared access, but
01174     waits <span class="keywordflow">for</span> any pending exclusive owners.
01175 
01176 Arguments:
01177 
01178     <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a> - Supplies a pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> resource that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> acquired
01179         <span class="keywordflow">for</span> shared access.
01180 
01181     Wait - <a class="code" href="../../d2/d1/bench_8h.html#a5">A</a> <span class="keywordtype">boolean</span> value that specifies whether to wait <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
01182         resource to become available <span class="keywordflow">if</span> access cannot be granted
01183         immediately.
01184 
01185 Return Value:
01186 
01187     BOOLEAN - <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> resource <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> acquired and <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a> otherwise
01188 
01189 --*/
01190 
01191 {
01192 
01193     <a class="code" href="../../d5/d8/ex_8h.html#a121">ERESOURCE_THREAD</a> CurrentThread;
01194     KIRQL OldIrql;
01195     <a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html">POWNER_ENTRY</a> OwnerEntry;
01196     <a class="code" href="../../d8/d7/struct__KSEMAPHORE.html">PKSEMAPHORE</a> Semaphore;
01197 
01198     <span class="comment">//</span>
01199     <span class="comment">// Acquire exclusive access to the specified resource.</span>
01200     <span class="comment">//</span>
01201 
01202     CurrentThread = (<a class="code" href="../../d5/d8/ex_8h.html#a121">ERESOURCE_THREAD</a>)<a class="code" href="../../d1/d9/ps_8h.html#a20">PsGetCurrentThread</a>();
01203     ExAcquireSpinLock(&amp;<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o12">SpinLock</a>, &amp;OldIrql);
01204 
01205     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(KeIsExecutingDpc() == FALSE);
01206     <a class="code" href="../../d7/d4/ddkresrc_8c.html#a0">ASSERT_RESOURCE</a>(Resource);
01207 
01208     <a class="code" href="../../d8/d8/ex_2resource_8c.html#a6">ExpIncrementCounter</a>(WaitForExclusive);
01209 
01210     <span class="comment">//</span>
01211     <span class="comment">// If the active count of the resource is zero, then there is neither</span>
01212     <span class="comment">// an exclusive owner nor a shared owner and access to the resource can</span>
01213     <span class="comment">// be immediately granted.</span>
01214     <span class="comment">//</span>
01215 
01216     <span class="keywordflow">if</span> (<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o2">ActiveCount</a> == 0) {
01217         <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o6">OwnerThreads</a>[1].<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o0">OwnerThread</a> = CurrentThread;
01218         <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o6">OwnerThreads</a>[1].<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o1">OwnerCount</a> = 1;
01219         <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o2">ActiveCount</a> = 1;
01220         ExReleaseSpinLock(&amp;<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o12">SpinLock</a>, OldIrql);
01221         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01222     }
01223 
01224     <span class="comment">//</span>
01225     <span class="comment">// The resource is either owned exclusive or shared.</span>
01226     <span class="comment">//</span>
01227     <span class="comment">// If the resource is owned exclusive and the current thread is the</span>
01228     <span class="comment">// owner, then treat the shared request as an exclusive request and</span>
01229     <span class="comment">// increment the recursion count. Otherwise, it is owned shared.</span>
01230     <span class="comment">//</span>
01231 
01232     <span class="keywordflow">if</span> (<a class="code" href="../../d7/d4/ddkresrc_8c.html#a6">IsOwnedExclusive</a>(Resource)) {
01233         <span class="keywordflow">if</span> (<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o6">OwnerThreads</a>[0].<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o0">OwnerThread</a> == CurrentThread) {
01234             <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o6">OwnerThreads</a>[0].<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o1">OwnerCount</a> += 1;
01235             ExReleaseSpinLock(&amp;<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o12">SpinLock</a>, OldIrql);
01236             <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01237         }
01238 
01239         <span class="comment">//</span>
01240         <span class="comment">// Find an empty entry in the thread array.</span>
01241         <span class="comment">//</span>
01242 
01243         OwnerEntry = <a class="code" href="../../d8/d8/ex_2resource_8c.html#a12">ExpFindCurrentThread</a>(Resource, 0);
01244 
01245     } <span class="keywordflow">else</span> {
01246 
01247         <span class="comment">//</span>
01248         <span class="comment">// The resource is owned shared.</span>
01249         <span class="comment">//</span>
01250         <span class="comment">// If there is an exclusive waiter, then wait for the exclusive</span>
01251         <span class="comment">// waiter to gain access to the resource, then acquire the resource</span>
01252         <span class="comment">// shared without regard to exclusive waiters. Otherwise, if the</span>
01253         <span class="comment">// current thread already has acquired the resource for shared access,</span>
01254         <span class="comment">// then increment the recursion count. Otherwise grant shared access</span>
01255         <span class="comment">// to the current thread</span>
01256         <span class="comment">//</span>
01257 
01258         <span class="keywordflow">if</span> (<a class="code" href="../../d7/d4/ddkresrc_8c.html#a5">IsExclusiveWaiting</a>(Resource)) {
01259 
01260             <span class="comment">//</span>
01261             <span class="comment">// The resource is shared, but there is an exclusive waiter.</span>
01262             <span class="comment">//</span>
01263             <span class="comment">// If wait is not specified, then return that the resource was</span>
01264             <span class="comment">// not acquired.</span>
01265             <span class="comment">//</span>
01266 
01267             <span class="keywordflow">if</span> (Wait == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
01268                 ExReleaseSpinLock(&amp;<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o12">SpinLock</a>, OldIrql);
01269                 <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01270             }
01271 
01272             <span class="comment">//</span>
01273             <span class="comment">// If the shared wait semaphore has not yet been allocated, then</span>
01274             <span class="comment">// allocate and initialize it.</span>
01275             <span class="comment">//</span>
01276 
01277             <span class="keywordflow">if</span> (<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o4">SharedWaiters</a> == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01278                 Semaphore = <a class="code" href="../../d5/d8/ex_8h.html#a4">ExAllocatePoolWithTag</a>(NonPagedPoolMustSucceed,
01279                                                   <span class="keyword">sizeof</span>(<a class="code" href="../../d8/d7/struct__KSEMAPHORE.html">KSEMAPHORE</a>),
01280                                                   'eSeR');
01281 
01282                 <a class="code" href="../../d1/d6/semphobj_8c.html#a1">KeInitializeSemaphore</a>(Semaphore, 0, MAXLONG);
01283                 <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o4">SharedWaiters</a> = Semaphore;
01284             }
01285 
01286             <span class="comment">//</span>
01287             <span class="comment">// Increment the number of shared waiters and wait for shared</span>
01288             <span class="comment">// access to the resource to be granted to some other set of</span>
01289             <span class="comment">// threads, and then acquire the resource shared without regard</span>
01290             <span class="comment">// to exclusive access.</span>
01291             <span class="comment">//</span>
01292             <span class="comment">// N.B. The resource is left in a state such that the calling</span>
01293             <span class="comment">//      thread does not have a reference in the owner table</span>
01294             <span class="comment">//      for the requested access even though the active count</span>
01295             <span class="comment">//      is incremented when control is returned. However, the</span>
01296             <span class="comment">//      resource is owned shared at this point, so an owner</span>
01297             <span class="comment">//      entry can simply be allocated and the owner count set</span>
01298             <span class="comment">//      to one.</span>
01299             <span class="comment">//</span>
01300 
01301             <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o8">NumberOfSharedWaiters</a> += 1;
01302             ExReleaseSpinLock(&amp;<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o12">SpinLock</a>, OldIrql);
01303             <a class="code" href="../../d8/d8/ex_2resource_8c.html#a11">ExpWaitForResource</a>(Resource, <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o4">SharedWaiters</a>);
01304 
01305             <span class="comment">//</span>
01306             <span class="comment">// Reacquire the resource spin lock, allocate an owner entry,</span>
01307             <span class="comment">// and initialize the owner count to one. The active count</span>
01308             <span class="comment">// was already incremented when shared access was granted.</span>
01309             <span class="comment">//</span>
01310 
01311             ExAcquireSpinLock(&amp;<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o12">SpinLock</a>, &amp;OldIrql);
01312 
01313             <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(<a class="code" href="../../d7/d4/ddkresrc_8c.html#a6">IsOwnedExclusive</a>(Resource) == FALSE);
01314             <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o2">ActiveCount</a> &gt; 0);
01315 
01316             OwnerEntry = <a class="code" href="../../d8/d8/ex_2resource_8c.html#a12">ExpFindCurrentThread</a>(Resource, CurrentThread);
01317 
01318             <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(OwnerEntry-&gt;<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o0">OwnerThread</a> != CurrentThread);
01319 
01320             OwnerEntry-&gt;<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o0">OwnerThread</a> = CurrentThread;
01321             OwnerEntry-&gt;<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o1">OwnerCount</a> = 1;
01322             ExReleaseSpinLock(&amp;<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o12">SpinLock</a>, OldIrql);
01323             <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01324 
01325         } <span class="keywordflow">else</span> {
01326             OwnerEntry = <a class="code" href="../../d8/d8/ex_2resource_8c.html#a12">ExpFindCurrentThread</a>(Resource, CurrentThread);
01327             <span class="keywordflow">if</span> (OwnerEntry-&gt;<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o0">OwnerThread</a> == CurrentThread) {
01328                 OwnerEntry-&gt;<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o1">OwnerCount</a> += 1;
01329 
01330                 <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(OwnerEntry-&gt;<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o1">OwnerCount</a> != 0);
01331 
01332                 ExReleaseSpinLock(&amp;<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o12">SpinLock</a>, OldIrql);
01333                 <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01334             }
01335 
01336             <span class="comment">//</span>
01337             <span class="comment">// Grant the current thread shared access to the resource.</span>
01338             <span class="comment">//</span>
01339 
01340             OwnerEntry-&gt;<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o0">OwnerThread</a> = CurrentThread;
01341             OwnerEntry-&gt;<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o1">OwnerCount</a> = 1;
01342             <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o2">ActiveCount</a> += 1;
01343             ExReleaseSpinLock(&amp;<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o12">SpinLock</a>, OldIrql);
01344             <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01345         }
01346     }
01347 
01348     <span class="comment">//</span>
01349     <span class="comment">// The resource is owned exclusive by some other thread.</span>
01350     <span class="comment">//</span>
01351     <span class="comment">// If wait is not specified, then return that the resource was</span>
01352     <span class="comment">// not acquired.</span>
01353     <span class="comment">//</span>
01354 
01355     <span class="keywordflow">if</span> (Wait == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
01356         ExReleaseSpinLock(&amp;<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o12">SpinLock</a>, OldIrql);
01357         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01358     }
01359 
01360     <span class="comment">//</span>
01361     <span class="comment">// If the shared wait semaphore has not yet been allocated, then allocate</span>
01362     <span class="comment">// and initialize it.</span>
01363     <span class="comment">//</span>
01364 
01365     <span class="keywordflow">if</span> (<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o4">SharedWaiters</a> == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01366         Semaphore = <a class="code" href="../../d5/d8/ex_8h.html#a4">ExAllocatePoolWithTag</a>(NonPagedPoolMustSucceed,
01367                                           <span class="keyword">sizeof</span>(<a class="code" href="../../d8/d7/struct__KSEMAPHORE.html">KSEMAPHORE</a>),
01368                                           'eSeR');
01369 
01370         <a class="code" href="../../d1/d6/semphobj_8c.html#a1">KeInitializeSemaphore</a>(Semaphore, 0, MAXLONG);
01371         <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o4">SharedWaiters</a> = Semaphore;
01372     }
01373 
01374     <span class="comment">//</span>
01375     <span class="comment">// Wait for shared access to the resource to be granted and increment</span>
01376     <span class="comment">// the recursion count.</span>
01377     <span class="comment">//</span>
01378 
01379     OwnerEntry-&gt;<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o0">OwnerThread</a> = CurrentThread;
01380     OwnerEntry-&gt;<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o1">OwnerCount</a> = 1;
01381     <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o8">NumberOfSharedWaiters</a> += 1;
01382     ExReleaseSpinLock(&amp;<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o12">SpinLock</a>, OldIrql);
01383     <a class="code" href="../../d8/d8/ex_2resource_8c.html#a11">ExpWaitForResource</a>(Resource, <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o4">SharedWaiters</a>);
01384     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01385 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a312" doxytag="ex.h::ExAcquireTimeRefreshLock" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID ExAcquireTimeRefreshLock           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d9/d2/kdapi_8c-source.html#l00528">KdpTimeSlipWork()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a245" doxytag="ex.h::ExAdjustLookasideDepth" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID ExAdjustLookasideDepth           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d5/ex_2lookasid_8c-source.html#l00089">89</a> of file <a class="el" href="../../d0/d5/ex_2lookasid_8c-source.html">ex/lookasid.c</a>.
<p>
References <a class="el" href="../../d5/d9/exp_8h-source.html#l00262">ExNPagedLookasideListHead</a>, <a class="el" href="../../d5/d9/exp_8h-source.html#l00263">ExNPagedLookasideLock</a>, <a class="el" href="../../d0/d5/ex_2lookasid_8c-source.html#l00085">ExpAdjustScanPeriod</a>, <a class="el" href="../../d5/d9/exp_8h-source.html#l00264">ExPagedLookasideListHead</a>, <a class="el" href="../../d5/d9/exp_8h-source.html#l00265">ExPagedLookasideLock</a>, <a class="el" href="../../d0/d5/ex_2lookasid_8c-source.html#l00086">ExpCurrentScanPeriod</a>, <a class="el" href="../../d5/d9/exp_8h-source.html#l00266">ExPoolLookasideListHead</a>, <a class="el" href="../../d0/d5/ex_2lookasid_8c-source.html#l00251">ExpScanGeneralLookasideList()</a>, <a class="el" href="../../d0/d5/ex_2lookasid_8c-source.html#l00340">ExpScanPoolLookasideList()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, and <a class="el" href="../../d0/d5/ex_2lookasid_8c-source.html#l00027">MAXIMUM_SCAN_PERIOD</a>.
<p>
Referenced by <a class="el" href="../../d0/d0/balmgr_8c-source.html#l00142">KeBalanceSetManager()</a>.
<p>
<pre class="fragment"><div>00095                    :
00096 
00097     This function <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> called periodically to adjust <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> maximum depth of
00098     all lookaside lists.
00099 
00100 Arguments:
00101 
00102     None.
00103 
00104 Return Value:
00105 
00106     None.
00107 
00108 --*/
00109 
00110 {
00111 
00112     LOGICAL Changes;
00113 
00114     <span class="comment">//</span>
00115     <span class="comment">// Decrement the scan period and check if it is time to dynamically</span>
00116     <span class="comment">// adjust the maximum depth of lookaside lists.</span>
00117     <span class="comment">//</span>
00118 
00119     <a class="code" href="../../d9/d5/ex_2lookasid_8c.html#a9">ExpCurrentScanPeriod</a> -= 1;
00120     <span class="keywordflow">if</span> (<a class="code" href="../../d9/d5/ex_2lookasid_8c.html#a9">ExpCurrentScanPeriod</a> == 0) {
00121         Changes = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00122 
00123         <span class="comment">//</span>
00124         <span class="comment">// Scan the general paged and nonpaged lookaside lists.</span>
00125         <span class="comment">//</span>
00126 
00127         Changes |= <a class="code" href="../../d9/d5/ex_2lookasid_8c.html#a12">ExpScanGeneralLookasideList</a>(&amp;ExNPagedLookasideListHead,
00128                                                &amp;ExNPagedLookasideLock);
00129 
00130         Changes |= <a class="code" href="../../d9/d5/ex_2lookasid_8c.html#a12">ExpScanGeneralLookasideList</a>(&amp;ExPagedLookasideListHead,
00131                                                &amp;ExPagedLookasideLock);
00132 
00133         <span class="comment">//</span>
00134         <span class="comment">// Scan the pool paged and nonpaged lookaside lists;</span>
00135         <span class="comment">//</span>
00136 
00137         Changes |= <a class="code" href="../../d9/d5/ex_2lookasid_8c.html#a13">ExpScanPoolLookasideList</a>(&amp;ExPoolLookasideListHead);
00138 
00139         <span class="comment">//</span>
00140         <span class="comment">// If any changes were made to the depth of any lookaside list during</span>
00141         <span class="comment">// this scan period, then lower the scan period to the minimum value.</span>
00142         <span class="comment">// Otherwise, attempt to raise the scan period.</span>
00143         <span class="comment">//</span>
00144 
00145         <span class="keywordflow">if</span> (Changes != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
00146             <a class="code" href="../../d9/d5/ex_2lookasid_8c.html#a8">ExpAdjustScanPeriod</a> = 1;
00147 
00148         } <span class="keywordflow">else</span> {
00149             <span class="keywordflow">if</span> (<a class="code" href="../../d9/d5/ex_2lookasid_8c.html#a8">ExpAdjustScanPeriod</a> != <a class="code" href="../../d9/d5/ex_2lookasid_8c.html#a0">MAXIMUM_SCAN_PERIOD</a>) {
00150                 <a class="code" href="../../d9/d5/ex_2lookasid_8c.html#a8">ExpAdjustScanPeriod</a> += 1;
00151             }
00152         }
00153 
00154         <a class="code" href="../../d9/d5/ex_2lookasid_8c.html#a9">ExpCurrentScanPeriod</a> = <a class="code" href="../../d9/d5/ex_2lookasid_8c.html#a8">ExpAdjustScanPeriod</a>;
00155     }
00156 
00157     <span class="keywordflow">return</span>;
00158 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a248" doxytag="ex.h::ExAllocateFromNPagedLookasideList" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> __inline PVOID ExAllocateFromNPagedLookasideList           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d1/d4/struct__NPAGED__LOOKASIDE__LIST.html">PNPAGED_LOOKASIDE_LIST</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Lookaside</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l00780">780</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.
<p>
References <a class="el" href="../../d5/d8/ex_8h.html#a242">ExInterlockedPopEntrySList()</a>, and <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>.
<p>
Referenced by <a class="el" href="../../d6/d7/ex_8h-source.html#l01011">ExAllocateFromPPNPagedLookasideList()</a>, <a class="el" href="../../d0/d5/ex_2lookasid_8c-source.html#l00494">ExDeleteNPagedLookasideList()</a>, <a class="el" href="../../d6/d2/filelock_8c-source.html#l00400">FsRtlAllocateExclusiveLock()</a>, <a class="el" href="../../d6/d2/filelock_8c-source.html#l00427">FsRtlAllocateLockInfo()</a>, <a class="el" href="../../d6/d2/filelock_8c-source.html#l00418">FsRtlAllocateLockTreeNode()</a>, <a class="el" href="../../d6/d2/filelock_8c-source.html#l00391">FsRtlAllocateSharedLock()</a>, <a class="el" href="../../d6/d2/filelock_8c-source.html#l00409">FsRtlAllocateWaitingLock()</a>, and <a class="el" href="../../d0/d7/udfs_2strucsup_8c-source.html#l01301">UdfCreateIrpContext()</a>.
<p>
<pre class="fragment"><div>00786                    :
00787 
00788     This function removes (pops) the first entry from the specified
00789     nonpaged lookaside list.
00790 
00791 Arguments:
00792 
00793     Lookaside - Supplies a pointer to a nonpaged lookaside list structure.
00794 
00795 Return Value:
00796 
00797     If an entry is removed from the specified lookaside list, then the
00798     address of the entry is returned as the function value. Otherwise,
00799     NULL is returned.
00800 
00801 --*/
00802 
00803 {
00804 
00805     PVOID Entry;
00806 
00807     Lookaside-&gt;L.TotalAllocates += 1;
00808     Entry = <a class="code" href="../../d5/d8/ex_8h.html#a242">ExInterlockedPopEntrySList</a>(&amp;Lookaside-&gt;L.ListHead, &amp;Lookaside-&gt;Lock);
00809     <span class="keywordflow">if</span> (Entry == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00810         Lookaside-&gt;L.AllocateMisses += 1;
00811         Entry = (Lookaside-&gt;L.Allocate)(Lookaside-&gt;L.Type,
00812                                         Lookaside-&gt;L.Size,
00813                                         Lookaside-&gt;L.Tag);
00814     }
00815 
00816     <span class="keywordflow">return</span> Entry;
00817 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a252" doxytag="ex.h::ExAllocateFromPagedLookasideList" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> __inline PVOID ExAllocateFromPagedLookasideList           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d1/d8/struct__PAGED__LOOKASIDE__LIST.html">PPAGED_LOOKASIDE_LIST</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Lookaside</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l00906">906</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.
<p>
References <a class="el" href="../../d5/d8/ex_8h.html#a242">ExInterlockedPopEntrySList()</a>, and <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>.
<p>
Referenced by <a class="el" href="../../d7/d2/queue_8c-source.html#l03208">AllocQEntry()</a>, <a class="el" href="../../d7/d2/queue_8c-source.html#l02102">AllocQueue()</a>, <a class="el" href="../../d4/d5/kernel_2sendmsg_8c-source.html#l00164">AllocSMS()</a>, <a class="el" href="../../d0/d5/ex_2lookasid_8c-source.html#l00629">ExDeletePagedLookasideList()</a>, <a class="el" href="../../d2/d6/tunnel_8c-source.html#l00584">FsRtlAddToTunnelCache()</a>, <a class="el" href="../../d6/d2/filelock_8c-source.html#l01141">FsRtlAllocateFileLock()</a>, and <a class="el" href="../../d6/d3/prefxsup_8c-source.html#l00064">UdfInsertPrefix()</a>.
<p>
<pre class="fragment"><div>00912                    :
00913 
00914     This function removes (pops) the first entry from the specified
00915     paged lookaside list.
00916 
00917 Arguments:
00918 
00919     Lookaside - Supplies a pointer to a paged lookaside list structure.
00920 
00921 Return Value:
00922 
00923     If an entry is removed from the specified lookaside list, then the
00924     address of the entry is returned as the function value. Otherwise,
00925     NULL is returned.
00926 
00927 --*/
00928 
00929 {
00930 
00931     PVOID Entry;
00932 
00933     Lookaside-&gt;L.TotalAllocates += 1;
00934     Entry = <a class="code" href="../../d5/d8/ex_8h.html#a242">ExInterlockedPopEntrySList</a>(&amp;Lookaside-&gt;L.ListHead, NULL);
00935     <span class="keywordflow">if</span> (Entry == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00936         Lookaside-&gt;L.AllocateMisses += 1;
00937         Entry = (Lookaside-&gt;L.Allocate)(Lookaside-&gt;L.Type,
00938                                         Lookaside-&gt;L.Size,
00939                                         Lookaside-&gt;L.Tag);
00940     }
00941 
00942     <span class="keywordflow">return</span> Entry;
00943 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a254" doxytag="ex.h::ExAllocateFromPPNPagedLookasideList" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> __inline PVOID ExAllocateFromPPNPagedLookasideList           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d5/d8/ex_8h.html#a108">PP_NPAGED_LOOKASIDE_NUMBER</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Number</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l01011">1011</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.
<p>
References <a class="el" href="../../d6/d7/ex_8h-source.html#l00729">_GENERAL_LOOKASIDE::AllocateMisses</a>, <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l00780">ExAllocateFromNPagedLookasideList()</a>, <a class="el" href="../../d5/d8/ex_8h.html#a242">ExInterlockedPopEntrySList()</a>, <a class="el" href="../../d3/d6/alpha_2kdpcpu_8h-source.html#l00069">KeGetCurrentPrcb</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l00755">_NPAGED_LOOKASIDE_LIST::L</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l00724">_GENERAL_LOOKASIDE::ListHead</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l00756">_NPAGED_LOOKASIDE_LIST::Lock</a>, <a class="el" href="../../d5/d8/ex_8h.html#a331a204">LookasideMaximumList</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d5/d8/ex_8h.html#a105">PNPAGED_LOOKASIDE_LIST</a>, and <a class="el" href="../../d6/d7/ex_8h-source.html#l00727">_GENERAL_LOOKASIDE::TotalAllocates</a>.
<p>
Referenced by <a class="el" href="../../d5/d5/iosubs_8c-source.html#l00805">IoAllocateMdl()</a>, and <a class="el" href="../../d7/d9/obcreate_8c-source.html#l00583">ObpAllocateObjectNameBuffer()</a>.
<p>
<pre class="fragment"><div>01017                    :
01018 
01019     This function removes (pops) the first entry from the specified
01020     nonpaged per processor lookaside list.
01021 
01022 Arguments:
01023 
01024     Number - Supplies the per processor nonpaged lookaside list number.
01025 
01026 Return Value:
01027 
01028     If an entry is removed from the specified lookaside list, then the
01029     address of the entry is returned as the function value. Otherwise,
01030     NULL is returned.
01031 
01032 --*/
01033 
01034 {
01035 
01036     PVOID Entry;
01037     <a class="code" href="../../d1/d4/struct__NPAGED__LOOKASIDE__LIST.html">PNPAGED_LOOKASIDE_LIST</a> Lookaside;
01038     PKPRCB Prcb;
01039 
01040     <span class="comment">//</span>
01041     <span class="comment">// Get address of current processor block.</span>
01042     <span class="comment">//</span>
01043     <span class="comment">// N.B. It is possible to context switch during the allocation from a</span>
01044     <span class="comment">//      per processor nonpaged lookaside list, but this should happen</span>
01045     <span class="comment">//      infrequently and should not aversely effect the benefits of</span>
01046     <span class="comment">//      per processor lookaside lists.</span>
01047     <span class="comment">//</span>
01048 
01049     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>((Number &gt;= 0) &amp;&amp; (Number &lt; LookasideMaximumList));
01050 
01051     Prcb = <a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a2">KeGetCurrentPrcb</a>();
01052 
01053     <span class="comment">//</span>
01054     <span class="comment">// Attempt to allocate from the per processor lookaside list.</span>
01055     <span class="comment">//</span>
01056 
01057     Lookaside = Prcb-&gt;PPLookasideList[Number].P;
01058     Lookaside-&gt;<a class="code" href="../../d1/d4/struct__NPAGED__LOOKASIDE__LIST.html#o0">L</a>.<a class="code" href="../../d6/d1/struct__GENERAL__LOOKASIDE.html#o3">TotalAllocates</a> += 1;
01059     Entry = <a class="code" href="../../d5/d8/ex_8h.html#a242">ExInterlockedPopEntrySList</a>(&amp;Lookaside-&gt;<a class="code" href="../../d1/d4/struct__NPAGED__LOOKASIDE__LIST.html#o0">L</a>.<a class="code" href="../../d6/d1/struct__GENERAL__LOOKASIDE.html#o0">ListHead</a>, &amp;Lookaside-&gt;<a class="code" href="../../d1/d4/struct__NPAGED__LOOKASIDE__LIST.html#o1">Lock</a>);
01060 
01061     <span class="comment">//</span>
01062     <span class="comment">// If the per processor allocation attempt failed, then attempt to</span>
01063     <span class="comment">// allocate from the system lookaside list.</span>
01064     <span class="comment">//</span>
01065 
01066     <span class="keywordflow">if</span> (Entry == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01067         Lookaside-&gt;<a class="code" href="../../d1/d4/struct__NPAGED__LOOKASIDE__LIST.html#o0">L</a>.<a class="code" href="../../d6/d1/struct__GENERAL__LOOKASIDE.html#o4">AllocateMisses</a> += 1;
01068         Lookaside = Prcb-&gt;PPLookasideList[Number].<a class="code" href="../../d1/d4/struct__NPAGED__LOOKASIDE__LIST.html#o0">L</a>;
01069         Entry = <a class="code" href="../../d5/d8/ex_8h.html#a248">ExAllocateFromNPagedLookasideList</a>(Lookaside);
01070     }
01071 
01072     <span class="keywordflow">return</span> Entry;
01073 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a219" doxytag="ex.h::ExAllocatePool" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI PVOID ExAllocatePool           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d5/d8/ex_8h.html#a96">POOL_TYPE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>PoolType</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN SIZE_T&nbsp;</td>
          <td class="mdname" nowrap> <em>NumberOfBytes</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00910">910</a> of file <a class="el" href="../../d3/d1/ex_2pool_8c-source.html">ex/pool.c</a>.
<p>
References <a class="el" href="../../d6/d7/ex_8h-source.html#l00253">ExAllocatePoolWithTag</a>.
<p>
<pre class="fragment"><div>00917                    :
00918 
00919     This function allocates a block of <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a> of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> and
00920     returns a pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> allocated block.  This function <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> used to
00921     access both <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> page-aligned pools, and <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> list head entries (less than
00922     a page) pools.
00923 
00924     If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> number of bytes specifies a size that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> too large to be
00925     satisfied by <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> appropriate list, then <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> page-aligned
00926     <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a> allocator <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> used.  The allocated block will be page-aligned
00927     and a page-sized multiple.
00928 
00929     Otherwise, <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> appropriate <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a> list entry <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> used.  The allocated
00930     block will be 64-bit aligned, but will not be page aligned.  The
00931     <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a> allocator calculates <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> smallest number of POOL_BLOCK_SIZE
00932     that can be used to satisfy <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> request.  If there are no blocks
00933     available of <span class="keyword">this</span> size, then a block of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> next larger block size
00934     <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> allocated and split.  One piece <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> placed back into <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a>, and
00935     <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> other piece <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> used to satisfy <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> request.  If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> allocator
00936     reaches <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> paged-sized block list, and nothing <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> there, <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00937     page-aligned <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a> allocator <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> called.  The page <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> split and added
00938     to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a>...
00939 
00940 Arguments:
00941 
00942     PoolType - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> of <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a> to allocate.  If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a> <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a>
00943         <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> one of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <span class="stringliteral">"MustSucceed"</span> <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a> types, then <span class="keyword">this</span> call will
00944         always succeed and <span class="keywordflow">return</span> a pointer to allocated <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a>.
00945         Otherwise, <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> system cannot allocate <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> requested amount
00946         of memory a <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned.
00947 
00948         Valid <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a> types:
00949 
00950         <a class="code" href="../../d5/d8/ex_8h.html#a329a173">NonPagedPool</a>
00951         <a class="code" href="../../d5/d8/ex_8h.html#a329a174">PagedPool</a>
00952         <a class="code" href="../../d5/d8/ex_8h.html#a329a175">NonPagedPoolMustSucceed</a>,
00953         <a class="code" href="../../d5/d8/ex_8h.html#a329a177">NonPagedPoolCacheAligned</a>
00954         <a class="code" href="../../d5/d8/ex_8h.html#a329a178">PagedPoolCacheAligned</a>
00955         <a class="code" href="../../d5/d8/ex_8h.html#a329a179">NonPagedPoolCacheAlignedMustS</a>
00956 
00957     NumberOfBytes - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> number of bytes to allocate.
00958 
00959 Return Value:
00960 
00961     <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> - The PoolType <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> not one of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <span class="stringliteral">"MustSucceed"</span> <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a> types, and
00962         not enough <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a> exists to satisfy <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> request.
00963 
00964     NON-<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> - Returns a pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> allocated <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a>.
00965 
00966 --*/
00967 
00968 {
00969     <span class="keywordflow">return</span> <a class="code" href="../../d5/d8/ex_8h.html#a4">ExAllocatePoolWithTag</a> (PoolType,
00970                                   NumberOfBytes,
00971                                   'enoN');
00972 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a217" doxytag="ex.h::ExAllocatePoolSanityChecks" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID ExAllocatePoolSanityChecks           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d5/d8/ex_8h.html#a96">POOL_TYPE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>PoolType</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN SIZE_T&nbsp;</td>
          <td class="mdname" nowrap> <em>NumberOfBytes</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l03828">3828</a> of file <a class="el" href="../../d3/d1/ex_2pool_8c-source.html">ex/pool.c</a>.
<p>
References <a class="el" href="../../d7/d6/halmips_8h-source.html#l00086">APC_LEVEL</a>, <a class="el" href="../../d5/d1/pool_8h-source.html#l00050">BASE_POOL_TYPE_MASK</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00087">DISPATCH_LEVEL</a>, <a class="el" href="../../d0/d1/bugcheck_8c-source.html#l00428">KeBugCheckEx()</a>, <a class="el" href="../../d5/d1/pool_8h-source.html#l00052">MUST_SUCCEED_POOL_TYPE_MASK</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00599">PAGE_SIZE</a>, and <a class="el" href="../../d5/d8/ex_8h.html#a329a174">PagedPool</a>.
<p>
Referenced by <a class="el" href="../../d0/d5/verifier_8c-source.html#l01812">VeAllocatePoolWithTagPriority()</a>.
<p>
<pre class="fragment"><div>03835                    :
03836 
03837     This function performs sanity checks on <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> caller.
03838 
03839 Return Value:
03840 
03841     None.
03842 
03843 Environment:
03844 
03845     Only enabled as part of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> driver verification package.
03846 
03847 --*/
03848 
03849 {
03850     <span class="keywordflow">if</span> (NumberOfBytes == 0) {
03851         <a class="code" href="../../d9/d1/bugcheck_8c.html#a19">KeBugCheckEx</a> (DRIVER_VERIFIER_DETECTED_VIOLATION,
03852                       0x0,
03853                       KeGetCurrentIrql(),
03854                       PoolType,
03855                       NumberOfBytes);
03856     }
03857 
03858     <span class="keywordflow">if</span> ((PoolType &amp; <a class="code" href="../../d4/d2/pool_8h.html#a5">BASE_POOL_TYPE_MASK</a>) == <a class="code" href="../../d5/d8/ex_8h.html#a329a174">PagedPool</a>) {
03859 
03860         <span class="keywordflow">if</span> (KeGetCurrentIrql() &gt; <a class="code" href="../../d6/d7/halmips_8h.html#a52">APC_LEVEL</a>) {
03861 
03862             <a class="code" href="../../d9/d1/bugcheck_8c.html#a19">KeBugCheckEx</a> (DRIVER_VERIFIER_DETECTED_VIOLATION,
03863                           0x1,
03864                           KeGetCurrentIrql(),
03865                           PoolType,
03866                           NumberOfBytes);
03867         }
03868     }
03869     <span class="keywordflow">else</span> {
03870         <span class="keywordflow">if</span> (KeGetCurrentIrql() &gt; <a class="code" href="../../d6/d7/halmips_8h.html#a53">DISPATCH_LEVEL</a>) {
03871 
03872             <a class="code" href="../../d9/d1/bugcheck_8c.html#a19">KeBugCheckEx</a> (DRIVER_VERIFIER_DETECTED_VIOLATION,
03873                           0x2,
03874                           KeGetCurrentIrql(),
03875                           PoolType,
03876                           NumberOfBytes);
03877         }
03878     }
03879 
03880     <span class="keywordflow">if</span> (PoolType &amp; <a class="code" href="../../d4/d2/pool_8h.html#a6">MUST_SUCCEED_POOL_TYPE_MASK</a>) {
03881         <span class="keywordflow">if</span> (NumberOfBytes &gt; <a class="code" href="../../d6/d7/halmips_8h.html#a446">PAGE_SIZE</a>) {
03882             <a class="code" href="../../d9/d1/bugcheck_8c.html#a19">KeBugCheckEx</a> (DRIVER_VERIFIER_DETECTED_VIOLATION,
03883                           0x3,
03884                           KeGetCurrentIrql(),
03885                           PoolType,
03886                           NumberOfBytes);
03887         }
03888     }
03889 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a220" doxytag="ex.h::ExAllocatePoolWithQuota" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI PVOID ExAllocatePoolWithQuota           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d5/d8/ex_8h.html#a96">POOL_TYPE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>PoolType</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN SIZE_T&nbsp;</td>
          <td class="mdname" nowrap> <em>NumberOfBytes</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l02550">2550</a> of file <a class="el" href="../../d3/d1/ex_2pool_8c-source.html">ex/pool.c</a>.
<p>
References <a class="el" href="../../d6/d7/ex_8h-source.html#l00265">ExAllocatePoolWithQuotaTag</a>.
<p>
<pre class="fragment"><div>02557                    :
02558 
02559     This function allocates a block of <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a> of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a>,
02560     returns a pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> allocated block, and <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> binary buddy
02561     allocator was used to satisfy <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> request, charges <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a> quota to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
02562     current process.  This function <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> used to access both <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
02563     page-aligned pools, and <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> binary buddy.
02564 
02565     If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> number of bytes specifies a size that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> too large to be
02566     satisfied by <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> appropriate binary buddy <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a>, then <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
02567     page-aligned <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a> allocator <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> used.  The allocated block will be
02568     page-aligned and a page-sized multiple.  No quota <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> charged to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
02569     current process <span class="keywordflow">if</span> <span class="keyword">this</span> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <span class="keywordflow">case</span>.
02570 
02571     Otherwise, <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> appropriate binary buddy <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> used.  The allocated
02572     block will be 64-bit aligned, but will not be page aligned.  After
02573     <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> allocation completes, an attempt will be <a class="code" href="../../d3/d0/user32_8def.html#a107">made</a> to charge <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a>
02574     quota (of the appropriate type) to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> current process object.  If
02575     <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> quota charge succeeds, then <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a> block's header <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> adjusted
02576     to point to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> current process.  The process object <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> not
02577     dereferenced until <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> deallocated and <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> appropriate
02578     amount of quota <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> process.  Otherwise, <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a>
02579     deallocated, a <span class="stringliteral">"quota exceeded"</span> condition <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> raised.
02580 
02581 Arguments:
02582 
02583     PoolType - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> of <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a> to allocate.  If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a> <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a>
02584         <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> one of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <span class="stringliteral">"MustSucceed"</span> <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a> types and sufficient quota
02585         exists, then <span class="keyword">this</span> call will always succeed and <span class="keywordflow">return</span> a pointer
02586         to allocated <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a>.  Otherwise, <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> system cannot allocate
02587         <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> requested amount of memory a STATUS_INSUFFICIENT_RESOURCES
02588         status <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> raised.
02589 
02590     NumberOfBytes - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> number of bytes to allocate.
02591 
02592 Return Value:
02593 
02594     NON-<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> - Returns a pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> allocated <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a>.
02595 
02596     Unspecified - If insufficient quota exists to complete <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a>
02597         allocation, <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <span class="keywordflow">return</span> value <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> unspecified.
02598 
02599 --*/
02600 
02601 {
02602     <span class="keywordflow">return</span> (<a class="code" href="../../d5/d8/ex_8h.html#a5">ExAllocatePoolWithQuotaTag</a> (PoolType, NumberOfBytes, 'enoN'));
02603 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a223" doxytag="ex.h::ExAllocatePoolWithQuotaTag" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI PVOID ExAllocatePoolWithQuotaTag           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d5/d8/ex_8h.html#a96">POOL_TYPE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>PoolType</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN SIZE_T&nbsp;</td>
          <td class="mdname" nowrap> <em>NumberOfBytes</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Tag</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l02607">2607</a> of file <a class="el" href="../../d3/d1/ex_2pool_8c-source.html">ex/pool.c</a>.
<p>
References <a class="el" href="../../d5/d1/pool_8h-source.html#l00050">BASE_POOL_TYPE_MASK</a>, <a class="el" href="../../d5/d1/pool_8h-source.html#l00171">_POOL_HEADER::BlockSize</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l00253">ExAllocatePoolWithTag</a>, <a class="el" href="../../d6/d1/poolhack_8c-source.html#l00651">ExpAllocatePoolWithQuotaHandler()</a>, <a class="el" href="../../d1/d3/ex_2alpha_2raisests_8c-source.html#l00157">ExRaiseStatus()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d0/d1/bugcheck_8c-source.html#l00070">KeBugCheck()</a>, <a class="el" href="../../d3/d0/mm_8h-source.html#l01977">MmSpecialPoolEnd</a>, <a class="el" href="../../d3/d0/mm_8h-source.html#l01976">MmSpecialPoolStart</a>, <a class="el" href="../../d0/d2/ldrp_8h-source.html#l00370">NtGlobalFlag</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d5/d9/ob_8h-source.html#l00514">ObReferenceObject</a>, <a class="el" href="../../d6/d1/poolhack_8c-source.html#l00071">PAGE_ALIGNED</a>, <a class="el" href="../../d5/d1/pool_8h-source.html#l00096">POOL_BLOCK_SHIFT</a>, <a class="el" href="../../d6/d1/poolhack_8c-source.html#l00116">POOL_OVERHEAD</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00041">POOL_QUOTA_ENABLED</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l00143">POOL_QUOTA_FAIL_INSTEAD_OF_RAISE</a>, <a class="el" href="../../d5/d1/pool_8h-source.html#l00073">POOL_QUOTA_MASK</a>, <a class="el" href="../../d5/d8/ex_8h.html#a96">POOL_TYPE</a>, <a class="el" href="../../d6/d1/poolhack_8c-source.html#l00112">_POOL_HEADER::ProcessBilled</a>, <a class="el" href="../../d1/d1/psquota_8c-source.html#l00246">PsChargePoolQuota()</a>, <a class="el" href="../../d2/d8/ps_8h-source.html#l00643">PsGetCurrentProcess</a>, <a class="el" href="../../d2/d8/ps_8h-source.html#l00579">PsInitialSystemProcess</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
<pre class="fragment"><div>02615                    :
02616 
02617     This function allocates a block of <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a> of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a>,
02618     returns a pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> allocated block, and <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> binary buddy
02619     allocator was used to satisfy <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> request, charges <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a> quota to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
02620     current process.  This function <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> used to access both <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
02621     page-aligned pools, and <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> binary buddy.
02622 
02623     If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> number of bytes specifies a size that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> too large to be
02624     satisfied by <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> appropriate binary buddy <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a>, then <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
02625     page-aligned <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a> allocator <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> used.  The allocated block will be
02626     page-aligned and a page-sized multiple.  No quota <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> charged to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
02627     current process <span class="keywordflow">if</span> <span class="keyword">this</span> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <span class="keywordflow">case</span>.
02628 
02629     Otherwise, <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> appropriate binary buddy <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> used.  The allocated
02630     block will be 64-bit aligned, but will not be page aligned.  After
02631     <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> allocation completes, an attempt will be <a class="code" href="../../d3/d0/user32_8def.html#a107">made</a> to charge <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a>
02632     quota (of the appropriate type) to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> current process object.  If
02633     <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> quota charge succeeds, then <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a> block's header <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> adjusted
02634     to point to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> current process.  The process object <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> not
02635     dereferenced until <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> deallocated and <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> appropriate
02636     amount of quota <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> process.  Otherwise, <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a>
02637     deallocated, a <span class="stringliteral">"quota exceeded"</span> condition <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> raised.
02638 
02639 Arguments:
02640 
02641     PoolType - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> of <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a> to allocate.  If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a> <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a>
02642         <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> one of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <span class="stringliteral">"MustSucceed"</span> <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a> types and sufficient quota
02643         exists, then <span class="keyword">this</span> call will always succeed and <span class="keywordflow">return</span> a pointer
02644         to allocated <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a>.  Otherwise, <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> system cannot allocate
02645         <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> requested amount of memory a STATUS_INSUFFICIENT_RESOURCES
02646         status <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> raised.
02647 
02648     NumberOfBytes - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> number of bytes to allocate.
02649 
02650 Return Value:
02651 
02652     NON-<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> - Returns a pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> allocated <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a>.
02653 
02654     Unspecified - If insufficient quota exists to complete <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a>
02655         allocation, <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <span class="keywordflow">return</span> value <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> unspecified.
02656 
02657 --*/
02658 
02659 {
02660     PVOID p;
02661     <a class="code" href="../../d0/d4/struct__EPROCESS.html">PEPROCESS</a> Process;
02662     <a class="code" href="../../d5/d8/struct__POOL__HEADER.html">PPOOL_HEADER</a> Entry;
02663     LOGICAL IgnoreQuota;
02664     LOGICAL RaiseOnQuotaFailure;
02665 
02666     IgnoreQuota = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
02667     RaiseOnQuotaFailure = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
02668 
02669     <span class="keywordflow">if</span> ( PoolType &amp; <a class="code" href="../../d5/d8/ex_8h.html#a2">POOL_QUOTA_FAIL_INSTEAD_OF_RAISE</a> ) {
02670         RaiseOnQuotaFailure = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
02671         PoolType &amp;= ~<a class="code" href="../../d5/d8/ex_8h.html#a2">POOL_QUOTA_FAIL_INSTEAD_OF_RAISE</a>;
02672     }
02673 
02674     <span class="keywordflow">if</span> ((<a class="code" href="../../d2/d2/ex_2pool_8c.html#a0">POOL_QUOTA_ENABLED</a> == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>)
02675 <span class="preprocessor">#if i386 &amp;&amp; !FPO</span>
02676 <span class="preprocessor"></span>            || (<a class="code" href="../../d9/d2/ldrp_8h.html#a33">NtGlobalFlag</a> &amp; FLG_KERNEL_STACK_TRACE_DB)
02677 <span class="preprocessor">#endif // i386 &amp;&amp; !FPO</span>
02678 <span class="preprocessor"></span>       ) {
02679         IgnoreQuota = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
02680     } <span class="keywordflow">else</span> {
02681         PoolType = (<a class="code" href="../../d5/d8/ex_8h.html#a96">POOL_TYPE</a>)((UCHAR)PoolType + <a class="code" href="../../d4/d2/pool_8h.html#a11">POOL_QUOTA_MASK</a>);
02682     }
02683 
02684     p = <a class="code" href="../../d5/d8/ex_8h.html#a4">ExAllocatePoolWithTag</a>(PoolType, NumberOfBytes, Tag);
02685 
02686     <span class="comment">//</span>
02687     <span class="comment">// Note - NULL is page aligned.</span>
02688     <span class="comment">//</span>
02689 
02690     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d2/poolhack_8c.html#a5">PAGE_ALIGNED</a>(p) &amp;&amp; !IgnoreQuota) {
02691 
02692         <span class="keywordflow">if</span> ((p &gt;= <a class="code" href="../../d2/d1/mm_8h.html#a160">MmSpecialPoolStart</a>) &amp;&amp; (p &lt; <a class="code" href="../../d2/d1/mm_8h.html#a161">MmSpecialPoolEnd</a>)) {
02693             <span class="keywordflow">return</span> p;
02694         }
02695 
02696 <span class="preprocessor">#if POOL_CACHE_SUPPORTED</span>
02697 <span class="preprocessor"></span>
02698         <span class="comment">//</span>
02699         <span class="comment">// Align entry on pool allocation boundary.</span>
02700         <span class="comment">//</span>
02701 
02702         <span class="keywordflow">if</span> (((ULONG)p &amp; POOL_CACHE_CHECK) == 0) {
02703             Entry = (<a class="code" href="../../d5/d8/struct__POOL__HEADER.html">PPOOL_HEADER</a>)((ULONG)p - PoolCacheSize);
02704         } <span class="keywordflow">else</span> {
02705             Entry = (<a class="code" href="../../d5/d8/struct__POOL__HEADER.html">PPOOL_HEADER</a>)((PCH)p - <a class="code" href="../../d5/d2/poolhack_8c.html#a6">POOL_OVERHEAD</a>);
02706         }
02707 
02708 <span class="preprocessor">#else</span>
02709 <span class="preprocessor"></span>        Entry = (<a class="code" href="../../d5/d8/struct__POOL__HEADER.html">PPOOL_HEADER</a>)((PCH)p - <a class="code" href="../../d5/d2/poolhack_8c.html#a6">POOL_OVERHEAD</a>);
02710 <span class="preprocessor">#endif //POOL_CACHE_SUPPORTED</span>
02711 <span class="preprocessor"></span>
02712         Process = <a class="code" href="../../d1/d9/ps_8h.html#a19">PsGetCurrentProcess</a>();
02713 
02714         <span class="comment">//</span>
02715         <span class="comment">// Catch exception and back out allocation if necessary</span>
02716         <span class="comment">//</span>
02717 
02718         <span class="keywordflow">try</span> {
02719 
02720             Entry-&gt;<a class="code" href="../../d5/d8/struct__POOL__HEADER.html#o2">ProcessBilled</a> = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
02721 
02722             <span class="keywordflow">if</span> (Process != <a class="code" href="../../d1/d9/ps_8h.html#a53">PsInitialSystemProcess</a>) {
02723 
02724                 <a class="code" href="../../d0/d2/psquota_8c.html#a2">PsChargePoolQuota</a>(Process,
02725                                  PoolType &amp; BASE_POOL_TYPE_MASK,
02726                                  (ULONG)(Entry-&gt;<a class="code" href="../../d5/d8/struct__POOL__HEADER.html#o6">BlockSize</a> &lt;&lt; POOL_BLOCK_SHIFT));
02727 
02728                 <a class="code" href="../../d4/d0/ob_8h.html#a15">ObReferenceObject</a>(Process);
02729                 Entry-&gt;<a class="code" href="../../d5/d8/struct__POOL__HEADER.html#o2">ProcessBilled</a> = Process;
02730             }
02731 
02732         } except ( <a class="code" href="../../d5/d2/poolhack_8c.html#a33">ExpAllocatePoolWithQuotaHandler</a>(GetExceptionCode(),p,RaiseOnQuotaFailure)) {
02733             <span class="keywordflow">if</span> ( RaiseOnQuotaFailure ) {
02734                 <a class="code" href="../../d9/d1/bugcheck_8c.html#a13">KeBugCheck</a>(GetExceptionCode());
02735             }
02736             <span class="keywordflow">else</span> {
02737                 p = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
02738             }
02739         }
02740 
02741     } <span class="keywordflow">else</span> {
02742         <span class="keywordflow">if</span> ( !p &amp;&amp; RaiseOnQuotaFailure ) {
02743             <a class="code" href="../../d5/d8/ex_8h.html#a303">ExRaiseStatus</a>(STATUS_INSUFFICIENT_RESOURCES);
02744         }
02745     }
02746 
02747     <span class="keywordflow">return</span> p;
02748 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a221" doxytag="ex.h::ExAllocatePoolWithTag" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI PVOID NTAPI ExAllocatePoolWithTag           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d5/d8/ex_8h.html#a96">POOL_TYPE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>PoolType</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN SIZE_T&nbsp;</td>
          <td class="mdname" nowrap> <em>NumberOfBytes</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Tag</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l01104">1104</a> of file <a class="el" href="../../d3/d1/ex_2pool_8c-source.html">ex/pool.c</a>.
<p>
References <a class="el" href="../../d6/d7/ex_8h-source.html#l00730">_GENERAL_LOOKASIDE::AllocateHits</a>, <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00205">ASSERT_ALLOCATE_IRQL</a>, <a class="el" href="../../d5/d1/pool_8h-source.html#l00050">BASE_POOL_TYPE_MASK</a>, <a class="el" href="../../d5/d1/pool_8h-source.html#l00171">_POOL_HEADER::BlockSize</a>, <a class="el" href="../../d3/d0/mm_8h-source.html#l00141">BYTES_TO_PAGES</a>, <a class="el" href="../../d5/d1/pool_8h-source.html#l00054">CACHE_ALIGNED_POOL_TYPE_MASK</a>, <a class="el" href="../../d2/d2/ex_2pool_8c.html#a38">CacheOverhead</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00173">CHECK_LIST</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00239">CHECK_LOOKASIDE_LIST</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00184">CHECK_POOL_HEADER</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00418">DECODE_POOL_INDEX</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00417">ENCODE_POOL_INDEX</a>, <a class="el" href="../../d5/d8/ex_8h.html#a242">ExInterlockedPopEntrySList()</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l02324">ExpAddTagForBigPages()</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00853">ExpCheckSingleFilter()</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l02000">ExpInsertPoolTracker()</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00429">ExpNumberOfPagedPools</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00452">ExpPagedPoolDescriptor</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00462">ExpPoolIndex</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00349">ExpSessionPoolDescriptor</a>, <a class="el" href="../../d1/d3/ex_2alpha_2raisests_8c-source.html#l00157">ExRaiseStatus()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d5/d8/ex_8h.html#a330a194">HighPoolPriority</a>, <a class="el" href="../../d2/d9/cmchek_8c-source.html#l00095">Index</a>, <a class="el" href="../../d6/d2/i386_8h-source.html#l02725">Isx86FeaturePresent</a>, <a class="el" href="../../d3/d6/alpha_2kdpcpu_8h-source.html#l00069">KeGetCurrentPrcb</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00987">KernelVerifier</a>, <a class="el" href="../../d6/d2/i386_8h-source.html#l02709">KF_CMPXCHG8B</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l00755">_NPAGED_LOOKASIDE_LIST::L</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l00724">_GENERAL_LOOKASIDE::ListHead</a>, <a class="el" href="../../d6/d1/poolhack_8c-source.html#l00100">_POOL_DESCRIPTOR::ListHeads</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00367">Lock</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l00756">_NPAGED_LOOKASIDE_LIST::Lock</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00500">LOCK_IF_PAGED_POOL</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00492">LOCK_POOL</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00098">LOCK_POOL_GRANULAR</a>, <a class="el" href="../../d5/d1/pool_8h-source.html#l00125">_POOL_DESCRIPTOR::LockAddress</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00420">MARK_POOL_HEADER_ALLOCATED</a>, <a class="el" href="../../d2/d5/allocpag_8c-source.html#l00807">MiAllocatePoolPages()</a>, <a class="el" href="../../d2/d5/allocpag_8c-source.html#l00505">MiSessionPoolAllocated()</a>, <a class="el" href="../../d2/d5/allocpag_8c-source.html#l03408">MmAllocateSpecialPool()</a>, <a class="el" href="../../d3/d0/mm_8h-source.html#l01975">MmSpecialPoolTag</a>, <a class="el" href="../../d1/d6/allocpag_8c.html#a38">MmSqueezeBadTags()</a>, <a class="el" href="../../d5/d1/pool_8h-source.html#l00052">MUST_SUCCEED_POOL_TYPE_MASK</a>, <a class="el" href="../../d5/d8/ex_8h.html#a329a173">NonPagedPool</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00454">NonPagedPoolLock</a>, <a class="el" href="../../d5/d8/ex_8h.html#a329a175">NonPagedPoolMustSucceed</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d5/d1/pool_8h-source.html#l00110">PAGE_END</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00599">PAGE_SIZE</a>, <a class="el" href="../../d5/d8/ex_8h.html#a329a174">PagedPool</a>, <a class="el" href="../../d3/d0/mm_8h-source.html#l02153">PERFINFO_ADDPOOLPAGE</a>, <a class="el" href="../../d3/d0/mm_8h-source.html#l02155">PERFINFO_BIGPOOLALLOC</a>, <a class="el" href="../../d3/d0/mm_8h-source.html#l02170">PERFINFO_EXALLOCATEPOOLWITHTAG_DECL</a>, <a class="el" href="../../d3/d0/mm_8h-source.html#l02203">PERFINFO_POOLALLOC</a>, <a class="el" href="../../d3/d0/mm_8h-source.html#l02204">PERFINFO_POOLALLOC_ADDR</a>, <a class="el" href="../../d5/d1/pool_8h-source.html#l00096">POOL_BLOCK_SHIFT</a>, <a class="el" href="../../d6/d1/poolhack_8c-source.html#l00117">POOL_BUDDY_MAX</a>, <a class="el" href="../../d5/d1/pool_8h-source.html#l00060">POOL_DRIVER_MASK</a>, <a class="el" href="../../d6/d1/poolhack_8c-source.html#l00068">POOL_LIST_HEADS</a>, <a class="el" href="../../d6/d1/poolhack_8c-source.html#l00116">POOL_OVERHEAD</a>, <a class="el" href="../../d5/d1/pool_8h-source.html#l00073">POOL_QUOTA_MASK</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l00144">POOL_RAISE_IF_ALLOCATION_FAILURE</a>, <a class="el" href="../../d1/d8/ntosdef_8h-source.html#l00115">POOL_SMALL_LISTS</a>, <a class="el" href="../../d5/d1/pool_8h-source.html#l00214">POOL_SMALLEST_BLOCK</a>, <a class="el" href="../../d5/d8/ex_8h.html#a96">POOL_TYPE</a>, <a class="el" href="../../d5/d1/pool_8h-source.html#l00058">POOL_VERIFIER_MASK</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00356">PoolBigPageTable</a>, <a class="el" href="../../d5/d1/pool_8h-source.html#l00119">_POOL_DESCRIPTOR::PoolIndex</a>, <a class="el" href="../../d5/d1/pool_8h-source.html#l00181">_POOL_HEADER::PoolTag</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00352">PoolTrackTable</a>, <a class="el" href="../../d6/d1/poolhack_8c-source.html#l00106">_POOL_HEADER::PoolType</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00451">PoolVector</a>, <a class="el" href="../../d4/d2/pool_8h.html#a29">PPOOL_BLOCK</a>, <a class="el" href="../../d6/d1/poolhack_8c-source.html#l00114">PPOOL_HEADER</a>, <a class="el" href="../../d5/d1/pool_8h-source.html#l00168">_POOL_HEADER::PreviousSize</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00162">PrivateInsertHeadList</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00151">PrivateInsertTailList</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00131">PrivateIsListEmpty</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00134">PrivateRemoveHeadList</a>, <a class="el" href="../../d3/d0/mm_8h-source.html#l00117">ROUND_TO_PAGES</a>, <a class="el" href="../../d6/d1/ppc_2getcalr_8c-source.html#l00038">RtlGetCallersAddress()</a>, <a class="el" href="../../d5/d1/pool_8h-source.html#l00120">_POOL_DESCRIPTOR::RunningAllocs</a>, <a class="el" href="../../d5/d1/pool_8h-source.html#l00056">SESSION_POOL_MASK</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l00727">_GENERAL_LOOKASIDE::TotalAllocates</a>, <a class="el" href="../../d5/d1/pool_8h-source.html#l00123">_POOL_DESCRIPTOR::TotalBigPages</a>, <a class="el" href="../../d5/d1/pool_8h-source.html#l00122">_POOL_DESCRIPTOR::TotalPages</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00559">UNLOCK_IF_PAGED_POOL</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00551">UNLOCK_POOL</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00099">UNLOCK_POOL_GRANULAR</a>, and <a class="el" href="../../d9/d5/verifier_8c.html#a58">VeAllocatePoolWithTagPriority()</a>.
<p>
<pre class="fragment"><div>01112                    :
01113 
01114     This function allocates a block of <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a> of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> and
01115     returns a pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> allocated block. This function <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> used to
01116     access both <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> page-aligned pools and <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> list head entries (less
01117     than a page) pools.
01118 
01119     If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> number of bytes specifies a size that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> too large to be
01120     satisfied by <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> appropriate list, then <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> page-aligned <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a>
01121     allocator <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> used. The allocated block will be page-aligned and a
01122     page-sized multiple.
01123 
01124     Otherwise, <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> appropriate <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a> list entry <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> used. The allocated
01125     block will be 64-bit aligned, but will not be page aligned. The
01126     <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a> allocator calculates <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> smallest number of POOL_BLOCK_SIZE
01127     that can be used to satisfy <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> request. If there are no blocks
01128     available of <span class="keyword">this</span> size, then a block of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> next larger block size
01129     <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> allocated and split. One piece <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> placed back into <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a>, and
01130     <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> other piece <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> used to satisfy <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> request. If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> allocator
01131     reaches <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> paged-sized block list, and nothing <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> there, <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
01132     page-aligned <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a> allocator <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> called. The page <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> split and added
01133     to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a>.
01134 
01135 Arguments:
01136 
01137     PoolType - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> of <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a> to allocate. If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a> <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a>
01138         <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> one of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <span class="stringliteral">"MustSucceed"</span> <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a> types, then <span class="keyword">this</span> call will
01139         always succeed and <span class="keywordflow">return</span> a pointer to allocated <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a>. Otherwise,
01140         <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> system cannot allocate <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> requested amount of memory a
01141         <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned.
01142 
01143         Valid <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a> types:
01144 
01145         <a class="code" href="../../d5/d8/ex_8h.html#a329a173">NonPagedPool</a>
01146         <a class="code" href="../../d5/d8/ex_8h.html#a329a174">PagedPool</a>
01147         <a class="code" href="../../d5/d8/ex_8h.html#a329a175">NonPagedPoolMustSucceed</a>,
01148         <a class="code" href="../../d5/d8/ex_8h.html#a329a177">NonPagedPoolCacheAligned</a>
01149         <a class="code" href="../../d5/d8/ex_8h.html#a329a178">PagedPoolCacheAligned</a>
01150         <a class="code" href="../../d5/d8/ex_8h.html#a329a179">NonPagedPoolCacheAlignedMustS</a>
01151 
01152     Tag - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> caller's identifying tag.
01153 
01154     NumberOfBytes - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> number of bytes to allocate.
01155 
01156 Return Value:
01157 
01158     <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> - The PoolType <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> not one of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <span class="stringliteral">"MustSucceed"</span> <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a> types, and
01159         not enough <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a> exists to satisfy <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> request.
01160 
01161     NON-<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> - Returns a pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> allocated <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a>.
01162 
01163 --*/
01164 
01165 {
01166     PVOID Block;
01167     <a class="code" href="../../d5/d8/struct__POOL__HEADER.html">PPOOL_HEADER</a> Entry;
01168     <a class="code" href="../../d1/d4/struct__NPAGED__LOOKASIDE__LIST.html">PNPAGED_LOOKASIDE_LIST</a> LookasideList;
01169     <a class="code" href="../../d5/d8/struct__POOL__HEADER.html">PPOOL_HEADER</a> NextEntry;
01170     <a class="code" href="../../d5/d8/struct__POOL__HEADER.html">PPOOL_HEADER</a> SplitEntry;
01171     KIRQL LockHandle;
01172     <a class="code" href="../../d4/d8/struct__POOL__DESCRIPTOR.html">PPOOL_DESCRIPTOR</a> PoolDesc;
01173     ULONG <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>;
01174     ULONG ListNumber;
01175     ULONG NeededSize;
01176     ULONG PoolIndex;
01177     <a class="code" href="../../d5/d8/ex_8h.html#a96">POOL_TYPE</a> CheckType;
01178     <a class="code" href="../../d5/d8/ex_8h.html#a96">POOL_TYPE</a> RequestType;
01179     PLIST_ENTRY ListHead;
01180     <a class="code" href="../../d5/d8/ex_8h.html#a96">POOL_TYPE</a> NewPoolType;
01181     LOGICAL GlobalSpace;
01182     ULONG IsLargeSessionAllocation;
01183     PKPRCB Prcb;
01184     ULONG NumberOfPages;
01185     PVOID CallingAddress;
01186     PVOID CallersCaller;
01187 
01188 <span class="preprocessor">#if POOL_CACHE_SUPPORTED</span>
01189 <span class="preprocessor"></span>    ULONG <a class="code" href="../../d2/d2/ex_2pool_8c.html#a38">CacheOverhead</a>;
01190 <span class="preprocessor">#else</span>
01191 <span class="preprocessor"></span><span class="preprocessor">#define CacheOverhead POOL_OVERHEAD</span>
01192 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
01193 <span class="preprocessor"></span>
01194     <a class="code" href="../../d2/d1/mm_8h.html#a49">PERFINFO_EXALLOCATEPOOLWITHTAG_DECL</a>();
01195 
01196 <span class="preprocessor">#ifdef _NTOSKRNL_VERIFIER_</span>
01197 <span class="preprocessor"></span>
01198     <span class="keywordflow">if</span> (<a class="code" href="../../d2/d2/ex_2pool_8c.html#a61">KernelVerifier</a> == <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>) {
01199 <span class="preprocessor">#if defined (_X86_)</span>
01200 <span class="preprocessor"></span>        <a class="code" href="../../d5/d2/ppc_2getcalr_8c.html#a0">RtlGetCallersAddress</a>(&amp;CallingAddress, &amp;CallersCaller);
01201 <span class="preprocessor">#else</span>
01202 <span class="preprocessor"></span>        CallingAddress = (PVOID)_ReturnAddress();
01203 <span class="preprocessor">#endif</span>
01204 <span class="preprocessor"></span>
01205         <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(NumberOfBytes != 0);
01206         <a class="code" href="../../d2/d2/ex_2pool_8c.html#a19">ASSERT_ALLOCATE_IRQL</a>(PoolType, NumberOfBytes);
01207 
01208         <span class="keywordflow">if</span> ((PoolType &amp; <a class="code" href="../../d4/d2/pool_8h.html#a10">POOL_DRIVER_MASK</a>) == 0) {
01209 
01210             <span class="comment">//</span>
01211             <span class="comment">// Use the Driver Verifier pool framework.  Note this will</span>
01212             <span class="comment">// result in a recursive callback to this routine.</span>
01213             <span class="comment">//</span>
01214 
01215             <span class="keywordflow">return</span> <a class="code" href="../../d9/d5/verifier_8c.html#a58">VeAllocatePoolWithTagPriority</a> (PoolType | POOL_DRIVER_MASK,
01216                                                   NumberOfBytes,
01217                                                   Tag,
01218                                                   HighPoolPriority,
01219                                                   CallingAddress);
01220         }
01221         PoolType &amp;= ~<a class="code" href="../../d4/d2/pool_8h.html#a10">POOL_DRIVER_MASK</a>;
01222     }
01223 
01224 <span class="preprocessor">#else</span>
01225 <span class="preprocessor"></span>
01226     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(NumberOfBytes != 0);
01227     <a class="code" href="../../d2/d2/ex_2pool_8c.html#a19">ASSERT_ALLOCATE_IRQL</a>(PoolType, NumberOfBytes);
01228 
01229 <span class="preprocessor">#endif</span>
01230 <span class="preprocessor"></span>
01231     <span class="comment">//</span>
01232     <span class="comment">// Isolate the base pool type and select a pool from which to allocate</span>
01233     <span class="comment">// the specified block size.</span>
01234     <span class="comment">//</span>
01235 
01236     CheckType = PoolType &amp; <a class="code" href="../../d4/d2/pool_8h.html#a5">BASE_POOL_TYPE_MASK</a>;
01237 
01238     <span class="comment">//</span>
01239     <span class="comment">// Currently only Hydra paged pool allocations come from the per session</span>
01240     <span class="comment">// pools.  Nonpaged Hydra pool allocations still come from global pool.</span>
01241     <span class="comment">//</span>
01242 
01243     <span class="keywordflow">if</span> (PoolType &amp; <a class="code" href="../../d4/d2/pool_8h.html#a8">SESSION_POOL_MASK</a>) {
01244         <span class="keywordflow">if</span> (<a class="code" href="../../d2/d2/ex_2pool_8c.html#a40">ExpSessionPoolDescriptor</a> == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01245 
01246             <span class="comment">//</span>
01247             <span class="comment">// Promote this down to support common binaries.</span>
01248             <span class="comment">//</span>
01249 
01250             PoolType &amp;= ~<a class="code" href="../../d4/d2/pool_8h.html#a8">SESSION_POOL_MASK</a>;
01251             PoolDesc = <a class="code" href="../../d2/d2/ex_2pool_8c.html#a54">PoolVector</a>[CheckType];
01252             GlobalSpace = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01253         }
01254         <span class="keywordflow">else</span> {
01255             GlobalSpace = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01256             <span class="keywordflow">if</span> (CheckType == <a class="code" href="../../d5/d8/ex_8h.html#a329a173">NonPagedPool</a>) {
01257                 PoolDesc = <a class="code" href="../../d2/d2/ex_2pool_8c.html#a54">PoolVector</a>[CheckType];
01258             }
01259             <span class="keywordflow">else</span> {
01260                 PoolDesc = <a class="code" href="../../d2/d2/ex_2pool_8c.html#a40">ExpSessionPoolDescriptor</a>;
01261             }
01262         }
01263     }
01264     <span class="keywordflow">else</span> {
01265         PoolDesc = <a class="code" href="../../d2/d2/ex_2pool_8c.html#a54">PoolVector</a>[CheckType];
01266         GlobalSpace = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01267     }
01268 
01269     <span class="comment">//</span>
01270     <span class="comment">// Check to determine if the requested block can be allocated from one</span>
01271     <span class="comment">// of the pool lists or must be directly allocated from virtual memory.</span>
01272     <span class="comment">//</span>
01273 
01274     <span class="keywordflow">if</span> (NumberOfBytes &gt; <a class="code" href="../../d5/d2/poolhack_8c.html#a7">POOL_BUDDY_MAX</a>) {
01275 
01276         <span class="comment">//</span>
01277         <span class="comment">// The requested size is greater than the largest block maintained</span>
01278         <span class="comment">// by allocation lists.</span>
01279         <span class="comment">//</span>
01280 
01281         <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a> ((NumberOfBytes &lt;= PAGE_SIZE) ||
01282                 (ExpPagedPoolDescriptor == (<a class="code" href="../../d4/d8/struct__POOL__DESCRIPTOR.html">PPOOL_DESCRIPTOR</a>)0) ||
01283                 ((PoolType &amp; MUST_SUCCEED_POOL_TYPE_MASK) == 0));
01284 
01285         <a class="code" href="../../d2/d2/ex_2pool_8c.html#a33">LOCK_POOL</a>(PoolDesc, LockHandle);
01286 
01287         PoolDesc-&gt;<a class="code" href="../../d4/d8/struct__POOL__DESCRIPTOR.html#o6">RunningAllocs</a> += 1;
01288 
01289         IsLargeSessionAllocation = (PoolType &amp; <a class="code" href="../../d4/d2/pool_8h.html#a8">SESSION_POOL_MASK</a>);
01290 
01291         RequestType = (PoolType &amp; (<a class="code" href="../../d4/d2/pool_8h.html#a5">BASE_POOL_TYPE_MASK</a> | <a class="code" href="../../d4/d2/pool_8h.html#a8">SESSION_POOL_MASK</a> | <a class="code" href="../../d4/d2/pool_8h.html#a9">POOL_VERIFIER_MASK</a>));
01292 
01293 RetryWithMustSucceed:
01294         Entry = (<a class="code" href="../../d5/d8/struct__POOL__HEADER.html">PPOOL_HEADER</a>) <a class="code" href="../../d1/d6/allocpag_8c.html#a54">MiAllocatePoolPages</a> (RequestType,
01295                                                     NumberOfBytes,
01296                                                     IsLargeSessionAllocation);
01297 
01298         <span class="comment">//</span>
01299         <span class="comment">// Large session pool allocations are accounted for directly by</span>
01300         <span class="comment">// the memory manager so no need to call MiSessionPoolAllocated here.</span>
01301         <span class="comment">//</span>
01302 
01303         <span class="keywordflow">if</span> (Entry != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01304 
01305             NumberOfPages = <a class="code" href="../../d2/d1/mm_8h.html#a5">BYTES_TO_PAGES</a>(NumberOfBytes);
01306             PoolDesc-&gt;<a class="code" href="../../d4/d8/struct__POOL__DESCRIPTOR.html#o8">TotalBigPages</a> += NumberOfPages;
01307 
01308             <a class="code" href="../../d2/d2/ex_2pool_8c.html#a35">UNLOCK_POOL</a>(PoolDesc, LockHandle);
01309 
01310             <span class="keywordflow">if</span> ((<a class="code" href="../../d2/d2/ex_2pool_8c.html#a45">PoolBigPageTable</a>) &amp;&amp; (IsLargeSessionAllocation == 0)) {
01311 
01312                 <span class="keywordflow">if</span> (<a class="code" href="../../d2/d2/ex_2pool_8c.html#a67">ExpAddTagForBigPages</a>((PVOID)Entry,
01313                                          Tag,
01314                                          NumberOfPages) == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
01315                     Tag = ' GIB';
01316                 }
01317 
01318                 <a class="code" href="../../d2/d2/ex_2pool_8c.html#a65">ExpInsertPoolTracker</a> (Tag,
01319                                       (ULONG) <a class="code" href="../../d2/d1/mm_8h.html#a4">ROUND_TO_PAGES</a>(NumberOfBytes),
01320                                       PoolType);
01321             }
01322 
01323         } <span class="keywordflow">else</span> {
01324             <span class="keywordflow">if</span> (PoolType &amp; <a class="code" href="../../d4/d2/pool_8h.html#a6">MUST_SUCCEED_POOL_TYPE_MASK</a>) {
01325                 RequestType |= <a class="code" href="../../d4/d2/pool_8h.html#a6">MUST_SUCCEED_POOL_TYPE_MASK</a>;
01326                 <span class="keywordflow">goto</span> RetryWithMustSucceed;
01327             }
01328 
01329             <a class="code" href="../../d2/d2/ex_2pool_8c.html#a35">UNLOCK_POOL</a>(PoolDesc, LockHandle);
01330 
01331             KdPrint((<span class="stringliteral">"EX: ExAllocatePool (%p, 0x%x ) returning NULL\n"</span>,
01332                 NumberOfBytes,
01333                 PoolType));
01334 
01335             <span class="keywordflow">if</span> ((PoolType &amp; <a class="code" href="../../d5/d8/ex_8h.html#a3">POOL_RAISE_IF_ALLOCATION_FAILURE</a>) != 0) {
01336                 <a class="code" href="../../d5/d8/ex_8h.html#a303">ExRaiseStatus</a>(STATUS_INSUFFICIENT_RESOURCES);
01337             }
01338         }
01339 
01340         <a class="code" href="../../d2/d1/mm_8h.html#a34">PERFINFO_BIGPOOLALLOC</a>(PoolType, Tag, NumberOfBytes, Entry);
01341 
01342         <span class="keywordflow">return</span> Entry;
01343     }
01344 
01345     <span class="comment">//</span>
01346     <span class="comment">// The requested size is less than or equal to the size of the</span>
01347     <span class="comment">// maximum block maintained by the allocation lists.</span>
01348     <span class="comment">//</span>
01349 
01350     <a class="code" href="../../d2/d1/mm_8h.html#a82">PERFINFO_POOLALLOC</a>(PoolType, Tag, NumberOfBytes);
01351 
01352     <span class="comment">//</span>
01353     <span class="comment">// Check for a special pool tag match by actual tag.</span>
01354     <span class="comment">//</span>
01355 
01356     <span class="keywordflow">if</span> (<a class="code" href="../../d2/d1/mm_8h.html#a159">MmSpecialPoolTag</a> != 0 &amp;&amp; NumberOfBytes != 0) {
01357 
01358 <span class="preprocessor">#ifndef NO_POOL_CHECKS</span>
01359 <span class="preprocessor"></span>        Entry = <a class="code" href="../../d1/d6/allocpag_8c.html#a38">MmSqueezeBadTags</a> (NumberOfBytes, Tag, CheckType, 2);
01360         <span class="keywordflow">if</span> (Entry != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01361             <span class="keywordflow">return</span> (PVOID)Entry;
01362         }
01363 <span class="preprocessor">#endif</span>
01364 <span class="preprocessor"></span>
01365         <span class="comment">//</span>
01366         <span class="comment">// Check for a special pool tag match by tag string and size ranges.</span>
01367         <span class="comment">//</span>
01368 
01369         <span class="keywordflow">if</span> ((<a class="code" href="../../d2/d2/ex_2pool_8c.html#a74">ExpCheckSingleFilter</a>(Tag, MmSpecialPoolTag)) ||
01370             ((<a class="code" href="../../d2/d1/mm_8h.html#a159">MmSpecialPoolTag</a> &gt;= (NumberOfBytes + <a class="code" href="../../d5/d2/poolhack_8c.html#a6">POOL_OVERHEAD</a>)) &amp;&amp;
01371              (<a class="code" href="../../d2/d1/mm_8h.html#a159">MmSpecialPoolTag</a> &lt; (NumberOfBytes + <a class="code" href="../../d5/d2/poolhack_8c.html#a6">POOL_OVERHEAD</a> + <a class="code" href="../../d4/d2/pool_8h.html#a20">POOL_SMALLEST_BLOCK</a>)))) {
01372 
01373             Entry = <a class="code" href="../../d1/d6/allocpag_8c.html#a60">MmAllocateSpecialPool</a> (NumberOfBytes,
01374                                            Tag,
01375                                            PoolType &amp; (BASE_POOL_TYPE_MASK | POOL_VERIFIER_MASK),
01376                                            2);
01377             <span class="keywordflow">if</span> (Entry != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01378                 <span class="keywordflow">return</span> (PVOID)Entry;
01379             }
01380         }
01381     }
01382 
01383     <span class="comment">//</span>
01384     <span class="comment">// If the request is for cache aligned memory adjust the number of</span>
01385     <span class="comment">// bytes.</span>
01386     <span class="comment">//</span>
01387 
01388 <span class="preprocessor">#if POOL_CACHE_SUPPORTED</span>
01389 <span class="preprocessor"></span>
01390     <a class="code" href="../../d2/d2/ex_2pool_8c.html#a38">CacheOverhead</a> = <a class="code" href="../../d5/d2/poolhack_8c.html#a6">POOL_OVERHEAD</a>;
01391     <span class="keywordflow">if</span> (PoolType &amp; <a class="code" href="../../d4/d2/pool_8h.html#a7">CACHE_ALIGNED_POOL_TYPE_MASK</a>) {
01392         NumberOfBytes += PoolCacheOverhead;
01393         <a class="code" href="../../d2/d2/ex_2pool_8c.html#a38">CacheOverhead</a> = PoolCacheSize;
01394     }
01395 
01396 <span class="preprocessor">#endif //POOL_CACHE_SUPPORTED</span>
01397 <span class="preprocessor"></span>
01398     <span class="comment">//</span>
01399     <span class="comment">// Compute the Index of the listhead for blocks of the requested</span>
01400     <span class="comment">// size.</span>
01401     <span class="comment">//</span>
01402 
01403     ListNumber = (ULONG)((NumberOfBytes + <a class="code" href="../../d5/d2/poolhack_8c.html#a6">POOL_OVERHEAD</a> + (<a class="code" href="../../d4/d2/pool_8h.html#a20">POOL_SMALLEST_BLOCK</a> - 1)) &gt;&gt; <a class="code" href="../../d4/d2/pool_8h.html#a14">POOL_BLOCK_SHIFT</a>);
01404 
01405     NeededSize = ListNumber;
01406 
01407     <span class="comment">//</span>
01408     <span class="comment">// If the pool type is paged, then pick a starting pool number and</span>
01409     <span class="comment">// attempt to lock each paged pool in circular succession. Otherwise,</span>
01410     <span class="comment">// lock the nonpaged pool as the same lock is used for both nonpaged</span>
01411     <span class="comment">// and nonpaged must succeed.</span>
01412     <span class="comment">//</span>
01413     <span class="comment">// N.B. The paged pool is selected in a round robin fashion using a</span>
01414     <span class="comment">//      simple counter. Note that the counter is incremented using a</span>
01415     <span class="comment">//      a noninterlocked sequence, but the pool index is never allowed</span>
01416     <span class="comment">//      to get out of range.</span>
01417     <span class="comment">//</span>
01418 
01419     <span class="keywordflow">if</span> (CheckType == <a class="code" href="../../d5/d8/ex_8h.html#a329a174">PagedPool</a>) {
01420 
01421         <span class="comment">//</span>
01422         <span class="comment">// If the requested pool block is a small block, then attempt to</span>
01423         <span class="comment">// allocate the requested pool from the per processor lookaside</span>
01424         <span class="comment">// list. If the attempt fails, then attempt to allocate from the</span>
01425         <span class="comment">// system lookaside list. If the attempt fails, then select a</span>
01426         <span class="comment">// pool to allocate from and allocate the block normally.</span>
01427         <span class="comment">//</span>
01428         <span class="comment">// Session space allocations do not currently use lookaside lists.</span>
01429         <span class="comment">//</span>
01430 
01431         <span class="keywordflow">if</span> ((GlobalSpace == <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>) &amp;&amp;
01432             (NeededSize &lt;= <a class="code" href="../../d0/d9/ntosdef_8h.html#a2">POOL_SMALL_LISTS</a>) &amp;&amp;
01433             (<a class="code" href="../../d5/d3/i386_8h.html#a16">Isx86FeaturePresent</a>(KF_CMPXCHG8B))) {
01434 
01435             Prcb = <a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a2">KeGetCurrentPrcb</a>();
01436             LookasideList = Prcb-&gt;PPPagedLookasideList[NeededSize - 1].P;
01437             LookasideList-&gt;<a class="code" href="../../d1/d4/struct__NPAGED__LOOKASIDE__LIST.html#o0">L</a>.<a class="code" href="../../d6/d1/struct__GENERAL__LOOKASIDE.html#o3">TotalAllocates</a> += 1;
01438 
01439             <a class="code" href="../../d2/d2/ex_2pool_8c.html#a23">CHECK_LOOKASIDE_LIST</a>(__LINE__, LookasideList, Entry);
01440 
01441             Entry = (<a class="code" href="../../d5/d8/struct__POOL__HEADER.html">PPOOL_HEADER</a>)
01442                 <a class="code" href="../../d5/d8/ex_8h.html#a242">ExInterlockedPopEntrySList</a> (&amp;LookasideList-&gt;<a class="code" href="../../d1/d4/struct__NPAGED__LOOKASIDE__LIST.html#o0">L</a>.<a class="code" href="../../d6/d1/struct__GENERAL__LOOKASIDE.html#o0">ListHead</a>,
01443                                             &amp;LookasideList-&gt;<a class="code" href="../../d1/d4/struct__NPAGED__LOOKASIDE__LIST.html#o1">Lock</a>);
01444 
01445             <span class="keywordflow">if</span> (Entry == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01446                 LookasideList = Prcb-&gt;PPPagedLookasideList[NeededSize - 1].<a class="code" href="../../d1/d4/struct__NPAGED__LOOKASIDE__LIST.html#o0">L</a>;
01447                 LookasideList-&gt;<a class="code" href="../../d1/d4/struct__NPAGED__LOOKASIDE__LIST.html#o0">L</a>.<a class="code" href="../../d6/d1/struct__GENERAL__LOOKASIDE.html#o3">TotalAllocates</a> += 1;
01448 
01449                 <a class="code" href="../../d2/d2/ex_2pool_8c.html#a23">CHECK_LOOKASIDE_LIST</a>(__LINE__, LookasideList, Entry);
01450 
01451                 Entry = (<a class="code" href="../../d5/d8/struct__POOL__HEADER.html">PPOOL_HEADER</a>)
01452                     <a class="code" href="../../d5/d8/ex_8h.html#a242">ExInterlockedPopEntrySList</a> (&amp;LookasideList-&gt;<a class="code" href="../../d1/d4/struct__NPAGED__LOOKASIDE__LIST.html#o0">L</a>.<a class="code" href="../../d6/d1/struct__GENERAL__LOOKASIDE.html#o0">ListHead</a>,
01453                                                 &amp;LookasideList-&gt;<a class="code" href="../../d1/d4/struct__NPAGED__LOOKASIDE__LIST.html#o1">Lock</a>);
01454             }
01455 
01456             <span class="keywordflow">if</span> (Entry != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01457 
01458                 <a class="code" href="../../d2/d2/ex_2pool_8c.html#a23">CHECK_LOOKASIDE_LIST</a>(__LINE__, LookasideList, Entry);
01459 
01460                 Entry -= 1;
01461                 LookasideList-&gt;<a class="code" href="../../d1/d4/struct__NPAGED__LOOKASIDE__LIST.html#o0">L</a>.<a class="code" href="../../d6/d1/struct__GENERAL__LOOKASIDE.html#o5">AllocateHits</a> += 1;
01462                 NewPoolType = (PoolType &amp; (<a class="code" href="../../d4/d2/pool_8h.html#a5">BASE_POOL_TYPE_MASK</a> | <a class="code" href="../../d4/d2/pool_8h.html#a11">POOL_QUOTA_MASK</a> | <a class="code" href="../../d4/d2/pool_8h.html#a8">SESSION_POOL_MASK</a> | <a class="code" href="../../d4/d2/pool_8h.html#a9">POOL_VERIFIER_MASK</a>)) + 1;
01463 
01464 <span class="preprocessor">#if _POOL_LOCK_GRANULAR_</span>
01465 <span class="preprocessor"></span>                PoolDesc = &amp;PoolDesc[<a class="code" href="../../d2/d2/ex_2pool_8c.html#a27">DECODE_POOL_INDEX</a>(Entry)];
01466 <span class="preprocessor">#endif</span>
01467 <span class="preprocessor"></span>
01468                 <a class="code" href="../../d2/d2/ex_2pool_8c.html#a6">LOCK_POOL_GRANULAR</a>(PoolDesc, LockHandle);
01469 
01470                 Entry-&gt;<a class="code" href="../../d5/d8/struct__POOL__HEADER.html#o1">PoolType</a> = (UCHAR)NewPoolType;
01471                 <a class="code" href="../../d2/d2/ex_2pool_8c.html#a28">MARK_POOL_HEADER_ALLOCATED</a>(Entry);
01472 
01473                 <a class="code" href="../../d2/d2/ex_2pool_8c.html#a7">UNLOCK_POOL_GRANULAR</a>(PoolDesc, LockHandle);
01474 
01475                 Entry-&gt;<a class="code" href="../../d5/d8/struct__POOL__HEADER.html#o9">PoolTag</a> = Tag;
01476 
01477                 <span class="keywordflow">if</span> ((<a class="code" href="../../d2/d2/ex_2pool_8c.html#a42">PoolTrackTable</a> != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) &amp;&amp;
01478                     ((PoolType &amp; <a class="code" href="../../d4/d2/pool_8h.html#a8">SESSION_POOL_MASK</a>) == 0)) {
01479 
01480                     <a class="code" href="../../d2/d2/ex_2pool_8c.html#a65">ExpInsertPoolTracker</a> (Tag,
01481                                           Entry-&gt;<a class="code" href="../../d5/d8/struct__POOL__HEADER.html#o6">BlockSize</a> &lt;&lt; POOL_BLOCK_SHIFT,
01482                                           PoolType);
01483                 }
01484 
01485                 <span class="comment">//</span>
01486                 <span class="comment">// Zero out any back pointer to our internal structures</span>
01487                 <span class="comment">// to stop someone from corrupting us via an</span>
01488                 <span class="comment">// uninitialized pointer.</span>
01489                 <span class="comment">//</span>
01490 
01491                 ((PULONG)((PCHAR)Entry + <a class="code" href="../../d2/d2/ex_2pool_8c.html#a38">CacheOverhead</a>))[0] = 0;
01492 
01493                 <a class="code" href="../../d2/d1/mm_8h.html#a83">PERFINFO_POOLALLOC_ADDR</a>((PUCHAR)Entry + CacheOverhead);
01494 
01495                 <span class="keywordflow">return</span> (PUCHAR)Entry + <a class="code" href="../../d2/d2/ex_2pool_8c.html#a38">CacheOverhead</a>;
01496             }
01497         }
01498 
01499         <span class="comment">//</span>
01500         <span class="comment">// If there is more than one paged pool, then attempt to find</span>
01501         <span class="comment">// one that can be immediately locked.</span>
01502         <span class="comment">//</span>
01503 
01504         <span class="keywordflow">if</span> (GlobalSpace == <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>) {
01505 
01506             PVOID <a class="code" href="../../d6/d0/usercli_8h.html#a41">Lock</a>;
01507 
01508             PoolIndex = 1;
01509             <span class="keywordflow">if</span> (<a class="code" href="../../d2/d2/ex_2pool_8c.html#a51">ExpNumberOfPagedPools</a> != PoolIndex) {
01510                 <a class="code" href="../../d2/d2/ex_2pool_8c.html#a57">ExpPoolIndex</a> += 1;
01511                 PoolIndex = <a class="code" href="../../d2/d2/ex_2pool_8c.html#a57">ExpPoolIndex</a>;
01512                 <span class="keywordflow">if</span> (PoolIndex &gt; <a class="code" href="../../d2/d2/ex_2pool_8c.html#a51">ExpNumberOfPagedPools</a>) {
01513                     PoolIndex = 1;
01514                     <a class="code" href="../../d2/d2/ex_2pool_8c.html#a57">ExpPoolIndex</a> = 1;
01515                 }
01516 
01517                 <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> = PoolIndex;
01518                 <span class="keywordflow">do</span> {
01519                     <a class="code" href="../../d6/d0/usercli_8h.html#a41">Lock</a> = PoolDesc[PoolIndex].<a class="code" href="../../d4/d8/struct__POOL__DESCRIPTOR.html#o3">LockAddress</a>;
01520                     <span class="keywordflow">if</span> (ExTryToAcquireFastMutex((<a class="code" href="../../d6/d9/struct__FAST__MUTEX.html">PFAST_MUTEX</a>)Lock) == <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>) {
01521                         PoolDesc = &amp;PoolDesc[PoolIndex];
01522                         <span class="keywordflow">goto</span> PoolLocked;
01523                     }
01524 
01525                     PoolIndex += 1;
01526                     <span class="keywordflow">if</span> (PoolIndex &gt; <a class="code" href="../../d2/d2/ex_2pool_8c.html#a51">ExpNumberOfPagedPools</a>) {
01527                         PoolIndex = 1;
01528                     }
01529 
01530                 } <span class="keywordflow">while</span> (PoolIndex != <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>);
01531             }
01532             PoolDesc = &amp;PoolDesc[PoolIndex];
01533         }
01534         <span class="keywordflow">else</span> {
01535 
01536             <span class="comment">//</span>
01537             <span class="comment">// Only one paged pool is currently available per session.</span>
01538             <span class="comment">//</span>
01539 
01540             PoolIndex = 0;
01541             <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a> (PoolDesc == ExpSessionPoolDescriptor);
01542         }
01543 
01544         <span class="comment">//</span>
01545         <span class="comment">// None of the paged pools could be conditionally locked or there</span>
01546         <span class="comment">// is only one paged pool. The first pool considered is picked as</span>
01547         <span class="comment">// the victim to wait on.</span>
01548         <span class="comment">//</span>
01549 
01550         ExAcquireFastMutex((<a class="code" href="../../d6/d9/struct__FAST__MUTEX.html">PFAST_MUTEX</a>)PoolDesc-&gt;<a class="code" href="../../d4/d8/struct__POOL__DESCRIPTOR.html#o3">LockAddress</a>);
01551 PoolLocked:
01552 
01553         GlobalSpace = GlobalSpace;
01554 <span class="preprocessor">#if DBG</span>
01555 <span class="preprocessor"></span>        <span class="keywordflow">if</span> (GlobalSpace == <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>) {
01556             <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(PoolIndex == PoolDesc-&gt;<a class="code" href="../../d4/d8/struct__POOL__DESCRIPTOR.html#o5">PoolIndex</a>);
01557         }
01558         <span class="keywordflow">else</span> {
01559             <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(PoolIndex == 0);
01560             <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(PoolDesc-&gt;<a class="code" href="../../d4/d8/struct__POOL__DESCRIPTOR.html#o5">PoolIndex</a> == 0);
01561         }
01562 <span class="preprocessor">#endif</span>
01563 <span class="preprocessor"></span>
01564     } <span class="keywordflow">else</span> {
01565 
01566         <span class="comment">//</span>
01567         <span class="comment">// If the requested pool block is a small block, then attempt to</span>
01568         <span class="comment">// allocate the requested pool from the per processor lookaside</span>
01569         <span class="comment">// list. If the attempt fails, then attempt to allocate from the</span>
01570         <span class="comment">// system lookaside list. If the attempt fails, then select a</span>
01571         <span class="comment">// pool to allocate from and allocate the block normally.</span>
01572         <span class="comment">//</span>
01573 
01574         <span class="keywordflow">if</span> (GlobalSpace == <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> &amp;&amp; NeededSize &lt;= <a class="code" href="../../d0/d9/ntosdef_8h.html#a2">POOL_SMALL_LISTS</a>) {
01575             Prcb = <a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a2">KeGetCurrentPrcb</a>();
01576             LookasideList = Prcb-&gt;PPNPagedLookasideList[NeededSize - 1].P;
01577             LookasideList-&gt;<a class="code" href="../../d1/d4/struct__NPAGED__LOOKASIDE__LIST.html#o0">L</a>.<a class="code" href="../../d6/d1/struct__GENERAL__LOOKASIDE.html#o3">TotalAllocates</a> += 1;
01578 
01579             <a class="code" href="../../d2/d2/ex_2pool_8c.html#a23">CHECK_LOOKASIDE_LIST</a>(__LINE__, LookasideList, 0);
01580 
01581             Entry = (<a class="code" href="../../d5/d8/struct__POOL__HEADER.html">PPOOL_HEADER</a>)
01582                         <a class="code" href="../../d5/d8/ex_8h.html#a242">ExInterlockedPopEntrySList</a> (&amp;LookasideList-&gt;<a class="code" href="../../d1/d4/struct__NPAGED__LOOKASIDE__LIST.html#o0">L</a>.<a class="code" href="../../d6/d1/struct__GENERAL__LOOKASIDE.html#o0">ListHead</a>,
01583                                                     &amp;LookasideList-&gt;<a class="code" href="../../d1/d4/struct__NPAGED__LOOKASIDE__LIST.html#o1">Lock</a>);
01584 
01585             <span class="keywordflow">if</span> (Entry == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01586                 LookasideList = Prcb-&gt;PPNPagedLookasideList[NeededSize - 1].<a class="code" href="../../d1/d4/struct__NPAGED__LOOKASIDE__LIST.html#o0">L</a>;
01587                 LookasideList-&gt;<a class="code" href="../../d1/d4/struct__NPAGED__LOOKASIDE__LIST.html#o0">L</a>.<a class="code" href="../../d6/d1/struct__GENERAL__LOOKASIDE.html#o3">TotalAllocates</a> += 1;
01588 
01589                 <a class="code" href="../../d2/d2/ex_2pool_8c.html#a23">CHECK_LOOKASIDE_LIST</a>(__LINE__, LookasideList, 0);
01590 
01591                 Entry = (<a class="code" href="../../d5/d8/struct__POOL__HEADER.html">PPOOL_HEADER</a>)
01592                         <a class="code" href="../../d5/d8/ex_8h.html#a242">ExInterlockedPopEntrySList</a> (&amp;LookasideList-&gt;<a class="code" href="../../d1/d4/struct__NPAGED__LOOKASIDE__LIST.html#o0">L</a>.<a class="code" href="../../d6/d1/struct__GENERAL__LOOKASIDE.html#o0">ListHead</a>,
01593                                                     &amp;LookasideList-&gt;<a class="code" href="../../d1/d4/struct__NPAGED__LOOKASIDE__LIST.html#o1">Lock</a>);
01594             }
01595 
01596             <span class="keywordflow">if</span> (Entry != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01597 
01598                 <a class="code" href="../../d2/d2/ex_2pool_8c.html#a23">CHECK_LOOKASIDE_LIST</a>(__LINE__, LookasideList, Entry);
01599 
01600                 Entry -= 1;
01601                 LookasideList-&gt;<a class="code" href="../../d1/d4/struct__NPAGED__LOOKASIDE__LIST.html#o0">L</a>.<a class="code" href="../../d6/d1/struct__GENERAL__LOOKASIDE.html#o5">AllocateHits</a> += 1;
01602                 NewPoolType = (PoolType &amp; (<a class="code" href="../../d4/d2/pool_8h.html#a5">BASE_POOL_TYPE_MASK</a> | <a class="code" href="../../d4/d2/pool_8h.html#a11">POOL_QUOTA_MASK</a> | <a class="code" href="../../d4/d2/pool_8h.html#a8">SESSION_POOL_MASK</a> | <a class="code" href="../../d4/d2/pool_8h.html#a9">POOL_VERIFIER_MASK</a>)) + 1;
01603 
01604                 <a class="code" href="../../d2/d2/ex_2pool_8c.html#a6">LOCK_POOL_GRANULAR</a>(PoolDesc, LockHandle);
01605 
01606                 Entry-&gt;<a class="code" href="../../d5/d8/struct__POOL__HEADER.html#o1">PoolType</a> = (UCHAR)NewPoolType;
01607                 <a class="code" href="../../d2/d2/ex_2pool_8c.html#a28">MARK_POOL_HEADER_ALLOCATED</a>(Entry);
01608 
01609                 <a class="code" href="../../d2/d2/ex_2pool_8c.html#a7">UNLOCK_POOL_GRANULAR</a>(PoolDesc, LockHandle);
01610 
01611                 Entry-&gt;<a class="code" href="../../d5/d8/struct__POOL__HEADER.html#o9">PoolTag</a> = Tag;
01612 
01613                 <span class="keywordflow">if</span> (<a class="code" href="../../d2/d2/ex_2pool_8c.html#a42">PoolTrackTable</a> != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01614 
01615                     <a class="code" href="../../d2/d2/ex_2pool_8c.html#a65">ExpInsertPoolTracker</a> (Tag,
01616                                           Entry-&gt;<a class="code" href="../../d5/d8/struct__POOL__HEADER.html#o6">BlockSize</a> &lt;&lt; POOL_BLOCK_SHIFT,
01617                                           PoolType);
01618                 }
01619 
01620                 <span class="comment">//</span>
01621                 <span class="comment">// Zero out any back pointer to our internal structures</span>
01622                 <span class="comment">// to stop someone from corrupting us via an</span>
01623                 <span class="comment">// uninitialized pointer.</span>
01624                 <span class="comment">//</span>
01625 
01626                 ((PULONG)((PCHAR)Entry + <a class="code" href="../../d2/d2/ex_2pool_8c.html#a38">CacheOverhead</a>))[0] = 0;
01627 
01628                 <a class="code" href="../../d2/d1/mm_8h.html#a83">PERFINFO_POOLALLOC_ADDR</a>((PUCHAR)Entry + CacheOverhead);
01629 
01630                 <span class="keywordflow">return</span> (PUCHAR)Entry + <a class="code" href="../../d2/d2/ex_2pool_8c.html#a38">CacheOverhead</a>;
01631             }
01632         }
01633 
01634         PoolIndex = 0;
01635         ExAcquireSpinLock(&amp;NonPagedPoolLock, &amp;LockHandle);
01636 
01637         <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(PoolIndex == PoolDesc-&gt;<a class="code" href="../../d4/d8/struct__POOL__DESCRIPTOR.html#o5">PoolIndex</a>);
01638     }
01639 
01640     <span class="comment">//</span>
01641     <span class="comment">// The following code has an outer loop and an inner loop.</span>
01642     <span class="comment">//</span>
01643     <span class="comment">// The outer loop is utilized to repeat a nonpaged must succeed</span>
01644     <span class="comment">// allocation if necessary.</span>
01645     <span class="comment">//</span>
01646     <span class="comment">// The inner loop is used to repeat an allocation attempt if there</span>
01647     <span class="comment">// are no entries in any of the pool lists.</span>
01648     <span class="comment">//</span>
01649 
01650     RequestType = PoolType &amp; (<a class="code" href="../../d4/d2/pool_8h.html#a5">BASE_POOL_TYPE_MASK</a> | <a class="code" href="../../d4/d2/pool_8h.html#a8">SESSION_POOL_MASK</a>);
01651 
01652     PoolDesc-&gt;<a class="code" href="../../d4/d8/struct__POOL__DESCRIPTOR.html#o6">RunningAllocs</a> += 1;
01653     ListHead = &amp;PoolDesc-&gt;<a class="code" href="../../d4/d8/struct__POOL__DESCRIPTOR.html#o4">ListHeads</a>[ListNumber];
01654 
01655     <span class="keywordflow">do</span> {
01656 
01657         <span class="comment">//</span>
01658         <span class="comment">// Attempt to allocate the requested block from the current free</span>
01659         <span class="comment">// blocks.</span>
01660         <span class="comment">//</span>
01661 
01662         <span class="keywordflow">do</span> {
01663 
01664             <span class="comment">//</span>
01665             <span class="comment">// If the list is not empty, then allocate a block from the</span>
01666             <span class="comment">// selected list.</span>
01667             <span class="comment">//</span>
01668 
01669             <span class="keywordflow">if</span> (<a class="code" href="../../d2/d2/ex_2pool_8c.html#a11">PrivateIsListEmpty</a>(ListHead) == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
01670 
01671                 <a class="code" href="../../d2/d2/ex_2pool_8c.html#a17">CHECK_LIST</a>( __LINE__, ListHead, 0 );
01672                 Block = <a class="code" href="../../d2/d2/ex_2pool_8c.html#a12">PrivateRemoveHeadList</a>(ListHead);
01673                 <a class="code" href="../../d2/d2/ex_2pool_8c.html#a17">CHECK_LIST</a>( __LINE__, ListHead, 0 );
01674                 Entry = (<a class="code" href="../../d5/d8/struct__POOL__HEADER.html">PPOOL_HEADER</a>)((PCHAR)Block - <a class="code" href="../../d5/d2/poolhack_8c.html#a6">POOL_OVERHEAD</a>);
01675 
01676                 <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(Entry-&gt;<a class="code" href="../../d5/d8/struct__POOL__HEADER.html#o6">BlockSize</a> &gt;= NeededSize);
01677 
01678                 <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(<a class="code" href="../../d2/d2/ex_2pool_8c.html#a27">DECODE_POOL_INDEX</a>(Entry) == PoolIndex);
01679 
01680                 <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(Entry-&gt;<a class="code" href="../../d5/d8/struct__POOL__HEADER.html#o1">PoolType</a> == 0);
01681 
01682                 <span class="keywordflow">if</span> (Entry-&gt;<a class="code" href="../../d5/d8/struct__POOL__HEADER.html#o6">BlockSize</a> != NeededSize) {
01683 
01684                     <span class="comment">//</span>
01685                     <span class="comment">// The selected block is larger than the allocation</span>
01686                     <span class="comment">// request. Split the block and insert the remaining</span>
01687                     <span class="comment">// fragment in the appropriate list.</span>
01688                     <span class="comment">//</span>
01689                     <span class="comment">// If the entry is at the start of a page, then take</span>
01690                     <span class="comment">// the allocation from the front of the block so as</span>
01691                     <span class="comment">// to minimize fragmentation. Otherwise, take the</span>
01692                     <span class="comment">// allocation from the end of the block which may</span>
01693                     <span class="comment">// also reduce fragmentation if the block is at the</span>
01694                     <span class="comment">// end of a page.</span>
01695                     <span class="comment">//</span>
01696 
01697                     <span class="keywordflow">if</span> (Entry-&gt;<a class="code" href="../../d5/d8/struct__POOL__HEADER.html#o3">PreviousSize</a> == 0) {
01698 
01699                         <span class="comment">//</span>
01700                         <span class="comment">// The entry is at the start of a page.</span>
01701                         <span class="comment">//</span>
01702 
01703                         SplitEntry = (<a class="code" href="../../d5/d8/struct__POOL__HEADER.html">PPOOL_HEADER</a>)((<a class="code" href="../../d3/d8/struct__POOL__BLOCK.html">PPOOL_BLOCK</a>)Entry + NeededSize);
01704                         SplitEntry-&gt;<a class="code" href="../../d5/d8/struct__POOL__HEADER.html#o6">BlockSize</a> = (UCHAR)(Entry-&gt;<a class="code" href="../../d5/d8/struct__POOL__HEADER.html#o6">BlockSize</a> - (UCHAR)NeededSize);
01705                         SplitEntry-&gt;<a class="code" href="../../d5/d8/struct__POOL__HEADER.html#o3">PreviousSize</a> = (UCHAR)NeededSize;
01706 
01707                         <span class="comment">//</span>
01708                         <span class="comment">// If the allocated block is not at the end of a</span>
01709                         <span class="comment">// page, then adjust the size of the next block.</span>
01710                         <span class="comment">//</span>
01711 
01712                         NextEntry = (<a class="code" href="../../d5/d8/struct__POOL__HEADER.html">PPOOL_HEADER</a>)((<a class="code" href="../../d3/d8/struct__POOL__BLOCK.html">PPOOL_BLOCK</a>)SplitEntry + SplitEntry-&gt;<a class="code" href="../../d5/d8/struct__POOL__HEADER.html#o6">BlockSize</a>);
01713                         <span class="keywordflow">if</span> (<a class="code" href="../../d4/d2/pool_8h.html#a17">PAGE_END</a>(NextEntry) == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
01714                             NextEntry-&gt;<a class="code" href="../../d5/d8/struct__POOL__HEADER.html#o3">PreviousSize</a> = SplitEntry-&gt;<a class="code" href="../../d5/d8/struct__POOL__HEADER.html#o6">BlockSize</a>;
01715                         }
01716 
01717                     } <span class="keywordflow">else</span> {
01718 
01719                         <span class="comment">//</span>
01720                         <span class="comment">// The entry is not at the start of a page.</span>
01721                         <span class="comment">//</span>
01722 
01723                         SplitEntry = Entry;
01724                         Entry-&gt;<a class="code" href="../../d5/d8/struct__POOL__HEADER.html#o6">BlockSize</a> -= (UCHAR)NeededSize;
01725                         Entry = (<a class="code" href="../../d5/d8/struct__POOL__HEADER.html">PPOOL_HEADER</a>)((<a class="code" href="../../d3/d8/struct__POOL__BLOCK.html">PPOOL_BLOCK</a>)Entry + Entry-&gt;BlockSize);
01726                         Entry-&gt;PreviousSize = SplitEntry-&gt;<a class="code" href="../../d5/d8/struct__POOL__HEADER.html#o6">BlockSize</a>;
01727 
01728                         <span class="comment">//</span>
01729                         <span class="comment">// If the allocated block is not at the end of a</span>
01730                         <span class="comment">// page, then adjust the size of the next block.</span>
01731                         <span class="comment">//</span>
01732 
01733                         NextEntry = (<a class="code" href="../../d5/d8/struct__POOL__HEADER.html">PPOOL_HEADER</a>)((<a class="code" href="../../d3/d8/struct__POOL__BLOCK.html">PPOOL_BLOCK</a>)Entry + NeededSize);
01734                         <span class="keywordflow">if</span> (<a class="code" href="../../d4/d2/pool_8h.html#a17">PAGE_END</a>(NextEntry) == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
01735                             NextEntry-&gt;<a class="code" href="../../d5/d8/struct__POOL__HEADER.html#o3">PreviousSize</a> = (UCHAR)NeededSize;
01736                         }
01737                     }
01738 
01739                     <span class="comment">//</span>
01740                     <span class="comment">// Set the size of the allocated entry, clear the pool</span>
01741                     <span class="comment">// type of the split entry, set the index of the split</span>
01742                     <span class="comment">// entry, and insert the split entry in the appropriate</span>
01743                     <span class="comment">// free list.</span>
01744                     <span class="comment">//</span>
01745 
01746                     Entry-&gt;<a class="code" href="../../d5/d8/struct__POOL__HEADER.html#o6">BlockSize</a> = (UCHAR)NeededSize;
01747                     <a class="code" href="../../d2/d2/ex_2pool_8c.html#a26">ENCODE_POOL_INDEX</a>(Entry, PoolIndex);
01748                     SplitEntry-&gt;<a class="code" href="../../d5/d8/struct__POOL__HEADER.html#o1">PoolType</a> = 0;
01749                     <a class="code" href="../../d2/d2/ex_2pool_8c.html#a26">ENCODE_POOL_INDEX</a>(SplitEntry, PoolIndex);
01750                     <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> = SplitEntry-&gt;<a class="code" href="../../d5/d8/struct__POOL__HEADER.html#o6">BlockSize</a>;
01751 
01752                     <a class="code" href="../../d2/d2/ex_2pool_8c.html#a17">CHECK_LIST</a>(__LINE__, &amp;PoolDesc-&gt;<a class="code" href="../../d4/d8/struct__POOL__DESCRIPTOR.html#o4">ListHeads</a>[Index - 1], 0);
01753                     <a class="code" href="../../d2/d2/ex_2pool_8c.html#a15">PrivateInsertTailList</a>(&amp;PoolDesc-&gt;<a class="code" href="../../d4/d8/struct__POOL__DESCRIPTOR.html#o4">ListHeads</a>[Index - 1], ((PLIST_ENTRY)((PCHAR)SplitEntry + POOL_OVERHEAD)));
01754                     <a class="code" href="../../d2/d2/ex_2pool_8c.html#a17">CHECK_LIST</a>(__LINE__, &amp;PoolDesc-&gt;<a class="code" href="../../d4/d8/struct__POOL__DESCRIPTOR.html#o4">ListHeads</a>[Index - 1], 0);
01755                     <a class="code" href="../../d2/d2/ex_2pool_8c.html#a17">CHECK_LIST</a>(__LINE__, ((PLIST_ENTRY)((PCHAR)SplitEntry + POOL_OVERHEAD)), 0);
01756                 }
01757 
01758                 Entry-&gt;<a class="code" href="../../d5/d8/struct__POOL__HEADER.html#o1">PoolType</a> = (UCHAR)((PoolType &amp; (<a class="code" href="../../d4/d2/pool_8h.html#a5">BASE_POOL_TYPE_MASK</a> | <a class="code" href="../../d4/d2/pool_8h.html#a11">POOL_QUOTA_MASK</a> | <a class="code" href="../../d4/d2/pool_8h.html#a8">SESSION_POOL_MASK</a> | <a class="code" href="../../d4/d2/pool_8h.html#a9">POOL_VERIFIER_MASK</a>)) + 1);
01759 
01760                 <a class="code" href="../../d2/d2/ex_2pool_8c.html#a28">MARK_POOL_HEADER_ALLOCATED</a>(Entry);
01761 
01762                 <a class="code" href="../../d2/d2/ex_2pool_8c.html#a18">CHECK_POOL_HEADER</a>(__LINE__, Entry);
01763 
01764                 <span class="comment">//</span>
01765                 <span class="comment">// Notify the memory manager of session pool allocations</span>
01766                 <span class="comment">// so leaked allocations can be caught on session exit.</span>
01767                 <span class="comment">// This call must be made with the relevant pool locked.</span>
01768                 <span class="comment">//</span>
01769 
01770                 <span class="keywordflow">if</span> (PoolType &amp; <a class="code" href="../../d4/d2/pool_8h.html#a8">SESSION_POOL_MASK</a>) {
01771                     <a class="code" href="../../d1/d6/allocpag_8c.html#a50">MiSessionPoolAllocated</a>(
01772                         (PVOID)((PCHAR)Entry + CacheOverhead),
01773                         (ULONG)(Entry-&gt;<a class="code" href="../../d5/d8/struct__POOL__HEADER.html#o6">BlockSize</a> &lt;&lt; POOL_BLOCK_SHIFT),
01774                         PoolType);
01775                 }
01776 
01777                 <a class="code" href="../../d2/d2/ex_2pool_8c.html#a35">UNLOCK_POOL</a>(PoolDesc, LockHandle);
01778 
01779                 Entry-&gt;<a class="code" href="../../d5/d8/struct__POOL__HEADER.html#o9">PoolTag</a> = Tag;
01780 
01781                 <span class="keywordflow">if</span> ((<a class="code" href="../../d2/d2/ex_2pool_8c.html#a42">PoolTrackTable</a> != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) &amp;&amp;
01782                     ((PoolType &amp; <a class="code" href="../../d4/d2/pool_8h.html#a8">SESSION_POOL_MASK</a>) == 0)) {
01783 
01784                     <a class="code" href="../../d2/d2/ex_2pool_8c.html#a65">ExpInsertPoolTracker</a> (Tag,
01785                                           Entry-&gt;<a class="code" href="../../d5/d8/struct__POOL__HEADER.html#o6">BlockSize</a> &lt;&lt; POOL_BLOCK_SHIFT,
01786                                           PoolType);
01787                 }
01788 
01789                 <span class="comment">//</span>
01790                 <span class="comment">// Zero out any back pointer to our internal structures</span>
01791                 <span class="comment">// to stop someone from corrupting us via an</span>
01792                 <span class="comment">// uninitialized pointer.</span>
01793                 <span class="comment">//</span>
01794 
01795                 ((PULONGLONG)((PCHAR)Entry + <a class="code" href="../../d2/d2/ex_2pool_8c.html#a38">CacheOverhead</a>))[0] = 0;
01796 
01797                 <a class="code" href="../../d2/d1/mm_8h.html#a83">PERFINFO_POOLALLOC_ADDR</a>((PUCHAR)Entry + CacheOverhead);
01798                 <span class="keywordflow">return</span> (PCHAR)Entry + <a class="code" href="../../d2/d2/ex_2pool_8c.html#a38">CacheOverhead</a>;
01799 
01800             }
01801             ListHead += 1;
01802 
01803         } <span class="keywordflow">while</span> (ListHead != &amp;PoolDesc-&gt;<a class="code" href="../../d4/d8/struct__POOL__DESCRIPTOR.html#o4">ListHeads</a>[<a class="code" href="../../d5/d2/poolhack_8c.html#a2">POOL_LIST_HEADS</a>]);
01804 
01805         <span class="comment">//</span>
01806         <span class="comment">// A block of the desired size does not exist and there are</span>
01807         <span class="comment">// no large blocks that can be split to satisfy the allocation.</span>
01808         <span class="comment">// Attempt to expand the pool by allocating another page to be</span>
01809         <span class="comment">// added to the pool.</span>
01810         <span class="comment">//</span>
01811         <span class="comment">// If the pool type is paged pool, then the paged pool page lock</span>
01812         <span class="comment">// must be held during the allocation of the pool pages.</span>
01813         <span class="comment">//</span>
01814 
01815         <a class="code" href="../../d2/d2/ex_2pool_8c.html#a34">LOCK_IF_PAGED_POOL</a>(CheckType, GlobalSpace);
01816 
01817         Entry = (<a class="code" href="../../d5/d8/struct__POOL__HEADER.html">PPOOL_HEADER</a>)<a class="code" href="../../d1/d6/allocpag_8c.html#a54">MiAllocatePoolPages</a> (RequestType,
01818                                                    PAGE_SIZE,
01819                                                    FALSE);
01820 
01821         <a class="code" href="../../d2/d2/ex_2pool_8c.html#a36">UNLOCK_IF_PAGED_POOL</a>(CheckType, GlobalSpace);
01822 
01823         <span class="keywordflow">if</span> (Entry == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01824             <span class="keywordflow">if</span> ((PoolType &amp; <a class="code" href="../../d4/d2/pool_8h.html#a6">MUST_SUCCEED_POOL_TYPE_MASK</a>) != 0) {
01825 
01826                 <span class="comment">//</span>
01827                 <span class="comment">// Must succeed pool was requested. Reset the type,</span>
01828                 <span class="comment">// the pool descriptor address, and continue the search.</span>
01829                 <span class="comment">//</span>
01830 
01831                 CheckType = <a class="code" href="../../d5/d8/ex_8h.html#a329a175">NonPagedPoolMustSucceed</a>;
01832                 RequestType = RequestType | <a class="code" href="../../d4/d2/pool_8h.html#a6">MUST_SUCCEED_POOL_TYPE_MASK</a>;
01833                 PoolDesc = <a class="code" href="../../d2/d2/ex_2pool_8c.html#a54">PoolVector</a>[<a class="code" href="../../d5/d8/ex_8h.html#a329a175">NonPagedPoolMustSucceed</a>];
01834                 ListHead = &amp;PoolDesc-&gt;<a class="code" href="../../d4/d8/struct__POOL__DESCRIPTOR.html#o4">ListHeads</a>[ListNumber];
01835                 <span class="keywordflow">continue</span>;
01836 
01837             } <span class="keywordflow">else</span> {
01838 
01839                 <span class="comment">//</span>
01840                 <span class="comment">// No more pool of the specified type is available.</span>
01841                 <span class="comment">//</span>
01842 
01843                 KdPrint((<span class="stringliteral">"EX: ExAllocatePool (%p, 0x%x ) returning NULL\n"</span>,
01844                     NumberOfBytes,
01845                     PoolType));
01846 
01847                 <a class="code" href="../../d2/d2/ex_2pool_8c.html#a35">UNLOCK_POOL</a>(PoolDesc, LockHandle);
01848 
01849                 <span class="keywordflow">if</span> ((PoolType &amp; <a class="code" href="../../d5/d8/ex_8h.html#a3">POOL_RAISE_IF_ALLOCATION_FAILURE</a>) != 0) {
01850                     <a class="code" href="../../d5/d8/ex_8h.html#a303">ExRaiseStatus</a>(STATUS_INSUFFICIENT_RESOURCES);
01851                 }
01852 
01853                 <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01854             }
01855         }
01856 
01857         <span class="comment">//</span>
01858         <span class="comment">// Insert the allocated page in the last allocation list.</span>
01859         <span class="comment">//</span>
01860 
01861         PoolDesc-&gt;<a class="code" href="../../d4/d8/struct__POOL__DESCRIPTOR.html#o1">TotalPages</a> += 1;
01862         Entry-&gt;<a class="code" href="../../d5/d8/struct__POOL__HEADER.html#o1">PoolType</a> = 0;
01863         <a class="code" href="../../d2/d2/ex_2pool_8c.html#a26">ENCODE_POOL_INDEX</a>(Entry, PoolIndex);
01864 
01865         <a class="code" href="../../d2/d1/mm_8h.html#a32">PERFINFO_ADDPOOLPAGE</a>(CheckType, PoolIndex, Entry, PoolDesc);
01866 
01867         <span class="comment">//</span>
01868         <span class="comment">// N.B. A byte is used to store the block size in units of the</span>
01869         <span class="comment">//      smallest block size. Therefore, if the number of small</span>
01870         <span class="comment">//      blocks in the page is greater than 255, the block size</span>
01871         <span class="comment">//      is set to 255.</span>
01872         <span class="comment">//</span>
01873 
01874         <span class="keywordflow">if</span> ((<a class="code" href="../../d6/d7/halmips_8h.html#a446">PAGE_SIZE</a> / <a class="code" href="../../d4/d2/pool_8h.html#a20">POOL_SMALLEST_BLOCK</a>) &gt; 255) {
01875             Entry-&gt;<a class="code" href="../../d5/d8/struct__POOL__HEADER.html#o6">BlockSize</a> = 255;
01876 
01877         } <span class="keywordflow">else</span> {
01878             Entry-&gt;<a class="code" href="../../d5/d8/struct__POOL__HEADER.html#o6">BlockSize</a> = (UCHAR)(<a class="code" href="../../d6/d7/halmips_8h.html#a446">PAGE_SIZE</a> / <a class="code" href="../../d4/d2/pool_8h.html#a20">POOL_SMALLEST_BLOCK</a>);
01879         }
01880 
01881         Entry-&gt;<a class="code" href="../../d5/d8/struct__POOL__HEADER.html#o3">PreviousSize</a> = 0;
01882         ListHead = &amp;PoolDesc-&gt;<a class="code" href="../../d4/d8/struct__POOL__DESCRIPTOR.html#o4">ListHeads</a>[<a class="code" href="../../d5/d2/poolhack_8c.html#a2">POOL_LIST_HEADS</a> - 1];
01883 
01884         <a class="code" href="../../d2/d2/ex_2pool_8c.html#a17">CHECK_LIST</a>(__LINE__, ListHead, 0);
01885         <a class="code" href="../../d2/d2/ex_2pool_8c.html#a16">PrivateInsertHeadList</a>(ListHead, ((PLIST_ENTRY)((PCHAR)Entry + POOL_OVERHEAD)));
01886         <a class="code" href="../../d2/d2/ex_2pool_8c.html#a17">CHECK_LIST</a>(__LINE__, ListHead, 0);
01887         <a class="code" href="../../d2/d2/ex_2pool_8c.html#a17">CHECK_LIST</a>(__LINE__, ((PLIST_ENTRY)((PCHAR)Entry + POOL_OVERHEAD)), 0);
01888 
01889     } <span class="keywordflow">while</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
01890 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a222" doxytag="ex.h::ExAllocatePoolWithTagPriority" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI PVOID NTAPI ExAllocatePoolWithTagPriority           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d5/d8/ex_8h.html#a96">POOL_TYPE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>PoolType</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN SIZE_T&nbsp;</td>
          <td class="mdname" nowrap> <em>NumberOfBytes</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Tag</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d5/d8/ex_8h.html#a97">EX_POOL_PRIORITY</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Priority</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00993">993</a> of file <a class="el" href="../../d3/d1/ex_2pool_8c-source.html">ex/pool.c</a>.
<p>
References <a class="el" href="../../d5/d1/pool_8h-source.html#l00050">BASE_POOL_TYPE_MASK</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l00253">ExAllocatePoolWithTag</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00349">ExpSessionPoolDescriptor</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d5/d8/ex_8h.html#a330a194">HighPoolPriority</a>, <a class="el" href="../../d2/d5/allocpag_8c-source.html#l03408">MmAllocateSpecialPool()</a>, <a class="el" href="../../d2/d5/allocpag_8c-source.html#l00589">MmResourcesAvailable()</a>, <a class="el" href="../../d5/d1/pool_8h-source.html#l00052">MUST_SUCCEED_POOL_TYPE_MASK</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d6/d1/poolhack_8c-source.html#l00117">POOL_BUDDY_MAX</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00048">POOL_SPECIAL_POOL_BIT</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00049">POOL_SPECIAL_POOL_UNDERRUN_BIT</a>, <a class="el" href="../../d5/d1/pool_8h-source.html#l00058">POOL_VERIFIER_MASK</a>, and <a class="el" href="../../d5/d1/pool_8h-source.html#l00056">SESSION_POOL_MASK</a>.
<p>
Referenced by <a class="el" href="../../d7/d5/ioverifier_8c-source.html#l00353">IovAllocateIrp()</a>, <a class="el" href="../../d9/d7/hashirp_8c-source.html#l00686">IovpProtectedIrpAllocate()</a>, <a class="el" href="../../d0/d5/verifier_8c-source.html#l01812">VeAllocatePoolWithTagPriority()</a>, <a class="el" href="../../d0/d5/verifier_8c-source.html#l01115">VerifierAllocatePoolWithTagPriority()</a>, and <a class="el" href="../../d0/d5/verifier_8c-source.html#l01233">ViReservePoolAllocation()</a>.
<p>
<pre class="fragment"><div>01002                    :
01003 
01004     This function allocates a block of <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a> of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> and
01005     returns a pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> allocated block.  This function <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> used to
01006     access both <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> page-aligned pools, and <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> list head entries (less than
01007     a page) pools.
01008 
01009     If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> number of bytes specifies a size that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> too large to be
01010     satisfied by <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> appropriate list, then <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> page-aligned
01011     <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a> allocator <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> used.  The allocated block will be page-aligned
01012     and a page-sized multiple.
01013 
01014     Otherwise, <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> appropriate <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a> list entry <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> used.  The allocated
01015     block will be 64-bit aligned, but will not be page aligned.  The
01016     <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a> allocator calculates <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> smallest number of POOL_BLOCK_SIZE
01017     that can be used to satisfy <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> request.  If there are no blocks
01018     available of <span class="keyword">this</span> size, then a block of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> next larger block size
01019     <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> allocated and split.  One piece <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> placed back into <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a>, and
01020     <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> other piece <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> used to satisfy <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> request.  If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> allocator
01021     reaches <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> paged-sized block list, and nothing <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> there, <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
01022     page-aligned <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a> allocator <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> called.  The page <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> split and added
01023     to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a>...
01024 
01025 Arguments:
01026 
01027     PoolType - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> of <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a> to allocate.  If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a> <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a>
01028         <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> one of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <span class="stringliteral">"MustSucceed"</span> <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a> types, then <span class="keyword">this</span> call will
01029         always succeed and <span class="keywordflow">return</span> a pointer to allocated <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a>.
01030         Otherwise, <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> system cannot allocate <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> requested amount
01031         of memory a <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned.
01032 
01033         Valid <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a> types:
01034 
01035         <a class="code" href="../../d5/d8/ex_8h.html#a329a173">NonPagedPool</a>
01036         <a class="code" href="../../d5/d8/ex_8h.html#a329a174">PagedPool</a>
01037         <a class="code" href="../../d5/d8/ex_8h.html#a329a175">NonPagedPoolMustSucceed</a>,
01038         <a class="code" href="../../d5/d8/ex_8h.html#a329a177">NonPagedPoolCacheAligned</a>
01039         <a class="code" href="../../d5/d8/ex_8h.html#a329a178">PagedPoolCacheAligned</a>
01040         <a class="code" href="../../d5/d8/ex_8h.html#a329a179">NonPagedPoolCacheAlignedMustS</a>
01041 
01042     NumberOfBytes - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> number of bytes to allocate.
01043 
01044     Tag - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> caller's identifying tag.
01045 
01046     Priority - Supplies an indication as to how important <a class="code" href="../../d1/d9/icmui_8def.html#a4">it</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> that <span class="keyword">this</span>
01047                request succeed under <a class="code" href="../../d2/d3/fetypes_8h.html#a457a418">low</a> available <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a> conditions.  This
01048                can also be used to specify special <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a>.
01049 
01050 Return Value:
01051 
01052     <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> - The PoolType <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> not one of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <span class="stringliteral">"MustSucceed"</span> <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a> types, and
01053         not enough <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a> exists to satisfy <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> request.
01054 
01055     NON-<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> - Returns a pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> allocated <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a>.
01056 
01057 --*/
01058 
01059 {
01060     PVOID Entry;
01061 
01062     <span class="keywordflow">if</span> ((Priority &amp; <a class="code" href="../../d2/d2/ex_2pool_8c.html#a1">POOL_SPECIAL_POOL_BIT</a>) &amp;&amp; (NumberOfBytes &lt;= <a class="code" href="../../d5/d2/poolhack_8c.html#a7">POOL_BUDDY_MAX</a>)) {
01063         Entry = <a class="code" href="../../d1/d6/allocpag_8c.html#a60">MmAllocateSpecialPool</a> (NumberOfBytes,
01064                                        Tag,
01065                                        PoolType &amp; (BASE_POOL_TYPE_MASK | POOL_VERIFIER_MASK),
01066                                        (Priority &amp; POOL_SPECIAL_POOL_UNDERRUN_BIT) ? 1 : 0);
01067 
01068         <span class="keywordflow">if</span> (Entry != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01069             <span class="keywordflow">return</span> Entry;
01070         }
01071         Priority &amp;= ~(<a class="code" href="../../d2/d2/ex_2pool_8c.html#a1">POOL_SPECIAL_POOL_BIT</a> | <a class="code" href="../../d2/d2/ex_2pool_8c.html#a2">POOL_SPECIAL_POOL_UNDERRUN_BIT</a>);
01072     }
01073 
01074     <span class="comment">//</span>
01075     <span class="comment">// Pool and other resources can be allocated directly through the Mm</span>
01076     <span class="comment">// without the pool code knowing - so always call the Mm for the</span>
01077     <span class="comment">// up-to-date counters.</span>
01078     <span class="comment">//</span>
01079 
01080     <span class="keywordflow">if</span> ((Priority != <a class="code" href="../../d5/d8/ex_8h.html#a330a194">HighPoolPriority</a>) &amp;&amp; ((PoolType &amp; <a class="code" href="../../d4/d2/pool_8h.html#a6">MUST_SUCCEED_POOL_TYPE_MASK</a>) == 0)) {
01081 
01082         <span class="keywordflow">if</span> (<a class="code" href="../../d2/d2/ex_2pool_8c.html#a40">ExpSessionPoolDescriptor</a> == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01083             PoolType &amp;= ~<a class="code" href="../../d4/d2/pool_8h.html#a8">SESSION_POOL_MASK</a>;
01084         }
01085 
01086         <span class="keywordflow">if</span> (<a class="code" href="../../d1/d6/allocpag_8c.html#a52">MmResourcesAvailable</a> (PoolType, NumberOfBytes, Priority) == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
01087             <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01088         }
01089     }
01090 
01091     <span class="comment">//</span>
01092     <span class="comment">// There is a window between determining whether to proceed and actually</span>
01093     <span class="comment">// doing the allocation.  In this window the pool may deplete.  This is not</span>
01094     <span class="comment">// worth closing at this time.</span>
01095     <span class="comment">//</span>
01096 
01097     <span class="keywordflow">return</span> <a class="code" href="../../d5/d8/ex_8h.html#a4">ExAllocatePoolWithTag</a> (PoolType,
01098                                   NumberOfBytes,
01099                                   Tag);
01100 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a298" doxytag="ex.h::ExChangeHandle" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI BOOLEAN ExChangeHandle           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d6/d3/struct__HANDLE__TABLE.html">PHANDLE_TABLE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>HandleTable</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN HANDLE&nbsp;</td>
          <td class="mdname" nowrap> <em>Handle</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d5/d8/ex_8h.html#a143">PEX_CHANGE_HANDLE_ROUTINE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>ChangeRoutine</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG_PTR&nbsp;</td>
          <td class="mdname" nowrap> <em>Parameter</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l01315">1315</a> of file <a class="el" href="../../d1/d7/ex_2handle_8c-source.html">ex/handle.c</a>.
<p>
References <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l00240">ExLockHandleTableEntry()</a>, <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l02195">ExpLookupHandleTableEntry()</a>, <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l00336">ExUnlockHandleTableEntry()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02630">_EXHANDLE::GenericHandleOverlay</a>, <a class="el" href="../../d8/d9/cmdat2_8c-source.html#l00091">Handle</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l01598">KeEnterCriticalRegion</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l01628">KeLeaveCriticalRegion</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, and <a class="el" href="../../d1/d8/ntosdef_8h-source.html#l00462">PAGED_CODE</a>.
<p>
Referenced by <a class="el" href="../../d7/d0/obquery_8c-source.html#l00545">NtSetInformationObject()</a>, <a class="el" href="../../d3/d7/ps_2create_8c-source.html#l00262">PspCreateThread()</a>, and <a class="el" href="../../d9/d9/psdelete_8c-source.html#l00690">PspExitThread()</a>.
<p>
<pre class="fragment"><div>01324                    :
01325 
01326     This function provides <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> capability to change <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> contents of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
01327     handle entry corrsponding to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified handle.
01328 
01329 Arguments:
01330 
01331     HandleTable - Supplies a pointer to a handle table.
01332 
01333     <a class="code" href="../../d7/d0/cmdat2_8c.html#a19">Handle</a> - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> handle <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> handle entry that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> changed.
01334 
01335     ChangeRoutine - Supplies a pointer to a function that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> called to
01336         perform <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> change.
01337 
01338     Parameter - Supplies an uninterpreted parameter that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> passed to
01339         <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> change routine.
01340 
01341 Return Value:
01342 
01343     If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> operation was successfully performed, then a value of <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>
01344     <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned. Otherwise, a value of <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned.
01345 
01346 --*/
01347 
01348 {
01349     <a class="code" href="../../d7/d8/struct__EXHANDLE.html">EXHANDLE</a> LocalHandle;
01350 
01351     <a class="code" href="../../d7/d3/struct__HANDLE__TABLE__ENTRY.html">PHANDLE_TABLE_ENTRY</a> HandleTableEntry;
01352     BOOLEAN ReturnValue;
01353 
01354     <a class="code" href="../../d0/d9/ntosdef_8h.html#a28">PAGED_CODE</a>();
01355 
01356     LocalHandle.<a class="code" href="../../d7/d8/struct__EXHANDLE.html#o2">GenericHandleOverlay</a> = <a class="code" href="../../d7/d0/cmdat2_8c.html#a19">Handle</a>;
01357 
01358     <span class="comment">//</span>
01359     <span class="comment">//  Translate the input handle to a handle table entry and make</span>
01360     <span class="comment">//  sure it is a valid handle.</span>
01361     <span class="comment">//</span>
01362 
01363     HandleTableEntry = <a class="code" href="../../d0/d8/ex_2handle_8c.html#a8">ExpLookupHandleTableEntry</a>( HandleTable,
01364                                                   LocalHandle );
01365 
01366     <span class="keywordflow">if</span> (HandleTableEntry == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01367 
01368         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01369     }
01370 
01371     <span class="comment">//</span>
01372     <span class="comment">//  Try and lock the handle table entry,  If this fails then that's</span>
01373     <span class="comment">//  because someone freed the handle</span>
01374     <span class="comment">//</span>
01375 
01376     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d8/ex_8h.html#a287">ExLockHandleTableEntry</a>( HandleTable, HandleTableEntry )) {
01377 
01378         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01379     }
01380 
01381     <span class="comment">//</span>
01382     <span class="comment">//  Make sure we can't get suspended and then invoke the callback</span>
01383     <span class="comment">//</span>
01384 
01385     <a class="code" href="../../d4/d9/ke_8h.html#a28">KeEnterCriticalRegion</a>();
01386 
01387     <span class="keywordflow">try</span> {
01388 
01389         ReturnValue = (*ChangeRoutine)( HandleTableEntry, Parameter );
01390 
01391     } finally {
01392 
01393         <a class="code" href="../../d5/d8/ex_8h.html#a288">ExUnlockHandleTableEntry</a>( HandleTable, HandleTableEntry );
01394         <a class="code" href="../../d4/d9/ke_8h.html#a29">KeLeaveCriticalRegion</a>();
01395     }
01396 
01397     <span class="keywordflow">return</span> ReturnValue;
01398 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a214" doxytag="ex.h::ExComputeTickCountMultiplier" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG ExComputeTickCountMultiplier           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN ULONG&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>TimeIncrement</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a276" doxytag="ex.h::ExConvertExclusiveToSharedLite" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI VOID ExConvertExclusiveToSharedLite           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d6/d4/struct__ERESOURCE.html">PERESOURCE</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Resource</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l01942">1942</a> of file <a class="el" href="../../d9/d7/ex_2resource_8c-source.html">ex/resource.c</a>.
<p>
References <a class="el" href="../../d6/d7/ex_8h-source.html#l02289">_ERESOURCE::ActiveCount</a>, <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d8/d3/ddkresrc_8c-source.html#l00070">ASSERT_RESOURCE</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02274">ERESOURCE_THREAD</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02290">_ERESOURCE::Flag</a>, <a class="el" href="../../d8/d3/ddkresrc_8c-source.html#l00091">IsOwnedExclusive</a>, <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l00049">IsSharedWaiting</a>, <a class="el" href="../../d2/d5/semphobj_8c-source.html#l00118">KeReleaseSemaphore()</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02295">_ERESOURCE::NumberOfSharedWaiters</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02278">_OWNER_ENTRY::OwnerThread</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02293">_ERESOURCE::OwnerThreads</a>, <a class="el" href="../../d2/d8/ps_8h-source.html#l00645">PsGetCurrentThread</a>, <a class="el" href="../../d5/d9/tex_8c-source.html#l01561">Resource</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02311">ResourceOwnedExclusive</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02291">_ERESOURCE::SharedWaiters</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00062">SHORT</a>, and <a class="el" href="../../d6/d7/ex_8h-source.html#l02302">_ERESOURCE::SpinLock</a>.
<p>
<pre class="fragment"><div>01948                    :
01949 
01950     This routine converts <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified resource from acquired <span class="keywordflow">for</span> exclusive
01951     access to acquired <span class="keywordflow">for</span> shared access.
01952 
01953     N.B. This routine uses fast locking.
01954 
01955 Arguments:
01956 
01957     <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a> - Supplies a pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> resource to acquire <span class="keywordflow">for</span> shared access. <a class="code" href="../../d1/d9/icmui_8def.html#a4">it</a>
01958 
01959 Return Value:
01960 
01961     None.
01962 
01963 --*/
01964 
01965 {
01966 
01967     ULONG Number;
01968     KIRQL OldIrql;
01969 
01970     <span class="comment">//</span>
01971     <span class="comment">// Acquire exclusive access to the specified resource.</span>
01972     <span class="comment">//</span>
01973 
01974     ExAcquireFastLock(&amp;<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o12">SpinLock</a>, &amp;OldIrql);
01975 
01976     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(KeIsExecutingDpc() == FALSE);
01977     <a class="code" href="../../d7/d4/ddkresrc_8c.html#a0">ASSERT_RESOURCE</a>(Resource);
01978     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(<a class="code" href="../../d7/d4/ddkresrc_8c.html#a6">IsOwnedExclusive</a>(Resource));
01979     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o6">OwnerThreads</a>[0].<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o0">OwnerThread</a> == (ERESOURCE_THREAD)<a class="code" href="../../d1/d9/ps_8h.html#a20">PsGetCurrentThread</a>());
01980 
01981     <span class="comment">//</span>
01982     <span class="comment">// Convert the granted access from exclusive to shared.</span>
01983     <span class="comment">//</span>
01984 
01985     <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o3">Flag</a> &amp;= ~<a class="code" href="../../d5/d8/ex_8h.html#a64">ResourceOwnedExclusive</a>;
01986 
01987     <span class="comment">//</span>
01988     <span class="comment">// If there are any shared waiters, then grant them shared access.</span>
01989     <span class="comment">//</span>
01990 
01991     <span class="keywordflow">if</span> (<a class="code" href="../../d8/d8/ex_2resource_8c.html#a1">IsSharedWaiting</a>(Resource)) {
01992         Number = <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o8">NumberOfSharedWaiters</a>;
01993         <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o2">ActiveCount</a> +=  (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a>)Number;
01994         <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o8">NumberOfSharedWaiters</a> = 0;
01995         ExReleaseFastLock(&amp;<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o12">SpinLock</a>, OldIrql);
01996         <a class="code" href="../../d1/d6/semphobj_8c.html#a3">KeReleaseSemaphore</a>(<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o4">SharedWaiters</a>, 0, Number, FALSE);
01997         <span class="keywordflow">return</span>;
01998     }
01999 
02000     ExReleaseFastLock(&amp;<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o12">SpinLock</a>, OldIrql);
02001     <span class="keywordflow">return</span>;
02002 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a320" doxytag="ex.h::ExCreateCallback" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI NTSTATUS ExCreateCallback           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">OUT <a class="el" href="../../d9/d6/struct__CALLBACK__OBJECT.html">PCALLBACK_OBJECT</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>CallbackObject</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN POBJECT_ATTRIBUTES&nbsp;</td>
          <td class="mdname" nowrap> <em>ObjectAttributes</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>Create</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>AllowMultipleCallbacks</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d3/ex_2callback_8c-source.html#l00222">222</a> of file <a class="el" href="../../d3/d3/ex_2callback_8c-source.html">ex/callback.c</a>.
<p>
References <a class="el" href="../../d1/d5/consubs_8c-source.html#l00023">Create()</a>, <a class="el" href="../../d3/d3/ex_2callback_8c-source.html#l00043">ExCallbackObjectType</a>, <a class="el" href="../../d8/d9/cmdat2_8c-source.html#l00091">Handle</a>, <a class="el" href="../../d4/d9/ke_8h.html#a354">KeInitializeSpinLock()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00624">KernelMode</a>, <a class="el" href="../../d6/d5/stierr_8h-source.html#l00030">NT_SUCCESS</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d7/d9/obcreate_8c-source.html#l00055">ObCreateObject()</a>, <a class="el" href="../../d2/d0/obinsert_8c-source.html#l00029">ObInsertObject()</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00027">ObjectAttributes</a>, <a class="el" href="../../d8/d0/obref_8c-source.html#l00095">ObOpenObjectByName()</a>, <a class="el" href="../../d8/d0/obref_8c-source.html#l00542">ObReferenceObjectByHandle()</a>, <a class="el" href="../../d1/d8/ntosdef_8h-source.html#l00462">PAGED_CODE</a>, <a class="el" href="../../d2/d4/ex_2callback_8c.html#a6">PCALLBACK_OBJECT</a>, and <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00135">Status</a>.
<p>
Referenced by <a class="el" href="../../d3/d3/ex_2callback_8c-source.html#l00101">ExpInitializeCallbacks()</a>.
<p>
<pre class="fragment"><div>00231                    :
00232 
00233     This function opens a callback object with <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified callback
00234     object. If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> callback object does not exist or <a class="code" href="../../d1/d9/icmui_8def.html#a4">it</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> a <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> then
00235     a callback object will be created <span class="keywordflow">if</span> create <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>. If a callbackobject
00236     <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> created <a class="code" href="../../d1/d9/icmui_8def.html#a4">it</a> will <a class="code" href="../../d3/d0/imm32_8def.html#a1">only</a> support mulitiple registered callbacks <span class="keywordflow">if</span>
00237     AllowMulitipleCallbacks <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>.
00238 
00239 Arguments:
00240 
00241     CallbackObject - Supplies a pointer to a variable that will receive <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00242         Callback object.
00243 
00244     CallbackName  - Supplies a pointer to a object name that will receive <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00245 
00246     <a class="code" href="../../d4/d5/conimep_8h.html#a111">Create</a> - Supplies a flag which indicates whether a callback object will
00247         be created or not .
00248 
00249     AllowMultipleCallbacks - Supplies a flag which indicates <a class="code" href="../../d3/d0/imm32_8def.html#a1">only</a> support
00250         mulitiple registered callbacks.
00251 
00252 Return Value:
00253 
00254     Returns STATUS_SUCESS unless fali...
00255 
00256 --*/
00257 
00258 {
00259     <a class="code" href="../../d9/d6/struct__CALLBACK__OBJECT.html">PCALLBACK_OBJECT</a> cbObject;
00260     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
00261     HANDLE <a class="code" href="../../d7/d0/cmdat2_8c.html#a19">Handle</a>;
00262 
00263     <a class="code" href="../../d0/d9/ntosdef_8h.html#a28">PAGED_CODE</a>();
00264 
00265     <span class="comment">//</span>
00266     <span class="comment">// If named callback, open handle to it</span>
00267     <span class="comment">//</span>
00268 
00269     <span class="keywordflow">if</span> (<a class="code" href="../../d7/d0/ctlnpqos_8c.html#a4">ObjectAttributes</a>-&gt;ObjectName) {
00270         <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d7/d1/obref_8c.html#a2">ObOpenObjectByName</a>(ObjectAttributes,
00271                                     ExCallbackObjectType,
00272                                     KernelMode,
00273                                     NULL,
00274                                     0,   <span class="comment">// DesiredAccess,</span>
00275                                     NULL,
00276                                     &amp;Handle);
00277     } <span class="keywordflow">else</span> {
00278         <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = STATUS_UNSUCCESSFUL;
00279     }
00280 
00281     <span class="comment">//</span>
00282     <span class="comment">// If not opened, check if callback should be created</span>
00283     <span class="comment">//</span>
00284 
00285     <span class="keywordflow">if</span>(!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status) &amp;&amp; <a class="code" href="../../d4/d5/conimep_8h.html#a111">Create</a> ) {
00286         <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d6/d0/obcreate_8c.html#a5">ObCreateObject</a>(KernelMode,
00287                                 ExCallbackObjectType,
00288                                 ObjectAttributes,
00289                                 KernelMode,
00290                                 NULL,
00291                                 <span class="keyword">sizeof</span>(<a class="code" href="../../d9/d6/struct__CALLBACK__OBJECT.html">CALLBACK_OBJECT</a>),
00292                                 0,
00293                                 0,
00294                                 (PVOID *)&amp;cbObject );
00295 
00296         <span class="keywordflow">if</span>(<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status)){
00297 
00298             <span class="comment">//</span>
00299             <span class="comment">// Fill in structure signature</span>
00300             <span class="comment">//</span>
00301 
00302             cbObject-&gt;<a class="code" href="../../d9/d6/struct__CALLBACK__OBJECT.html#o0">Signature</a> = 'llaC';
00303 
00304             <span class="comment">//</span>
00305             <span class="comment">// It will support multiple registered callbacks if</span>
00306             <span class="comment">// AllowMultipleCallbacks is TRUE.</span>
00307             <span class="comment">//</span>
00308 
00309             cbObject-&gt;<a class="code" href="../../d9/d6/struct__CALLBACK__OBJECT.html#o3">AllowMultipleCallbacks</a> = AllowMultipleCallbacks;
00310 
00311             <span class="comment">//</span>
00312             <span class="comment">// Initialize CallbackObject queue.</span>
00313             <span class="comment">//</span>
00314 
00315             InitializeListHead( &amp;cbObject-&gt;<a class="code" href="../../d9/d6/struct__CALLBACK__OBJECT.html#o2">RegisteredCallbacks</a> );
00316 
00317             <span class="comment">//</span>
00318             <span class="comment">// Initialize spinlock</span>
00319             <span class="comment">//</span>
00320 
00321             <a class="code" href="../../d4/d9/ke_8h.html#a354">KeInitializeSpinLock</a> (&amp;cbObject-&gt;<a class="code" href="../../d9/d6/struct__CALLBACK__OBJECT.html#o1">Lock</a>);
00322 
00323 
00324             <span class="comment">//</span>
00325             <span class="comment">// Put the object in the root directory</span>
00326             <span class="comment">//</span>
00327 
00328             <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d1/d1/obinsert_8c.html#a0">ObInsertObject</a> (
00329                      cbObject,
00330                      NULL,
00331                      FILE_READ_DATA,
00332                      0,
00333                      NULL,
00334                      &amp;Handle );
00335 
00336         }
00337 
00338     }
00339 
00340     <span class="keywordflow">if</span>(<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status)){
00341 
00342         <span class="comment">//</span>
00343         <span class="comment">// Add one to callback object reference count</span>
00344         <span class="comment">//</span>
00345 
00346         <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d7/d1/obref_8c.html#a4">ObReferenceObjectByHandle</a> (
00347                     Handle,
00348                     0,          <span class="comment">// DesiredAccess</span>
00349                     ExCallbackObjectType,
00350                     KernelMode,
00351                     &amp;cbObject,
00352                     NULL
00353                     );
00354 
00355         ZwClose (Handle);
00356     }
00357 
00358     <span class="comment">//</span>
00359     <span class="comment">// If SUCEESS , returns a referenced pointer to the CallbackObject.</span>
00360     <span class="comment">//</span>
00361 
00362     <span class="keywordflow">if</span> (<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status)) {
00363         *CallbackObject = cbObject;
00364     }
00365 
00366     <span class="keywordflow">return</span> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
00367 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a308" doxytag="ex.h::ExCreateDebugLog" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI <a class="el" href="../../d4/d7/struct__EX__DEBUG__LOG.html">PEX_DEBUG_LOG</a> ExCreateDebugLog           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN UCHAR&nbsp;</td>
          <td class="mdname" nowrap> <em>MaximumNumberOfTags</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>MaximumNumberOfEvents</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d4/logger_8c-source.html#l00030">30</a> of file <a class="el" href="../../d5/d4/logger_8c-source.html">logger.c</a>.
<p>
References <a class="el" href="../../d6/d7/ex_8h-source.html#l00253">ExAllocatePoolWithTag</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l03150">_EX_DEBUG_LOG::First</a>, <a class="el" href="../../d4/d9/ke_8h.html#a354">KeInitializeSpinLock()</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l03151">_EX_DEBUG_LOG::Last</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l03145">_EX_DEBUG_LOG::Lock</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l03147">_EX_DEBUG_LOG::MaximumNumberOfTags</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l03152">_EX_DEBUG_LOG::Next</a>, <a class="el" href="../../d5/d8/ex_8h.html#a329a173">NonPagedPool</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d9/d6/lh__open_2pi__mem_8h-source.html#l00017">Size</a>, and <a class="el" href="../../d6/d7/ex_8h-source.html#l03148">_EX_DEBUG_LOG::Tags</a>.
<p>
<pre class="fragment"><div>00034 {
00035     <a class="code" href="../../d4/d7/struct__EX__DEBUG__LOG.html">PEX_DEBUG_LOG</a> Log;
00036     ULONG <a class="code" href="../../d8/d7/lh__open_2pi__mem_8h.html#a0">Size</a>;
00037 
00038     <a class="code" href="../../d8/d7/lh__open_2pi__mem_8h.html#a0">Size</a> = <span class="keyword">sizeof</span>( <a class="code" href="../../d4/d7/struct__EX__DEBUG__LOG.html">EX_DEBUG_LOG</a> ) +
00039             (MaximumNumberOfTags *
00040              <span class="keyword">sizeof</span>( <a class="code" href="../../d6/d7/struct__EX__DEBUG__LOG__TAG.html">EX_DEBUG_LOG_TAG</a> )
00041             ) +
00042             (MaximumNumberOfEvents *
00043              <span class="keyword">sizeof</span>( <a class="code" href="../../d5/d7/struct__EX__DEBUG__LOG__EVENT.html">EX_DEBUG_LOG_EVENT</a> )
00044             );
00045 
00046 
00047     Log = <a class="code" href="../../d5/d8/ex_8h.html#a4">ExAllocatePoolWithTag</a>( NonPagedPool, Size, 'oLbD' );
00048     <span class="keywordflow">if</span> (Log != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00049         RtlZeroMemory( Log, Size );
00050         <a class="code" href="../../d4/d9/ke_8h.html#a354">KeInitializeSpinLock</a>( &amp;Log-&gt;<a class="code" href="../../d4/d7/struct__EX__DEBUG__LOG.html#o0">Lock</a> );
00051         Log-&gt;<a class="code" href="../../d4/d7/struct__EX__DEBUG__LOG.html#o2">MaximumNumberOfTags</a> = MaximumNumberOfTags;
00052         Log-&gt;<a class="code" href="../../d4/d7/struct__EX__DEBUG__LOG.html#o3">Tags</a> = (<a class="code" href="../../d6/d7/struct__EX__DEBUG__LOG__TAG.html">PEX_DEBUG_LOG_TAG</a>)(Log + 1);
00053         Log-&gt;<a class="code" href="../../d4/d7/struct__EX__DEBUG__LOG.html#o5">First</a> = (<a class="code" href="../../d5/d7/struct__EX__DEBUG__LOG__EVENT.html">PEX_DEBUG_LOG_EVENT</a>)(Log-&gt;<a class="code" href="../../d4/d7/struct__EX__DEBUG__LOG.html#o3">Tags</a> + MaximumNumberOfTags);
00054         Log-&gt;<a class="code" href="../../d4/d7/struct__EX__DEBUG__LOG.html#o6">Last</a> = Log-&gt;<a class="code" href="../../d4/d7/struct__EX__DEBUG__LOG.html#o5">First</a> + MaximumNumberOfEvents;
00055         Log-&gt;<a class="code" href="../../d4/d7/struct__EX__DEBUG__LOG.html#o7">Next</a> = Log-&gt;<a class="code" href="../../d4/d7/struct__EX__DEBUG__LOG.html#o5">First</a>;
00056         }
00057 
00058     <span class="keywordflow">return</span> Log;
00059 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a309" doxytag="ex.h::ExCreateDebugLogTag" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI UCHAR ExCreateDebugLogTag           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d4/d7/struct__EX__DEBUG__LOG.html">PEX_DEBUG_LOG</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Log</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PCHAR&nbsp;</td>
          <td class="mdname" nowrap> <em>Name</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN UCHAR&nbsp;</td>
          <td class="mdname" nowrap> <em>Format1</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN UCHAR&nbsp;</td>
          <td class="mdname" nowrap> <em>Format2</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN UCHAR&nbsp;</td>
          <td class="mdname" nowrap> <em>Format3</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN UCHAR&nbsp;</td>
          <td class="mdname" nowrap> <em>Format4</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d4/logger_8c-source.html#l00062">62</a> of file <a class="el" href="../../d5/d4/logger_8c-source.html">logger.c</a>.
<p>
References <a class="el" href="../../d6/d7/ex_8h-source.html#l00253">ExAllocatePoolWithTag</a>, <a class="el" href="../../d7/d2/cmwraper_8c-source.html#l00304">ExFreePool()</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l03131">_EX_DEBUG_LOG_TAG::Format</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l03132">_EX_DEBUG_LOG_TAG::Name</a>, <a class="el" href="../../d9/d9/geninst_8c-source.html#l00154">Name</a>, <a class="el" href="../../d5/d8/ex_8h.html#a329a173">NonPagedPool</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d9/d6/lh__open_2pi__mem_8h-source.html#l00017">Size</a>, and <a class="el" href="../../d2/d7/regtest_8c.html#a2">strlen()</a>.
<p>
<pre class="fragment"><div>00070 {
00071     KIRQL OldIrql;
00072     ULONG <a class="code" href="../../d8/d7/lh__open_2pi__mem_8h.html#a0">Size</a>;
00073     <a class="code" href="../../d6/d7/struct__EX__DEBUG__LOG__TAG.html">PEX_DEBUG_LOG_TAG</a> Tag;
00074     UCHAR TagIndex;
00075     PCHAR CapturedName;
00076 
00077     <a class="code" href="../../d8/d7/lh__open_2pi__mem_8h.html#a0">Size</a> = <a class="code" href="../../d2/d7/regtest_8c.html#a2">strlen</a>( Name );
00078     CapturedName = <a class="code" href="../../d5/d8/ex_8h.html#a4">ExAllocatePoolWithTag</a>( NonPagedPool, Size, 'oLbD' );
00079     RtlMoveMemory( CapturedName, Name, Size + 1 );
00080 
00081     ExAcquireSpinLock( &amp;Log-&gt;Lock, &amp;OldIrql );
00082 
00083     <span class="keywordflow">if</span> (Log-&gt;NumberOfTags &lt; Log-&gt;MaximumNumberOfTags) {
00084         TagIndex = (UCHAR)(Log-&gt;NumberOfTags++);
00085         Tag = &amp;Log-&gt;Tags[ TagIndex ];
00086         Tag-&gt;<a class="code" href="../../d6/d7/struct__EX__DEBUG__LOG__TAG.html#o1">Name</a> = CapturedName;
00087         Tag-&gt;<a class="code" href="../../d6/d7/struct__EX__DEBUG__LOG__TAG.html#o0">Format</a>[ 0 ] = Format1;
00088         Tag-&gt;<a class="code" href="../../d6/d7/struct__EX__DEBUG__LOG__TAG.html#o0">Format</a>[ 1 ] = Format2;
00089         Tag-&gt;<a class="code" href="../../d6/d7/struct__EX__DEBUG__LOG__TAG.html#o0">Format</a>[ 2 ] = Format3;
00090         Tag-&gt;<a class="code" href="../../d6/d7/struct__EX__DEBUG__LOG__TAG.html#o0">Format</a>[ 3 ] = Format4;
00091         CapturedName = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00092         }
00093     <span class="keywordflow">else</span> {
00094         TagIndex = (UCHAR)0xFF;
00095         }
00096 
00097     ExReleaseSpinLock( &amp;Log-&gt;Lock, OldIrql );
00098 
00099     <span class="keywordflow">if</span> (CapturedName != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00100         <a class="code" href="../../d5/d8/ex_8h.html#a224">ExFreePool</a>( CapturedName );
00101         }
00102     <span class="keywordflow">return</span> TagIndex;
00103 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a296" doxytag="ex.h::ExCreateHandle" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI HANDLE ExCreateHandle           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d6/d3/struct__HANDLE__TABLE.html">PHANDLE_TABLE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>HandleTable</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d7/d3/struct__HANDLE__TABLE__ENTRY.html">PHANDLE_TABLE_ENTRY</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>HandleTableEntry</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l01144">1144</a> of file <a class="el" href="../../d1/d7/ex_2handle_8c-source.html">ex/handle.c</a>.
<p>
References <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l00146">ExLockHandleTableExclusive()</a>, <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l01825">ExpAllocateHandleTableEntry()</a>, <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l00336">ExUnlockHandleTableEntry()</a>, <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l00209">ExUnlockHandleTableExclusive()</a>, <a class="el" href="../../d8/d9/cmdat2_8c-source.html#l00091">Handle</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l01598">KeEnterCriticalRegion</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l01628">KeLeaveCriticalRegion</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, and <a class="el" href="../../d1/d8/ntosdef_8h-source.html#l00462">PAGED_CODE</a>.
<p>
Referenced by <a class="el" href="../../d5/d9/tex_8c-source.html#l01160">DoHandleTest()</a>, <a class="el" href="../../d0/d0/obhandle_8c-source.html#l00163">NtDuplicateObject()</a>, <a class="el" href="../../d0/d0/obhandle_8c-source.html#l02160">ObpCreateHandle()</a>, <a class="el" href="../../d0/d0/obhandle_8c-source.html#l02507">ObpCreateUnnamedHandle()</a>, <a class="el" href="../../d3/d7/ps_2create_8c-source.html#l00262">PspCreateThread()</a>, and <a class="el" href="../../d1/d9/rtl_2atom_8c-source.html#l00187">RtlpCreateHandleForAtom()</a>.
<p>
<pre class="fragment"><div>01151                    :
01152 
01153     This function creates a handle entry in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified handle table and
01154     returns a handle <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> entry.
01155 
01156 Arguments:
01157 
01158     HandleTable - Supplies a pointer to a handle table
01159 
01160     HandleEntry - Supplies a poiner to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> handle entry <span class="keywordflow">for</span> which a
01161         handle entry <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> created.
01162 
01163 Return Value:
01164 
01165     If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> handle entry <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> successfully created, then value of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> created
01166     handle <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned as <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> function value.  Otherwise, a value of zero <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a>
01167     returned.
01168 
01169 --*/
01170 
01171 {
01172     <a class="code" href="../../d7/d8/struct__EXHANDLE.html">EXHANDLE</a> <a class="code" href="../../d7/d0/cmdat2_8c.html#a19">Handle</a>;
01173     <a class="code" href="../../d7/d3/struct__HANDLE__TABLE__ENTRY.html">PHANDLE_TABLE_ENTRY</a> NewHandleTableEntry;
01174 
01175     <a class="code" href="../../d0/d9/ntosdef_8h.html#a28">PAGED_CODE</a>();
01176 
01177     <span class="comment">//</span>
01178     <span class="comment">//  Set out output variable to zero (i.e., null) before going on</span>
01179     <span class="comment">//</span>
01180 
01181     <span class="comment">//</span>
01182     <span class="comment">// Clears Handle.Index and Handle.TagBits</span>
01183     <span class="comment">//</span>
01184 
01185     <a class="code" href="../../d7/d0/cmdat2_8c.html#a19">Handle</a>.GenericHandleOverlay = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01186 
01187     <span class="comment">//</span>
01188     <span class="comment">//  Lock the handle table for exclusive access</span>
01189     <span class="comment">//</span>
01190 
01191     <a class="code" href="../../d4/d9/ke_8h.html#a28">KeEnterCriticalRegion</a>();
01192     <a class="code" href="../../d5/d8/ex_8h.html#a284">ExLockHandleTableExclusive</a>( HandleTable );
01193 
01194     <span class="keywordflow">try</span> {
01195 
01196         <span class="comment">//</span>
01197         <span class="comment">//  Allocate a new handle table entry, and get the handle value</span>
01198         <span class="comment">//</span>
01199 
01200         NewHandleTableEntry = <a class="code" href="../../d0/d8/ex_2handle_8c.html#a6">ExpAllocateHandleTableEntry</a>( HandleTable,
01201                                                            &amp;Handle );
01202 
01203         <span class="comment">//</span>
01204         <span class="comment">//  If we really got a handle then copy over the template and unlock</span>
01205         <span class="comment">//  the entry</span>
01206         <span class="comment">//</span>
01207 
01208         <span class="keywordflow">if</span> (NewHandleTableEntry != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01209 
01210             *NewHandleTableEntry = *HandleTableEntry;
01211 
01212             <a class="code" href="../../d5/d8/ex_8h.html#a288">ExUnlockHandleTableEntry</a>( HandleTable, NewHandleTableEntry );
01213         }
01214 
01215     } finally {
01216 
01217         <a class="code" href="../../d5/d8/ex_8h.html#a286">ExUnlockHandleTableExclusive</a>( HandleTable );
01218         <a class="code" href="../../d4/d9/ke_8h.html#a29">KeLeaveCriticalRegion</a>();
01219     }
01220 
01221     <span class="keywordflow">return</span> <a class="code" href="../../d7/d0/cmdat2_8c.html#a19">Handle</a>.GenericHandleOverlay;
01222 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a290" doxytag="ex.h::ExCreateHandleTable" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI <a class="el" href="../../d6/d3/struct__HANDLE__TABLE.html">PHANDLE_TABLE</a> ExCreateHandleTable           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN struct <a class="el" href="../../d0/d4/struct__EPROCESS.html">_EPROCESS</a> *Process&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>OPTIONAL</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l00457">457</a> of file <a class="el" href="../../d1/d7/ex_2handle_8c-source.html">ex/handle.c</a>.
<p>
References <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l01475">ExpAllocateHandleTable()</a>, and <a class="el" href="../../d1/d8/ntosdef_8h-source.html#l00462">PAGED_CODE</a>.
<p>
Referenced by <a class="el" href="../../d5/d9/tex_8c-source.html#l01160">DoHandleTest()</a>, <a class="el" href="../../d1/d0/obinit_8c-source.html#l00815">ObInitProcess()</a>, <a class="el" href="../../d1/d0/obinit_8c-source.html#l00117">ObInitSystem()</a>, <a class="el" href="../../d1/d0/psinit_8c-source.html#l00181">PspInitPhase0()</a>, and <a class="el" href="../../d1/d9/rtl_2atom_8c-source.html#l00112">RtlpInitializeHandleTableForAtomTable()</a>.
<p>
<pre class="fragment"><div>00463                    :
00464 
00465     This function allocate and initialize a <span class="keyword">new</span> <span class="keyword">new</span> handle table
00466 
00467 Arguments:
00468 
00469     Process - Supplies an optional pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> process against which quota
00470         will be charged.
00471 
00472 Return Value:
00473 
00474     If a handle table <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> successfully created, then <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> address of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00475     handle table <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned as <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> function value. Otherwize, a value
00476     <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned.
00477 
00478 --*/
00479 
00480 {
00481     <a class="code" href="../../d6/d3/struct__HANDLE__TABLE.html">PHANDLE_TABLE</a> HandleTable;
00482 
00483     <a class="code" href="../../d0/d9/ntosdef_8h.html#a28">PAGED_CODE</a>();
00484 
00485     <span class="comment">//</span>
00486     <span class="comment">//  Allocate and initialize a handle table descriptor</span>
00487     <span class="comment">//</span>
00488 
00489     HandleTable = <a class="code" href="../../d0/d8/ex_2handle_8c.html#a4">ExpAllocateHandleTable</a>( Process );
00490 
00491     <span class="comment">//</span>
00492     <span class="comment">//  And return to our caller</span>
00493     <span class="comment">//</span>
00494 
00495     <span class="keywordflow">return</span> HandleTable;
00496 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a310" doxytag="ex.h::ExDebugLogEvent" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI VOID ExDebugLogEvent           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d4/d7/struct__EX__DEBUG__LOG.html">PEX_DEBUG_LOG</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Log</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN UCHAR&nbsp;</td>
          <td class="mdname" nowrap> <em>Tag</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Data1</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Data2</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Data3</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Data4</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d5/d4/logger_8c-source.html#l00106">106</a> of file <a class="el" href="../../d5/d4/logger_8c-source.html">logger.c</a>.
<p>
References <a class="el" href="../../d2/d8/ps_8h-source.html#l00388">_ETHREAD::Cid</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l03141">_EX_DEBUG_LOG_EVENT::Data</a>, <a class="el" href="../../d8/d9/ke_2miscc_8c-source.html#l00153">KeQuerySystemTime()</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l03137">_EX_DEBUG_LOG_EVENT::ProcessId</a>, <a class="el" href="../../d2/d8/ps_8h-source.html#l00645">PsGetCurrentThread</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l03139">_EX_DEBUG_LOG_EVENT::Tag</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l03136">_EX_DEBUG_LOG_EVENT::ThreadId</a>, and <a class="el" href="../../d6/d7/ex_8h-source.html#l03138">_EX_DEBUG_LOG_EVENT::Time</a>.
<p>
<pre class="fragment"><div>00114 {
00115     KIRQL OldIrql;
00116     <a class="code" href="../../d5/d7/struct__EX__DEBUG__LOG__EVENT.html">PEX_DEBUG_LOG_EVENT</a> p;
00117     <a class="code" href="../../d5/d6/struct__ETHREAD.html">PETHREAD</a> Thread = <a class="code" href="../../d1/d9/ps_8h.html#a20">PsGetCurrentThread</a>();
00118     LARGE_INTEGER CurrentTime;
00119 
00120     <a class="code" href="../../d7/d0/ke_2miscc_8c.html#a3">KeQuerySystemTime</a>( &amp;CurrentTime );
00121 
00122     ExAcquireSpinLock( &amp;Log-&gt;Lock, &amp;OldIrql );
00123 
00124     p = Log-&gt;Next;
00125     <span class="keywordflow">if</span> (p == Log-&gt;Last) {
00126         p = Log-&gt;First;
00127         }
00128     Log-&gt;Next = p + 1;
00129 
00130     p-&gt;<a class="code" href="../../d5/d7/struct__EX__DEBUG__LOG__EVENT.html#o0">ThreadId</a> = Thread-&gt;<a class="code" href="../../d5/d6/struct__ETHREAD.html#o12">Cid</a>.UniqueThread;
00131     p-&gt;<a class="code" href="../../d5/d7/struct__EX__DEBUG__LOG__EVENT.html#o1">ProcessId</a> = Thread-&gt;<a class="code" href="../../d5/d6/struct__ETHREAD.html#o12">Cid</a>.UniqueProcess;
00132     p-&gt;<a class="code" href="../../d5/d7/struct__EX__DEBUG__LOG__EVENT.html#o2">Time</a> = CurrentTime.LowPart;
00133     p-&gt;<a class="code" href="../../d5/d7/struct__EX__DEBUG__LOG__EVENT.html#o3">Tag</a> = Tag;
00134     p-&gt;<a class="code" href="../../d5/d7/struct__EX__DEBUG__LOG__EVENT.html#o5">Data</a>[ 0 ] = Data1;
00135     p-&gt;<a class="code" href="../../d5/d7/struct__EX__DEBUG__LOG__EVENT.html#o5">Data</a>[ 1 ] = Data2;
00136     p-&gt;<a class="code" href="../../d5/d7/struct__EX__DEBUG__LOG__EVENT.html#o5">Data</a>[ 2 ] = Data3;
00137     p-&gt;<a class="code" href="../../d5/d7/struct__EX__DEBUG__LOG__EVENT.html#o5">Data</a>[ 3 ] = Data4;
00138 
00139     ExReleaseSpinLock( &amp;Log-&gt;Lock, OldIrql );
00140 
00141     <span class="keywordflow">return</span>;
00142 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a247" doxytag="ex.h::ExDeleteNPagedLookasideList" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI VOID ExDeleteNPagedLookasideList           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d1/d4/struct__NPAGED__LOOKASIDE__LIST.html">PNPAGED_LOOKASIDE_LIST</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Lookaside</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d5/ex_2lookasid_8c-source.html#l00494">494</a> of file <a class="el" href="../../d0/d5/ex_2lookasid_8c-source.html">ex/lookasid.c</a>.
<p>
References <a class="el" href="../../d6/d7/ex_8h-source.html#l00780">ExAllocateFromNPagedLookasideList()</a>, <a class="el" href="../../d5/d9/exp_8h-source.html#l00263">ExNPagedLookasideLock</a>, <a class="el" href="../../d0/d5/ex_2lookasid_8c-source.html#l00802">ExpDummyAllocate()</a>, and <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>.
<p>
<pre class="fragment"><div>00500                    :
00501 
00502     This function removes a paged lookaside structure from <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> system paged
00503     lookaside list and frees any entries specified by <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> lookaside structure.
00504 
00505 Arguments:
00506 
00507     Lookaside - Supplies a pointer to a nonpaged lookaside list structure.
00508 
00509 Return Value:
00510 
00511     None.
00512 
00513 --*/
00514 
00515 {
00516 
00517     PVOID Entry;
00518     KIRQL OldIrql;
00519 
00520     <span class="comment">//</span>
00521     <span class="comment">// Acquire the nonpaged system lookaside list lock and remove the</span>
00522     <span class="comment">// specified lookaside list structure from the list.</span>
00523     <span class="comment">//</span>
00524 
00525     ExAcquireSpinLock(&amp;ExNPagedLookasideLock, &amp;OldIrql);
00526     RemoveEntryList(&amp;Lookaside-&gt;L.ListEntry);
00527     ExReleaseSpinLock(&amp;ExNPagedLookasideLock, OldIrql);
00528 
00529     <span class="comment">//</span>
00530     <span class="comment">// Remove all pool entries from the specified lookaside structure</span>
00531     <span class="comment">// and free them.</span>
00532     <span class="comment">//</span>
00533 
00534     Lookaside-&gt;L.Allocate = <a class="code" href="../../d9/d5/ex_2lookasid_8c.html#a11">ExpDummyAllocate</a>;
00535     <span class="keywordflow">while</span> ((Entry = <a class="code" href="../../d5/d8/ex_8h.html#a248">ExAllocateFromNPagedLookasideList</a>(Lookaside)) != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00536         (Lookaside-&gt;L.Free)(Entry);
00537     }
00538 
00539     <span class="keywordflow">return</span>;
00540 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a251" doxytag="ex.h::ExDeletePagedLookasideList" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI VOID ExDeletePagedLookasideList           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d1/d8/struct__PAGED__LOOKASIDE__LIST.html">PPAGED_LOOKASIDE_LIST</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Lookaside</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d5/ex_2lookasid_8c-source.html#l00629">629</a> of file <a class="el" href="../../d0/d5/ex_2lookasid_8c-source.html">ex/lookasid.c</a>.
<p>
References <a class="el" href="../../d6/d7/ex_8h-source.html#l00906">ExAllocateFromPagedLookasideList()</a>, <a class="el" href="../../d5/d9/exp_8h-source.html#l00265">ExPagedLookasideLock</a>, <a class="el" href="../../d0/d5/ex_2lookasid_8c-source.html#l00802">ExpDummyAllocate()</a>, and <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>.
<p>
Referenced by <a class="el" href="../../d7/d2/queue_8c-source.html#l02193">FreeCachedQueues()</a>, and <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l00097">Win32kNtUserCleanup()</a>.
<p>
<pre class="fragment"><div>00635                    :
00636 
00637     This function removes a paged lookaside structure from <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> system paged
00638     lookaside list and frees any entries specified by <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> lookaside structure.
00639 
00640 Arguments:
00641 
00642     Lookaside - Supplies a pointer to a paged lookaside list structure.
00643 
00644 Return Value:
00645 
00646     None.
00647 
00648 --*/
00649 
00650 {
00651 
00652     PVOID Entry;
00653     KIRQL OldIrql;
00654 
00655     <span class="comment">//</span>
00656     <span class="comment">// Acquire the paged system lookaside list lock and remove the</span>
00657     <span class="comment">// specified lookaside list structure from the list.</span>
00658     <span class="comment">//</span>
00659 
00660     ExAcquireSpinLock(&amp;ExPagedLookasideLock, &amp;OldIrql);
00661     RemoveEntryList(&amp;Lookaside-&gt;L.ListEntry);
00662     ExReleaseSpinLock(&amp;ExPagedLookasideLock, OldIrql);
00663 
00664     <span class="comment">//</span>
00665     <span class="comment">// Remove all pool entries from the specified lookaside structure</span>
00666     <span class="comment">// and free them.</span>
00667     <span class="comment">//</span>
00668 
00669     Lookaside-&gt;L.Allocate = <a class="code" href="../../d9/d5/ex_2lookasid_8c.html#a11">ExpDummyAllocate</a>;
00670     <span class="keywordflow">while</span> ((Entry = <a class="code" href="../../d5/d8/ex_8h.html#a252">ExAllocateFromPagedLookasideList</a>(Lookaside)) != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00671         (Lookaside-&gt;L.Free)(Entry);
00672     }
00673 
00674     <span class="keywordflow">return</span>;
00675 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a277" doxytag="ex.h::ExDeleteResourceLite" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI NTSTATUS ExDeleteResourceLite           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d6/d4/struct__ERESOURCE.html">PERESOURCE</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Resource</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l02005">2005</a> of file <a class="el" href="../../d9/d7/ex_2resource_8c-source.html">ex/resource.c</a>.
<p>
References <a class="el" href="../../d6/d7/ex_8h-source.html#l02323">_RESOURCE_PERFORMANCE_DATA::ActiveResourceCount</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02317">_RESOURCE_HASH_ENTRY::Address</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02298">_ERESOURCE::Address</a>, <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d8/d3/ddkresrc_8c-source.html#l00070">ASSERT_RESOURCE</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02294">_ERESOURCE::ContentionCount</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02318">_RESOURCE_HASH_ENTRY::ContentionCount</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l00253">ExAllocatePoolWithTag</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02292">_ERESOURCE::ExclusiveWaiters</a>, <a class="el" href="../../d7/d2/cmwraper_8c-source.html#l00304">ExFreePool()</a>, <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l00114">ExpResourceSpinLock</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02333">_RESOURCE_PERFORMANCE_DATA::HashTable</a>, <a class="el" href="../../d8/d3/ddkresrc_8c-source.html#l00089">IsExclusiveWaiting</a>, <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l00049">IsSharedWaiting</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02316">_RESOURCE_HASH_ENTRY::ListEntry</a>, <a class="el" href="../../d5/d8/ex_8h.html#a329a173">NonPagedPool</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02319">_RESOURCE_HASH_ENTRY::Number</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02288">_ERESOURCE::OwnerTable</a>, <a class="el" href="../../d5/d8/ex_8h.html#a128">PRESOURCE_HASH_ENTRY</a>, <a class="el" href="../../d5/d9/tex_8c-source.html#l01561">Resource</a>, <a class="el" href="../../d5/d8/ex_8h.html#a127">RESOURCE_HASH_ENTRY</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02313">RESOURCE_HASH_TABLE_SIZE</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02291">_ERESOURCE::SharedWaiters</a>, and <a class="el" href="../../d6/d7/ex_8h-source.html#l02287">_ERESOURCE::SystemResourcesList</a>.
<p>
<pre class="fragment"><div>02011                    :
02012 
02013     This routine deallocates any <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a> allocated to support <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified
02014     resource.
02015 
02016 
02017 Arguments:
02018 
02019     <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a> - Supplies a pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> resource whose allocated <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a>
02020         <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> freed.
02021 
02022 Return Value:
02023 
02024     STATUS_SUCCESS.
02025 
02026 --*/
02027 
02028 {
02029 
02030     <a class="code" href="../../d3/d4/struct__RESOURCE__HASH__ENTRY.html">PRESOURCE_HASH_ENTRY</a> HashEntry;
02031     ULONG Hash;
02032     <a class="code" href="../../d3/d4/struct__RESOURCE__HASH__ENTRY.html">PRESOURCE_HASH_ENTRY</a> MatchEntry;
02033     PLIST_ENTRY NextEntry;
02034     KIRQL OldIrql;
02035 
02036     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(<a class="code" href="../../d8/d8/ex_2resource_8c.html#a1">IsSharedWaiting</a>(Resource) == FALSE);
02037     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(<a class="code" href="../../d7/d4/ddkresrc_8c.html#a5">IsExclusiveWaiting</a>(Resource) == FALSE);
02038 
02039     <span class="comment">//</span>
02040     <span class="comment">// Acquire the executive resource spinlock and remove the resource from</span>
02041     <span class="comment">// the system resource list.</span>
02042     <span class="comment">//</span>
02043 
02044     ExAcquireSpinLock(&amp;ExpResourceSpinLock, &amp;OldIrql);
02045 
02046     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(KeIsExecutingDpc() == FALSE);
02047     <a class="code" href="../../d7/d4/ddkresrc_8c.html#a0">ASSERT_RESOURCE</a>(Resource);
02048 
02049     RemoveEntryList(&amp;<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o0">SystemResourcesList</a>);
02050 
02051 <span class="preprocessor">#if defined(_COLLECT_RESOURCE_DATA_)</span>
02052 <span class="preprocessor"></span>
02053     <span class="comment">//</span>
02054     <span class="comment">// Lookup resource initialization address in resource hash table. If</span>
02055     <span class="comment">// the address does not exist in the table, then create a new entry.</span>
02056     <span class="comment">//</span>
02057 
02058     Hash = (ULONG)<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o10">Address</a>;
02059     Hash = ((Hash &gt; 24) ^ (Hash &gt; 16) ^ (Hash &gt; 8) ^ (Hash)) &amp; (<a class="code" href="../../d5/d8/ex_8h.html#a65">RESOURCE_HASH_TABLE_SIZE</a> - 1);
02060     MatchEntry = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
02061     NextEntry = ExpResourcePerformanceData.HashTable[Hash].Flink;
02062     <span class="keywordflow">while</span> (NextEntry != &amp;ExpResourcePerformanceData.HashTable[Hash]) {
02063         HashEntry = CONTAINING_RECORD(NextEntry,
02064                                       <a class="code" href="../../d3/d4/struct__RESOURCE__HASH__ENTRY.html">RESOURCE_HASH_ENTRY</a>,
02065                                       ListEntry);
02066 
02067         <span class="keywordflow">if</span> (HashEntry-&gt;<a class="code" href="../../d3/d4/struct__RESOURCE__HASH__ENTRY.html#o1">Address</a> == <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o10">Address</a>) {
02068             MatchEntry = HashEntry;
02069             <span class="keywordflow">break</span>;
02070         }
02071 
02072         NextEntry = NextEntry-&gt;Flink;
02073     }
02074 
02075     <span class="comment">//</span>
02076     <span class="comment">// If a matching initialization address was found, then update the call</span>
02077     <span class="comment">// site statistics. Otherwise, allocate a new hash entry and initialize</span>
02078     <span class="comment">// call site statistics.</span>
02079     <span class="comment">//</span>
02080 
02081     <span class="keywordflow">if</span> (MatchEntry != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
02082         MatchEntry-&gt;<a class="code" href="../../d3/d4/struct__RESOURCE__HASH__ENTRY.html#o2">ContentionCount</a> += <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o7">ContentionCount</a>;
02083         MatchEntry-&gt;<a class="code" href="../../d3/d4/struct__RESOURCE__HASH__ENTRY.html#o3">Number</a> += 1;
02084 
02085     } <span class="keywordflow">else</span> {
02086         MatchEntry = <a class="code" href="../../d5/d8/ex_8h.html#a4">ExAllocatePoolWithTag</a>(NonPagedPool,
02087                                           <span class="keyword">sizeof</span>(<a class="code" href="../../d3/d4/struct__RESOURCE__HASH__ENTRY.html">RESOURCE_HASH_ENTRY</a>),
02088                                           'vEpR');
02089 
02090         <span class="keywordflow">if</span> (MatchEntry != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
02091             MatchEntry-&gt;<a class="code" href="../../d3/d4/struct__RESOURCE__HASH__ENTRY.html#o1">Address</a> = <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o10">Address</a>;
02092             MatchEntry-&gt;<a class="code" href="../../d3/d4/struct__RESOURCE__HASH__ENTRY.html#o2">ContentionCount</a> = <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o7">ContentionCount</a>;
02093             MatchEntry-&gt;<a class="code" href="../../d3/d4/struct__RESOURCE__HASH__ENTRY.html#o3">Number</a> = 1;
02094             InsertTailList(&amp;ExpResourcePerformanceData.HashTable[Hash],
02095                            &amp;MatchEntry-&gt;<a class="code" href="../../d3/d4/struct__RESOURCE__HASH__ENTRY.html#o0">ListEntry</a>);
02096         }
02097     }
02098 
02099     ExpResourcePerformanceData.ActiveResourceCount -= 1;
02100 
02101 <span class="preprocessor">#endif</span>
02102 <span class="preprocessor"></span>
02103     ExReleaseSpinLock(&amp;ExpResourceSpinLock, OldIrql);
02104 
02105     <span class="comment">//</span>
02106     <span class="comment">// If an owner table was allocated, then free it to pool.</span>
02107     <span class="comment">//</span>
02108 
02109     <span class="keywordflow">if</span> (<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o1">OwnerTable</a> != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
02110         <a class="code" href="../../d5/d8/ex_8h.html#a224">ExFreePool</a>(<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o1">OwnerTable</a>);
02111     }
02112 
02113     <span class="comment">//</span>
02114     <span class="comment">// If a semaphore was allocated, then free it to pool.</span>
02115     <span class="comment">//</span>
02116 
02117     <span class="keywordflow">if</span> (<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o4">SharedWaiters</a>) {
02118         <a class="code" href="../../d5/d8/ex_8h.html#a224">ExFreePool</a>(<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o4">SharedWaiters</a>);
02119     }
02120 
02121     <span class="comment">//</span>
02122     <span class="comment">// If an event was allocated, then free it to pool.</span>
02123     <span class="comment">//</span>
02124 
02125     <span class="keywordflow">if</span> (<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o5">ExclusiveWaiters</a>) {
02126         <a class="code" href="../../d5/d8/ex_8h.html#a224">ExFreePool</a>(<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o5">ExclusiveWaiters</a>);
02127     }
02128 
02129     <span class="keywordflow">return</span> STATUS_SUCCESS;
02130 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a297" doxytag="ex.h::ExDestroyHandle" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI BOOLEAN ExDestroyHandle           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d6/d3/struct__HANDLE__TABLE.html">PHANDLE_TABLE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>HandleTable</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN HANDLE&nbsp;</td>
          <td class="mdname" nowrap> <em>Handle</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d7/d3/struct__HANDLE__TABLE__ENTRY.html">PHANDLE_TABLE_ENTRY</a> HandleTableEntry&nbsp;</td>
          <td class="mdname" nowrap> <em>OPTIONAL</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l01227">1227</a> of file <a class="el" href="../../d1/d7/ex_2handle_8c-source.html">ex/handle.c</a>.
<p>
References <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l00240">ExLockHandleTableEntry()</a>, <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l00146">ExLockHandleTableExclusive()</a>, <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l02127">ExpFreeHandleTableEntry()</a>, <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l02195">ExpLookupHandleTableEntry()</a>, <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l00209">ExUnlockHandleTableExclusive()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02630">_EXHANDLE::GenericHandleOverlay</a>, <a class="el" href="../../d8/d9/cmdat2_8c-source.html#l00091">Handle</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l01598">KeEnterCriticalRegion</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l01628">KeLeaveCriticalRegion</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d1/d8/ntosdef_8h-source.html#l00462">PAGED_CODE</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d5/d9/tex_8c-source.html#l01160">DoHandleTest()</a>, <a class="el" href="../../d6/d9/obclose_8c-source.html#l00037">NtClose()</a>, <a class="el" href="../../d9/d9/psdelete_8c-source.html#l01363">PspProcessDelete()</a>, <a class="el" href="../../d9/d9/psdelete_8c-source.html#l01438">PspThreadDelete()</a>, and <a class="el" href="../../d1/d9/rtl_2atom_8c-source.html#l00228">RtlpFreeHandleForAtom()</a>.
<p>
<pre class="fragment"><div>01235                    :
01236 
01237     This function removes a handle from a handle table.
01238 
01239 Arguments:
01240 
01241     HandleTable - Supplies a pointer to a handle table
01242 
01243     <a class="code" href="../../d7/d0/cmdat2_8c.html#a19">Handle</a> - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> handle value of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> entry to remove.
01244 
01245     HandleTableEntry - Optionally supplies a pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> handle
01246         table entry being destroyed.  If supplied <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> entry <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a>
01247         assume to be locked.
01248 
01249 Return Value:
01250 
01251     If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified handle <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> successfully removed, then a value of
01252     <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned. Otherwise, a value of <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned.
01253 
01254 --*/
01255 
01256 {
01257     <a class="code" href="../../d7/d8/struct__EXHANDLE.html">EXHANDLE</a> LocalHandle;
01258 
01259     <a class="code" href="../../d0/d9/ntosdef_8h.html#a28">PAGED_CODE</a>();
01260 
01261     LocalHandle.<a class="code" href="../../d7/d8/struct__EXHANDLE.html#o2">GenericHandleOverlay</a> = <a class="code" href="../../d7/d0/cmdat2_8c.html#a19">Handle</a>;
01262 
01263     <span class="comment">//</span>
01264     <span class="comment">//  If the caller did not supply the optional handle table entry then</span>
01265     <span class="comment">//  locate the entry via the supplied handle, make sure it is real, and</span>
01266     <span class="comment">//  then lock the entry.</span>
01267     <span class="comment">//</span>
01268 
01269     <span class="keywordflow">if</span> (HandleTableEntry == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01270 
01271         HandleTableEntry = <a class="code" href="../../d0/d8/ex_2handle_8c.html#a8">ExpLookupHandleTableEntry</a>( HandleTable,
01272                                                       LocalHandle );
01273 
01274         <span class="keywordflow">if</span> (HandleTableEntry == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01275 
01276             <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01277         }
01278 
01279         <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d8/ex_8h.html#a287">ExLockHandleTableEntry</a>( HandleTable, HandleTableEntry )) {
01280 
01281             <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01282         }
01283     }
01284 
01285     <span class="comment">//</span>
01286     <span class="comment">//  At this point we have a locked handle table entry.  Now mark it free</span>
01287     <span class="comment">//  which does the implicit unlock.  The system will not allocate it</span>
01288     <span class="comment">//  again until we add it to the free list which we will do right after</span>
01289     <span class="comment">//  we take out the lock</span>
01290     <span class="comment">//</span>
01291 
01292     HandleTableEntry-&gt;Object = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01293 
01294     <a class="code" href="../../d4/d9/ke_8h.html#a28">KeEnterCriticalRegion</a>();
01295     <a class="code" href="../../d5/d8/ex_8h.html#a284">ExLockHandleTableExclusive</a>( HandleTable );
01296 
01297     <span class="keywordflow">try</span> {
01298 
01299         <a class="code" href="../../d0/d8/ex_2handle_8c.html#a7">ExpFreeHandleTableEntry</a>( HandleTable,
01300                                  LocalHandle,
01301                                  HandleTableEntry );
01302 
01303     } finally {
01304 
01305         <a class="code" href="../../d5/d8/ex_8h.html#a286">ExUnlockHandleTableExclusive</a>( HandleTable );
01306         <a class="code" href="../../d4/d9/ke_8h.html#a29">KeLeaveCriticalRegion</a>();
01307     }
01308 
01309     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01310 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a292" doxytag="ex.h::ExDestroyHandleTable" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI VOID ExDestroyHandleTable           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d6/d3/struct__HANDLE__TABLE.html">PHANDLE_TABLE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>HandleTable</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d5/d8/ex_8h.html#a139">EX_DESTROY_HANDLE_ROUTINE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>DestroyHandleProcedure</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l00560">560</a> of file <a class="el" href="../../d1/d7/ex_2handle_8c-source.html">ex/handle.c</a>.
<p>
References <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l01667">ExpFreeHandleTable()</a>, <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l02195">ExpLookupHandleTableEntry()</a>, <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l00501">ExRemoveHandleTable()</a>, <a class="el" href="../../d8/d9/cmdat2_8c-source.html#l00091">Handle</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02672">_HANDLE_TABLE_ENTRY::Object</a>, and <a class="el" href="../../d1/d8/ntosdef_8h-source.html#l00462">PAGED_CODE</a>.
<p>
Referenced by <a class="el" href="../../d5/d9/tex_8c-source.html#l01160">DoHandleTest()</a>, <a class="el" href="../../d1/d0/obinit_8c-source.html#l01022">ObKillProcess()</a>, and <a class="el" href="../../d1/d9/rtl_2atom_8c-source.html#l00139">RtlpDestroyHandleTableForAtomTable()</a>.
<p>
<pre class="fragment"><div>00567                    :
00568 
00569     This function destroys <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified handle table.
00570 
00571 Arguments:
00572 
00573     HandleTable - Supplies a pointer to a handle table
00574 
00575     DestroyHandleProcedure - Supplies a pointer to a function to call <span class="keywordflow">for</span> each
00576         valid handle entry in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> handle table.
00577 
00578 Return Value:
00579 
00580     None.
00581 
00582 --*/
00583 
00584 {
00585     <a class="code" href="../../d7/d8/struct__EXHANDLE.html">EXHANDLE</a> <a class="code" href="../../d7/d0/cmdat2_8c.html#a19">Handle</a>;
00586     <a class="code" href="../../d7/d3/struct__HANDLE__TABLE__ENTRY.html">PHANDLE_TABLE_ENTRY</a> HandleTableEntry;
00587 
00588     <a class="code" href="../../d0/d9/ntosdef_8h.html#a28">PAGED_CODE</a>();
00589 
00590     <span class="comment">//</span>
00591     <span class="comment">//  Remove the handle table from the handle table list</span>
00592     <span class="comment">//</span>
00593 
00594     <a class="code" href="../../d5/d8/ex_8h.html#a291">ExRemoveHandleTable</a>( HandleTable );
00595 
00596     <span class="comment">//</span>
00597     <span class="comment">//  Iterate through the handle table and for each handle that is allocated</span>
00598     <span class="comment">//  we'll invoke the call back.  Note that this loop exits when we get a</span>
00599     <span class="comment">//  null handle table entry.  We know there will be no more possible</span>
00600     <span class="comment">//  entries after the first null one is encountered because we allocate</span>
00601     <span class="comment">//  memory of the handles in a dense fashion.  But first test that we have</span>
00602     <span class="comment">//  call back to use</span>
00603     <span class="comment">//</span>
00604 
00605     <span class="keywordflow">if</span> (ARGUMENT_PRESENT(DestroyHandleProcedure)) {
00606 
00607         <span class="keywordflow">for</span> (<a class="code" href="../../d7/d0/cmdat2_8c.html#a19">Handle</a>.GenericHandleOverlay = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>; <span class="comment">// does essentially the following "Handle.Index = 0, Handle.TagBits = 0;"</span>
00608              (HandleTableEntry = <a class="code" href="../../d0/d8/ex_2handle_8c.html#a8">ExpLookupHandleTableEntry</a>( HandleTable, Handle )) != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00609              <a class="code" href="../../d7/d0/cmdat2_8c.html#a19">Handle</a>.Index += 1) {
00610 
00611             <span class="comment">//</span>
00612             <span class="comment">//  Only do the callback if the entry is not free</span>
00613             <span class="comment">//</span>
00614 
00615             <span class="keywordflow">if</span> (HandleTableEntry-&gt;<a class="code" href="../../d7/d3/struct__HANDLE__TABLE__ENTRY.html#o0">Object</a> != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00616 
00617                 (*DestroyHandleProcedure)( <a class="code" href="../../d7/d0/cmdat2_8c.html#a19">Handle</a>.GenericHandleOverlay );
00618             }
00619         }
00620     }
00621 
00622     <span class="comment">//</span>
00623     <span class="comment">//  Now free up the handle table memory and return to our caller</span>
00624     <span class="comment">//</span>
00625 
00626     <a class="code" href="../../d0/d8/ex_2handle_8c.html#a5">ExpFreeHandleTable</a>( HandleTable );
00627 
00628     <span class="keywordflow">return</span>;
00629 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a280" doxytag="ex.h::ExDisableResourceBoostLite" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI VOID ExDisableResourceBoostLite           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d6/d4/struct__ERESOURCE.html">PERESOURCE</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Resource</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l00370">370</a> of file <a class="el" href="../../d9/d7/ex_2resource_8c-source.html">ex/resource.c</a>.
<p>
References <a class="el" href="../../d8/d3/ddkresrc_8c-source.html#l00070">ASSERT_RESOURCE</a>, <a class="el" href="../../d8/d3/ddkresrc_8c-source.html#l00080">DisablePriorityBoost</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02290">_ERESOURCE::Flag</a>, <a class="el" href="../../d5/d9/tex_8c-source.html#l01561">Resource</a>, and <a class="el" href="../../d6/d7/ex_8h-source.html#l02302">_ERESOURCE::SpinLock</a>.
<p>
<pre class="fragment"><div>00376                    :
00377 
00378     This routine disables priority inversion boosting <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified
00379     resource.
00380 
00381 Arguments:
00382 
00383     <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a> - Supplies a pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> resource <span class="keywordflow">for</span> which priority
00384         boosting <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> disabled.
00385 
00386 Return Value:
00387 
00388     None.
00389 
00390 --*/
00391 
00392 {
00393 
00394     KIRQL OldIrql;
00395 
00396     <span class="comment">//</span>
00397     <span class="comment">// Disable priority boosts for the specified resource.</span>
00398     <span class="comment">//</span>
00399 
00400     ExAcquireFastLock(&amp;<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o12">SpinLock</a>, &amp;OldIrql);
00401 
00402     <a class="code" href="../../d7/d4/ddkresrc_8c.html#a0">ASSERT_RESOURCE</a>(Resource);
00403 
00404     <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o3">Flag</a> |= <a class="code" href="../../d7/d4/ddkresrc_8c.html#a3">DisablePriorityBoost</a>;
00405     ExReleaseFastLock(&amp;<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o12">SpinLock</a>, OldIrql);
00406 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a294" doxytag="ex.h::ExDupHandleTable" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI <a class="el" href="../../d6/d3/struct__HANDLE__TABLE.html">PHANDLE_TABLE</a> ExDupHandleTable           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN struct <a class="el" href="../../d0/d4/struct__EPROCESS.html">_EPROCESS</a> *Process&nbsp;</td>
          <td class="mdname" nowrap> <em>OPTIONAL</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d6/d3/struct__HANDLE__TABLE.html">PHANDLE_TABLE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>OldHandleTable</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d5/d8/ex_8h.html#a141">EX_DUPLICATE_HANDLE_ROUTINE</a> DupHandleProcedure&nbsp;</td>
          <td class="mdname" nowrap> <em>OPTIONAL</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l00765">765</a> of file <a class="el" href="../../d1/d7/ex_2handle_8c-source.html">ex/handle.c</a>.
<p>
References <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l00240">ExLockHandleTableEntry()</a>, <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l00114">ExLockHandleTableShared()</a>, <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l01475">ExpAllocateHandleTable()</a>, <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l01825">ExpAllocateHandleTableEntry()</a>, <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l01667">ExpFreeHandleTable()</a>, <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l02127">ExpFreeHandleTableEntry()</a>, <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l02195">ExpLookupHandleTableEntry()</a>, <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l00336">ExUnlockHandleTableEntry()</a>, <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l00178">ExUnlockHandleTableShared()</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02746">_HANDLE_TABLE::FirstFreeTableEntry</a>, <a class="el" href="../../d8/d9/cmdat2_8c-source.html#l00091">Handle</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02723">_HANDLE_TABLE::HandleCount</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l01598">KeEnterCriticalRegion</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l01628">KeLeaveCriticalRegion</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02699">_HANDLE_TABLE_ENTRY::NextFreeTableEntry</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02747">_HANDLE_TABLE::NextIndexNeedingPool</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02672">_HANDLE_TABLE_ENTRY::Object</a>, and <a class="el" href="../../d1/d8/ntosdef_8h-source.html#l00462">PAGED_CODE</a>.
<p>
Referenced by <a class="el" href="../../d5/d9/tex_8c-source.html#l01160">DoHandleTest()</a>, and <a class="el" href="../../d1/d0/obinit_8c-source.html#l00815">ObInitProcess()</a>.
<p>
<pre class="fragment"><div>00773                    :
00774 
00775     This function creates a duplicate copy of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified handle table.
00776 
00777 Arguments:
00778 
00779     Process - Supplies an optional to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> process to charge quota to.
00780 
00781     OldHandleTable - Supplies a pointer to a handle table.
00782 
00783     DupHandleProcedure - Supplies an optional pointer to a function to call
00784         <span class="keywordflow">for</span> each valid handle in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> duplicated handle table.
00785 
00786 Return Value:
00787 
00788     If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified handle table <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> successfully duplicated, then <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00789     address of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <span class="keyword">new</span> handle table <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned as <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> function value.
00790     Otherwize, a value <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned.
00791 
00792 --*/
00793 
00794 {
00795     <a class="code" href="../../d6/d3/struct__HANDLE__TABLE.html">PHANDLE_TABLE</a> NewHandleTable;
00796 
00797     <a class="code" href="../../d7/d3/struct__HANDLE__TABLE__ENTRY.html">PHANDLE_TABLE_ENTRY</a> AdditionalFreeEntries;
00798 
00799     <a class="code" href="../../d7/d8/struct__EXHANDLE.html">EXHANDLE</a> <a class="code" href="../../d7/d0/cmdat2_8c.html#a19">Handle</a>;
00800 
00801     <a class="code" href="../../d7/d3/struct__HANDLE__TABLE__ENTRY.html">PHANDLE_TABLE_ENTRY</a> OldHandleTableEntry;
00802     <a class="code" href="../../d7/d3/struct__HANDLE__TABLE__ENTRY.html">PHANDLE_TABLE_ENTRY</a> NewHandleTableEntry;
00803 
00804     <a class="code" href="../../d0/d9/ntosdef_8h.html#a28">PAGED_CODE</a>();
00805 
00806     <span class="comment">//</span>
00807     <span class="comment">//  First allocate a new handle table.  If this fails then</span>
00808     <span class="comment">//  return immediately to our caller</span>
00809     <span class="comment">//</span>
00810 
00811     NewHandleTable = <a class="code" href="../../d0/d8/ex_2handle_8c.html#a4">ExpAllocateHandleTable</a>( Process );
00812 
00813     <span class="keywordflow">if</span> (NewHandleTable == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00814 
00815         <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00816     }
00817 
00818     <span class="comment">//</span>
00819     <span class="comment">//  Now lock down the old handle table.  We will release it</span>
00820     <span class="comment">//  right after enumerating through the table</span>
00821     <span class="comment">//</span>
00822 
00823     <a class="code" href="../../d4/d9/ke_8h.html#a28">KeEnterCriticalRegion</a>();
00824     <a class="code" href="../../d5/d8/ex_8h.html#a283">ExLockHandleTableShared</a>( OldHandleTable );
00825 
00826     AdditionalFreeEntries = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00827 
00828     <span class="keywordflow">try</span> {
00829 
00830         <span class="comment">//</span>
00831         <span class="comment">//  Now we'll build up the new handle table. We do this by calling</span>
00832         <span class="comment">//  allocating new handle table entries, and "fooling" the worker</span>
00833         <span class="comment">//  routine to allocate keep on allocating until the next free</span>
00834         <span class="comment">//  index needing pool are equal</span>
00835         <span class="comment">//</span>
00836 
00837         <span class="keywordflow">while</span> (NewHandleTable-&gt;<a class="code" href="../../d6/d3/struct__HANDLE__TABLE.html#o6">NextIndexNeedingPool</a> &lt; OldHandleTable-&gt;NextIndexNeedingPool) {
00838 
00839             <span class="comment">//</span>
00840             <span class="comment">//  If we set the first free table entry to -1 then the worker</span>
00841             <span class="comment">//  routine will allocate another buffer</span>
00842             <span class="comment">//</span>
00843 
00844             NewHandleTable-&gt;<a class="code" href="../../d6/d3/struct__HANDLE__TABLE.html#o5">FirstFreeTableEntry</a> = -1;
00845 
00846             <span class="comment">//</span>
00847             <span class="comment">//  Call the worker routine to grow the new handle table.  If</span>
00848             <span class="comment">//  not successful then free the new table as far as we got,</span>
00849             <span class="comment">//  set out output variable and exit out here</span>
00850             <span class="comment">//</span>
00851 
00852             <span class="keywordflow">if</span> (<a class="code" href="../../d0/d8/ex_2handle_8c.html#a6">ExpAllocateHandleTableEntry</a>( NewHandleTable, &amp;Handle ) == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00853 
00854                 <a class="code" href="../../d0/d8/ex_2handle_8c.html#a5">ExpFreeHandleTable</a>( NewHandleTable );
00855 
00856                 NewHandleTable = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00857 
00858                 leave;
00859             }
00860         }
00861 
00862         <span class="comment">//</span>
00863         <span class="comment">//  Now modify the new handle table to think it has zero handles</span>
00864         <span class="comment">//  and set its free list to start on the same index as the old</span>
00865         <span class="comment">//  free list</span>
00866         <span class="comment">//</span>
00867 
00868         NewHandleTable-&gt;<a class="code" href="../../d6/d3/struct__HANDLE__TABLE.html#o1">HandleCount</a> = 0;
00869         NewHandleTable-&gt;<a class="code" href="../../d6/d3/struct__HANDLE__TABLE.html#o5">FirstFreeTableEntry</a> = OldHandleTable-&gt;FirstFreeTableEntry;
00870 
00871         <span class="comment">//</span>
00872         <span class="comment">//  Now for every valid index value we'll copy over the old entry into</span>
00873         <span class="comment">//  the new entry</span>
00874         <span class="comment">//</span>
00875 
00876         <span class="keywordflow">for</span> (<a class="code" href="../../d7/d0/cmdat2_8c.html#a19">Handle</a>.GenericHandleOverlay = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>; <span class="comment">// does essentially the following "Handle.Index = 0, Handle.TagBits = 0;"</span>
00877              (OldHandleTableEntry = <a class="code" href="../../d0/d8/ex_2handle_8c.html#a8">ExpLookupHandleTableEntry</a>( OldHandleTable, Handle )) != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00878              <a class="code" href="../../d7/d0/cmdat2_8c.html#a19">Handle</a>.Index += 1) {
00879 
00880             <span class="comment">//</span>
00881             <span class="comment">//  The conditinal in the loop gives up the old handle table</span>
00882             <span class="comment">//  entry, by definition there must exist a corresponding new</span>
00883             <span class="comment">//  handle table entry, so now look it up</span>
00884             <span class="comment">//</span>
00885 
00886             NewHandleTableEntry = <a class="code" href="../../d0/d8/ex_2handle_8c.html#a8">ExpLookupHandleTableEntry</a>( NewHandleTable,
00887                                                              Handle );
00888 
00889             <span class="comment">//</span>
00890             <span class="comment">//  If the old entry is free then simply copy over the entire</span>
00891             <span class="comment">//  old entry to the new entry.  The lock command will tell us</span>
00892             <span class="comment">//  it entry is free.</span>
00893             <span class="comment">//</span>
00894 
00895             <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d8/ex_8h.html#a287">ExLockHandleTableEntry</a>( OldHandleTable, OldHandleTableEntry )) {
00896 
00897                 *NewHandleTableEntry = *OldHandleTableEntry;
00898 
00899             } <span class="keywordflow">else</span> {
00900 
00901                 <span class="comment">//</span>
00902                 <span class="comment">//  Otherwise we have a non empty entry.  So now copy it</span>
00903                 <span class="comment">//  over, and unlock the old entry.  In both cases we bump</span>
00904                 <span class="comment">//  the handle count because either the entry is going into</span>
00905                 <span class="comment">//  the new table or we're going to remove it with Exp Free</span>
00906                 <span class="comment">//  Handle Table Entry which will decrement the handle count</span>
00907                 <span class="comment">//</span>
00908 
00909                 *NewHandleTableEntry = *OldHandleTableEntry;
00910                 NewHandleTable-&gt;<a class="code" href="../../d6/d3/struct__HANDLE__TABLE.html#o1">HandleCount</a> += 1;
00911 
00912                 <a class="code" href="../../d5/d8/ex_8h.html#a288">ExUnlockHandleTableEntry</a>( OldHandleTable, OldHandleTableEntry );
00913 
00914                 <span class="comment">//</span>
00915                 <span class="comment">//  Invoke the callback and if it returns true then we</span>
00916                 <span class="comment">//  unlock the new entry</span>
00917                 <span class="comment">//</span>
00918 
00919                 <span class="keywordflow">if</span> ((*DupHandleProcedure)( Process, NewHandleTableEntry )) {
00920 
00921                     <a class="code" href="../../d5/d8/ex_8h.html#a288">ExUnlockHandleTableEntry</a>( NewHandleTable, NewHandleTableEntry );
00922 
00923                 } <span class="keywordflow">else</span> {
00924 
00925                     <span class="comment">//</span>
00926                     <span class="comment">//  Otherwise this entry is going to be freed in the</span>
00927                     <span class="comment">//  new handle table.  So add it to the stack list of</span>
00928                     <span class="comment">//  additional freed entries</span>
00929                     <span class="comment">//</span>
00930 
00931                     NewHandleTableEntry-&gt;<a class="code" href="../../d7/d3/struct__HANDLE__TABLE__ENTRY.html#o0">Object</a> = AdditionalFreeEntries;
00932                     NewHandleTableEntry-&gt;<a class="code" href="../../d7/d3/struct__HANDLE__TABLE__ENTRY.html#o5">NextFreeTableEntry</a> = <a class="code" href="../../d7/d0/cmdat2_8c.html#a19">Handle</a>.Index;
00933 
00934                     AdditionalFreeEntries = NewHandleTableEntry;
00935                 }
00936             }
00937         }
00938 
00939     } finally {
00940 
00941         <a class="code" href="../../d5/d8/ex_8h.html#a285">ExUnlockHandleTableShared</a>( OldHandleTable );
00942         <a class="code" href="../../d4/d9/ke_8h.html#a29">KeLeaveCriticalRegion</a>();
00943     }
00944 
00945     <span class="comment">//</span>
00946     <span class="comment">//  At this point we are through with the old handle table,</span>
00947     <span class="comment">//  and if present the new handle table is done with except</span>
00948     <span class="comment">//  for adding back the newly freed entrires.  The only time</span>
00949     <span class="comment">//  the additionalFreeEntries variable will not be null is if</span>
00950     <span class="comment">//  we successfully built the new table and the dup routine</span>
00951     <span class="comment">//  came back false.</span>
00952     <span class="comment">//</span>
00953     <span class="comment">//  While there are additional entries to add to the free list</span>
00954     <span class="comment">//  pop the entry off the stack and add it to the table</span>
00955     <span class="comment">//</span>
00956 
00957     <a class="code" href="../../d7/d0/cmdat2_8c.html#a19">Handle</a>.GenericHandleOverlay = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00958     <span class="keywordflow">while</span> (AdditionalFreeEntries != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00959 
00960         PVOID Next;
00961 
00962         Next = AdditionalFreeEntries-&gt;<a class="code" href="../../d7/d3/struct__HANDLE__TABLE__ENTRY.html#o0">Object</a>;
00963         <a class="code" href="../../d7/d0/cmdat2_8c.html#a19">Handle</a>.Index = AdditionalFreeEntries-&gt;<a class="code" href="../../d7/d3/struct__HANDLE__TABLE__ENTRY.html#o5">NextFreeTableEntry</a>;
00964 
00965         AdditionalFreeEntries-&gt;<a class="code" href="../../d7/d3/struct__HANDLE__TABLE__ENTRY.html#o0">Object</a> = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00966 
00967         <a class="code" href="../../d0/d8/ex_2handle_8c.html#a7">ExpFreeHandleTableEntry</a>( NewHandleTable,
00968                                  Handle,
00969                                  AdditionalFreeEntries );
00970 
00971         AdditionalFreeEntries = Next;
00972     }
00973 
00974     <span class="comment">//</span>
00975     <span class="comment">//  lastly return the new handle table to our caller</span>
00976     <span class="comment">//</span>
00977 
00978     <span class="keywordflow">return</span> NewHandleTable;
00979 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a293" doxytag="ex.h::ExEnumHandleTable" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI BOOLEAN ExEnumHandleTable           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d6/d3/struct__HANDLE__TABLE.html">PHANDLE_TABLE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>HandleTable</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d5/d8/ex_8h.html#a140">EX_ENUMERATE_HANDLE_ROUTINE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>EnumHandleProcedure</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>EnumParameter</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT PHANDLE <a class="el" href="../../d5/d6/w98_2lh__open_2pi__basic_8h.html#a29">Handle</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>OPTIONAL</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l00634">634</a> of file <a class="el" href="../../d1/d7/ex_2handle_8c-source.html">ex/handle.c</a>.
<p>
References <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l00240">ExLockHandleTableEntry()</a>, <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l00114">ExLockHandleTableShared()</a>, <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l02195">ExpLookupHandleTableEntry()</a>, <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l00336">ExUnlockHandleTableEntry()</a>, <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l00178">ExUnlockHandleTableShared()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02630">_EXHANDLE::GenericHandleOverlay</a>, <a class="el" href="../../d8/d9/cmdat2_8c-source.html#l00091">Handle</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02627">_EXHANDLE::Index</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l01598">KeEnterCriticalRegion</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l01628">KeLeaveCriticalRegion</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02672">_HANDLE_TABLE_ENTRY::Object</a>, <a class="el" href="../../d1/d8/ntosdef_8h-source.html#l00462">PAGED_CODE</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d5/d9/tex_8c-source.html#l01160">DoHandleTest()</a>, <a class="el" href="../../d1/d0/obinit_8c-source.html#l01234">ObFindHandleForObject()</a>, and <a class="el" href="../../d1/d0/obinit_8c-source.html#l00815">ObInitProcess()</a>.
<p>
<pre class="fragment"><div>00643                    :
00644 
00645     This function enumerates all <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> valid handles in a handle table.
00646     For each valid handle in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> handle table, <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified eumeration
00647     function <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> called. If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> enumeration function returns <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>, then
00648     <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> enumeration <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> stopped, <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> current handle <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00649     caller via <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> optional <a class="code" href="../../d7/d0/cmdat2_8c.html#a19">Handle</a> parameter, and <span class="keyword">this</span> function returns
00650     <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> to indicated that <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> enumeration stopped at a specific handle.
00651 
00652 Arguments:
00653 
00654     HandleTable - Supplies a pointer to a handle table.
00655 
00656     EnumHandleProcedure - Supplies a pointer to a fucntion to call <span class="keywordflow">for</span>
00657         each valid handle in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> enumerated handle table.
00658 
00659     EnumParameter - Supplies an uninterpreted 32-bit value that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> passed
00660         to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> EnumHandleProcedure each time <a class="code" href="../../d1/d9/icmui_8def.html#a4">it</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> called.
00661 
00662     <a class="code" href="../../d7/d0/cmdat2_8c.html#a19">Handle</a> - Supplies an optional pointer a variable that receives <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00663         <a class="code" href="../../d7/d0/cmdat2_8c.html#a19">Handle</a> value that <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> enumeration stopped at. Contents of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00664         variable <a class="code" href="../../d3/d0/imm32_8def.html#a1">only</a> valid <span class="keywordflow">if</span> <span class="keyword">this</span> function returns <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>.
00665 
00666 Return Value:
00667 
00668     If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> enumeration stopped at a specific handle, then a value of <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>
00669     <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned. Otherwise, a value of <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned.
00670 
00671 --*/
00672 
00673 {
00674     BOOLEAN ResultValue;
00675     <a class="code" href="../../d7/d8/struct__EXHANDLE.html">EXHANDLE</a> LocalHandle;
00676     <a class="code" href="../../d7/d3/struct__HANDLE__TABLE__ENTRY.html">PHANDLE_TABLE_ENTRY</a> HandleTableEntry;
00677 
00678     <a class="code" href="../../d0/d9/ntosdef_8h.html#a28">PAGED_CODE</a>();
00679 
00680     <span class="comment">//</span>
00681     <span class="comment">//  First lock the handle table shared to stop anyone from creating or</span>
00682     <span class="comment">//  destroying new handles.  We need to do this because out iteration</span>
00683     <span class="comment">//  function doesn't want the handles to be closed while we're doing</span>
00684     <span class="comment">//  our work</span>
00685     <span class="comment">//</span>
00686 
00687     <a class="code" href="../../d4/d9/ke_8h.html#a28">KeEnterCriticalRegion</a>();
00688     <a class="code" href="../../d5/d8/ex_8h.html#a283">ExLockHandleTableShared</a>( HandleTable );
00689 
00690     <span class="keywordflow">try</span> {
00691 
00692         <span class="comment">//</span>
00693         <span class="comment">//  Our initial return value is false until the enumeration callback</span>
00694         <span class="comment">//  function tells us otherwise</span>
00695         <span class="comment">//</span>
00696 
00697         ResultValue = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00698 
00699         <span class="comment">//</span>
00700         <span class="comment">//  Iterate through the handle table and for each handle that is</span>
00701         <span class="comment">//  allocated we'll invoke the call back.  Note that this loop exits</span>
00702         <span class="comment">//  when we get a null handle table entry.  We know there will be no</span>
00703         <span class="comment">//  more possible entries after the first null one is encountered</span>
00704         <span class="comment">//  because we allocate memory of the handles in a dense fashion</span>
00705         <span class="comment">//</span>
00706 
00707         <span class="keywordflow">for</span> (LocalHandle.<a class="code" href="../../d7/d8/struct__EXHANDLE.html#o2">GenericHandleOverlay</a> = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>; <span class="comment">// does essentially the following "LocalHandle.Index = 0, LocalHandle.TagBits = 0;"</span>
00708              (HandleTableEntry = <a class="code" href="../../d0/d8/ex_2handle_8c.html#a8">ExpLookupHandleTableEntry</a>( HandleTable, LocalHandle )) != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00709              LocalHandle.<a class="code" href="../../d7/d8/struct__EXHANDLE.html#o1">Index</a> += 1) {
00710 
00711             <span class="comment">//</span>
00712             <span class="comment">//  Only do the callback if the entry is not free</span>
00713             <span class="comment">//</span>
00714 
00715             <span class="keywordflow">if</span> (HandleTableEntry-&gt;<a class="code" href="../../d7/d3/struct__HANDLE__TABLE__ENTRY.html#o0">Object</a> != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00716 
00717                 <span class="comment">//</span>
00718                 <span class="comment">//  Lock the handle table entry because we're about to give</span>
00719                 <span class="comment">//  it to the callback function, then release the entry</span>
00720                 <span class="comment">//  right after the call back.</span>
00721                 <span class="comment">//</span>
00722 
00723                 <span class="keywordflow">if</span> (<a class="code" href="../../d5/d8/ex_8h.html#a287">ExLockHandleTableEntry</a>( HandleTable, HandleTableEntry )) {
00724 
00725                     <span class="keywordflow">try</span> {
00726 
00727                         <span class="comment">//</span>
00728                         <span class="comment">//  Invoke the callback, and if it returns true then set</span>
00729                         <span class="comment">//  the proper output values and break out of the loop.</span>
00730                         <span class="comment">//</span>
00731 
00732                         <span class="keywordflow">if</span> ((*EnumHandleProcedure)( HandleTableEntry,
00733                                                     LocalHandle.<a class="code" href="../../d7/d8/struct__EXHANDLE.html#o2">GenericHandleOverlay</a>,
00734                                                     EnumParameter )) {
00735 
00736                             <span class="keywordflow">if</span> (ARGUMENT_PRESENT( Handle )) {
00737 
00738                                 *<a class="code" href="../../d7/d0/cmdat2_8c.html#a19">Handle</a> = LocalHandle.<a class="code" href="../../d7/d8/struct__EXHANDLE.html#o2">GenericHandleOverlay</a>;
00739                             }
00740 
00741                             ResultValue = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00742                             <span class="keywordflow">break</span>;
00743                         }
00744 
00745                     } finally {
00746 
00747                         <a class="code" href="../../d5/d8/ex_8h.html#a288">ExUnlockHandleTableEntry</a>( HandleTable, HandleTableEntry );
00748                     }
00749                 }
00750             }
00751         }
00752 
00753     } finally {
00754 
00755         <a class="code" href="../../d5/d8/ex_8h.html#a285">ExUnlockHandleTableShared</a>( HandleTable );
00756         <a class="code" href="../../d4/d9/ke_8h.html#a29">KeLeaveCriticalRegion</a>();
00757     }
00758 
00759     <span class="keywordflow">return</span> ResultValue;
00760 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a264" doxytag="ex.h::ExExtendZone" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI NTSTATUS ExExtendZone           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d0/d0/struct__ZONE__HEADER.html">PZONE_HEADER</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Zone</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>Segment</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>SegmentSize</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/zone_8c-source.html#l00138">138</a> of file <a class="el" href="../../d9/d0/zone_8c-source.html">zone.c</a>.
<p>
References <a class="el" href="../../d7/d5/memprint_8h-source.html#l00079">DbgPrint</a>.
<p>
Referenced by <a class="el" href="../../d7/d1/cachesub_8c-source.html#l05541">CcAllocateInitializeBcb()</a>, <a class="el" href="../../d5/d9/tex_8c-source.html#l01510">DoZoneTest()</a>, <a class="el" href="../../d9/d0/zone_8c-source.html#l00212">ExInterlockedExtendZone()</a>, and <a class="el" href="../../d4/d6/lpcqueue_8c-source.html#l00397">LpcpExtendPortZone()</a>.
<p>
<pre class="fragment"><div>00146                    :
00147 
00148     This function extends a zone by adding another segment's worth of
00149     blocks to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> zone.
00150 
00151 Arguments:
00152 
00153     Zone - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> address of a zone header to be extended.
00154 
00155     Segment - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> address of a segment of storage.  The first
00156               <a class="code" href="../../d1/d0/struct__ZONE__SEGMENT__HEADER.html">ZONE_SEGMENT_HEADER</a>-sized portion of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> segment <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> used by <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00157               zone allocator.  The remainder of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> segment <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> carved up
00158               into fixed-size (BlockSize) blocks and is added to the
00159               zone.  The address of the segment must be aligned on a 64-
00160               bit boundary.
00161 
00162     SegmentSize - Supplies the size in bytes of Segment.
00163 
00164 Return Value:
00165 
00166     STATUS_UNSUCCESSFUL - BlockSize or Segment was not aligned on
00167                           64-bit boundaries, or BlockSize was larger than
00168                           the segment size.
00169 
00170     STATUS_SUCCESS - The zone was successfully extended.
00171 
00172 --*/
00173 
00174 {
00175     ULONG i;
00176     PCH p;
00177 
00178     <span class="keywordflow">if</span> ( ((ULONG_PTR)Segment &amp; 7) ||
00179          (SegmentSize &amp; 7) ||
00180          (Zone-&gt;BlockSize &gt; SegmentSize) ) {
00181         <span class="keywordflow">return</span> STATUS_UNSUCCESSFUL;
00182     }
00183 
00184     ((<a class="code" href="../../d1/d0/struct__ZONE__SEGMENT__HEADER.html">PZONE_SEGMENT_HEADER</a>) Segment)-&gt;SegmentList.Next = Zone-&gt;SegmentList.Next;
00185     Zone-&gt;SegmentList.Next = &amp;((<a class="code" href="../../d1/d0/struct__ZONE__SEGMENT__HEADER.html">PZONE_SEGMENT_HEADER</a>) Segment)-&gt;SegmentList;
00186 
00187     p = (PCH)Segment + <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d0/struct__ZONE__SEGMENT__HEADER.html">ZONE_SEGMENT_HEADER</a>);
00188 
00189     <span class="keywordflow">for</span> (i = <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d0/struct__ZONE__SEGMENT__HEADER.html">ZONE_SEGMENT_HEADER</a>);
00190          i &lt;= SegmentSize - Zone-&gt;BlockSize;
00191          i += Zone-&gt;BlockSize
00192         ) {
00193 
00194         ((PSINGLE_LIST_ENTRY)p)-&gt;Next = Zone-&gt;FreeList.Next;
00195         Zone-&gt;FreeList.Next = (PSINGLE_LIST_ENTRY)p;
00196         p += Zone-&gt;BlockSize;
00197     }
00198     Zone-&gt;TotalSegmentSize += i;
00199 
00200 <span class="preprocessor">#if 0</span>
00201 <span class="preprocessor"></span>    <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>( <span class="stringliteral">"EX: ExExtendZone( %lx, %lx, %lu, %lu, %lx )\n"</span>,
00202               Zone, Segment, SegmentSize, Zone-&gt;BlockSize, p
00203             );
00204 <span class="preprocessor">#endif</span>
00205 <span class="preprocessor"></span>
00206     <span class="keywordflow">return</span> STATUS_SUCCESS;
00207 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a224" doxytag="ex.h::ExFreePool" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI VOID NTAPI ExFreePool           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PVOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>P</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d2/cmwraper_8c-source.html#l00304">304</a> of file <a class="el" href="../../d7/d2/cmwraper_8c-source.html">cmwraper.c</a>.
<p>
References <a class="el" href="../../d7/d6/halmips_8h-source.html#l00086">APC_LEVEL</a>, <a class="el" href="../../d6/d1/poolhack_8c-source.html#l00133">BasePoolTypeTable</a>, <a class="el" href="../../d7/d5/memprint_8h-source.html#l00079">DbgPrint</a>, <a class="el" href="../../d6/d1/poolhack_8c-source.html#l01177">DeallocatePoolInternal()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d1/d0/hivedata_8h-source.html#l00122">HBLOCK_SIZE</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l02007">KeAcquireSpinLock</a>, <a class="el" href="../../d0/d1/bugcheck_8c-source.html#l00070">KeBugCheck()</a>, <a class="el" href="../../d9/d5/verifier_8c.html#a117">KeLowerIrql()</a>, <a class="el" href="../../d9/d5/verifier_8c.html#a116">KeRaiseIrql()</a>, <a class="el" href="../../d2/d5/semphobj_8c-source.html#l00118">KeReleaseSemaphore()</a>, <a class="el" href="../../d9/d5/verifier_8c.html#a119">KeReleaseSpinLock()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00624">KernelMode</a>, <a class="el" href="../../d4/d4/ppc_2flush_8c-source.html#l00220">KeSweepDcache()</a>, <a class="el" href="../../d2/d6/wait_8c-source.html#l00810">KeWaitForSingleObject()</a>, <a class="el" href="../../d0/d0/ki_8h.html#a114">KiFlushSingleTb()</a>, <a class="el" href="../../d3/d9/aw_8h-source.html#l00031">L</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00367">Lock</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00492">LOCK_POOL</a>, <a class="el" href="../../d5/d1/pool_8h-source.html#l00125">_POOL_DESCRIPTOR::LockAddress</a>, <a class="el" href="../../d6/d1/poolhack_8c-source.html#l00105">_POOL_HEADER::LogAllocationSize</a>, <a class="el" href="../../d5/d8/ex_8h.html#a329a180">MaxPoolType</a>, <a class="el" href="../../d5/d7/mi_8h-source.html#l00769">MI_PFN_ELEMENT</a>, <a class="el" href="../../d5/d7/mi_8h-source.html#l02757">MiDecrementShareCountOnly</a>, <a class="el" href="../../d2/d5/allocpag_8c-source.html#l01778">MiFreePoolPages()</a>, <a class="el" href="../../d9/d7/alpha_2mialpha_8h-source.html#l01671">MiGetPteAddress</a>, <a class="el" href="../../d1/d8/sysptes_8c-source.html#l01354">MiReleaseSystemPtes()</a>, <a class="el" href="../../d9/d7/alpha_2mialpha_8h-source.html#l00107">MM_EMPTY_LIST</a>, <a class="el" href="../../d2/d5/allocpag_8c-source.html#l00437">MmDeterminePoolType()</a>, <a class="el" href="../../d8/d1/alpha_2initkr_8c-source.html#l00039">MmPfnLock</a>, <a class="el" href="../../d4/d6/freevm_8c-source.html#l00066">NtFreeVirtualMemory()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d5/d9/ob_8h-source.html#l00494">ObDereferenceObject</a>, <a class="el" href="../../d6/d1/poolhack_8c-source.html#l00071">PAGE_ALIGNED</a>, <a class="el" href="../../d6/d1/poolhack_8c-source.html#l00116">POOL_OVERHEAD</a>, <a class="el" href="../../d5/d8/ex_8h.html#a96">POOL_TYPE</a>, <a class="el" href="../../d4/d9/ke_8h.html#a407a201">PoolAllocation</a>, <a class="el" href="../../d6/d1/poolhack_8c-source.html#l00106">_POOL_HEADER::PoolType</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00451">PoolVector</a>, <a class="el" href="../../d6/d1/poolhack_8c-source.html#l00102">PPOOL_DESCRIPTOR</a>, <a class="el" href="../../d6/d1/poolhack_8c-source.html#l00114">PPOOL_HEADER</a>, <a class="el" href="../../d6/d1/poolhack_8c-source.html#l00112">_POOL_HEADER::ProcessBilled</a>, <a class="el" href="../../d2/d8/ps_8h-source.html#l00645">PsGetCurrentThread</a>, <a class="el" href="../../d1/d1/psquota_8c-source.html#l00356">PsReturnPoolQuota()</a>, <a class="el" href="../../d5/d7/mi_8h-source.html#l01281">_MMPFN::PteAddress</a>, <a class="el" href="../../d4/d8/mi_8h.html#a1003a769">SystemPteSpace</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d2/d4/struct__MMPTE.html#o8">_MMPTE::u</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00551">UNLOCK_POOL</a>, <a class="el" href="../../d2/d7/hal_8h.html#a212">VOID()</a>, and <a class="el" href="../../d5/d1/datalpha_8c-source.html#l00030">ZeroPte</a>.
<p>
Referenced by <a class="el" href="../../d9/d7/arbiter_8c-source.html#l03028">ArbAddOrdering()</a>, <a class="el" href="../../d9/d7/arbiter_8c-source.html#l01622">ArbBuildAssignmentOrdering()</a>, <a class="el" href="../../d9/d7/arbiter_8c-source.html#l00469">ArbDeleteArbiterInstance()</a>, <a class="el" href="../../d9/d7/arbiter_8c-source.html#l03350">ArbFreeOrderingList()</a>, <a class="el" href="../../d9/d7/arbiter_8c-source.html#l00192">ArbInitializeArbiterInstance()</a>, <a class="el" href="../../d9/d7/arbiter_8c-source.html#l00786">ArbpBuildAllocationStack()</a>, <a class="el" href="../../d9/d7/arbiter_8c-source.html#l02824">ArbpGetRegistryValue()</a>, <a class="el" href="../../d9/d7/arbiter_8c-source.html#l03120">ArbPruneOrdering()</a>, <a class="el" href="../../d9/d7/arbiter_8c-source.html#l03695">ArbQueryConflict()</a>, <a class="el" href="../../d1/d7/dir_8c-source.html#l00057">BuildQueryDirectoryIrp()</a>, <a class="el" href="../../d7/d1/cachesub_8c-source.html#l05694">CcDeallocateBcb()</a>, <a class="el" href="../../d6/d7/fssup_8c-source.html#l02626">CcDeleteMbcb()</a>, <a class="el" href="../../d6/d7/fssup_8c-source.html#l01517">CcDeleteSharedCacheMap()</a>, <a class="el" href="../../d6/d2/vacbsup_8c-source.html#l02044">CcDrainVacbLevelZone()</a>, <a class="el" href="../../d6/d2/vacbsup_8c-source.html#l01377">CcExtendVacbArray()</a>, <a class="el" href="../../d6/d7/fssup_8c-source.html#l00387">CcInitializeCacheMap()</a>, <a class="el" href="../../d6/d6/copysup_8c-source.html#l02099">CcPostDeferredWrites()</a>, <a class="el" href="../../d6/d7/fssup_8c-source.html#l01164">CcUninitializeCacheMap()</a>, <a class="el" href="../../d3/d8/pinsup_8c-source.html#l01000">CcUnpinData()</a>, <a class="el" href="../../d3/d8/pinsup_8c-source.html#l01142">CcUnpinDataForThread()</a>, <a class="el" href="../../d7/d1/cachesub_8c-source.html#l03880">CcWriteBehind()</a>, <a class="el" href="../../d6/d7/fssup_8c-source.html#l02952">CcZeroData()</a>, <a class="el" href="../../d7/d1/hwprofil_8c-source.html#l02394">CmDeleteKeyRecursive()</a>, <a class="el" href="../../d2/d2/cmsysini_8c-source.html#l00293">CmInitSystem1()</a>, <a class="el" href="../../d7/d0/cmhvlist_8c-source.html#l00042">CmpAddToHiveFileList()</a>, <a class="el" href="../../d8/d6/ntapi_8c-source.html#l03883">CmpAllocatePostBlock()</a>, <a class="el" href="../../d9/d9/geninst_8c-source.html#l01392">CmpAppendStringToMultiSz()</a>, <a class="el" href="../../d9/d1/cmsubs_8c-source.html#l00568">CmpCleanUpKcbValueCache()</a>, <a class="el" href="../../d2/d2/cmsysini_8c-source.html#l03262">CmpCloneControlSet()</a>, <a class="el" href="../../d7/d1/hwprofil_8c-source.html#l01869">CmpCloneHwProfile()</a>, <a class="el" href="../../d6/d2/parseini_8c-source.html#l01832">CmpCloseInfFile()</a>, <a class="el" href="../../d3/d2/cmtrecpy_8c-source.html#l00127">CmpCopySyncTree()</a>, <a class="el" href="../../d3/d2/cmtrecpy_8c-source.html#l00251">CmpCopySyncTree2()</a>, <a class="el" href="../../d2/d2/cmsysini_8c-source.html#l01165">CmpCreateRegistryRoot()</a>, <a class="el" href="../../d1/d1/cmnotify_8c-source.html#l01900">CmpDelayedDerefKeys()</a>, <a class="el" href="../../d7/d1/cmsavres_8c-source.html#l01490">CmpDestroyTemporaryHive()</a>, <a class="el" href="../../d6/d2/cmworker_8c-source.html#l00518">CmpDiskFullWarningWorker()</a>, <a class="el" href="../../d0/d3/rules_8c-source.html#l02173">CmpFindACPITable()</a>, <a class="el" href="../../d0/d3/rules_8c-source.html#l02430">CmpFindRSDTTable()</a>, <a class="el" href="../../d1/d1/cmnotify_8c-source.html#l01235">CmpFlushNotify()</a>, <a class="el" href="../../d8/d2/cmwrapr_8c-source.html#l00186">CmpFree()</a>, <a class="el" href="../../d6/d2/parseini_8c-source.html#l01495">CmpFreeLineList()</a>, <a class="el" href="../../d8/d6/ntapi_8c-source.html#l03764">CmpFreePostBlock()</a>, <a class="el" href="../../d6/d2/parseini_8c-source.html#l01558">CmpFreeSectionList()</a>, <a class="el" href="../../d6/d2/parseini_8c-source.html#l01439">CmpFreeValueList()</a>, <a class="el" href="../../d7/d1/hwprofil_8c-source.html#l00076">CmpGetAcpiProfileInformation()</a>, <a class="el" href="../../d0/d3/rules_8c-source.html#l02635">CmpGetRegistryValue()</a>, <a class="el" href="../../d3/d1/cmparse_8c-source.html#l01476">CmpGetSymbolicLink()</a>, <a class="el" href="../../d0/d2/cmsubs2_8c-source.html#l00403">CmpGetValueDataFromCache()</a>, <a class="el" href="../../d8/d1/cmse_8c-source.html#l01227">CmpHiveRootSecurityDescriptor()</a>, <a class="el" href="../../d5/d9/cmconfig_8c-source.html#l00087">CmpInitializeHardwareConfiguration()</a>, <a class="el" href="../../d9/d0/cminit_8c-source.html#l00471">CmpInitializeHive()</a>, <a class="el" href="../../d2/d2/cmsysini_8c-source.html#l00726">CmpInitializeHiveList()</a>, <a class="el" href="../../d0/d1/config_2i386_2init386_8c-source.html#l00465">CmpInitializeMachineDependentConfiguration()</a>, <a class="el" href="../../d5/d9/cmconfig_8c-source.html#l00458">CmpInitializeRegistryNode()</a>, <a class="el" href="../../d2/d2/cmsysini_8c-source.html#l02022">CmpInitializeSystemHive()</a>, <a class="el" href="../../d7/d1/cmsavres_8c-source.html#l00484">CmpLoadHiveVolatile()</a>, <a class="el" href="../../d3/d2/cmtrecpy_8c-source.html#l01150">CmpMergeKeyValues()</a>, <a class="el" href="../../d8/d6/ntapi_8c-source.html#l03603">CmpNameFromAttributes()</a>, <a class="el" href="../../d1/d1/cmnotify_8c-source.html#l01378">CmpNotifyChangeKey()</a>, <a class="el" href="../../d9/d0/cminit_8c-source.html#l00046">CmpOpenHiveFiles()</a>, <a class="el" href="../../d9/d9/geninst_8c-source.html#l01264">CmpOpenRegKey()</a>, <a class="el" href="../../d6/d2/parseini_8c-source.html#l00744">CmpParseInfBuffer()</a>, <a class="el" href="../../d1/d1/cmnotify_8c-source.html#l00487">CmpPostNotify()</a>, <a class="el" href="../../d9/d9/geninst_8c-source.html#l00776">CmpProcessBitRegLine()</a>, <a class="el" href="../../d6/d0/cmgquota_8c-source.html#l00166">CmpQuotaWarningWorker()</a>, <a class="el" href="../../d7/d0/cmhvlist_8c-source.html#l00188">CmpRemoveFromHiveFileList()</a>, <a class="el" href="../../d2/d2/cmsysini_8c-source.html#l03458">CmpSaveBootControlSet()</a>, <a class="el" href="../../d7/d1/cmsavres_8c-source.html#l01261">CmpSaveKeyByFileCopy()</a>, <a class="el" href="../../d8/d1/cmse_8c-source.html#l00397">CmpSetSecurityDescriptorInfo()</a>, <a class="el" href="../../d9/d8/cmapi_8c-source.html#l01383">CmpSetValueKeyExisting()</a>, <a class="el" href="../../d2/d2/cmsysini_8c-source.html#l01545">CmpSetVersionData()</a>, <a class="el" href="../../d2/d2/cmsysini_8c-source.html#l04077">CmpValidateAlternate()</a>, <a class="el" href="../../d6/d2/cmworker_8c-source.html#l00115">CmpWorker()</a>, <a class="el" href="../../d9/d8/cmapi_8c-source.html#l02293">CmReplaceKey()</a>, <a class="el" href="../../d7/d1/hwprofil_8c-source.html#l00805">CmSetAcpiHwProfile()</a>, <a class="el" href="../../d9/d8/cmapi_8c-source.html#l02079">CmUnloadKey()</a>, <a class="el" href="../../d3/d4/mapper_8c-source.html#l01955">ComPortDBAdd()</a>, <a class="el" href="../../d8/d2/dbgkproc_8c-source.html#l00211">DbgkCreateThread()</a>, <a class="el" href="../../d8/d2/dbgkproc_8c-source.html#l00136">DbgkpSectionHandleToFileHandle()</a>, <a class="el" href="../../d5/d9/tex_8c-source.html#l01468">DoPoolTest()</a>, <a class="el" href="../../d7/d7/fsvga_8c-source.html#l00053">DriverEntry()</a>, <a class="el" href="../../d6/d9/pnpeisa_8c-source.html#l00059">EisaBuildEisaDeviceNode()</a>, <a class="el" href="../../d6/d9/pnpeisa_8c-source.html#l00201">EisaGetEisaDevicesResources()</a>, <a class="el" href="../../d5/d4/logger_8c-source.html#l00062">ExCreateDebugLogTag()</a>, <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l02005">ExDeleteResourceLite()</a>, <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l02995">ExLockUserBuffer()</a>, <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l01475">ExpAllocateHandleTable()</a>, <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l01825">ExpAllocateHandleTableEntry()</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l02502">ExpAllocatePoolWithQuotaHandler()</a>, <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l02683">ExpFindCurrentThread()</a>, <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l01667">ExpFreeHandleTable()</a>, <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l04104">ExpGetPoolTagInfo()</a>, <a class="el" href="../../d0/d6/ex_2profile_8c-source.html#l00145">ExpProfileDelete()</a>, <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l04328">ExpQueryLegacyDriverInformation()</a>, <a class="el" href="../../d7/d7/ex_2harderr_8c-source.html#l00064">ExpSystemErrorHandler()</a>, <a class="el" href="../../d3/d3/ex_2callback_8c-source.html#l00378">ExRegisterCallback()</a>, <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l03048">ExUnlockUserBuffer()</a>, <a class="el" href="../../d3/d3/ex_2callback_8c-source.html#l00479">ExUnregisterCallback()</a>, <a class="el" href="../../d6/d0/fat__rec_8c-source.html#l00043">FatRecFsControl()</a>, <a class="el" href="../../d1/d6/dev2dos_8c-source.html#l00454">FindPathForDevice()</a>, <a class="el" href="../../d3/d1/drawscrn_8c-source.html#l00489">FsgWriteToFrameBuffer()</a>, <a class="el" href="../../d7/d6/fs__rec_8c-source.html#l00539">FsRecUnload()</a>, <a class="el" href="../../d2/d0/largemcb_8c-source.html#l02852">FsRtlAddLargeEntry()</a>, <a class="el" href="../../d6/d1/oplock_8c-source.html#l01221">FsRtlAllocateOplock()</a>, <a class="el" href="../../d3/d6/notify_8c-source.html#l02555">FsRtlCancelNotify()</a>, <a class="el" href="../../d6/d8/unc_8c-source.html#l00418">FsRtlDeregisterUncProvider()</a>, <a class="el" href="../../d2/d6/tunnel_8c-source.html#l00255">FsRtlFreeTunnelNode()</a>, <a class="el" href="../../d5/d7/fsrtlpc_8c-source.html#l00323">FsRtlGetCompatibilityModeValue()</a>, <a class="el" href="../../d2/d6/tunnel_8c-source.html#l01371">FsRtlGetTunnelParameterValue()</a>, <a class="el" href="../../d2/d2/dbcsname_8c-source.html#l00771">FsRtlIsDbcsInExpression()</a>, <a class="el" href="../../d5/d4/name_8c-source.html#l00482">FsRtlIsNameInExpressionPrivate()</a>, <a class="el" href="../../d3/d6/notify_8c-source.html#l01795">FsRtlNotifyCleanup()</a>, <a class="el" href="../../d3/d6/notify_8c-source.html#l02000">FsRtlNotifyCompleteIrp()</a>, <a class="el" href="../../d3/d6/notify_8c-source.html#l00547">FsRtlNotifyFullChangeDirectory()</a>, <a class="el" href="../../d3/d6/notify_8c-source.html#l00973">FsRtlNotifyFullReportChange()</a>, <a class="el" href="../../d3/d6/notify_8c-source.html#l00426">FsRtlNotifyUninitializeSync()</a>, <a class="el" href="../../d6/d8/unc_8c-source.html#l00104">FsRtlpRegisterProviderWithMUP()</a>, <a class="el" href="../../d6/d8/unc_8c-source.html#l00247">FsRtlRegisterUncProvider()</a>, <a class="el" href="../../d6/d1/oplock_8c-source.html#l03623">FsRtlRemoveAndCompleteWaitIrp()</a>, <a class="el" href="../../d5/d4/stackovf_8c-source.html#l00294">FsRtlStackOverflowRead()</a>, <a class="el" href="../../d2/d0/largemcb_8c-source.html#l00743">FsRtlTruncateLargeMcb()</a>, <a class="el" href="../../d2/d0/largemcb_8c-source.html#l00670">FsRtlUninitializeLargeMcb()</a>, <a class="el" href="../../d6/d1/oplock_8c-source.html#l00413">FsRtlUninitializeOplock()</a>, <a class="el" href="../../d7/d7/fsvga_8c-source.html#l00858">FsVgaServiceParameters()</a>, <a class="el" href="../../d7/d7/fsvga_8c-source.html#l01429">FsVgaWriteToFrameBuffer()</a>, <a class="el" href="../../d1/d6/dev2dos_8c-source.html#l00326">GetNextReparseVolumePath()</a>, <a class="el" href="../../d8/d1/drivesup_8c-source.html#l03735">HalpGetFullGeometry()</a>, <a class="el" href="../../d8/d1/drivesup_8c-source.html#l00851">HalpNextMountLetter()</a>, <a class="el" href="../../d8/d1/drivesup_8c-source.html#l01078">HalpSetMountLetter()</a>, <a class="el" href="../../d1/d1/hivesync_8c-source.html#l01885">HvpDiscardBins()</a>, <a class="el" href="../../d1/d1/hivesync_8c-source.html#l00775">HvpDoWriteHive()</a>, <a class="el" href="../../d7/d0/hiveload_8c-source.html#l00311">HvpReadFileImageAndBuildMap()</a>, <a class="el" href="../../d7/d0/hiveload_8c-source.html#l00847">HvpRecoverData()</a>, <a class="el" href="../../d1/d1/hivesync_8c-source.html#l01025">HvpWriteLog()</a>, <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l01322">InitCreateUserCrit()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l00328">IoAllocateDriverObjectExtension()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l01552">IoBuildDeviceIoControlRequest()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l03665">IoConnectInterrupt()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l04073">IoCreateDevice()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l04502">IoCreateFile()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l05951">IoDeleteDevice()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l06364">IoDisconnectInterrupt()</a>, <a class="el" href="../../d8/d4/ioerr_8c-source.html#l00414">IoepFreeErrStack()</a>, <a class="el" href="../../d8/d4/ioerr_8c-source.html#l01200">IoepGetErrCaseDB()</a>, <a class="el" href="../../d8/d4/ioerr_8c-source.html#l00039">IoepInitErrLog()</a>, <a class="el" href="../../d8/d4/ioerr_8c-source.html#l00255">IoepLogErr()</a>, <a class="el" href="../../d5/d4/ioeapi_8c-source.html#l00647">IoErrFreeSavedData()</a>, <a class="el" href="../../d5/d4/ioeapi_8c-source.html#l00452">IoErrGetErrData()</a>, <a class="el" href="../../d5/d4/ioeapi_8c-source.html#l00238">IoErrPropagateErrLog()</a>, <a class="el" href="../../d5/d4/ioeapi_8c-source.html#l00305">IoErrTerminateErrLog()</a>, <a class="el" href="../../d3/d2/dumpctl_8c-source.html#l01300">IoFreeDumpStack()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l06744">IoFreeMdl()</a>, <a class="el" href="../../d5/d0/pnppower_8c-source.html#l00352">IoFreePoDeviceNotifyList()</a>, <a class="el" href="../../d2/d9/io_2misc_8c-source.html#l00924">IoFreeWorkItem()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l11641">IoGetBootDiskInformation()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l04946">IoGetDeviceInterfaceAlias()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l00373">IoGetDeviceProperty()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l09712">IoGetLegacyVetoList()</a>, <a class="el" href="../../d0/d5/ioinit_8c-source.html#l00270">IoInitSystem()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l07705">IoIsValidNameGraftingBuffer()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l00810">IoOpenDeviceRegistryKey()</a>, <a class="el" href="../../d6/d0/pnpres_8c-source.html#l00720">IopAllocateResources()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l00383">IopApcHardError()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l09357">IopAppendLegacyVeto()</a>, <a class="el" href="../../d0/d1/pnpsubs_8c-source.html#l00546">IopAppendStringToValueKey()</a>, <a class="el" href="../../d0/d1/pnpsubs_8c-source.html#l02209">IopApplyFunctionToServiceInstances()</a>, <a class="el" href="../../d0/d1/pnpsubs_8c-source.html#l01844">IopApplyFunctionToSubKeys()</a>, <a class="el" href="../../d6/d8/arcsec_8c-source.html#l00168">IopApplySystemPartitionProt()</a>, <a class="el" href="../../d6/d0/pnpres_8c-source.html#l05016">IopArbitrateDeviceResources()</a>, <a class="el" href="../../d6/d0/pnpres_8c-source.html#l02034">IopBuildCmResourceList()</a>, <a class="el" href="../../d7/d9/pnpenum_8c-source.html#l02525">IopCallDriverAddDevice()</a>, <a class="el" href="../../d7/d9/pnpenum_8c-source.html#l03165">IopCallDriverAddDeviceQueryRoutine()</a>, <a class="el" href="../../d7/d9/pnpenum_8c-source.html#l04759">IopChangeDeviceObjectFromRegistryProperties()</a>, <a class="el" href="../../d0/d5/ioinit_8c-source.html#l00978">IopCheckDependencies()</a>, <a class="el" href="../../d6/d0/pnpres_8c-source.html#l03933">IopChildToRootTranslation()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l01019">IopCompleteRequest()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l00657">IopCompleteUnloadOrDelete()</a>, <a class="el" href="../../d7/d0/pnprlist_8c-source.html#l00286">IopCompressRelationList()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l09157">IopCopyBootLogRegistryToFile()</a>, <a class="el" href="../../d0/d5/ioinit_8c-source.html#l01047">IopCreateArcNames()</a>, <a class="el" href="../../d6/d0/pnpres_8c-source.html#l06801">IopCreateCmResourceList()</a>, <a class="el" href="../../d0/d1/pnpsubs_8c-source.html#l00091">IopCreateMadeupNode()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l01771">IopDeallocateApc()</a>, <a class="el" href="../../d4/d9/pnpdel_8c-source.html#l00187">IopDelayedRemoveWorker()</a>, <a class="el" href="../../d4/d0/objsup_8c-source.html#l00769">IopDeleteDevice()</a>, <a class="el" href="../../d4/d0/objsup_8c-source.html#l00698">IopDeleteDriver()</a>, <a class="el" href="../../d4/d0/objsup_8c-source.html#l00417">IopDeleteFile()</a>, <a class="el" href="../../d0/d1/pnpsubs_8c-source.html#l05453">IopDeleteLegacyKey()</a>, <a class="el" href="../../d4/d9/pnpdel_8c-source.html#l00232">IopDeleteLockedDeviceNode()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l06037">IopDeleteSessionSymLinks()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l06600">IopDereferenceNotify()</a>, <a class="el" href="../../d5/d2/parse_8c-source.html#l00180">IopDereferenceVpbAndFree()</a>, <a class="el" href="../../d5/d6/devnode_8c-source.html#l00297">IopDestroyDeviceNode()</a>, <a class="el" href="../../d7/d9/pnpenum_8c-source.html#l00307">IopDeviceActionWorker()</a>, <a class="el" href="../../d0/d1/pnpsubs_8c-source.html#l03759">IopDeviceObjectFromDeviceInstance()</a>, <a class="el" href="../../d1/d0/pnpirp_8c-source.html#l01496">IopDeviceRelationsComplete()</a>, <a class="el" href="../../d1/d0/pnpirp_8c-source.html#l01370">IopDeviceStartComplete()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l09866">IopDoDeferredSetInterfaceState()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l08130">IopDoNameTransmogrify()</a>, <a class="el" href="../../d0/d1/pnpsubs_8c-source.html#l02779">IopDriverLoadingFailed()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l01821">IopDropIrp()</a>, <a class="el" href="../../d6/d0/pnpres_8c-source.html#l06528">IopDuplicateDetection()</a>, <a class="el" href="../../d7/d9/pnpenum_8c-source.html#l01163">IopEnumerateDevice()</a>, <a class="el" href="../../d8/d6/errorlog_8c-source.html#l00660">IopErrorLogDpc()</a>, <a class="el" href="../../d8/d6/errorlog_8c-source.html#l00088">IopErrorLogThread()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l01934">IopExceptionCleanup()</a>, <a class="el" href="../../d0/d0/dockhwp_8c-source.html#l01028">IopExecuteHardwareProfileChange()</a>, <a class="el" href="../../d0/d1/pnpsubs_8c-source.html#l04592">IopFilterResourceRequirementsList()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l05668">IopFreeAllocatedUnicodeString()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l02536">IopFreeBuffer()</a>, <a class="el" href="../../d3/d2/dumpctl_8c-source.html#l04252">IopFreeDCB()</a>, <a class="el" href="../../d0/d5/ioinit_8c-source.html#l02223">IopFreeGroupTree()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l06641">IopFreeIrp()</a>, <a class="el" href="../../d6/d3/complete_8c-source.html#l00797">IopFreeMiniPacket()</a>, <a class="el" href="../../d5/d0/pnppower_8c-source.html#l00321">IopFreePoDeviceNotifyListHead()</a>, <a class="el" href="../../d7/d0/pnprlist_8c-source.html#l00709">IopFreeRelationList()</a>, <a class="el" href="../../d6/d0/pnpres_8c-source.html#l01922">IopFreeReqAlternative()</a>, <a class="el" href="../../d6/d0/pnpres_8c-source.html#l01948">IopFreeReqList()</a>, <a class="el" href="../../d6/d0/pnpres_8c-source.html#l01988">IopFreeResourceRequirementsForAssignTable()</a>, <a class="el" href="../../d0/d1/pnpsubs_8c-source.html#l02740">IopFreeUnicodeStringList()</a>, <a class="el" href="../../d7/d9/pnpenum_8c-source.html#l04425">IopGetBusTypeGuidIndex()</a>, <a class="el" href="../../d0/d1/pnpsubs_8c-source.html#l01477">IopGetDeviceInstanceCsConfigFlags()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l02707">IopGetDeviceInterfaces()</a>, <a class="el" href="../../d0/d1/pnpsubs_8c-source.html#l04081">IopGetDeviceResourcesFromRegistry()</a>, <a class="el" href="../../d3/d9/pnpdd_8c-source.html#l01411">IopGetDriverDeviceList()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l02072">IopGetDriverNameFromKeyNode()</a>, <a class="el" href="../../d0/d5/ioinit_8c-source.html#l04120">IopGetDriverTagPriority()</a>, <a class="el" href="../../d3/d2/dumpctl_8c-source.html#l00384">IopGetDumpStack()</a>, <a class="el" href="../../d0/d1/pnpsubs_8c-source.html#l05334">IopGetGroupOrderIndex()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l09565">IopGetLegacyVetoListDrivers()</a>, <a class="el" href="../../d7/d9/pnpenum_8c-source.html#l04610">IopGetRegistryDwordWithFallback()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l02462">IopGetRegistryKeyInformation()</a>, <a class="el" href="../../d7/d9/pnpenum_8c-source.html#l04679">IopGetRegistrySecurityWithFallback()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l02546">IopGetRegistryValue()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l08036">IopGetRelatedTargetDevice()</a>, <a class="el" href="../../d6/d0/pnpres_8c-source.html#l01066">IopGetResourceRequirementsForAssignTable()</a>, <a class="el" href="../../d8/d9/pnpinit_8c-source.html#l00680">IopGetRootDevices()</a>, <a class="el" href="../../d0/d1/pnpsubs_8c-source.html#l01591">IopGetServiceInstanceCsConfigFlags()</a>, <a class="el" href="../../d8/d9/pnpinit_8c-source.html#l01454">IopGetServiceType()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l02977">IopHardErrorThread()</a>, <a class="el" href="../../d0/d0/dockhwp_8c-source.html#l00465">IopHardwareProfileCommitRemovedDock()</a>, <a class="el" href="../../d0/d0/dockhwp_8c-source.html#l00160">IopHardwareProfileMarkDock()</a>, <a class="el" href="../../d0/d5/ioinit_8c-source.html#l02327">IopInitializeBootDrivers()</a>, <a class="el" href="../../d3/d2/dumpctl_8c-source.html#l04580">IopInitializeDCB()</a>, <a class="el" href="../../d8/d9/pnpinit_8c-source.html#l00879">IopInitializeDeviceInstanceKey()</a>, <a class="el" href="../../d8/d9/pnpinit_8c-source.html#l00093">IopInitializePlugPlayServices()</a>, <a class="el" href="../../d2/d7/report_8c-source.html#l00066">IopInitializeResourceMap()</a>, <a class="el" href="../../d0/d5/ioinit_8c-source.html#l03146">IopInitializeSystemDrivers()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l06387">IopInvalidateDeviceStateWorker()</a>, <a class="el" href="../../d0/d1/pnpsubs_8c-source.html#l03181">IopIsAnyDeviceInstanceEnabled()</a>, <a class="el" href="../../d0/d1/pnpsubs_8c-source.html#l03443">IopIsDeviceInstanceEnabled()</a>, <a class="el" href="../../d8/d9/pnpinit_8c-source.html#l01572">IopIsFirmwareMapperDevicePresent()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l02286">IopIsReportedAlready()</a>, <a class="el" href="../../d6/d0/pnpres_8c-source.html#l06180">IopLegacyResourceAllocation()</a>, <a class="el" href="../../d0/d5/ioinit_8c-source.html#l04654">IopLoadBootFilterDriver()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l03200">IopLoadDriver()</a>, <a class="el" href="../../d3/d2/dumpctl_8c-source.html#l00954">IopLoadDumpDriver()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l04169">IopLoadUnloadDriver()</a>, <a class="el" href="../../d1/d0/pnpirp_8c-source.html#l01891">IopMakeGloballyUniqueId()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l09221">IoPnPDeliverServicePowerNotification()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l08501">IopOpenDeviceParametersSubkey()</a>, <a class="el" href="../../d5/d2/parse_8c-source.html#l00202">IopParseDevice()</a>, <a class="el" href="../../d0/d1/pnpsubs_8c-source.html#l00753">IopPrepareDriverLoading()</a>, <a class="el" href="../../d3/d9/pnpdd_8c-source.html#l01185">IopProcessAssignResources()</a>, <a class="el" href="../../d4/d9/pnpdel_8c-source.html#l01417">IopProcessCompletedEject()</a>, <a class="el" href="../../d7/d9/pnpenum_8c-source.html#l04000">IopProcessCriticalDeviceRoutine()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l05954">IopProcessDeferredRegistrations()</a>, <a class="el" href="../../d7/d9/pnpenum_8c-source.html#l01538">IopProcessNewDeviceNode()</a>, <a class="el" href="../../d7/d9/pnpenum_8c-source.html#l05109">IopProcessNewProfileWorker()</a>, <a class="el" href="../../d4/d9/pnpdel_8c-source.html#l00917">IopProcessRelation()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l09922">IopProcessSetInterfaceState()</a>, <a class="el" href="../../d6/d0/pnpres_8c-source.html#l08336">IopQueryConflictListInternal()</a>, <a class="el" href="../../d1/d0/pnpirp_8c-source.html#l02262">IopQueryDeviceResources()</a>, <a class="el" href="../../d1/d0/pnpirp_8c-source.html#l03395">IopQueryDockRemovalInterface()</a>, <a class="el" href="../../d1/d0/pnpirp_8c-source.html#l02793">IopQueryLegacyBusInformation()</a>, <a class="el" href="../../d5/d2/parse_8c-source.html#l01811">IopQueryName()</a>, <a class="el" href="../../d1/d0/pnpirp_8c-source.html#l02885">IopQueryPnpBusInformation()</a>, <a class="el" href="../../d6/d0/pnpres_8c-source.html#l04589">IopQueryRebalance()</a>, <a class="el" href="../../d1/d0/pnpirp_8c-source.html#l02617">IopQueryResourceHandlerInterface()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l05617">IopRaiseHardError()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l05841">IopRaiseInformationalHardError()</a>, <a class="el" href="../../d0/d1/pnpsubs_8c-source.html#l04283">IopReadDeviceConfiguration()</a>, <a class="el" href="../../d3/d2/dumpctl_8c-source.html#l04379">IopReadDumpRegistry()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l03491">IopRealloc()</a>, <a class="el" href="../../d6/d0/pnpres_8c-source.html#l07470">IopReallocateResources()</a>, <a class="el" href="../../d6/d0/pnpres_8c-source.html#l05215">IopRebalance()</a>, <a class="el" href="../../d6/d0/pnpres_8c-source.html#l02474">IopReleaseFilteredBootResources()</a>, <a class="el" href="../../d6/d0/pnpres_8c-source.html#l07383">IopReleaseResources()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l04414">IopRemoveDeviceInterfaces()</a>, <a class="el" href="../../d7/d0/pnprlist_8c-source.html#l01013">IopRemoveIndirectRelationsFromList()</a>, <a class="el" href="../../d7/d0/pnprlist_8c-source.html#l01090">IopRemoveRelationFromList()</a>, <a class="el" href="../../d0/d1/pnpsubs_8c-source.html#l00449">IopRemoveStringFromValueKey()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l06242">IopReportTargetDeviceChangeAsyncWorker()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l01520">IopRequestDeviceEjectWorker()</a>, <a class="el" href="../../d6/d0/pnpres_8c-source.html#l07291">IopReserveBootResources()</a>, <a class="el" href="../../d6/d0/pnpres_8c-source.html#l07198">IopReserveBootResourcesInternal()</a>, <a class="el" href="../../d6/d0/pnpres_8c-source.html#l06996">IopReserveLegacyBootResources()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l02467">IopResizeBuffer()</a>, <a class="el" href="../../d0/d1/pnpsubs_8c-source.html#l05777">IopRestartDeviceNode()</a>, <a class="el" href="../../d6/d0/pnpres_8c-source.html#l05660">IopRestoreResourcesInternal()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l08822">IopSafebootDriverLoad()</a>, <a class="el" href="../../d0/d1/pnpsubs_8c-source.html#l00931">IopServiceInstanceToDeviceInstance()</a>, <a class="el" href="../../d5/d5/netboot_8c-source.html#l04017">IopSetDefaultGateway()</a>, <a class="el" href="../../d4/d0/objsup_8c-source.html#l00877">IopSetDeviceSecurityDescriptors()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l06326">IopSetEaOrQuotaInformationFile()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l08959">IopSetSecurityObjectFromRegistry()</a>, <a class="el" href="../../d7/d9/pnpenum_8c-source.html#l00994">IopStartAndEnumerateDevice()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l06870">IopStartApcHardError()</a>, <a class="el" href="../../d3/d9/pnpdd_8c-source.html#l01740">IopStartDriverDevices()</a>, <a class="el" href="../../d5/d5/netboot_8c-source.html#l00770">IopStartNetworkForRemoteBoot()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l06926">IopSynchronousApiServiceTail()</a>, <a class="el" href="../../d5/d5/netboot_8c-source.html#l04458">IopTCPSetInformationEx()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l07272">IopTrackLink()</a>, <a class="el" href="../../d6/d0/pnpres_8c-source.html#l04129">IopTranslateAndAdjustReqDesc()</a>, <a class="el" href="../../d1/d0/pnpirp_8c-source.html#l00191">IopUncacheInterfaceInformation()</a>, <a class="el" href="../../d4/d9/pnpdel_8c-source.html#l01755">IopUnloadAttachedDriver()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l04140">IopUnregisterDeviceInterface()</a>, <a class="el" href="../../d0/d0/dockhwp_8c-source.html#l00862">IopUpdateHardwareProfile()</a>, <a class="el" href="../../d3/d2/io_2query_8c-source.html#l00070">IoQueryDeviceDescription()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l08909">IoRaiseInformationalHardError()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l07495">IoRegisterPlugPlayNotification()</a>, <a class="el" href="../../d8/d6/io_2remlock_8c-source.html#l00394">IoReleaseRemoveLockAndWaitEx()</a>, <a class="el" href="../../d8/d6/io_2remlock_8c-source.html#l00244">IoReleaseRemoveLockEx()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l01548">IoReportDetectedDevice()</a>, <a class="el" href="../../d2/d7/report_8c-source.html#l00469">IoReportResourceUsageInternal()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l10359">IoShutdownSystem()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l11178">IoUnregisterFsRegistrationChange()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l05829">IoUnregisterPlugPlayNotification()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l11239">IoUnregisterShutdownNotification()</a>, <a class="el" href="../../d9/d3/trackirp_8c-source.html#l02499">IovpInternalCompleteAfterWait()</a>, <a class="el" href="../../d9/d3/trackirp_8c-source.html#l02555">IovpInternalDeferredCompletion()</a>, <a class="el" href="../../d9/d7/hashirp_8c-source.html#l00744">IovpProtectedIrpMakeUntouchable()</a>, <a class="el" href="../../d6/d6/sessnirp_8c-source.html#l00152">IovpSessionDataDereference()</a>, <a class="el" href="../../d8/d3/flunkirp_8c-source.html#l01392">IovpThrowChaffAtStartedPdoStack()</a>, <a class="el" href="../../d9/d7/hashirp_8c-source.html#l00232">IovpTrackingDataFree()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l11556">IoWriteErrorLogEntry()</a>, <a class="el" href="../../d5/d7/udfs__rec_8c-source.html#l00157">IsUdfsVolume()</a>, <a class="el" href="../../d4/d0/biosc_8c-source.html#l00060">Ke386CallBios()</a>, <a class="el" href="../../d3/d9/ke_2i386_2misc_8c-source.html#l00366">KeRestoreFloatingPointState()</a>, <a class="el" href="../../d6/d0/i386_2thredini_8c-source.html#l00454">KeSetAutoAlignmentThread()</a>, <a class="el" href="../../d5/d5/alpha_2allproc_8c-source.html#l00078">KeStartAllProcessors()</a>, <a class="el" href="../../d1/d7/profobj_8c-source.html#l00289">KeStartProfile()</a>, <a class="el" href="../../d1/d7/profobj_8c-source.html#l00520">KeStopProfile()</a>, <a class="el" href="../../d9/d3/mtrr_8c-source.html#l00992">KiAddRange()</a>, <a class="el" href="../../d9/d3/mtrr_8c-source.html#l01112">KiCompleteEffectiveRangeChange()</a>, <a class="el" href="../../d9/d3/mtrr_8c-source.html#l00275">KiInitializeMTRR()</a>, <a class="el" href="../../d9/d6/lfs_2strucsup_8c-source.html#l00402">LfsDeallocateLbcb()</a>, <a class="el" href="../../d9/d6/lfs_2strucsup_8c-source.html#l00518">LfsDeallocateLcb()</a>, <a class="el" href="../../d9/d6/lfs_2strucsup_8c-source.html#l00188">LfsDeallocateLfcb()</a>, <a class="el" href="../../d1/d6/lfs_2registry_8c-source.html#l01063">LfsDeleteLogHandle()</a>, <a class="el" href="../../d8/d9/rstrtsup_8c-source.html#l00036">LfsWriteLfsRestart()</a>, <a class="el" href="../../d4/d6/lpcqueue_8c-source.html#l00104">LpcpDestroyPortQueue()</a>, <a class="el" href="../../d4/d6/lpcqueue_8c-source.html#l00397">LpcpExtendPortZone()</a>, <a class="el" href="../../d4/d6/lpcqueue_8c-source.html#l00287">LpcpInitializePortZone()</a>, <a class="el" href="../../d3/d4/mapper_8c-source.html#l01803">MapperAdjustResourceList()</a>, <a class="el" href="../../d3/d4/mapper_8c-source.html#l00658">MapperCallback()</a>, <a class="el" href="../../d3/d4/mapper_8c-source.html#l01600">MapperConstructRootEnumTree()</a>, <a class="el" href="../../d3/d4/mapper_8c-source.html#l01549">MapperFreeList()</a>, <a class="el" href="../../d3/d4/mapper_8c-source.html#l01091">MapperMarkKey()</a>, <a class="el" href="../../d3/d4/mapper_8c-source.html#l00535">MapperPeripheralCallback()</a>, <a class="el" href="../../d3/d4/mapper_8c-source.html#l02060">MapperPhantomizeDetectedComPorts()</a>, <a class="el" href="../../d3/d4/mapper_8c-source.html#l01298">MapperSeedKey()</a>, <a class="el" href="../../d6/d5/iosup_8c-source.html#l04107">MiAllocateContiguousMemory()</a>, <a class="el" href="../../d9/d7/sysload_8c-source.html#l03326">MiBuildImportsForBootDrivers()</a>, <a class="el" href="../../d9/d4/physical_8c-source.html#l02313">MiCleanPhysicalProcessPages()</a>, <a class="el" href="../../d9/d7/sysload_8c-source.html#l02693">MiClearImports()</a>, <a class="el" href="../../d9/d5/forksup_8c-source.html#l00100">MiCloneProcessAddressSpace()</a>, <a class="el" href="../../d1/d7/creasect_8c-source.html#l03553">MiCreateDataFileMap()</a>, <a class="el" href="../../d1/d7/creasect_8c-source.html#l01424">MiCreateImageFileMap()</a>, <a class="el" href="../../d1/d7/creasect_8c-source.html#l04018">MiCreatePagingFileMap()</a>, <a class="el" href="../../d5/d4/procsup_8c-source.html#l04202">MiCreatePebOrTeb()</a>, <a class="el" href="../../d9/d5/forksup_8c-source.html#l01745">MiDecrementCloneBlockReference()</a>, <a class="el" href="../../d9/d7/sysload_8c-source.html#l03822">MiDereferenceImports()</a>, <a class="el" href="../../d6/d4/sectsup_8c-source.html#l00603">MiDereferenceSegmentThread()</a>, <a class="el" href="../../d0/d5/readwrt_8c-source.html#l00758">MiDoPoolCopy()</a>, <a class="el" href="../../d2/d5/allocpag_8c-source.html#l04569">MiFindContiguousMemory()</a>, <a class="el" href="../../d6/d4/sectsup_8c-source.html#l02487">MiFlushEventCounter()</a>, <a class="el" href="../../d9/d1/pagfault_8c-source.html#l04301">MiFlushInPageSupportBlock()</a>, <a class="el" href="../../d6/d5/iosup_8c-source.html#l01041">MiFreeMdlTracker()</a>, <a class="el" href="../../d2/d5/allocpag_8c-source.html#l04478">MiFreeSessionPoolBitMaps()</a>, <a class="el" href="../../d4/d4/mapview_8c-source.html#l04071">MiFreeSessionSpaceMap()</a>, <a class="el" href="../../d9/d1/pagfault_8c-source.html#l04152">MiGetInPageSupportBlock()</a>, <a class="el" href="../../d6/d2/queryvm_8c-source.html#l00890">MiGetWorkingSetInfo()</a>, <a class="el" href="../../d9/d7/sysload_8c-source.html#l06591">MiInitializeLoadedModuleList()</a>, <a class="el" href="../../d4/d4/mapview_8c-source.html#l03757">MiInsertInSystemSpace()</a>, <a class="el" href="../../d9/d7/sysload_8c-source.html#l00443">MiLoadSystemImage()</a>, <a class="el" href="../../d6/d5/iosup_8c-source.html#l02785">MiMapLockedPagesInUserSpace()</a>, <a class="el" href="../../d4/d4/mapview_8c-source.html#l02256">MiMapViewOfDataSection()</a>, <a class="el" href="../../d4/d4/mapview_8c-source.html#l01567">MiMapViewOfImageSection()</a>, <a class="el" href="../../d4/d4/mapview_8c-source.html#l01028">MiMapViewOfPhysicalSection()</a>, <a class="el" href="../../d6/d5/iosup_8c-source.html#l02641">MiPhysicalViewRemover()</a>, <a class="el" href="../../d6/d5/iosup_8c-source.html#l01859">MiReleaseDeadPteTrackers()</a>, <a class="el" href="../../d5/d8/umapview_8c-source.html#l00265">MiRemoveMappedView()</a>, <a class="el" href="../../d7/d2/vadtree_8c-source.html#l00256">MiRemoveVad()</a>, <a class="el" href="../../d9/d7/sysload_8c-source.html#l03953">MiResolveImageReferences()</a>, <a class="el" href="../../d6/d4/sectsup_8c-source.html#l00768">MiSectionInitialization()</a>, <a class="el" href="../../d6/d4/sectsup_8c-source.html#l00191">MiSegmentDelete()</a>, <a class="el" href="../../d5/d6/sessload_8c-source.html#l00461">MiSessionRemoveImage()</a>, <a class="el" href="../../d5/d6/sessload_8c-source.html#l00802">MiSessionWideDereferenceImage()</a>, <a class="el" href="../../d5/d6/sessload_8c-source.html#l00683">MiSessionWideInsertImageAddress()</a>, <a class="el" href="../../d9/d7/sysload_8c-source.html#l04464">MiSnapThunk()</a>, <a class="el" href="../../d6/d5/iosup_8c-source.html#l03253">MiUnmapLockedPagesInUserSpace()</a>, <a class="el" href="../../d0/d5/verifier_8c-source.html#l03982">MiVerifierCheckThunks()</a>, <a class="el" href="../../d0/d5/verifier_8c-source.html#l03625">MiVerifyingDriverUnloading()</a>, <a class="el" href="../../d0/d3/dynmem_8c-source.html#l00043">MmAddPhysicalMemory()</a>, <a class="el" href="../../d0/d5/verifier_8c-source.html#l03846">MmAddVerifierThunks()</a>, <a class="el" href="../../d6/d5/iosup_8c-source.html#l04270">MmAllocatePagesForMdl()</a>, <a class="el" href="../../d9/d7/sysload_8c-source.html#l06717">MmCallDllInitialize()</a>, <a class="el" href="../../d5/d4/procsup_8c-source.html#l01695">MmCleanProcessAddressSpace()</a>, <a class="el" href="../../d1/d7/creasect_8c-source.html#l00390">MmCreateSection()</a>, <a class="el" href="../../d5/d4/procsup_8c-source.html#l04843">MmDeleteTeb()</a>, <a class="el" href="../../d9/d9/extsect_8c-source.html#l00201">MmExtendSection()</a>, <a class="el" href="../../d6/d5/iosup_8c-source.html#l05372">MmFreeContiguousMemory()</a>, <a class="el" href="../../d6/d5/iosup_8c-source.html#l05414">MmFreeContiguousMemorySpecifyCache()</a>, <a class="el" href="../../d6/d4/sectsup_8c-source.html#l01721">MmGetFileNameForSection()</a>, <a class="el" href="../../d5/d4/procsup_8c-source.html#l00911">MmInitializeProcessAddressSpace()</a>, <a class="el" href="../../d6/d5/iosup_8c-source.html#l02058">MmMapLockedPagesSpecifyCache()</a>, <a class="el" href="../../d6/d5/iosup_8c-source.html#l07516">MmMapVideoDisplay()</a>, <a class="el" href="../../d0/d3/dynmem_8c-source.html#l00437">MmRemovePhysicalMemory()</a>, <a class="el" href="../../d4/d4/mapview_8c-source.html#l04177">MmSecureVirtualMemory()</a>, <a class="el" href="../../d9/d7/sysload_8c-source.html#l02896">MmUnloadSystemImage()</a>, <a class="el" href="../../d6/d5/iosup_8c-source.html#l07751">MmUnmapVideoDisplay()</a>, <a class="el" href="../../d5/d8/umapview_8c-source.html#l00090">MmUnmapViewOfSection()</a>, <a class="el" href="../../d4/d4/mapview_8c-source.html#l04614">MmUnsecureVirtualMemory()</a>, <a class="el" href="../../d7/d7/exatom_8c-source.html#l00045">NtAddAtom()</a>, <a class="el" href="../../d9/d4/physical_8c-source.html#l00970">NtAllocateUserPhysicalPages()</a>, <a class="el" href="../../d4/d5/allocvm_8c-source.html#l00075">NtAllocateVirtualMemory()</a>, <a class="el" href="../../d4/d4/seaudit_8c-source.html#l02492">NtCloseObjectAuditAlarm()</a>, <a class="el" href="../../d7/d2/modwrite_8c-source.html#l00297">NtCreatePagingFile()</a>, <a class="el" href="../../d4/d4/seaudit_8c-source.html#l02627">NtDeleteObjectAuditAlarm()</a>, <a class="el" href="../../d7/d7/exatom_8c-source.html#l00152">NtFindAtom()</a>, <a class="el" href="../../d2/d9/io_2misc_8c-source.html#l00386">NtFlushBuffersFile()</a>, <a class="el" href="../../d9/d4/physical_8c-source.html#l01624">NtFreeUserPhysicalPages()</a>, <a class="el" href="../../d4/d6/freevm_8c-source.html#l00066">NtFreeVirtualMemory()</a>, <a class="el" href="../../d3/d7/ntfs__rec_8c-source.html#l00042">NtfsRecFsControl()</a>, <a class="el" href="../../d9/d3/loadunld_8c-source.html#l00035">NtLoadDriver()</a>, <a class="el" href="../../d8/d6/ntapi_8c-source.html#l02881">NtLoadKey2()</a>, <a class="el" href="../../d9/d4/physical_8c-source.html#l00085">NtMapUserPhysicalPages()</a>, <a class="el" href="../../d9/d4/physical_8c-source.html#l00498">NtMapUserPhysicalPagesScatter()</a>, <a class="el" href="../../d4/d4/seaudit_8c-source.html#l02072">NtOpenObjectAuditAlarm()</a>, <a class="el" href="../../d8/d2/tokenopn_8c-source.html#l00458">NtOpenThreadToken()</a>, <a class="el" href="../../d4/d4/seaudit_8c-source.html#l00731">NtPrivilegedServiceAuditAlarm()</a>, <a class="el" href="../../d4/d4/seaudit_8c-source.html#l00406">NtPrivilegeObjectAuditAlarm()</a>, <a class="el" href="../../d9/d9/obdir_8c-source.html#l00229">NtQueryDirectoryObject()</a>, <a class="el" href="../../d8/d1/qsea_8c-source.html#l00035">NtQueryEaFile()</a>, <a class="el" href="../../d0/d2/qsinfo_8c-source.html#l00101">NtQueryInformationFile()</a>, <a class="el" href="../../d1/d2/qsquota_8c-source.html#l00035">NtQueryQuotaInformationFile()</a>, <a class="el" href="../../d6/d7/sysenv_8c-source.html#l00045">NtQuerySystemEnvironmentValue()</a>, <a class="el" href="../../d9/d1/qsfs_8c-source.html#l00037">NtQueryVolumeInformationFile()</a>, <a class="el" href="../../d3/d9/psctx_8c-source.html#l00056">NtQueueApcThread()</a>, <a class="el" href="../../d7/d7/ex_2harderr_8c-source.html#l00532">NtRaiseHardError()</a>, <a class="el" href="../../d7/d4/io_2read_8c-source.html#l00730">NtReadFileScatter()</a>, <a class="el" href="../../d8/d6/ntapi_8c-source.html#l03336">NtReplaceKey()</a>, <a class="el" href="../../d6/d5/lpcconn_8c-source.html#l00084">NtSecureConnectPort()</a>, <a class="el" href="../../d8/d1/qsea_8c-source.html#l00652">NtSetEaFile()</a>, <a class="el" href="../../d0/d2/qsinfo_8c-source.html#l00849">NtSetInformationFile()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l01323">NtSetInformationJobObject()</a>, <a class="el" href="../../d0/d1/psquery_8c-source.html#l01510">NtSetInformationProcess()</a>, <a class="el" href="../../d4/d0/i386_2psldt_8c-source.html#l01235">NtSetLdtEntries()</a>, <a class="el" href="../../d6/d7/sysenv_8c-source.html#l00305">NtSetSystemEnvironmentValue()</a>, <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l02264">NtSetSystemInformation()</a>, <a class="el" href="../../d8/d6/ntapi_8c-source.html#l02672">NtSetValueKey()</a>, <a class="el" href="../../d9/d1/qsfs_8c-source.html#l00492">NtSetVolumeInformationFile()</a>, <a class="el" href="../../d0/d6/ex_2profile_8c-source.html#l00517">NtStartProfile()</a>, <a class="el" href="../../d0/d6/ex_2profile_8c-source.html#l00680">NtStopProfile()</a>, <a class="el" href="../../d9/d3/loadunld_8c-source.html#l00244">NtUnloadDriver()</a>, <a class="el" href="../../d2/d4/lock_8c-source.html#l00458">NtUnlockFile()</a>, <a class="el" href="../../d2/d1/obwait_8c-source.html#l00406">NtWaitForMultipleObjects()</a>, <a class="el" href="../../d1/d9/io_2write_8c-source.html#l00801">NtWriteFileGather()</a>, <a class="el" href="../../d1/d1/obtype_8c-source.html#l00069">ObCreateObjectType()</a>, <a class="el" href="../../d8/d9/obdevmap_8c-source.html#l00416">ObDereferenceDeviceMap()</a>, <a class="el" href="../../d0/d1/obse_8c-source.html#l01258">ObGetObjectSecurity()</a>, <a class="el" href="../../d7/d9/obcreate_8c-source.html#l00438">ObpCaptureObjectName()</a>, <a class="el" href="../../d9/d9/obdir_8c-source.html#l01009">ObpDeleteDirectoryEntry()</a>, <a class="el" href="../../d8/d0/obref_8c-source.html#l01497">ObpDeleteNameCheck()</a>, <a class="el" href="../../d5/d0/oblink_8c-source.html#l00904">ObpDeleteSymbolicLink()</a>, <a class="el" href="../../d9/d0/obsdata_8c-source.html#l00759">ObpDestroySecurityDescriptorHeader()</a>, <a class="el" href="../../d1/d0/obinit_8c-source.html#l01805">ObpFreeDosDevicesProtection()</a>, <a class="el" href="../../d7/d9/obcreate_8c-source.html#l01098">ObpFreeObject()</a>, <a class="el" href="../../d7/d9/obcreate_8c-source.html#l00663">ObpFreeObjectNameBuffer()</a>, <a class="el" href="../../d9/d0/obsdata_8c-source.html#l00118">ObpInitSecurityDescriptorCache()</a>, <a class="el" href="../../d0/d0/obhandle_8c-source.html#l00908">ObpInsertHandleCount()</a>, <a class="el" href="../../d9/d0/obsdata_8c-source.html#l00297">ObpLogSecurityDescriptor()</a>, <a class="el" href="../../d9/d9/obdir_8c-source.html#l01081">ObpLookupObjectName()</a>, <a class="el" href="../../d5/d0/oblink_8c-source.html#l00501">ObpParseSymbolicLink()</a>, <a class="el" href="../../d5/d0/oblink_8c-source.html#l01121">ObpProcessDosDeviceSymbolicLink()</a>, <a class="el" href="../../d8/d0/obref_8c-source.html#l01370">ObpRemoveObjectRoutine()</a>, <a class="el" href="../../d0/d1/obse_8c-source.html#l01418">ObReleaseObjectSecurity()</a>, <a class="el" href="../../d0/d1/obse_8c-source.html#l01748">ObSetSecurityDescriptorInfo()</a>, <a class="el" href="../../d1/d6/dev2dos_8c-source.html#l00225">OpenDeviceReparseIndex()</a>, <a class="el" href="../../d3/d2/io_2query_8c-source.html#l00223">pIoQueryBusDescription()</a>, <a class="el" href="../../d3/d2/io_2query_8c-source.html#l00565">pIoQueryDeviceDescription()</a>, <a class="el" href="../../d3/d0/pnpmap_8c-source.html#l02089">PnPBiosCopyDeviceParamKey()</a>, <a class="el" href="../../d3/d0/pnpmap_8c-source.html#l02663">PnPBiosCopyIoDecode()</a>, <a class="el" href="../../d3/d0/pnpmap_8c-source.html#l01725">PnPBiosEliminateDupes()</a>, <a class="el" href="../../d3/d0/pnpmap_8c-source.html#l02956">PnPBiosFreeDevNodeInfo()</a>, <a class="el" href="../../d3/d0/pnpmap_8c-source.html#l00399">PnPBiosGetBiosInfo()</a>, <a class="el" href="../../d3/d0/pnpmap_8c-source.html#l03008">PnPBiosMapper()</a>, <a class="el" href="../../d3/d0/pnpmap_8c-source.html#l01126">PnPBiosTranslateInfo()</a>, <a class="el" href="../../d3/d0/pnpmap_8c-source.html#l02289">PnPBiosWriteInfo()</a>, <a class="el" href="../../d3/d0/pnpmap_8c-source.html#l00788">PnPCheckFixedIoOverrideDecodes()</a>, <a class="el" href="../../d9/d9/psdelete_8c-source.html#l00603">PsExitSpecialApc()</a>, <a class="el" href="../../d4/d1/i386_2psvdm_8c-source.html#l00730">Psp386CreateVdmIoListHead()</a>, <a class="el" href="../../d4/d1/i386_2psvdm_8c-source.html#l00477">Psp386InstallIoHandler()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l02210">PspApplyJobLimitsToProcessSet()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l02680">PspCaptureTokenFilter()</a>, <a class="el" href="../../d4/d0/i386_2psldt_8c-source.html#l01202">PspDeleteLdt()</a>, <a class="el" href="../../d7/d4/ps_2security_8c-source.html#l01436">PspDeleteThreadSecurity()</a>, <a class="el" href="../../d4/d1/i386_2psvdm_8c-source.html#l00203">PspDeleteVdmObjects()</a>, <a class="el" href="../../d1/d1/psquota_8c-source.html#l00494">PspDereferenceQuota()</a>, <a class="el" href="../../d9/d9/psdelete_8c-source.html#l00631">PspExitNormalApc()</a>, <a class="el" href="../../d9/d9/psdelete_8c-source.html#l00690">PspExitThread()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l00636">PspJobDelete()</a>, <a class="el" href="../../d9/d9/psdelete_8c-source.html#l00580">PspNullSpecialApc()</a>, <a class="el" href="../../d9/d9/psdelete_8c-source.html#l01363">PspProcessDelete()</a>, <a class="el" href="../../d3/d9/psctx_8c-source.html#l00040">PspQueueApcSpecialApc()</a>, <a class="el" href="../../d4/d0/i386_2psldt_8c-source.html#l00503">PspSetLdtInformation()</a>, <a class="el" href="../../d4/d0/i386_2psldt_8c-source.html#l00308">PspSetLdtSize()</a>, <a class="el" href="../../d0/d1/psquery_8c-source.html#l01211">PspSetQuotaLimits()</a>, <a class="el" href="../../d9/d9/psdelete_8c-source.html#l00160">PspTerminateThreadByPointer()</a>, <a class="el" href="../../d3/d7/ps_2create_8c-source.html#l01800">PspUserThreadStartup()</a>, <a class="el" href="../../d1/d1/psquota_8c-source.html#l00174">PsReturnSharedPoolQuota()</a>, <a class="el" href="../../d1/d6/dev2dos_8c-source.html#l00149">QueryDeviceNameForPath()</a>, <a class="el" href="../../d1/d6/dev2dos_8c-source.html#l00094">QuerySymbolicLink()</a>, <a class="el" href="../../d5/d6/rtl_2regutil_8c-source.html#l00679">RtlpAllocDeallocQueryBuffer()</a>, <a class="el" href="../../d9/d5/sertl_8c-source.html#l06266">RtlpComputeMergedAcl()</a>, <a class="el" href="../../d9/d5/sertl_8c-source.html#l07461">RtlpConvertAclToAutoInherit()</a>, <a class="el" href="../../d9/d5/sertl_8c-source.html#l06520">RtlpConvertToAutoInheritSecurityObject()</a>, <a class="el" href="../../d1/d9/rtl_2atom_8c-source.html#l00042">RtlpFreeAtom()</a>, <a class="el" href="../../d9/d5/sertl_8c-source.html#l05153">RtlpInheritAcl()</a>, <a class="el" href="../../d9/d5/sertl_8c-source.html#l09057">RtlpNewSecurityObject()</a>, <a class="el" href="../../d9/d5/sertl_8c-source.html#l10195">RtlpSetSecurityObject()</a>, <a class="el" href="../../d9/d6/rtl_2remlock_8c-source.html#l00204">RtlReleaseRemoveLock()</a>, <a class="el" href="../../d9/d6/rtl_2remlock_8c-source.html#l00328">RtlReleaseRemoveLockAndWait()</a>, <a class="el" href="../../d1/d6/dev2dos_8c-source.html#l00580">RtlVolumeDeviceToDosName()</a>, <a class="el" href="../../d1/d3/accessck_8c-source.html#l02704">SeAccessCheckByType()</a>, <a class="el" href="../../d3/d4/seastate_8c-source.html#l00434">SeAppendPrivileges()</a>, <a class="el" href="../../d3/d4/se_2capture_8c-source.html#l01370">SeCaptureAcl()</a>, <a class="el" href="../../d3/d4/se_2capture_8c-source.html#l01608">SeCaptureLuidAndAttributesArray()</a>, <a class="el" href="../../d1/d3/accessck_8c-source.html#l00144">SeCaptureObjectTypeList()</a>, <a class="el" href="../../d3/d4/se_2capture_8c-source.html#l00053">SeCaptureSecurityDescriptor()</a>, <a class="el" href="../../d3/d4/se_2capture_8c-source.html#l00953">SeCaptureSecurityQos()</a>, <a class="el" href="../../d3/d4/se_2capture_8c-source.html#l01141">SeCaptureSid()</a>, <a class="el" href="../../d3/d4/se_2capture_8c-source.html#l01850">SeCaptureSidAndAttributesArray()</a>, <a class="el" href="../../d4/d4/seaudit_8c-source.html#l03538">SeCreateObjectAuditAlarm()</a>, <a class="el" href="../../d2/d4/seassign_8c-source.html#l00373">SeDeassignSecurity()</a>, <a class="el" href="../../d3/d4/seastate_8c-source.html#l00348">SeDeleteAccessState()</a>, <a class="el" href="../../d1/d3/accessck_8c-source.html#l00353">SeFreeCapturedObjectTypeList()</a>, <a class="el" href="../../d3/d4/se_2capture_8c-source.html#l00910">SeFreeCapturedSecurityQos()</a>, <a class="el" href="../../d1/d3/accessck_8c-source.html#l03294">SeFreePrivileges()</a>, <a class="el" href="../../d5/d2/token_8c-source.html#l01010">SeMakeAnonymousLogonToken()</a>, <a class="el" href="../../d5/d2/token_8c-source.html#l00536">SeMakeSystemToken()</a>, <a class="el" href="../../d4/d4/seaudit_8c-source.html#l02765">SeOpenObjectAuditAlarm()</a>, <a class="el" href="../../d4/d4/seaudit_8c-source.html#l03085">SeOpenObjectForDeleteAuditAlarm()</a>, <a class="el" href="../../d4/d4/seaudit_8c-source.html#l01050">SepAccessCheckAndAuditAlarm()</a>, <a class="el" href="../../d0/d4/adtinit_8c-source.html#l00117">SepAdtInitializeBounds()</a>, <a class="el" href="../../d1/d4/adtlog_8c-source.html#l00052">SepAdtLogAuditRecord()</a>, <a class="el" href="../../d8/d5/sepaudit_8c-source.html#l01907">SepAdtObjectReferenceAuditAlarm()</a>, <a class="el" href="../../d8/d5/sepaudit_8c-source.html#l00571">SepAdtOpenObjectAuditAlarm()</a>, <a class="el" href="../../d3/d4/se_2capture_8c-source.html#l00681">SepCopyProxyData()</a>, <a class="el" href="../../d0/d9/rmlogon_8c-source.html#l00541">SepCreateLogonSessionTrack()</a>, <a class="el" href="../../d0/d9/rmlogon_8c-source.html#l00655">SepDeleteLogonSessionTrack()</a>, <a class="el" href="../../d1/d4/adtlog_8c-source.html#l00738">SepDequeueWorkItem()</a>, <a class="el" href="../../d0/d9/rmlogon_8c-source.html#l00384">SepDeReferenceLogonSession()</a>, <a class="el" href="../../d7/d2/tokendup_8c-source.html#l00362">SepDuplicateToken()</a>, <a class="el" href="../../d7/d2/tokendup_8c-source.html#l01939">SepFilterToken()</a>, <a class="el" href="../../d4/d4/seaudit_8c-source.html#l00370">SepFreeCapturedString()</a>, <a class="el" href="../../d3/d4/se_2capture_8c-source.html#l00737">SepFreeProxyData()</a>, <a class="el" href="../../d0/d9/rmlogon_8c-source.html#l00777">SepInformLsaOfDeletedLogon()</a>, <a class="el" href="../../d0/d5/seinit_8c-source.html#l00184">SepInitializationPhase1()</a>, <a class="el" href="../../d0/d9/rmlogon_8c-source.html#l01107">SepNotifyFileSystems()</a>, <a class="el" href="../../d3/d4/se_2capture_8c-source.html#l00773">SepProbeAndCaptureQosData()</a>, <a class="el" href="../../d4/d4/seaudit_8c-source.html#l00259">SepProbeAndCaptureString_U()</a>, <a class="el" href="../../d8/d5/sepaudit_8c-source.html#l02324">SepQueryNameString()</a>, <a class="el" href="../../d1/d9/rmmain_8c-source.html#l00907">SepRmCallLsa()</a>, <a class="el" href="../../d5/d2/token_8c-source.html#l02156">SepTokenDeleteMethod()</a>, <a class="el" href="../../d3/d4/se_2capture_8c-source.html#l01560">SeReleaseAcl()</a>, <a class="el" href="../../d3/d4/se_2capture_8c-source.html#l01797">SeReleaseLuidAndAttributesArray()</a>, <a class="el" href="../../d3/d4/se_2capture_8c-source.html#l00631">SeReleaseSecurityDescriptor()</a>, <a class="el" href="../../d3/d4/se_2capture_8c-source.html#l01320">SeReleaseSid()</a>, <a class="el" href="../../d3/d4/se_2capture_8c-source.html#l02297">SeReleaseSidAndAttributesArray()</a>, <a class="el" href="../../d1/d9/rmmain_8c-source.html#l00060">SeRmInitPhase1()</a>, <a class="el" href="../../d0/d9/rmlogon_8c-source.html#l00908">SeUnregisterLogonSessionTerminatedRoutine()</a>, <a class="el" href="../../d5/d8/smbtrsup_8c-source.html#l01456">SmbTraceCompleteRdr()</a>, <a class="el" href="../../d5/d8/smbtrsup_8c-source.html#l01242">SmbTraceCompleteSrv()</a>, <a class="el" href="../../d5/d8/smbtrsup_8c-source.html#l01760">SmbTraceDeferredDereferenceHeap()</a>, <a class="el" href="../../d5/d8/smbtrsup_8c-source.html#l01949">SmbTraceEmptyQueue()</a>, <a class="el" href="../../d5/d8/smbtrsup_8c-source.html#l00438">SmbTraceInitialize()</a>, <a class="el" href="../../d5/d8/smbtrsup_8c-source.html#l00509">SmbTraceTerminate()</a>, <a class="el" href="../../d5/d8/smbtrsup_8c-source.html#l02020">SmbTraceThreadEntry()</a>, <a class="el" href="../../d2/d5/tse_8c-source.html#l00296">TestCaptureSecurityDescriptor()</a>, <a class="el" href="../../d2/d5/tse_8c-source.html#l00205">TestDefaultObjectMethod()</a>, <a class="el" href="../../d2/d5/tse_8c-source.html#l00105">TestMakeSystemToken()</a>, <a class="el" href="../../d2/d5/tse_8c-source.html#l00131">TestTokenCopy()</a>, <a class="el" href="../../d2/d5/tse_8c-source.html#l00177">TestTokenSize()</a>, <a class="el" href="../../d0/d7/udfs_2strucsup_8c-source.html#l04446">UdfDeallocateTable()</a>, <a class="el" href="../../d3/d5/allocsup_8c-source.html#l00309">UdfDeletePcb()</a>, <a class="el" href="../../d4/d7/udfprocs_8h-source.html#l00453">UdfFreePool()</a>, <a class="el" href="../../d4/d7/udfs_2create_8c-source.html#l00809">UdfNormalizeFileNames()</a>, <a class="el" href="../../d6/d3/prefxsup_8c-source.html#l00256">UdfRemovePrefix()</a>, <a class="el" href="../../d0/d7/udfs_2strucsup_8c-source.html#l00477">UdfUpdateVcbPhase0()</a>, <a class="el" href="../../d0/d4/vdmints_8c-source.html#l01235">VdmpDelayInterrupt()</a>, <a class="el" href="../../d8/d3/vdminit_8c-source.html#l00019">VdmpInitialize()</a>, <a class="el" href="../../d4/d3/vdm_2vdm_8c-source.html#l00087">VdmQueryDirectoryFile()</a>, <a class="el" href="../../d0/d5/verifier_8c-source.html#l02129">VerifierFreePool()</a>, <a class="el" href="../../d0/d5/verifier_8c-source.html#l01233">ViReservePoolAllocation()</a>, <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l00773">Win32KDriverUnload()</a>, <a class="el" href="../../d8/d0/w32_2ntuser_2kernel_2init_8c-source.html#l00097">Win32kNtUserCleanup()</a>, <a class="el" href="../../d8/d1/drivesup_8c-source.html#l00190">xHalExamineMBR()</a>, <a class="el" href="../../d8/d1/drivesup_8c-source.html#l00382">xHalGetPartialGeometry()</a>, <a class="el" href="../../d8/d1/drivesup_8c-source.html#l01243">xHalIoAssignDriveLetters()</a>, <a class="el" href="../../d8/d1/drivesup_8c-source.html#l03486">xHalIoClearPartitionTable()</a>, <a class="el" href="../../d8/d1/drivesup_8c-source.html#l01739">xHalIoReadPartitionTable()</a>, <a class="el" href="../../d8/d1/drivesup_8c-source.html#l02485">xHalIoSetPartitionInformation()</a>, and <a class="el" href="../../d8/d1/drivesup_8c-source.html#l02879">xHalIoWritePartitionTable()</a>.
<p>
<pre class="fragment"><div>00307 {
00308     ULONG   size;
00309     size = <a class="code" href="../../d0/d1/hivedata_8h.html#a14">HBLOCK_SIZE</a>;
00310 
00311     <span class="comment">// if it was really more than 1 page, well, too bad</span>
00312     <a class="code" href="../../d3/d7/freevm_8c.html#a6">NtFreeVirtualMemory</a>(
00313         NtCurrentProcess(),
00314         &amp;P,
00315         &amp;size,
00316         MEM_DECOMMIT
00317         );
00318     <span class="keywordflow">return</span>;
00319 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a218" doxytag="ex.h::ExFreePoolSanityChecks" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID ExFreePoolSanityChecks           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PVOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>P</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l03892">3892</a> of file <a class="el" href="../../d3/d1/ex_2pool_8c-source.html">ex/pool.c</a>.
<p>
References <a class="el" href="../../d7/d6/halmips_8h-source.html#l00086">APC_LEVEL</a>, <a class="el" href="../../d5/d1/pool_8h-source.html#l00050">BASE_POOL_TYPE_MASK</a>, <a class="el" href="../../d5/d1/pool_8h-source.html#l00171">_POOL_HEADER::BlockSize</a>, <a class="el" href="../../d3/d0/mm_8h-source.html#l00166">BYTE_OFFSET</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00087">DISPATCH_LEVEL</a>, <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l02894">ExpCheckForResource()</a>, <a class="el" href="../../d1/d9/worker_8c.html#a27">ExpCheckForWorker()</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00422">IS_POOL_HEADER_MARKED_ALLOCATED</a>, <a class="el" href="../../d0/d1/bugcheck_8c-source.html#l00428">KeBugCheckEx()</a>, <a class="el" href="../../d4/d1/timerobj_8c-source.html#l00467">KeCheckForTimer()</a>, <a class="el" href="../../d2/d5/allocpag_8c-source.html#l00437">MmDeterminePoolType()</a>, <a class="el" href="../../d3/d0/mm_8h-source.html#l01977">MmSpecialPoolEnd</a>, <a class="el" href="../../d3/d0/mm_8h-source.html#l01976">MmSpecialPoolStart</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d6/d1/poolhack_8c-source.html#l00071">PAGE_ALIGNED</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00599">PAGE_SIZE</a>, <a class="el" href="../../d5/d8/ex_8h.html#a329a174">PagedPool</a>, <a class="el" href="../../d5/d1/pool_8h-source.html#l00096">POOL_BLOCK_SHIFT</a>, <a class="el" href="../../d6/d1/poolhack_8c-source.html#l00116">POOL_OVERHEAD</a>, <a class="el" href="../../d5/d8/ex_8h.html#a96">POOL_TYPE</a>, <a class="el" href="../../d5/d1/pool_8h-source.html#l00075">POOL_TYPE_MASK</a>, <a class="el" href="../../d6/d1/poolhack_8c-source.html#l00106">_POOL_HEADER::PoolType</a>, and <a class="el" href="../../d5/d1/pool_8h-source.html#l00173">_POOL_HEADER::Ulong1</a>.
<p>
Referenced by <a class="el" href="../../d0/d5/verifier_8c-source.html#l02143">VerifierFreePoolWithTag()</a>.
<p>
<pre class="fragment"><div>03898                    :
03899 
03900     This function performs sanity checks on <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> caller.
03901 
03902 Return Value:
03903 
03904     None.
03905 
03906 Environment:
03907 
03908     Only enabled as part of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> driver verification package.
03909 
03910 --*/
03911 
03912 {
03913     <a class="code" href="../../d5/d8/struct__POOL__HEADER.html">PPOOL_HEADER</a> Entry;
03914     <a class="code" href="../../d5/d8/ex_8h.html#a96">POOL_TYPE</a> PoolType;
03915     PVOID StillQueued;
03916 
03917     <span class="keywordflow">if</span> (P &lt;= (PVOID)(MM_HIGHEST_USER_ADDRESS)) {
03918         <a class="code" href="../../d9/d1/bugcheck_8c.html#a19">KeBugCheckEx</a> (DRIVER_VERIFIER_DETECTED_VIOLATION,
03919                       0x10,
03920                       (ULONG_PTR)P,
03921                       0,
03922                       0);
03923     }
03924 
03925     <span class="keywordflow">if</span> ((P &gt;= <a class="code" href="../../d2/d1/mm_8h.html#a160">MmSpecialPoolStart</a>) &amp;&amp; (P &lt; <a class="code" href="../../d2/d1/mm_8h.html#a161">MmSpecialPoolEnd</a>)) {
03926         StillQueued = <a class="code" href="../../d3/d2/timerobj_8c.html#a9">KeCheckForTimer</a>(P, PAGE_SIZE - BYTE_OFFSET (P));
03927         <span class="keywordflow">if</span> (StillQueued != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
03928             <a class="code" href="../../d9/d1/bugcheck_8c.html#a19">KeBugCheckEx</a> (DRIVER_VERIFIER_DETECTED_VIOLATION,
03929                           0x15,
03930                           (ULONG_PTR)StillQueued,
03931                           (ULONG_PTR)-1,
03932                           (ULONG_PTR)P);
03933         }
03934 
03935         <span class="comment">//</span>
03936         <span class="comment">// Check if an ERESOURCE is currently active in this memory block.</span>
03937         <span class="comment">//</span>
03938 
03939         StillQueued = <a class="code" href="../../d8/d8/ex_2resource_8c.html#a34">ExpCheckForResource</a>(P, PAGE_SIZE - BYTE_OFFSET (P));
03940         <span class="keywordflow">if</span> (StillQueued != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
03941             <a class="code" href="../../d9/d1/bugcheck_8c.html#a19">KeBugCheckEx</a> (DRIVER_VERIFIER_DETECTED_VIOLATION,
03942                           0x17,
03943                           (ULONG_PTR)StillQueued,
03944                           (ULONG_PTR)-1,
03945                           (ULONG_PTR)P);
03946         }
03947 
03948         <a class="code" href="../../d1/d9/worker_8c.html#a27">ExpCheckForWorker</a> (P, PAGE_SIZE - BYTE_OFFSET (P)); <span class="comment">// bugchecks inside</span>
03949         <span class="keywordflow">return</span>;
03950     }
03951 
03952     <span class="keywordflow">if</span> (<a class="code" href="../../d5/d2/poolhack_8c.html#a5">PAGE_ALIGNED</a>(P)) {
03953         PoolType = <a class="code" href="../../d1/d6/allocpag_8c.html#a48">MmDeterminePoolType</a>(P);
03954 
03955         <span class="keywordflow">if</span> ((PoolType &amp; <a class="code" href="../../d4/d2/pool_8h.html#a5">BASE_POOL_TYPE_MASK</a>) == <a class="code" href="../../d5/d8/ex_8h.html#a329a174">PagedPool</a>) {
03956             <span class="keywordflow">if</span> (KeGetCurrentIrql() &gt; <a class="code" href="../../d6/d7/halmips_8h.html#a52">APC_LEVEL</a>) {
03957                 <a class="code" href="../../d9/d1/bugcheck_8c.html#a19">KeBugCheckEx</a> (DRIVER_VERIFIER_DETECTED_VIOLATION,
03958                               0x11,
03959                               KeGetCurrentIrql(),
03960                               PoolType,
03961                               (ULONG_PTR)P);
03962             }
03963         }
03964         <span class="keywordflow">else</span> {
03965             <span class="keywordflow">if</span> (KeGetCurrentIrql() &gt; <a class="code" href="../../d6/d7/halmips_8h.html#a53">DISPATCH_LEVEL</a>) {
03966                 <a class="code" href="../../d9/d1/bugcheck_8c.html#a19">KeBugCheckEx</a> (DRIVER_VERIFIER_DETECTED_VIOLATION,
03967                               0x12,
03968                               KeGetCurrentIrql(),
03969                               PoolType,
03970                               (ULONG_PTR)P);
03971             }
03972         }
03973 
03974         <span class="comment">//</span>
03975         <span class="comment">// Just check the first page.</span>
03976         <span class="comment">//</span>
03977 
03978         StillQueued = <a class="code" href="../../d3/d2/timerobj_8c.html#a9">KeCheckForTimer</a>(P, PAGE_SIZE);
03979         <span class="keywordflow">if</span> (StillQueued != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
03980             <a class="code" href="../../d9/d1/bugcheck_8c.html#a19">KeBugCheckEx</a> (DRIVER_VERIFIER_DETECTED_VIOLATION,
03981                           0x15,
03982                           (ULONG_PTR)StillQueued,
03983                           PoolType,
03984                           (ULONG_PTR)P);
03985         }
03986 
03987         <span class="comment">//</span>
03988         <span class="comment">// Check if an ERESOURCE is currently active in this memory block.</span>
03989         <span class="comment">//</span>
03990 
03991         StillQueued = <a class="code" href="../../d8/d8/ex_2resource_8c.html#a34">ExpCheckForResource</a>(P, PAGE_SIZE);
03992 
03993         <span class="keywordflow">if</span> (StillQueued != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
03994             <a class="code" href="../../d9/d1/bugcheck_8c.html#a19">KeBugCheckEx</a> (DRIVER_VERIFIER_DETECTED_VIOLATION,
03995                           0x17,
03996                           (ULONG_PTR)StillQueued,
03997                           PoolType,
03998                           (ULONG_PTR)P);
03999         }
04000     }
04001     <span class="keywordflow">else</span> {
04002 
04003 <span class="preprocessor">#if !defined (_WIN64)</span>
04004 <span class="preprocessor"></span>        <span class="keywordflow">if</span> (((ULONG_PTR)P &amp; 0x17) != 0) {
04005             <a class="code" href="../../d9/d1/bugcheck_8c.html#a19">KeBugCheckEx</a> (DRIVER_VERIFIER_DETECTED_VIOLATION,
04006                           0x16,
04007                           __LINE__,
04008                           (ULONG_PTR)P,
04009                           0);
04010         }
04011 <span class="preprocessor">#endif</span>
04012 <span class="preprocessor"></span>
04013         Entry = (<a class="code" href="../../d5/d8/struct__POOL__HEADER.html">PPOOL_HEADER</a>)((PCHAR)P - <a class="code" href="../../d5/d2/poolhack_8c.html#a6">POOL_OVERHEAD</a>);
04014 
04015         <span class="keywordflow">if</span> ((Entry-&gt;<a class="code" href="../../d5/d8/struct__POOL__HEADER.html#o1">PoolType</a> &amp; <a class="code" href="../../d4/d2/pool_8h.html#a12">POOL_TYPE_MASK</a>) == 0) {
04016             <a class="code" href="../../d9/d1/bugcheck_8c.html#a19">KeBugCheckEx</a> (DRIVER_VERIFIER_DETECTED_VIOLATION,
04017                           0x13,
04018                           __LINE__,
04019                           (ULONG_PTR)Entry,
04020                           Entry-&gt;Ulong1);
04021         }
04022 
04023         PoolType = (Entry-&gt;<a class="code" href="../../d5/d8/struct__POOL__HEADER.html#o1">PoolType</a> &amp; <a class="code" href="../../d4/d2/pool_8h.html#a12">POOL_TYPE_MASK</a>) - 1;
04024 
04025         <span class="keywordflow">if</span> ((PoolType &amp; <a class="code" href="../../d4/d2/pool_8h.html#a5">BASE_POOL_TYPE_MASK</a>) == <a class="code" href="../../d5/d8/ex_8h.html#a329a174">PagedPool</a>) {
04026             <span class="keywordflow">if</span> (KeGetCurrentIrql() &gt; <a class="code" href="../../d6/d7/halmips_8h.html#a52">APC_LEVEL</a>) {
04027                 <a class="code" href="../../d9/d1/bugcheck_8c.html#a19">KeBugCheckEx</a> (DRIVER_VERIFIER_DETECTED_VIOLATION,
04028                               0x11,
04029                               KeGetCurrentIrql(),
04030                               PoolType,
04031                               (ULONG_PTR)P);
04032             }
04033         }
04034         <span class="keywordflow">else</span> {
04035             <span class="keywordflow">if</span> (KeGetCurrentIrql() &gt; <a class="code" href="../../d6/d7/halmips_8h.html#a53">DISPATCH_LEVEL</a>) {
04036                 <a class="code" href="../../d9/d1/bugcheck_8c.html#a19">KeBugCheckEx</a> (DRIVER_VERIFIER_DETECTED_VIOLATION,
04037                               0x12,
04038                               KeGetCurrentIrql(),
04039                               PoolType,
04040                               (ULONG_PTR)P);
04041             }
04042         }
04043 
04044         <span class="keywordflow">if</span> (!<a class="code" href="../../d2/d2/ex_2pool_8c.html#a30">IS_POOL_HEADER_MARKED_ALLOCATED</a>(Entry)) {
04045             <a class="code" href="../../d9/d1/bugcheck_8c.html#a19">KeBugCheckEx</a> (DRIVER_VERIFIER_DETECTED_VIOLATION,
04046                           0x14,
04047                           __LINE__,
04048                           (ULONG_PTR)Entry,
04049                           0);
04050         }
04051         StillQueued = <a class="code" href="../../d3/d2/timerobj_8c.html#a9">KeCheckForTimer</a>(Entry, (ULONG)(Entry-&gt;<a class="code" href="../../d5/d8/struct__POOL__HEADER.html#o6">BlockSize</a> &lt;&lt; POOL_BLOCK_SHIFT));
04052         <span class="keywordflow">if</span> (StillQueued != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
04053             <a class="code" href="../../d9/d1/bugcheck_8c.html#a19">KeBugCheckEx</a> (DRIVER_VERIFIER_DETECTED_VIOLATION,
04054                           0x15,
04055                           (ULONG_PTR)StillQueued,
04056                           PoolType,
04057                           (ULONG_PTR)P);
04058         }
04059 
04060         <span class="comment">//</span>
04061         <span class="comment">// Check if an ERESOURCE is currently active in this memory block.</span>
04062         <span class="comment">//</span>
04063 
04064         StillQueued = <a class="code" href="../../d8/d8/ex_2resource_8c.html#a34">ExpCheckForResource</a>(Entry, (ULONG)(Entry-&gt;<a class="code" href="../../d5/d8/struct__POOL__HEADER.html#o6">BlockSize</a> &lt;&lt; POOL_BLOCK_SHIFT));
04065 
04066         <span class="keywordflow">if</span> (StillQueued != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
04067             <a class="code" href="../../d9/d1/bugcheck_8c.html#a19">KeBugCheckEx</a> (DRIVER_VERIFIER_DETECTED_VIOLATION,
04068                           0x17,
04069                           (ULONG_PTR)StillQueued,
04070                           PoolType,
04071                           (ULONG_PTR)P);
04072         }
04073     }
04074 }
}
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a225" doxytag="ex.h::ExFreePoolWithTag" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI VOID ExFreePoolWithTag           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>P</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Tag</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l02760">2760</a> of file <a class="el" href="../../d3/d1/ex_2pool_8c-source.html">ex/pool.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00217">ASSERT_FREE_IRQL</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00229">ASSERT_POOL_NOT_FREE</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00234">ASSERT_POOL_TYPE_NOT_ZERO</a>, <a class="el" href="../../d5/d1/pool_8h-source.html#l00050">BASE_POOL_TYPE_MASK</a>, <a class="el" href="../../d5/d1/pool_8h-source.html#l00171">_POOL_HEADER::BlockSize</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00173">CHECK_LIST</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00239">CHECK_LOOKASIDE_LIST</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00184">CHECK_POOL_HEADER</a>, <a class="el" href="../../d7/d5/memprint_8h-source.html#l00079">DbgPrint</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00418">DECODE_POOL_INDEX</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00125">DecodeLink</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l00725">_GENERAL_LOOKASIDE::Depth</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00417">ENCODE_POOL_INDEX</a>, <a class="el" href="../../d5/d8/ex_8h.html#a243">ExInterlockedPushEntrySList()</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l02461">ExpFindAndRemoveTagBigPages()</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l02231">ExpRemovePoolTracker()</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00349">ExpSessionPoolDescriptor</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l00637">ExQueryDepthSList</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00072">FREE_CHECK_ERESOURCE</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00073">FREE_CHECK_KTIMER</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00074">FREE_CHECK_WORKER</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l00736">_GENERAL_LOOKASIDE::FreeHits</a>, <a class="el" href="../../d2/d9/cmchek_8c-source.html#l00095">Index</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00422">IS_POOL_HEADER_MARKED_ALLOCATED</a>, <a class="el" href="../../d6/d2/i386_8h-source.html#l02725">Isx86FeaturePresent</a>, <a class="el" href="../../d0/d1/bugcheck_8c-source.html#l00428">KeBugCheckEx()</a>, <a class="el" href="../../d3/d6/alpha_2kdpcpu_8h-source.html#l00069">KeGetCurrentPrcb</a>, <a class="el" href="../../d6/d2/i386_8h-source.html#l02709">KF_CMPXCHG8B</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l00755">_NPAGED_LOOKASIDE_LIST::L</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l00724">_GENERAL_LOOKASIDE::ListHead</a>, <a class="el" href="../../d6/d1/poolhack_8c-source.html#l00100">_POOL_DESCRIPTOR::ListHeads</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l00756">_NPAGED_LOOKASIDE_LIST::Lock</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00500">LOCK_IF_PAGED_POOL</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00492">LOCK_POOL</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00421">MARK_POOL_HEADER_FREED</a>, <a class="el" href="../../d2/d5/allocpag_8c-source.html#l01778">MiFreePoolPages()</a>, <a class="el" href="../../d2/d5/allocpag_8c-source.html#l00547">MiSessionPoolFreed()</a>, <a class="el" href="../../d2/d5/allocpag_8c-source.html#l00437">MmDeterminePoolType()</a>, <a class="el" href="../../d1/d6/allocpag_8c.html#a41">MmFreeSpecialPool()</a>, <a class="el" href="../../d3/d0/mm_8h-source.html#l01977">MmSpecialPoolEnd</a>, <a class="el" href="../../d3/d0/mm_8h-source.html#l01976">MmSpecialPoolStart</a>, <a class="el" href="../../d5/d8/ex_8h.html#a329a173">NonPagedPool</a>, <a class="el" href="../../d5/d8/ex_8h.html#a329a175">NonPagedPoolMustSucceed</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d5/d9/ob_8h-source.html#l00494">ObDereferenceObject</a>, <a class="el" href="../../d6/d1/poolhack_8c-source.html#l00071">PAGE_ALIGNED</a>, <a class="el" href="../../d5/d1/pool_8h-source.html#l00110">PAGE_END</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00600">PAGE_SHIFT</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00599">PAGE_SIZE</a>, <a class="el" href="../../d5/d8/ex_8h.html#a329a174">PagedPool</a>, <a class="el" href="../../d5/d8/ex_8h.html#a329a182">PagedPoolSession</a>, <a class="el" href="../../d3/d0/mm_8h-source.html#l02171">PERFINFO_EXFREEPOOLWITHTAG_DECL</a>, <a class="el" href="../../d3/d0/mm_8h-source.html#l02172">PERFINFO_FREEPOOL</a>, <a class="el" href="../../d3/d0/mm_8h-source.html#l02173">PERFINFO_FREEPOOLPAGE</a>, <a class="el" href="../../d5/d1/pool_8h-source.html#l00096">POOL_BLOCK_SHIFT</a>, <a class="el" href="../../d6/d1/poolhack_8c-source.html#l00116">POOL_OVERHEAD</a>, <a class="el" href="../../d5/d1/pool_8h-source.html#l00073">POOL_QUOTA_MASK</a>, <a class="el" href="../../d1/d8/ntosdef_8h-source.html#l00115">POOL_SMALL_LISTS</a>, <a class="el" href="../../d5/d8/ex_8h.html#a96">POOL_TYPE</a>, <a class="el" href="../../d5/d1/pool_8h-source.html#l00075">POOL_TYPE_MASK</a>, <a class="el" href="../../d5/d1/pool_8h-source.html#l00058">POOL_VERIFIER_MASK</a>, <a class="el" href="../../d5/d1/pool_8h-source.html#l00119">_POOL_DESCRIPTOR::PoolIndex</a>, <a class="el" href="../../d5/d1/pool_8h-source.html#l00181">_POOL_HEADER::PoolTag</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00352">PoolTrackTable</a>, <a class="el" href="../../d6/d1/poolhack_8c-source.html#l00106">_POOL_HEADER::PoolType</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00451">PoolVector</a>, <a class="el" href="../../d5/d1/pool_8h-source.html#l00168">_POOL_HEADER::PreviousSize</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00162">PrivateInsertHeadList</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00151">PrivateInsertTailList</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00142">PrivateRemoveEntryList</a>, <a class="el" href="../../d6/d1/poolhack_8c-source.html#l00112">_POOL_HEADER::ProcessBilled</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l00281">PROTECTED_POOL</a>, <a class="el" href="../../d1/d1/psquota_8c-source.html#l00356">PsReturnPoolQuota()</a>, <a class="el" href="../../d5/d1/pool_8h-source.html#l00121">_POOL_DESCRIPTOR::RunningDeAllocs</a>, <a class="el" href="../../d5/d1/pool_8h-source.html#l00056">SESSION_POOL_MASK</a>, <a class="el" href="../../d5/d1/pool_8h-source.html#l00123">_POOL_DESCRIPTOR::TotalBigPages</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l00733">_GENERAL_LOOKASIDE::TotalFrees</a>, <a class="el" href="../../d5/d1/pool_8h-source.html#l00122">_POOL_DESCRIPTOR::TotalPages</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00559">UNLOCK_IF_PAGED_POOL</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00551">UNLOCK_POOL</a>, and <a class="el" href="../../d9/d5/verifier_8c.html#a91">VerifierFreeTrackedPool()</a>.
<p>
<pre class="fragment"><div>02764 {
02765 
02766 <span class="comment">/*++</span>
02767 <span class="comment"></span>
02768 <span class="comment">Routine Description:</span>
02769 <span class="comment"></span>
02770 <span class="comment">    This function deallocates a block of pool. This function is used to</span>
02771 <span class="comment">    deallocate to both the page aligned pools and the buddy (less than</span>
02772 <span class="comment">    a page) pools.</span>
02773 <span class="comment"></span>
02774 <span class="comment">    If the address of the block being deallocated is page-aligned, then</span>
02775 <span class="comment">    the page-aligned pool deallocator is used.</span>
02776 <span class="comment"></span>
02777 <span class="comment">    Otherwise, the binary buddy pool deallocator is used.  Deallocation</span>
02778 <span class="comment">    looks at the allocated block's pool header to determine the pool</span>
02779 <span class="comment">    type and block size being deallocated.  If the pool was allocated</span>
02780 <span class="comment">    using ExAllocatePoolWithQuota, then after the deallocation is</span>
02781 <span class="comment">    complete, the appropriate process's pool quota is adjusted to reflect</span>
02782 <span class="comment">    the deallocation, and the process object is dereferenced.</span>
02783 <span class="comment"></span>
02784 <span class="comment">Arguments:</span>
02785 <span class="comment"></span>
02786 <span class="comment">    P - Supplies the address of the block of pool being deallocated.</span>
02787 <span class="comment"></span>
02788 <span class="comment">Return Value:</span>
02789 <span class="comment"></span>
02790 <span class="comment">    None.</span>
02791 <span class="comment"></span>
02792 <span class="comment">--*/</span>
02793 
02794     <a class="code" href="../../d5/d8/ex_8h.html#a96">POOL_TYPE</a> CheckType;
02795     <a class="code" href="../../d5/d8/struct__POOL__HEADER.html">PPOOL_HEADER</a> Entry;
02796     ULONG <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>;
02797     KIRQL LockHandle;
02798     <a class="code" href="../../d1/d4/struct__NPAGED__LOOKASIDE__LIST.html">PNPAGED_LOOKASIDE_LIST</a> LookasideList;
02799     <a class="code" href="../../d5/d8/struct__POOL__HEADER.html">PPOOL_HEADER</a> NextEntry;
02800     ULONG PoolIndex;
02801     <a class="code" href="../../d5/d8/ex_8h.html#a96">POOL_TYPE</a> PoolType;
02802     <a class="code" href="../../d4/d8/struct__POOL__DESCRIPTOR.html">PPOOL_DESCRIPTOR</a> PoolDesc;
02803     <a class="code" href="../../d0/d4/struct__EPROCESS.html">PEPROCESS</a> ProcessBilled;
02804     LOGICAL Combined;
02805     ULONG BigPages;
02806     ULONG Tag;
02807     LOGICAL GlobalSpace;
02808     PKPRCB Prcb;
02809     <a class="code" href="../../d2/d1/mm_8h.html#a50">PERFINFO_EXFREEPOOLWITHTAG_DECL</a>();
02810 
02811     <a class="code" href="../../d2/d1/mm_8h.html#a51">PERFINFO_FREEPOOL</a>(P);
02812 
02813     <span class="keywordflow">if</span> ((P &gt;= <a class="code" href="../../d2/d1/mm_8h.html#a160">MmSpecialPoolStart</a>) &amp;&amp; (P &lt; <a class="code" href="../../d2/d1/mm_8h.html#a161">MmSpecialPoolEnd</a>)) {
02814         <a class="code" href="../../d1/d6/allocpag_8c.html#a41">MmFreeSpecialPool</a> (P);
02815         <span class="keywordflow">return</span>;
02816     }
02817 
02818     ProcessBilled = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
02819 
02820     <span class="comment">//</span>
02821     <span class="comment">// If entry is page aligned, then call free block to the page aligned</span>
02822     <span class="comment">// pool. Otherwise, free the block to the allocation lists.</span>
02823     <span class="comment">//</span>
02824 
02825     <span class="keywordflow">if</span> (<a class="code" href="../../d5/d2/poolhack_8c.html#a5">PAGE_ALIGNED</a>(P)) {
02826 
02827         PoolType = <a class="code" href="../../d1/d6/allocpag_8c.html#a48">MmDeterminePoolType</a>(P);
02828 
02829         <a class="code" href="../../d2/d2/ex_2pool_8c.html#a20">ASSERT_FREE_IRQL</a>(PoolType, P);
02830 
02831         CheckType = PoolType &amp; <a class="code" href="../../d4/d2/pool_8h.html#a5">BASE_POOL_TYPE_MASK</a>;
02832 
02833         <span class="keywordflow">if</span> (PoolType == <a class="code" href="../../d5/d8/ex_8h.html#a329a182">PagedPoolSession</a>) {
02834             PoolDesc = <a class="code" href="../../d2/d2/ex_2pool_8c.html#a40">ExpSessionPoolDescriptor</a>;
02835         }
02836         <span class="keywordflow">else</span> {
02837             PoolDesc = <a class="code" href="../../d2/d2/ex_2pool_8c.html#a54">PoolVector</a>[PoolType];
02838         }
02839 
02840         <span class="keywordflow">if</span> ((<a class="code" href="../../d2/d2/ex_2pool_8c.html#a42">PoolTrackTable</a> != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) &amp;&amp; (PoolType != <a class="code" href="../../d5/d8/ex_8h.html#a329a182">PagedPoolSession</a>)) {
02841             Tag = <a class="code" href="../../d2/d2/ex_2pool_8c.html#a68">ExpFindAndRemoveTagBigPages</a>(P);
02842         }
02843 
02844         <a class="code" href="../../d2/d2/ex_2pool_8c.html#a33">LOCK_POOL</a>(PoolDesc, LockHandle);
02845 
02846         PoolDesc-&gt;<a class="code" href="../../d4/d8/struct__POOL__DESCRIPTOR.html#o7">RunningDeAllocs</a> += 1;
02847 
02848         <span class="comment">//</span>
02849         <span class="comment">// Large session pool allocations are accounted for directly by</span>
02850         <span class="comment">// the memory manager so no need to call MiSessionPoolFreed here.</span>
02851         <span class="comment">//</span>
02852 
02853         BigPages = <a class="code" href="../../d1/d6/allocpag_8c.html#a55">MiFreePoolPages</a>(P);
02854 
02855         <span class="keywordflow">if</span> ((<a class="code" href="../../d2/d2/ex_2pool_8c.html#a42">PoolTrackTable</a> != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) &amp;&amp; (PoolType != <a class="code" href="../../d5/d8/ex_8h.html#a329a182">PagedPoolSession</a>)) {
02856             <span class="keywordflow">if</span> (Tag &amp; <a class="code" href="../../d5/d8/ex_8h.html#a6">PROTECTED_POOL</a>) {
02857                 Tag &amp;= ~<a class="code" href="../../d5/d8/ex_8h.html#a6">PROTECTED_POOL</a>;
02858                 TagToFree &amp;= ~<a class="code" href="../../d5/d8/ex_8h.html#a6">PROTECTED_POOL</a>;
02859                 <span class="keywordflow">if</span> (Tag != TagToFree) {
02860                     <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>( <span class="stringliteral">"EX: Invalid attempt to free protected pool block %x (%c%c%c%c)\n"</span>,
02861                               P,
02862                               Tag,
02863                               Tag &gt;&gt; 8,
02864                               Tag &gt;&gt; 16,
02865                               Tag &gt;&gt; 24
02866                             );
02867                     DbgBreakPoint();
02868                 }
02869             }
02870 
02871             <a class="code" href="../../d2/d2/ex_2pool_8c.html#a66">ExpRemovePoolTracker</a>(Tag,
02872                                  BigPages * PAGE_SIZE,
02873                                  PoolType);
02874         }
02875 
02876         <span class="comment">//</span>
02877         <span class="comment">// Check if an ERESOURCE is currently active in this memory block.</span>
02878         <span class="comment">//</span>
02879 
02880         <a class="code" href="../../d2/d2/ex_2pool_8c.html#a3">FREE_CHECK_ERESOURCE</a> (P, BigPages &lt;&lt; PAGE_SHIFT);
02881 
02882         <span class="comment">//</span>
02883         <span class="comment">// Check if a KTIMER is currently active in this memory block</span>
02884         <span class="comment">//</span>
02885 
02886         <a class="code" href="../../d2/d2/ex_2pool_8c.html#a4">FREE_CHECK_KTIMER</a>(P, BigPages &lt;&lt; PAGE_SHIFT);
02887 
02888         <span class="comment">//</span>
02889         <span class="comment">// Search worker queues for work items still queued</span>
02890         <span class="comment">//</span>
02891         <a class="code" href="../../d2/d2/ex_2pool_8c.html#a5">FREE_CHECK_WORKER</a>(P, BigPages &lt;&lt; PAGE_SHIFT);
02892 
02893         PoolDesc-&gt;<a class="code" href="../../d4/d8/struct__POOL__DESCRIPTOR.html#o8">TotalBigPages</a> -= BigPages;
02894 
02895         <a class="code" href="../../d2/d2/ex_2pool_8c.html#a35">UNLOCK_POOL</a>(PoolDesc, LockHandle);
02896 
02897         <span class="keywordflow">return</span>;
02898     }
02899 
02900     <span class="comment">//</span>
02901     <span class="comment">// Align the entry address to a pool allocation boundary.</span>
02902     <span class="comment">//</span>
02903 
02904 <span class="preprocessor">#if POOL_CACHE_SUPPORTED</span>
02905 <span class="preprocessor"></span>
02906     <span class="keywordflow">if</span> (((ULONG)P &amp; POOL_CACHE_CHECK) == 0) {
02907         Entry = (<a class="code" href="../../d5/d8/struct__POOL__HEADER.html">PPOOL_HEADER</a>)((ULONG)P - PoolCacheSize);
02908 
02909     } <span class="keywordflow">else</span> {
02910         Entry = (<a class="code" href="../../d5/d8/struct__POOL__HEADER.html">PPOOL_HEADER</a>)((PCHAR)P - <a class="code" href="../../d5/d2/poolhack_8c.html#a6">POOL_OVERHEAD</a>);
02911     }
02912 
02913 <span class="preprocessor">#else</span>
02914 <span class="preprocessor"></span>
02915     Entry = (<a class="code" href="../../d5/d8/struct__POOL__HEADER.html">PPOOL_HEADER</a>)((PCHAR)P - <a class="code" href="../../d5/d2/poolhack_8c.html#a6">POOL_OVERHEAD</a>);
02916 
02917 <span class="preprocessor">#endif //POOL_CACHE_SUPPORTED</span>
02918 <span class="preprocessor"></span>
02919     <a class="code" href="../../d2/d2/ex_2pool_8c.html#a21">ASSERT_POOL_NOT_FREE</a>(Entry);
02920 
02921     PoolType = (Entry-&gt;<a class="code" href="../../d5/d8/struct__POOL__HEADER.html#o1">PoolType</a> &amp; <a class="code" href="../../d4/d2/pool_8h.html#a12">POOL_TYPE_MASK</a>) - 1;
02922 
02923     CheckType = PoolType &amp; <a class="code" href="../../d4/d2/pool_8h.html#a5">BASE_POOL_TYPE_MASK</a>;
02924 
02925     <a class="code" href="../../d2/d2/ex_2pool_8c.html#a20">ASSERT_FREE_IRQL</a>(PoolType, P);
02926 
02927     <span class="keywordflow">if</span> (Entry-&gt;<a class="code" href="../../d5/d8/struct__POOL__HEADER.html#o1">PoolType</a> &amp; <a class="code" href="../../d4/d2/pool_8h.html#a9">POOL_VERIFIER_MASK</a>) {
02928         <a class="code" href="../../d9/d5/verifier_8c.html#a91">VerifierFreeTrackedPool</a> (P,
02929                                  Entry-&gt;<a class="code" href="../../d5/d8/struct__POOL__HEADER.html#o6">BlockSize</a> &lt;&lt; POOL_BLOCK_SHIFT,
02930                                  CheckType,
02931                                  FALSE);
02932     }
02933 
02934     PoolDesc = <a class="code" href="../../d2/d2/ex_2pool_8c.html#a54">PoolVector</a>[PoolType];
02935     GlobalSpace = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
02936 
02937     <span class="keywordflow">if</span> (Entry-&gt;<a class="code" href="../../d5/d8/struct__POOL__HEADER.html#o1">PoolType</a> &amp; <a class="code" href="../../d4/d2/pool_8h.html#a8">SESSION_POOL_MASK</a>) {
02938         <span class="keywordflow">if</span> (CheckType == <a class="code" href="../../d5/d8/ex_8h.html#a329a174">PagedPool</a>) {
02939             PoolDesc = <a class="code" href="../../d2/d2/ex_2pool_8c.html#a40">ExpSessionPoolDescriptor</a>;
02940         }
02941         GlobalSpace = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
02942     }
02943     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (CheckType == <a class="code" href="../../d5/d8/ex_8h.html#a329a174">PagedPool</a>) {
02944         PoolDesc = &amp;PoolDesc[<a class="code" href="../../d2/d2/ex_2pool_8c.html#a27">DECODE_POOL_INDEX</a>(Entry)];
02945     }
02946 
02947     <a class="code" href="../../d2/d2/ex_2pool_8c.html#a33">LOCK_POOL</a>(PoolDesc, LockHandle);
02948 
02949     <span class="keywordflow">if</span> (!<a class="code" href="../../d2/d2/ex_2pool_8c.html#a30">IS_POOL_HEADER_MARKED_ALLOCATED</a>(Entry)) {
02950         <a class="code" href="../../d9/d1/bugcheck_8c.html#a19">KeBugCheckEx</a> (BAD_POOL_CALLER, 7, __LINE__, (ULONG_PTR)Entry, (ULONG_PTR)P);
02951     }
02952 
02953     <a class="code" href="../../d2/d2/ex_2pool_8c.html#a29">MARK_POOL_HEADER_FREED</a>(Entry);
02954 
02955     <span class="comment">//</span>
02956     <span class="comment">// If this allocation was in session space, let the memory</span>
02957     <span class="comment">// manager know to delete it so it won't be considered in use on</span>
02958     <span class="comment">// session exit.  Note this call must be made with the</span>
02959     <span class="comment">// relevant pool still locked.</span>
02960     <span class="comment">//</span>
02961 
02962     <span class="keywordflow">if</span> (GlobalSpace == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
02963         <a class="code" href="../../d1/d6/allocpag_8c.html#a51">MiSessionPoolFreed</a>(P, Entry-&gt;<a class="code" href="../../d5/d8/struct__POOL__HEADER.html#o6">BlockSize</a> &lt;&lt; POOL_BLOCK_SHIFT, CheckType);
02964     }
02965 
02966     <a class="code" href="../../d2/d2/ex_2pool_8c.html#a35">UNLOCK_POOL</a>(PoolDesc, LockHandle);
02967 
02968     <a class="code" href="../../d2/d2/ex_2pool_8c.html#a22">ASSERT_POOL_TYPE_NOT_ZERO</a>(Entry);
02969 
02970     <span class="comment">//</span>
02971     <span class="comment">// Check if an ERESOURCE is currently active in this memory block.</span>
02972     <span class="comment">//</span>
02973 
02974     <a class="code" href="../../d2/d2/ex_2pool_8c.html#a3">FREE_CHECK_ERESOURCE</a> (Entry, (ULONG)(Entry-&gt;<a class="code" href="../../d5/d8/struct__POOL__HEADER.html#o6">BlockSize</a> &lt;&lt; POOL_BLOCK_SHIFT));
02975 
02976     <span class="comment">//</span>
02977     <span class="comment">// Check if a KTIMER is currently active in this memory block.</span>
02978     <span class="comment">//</span>
02979 
02980     <a class="code" href="../../d2/d2/ex_2pool_8c.html#a4">FREE_CHECK_KTIMER</a>(Entry, (ULONG)(Entry-&gt;<a class="code" href="../../d5/d8/struct__POOL__HEADER.html#o6">BlockSize</a> &lt;&lt; POOL_BLOCK_SHIFT));
02981 
02982     <span class="comment">//</span>
02983     <span class="comment">// Look for work items still queued</span>
02984     <span class="comment">//</span>
02985 
02986     <a class="code" href="../../d2/d2/ex_2pool_8c.html#a5">FREE_CHECK_WORKER</a>(Entry, (ULONG)(Entry-&gt;<a class="code" href="../../d5/d8/struct__POOL__HEADER.html#o6">BlockSize</a> &lt;&lt; POOL_BLOCK_SHIFT));
02987 
02988 
02989 <span class="preprocessor">#if DBG</span>
02990 <span class="preprocessor"></span>
02991     <span class="comment">//</span>
02992     <span class="comment">// Check if the pool index field is defined correctly.</span>
02993     <span class="comment">//</span>
02994 
02995     <span class="keywordflow">if</span> (CheckType == <a class="code" href="../../d5/d8/ex_8h.html#a329a173">NonPagedPool</a>) {
02996         <span class="keywordflow">if</span> (<a class="code" href="../../d2/d2/ex_2pool_8c.html#a27">DECODE_POOL_INDEX</a>(Entry) != 0) {
02997             <a class="code" href="../../d9/d1/bugcheck_8c.html#a19">KeBugCheckEx</a>(BAD_POOL_CALLER, 2, (ULONG_PTR)Entry, (ULONG_PTR)(*(PULONG)Entry), 0);
02998         }
02999     }
03000     <span class="keywordflow">else</span> {
03001         <span class="keywordflow">if</span> (GlobalSpace == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
03002             <span class="comment">//</span>
03003             <span class="comment">// All session space allocations have an index of 0.</span>
03004             <span class="comment">//</span>
03005             <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a> (<a class="code" href="../../d2/d2/ex_2pool_8c.html#a27">DECODE_POOL_INDEX</a>(Entry) == 0);
03006         }
03007         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d2/d2/ex_2pool_8c.html#a27">DECODE_POOL_INDEX</a>(Entry) == 0) {
03008             <a class="code" href="../../d9/d1/bugcheck_8c.html#a19">KeBugCheckEx</a>(BAD_POOL_CALLER, 4, (ULONG_PTR)Entry, *(PULONG)Entry, 0);
03009         }
03010     }
03011 
03012 <span class="preprocessor">#endif // DBG</span>
03013 <span class="preprocessor"></span>
03014     <span class="comment">//</span>
03015     <span class="comment">// If pool tagging is enabled, then update the pool tracking database.</span>
03016     <span class="comment">// Otherwise, check to determine if quota was charged when the pool</span>
03017     <span class="comment">// block was allocated.</span>
03018     <span class="comment">//</span>
03019 
03020 <span class="preprocessor">#if defined (_WIN64)</span>
03021 <span class="preprocessor"></span>    <span class="keywordflow">if</span> (Entry-&gt;PoolType &amp; <a class="code" href="../../d4/d2/pool_8h.html#a11">POOL_QUOTA_MASK</a>) {
03022         ProcessBilled = Entry-&gt;ProcessBilled;
03023     }
03024 
03025     Tag = Entry-&gt;PoolTag;
03026     <span class="keywordflow">if</span> (Tag &amp; <a class="code" href="../../d5/d8/ex_8h.html#a6">PROTECTED_POOL</a>) {
03027         Tag &amp;= ~<a class="code" href="../../d5/d8/ex_8h.html#a6">PROTECTED_POOL</a>;
03028         TagToFree &amp;= ~<a class="code" href="../../d5/d8/ex_8h.html#a6">PROTECTED_POOL</a>;
03029         <span class="keywordflow">if</span> (Tag != TagToFree) {
03030             <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>( <span class="stringliteral">"EX: Invalid attempt to free protected pool block %x (%c%c%c%c)\n"</span>,
03031                       P,
03032                       Tag,
03033                       Tag &gt;&gt; 8,
03034                       Tag &gt;&gt; 16,
03035                       Tag &gt;&gt; 24
03036                     );
03037             DbgBreakPoint();
03038         }
03039     }
03040     <span class="keywordflow">if</span> (<a class="code" href="../../d2/d2/ex_2pool_8c.html#a42">PoolTrackTable</a> != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
03041         <span class="keywordflow">if</span> (GlobalSpace == <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>) {
03042             <a class="code" href="../../d2/d2/ex_2pool_8c.html#a66">ExpRemovePoolTracker</a>(Tag,
03043                                  Entry-&gt;BlockSize &lt;&lt; POOL_BLOCK_SHIFT,
03044                                  PoolType);
03045 
03046         }
03047     }
03048     <span class="keywordflow">if</span> (ProcessBilled != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
03049         <a class="code" href="../../d0/d2/psquota_8c.html#a3">PsReturnPoolQuota</a>(ProcessBilled,
03050                           PoolType &amp; BASE_POOL_TYPE_MASK,
03051                           (ULONG)Entry-&gt;BlockSize &lt;&lt; POOL_BLOCK_SHIFT);
03052         <a class="code" href="../../d4/d0/ob_8h.html#a14">ObDereferenceObject</a>(ProcessBilled);
03053     }
03054 <span class="preprocessor">#else</span>
03055 <span class="preprocessor"></span>    <span class="keywordflow">if</span> (Entry-&gt;PoolType &amp; <a class="code" href="../../d4/d2/pool_8h.html#a11">POOL_QUOTA_MASK</a>) {
03056         <span class="keywordflow">if</span> (<a class="code" href="../../d2/d2/ex_2pool_8c.html#a42">PoolTrackTable</a> == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
03057             ProcessBilled = Entry-&gt;ProcessBilled;
03058             Entry-&gt;PoolTag = 'atoQ';
03059         }
03060     }
03061 
03062     <span class="keywordflow">if</span> (<a class="code" href="../../d2/d2/ex_2pool_8c.html#a42">PoolTrackTable</a> != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
03063         Tag = Entry-&gt;PoolTag;
03064         <span class="keywordflow">if</span> (Tag &amp; <a class="code" href="../../d5/d8/ex_8h.html#a6">PROTECTED_POOL</a>) {
03065             Tag &amp;= ~<a class="code" href="../../d5/d8/ex_8h.html#a6">PROTECTED_POOL</a>;
03066             TagToFree &amp;= ~<a class="code" href="../../d5/d8/ex_8h.html#a6">PROTECTED_POOL</a>;
03067             <span class="keywordflow">if</span> (Tag != TagToFree) {
03068                 <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>( <span class="stringliteral">"EX: Invalid attempt to free protected pool block %x (%c%c%c%c)\n"</span>,
03069                           P,
03070                           Tag,
03071                           Tag &gt;&gt; 8,
03072                           Tag &gt;&gt; 16,
03073                           Tag &gt;&gt; 24
03074                         );
03075                 DbgBreakPoint();
03076             }
03077         }
03078         <span class="keywordflow">if</span> (GlobalSpace == <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>) {
03079             <a class="code" href="../../d2/d2/ex_2pool_8c.html#a66">ExpRemovePoolTracker</a>(Tag,
03080                                  Entry-&gt;BlockSize &lt;&lt; POOL_BLOCK_SHIFT ,
03081                                  PoolType);
03082         }
03083     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ProcessBilled != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
03084         <a class="code" href="../../d0/d2/psquota_8c.html#a3">PsReturnPoolQuota</a>(ProcessBilled,
03085                           PoolType &amp; BASE_POOL_TYPE_MASK,
03086                           (ULONG)Entry-&gt;BlockSize &lt;&lt; POOL_BLOCK_SHIFT);
03087         <a class="code" href="../../d4/d0/ob_8h.html#a14">ObDereferenceObject</a>(ProcessBilled);
03088     }
03089 <span class="preprocessor">#endif</span>
03090 <span class="preprocessor"></span>
03091     <span class="comment">//</span>
03092     <span class="comment">// If the pool block is a small block, then attempt to free the block</span>
03093     <span class="comment">// to the single entry lookaside list. If the free attempt fails, then</span>
03094     <span class="comment">// free the block by merging it back into the pool data structures.</span>
03095     <span class="comment">//</span>
03096 
03097     PoolIndex = <a class="code" href="../../d2/d2/ex_2pool_8c.html#a27">DECODE_POOL_INDEX</a>(Entry);
03098 
03099     <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> = Entry-&gt;BlockSize;
03100 
03101     <span class="keywordflow">if</span> (<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> &lt;= <a class="code" href="../../d0/d9/ntosdef_8h.html#a2">POOL_SMALL_LISTS</a> &amp;&amp; GlobalSpace == <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>) {
03102 
03103         <span class="comment">//</span>
03104         <span class="comment">// Attempt to free the small block to a per processor lookaside</span>
03105         <span class="comment">// list.</span>
03106         <span class="comment">//</span>
03107 
03108         <span class="keywordflow">if</span> (CheckType == <a class="code" href="../../d5/d8/ex_8h.html#a329a174">PagedPool</a>) {
03109             <span class="keywordflow">if</span> (<a class="code" href="../../d5/d3/i386_8h.html#a16">Isx86FeaturePresent</a>(KF_CMPXCHG8B)) {
03110                 Prcb = <a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a2">KeGetCurrentPrcb</a>();
03111                 LookasideList = Prcb-&gt;PPPagedLookasideList[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> - 1].P;
03112                 LookasideList-&gt;<a class="code" href="../../d1/d4/struct__NPAGED__LOOKASIDE__LIST.html#o0">L</a>.<a class="code" href="../../d6/d1/struct__GENERAL__LOOKASIDE.html#o6">TotalFrees</a> += 1;
03113 
03114                 <a class="code" href="../../d2/d2/ex_2pool_8c.html#a23">CHECK_LOOKASIDE_LIST</a>(__LINE__, LookasideList, P);
03115 
03116                 <span class="keywordflow">if</span> (<a class="code" href="../../d5/d8/ex_8h.html#a10">ExQueryDepthSList</a>(&amp;LookasideList-&gt;<a class="code" href="../../d1/d4/struct__NPAGED__LOOKASIDE__LIST.html#o0">L</a>.<a class="code" href="../../d6/d1/struct__GENERAL__LOOKASIDE.html#o0">ListHead</a>) &lt; LookasideList-&gt;<a class="code" href="../../d1/d4/struct__NPAGED__LOOKASIDE__LIST.html#o0">L</a>.<a class="code" href="../../d6/d1/struct__GENERAL__LOOKASIDE.html#o1">Depth</a>) {
03117                     LookasideList-&gt;<a class="code" href="../../d1/d4/struct__NPAGED__LOOKASIDE__LIST.html#o0">L</a>.<a class="code" href="../../d6/d1/struct__GENERAL__LOOKASIDE.html#o8">FreeHits</a> += 1;
03118                     Entry += 1;
03119                     <a class="code" href="../../d5/d8/ex_8h.html#a243">ExInterlockedPushEntrySList</a>(&amp;LookasideList-&gt;<a class="code" href="../../d1/d4/struct__NPAGED__LOOKASIDE__LIST.html#o0">L</a>.<a class="code" href="../../d6/d1/struct__GENERAL__LOOKASIDE.html#o0">ListHead</a>,
03120                                                 (PSINGLE_LIST_ENTRY)Entry,
03121                                                 &amp;LookasideList-&gt;<a class="code" href="../../d1/d4/struct__NPAGED__LOOKASIDE__LIST.html#o1">Lock</a>);
03122 
03123                     <a class="code" href="../../d2/d2/ex_2pool_8c.html#a23">CHECK_LOOKASIDE_LIST</a>(__LINE__, LookasideList, P);
03124 
03125                     <span class="keywordflow">return</span>;
03126 
03127                 } <span class="keywordflow">else</span> {
03128                     LookasideList = Prcb-&gt;PPPagedLookasideList[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> - 1].<a class="code" href="../../d1/d4/struct__NPAGED__LOOKASIDE__LIST.html#o0">L</a>;
03129                     LookasideList-&gt;<a class="code" href="../../d1/d4/struct__NPAGED__LOOKASIDE__LIST.html#o0">L</a>.<a class="code" href="../../d6/d1/struct__GENERAL__LOOKASIDE.html#o6">TotalFrees</a> += 1;
03130 
03131                     <a class="code" href="../../d2/d2/ex_2pool_8c.html#a23">CHECK_LOOKASIDE_LIST</a>(__LINE__, LookasideList, P);
03132 
03133                     <span class="keywordflow">if</span> (<a class="code" href="../../d5/d8/ex_8h.html#a10">ExQueryDepthSList</a>(&amp;LookasideList-&gt;<a class="code" href="../../d1/d4/struct__NPAGED__LOOKASIDE__LIST.html#o0">L</a>.<a class="code" href="../../d6/d1/struct__GENERAL__LOOKASIDE.html#o0">ListHead</a>) &lt; LookasideList-&gt;<a class="code" href="../../d1/d4/struct__NPAGED__LOOKASIDE__LIST.html#o0">L</a>.<a class="code" href="../../d6/d1/struct__GENERAL__LOOKASIDE.html#o1">Depth</a>) {
03134                         LookasideList-&gt;<a class="code" href="../../d1/d4/struct__NPAGED__LOOKASIDE__LIST.html#o0">L</a>.<a class="code" href="../../d6/d1/struct__GENERAL__LOOKASIDE.html#o8">FreeHits</a> += 1;
03135                         Entry += 1;
03136                         <a class="code" href="../../d5/d8/ex_8h.html#a243">ExInterlockedPushEntrySList</a>(&amp;LookasideList-&gt;<a class="code" href="../../d1/d4/struct__NPAGED__LOOKASIDE__LIST.html#o0">L</a>.<a class="code" href="../../d6/d1/struct__GENERAL__LOOKASIDE.html#o0">ListHead</a>,
03137                                                     (PSINGLE_LIST_ENTRY)Entry,
03138                                                     &amp;LookasideList-&gt;<a class="code" href="../../d1/d4/struct__NPAGED__LOOKASIDE__LIST.html#o1">Lock</a>);
03139 
03140                         <a class="code" href="../../d2/d2/ex_2pool_8c.html#a23">CHECK_LOOKASIDE_LIST</a>(__LINE__, LookasideList, P);
03141 
03142                         <span class="keywordflow">return</span>;
03143                     }
03144                 }
03145             }
03146 
03147         } <span class="keywordflow">else</span> {
03148 
03149             <span class="comment">//</span>
03150             <span class="comment">// Make sure we don't put a must succeed buffer into the</span>
03151             <span class="comment">// regular nonpaged pool list.</span>
03152             <span class="comment">//</span>
03153 
03154             <span class="keywordflow">if</span> (PoolType != <a class="code" href="../../d5/d8/ex_8h.html#a329a175">NonPagedPoolMustSucceed</a>) {
03155                 Prcb = <a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a2">KeGetCurrentPrcb</a>();
03156                 LookasideList = Prcb-&gt;PPNPagedLookasideList[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> - 1].P;
03157                 LookasideList-&gt;<a class="code" href="../../d1/d4/struct__NPAGED__LOOKASIDE__LIST.html#o0">L</a>.<a class="code" href="../../d6/d1/struct__GENERAL__LOOKASIDE.html#o6">TotalFrees</a> += 1;
03158 
03159                 <a class="code" href="../../d2/d2/ex_2pool_8c.html#a23">CHECK_LOOKASIDE_LIST</a>(__LINE__, LookasideList, P);
03160 
03161                 <span class="keywordflow">if</span> (<a class="code" href="../../d5/d8/ex_8h.html#a10">ExQueryDepthSList</a>(&amp;LookasideList-&gt;<a class="code" href="../../d1/d4/struct__NPAGED__LOOKASIDE__LIST.html#o0">L</a>.<a class="code" href="../../d6/d1/struct__GENERAL__LOOKASIDE.html#o0">ListHead</a>) &lt; LookasideList-&gt;<a class="code" href="../../d1/d4/struct__NPAGED__LOOKASIDE__LIST.html#o0">L</a>.<a class="code" href="../../d6/d1/struct__GENERAL__LOOKASIDE.html#o1">Depth</a>) {
03162                     LookasideList-&gt;<a class="code" href="../../d1/d4/struct__NPAGED__LOOKASIDE__LIST.html#o0">L</a>.<a class="code" href="../../d6/d1/struct__GENERAL__LOOKASIDE.html#o8">FreeHits</a> += 1;
03163                     Entry += 1;
03164                     <a class="code" href="../../d5/d8/ex_8h.html#a243">ExInterlockedPushEntrySList</a>(&amp;LookasideList-&gt;<a class="code" href="../../d1/d4/struct__NPAGED__LOOKASIDE__LIST.html#o0">L</a>.<a class="code" href="../../d6/d1/struct__GENERAL__LOOKASIDE.html#o0">ListHead</a>,
03165                                                 (PSINGLE_LIST_ENTRY)Entry,
03166                                                 &amp;LookasideList-&gt;<a class="code" href="../../d1/d4/struct__NPAGED__LOOKASIDE__LIST.html#o1">Lock</a>);
03167 
03168                     <a class="code" href="../../d2/d2/ex_2pool_8c.html#a23">CHECK_LOOKASIDE_LIST</a>(__LINE__, LookasideList, P);
03169 
03170                     <span class="keywordflow">return</span>;
03171 
03172                 } <span class="keywordflow">else</span> {
03173                     LookasideList = Prcb-&gt;PPNPagedLookasideList[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> - 1].<a class="code" href="../../d1/d4/struct__NPAGED__LOOKASIDE__LIST.html#o0">L</a>;
03174                     LookasideList-&gt;<a class="code" href="../../d1/d4/struct__NPAGED__LOOKASIDE__LIST.html#o0">L</a>.<a class="code" href="../../d6/d1/struct__GENERAL__LOOKASIDE.html#o6">TotalFrees</a> += 1;
03175 
03176                     <a class="code" href="../../d2/d2/ex_2pool_8c.html#a23">CHECK_LOOKASIDE_LIST</a>(__LINE__, LookasideList, P);
03177 
03178                     <span class="keywordflow">if</span> (<a class="code" href="../../d5/d8/ex_8h.html#a10">ExQueryDepthSList</a>(&amp;LookasideList-&gt;<a class="code" href="../../d1/d4/struct__NPAGED__LOOKASIDE__LIST.html#o0">L</a>.<a class="code" href="../../d6/d1/struct__GENERAL__LOOKASIDE.html#o0">ListHead</a>) &lt; LookasideList-&gt;<a class="code" href="../../d1/d4/struct__NPAGED__LOOKASIDE__LIST.html#o0">L</a>.<a class="code" href="../../d6/d1/struct__GENERAL__LOOKASIDE.html#o1">Depth</a>) {
03179                         LookasideList-&gt;<a class="code" href="../../d1/d4/struct__NPAGED__LOOKASIDE__LIST.html#o0">L</a>.<a class="code" href="../../d6/d1/struct__GENERAL__LOOKASIDE.html#o8">FreeHits</a> += 1;
03180                         Entry += 1;
03181                         <a class="code" href="../../d5/d8/ex_8h.html#a243">ExInterlockedPushEntrySList</a>(&amp;LookasideList-&gt;<a class="code" href="../../d1/d4/struct__NPAGED__LOOKASIDE__LIST.html#o0">L</a>.<a class="code" href="../../d6/d1/struct__GENERAL__LOOKASIDE.html#o0">ListHead</a>,
03182                                                     (PSINGLE_LIST_ENTRY)Entry,
03183                                                     &amp;LookasideList-&gt;<a class="code" href="../../d1/d4/struct__NPAGED__LOOKASIDE__LIST.html#o1">Lock</a>);
03184 
03185                         <a class="code" href="../../d2/d2/ex_2pool_8c.html#a23">CHECK_LOOKASIDE_LIST</a>(__LINE__, LookasideList, P);
03186 
03187                         <span class="keywordflow">return</span>;
03188                     }
03189                 }
03190             }
03191         }
03192     }
03193 
03194     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(PoolIndex == PoolDesc-&gt;<a class="code" href="../../d4/d8/struct__POOL__DESCRIPTOR.html#o5">PoolIndex</a>);
03195 
03196     <a class="code" href="../../d2/d2/ex_2pool_8c.html#a33">LOCK_POOL</a>(PoolDesc, LockHandle);
03197 
03198     <a class="code" href="../../d2/d2/ex_2pool_8c.html#a18">CHECK_POOL_HEADER</a>(__LINE__, Entry);
03199 
03200     PoolDesc-&gt;<a class="code" href="../../d4/d8/struct__POOL__DESCRIPTOR.html#o7">RunningDeAllocs</a> += 1;
03201 
03202     <span class="comment">//</span>
03203     <span class="comment">// Free the specified pool block.</span>
03204     <span class="comment">//</span>
03205     <span class="comment">// Check to see if the next entry is free.</span>
03206     <span class="comment">//</span>
03207 
03208     Combined = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
03209     NextEntry = (<a class="code" href="../../d5/d8/struct__POOL__HEADER.html">PPOOL_HEADER</a>)((<a class="code" href="../../d3/d8/struct__POOL__BLOCK.html">PPOOL_BLOCK</a>)Entry + Entry-&gt;BlockSize);
03210     <span class="keywordflow">if</span> (<a class="code" href="../../d4/d2/pool_8h.html#a17">PAGE_END</a>(NextEntry) == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
03211 
03212         <span class="keywordflow">if</span> (NextEntry-&gt;<a class="code" href="../../d5/d8/struct__POOL__HEADER.html#o1">PoolType</a> == 0) {
03213 
03214             <span class="comment">//</span>
03215             <span class="comment">// This block is free, combine with the released block.</span>
03216             <span class="comment">//</span>
03217 
03218             Combined = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
03219 
03220             <a class="code" href="../../d2/d2/ex_2pool_8c.html#a17">CHECK_LIST</a>(__LINE__, ((PLIST_ENTRY)((PCHAR)NextEntry + POOL_OVERHEAD)), P);
03221             <a class="code" href="../../d2/d2/ex_2pool_8c.html#a14">PrivateRemoveEntryList</a>(((PLIST_ENTRY)((PCHAR)NextEntry + POOL_OVERHEAD)));
03222             <a class="code" href="../../d2/d2/ex_2pool_8c.html#a17">CHECK_LIST</a>(__LINE__, <a class="code" href="../../d2/d2/ex_2pool_8c.html#a8">DecodeLink</a>(((PLIST_ENTRY)((PCHAR)NextEntry + POOL_OVERHEAD))-&gt;Flink), P);
03223             <a class="code" href="../../d2/d2/ex_2pool_8c.html#a17">CHECK_LIST</a>(__LINE__, <a class="code" href="../../d2/d2/ex_2pool_8c.html#a8">DecodeLink</a>(((PLIST_ENTRY)((PCHAR)NextEntry + POOL_OVERHEAD))-&gt;Blink), P);
03224 
03225             Entry-&gt;BlockSize += NextEntry-&gt;<a class="code" href="../../d5/d8/struct__POOL__HEADER.html#o6">BlockSize</a>;
03226         }
03227     }
03228 
03229     <span class="comment">//</span>
03230     <span class="comment">// Check to see if the previous entry is free.</span>
03231     <span class="comment">//</span>
03232 
03233     <span class="keywordflow">if</span> (Entry-&gt;PreviousSize != 0) {
03234         NextEntry = (<a class="code" href="../../d5/d8/struct__POOL__HEADER.html">PPOOL_HEADER</a>)((<a class="code" href="../../d3/d8/struct__POOL__BLOCK.html">PPOOL_BLOCK</a>)Entry - Entry-&gt;PreviousSize);
03235         <span class="keywordflow">if</span> (NextEntry-&gt;<a class="code" href="../../d5/d8/struct__POOL__HEADER.html#o1">PoolType</a> == 0) {
03236 
03237             <span class="comment">//</span>
03238             <span class="comment">// This block is free, combine with the released block.</span>
03239             <span class="comment">//</span>
03240 
03241             Combined = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
03242 
03243             <a class="code" href="../../d2/d2/ex_2pool_8c.html#a17">CHECK_LIST</a>(__LINE__, ((PLIST_ENTRY)((PCHAR)NextEntry + POOL_OVERHEAD)), P);
03244             <a class="code" href="../../d2/d2/ex_2pool_8c.html#a14">PrivateRemoveEntryList</a>(((PLIST_ENTRY)((PCHAR)NextEntry + POOL_OVERHEAD)));
03245             <a class="code" href="../../d2/d2/ex_2pool_8c.html#a17">CHECK_LIST</a>(__LINE__, <a class="code" href="../../d2/d2/ex_2pool_8c.html#a8">DecodeLink</a>(((PLIST_ENTRY)((PCHAR)NextEntry + POOL_OVERHEAD))-&gt;Flink), P);
03246             <a class="code" href="../../d2/d2/ex_2pool_8c.html#a17">CHECK_LIST</a>(__LINE__, <a class="code" href="../../d2/d2/ex_2pool_8c.html#a8">DecodeLink</a>(((PLIST_ENTRY)((PCHAR)NextEntry + POOL_OVERHEAD))-&gt;Blink), P);
03247 
03248             NextEntry-&gt;<a class="code" href="../../d5/d8/struct__POOL__HEADER.html#o6">BlockSize</a> += Entry-&gt;BlockSize;
03249             Entry = NextEntry;
03250         }
03251     }
03252 
03253     <span class="comment">//</span>
03254     <span class="comment">// If the block being freed has been combined into a full page,</span>
03255     <span class="comment">// then return the free page to memory management.</span>
03256     <span class="comment">//</span>
03257 
03258     <span class="keywordflow">if</span> (<a class="code" href="../../d5/d2/poolhack_8c.html#a5">PAGE_ALIGNED</a>(Entry) &amp;&amp;
03259         (<a class="code" href="../../d4/d2/pool_8h.html#a17">PAGE_END</a>((<a class="code" href="../../d3/d8/struct__POOL__BLOCK.html">PPOOL_BLOCK</a>)Entry + Entry-&gt;BlockSize) != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>)) {
03260 
03261         <span class="comment">//</span>
03262         <span class="comment">// If the pool type is paged pool, then the paged pool page lock</span>
03263         <span class="comment">// must be held during the free of the pool pages.</span>
03264         <span class="comment">//</span>
03265 
03266         <a class="code" href="../../d2/d2/ex_2pool_8c.html#a34">LOCK_IF_PAGED_POOL</a>(CheckType, GlobalSpace);
03267 
03268         <a class="code" href="../../d2/d1/mm_8h.html#a52">PERFINFO_FREEPOOLPAGE</a>(CheckType, PoolIndex, Entry, PoolDesc);
03269 
03270         <a class="code" href="../../d1/d6/allocpag_8c.html#a55">MiFreePoolPages</a>(Entry);
03271 
03272         <a class="code" href="../../d2/d2/ex_2pool_8c.html#a36">UNLOCK_IF_PAGED_POOL</a>(CheckType, GlobalSpace);
03273 
03274         PoolDesc-&gt;<a class="code" href="../../d4/d8/struct__POOL__DESCRIPTOR.html#o1">TotalPages</a> -= 1;
03275 
03276     } <span class="keywordflow">else</span> {
03277 
03278         <span class="comment">//</span>
03279         <span class="comment">// Insert this element into the list.</span>
03280         <span class="comment">//</span>
03281 
03282         Entry-&gt;PoolType = 0;
03283         <a class="code" href="../../d2/d2/ex_2pool_8c.html#a26">ENCODE_POOL_INDEX</a>(Entry, PoolIndex);
03284         <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> = Entry-&gt;BlockSize;
03285 
03286         <span class="comment">//</span>
03287         <span class="comment">// If the freed block was combined with any other block, then</span>
03288         <span class="comment">// adjust the size of the next block if necessary.</span>
03289         <span class="comment">//</span>
03290 
03291         <span class="keywordflow">if</span> (Combined != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
03292 
03293             <span class="comment">//</span>
03294             <span class="comment">// The size of this entry has changed, if this entry is</span>
03295             <span class="comment">// not the last one in the page, update the pool block</span>
03296             <span class="comment">// after this block to have a new previous allocation size.</span>
03297             <span class="comment">//</span>
03298 
03299             NextEntry = (<a class="code" href="../../d5/d8/struct__POOL__HEADER.html">PPOOL_HEADER</a>)((<a class="code" href="../../d3/d8/struct__POOL__BLOCK.html">PPOOL_BLOCK</a>)Entry + Entry-&gt;BlockSize);
03300             <span class="keywordflow">if</span> (<a class="code" href="../../d4/d2/pool_8h.html#a17">PAGE_END</a>(NextEntry) == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
03301                 NextEntry-&gt;<a class="code" href="../../d5/d8/struct__POOL__HEADER.html#o3">PreviousSize</a> = Entry-&gt;BlockSize;
03302             }
03303 
03304             <span class="comment">//</span>
03305             <span class="comment">// Reduce fragmentation and insert at the tail in hopes</span>
03306             <span class="comment">// neighbors for this will be freed before this is reallocated.</span>
03307             <span class="comment">//</span>
03308 
03309             <a class="code" href="../../d2/d2/ex_2pool_8c.html#a17">CHECK_LIST</a>(__LINE__, &amp;PoolDesc-&gt;<a class="code" href="../../d4/d8/struct__POOL__DESCRIPTOR.html#o4">ListHeads</a>[Index - 1], P);
03310             <a class="code" href="../../d2/d2/ex_2pool_8c.html#a15">PrivateInsertTailList</a>(&amp;PoolDesc-&gt;<a class="code" href="../../d4/d8/struct__POOL__DESCRIPTOR.html#o4">ListHeads</a>[Index - 1], ((PLIST_ENTRY)((PCHAR)Entry + POOL_OVERHEAD)));
03311             <a class="code" href="../../d2/d2/ex_2pool_8c.html#a17">CHECK_LIST</a>(__LINE__, &amp;PoolDesc-&gt;<a class="code" href="../../d4/d8/struct__POOL__DESCRIPTOR.html#o4">ListHeads</a>[Index - 1], P);
03312             <a class="code" href="../../d2/d2/ex_2pool_8c.html#a17">CHECK_LIST</a>(__LINE__, ((PLIST_ENTRY)((PCHAR)Entry + POOL_OVERHEAD)), P);
03313 
03314         } <span class="keywordflow">else</span> {
03315 
03316             <a class="code" href="../../d2/d2/ex_2pool_8c.html#a17">CHECK_LIST</a>(__LINE__, &amp;PoolDesc-&gt;<a class="code" href="../../d4/d8/struct__POOL__DESCRIPTOR.html#o4">ListHeads</a>[Index - 1], P);
03317             <a class="code" href="../../d2/d2/ex_2pool_8c.html#a16">PrivateInsertHeadList</a>(&amp;PoolDesc-&gt;<a class="code" href="../../d4/d8/struct__POOL__DESCRIPTOR.html#o4">ListHeads</a>[Index - 1], ((PLIST_ENTRY)((PCHAR)Entry + POOL_OVERHEAD)));
03318             <a class="code" href="../../d2/d2/ex_2pool_8c.html#a17">CHECK_LIST</a>(__LINE__, &amp;PoolDesc-&gt;<a class="code" href="../../d4/d8/struct__POOL__DESCRIPTOR.html#o4">ListHeads</a>[Index - 1], P);
03319             <a class="code" href="../../d2/d2/ex_2pool_8c.html#a17">CHECK_LIST</a>(__LINE__, ((PLIST_ENTRY)((PCHAR)Entry + POOL_OVERHEAD)), P);
03320         }
03321     }
03322 
03323     <a class="code" href="../../d2/d2/ex_2pool_8c.html#a35">UNLOCK_POOL</a>(PoolDesc, LockHandle);
03324 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a249" doxytag="ex.h::ExFreeToNPagedLookasideList" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> __inline VOID ExFreeToNPagedLookasideList           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d1/d4/struct__NPAGED__LOOKASIDE__LIST.html">PNPAGED_LOOKASIDE_LIST</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Lookaside</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>Entry</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l00821">821</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.
<p>
References <a class="el" href="../../d5/d8/ex_8h.html#a243">ExInterlockedPushEntrySList()</a>, and <a class="el" href="../../d6/d7/ex_8h-source.html#l00637">ExQueryDepthSList</a>.
<p>
Referenced by <a class="el" href="../../d6/d7/ex_8h-source.html#l01077">ExFreeToPPNPagedLookasideList()</a>, <a class="el" href="../../d6/d2/filelock_8c-source.html#l00446">FsRtlFreeExclusiveLock()</a>, <a class="el" href="../../d6/d2/filelock_8c-source.html#l00473">FsRtlFreeLockInfo()</a>, <a class="el" href="../../d6/d2/filelock_8c-source.html#l00464">FsRtlFreeLockTreeNode()</a>, <a class="el" href="../../d6/d2/filelock_8c-source.html#l00437">FsRtlFreeSharedLock()</a>, <a class="el" href="../../d6/d2/filelock_8c-source.html#l00455">FsRtlFreeWaitingLock()</a>, and <a class="el" href="../../d0/d7/udfs_2strucsup_8c-source.html#l01437">UdfCleanupIrpContext()</a>.
<p>
<pre class="fragment"><div>00828                    :
00829 
00830     This function inserts (pushes) the specified entry into the specified
00831     nonpaged lookaside list.
00832 
00833 Arguments:
00834 
00835     Lookaside - Supplies a pointer to a nonpaged lookaside list structure.
00836 
00837     Entry - Supples a pointer to the entry that is inserted in the
00838         lookaside list.
00839 
00840 Return Value:
00841 
00842     None.
00843 
00844 --*/
00845 
00846 {
00847 
00848     Lookaside-&gt;L.TotalFrees += 1;
00849     <span class="keywordflow">if</span> (<a class="code" href="../../d5/d8/ex_8h.html#a10">ExQueryDepthSList</a>(&amp;Lookaside-&gt;L.ListHead) &gt;= Lookaside-&gt;L.Depth) {
00850         Lookaside-&gt;L.FreeMisses += 1;
00851         (Lookaside-&gt;L.Free)(Entry);
00852 
00853     } <span class="keywordflow">else</span> {
00854         <a class="code" href="../../d5/d8/ex_8h.html#a243">ExInterlockedPushEntrySList</a>(&amp;Lookaside-&gt;L.ListHead,
00855                                     (PSINGLE_LIST_ENTRY)Entry,
00856                                     &amp;Lookaside-&gt;Lock);
00857     }
00858 
00859     <span class="keywordflow">return</span>;
00860 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a253" doxytag="ex.h::ExFreeToPagedLookasideList" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> __inline VOID ExFreeToPagedLookasideList           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d1/d8/struct__PAGED__LOOKASIDE__LIST.html">PPAGED_LOOKASIDE_LIST</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Lookaside</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>Entry</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l00947">947</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.
<p>
References <a class="el" href="../../d5/d8/ex_8h.html#a243">ExInterlockedPushEntrySList()</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l00637">ExQueryDepthSList</a>, and <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>.
<p>
Referenced by <a class="el" href="../../d7/d2/queue_8c-source.html#l03253">DelQEntry()</a>, <a class="el" href="../../d7/d2/queue_8c-source.html#l02168">FreeQueue()</a>, <a class="el" href="../../d4/d5/kernel_2sendmsg_8c-source.html#l00178">FreeSMS()</a>, <a class="el" href="../../d6/d2/filelock_8c-source.html#l01162">FsRtlFreeFileLock()</a>, <a class="el" href="../../d2/d6/tunnel_8c-source.html#l00255">FsRtlFreeTunnelNode()</a>, and <a class="el" href="../../d6/d3/prefxsup_8c-source.html#l00256">UdfRemovePrefix()</a>.
<p>
<pre class="fragment"><div>00954                    :
00955 
00956     This function inserts (pushes) the specified entry into the specified
00957     paged lookaside list.
00958 
00959 Arguments:
00960 
00961     Lookaside - Supplies a pointer to a nonpaged lookaside list structure.
00962 
00963     Entry - Supples a pointer to the entry that is inserted in the
00964         lookaside list.
00965 
00966 Return Value:
00967 
00968     None.
00969 
00970 --*/
00971 
00972 {
00973 
00974     Lookaside-&gt;L.TotalFrees += 1;
00975     <span class="keywordflow">if</span> (<a class="code" href="../../d5/d8/ex_8h.html#a10">ExQueryDepthSList</a>(&amp;Lookaside-&gt;L.ListHead) &gt;= Lookaside-&gt;L.Depth) {
00976         Lookaside-&gt;L.FreeMisses += 1;
00977         (Lookaside-&gt;L.Free)(Entry);
00978 
00979     } <span class="keywordflow">else</span> {
00980         <a class="code" href="../../d5/d8/ex_8h.html#a243">ExInterlockedPushEntrySList</a>(&amp;Lookaside-&gt;L.ListHead,
00981                                     (PSINGLE_LIST_ENTRY)Entry,
00982                                     NULL);
00983     }
00984 
00985     <span class="keywordflow">return</span>;
00986 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a255" doxytag="ex.h::ExFreeToPPNPagedLookasideList" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> __inline VOID ExFreeToPPNPagedLookasideList           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d5/d8/ex_8h.html#a108">PP_NPAGED_LOOKASIDE_NUMBER</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Number</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>Entry</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l01077">1077</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l00725">_GENERAL_LOOKASIDE::Depth</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l00821">ExFreeToNPagedLookasideList()</a>, <a class="el" href="../../d5/d8/ex_8h.html#a243">ExInterlockedPushEntrySList()</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l00637">ExQueryDepthSList</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l00735">_GENERAL_LOOKASIDE::FreeMisses</a>, <a class="el" href="../../d3/d6/alpha_2kdpcpu_8h-source.html#l00069">KeGetCurrentPrcb</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l00755">_NPAGED_LOOKASIDE_LIST::L</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l00724">_GENERAL_LOOKASIDE::ListHead</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l00756">_NPAGED_LOOKASIDE_LIST::Lock</a>, <a class="el" href="../../d5/d8/ex_8h.html#a331a204">LookasideMaximumList</a>, <a class="el" href="../../d5/d8/ex_8h.html#a105">PNPAGED_LOOKASIDE_LIST</a>, and <a class="el" href="../../d6/d7/ex_8h-source.html#l00733">_GENERAL_LOOKASIDE::TotalFrees</a>.
<p>
Referenced by <a class="el" href="../../d5/d5/iosubs_8c-source.html#l06744">IoFreeMdl()</a>, and <a class="el" href="../../d7/d9/obcreate_8c-source.html#l00663">ObpFreeObjectNameBuffer()</a>.
<p>
<pre class="fragment"><div>01084                    :
01085 
01086     This function inserts (pushes) the specified entry into the specified
01087     nonpaged per processor lookaside list.
01088 
01089 Arguments:
01090 
01091     Number - Supplies the per processor nonpaged lookaside list number.
01092 
01093     Entry - Supples a pointer to the entry that is inserted in the nonpaged
01094         per processor lookaside list.
01095 
01096 Return Value:
01097 
01098     None.
01099 
01100 --*/
01101 
01102 {
01103 
01104     <a class="code" href="../../d1/d4/struct__NPAGED__LOOKASIDE__LIST.html">PNPAGED_LOOKASIDE_LIST</a> Lookaside;
01105     PKPRCB Prcb;
01106 
01107     <span class="comment">//</span>
01108     <span class="comment">// Get address of current processor block.</span>
01109     <span class="comment">//</span>
01110     <span class="comment">// N.B. It is possible to context switch during the free to a per</span>
01111     <span class="comment">//      processor nonpaged lookaside list, but this should happen</span>
01112     <span class="comment">//      infrequently and should not aversely effect the benefits of</span>
01113     <span class="comment">//      per processor lookaside lists.</span>
01114     <span class="comment">//</span>
01115 
01116     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>((Number &gt;= 0) &amp;&amp; (Number &lt; LookasideMaximumList));
01117 
01118     Prcb = <a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a2">KeGetCurrentPrcb</a>();
01119 
01120     <span class="comment">//</span>
01121     <span class="comment">// If the current depth is less than of equal to the maximum depth, then</span>
01122     <span class="comment">// free the specified entry to the per processor lookaside list. Otherwise,</span>
01123     <span class="comment">// free the entry to the system lookaside list;</span>
01124     <span class="comment">//</span>
01125     <span class="comment">//</span>
01126 
01127     Lookaside = Prcb-&gt;PPLookasideList[Number].P;
01128     Lookaside-&gt;<a class="code" href="../../d1/d4/struct__NPAGED__LOOKASIDE__LIST.html#o0">L</a>.<a class="code" href="../../d6/d1/struct__GENERAL__LOOKASIDE.html#o6">TotalFrees</a> += 1;
01129     <span class="keywordflow">if</span> (<a class="code" href="../../d5/d8/ex_8h.html#a10">ExQueryDepthSList</a>(&amp;Lookaside-&gt;<a class="code" href="../../d1/d4/struct__NPAGED__LOOKASIDE__LIST.html#o0">L</a>.<a class="code" href="../../d6/d1/struct__GENERAL__LOOKASIDE.html#o0">ListHead</a>) &gt;= Lookaside-&gt;<a class="code" href="../../d1/d4/struct__NPAGED__LOOKASIDE__LIST.html#o0">L</a>.<a class="code" href="../../d6/d1/struct__GENERAL__LOOKASIDE.html#o1">Depth</a>) {
01130         Lookaside-&gt;<a class="code" href="../../d1/d4/struct__NPAGED__LOOKASIDE__LIST.html#o0">L</a>.<a class="code" href="../../d6/d1/struct__GENERAL__LOOKASIDE.html#o7">FreeMisses</a> += 1;
01131         Lookaside = Prcb-&gt;PPLookasideList[Number].<a class="code" href="../../d1/d4/struct__NPAGED__LOOKASIDE__LIST.html#o0">L</a>;
01132         <a class="code" href="../../d5/d8/ex_8h.html#a249">ExFreeToNPagedLookasideList</a>(Lookaside, Entry);
01133 
01134     } <span class="keywordflow">else</span> {
01135         <a class="code" href="../../d5/d8/ex_8h.html#a243">ExInterlockedPushEntrySList</a>(&amp;Lookaside-&gt;<a class="code" href="../../d1/d4/struct__NPAGED__LOOKASIDE__LIST.html#o0">L</a>.<a class="code" href="../../d6/d1/struct__GENERAL__LOOKASIDE.html#o0">ListHead</a>,
01136                                     (PSINGLE_LIST_ENTRY)Entry,
01137                                     &amp;Lookaside-&gt;<a class="code" href="../../d1/d4/struct__NPAGED__LOOKASIDE__LIST.html#o1">Lock</a>);
01138     }
01139 
01140     <span class="keywordflow">return</span>;
01141 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a278" doxytag="ex.h::ExGetExclusiveWaiterCount" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI ULONG ExGetExclusiveWaiterCount           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d6/d4/struct__ERESOURCE.html">PERESOURCE</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Resource</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l02133">2133</a> of file <a class="el" href="../../d9/d7/ex_2resource_8c-source.html">ex/resource.c</a>.
<p>
References <a class="el" href="../../d6/d7/ex_8h-source.html#l02296">_ERESOURCE::NumberOfExclusiveWaiters</a>, and <a class="el" href="../../d5/d9/tex_8c-source.html#l01561">Resource</a>.
<p>
Referenced by <a class="el" href="../../d7/d1/mndraw_8c-source.html#l00290">MNAnimate()</a>.
<p>
<pre class="fragment"><div>02139                    :
02140 
02141     This routine returns <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> exclusive waiter count.
02142 
02143 
02144 Arguments:
02145 
02146     <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a> - Supplies a pointer to and executive resource.
02147 
02148 Return Value:
02149 
02150     The current number of exclusive waiters <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned as <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> function
02151     value.
02152 
02153 --*/
02154 
02155 {
02156     <span class="keywordflow">return</span> <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o9">NumberOfExclusiveWaiters</a>;
02157 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a315" doxytag="ex.h::ExGetNextWakeTime" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID ExGetNextWakeTime           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">OUT PULONGLONG&nbsp;</td>
          <td class="mdname" nowrap> <em>DueTime</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT PTIME_FIELDS&nbsp;</td>
          <td class="mdname" nowrap> <em>TimeFields</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT PVOID *&nbsp;</td>
          <td class="mdname" nowrap> <em>TimerObject</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d1/timer_8c-source.html#l01212">1212</a> of file <a class="el" href="../../d3/d1/timer_8c-source.html">timer.c</a>.
<p>
References <a class="el" href="../../d3/d1/timer_8c-source.html#l00049">ExpWakeTimerList</a>, <a class="el" href="../../d3/d1/timer_8c-source.html#l00048">ExpWakeTimerListLock</a>, <a class="el" href="../../d5/d8/ex_8h.html#a317">ExSystemTimeToLocalTime()</a>, <a class="el" href="../../d8/d9/ke_2miscc_8c-source.html#l00122">KeQueryInterruptTime()</a>, <a class="el" href="../../d8/d9/ke_2miscc_8c-source.html#l00153">KeQuerySystemTime()</a>, <a class="el" href="../../d4/d1/timerobj_8c-source.html#l00410">KeQueryTimerDueTime()</a>, <a class="el" href="../../d3/d1/timer_8c-source.html#l00033">_ETIMER::KeTimer</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d2/d2/timer_8c.html#a1">PETIMER</a>, <a class="el" href="../../d2/d1/time_8c-source.html#l00508">RtlTimeToTimeFields()</a>, <a class="el" href="../../d7/d5/ttime_8c-source.html#l00046">TimeFields</a>, <a class="el" href="../../d3/d1/timer_8c-source.html#l00040">_ETIMER::WakeTimer</a>, and <a class="el" href="../../d3/d1/timer_8c-source.html#l00041">_ETIMER::WakeTimerListEntry</a>.
<p>
<pre class="fragment"><div>01217 {
01218     PLIST_ENTRY     Link;
01219     <a class="code" href="../../d1/d7/struct__ETIMER.html">PETIMER</a>         ExTimer;
01220     <a class="code" href="../../d1/d7/struct__ETIMER.html">PETIMER</a>         BestTimer;
01221     KIRQL           OldIrql;
01222     ULONGLONG       TimerDueTime;
01223     ULONGLONG       BestDueTime;
01224     ULONGLONG       InterruptTime;
01225     LARGE_INTEGER   SystemTime;
01226     LARGE_INTEGER   CmosTime;
01227 
01228     ExAcquireSpinLock(&amp;ExpWakeTimerListLock, &amp;OldIrql);
01229     BestDueTime = 0;
01230     BestTimer = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01231     Link = <a class="code" href="../../d2/d2/timer_8c.html#a3">ExpWakeTimerList</a>.Flink;
01232     <span class="keywordflow">while</span> (Link != &amp;<a class="code" href="../../d2/d2/timer_8c.html#a3">ExpWakeTimerList</a>) {
01233         ExTimer = CONTAINING_RECORD(Link, <a class="code" href="../../d1/d7/struct__ETIMER.html">ETIMER</a>, WakeTimerListEntry);
01234         Link = Link-&gt;Flink;
01235 
01236         <span class="keywordflow">if</span> (ExTimer-&gt;<a class="code" href="../../d1/d7/struct__ETIMER.html#o7">WakeTimer</a>) {
01237 
01238             TimerDueTime = <a class="code" href="../../d3/d2/timerobj_8c.html#a8">KeQueryTimerDueTime</a>(&amp;ExTimer-&gt;<a class="code" href="../../d1/d7/struct__ETIMER.html#o0">KeTimer</a>);
01239             TimerDueTime = 0 - TimerDueTime;
01240 
01241             <span class="comment">//</span>
01242             <span class="comment">// Is this timers due time closer?</span>
01243             <span class="comment">//</span>
01244 
01245             <span class="keywordflow">if</span> (TimerDueTime &gt; BestDueTime) {
01246                 BestDueTime = TimerDueTime;
01247                 BestTimer = ExTimer;
01248             }
01249 
01250         } <span class="keywordflow">else</span> {
01251 
01252             <span class="comment">//</span>
01253             <span class="comment">// Timer is not an active wake timer, remove it</span>
01254             <span class="comment">//</span>
01255 
01256             RemoveEntryList(&amp;ExTimer-&gt;<a class="code" href="../../d1/d7/struct__ETIMER.html#o8">WakeTimerListEntry</a>);
01257             ExTimer-&gt;<a class="code" href="../../d1/d7/struct__ETIMER.html#o8">WakeTimerListEntry</a>.Flink = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01258         }
01259     }
01260 
01261     ExReleaseSpinLock(&amp;ExpWakeTimerListLock, OldIrql);
01262 
01263     <span class="keywordflow">if</span> (BestDueTime) {
01264         <span class="comment">//</span>
01265         <span class="comment">// Convert time to timefields</span>
01266         <span class="comment">//</span>
01267 
01268         <a class="code" href="../../d7/d0/ke_2miscc_8c.html#a3">KeQuerySystemTime</a> (&amp;SystemTime);
01269         InterruptTime = <a class="code" href="../../d7/d0/ke_2miscc_8c.html#a2">KeQueryInterruptTime</a> ();
01270         BestDueTime = 0 - BestDueTime;
01271 
01272         SystemTime.QuadPart += BestDueTime - InterruptTime;
01273 
01274         <span class="comment">//</span>
01275         <span class="comment">// Many system alarms are only good to 1 second resolution.</span>
01276         <span class="comment">// Add one sceond to the target time so that the timer is really</span>
01277         <span class="comment">// elasped if this is the wake event.</span>
01278         <span class="comment">//</span>
01279 
01280         SystemTime.QuadPart += 10000000;
01281 
01282         <a class="code" href="../../d5/d8/ex_8h.html#a317">ExSystemTimeToLocalTime</a>(&amp;SystemTime,&amp;CmosTime);
01283         <a class="code" href="../../d1/d2/time_8c.html#a26">RtlTimeToTimeFields</a>(&amp;CmosTime, TimeFields);
01284     }
01285 
01286     *DueTime = BestDueTime;
01287     *TimerObject = BestTimer;
01288 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a301" doxytag="ex.h::ExGetPreviousMode" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI <a class="el" href="../../d0/d9/ntosdef_8h.html#a39">KPROCESSOR_MODE</a> ExGetPreviousMode           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a279" doxytag="ex.h::ExGetSharedWaiterCount" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI ULONG ExGetSharedWaiterCount           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d6/d4/struct__ERESOURCE.html">PERESOURCE</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Resource</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l02160">2160</a> of file <a class="el" href="../../d9/d7/ex_2resource_8c-source.html">ex/resource.c</a>.
<p>
References <a class="el" href="../../d6/d7/ex_8h-source.html#l02295">_ERESOURCE::NumberOfSharedWaiters</a>, and <a class="el" href="../../d5/d9/tex_8c-source.html#l01561">Resource</a>.
<p>
Referenced by <a class="el" href="../../d7/d1/mndraw_8c-source.html#l00290">MNAnimate()</a>.
<p>
<pre class="fragment"><div>02166                    :
02167 
02168     This routine returns <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> shared waiter count.
02169 
02170 
02171 Arguments:
02172 
02173     <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a> - Supplies a pointer to and executive resource.
02174 
02175 Return Value:
02176 
02177     The current number of shared waiters <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned as <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> function
02178     value.
02179 
02180 --*/
02181 
02182 {
02183     <span class="keywordflow">return</span> <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o8">NumberOfSharedWaiters</a>;
02184 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a209" doxytag="ex.h::ExInitializeCallData" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID ExInitializeCallData           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d8/d6/struct__CALL__PERFORMANCE__DATA.html">PCALL_PERFORMANCE_DATA</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>CallData</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d4/callperf_8c-source.html#l00028">28</a> of file <a class="el" href="../../d0/d4/callperf_8c-source.html">callperf.c</a>.
<p>
References <a class="el" href="../../d6/d7/ex_8h-source.html#l00028">CALL_HASH_TABLE_SIZE</a>, <a class="el" href="../../d2/d9/cmchek_8c-source.html#l00095">Index</a>, <a class="el" href="../../d4/d9/ke_8h.html#a354">KeInitializeSpinLock()</a>, and <a class="el" href="../../d5/d8/ex_8h.html#a93">PCALL_PERFORMANCE_DATA</a>.
<p>
Referenced by <a class="el" href="../../d3/d9/kiinit_8c-source.html#l00096">KiInitSystem()</a>.
<p>
<pre class="fragment"><div>00034                    :
00035 
00036     This function initializes a call performance data structure.
00037 
00038 Arguments:
00039 
00040     CallData - Supplies a pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> call performance data structure
00041         that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> initialized.
00042 
00043 Return Value:
00044 
00045     None.
00046 
00047 --*/
00048 
00049 {
00050 
00051     ULONG <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>;
00052 
00053     <span class="comment">//</span>
00054     <span class="comment">// Initialize the spinlock and listheads for the call performance</span>
00055     <span class="comment">// data structure.</span>
00056     <span class="comment">//</span>
00057 
00058     <a class="code" href="../../d4/d9/ke_8h.html#a354">KeInitializeSpinLock</a>(&amp;CallData-&gt;SpinLock);
00059     <span class="keywordflow">for</span> (<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> = 0; <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> &lt; <a class="code" href="../../d5/d8/ex_8h.html#a0">CALL_HASH_TABLE_SIZE</a>; <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> += 1) {
00060         InitializeListHead(&amp;CallData-&gt;HashTable[Index]);
00061     }
00062 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a289" doxytag="ex.h::ExInitializeHandleTablePackage" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI VOID ExInitializeHandleTablePackage           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l00422">422</a> of file <a class="el" href="../../d1/d7/ex_2handle_8c-source.html">ex/handle.c</a>.
<p>
References <a class="el" href="../../d6/d7/ex_8h-source.html#l02473">ExInitializeResource</a>, <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l00037">HandleTableListHead</a>, and <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l00036">HandleTableListLock</a>.
<p>
<pre class="fragment"><div>00428                    :
00429 
00430     This routine <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> called once at system initialization to setup <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> ex handle
00431     table <span class="keyword">package</span>
00432 <span class="keyword"></span>
00433 <span class="keyword"></span>Arguments:
00434 
00435     None.
00436 
00437 Return Value:
00438 
00439     None.
00440 
00441 --*/
00442 
00443 {
00444     <span class="comment">//</span>
00445     <span class="comment">//  Initialize the handle table synchronization resource and list head</span>
00446     <span class="comment">//</span>
00447 
00448     InitializeListHead( &amp;HandleTableListHead );
00449     <a class="code" href="../../d5/d8/ex_8h.html#a68">ExInitializeResource</a>( &amp;HandleTableListLock );
00450 
00451     <span class="keywordflow">return</span>;
00452 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a246" doxytag="ex.h::ExInitializeNPagedLookasideList" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI VOID ExInitializeNPagedLookasideList           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d1/d4/struct__NPAGED__LOOKASIDE__LIST.html">PNPAGED_LOOKASIDE_LIST</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Lookaside</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d5/d8/ex_8h.html#a100">PALLOCATE_FUNCTION</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Allocate</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d5/d8/ex_8h.html#a101">PFREE_FUNCTION</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Free</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Flags</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN SIZE_T&nbsp;</td>
          <td class="mdname" nowrap> <em>Size</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Tag</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a14">USHORT</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Depth</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d5/ex_2lookasid_8c-source.html#l00408">408</a> of file <a class="el" href="../../d0/d5/ex_2lookasid_8c-source.html">ex/lookasid.c</a>.
<p>
References <a class="el" href="../../d6/d7/ex_8h-source.html#l00253">ExAllocatePoolWithTag</a>, <a class="el" href="../../d7/d2/cmwraper_8c-source.html#l00304">ExFreePool()</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l00611">ExInitializeSListHead</a>, <a class="el" href="../../d5/d8/ex_8h.html#a238">ExInterlockedInsertTailList()</a>, <a class="el" href="../../d5/d9/exp_8h-source.html#l00262">ExNPagedLookasideListHead</a>, <a class="el" href="../../d5/d9/exp_8h-source.html#l00263">ExNPagedLookasideLock</a>, <a class="el" href="../../d4/d9/ke_8h.html#a354">KeInitializeSpinLock()</a>, <a class="el" href="../../d0/d5/ex_2lookasid_8c-source.html#l00033">MINIMUM_LOOKASIDE_DEPTH</a>, <a class="el" href="../../d5/d8/ex_8h.html#a329a173">NonPagedPool</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, and <a class="el" href="../../d9/d6/lh__open_2pi__mem_8h-source.html#l00017">Size</a>.
<p>
Referenced by <a class="el" href="../../d6/d7/fssup_8c-source.html#l00069">CcInitializeCacheManager()</a>, <a class="el" href="../../d6/d2/filelock_8c-source.html#l00744">FsRtlInitializeFileLocks()</a>, <a class="el" href="../../d2/d0/largemcb_8c-source.html#l00521">FsRtlInitializeLargeMcbs()</a>, <a class="el" href="../../d0/d5/ioinit_8c-source.html#l00270">IoInitSystem()</a>, and <a class="el" href="../../d1/d0/obinit_8c-source.html#l00117">ObInitSystem()</a>.
<p>
<pre class="fragment"><div>00420                    :
00421 
00422     This function initializes a nonpaged lookaside list structure and inserts
00423     <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> structure in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> system nonpaged lookaside list.
00424 
00425 Arguments:
00426 
00427     Lookaside - Supplies a pointer to a nonpaged lookaside list structure.
00428 
00429     Allocate - Supplies an optional pointer to an allocate function.
00430 
00431     Free - Supplies an optional pointer to a free function.
00432 
00433     Flags - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a> allocation flags which are merged with <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00434         <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a> allocation <a class="code" href="../../d4/d4/iafptrap_8c.html#a9">type</a> (NonPagedPool) to control pool allocation.
00435 
00436     Size - Supplies the size for the lookaside list entries.
00437 
00438     Tag - Supplies the pool tag for the lookaside list entries.
00439 
00440     Depth - Supplies the maximum depth of the lookaside list.
00441 
00442 Return Value:
00443 
00444     None.
00445 
00446 --*/
00447 
00448 {
00449 
00450     <span class="comment">//</span>
00451     <span class="comment">// Initialize the lookaside list structure.</span>
00452     <span class="comment">//</span>
00453 
00454     <a class="code" href="../../d5/d8/ex_8h.html#a9">ExInitializeSListHead</a>(&amp;Lookaside-&gt;L.ListHead);
00455     Lookaside-&gt;L.Depth = <a class="code" href="../../d9/d5/ex_2lookasid_8c.html#a1">MINIMUM_LOOKASIDE_DEPTH</a>;
00456     Lookaside-&gt;L.MaximumDepth = 256; <span class="comment">//Depth;</span>
00457     Lookaside-&gt;L.TotalAllocates = 0;
00458     Lookaside-&gt;L.AllocateMisses = 0;
00459     Lookaside-&gt;L.TotalFrees = 0;
00460     Lookaside-&gt;L.FreeMisses = 0;
00461     Lookaside-&gt;L.Type = <a class="code" href="../../d5/d8/ex_8h.html#a329a173">NonPagedPool</a> | Flags;
00462     Lookaside-&gt;L.Tag = Tag;
00463     Lookaside-&gt;L.Size = (ULONG)<a class="code" href="../../d8/d7/lh__open_2pi__mem_8h.html#a0">Size</a>;
00464     <span class="keywordflow">if</span> (Allocate == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00465         Lookaside-&gt;L.Allocate = <a class="code" href="../../d5/d8/ex_8h.html#a4">ExAllocatePoolWithTag</a>;
00466 
00467     } <span class="keywordflow">else</span> {
00468         Lookaside-&gt;L.Allocate = Allocate;
00469     }
00470 
00471     <span class="keywordflow">if</span> (Free == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00472         Lookaside-&gt;L.Free = <a class="code" href="../../d6/d3/cmwraper_8c.html#a26">ExFreePool</a>;
00473 
00474     } <span class="keywordflow">else</span> {
00475         Lookaside-&gt;L.Free = Free;
00476     }
00477 
00478     Lookaside-&gt;L.LastTotalAllocates = 0;
00479     Lookaside-&gt;L.LastAllocateMisses = 0;
00480     <a class="code" href="../../d4/d9/ke_8h.html#a354">KeInitializeSpinLock</a>(&amp;Lookaside-&gt;Lock);
00481 
00482     <span class="comment">//</span>
00483     <span class="comment">// Insert the lookaside list structure is the system nonpaged lookaside</span>
00484     <span class="comment">// list.</span>
00485     <span class="comment">//</span>
00486 
00487     <a class="code" href="../../d5/d8/ex_8h.html#a238">ExInterlockedInsertTailList</a>(&amp;ExNPagedLookasideListHead,
00488                                 &amp;Lookaside-&gt;L.ListEntry,
00489                                 &amp;ExNPagedLookasideLock);
00490     <span class="keywordflow">return</span>;
00491 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a250" doxytag="ex.h::ExInitializePagedLookasideList" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI VOID ExInitializePagedLookasideList           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d1/d8/struct__PAGED__LOOKASIDE__LIST.html">PPAGED_LOOKASIDE_LIST</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Lookaside</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d5/d8/ex_8h.html#a100">PALLOCATE_FUNCTION</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Allocate</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d5/d8/ex_8h.html#a101">PFREE_FUNCTION</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Free</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Flags</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN SIZE_T&nbsp;</td>
          <td class="mdname" nowrap> <em>Size</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Tag</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a14">USHORT</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Depth</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d5/ex_2lookasid_8c-source.html#l00543">543</a> of file <a class="el" href="../../d0/d5/ex_2lookasid_8c-source.html">ex/lookasid.c</a>.
<p>
References <a class="el" href="../../d6/d7/ex_8h-source.html#l00253">ExAllocatePoolWithTag</a>, <a class="el" href="../../d7/d2/cmwraper_8c-source.html#l00304">ExFreePool()</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l00367">ExInitializeFastMutex</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l00611">ExInitializeSListHead</a>, <a class="el" href="../../d5/d8/ex_8h.html#a238">ExInterlockedInsertTailList()</a>, <a class="el" href="../../d5/d9/exp_8h-source.html#l00264">ExPagedLookasideListHead</a>, <a class="el" href="../../d5/d9/exp_8h-source.html#l00265">ExPagedLookasideLock</a>, <a class="el" href="../../d0/d5/ex_2lookasid_8c-source.html#l00033">MINIMUM_LOOKASIDE_DEPTH</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d5/d8/ex_8h.html#a329a174">PagedPool</a>, and <a class="el" href="../../d9/d6/lh__open_2pi__mem_8h-source.html#l00017">Size</a>.
<p>
Referenced by <a class="el" href="../../d6/d2/filelock_8c-source.html#l00744">FsRtlInitializeFileLocks()</a>, <a class="el" href="../../d2/d0/largemcb_8c-source.html#l00521">FsRtlInitializeLargeMcbs()</a>, <a class="el" href="../../d2/d6/tunnel_8c-source.html#l00382">FsRtlInitializeTunnels()</a>, <a class="el" href="../../d7/d2/queue_8c-source.html#l03169">InitQEntryLookaside()</a>, and <a class="el" href="../../d4/d5/kernel_2sendmsg_8c-source.html#l00137">InitSMSLookaside()</a>.
<p>
<pre class="fragment"><div>00555                    :
00556 
00557     This function initializes a paged lookaside list structure and inserts
00558     <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> structure in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> system paged lookaside list.
00559 
00560 Arguments:
00561 
00562     Lookaside - Supplies a pointer to a paged lookaside list structure.
00563 
00564     Allocate - Supplies an optional pointer to an allocate function.
00565 
00566     Free - Supplies an optional pointer to a free function.
00567 
00568     Flags - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a> allocation flags which are merged with <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00569         <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a> allocation <a class="code" href="../../d4/d4/iafptrap_8c.html#a9">type</a> (NonPagedPool) to control pool allocation.
00570 
00571     Size - Supplies the size for the lookaside list entries.
00572 
00573     Tag - Supplies the pool tag for the lookaside list entries.
00574 
00575     Depth - Supplies the maximum depth of the lookaside list.
00576 
00577 Return Value:
00578 
00579     None.
00580 
00581 --*/
00582 
00583 {
00584 
00585     <span class="comment">//</span>
00586     <span class="comment">// Initialize the lookaside list structure.</span>
00587     <span class="comment">//</span>
00588 
00589     <a class="code" href="../../d5/d8/ex_8h.html#a9">ExInitializeSListHead</a>(&amp;Lookaside-&gt;L.ListHead);
00590     Lookaside-&gt;L.Depth = <a class="code" href="../../d9/d5/ex_2lookasid_8c.html#a1">MINIMUM_LOOKASIDE_DEPTH</a>;
00591     Lookaside-&gt;L.MaximumDepth = 256; <span class="comment">//Depth;</span>
00592     Lookaside-&gt;L.TotalAllocates = 0;
00593     Lookaside-&gt;L.AllocateMisses = 0;
00594     Lookaside-&gt;L.TotalFrees = 0;
00595     Lookaside-&gt;L.FreeMisses = 0;
00596     Lookaside-&gt;L.Type = <a class="code" href="../../d5/d8/ex_8h.html#a329a174">PagedPool</a> | Flags;
00597     Lookaside-&gt;L.Tag = Tag;
00598     Lookaside-&gt;L.Size = (ULONG)<a class="code" href="../../d8/d7/lh__open_2pi__mem_8h.html#a0">Size</a>;
00599     <span class="keywordflow">if</span> (Allocate == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00600         Lookaside-&gt;L.Allocate = <a class="code" href="../../d5/d8/ex_8h.html#a4">ExAllocatePoolWithTag</a>;
00601 
00602     } <span class="keywordflow">else</span> {
00603         Lookaside-&gt;L.Allocate = Allocate;
00604     }
00605 
00606     <span class="keywordflow">if</span> (Free == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00607         Lookaside-&gt;L.Free = <a class="code" href="../../d6/d3/cmwraper_8c.html#a26">ExFreePool</a>;
00608 
00609     } <span class="keywordflow">else</span> {
00610         Lookaside-&gt;L.Free = Free;
00611     }
00612 
00613     Lookaside-&gt;L.LastTotalAllocates = 0;
00614     Lookaside-&gt;L.LastAllocateMisses = 0;
00615     <a class="code" href="../../d5/d8/ex_8h.html#a8">ExInitializeFastMutex</a>(&amp;Lookaside-&gt;Lock);
00616 
00617     <span class="comment">//</span>
00618     <span class="comment">// Insert the lookaside list structure in the system paged lookaside</span>
00619     <span class="comment">// list.</span>
00620     <span class="comment">//</span>
00621 
00622     <a class="code" href="../../d5/d8/ex_8h.html#a238">ExInterlockedInsertTailList</a>(&amp;ExPagedLookasideListHead,
00623                                 &amp;Lookaside-&gt;L.ListEntry,
00624                                 &amp;ExPagedLookasideLock);
00625     <span class="keywordflow">return</span>;
00626 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a266" doxytag="ex.h::ExInitializeResourceLite" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI NTSTATUS ExInitializeResourceLite           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d6/d4/struct__ERESOURCE.html">PERESOURCE</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Resource</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l00209">209</a> of file <a class="el" href="../../d9/d7/ex_2resource_8c-source.html">ex/resource.c</a>.
<p>
References <a class="el" href="../../d6/d7/ex_8h-source.html#l02323">_RESOURCE_PERFORMANCE_DATA::ActiveResourceCount</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02298">_ERESOURCE::Address</a>, <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02299">_ERESOURCE::CreatorBackTraceIndex</a>, <a class="el" href="../../d5/d8/ex_8h.html#a238">ExInterlockedInsertTailList()</a>, <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l00114">ExpResourceSpinLock</a>, <a class="el" href="../../d8/d3/ddkresrc_8c-source.html#l00157">ExpSystemResourcesList</a>, <a class="el" href="../../d4/d9/ke_8h.html#a354">KeInitializeSpinLock()</a>, <a class="el" href="../../d2/d5/allocpag_8c-source.html#l00437">MmDeterminePoolType()</a>, <a class="el" href="../../d5/d8/ex_8h.html#a329a173">NonPagedPool</a>, <a class="el" href="../../d0/d2/ldrp_8h-source.html#l00370">NtGlobalFlag</a>, <a class="el" href="../../d5/d9/tex_8c-source.html#l01561">Resource</a>, <a class="el" href="../../d6/d1/ppc_2getcalr_8c-source.html#l00038">RtlGetCallersAddress()</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02302">_ERESOURCE::SpinLock</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02287">_ERESOURCE::SystemResourcesList</a>, and <a class="el" href="../../d6/d7/ex_8h-source.html#l02324">_RESOURCE_PERFORMANCE_DATA::TotalResourceCount</a>.
<p>
Referenced by <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l01322">InitCreateUserCrit()</a>, <a class="el" href="../../d1/d1/obtype_8c-source.html#l00069">ObCreateObjectType()</a>, and <a class="el" href="../../d1/d0/obinit_8c-source.html#l00117">ObInitSystem()</a>.
<p>
<pre class="fragment"><div>00215                    :
00216 
00217     This routine initializes <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified resource.
00218 
00219 Arguments:
00220 
00221     <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a> - Supplies a pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> resource to initialize.
00222 
00223 Return Value:
00224 
00225     STATUS_SUCCESS.
00226 
00227 --*/
00228 
00229 {
00230 
00231     PVOID CallersCaller;
00232 
00233     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(<a class="code" href="../../d1/d6/allocpag_8c.html#a48">MmDeterminePoolType</a>(Resource) == NonPagedPool);
00234 
00235     <span class="comment">//</span>
00236     <span class="comment">// Initialize the specified resource.</span>
00237     <span class="comment">//</span>
00238     <span class="comment">// N.B. All fields are initialized to zero (NULL pointers) except</span>
00239     <span class="comment">//      the list entry and spinlock.</span>
00240     <span class="comment">//</span>
00241 
00242     RtlZeroMemory(Resource, <span class="keyword">sizeof</span>(<a class="code" href="../../d6/d4/struct__ERESOURCE.html">ERESOURCE</a>));
00243     <a class="code" href="../../d4/d9/ke_8h.html#a354">KeInitializeSpinLock</a>(&amp;<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o12">SpinLock</a>);
00244 
00245 <span class="preprocessor">#if i386 &amp;&amp; !FPO</span>
00246 <span class="preprocessor"></span>    <span class="keywordflow">if</span> (<a class="code" href="../../d9/d2/ldrp_8h.html#a33">NtGlobalFlag</a> &amp; FLG_KERNEL_STACK_TRACE_DB) {
00247         <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o11">CreatorBackTraceIndex</a> = RtlLogStackBackTrace();
00248         }
00249     <span class="keywordflow">else</span> {
00250         <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o11">CreatorBackTraceIndex</a> = 0;
00251         }
00252 <span class="preprocessor">#endif // i386 &amp;&amp; !FPO</span>
00253 <span class="preprocessor"></span>    <a class="code" href="../../d5/d8/ex_8h.html#a238">ExInterlockedInsertTailList</a>(&amp;ExpSystemResourcesList,
00254                                 &amp;<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o0">SystemResourcesList</a>,
00255                                 &amp;ExpResourceSpinLock);
00256 
00257     <span class="comment">//</span>
00258     <span class="comment">// Initialize performance data entry for the resource.</span>
00259     <span class="comment">//</span>
00260 
00261 <span class="preprocessor">#if defined(_COLLECT_RESOURCE_DATA_)</span>
00262 <span class="preprocessor"></span>
00263     <a class="code" href="../../d5/d2/ppc_2getcalr_8c.html#a0">RtlGetCallersAddress</a>(&amp;<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o10">Address</a>, &amp;CallersCaller);
00264     ExpResourcePerformanceData.TotalResourceCount += 1;
00265     ExpResourcePerformanceData.ActiveResourceCount += 1;
00266 
00267 <span class="preprocessor">#endif</span>
00268 <span class="preprocessor"></span>
00269     <span class="keywordflow">return</span> STATUS_SUCCESS;
00270 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a319" doxytag="ex.h::ExInitializeTimeRefresh" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI VOID ExInitializeTimeRefresh           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a263" doxytag="ex.h::ExInitializeZone" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI NTSTATUS ExInitializeZone           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d0/d0/struct__ZONE__HEADER.html">PZONE_HEADER</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Zone</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>BlockSize</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>InitialSegment</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>InitialSegmentSize</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/zone_8c-source.html#l00048">48</a> of file <a class="el" href="../../d9/d0/zone_8c-source.html">zone.c</a>.
<p>
References <a class="el" href="../../d4/d7/udfprocs_8h-source.html#l00278">BlockSize</a>, <a class="el" href="../../d7/d5/memprint_8h-source.html#l00079">DbgPrint</a>, and <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>.
<p>
Referenced by <a class="el" href="../../d6/d7/fssup_8c-source.html#l00069">CcInitializeCacheManager()</a>, <a class="el" href="../../d5/d9/tex_8c-source.html#l01510">DoZoneTest()</a>, and <a class="el" href="../../d4/d6/lpcqueue_8c-source.html#l00287">LpcpInitializePortZone()</a>.
<p>
<pre class="fragment"><div>00057                    :
00058 
00059     This function initializes a zone header.  Once successfully
00060     initialized, blocks can be allocated and freed from <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> zone, and
00061     <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> zone can be extended.
00062 
00063 Arguments:
00064 
00065     Zone - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> address of a zone header to be initialized.
00066 
00067     <a class="code" href="../../d3/d8/udfprocs_8h.html#a54">BlockSize</a> - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> block size of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> allocatable unit within
00068                 <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> zone.  The size must be larger that <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> size of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00069                 initial segment, and must be 64-bit aligned.
00070 
00071     InitialSegment - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> address of a segment of storage.  The
00072                      first <a class="code" href="../../d1/d0/struct__ZONE__SEGMENT__HEADER.html">ZONE_SEGMENT_HEADER</a>-sized portion of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> segment
00073                      <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> used by <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> zone allocator.  The remainder of
00074                      <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> segment <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> carved up into fixed size
00075                      (<a class="code" href="../../d3/d8/udfprocs_8h.html#a54">BlockSize</a>) blocks and <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <a class="code" href="../../d3/d0/user32_8def.html#a107">made</a> available <span class="keywordflow">for</span>
00076                      allocation and deallocation from <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> zone.  The
00077                      address of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> segment must be aligned on a 64-bit
00078                      boundary.
00079 
00080     InitialSegmentSize - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> size in bytes of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> InitialSegment.
00081 
00082 Return Value:
00083 
00084     STATUS_UNSUCCESSFUL - <a class="code" href="../../d3/d8/udfprocs_8h.html#a54">BlockSize</a> or InitialSegment was not aligned on
00085                           64-bit boundaries, or <a class="code" href="../../d3/d8/udfprocs_8h.html#a54">BlockSize</a> was larger than
00086                           <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> initial segment size.
00087 
00088     STATUS_SUCCESS - The zone was successfully initialized.
00089 
00090 --*/
00091 
00092 {
00093     ULONG i;
00094     PCH p;
00095 
00096     <span class="keywordflow">if</span> ( (<a class="code" href="../../d3/d8/udfprocs_8h.html#a54">BlockSize</a> &amp; 7) || ((ULONG_PTR)InitialSegment &amp; 7) ||
00097          (<a class="code" href="../../d3/d8/udfprocs_8h.html#a54">BlockSize</a> &gt; InitialSegmentSize) ) {
00098 <span class="preprocessor">#if DBG</span>
00099 <span class="preprocessor"></span>        <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>( <span class="stringliteral">"EX: ExInitializeZone( %x, %x, %x, %x ) - Invalid parameters.\n"</span>,
00100                   Zone, BlockSize, InitialSegment, InitialSegmentSize
00101                 );
00102         DbgBreakPoint();
00103 <span class="preprocessor">#endif</span>
00104 <span class="preprocessor"></span>        <span class="keywordflow">return</span> STATUS_INVALID_PARAMETER;
00105     }
00106 
00107     Zone-&gt;BlockSize = <a class="code" href="../../d3/d8/udfprocs_8h.html#a54">BlockSize</a>;
00108 
00109     Zone-&gt;SegmentList.Next = &amp;((<a class="code" href="../../d1/d0/struct__ZONE__SEGMENT__HEADER.html">PZONE_SEGMENT_HEADER</a>) InitialSegment)-&gt;SegmentList;
00110     ((<a class="code" href="../../d1/d0/struct__ZONE__SEGMENT__HEADER.html">PZONE_SEGMENT_HEADER</a>) InitialSegment)-&gt;SegmentList.Next = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00111     ((<a class="code" href="../../d1/d0/struct__ZONE__SEGMENT__HEADER.html">PZONE_SEGMENT_HEADER</a>) InitialSegment)-&gt;Reserved = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00112 
00113     Zone-&gt;FreeList.Next = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00114 
00115     p = (PCH)InitialSegment + <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d0/struct__ZONE__SEGMENT__HEADER.html">ZONE_SEGMENT_HEADER</a>);
00116 
00117     <span class="keywordflow">for</span> (i = <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d0/struct__ZONE__SEGMENT__HEADER.html">ZONE_SEGMENT_HEADER</a>);
00118          i &lt;= InitialSegmentSize - <a class="code" href="../../d3/d8/udfprocs_8h.html#a54">BlockSize</a>;
00119          i += <a class="code" href="../../d3/d8/udfprocs_8h.html#a54">BlockSize</a>
00120         ) {
00121         ((PSINGLE_LIST_ENTRY)p)-&gt;Next = Zone-&gt;FreeList.Next;
00122         Zone-&gt;FreeList.Next = (PSINGLE_LIST_ENTRY)p;
00123         p += <a class="code" href="../../d3/d8/udfprocs_8h.html#a54">BlockSize</a>;
00124     }
00125     Zone-&gt;TotalSegmentSize = i;
00126 
00127 <span class="preprocessor">#if 0</span>
00128 <span class="preprocessor"></span>    <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>( <span class="stringliteral">"EX: ExInitializeZone( %lx, %lx, %lu, %lu, %lx )\n"</span>,
00129               Zone, InitialSegment, InitialSegmentSize,
00130               BlockSize, p
00131             );
00132 <span class="preprocessor">#endif</span>
00133 <span class="preprocessor"></span>
00134     <span class="keywordflow">return</span> STATUS_SUCCESS;
00135 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a213" doxytag="ex.h::ExInitPoolLookasidePointers" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID ExInitPoolLookasidePointers           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a211" doxytag="ex.h::ExInitSystem" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI BOOLEAN ExInitSystem           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a212" doxytag="ex.h::ExInitSystemPhase2" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI VOID ExInitSystemPhase2           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a216" doxytag="ex.h::ExInsertPoolTag" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID ExInsertPoolTag           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Tag</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>Va</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>SIZE_T&nbsp;</td>
          <td class="mdname" nowrap> <em>NumberOfBytes</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d5/d8/ex_8h.html#a96">POOL_TYPE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>PoolType</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l01893">1893</a> of file <a class="el" href="../../d3/d1/ex_2pool_8c-source.html">ex/pool.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d3/d0/mm_8h-source.html#l00141">BYTES_TO_PAGES</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l02324">ExpAddTagForBigPages()</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l02000">ExpInsertPoolTracker()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d5/d8/ex_8h.html#a329a173">NonPagedPool</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00599">PAGE_SIZE</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00356">PoolBigPageTable</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00352">PoolTrackTable</a>, and <a class="el" href="../../d5/d1/pool_8h-source.html#l00056">SESSION_POOL_MASK</a>.
<p>
Referenced by <a class="el" href="../../d2/d5/allocpag_8c-source.html#l04569">MiFindContiguousMemory()</a>.
<p>
<pre class="fragment"><div>01902                    :
01903 
01904     This function inserts a <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a> tag in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> tag table and increments <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
01905     number of allocates and updates <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> total allocation size.
01906 
01907     This function also inserts <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a> tag in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> big page tag table.
01908 
01909     N.B. This function <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <span class="keywordflow">for</span> use by memory management ONLY.
01910 
01911 Arguments:
01912 
01913     Tag - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> tag used to insert an entry in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> tag table.
01914 
01915     Va - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> allocated <span class="keyword">virtual</span> address.
01916 
01917     NumberOfBytes - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> allocation size in bytes.
01918 
01919     PoolType - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a> <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a>.
01920 
01921 Return Value:
01922 
01923     None.
01924 
01925 Environment:
01926 
01927     No <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a> locks held so <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a> may be freely allocated here as needed.
01928 
01929 --*/
01930 
01931 {
01932     ULONG NumberOfPages;
01933 
01934     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a> ((PoolType &amp; SESSION_POOL_MASK) == 0);
01935 
01936     <span class="keywordflow">if</span> ((<a class="code" href="../../d2/d2/ex_2pool_8c.html#a45">PoolBigPageTable</a>) &amp;&amp; (NumberOfBytes &gt;= <a class="code" href="../../d6/d7/halmips_8h.html#a446">PAGE_SIZE</a>)) {
01937 
01938         NumberOfPages = <a class="code" href="../../d2/d1/mm_8h.html#a5">BYTES_TO_PAGES</a>(NumberOfBytes);
01939 
01940         <span class="keywordflow">if</span> (<a class="code" href="../../d2/d2/ex_2pool_8c.html#a67">ExpAddTagForBigPages</a>((PVOID)Va, Tag, NumberOfPages) == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
01941             Tag = ' GIB';
01942         }
01943     }
01944 
01945     <span class="keywordflow">if</span> (<a class="code" href="../../d2/d2/ex_2pool_8c.html#a42">PoolTrackTable</a> != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01946         <a class="code" href="../../d2/d2/ex_2pool_8c.html#a65">ExpInsertPoolTracker</a> (Tag, NumberOfBytes, NonPagedPool);
01947     }
01948 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a234" doxytag="ex.h::ExInterlockedAddLargeInteger" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI LARGE_INTEGER ExInterlockedAddLargeInteger           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PLARGE_INTEGER&nbsp;</td>
          <td class="mdname" nowrap> <em>Addend</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN LARGE_INTEGER&nbsp;</td>
          <td class="mdname" nowrap> <em>Increment</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PKSPIN_LOCK&nbsp;</td>
          <td class="mdname" nowrap> <em>Lock</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a233" doxytag="ex.h::ExInterlockedAddLargeStatistic" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI VOID FASTCALL ExInterlockedAddLargeStatistic           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PLARGE_INTEGER&nbsp;</td>
          <td class="mdname" nowrap> <em>Addend</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Increment</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d5/d5/iosubs_8c-source.html#l12345">IopUpdateOtherOperationCount()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l12441">IopUpdateOtherTransferCount()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l12377">IopUpdateReadOperationCount()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l12473">IopUpdateReadTransferCount()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l12410">IopUpdateWriteOperationCount()</a>, and <a class="el" href="../../d5/d5/iosubs_8c-source.html#l12504">IopUpdateWriteTransferCount()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a235" doxytag="ex.h::ExInterlockedAddUlong" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI ULONG FASTCALL ExInterlockedAddUlong           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Addend</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Increment</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PKSPIN_LOCK&nbsp;</td>
          <td class="mdname" nowrap> <em>Lock</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d9/d3/intrloc2_8c-source.html#l00075">ExInterlockedDecrementLong()</a>, <a class="el" href="../../d9/d3/intrloc2_8c-source.html#l00030">ExInterlockedIncrementLong()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l12535">IoCancelFileOpen()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l05378">IoCreateStreamFileObject()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l05535">IoCreateStreamFileObjectLite()</a>, <a class="el" href="../../d4/d0/objsup_8c-source.html#l00417">IopDeleteFile()</a>, <a class="el" href="../../d8/d6/errorlog_8c-source.html#l00088">IopErrorLogThread()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l04282">IopMountVolume()</a>, <a class="el" href="../../d5/d2/parse_8c-source.html#l00202">IopParseDevice()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l09324">IoRegisterFileSystem()</a>, and <a class="el" href="../../d5/d5/iosubs_8c-source.html#l11106">IoUnregisterFileSystem()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a327" doxytag="ex.h::ExInterlockedClearBits" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI ULONG FASTCALL ExInterlockedClearBits           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN OUT PULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Flags</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Flag</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a236" doxytag="ex.h::ExInterlockedCompareExchange64" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI LONGLONG FASTCALL ExInterlockedCompareExchange64           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PLONGLONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Destination</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PLONGLONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Exchange</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PLONGLONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Comperand</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PKSPIN_LOCK&nbsp;</td>
          <td class="mdname" nowrap> <em>Lock</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a265" doxytag="ex.h::ExInterlockedExtendZone" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI NTSTATUS ExInterlockedExtendZone           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d0/d0/struct__ZONE__HEADER.html">PZONE_HEADER</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Zone</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>Segment</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>SegmentSize</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PKSPIN_LOCK&nbsp;</td>
          <td class="mdname" nowrap> <em>Lock</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d0/zone_8c-source.html#l00212">212</a> of file <a class="el" href="../../d9/d0/zone_8c-source.html">zone.c</a>.
<p>
References <a class="el" href="../../d9/d0/zone_8c-source.html#l00138">ExExtendZone()</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l00367">Lock</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, and <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00135">Status</a>.
<p>
<pre class="fragment"><div>00221                    :
00222 
00223     This function extends a zone by adding another segment's worth of
00224     blocks to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> zone.
00225 
00226 Arguments:
00227 
00228     Zone - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> address of a zone header to be extended.
00229 
00230     Segment - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> address of a segment of storage.  The first
00231               <a class="code" href="../../d1/d0/struct__ZONE__SEGMENT__HEADER.html">ZONE_SEGMENT_HEADER</a>-sized portion of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> segment <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> used by <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00232               zone allocator.  The remainder of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> segment <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> carved up
00233               into fixed-size (BlockSize) blocks and is added to the
00234               zone.  The address of the segment must be aligned on a 64-
00235               bit boundary.
00236 
00237     SegmentSize - Supplies the size in bytes of Segment.
00238 
00239     Lock - pointer to spinlock to use
00240 
00241 Return Value:
00242 
00243     STATUS_UNSUCCESSFUL - BlockSize or Segment was not aligned on
00244                           64-bit boundaries, or BlockSize was larger than
00245                           the segment size.
00246 
00247     STATUS_SUCCESS - The zone was successfully extended.
00248 
00249 --*/
00250 
00251 {
00252     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
00253     KIRQL OldIrql;
00254 
00255     ExAcquireSpinLock( Lock, &amp;OldIrql );
00256 
00257     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d5/d8/ex_8h.html#a264">ExExtendZone</a>( Zone, Segment, SegmentSize );
00258 
00259     ExReleaseSpinLock( Lock, OldIrql );
00260 
00261     <span class="keywordflow">return</span> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
00262 }
}
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a244" doxytag="ex.h::ExInterlockedFlushSList" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI PSINGLE_LIST_ENTRY FASTCALL ExInterlockedFlushSList           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d9/d3/union__SLIST__HEADER.html">PSLIST_HEADER</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>ListHead</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a237" doxytag="ex.h::ExInterlockedInsertHeadList" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI PLIST_ENTRY FASTCALL ExInterlockedInsertHeadList           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PLIST_ENTRY&nbsp;</td>
          <td class="mdname" nowrap> <em>ListHead</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PLIST_ENTRY&nbsp;</td>
          <td class="mdname" nowrap> <em>ListEntry</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PKSPIN_LOCK&nbsp;</td>
          <td class="mdname" nowrap> <em>Lock</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d6/d6/copysup_8c-source.html#l01790">CcCanIWrite()</a>, <a class="el" href="../../d6/d6/copysup_8c-source.html#l01982">CcDeferWrite()</a>, <a class="el" href="../../d8/d4/ioerr_8c-source.html#l00039">IoepInitErrLog()</a>, <a class="el" href="../../d8/d4/ioerr_8c-source.html#l00186">IoepNewErrThread()</a>, <a class="el" href="../../d5/d4/ioeapi_8c-source.html#l00538">IoErrSaveErrData()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l09487">IoRegisterLastChanceShutdownNotification()</a>, and <a class="el" href="../../d5/d5/iosubs_8c-source.html#l09550">IoRegisterShutdownNotification()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a238" doxytag="ex.h::ExInterlockedInsertTailList" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI PLIST_ENTRY FASTCALL ExInterlockedInsertTailList           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PLIST_ENTRY&nbsp;</td>
          <td class="mdname" nowrap> <em>ListHead</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PLIST_ENTRY&nbsp;</td>
          <td class="mdname" nowrap> <em>ListEntry</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PKSPIN_LOCK&nbsp;</td>
          <td class="mdname" nowrap> <em>Lock</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d6/d6/copysup_8c-source.html#l01790">CcCanIWrite()</a>, <a class="el" href="../../d6/d6/copysup_8c-source.html#l01982">CcDeferWrite()</a>, <a class="el" href="../../d0/d5/ex_2lookasid_8c-source.html#l00408">ExInitializeNPagedLookasideList()</a>, <a class="el" href="../../d0/d5/ex_2lookasid_8c-source.html#l00543">ExInitializePagedLookasideList()</a>, <a class="el" href="../../d8/d3/ddkresrc_8c-source.html#l00172">ExInitializeResource()</a>, <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l00209">ExInitializeResourceLite()</a>, <a class="el" href="../../d5/d4/ioeapi_8c-source.html#l00383">IoErrRegisterErrHandlers()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l07543">IoInitializeTimer()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l09200">IoRegisterBootDriverReinitialization()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l09262">IoRegisterDriverReinitialization()</a>, <a class="el" href="../../d5/d8/smbtrsup_8c-source.html#l01456">SmbTraceCompleteRdr()</a>, and <a class="el" href="../../d5/d8/smbtrsup_8c-source.html#l01242">SmbTraceCompleteSrv()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a240" doxytag="ex.h::ExInterlockedPopEntryList" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI PSINGLE_LIST_ENTRY FASTCALL ExInterlockedPopEntryList           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PSINGLE_LIST_ENTRY&nbsp;</td>
          <td class="mdname" nowrap> <em>ListHead</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PKSPIN_LOCK&nbsp;</td>
          <td class="mdname" nowrap> <em>Lock</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a242" doxytag="ex.h::ExInterlockedPopEntrySList" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI PSINGLE_LIST_ENTRY FASTCALL ExInterlockedPopEntrySList           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d9/d3/union__SLIST__HEADER.html">PSLIST_HEADER</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>ListHead</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PKSPIN_LOCK&nbsp;</td>
          <td class="mdname" nowrap> <em>Lock</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d6/d7/ex_8h-source.html#l00780">ExAllocateFromNPagedLookasideList()</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l00906">ExAllocateFromPagedLookasideList()</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l01011">ExAllocateFromPPNPagedLookasideList()</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l01104">ExAllocatePoolWithTag()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l08338">IoMakeAssociatedIrp()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l00662">IopAllocateIrpPrivate()</a>, and <a class="el" href="../../d6/d3/complete_8c-source.html#l00671">IoSetIoCompletion()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a241" doxytag="ex.h::ExInterlockedPushEntryList" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI PSINGLE_LIST_ENTRY FASTCALL ExInterlockedPushEntryList           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PSINGLE_LIST_ENTRY&nbsp;</td>
          <td class="mdname" nowrap> <em>ListHead</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PSINGLE_LIST_ENTRY&nbsp;</td>
          <td class="mdname" nowrap> <em>ListEntry</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PKSPIN_LOCK&nbsp;</td>
          <td class="mdname" nowrap> <em>Lock</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a243" doxytag="ex.h::ExInterlockedPushEntrySList" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI PSINGLE_LIST_ENTRY FASTCALL ExInterlockedPushEntrySList           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d9/d3/union__SLIST__HEADER.html">PSLIST_HEADER</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>ListHead</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PSINGLE_LIST_ENTRY&nbsp;</td>
          <td class="mdname" nowrap> <em>ListEntry</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PKSPIN_LOCK&nbsp;</td>
          <td class="mdname" nowrap> <em>Lock</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l02760">ExFreePoolWithTag()</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l00821">ExFreeToNPagedLookasideList()</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l00947">ExFreeToPagedLookasideList()</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l01077">ExFreeToPPNPagedLookasideList()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l06641">IopFreeIrp()</a>, and <a class="el" href="../../d6/d3/complete_8c-source.html#l00797">IopFreeMiniPacket()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a239" doxytag="ex.h::ExInterlockedRemoveHeadList" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI PLIST_ENTRY FASTCALL ExInterlockedRemoveHeadList           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PLIST_ENTRY&nbsp;</td>
          <td class="mdname" nowrap> <em>ListHead</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PKSPIN_LOCK&nbsp;</td>
          <td class="mdname" nowrap> <em>Lock</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d0/d5/ioinit_8c-source.html#l00270">IoInitSystem()</a>, <a class="el" href="../../d7/d9/pnpenum_8c-source.html#l03165">IopCallDriverAddDeviceQueryRoutine()</a>, <a class="el" href="../../d0/d5/ioinit_8c-source.html#l02327">IopInitializeBootDrivers()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l04169">IopLoadUnloadDriver()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l10359">IoShutdownSystem()</a>, <a class="el" href="../../d5/d8/smbtrsup_8c-source.html#l01949">SmbTraceEmptyQueue()</a>, and <a class="el" href="../../d5/d8/smbtrsup_8c-source.html#l02020">SmbTraceThreadEntry()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a326" doxytag="ex.h::ExInterlockedSetBits" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI ULONG FASTCALL ExInterlockedSetBits           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN OUT PULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Flags</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Flag</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a328" doxytag="ex.h::ExInterlockedSetClearBits" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI ULONG FASTCALL ExInterlockedSetClearBits           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN OUT PULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Flags</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>sFlag</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>cFlag</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a262" doxytag="ex.h::ExIsProcessorFeaturePresent" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI BOOLEAN ExIsProcessorFeaturePresent           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">ULONG&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>ProcessorFeature</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l04311">4311</a> of file <a class="el" href="../../d7/d7/sysinfo_8c-source.html">sysinfo.c</a>.
<p>
References <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>.
<p>
<pre class="fragment"><div>04314 {
04315     BOOLEAN rv;
04316 
04317     <span class="keywordflow">if</span> ( ProcessorFeature &lt; PROCESSOR_FEATURE_MAX ) {
04318         rv = SharedUserData-&gt;ProcessorFeatures[ProcessorFeature];
04319         }
04320     <span class="keywordflow">else</span> {
04321         rv = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
04322         }
04323     <span class="keywordflow">return</span> rv;
04324 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a281" doxytag="ex.h::ExIsResourceAcquiredExclusiveLite" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI BOOLEAN ExIsResourceAcquiredExclusiveLite           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d6/d4/struct__ERESOURCE.html">PERESOURCE</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Resource</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l02187">2187</a> of file <a class="el" href="../../d9/d7/ex_2resource_8c-source.html">ex/resource.c</a>.
<p>
References <a class="el" href="../../d8/d3/ddkresrc_8c-source.html#l00070">ASSERT_RESOURCE</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02274">ERESOURCE_THREAD</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d8/d3/ddkresrc_8c-source.html#l00091">IsOwnedExclusive</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02278">_OWNER_ENTRY::OwnerThread</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02293">_ERESOURCE::OwnerThreads</a>, <a class="el" href="../../d2/d8/ps_8h-source.html#l00645">PsGetCurrentThread</a>, <a class="el" href="../../d5/d9/tex_8c-source.html#l01561">Resource</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02302">_ERESOURCE::SpinLock</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d6/d8/w32_2ntuser_2kernel_2pnp_8c-source.html#l01535">RequestDeviceChange()</a>, <a class="el" href="../../d6/d8/w32_2ntuser_2kernel_2pnp_8c-source.html#l01099">StartDeviceRead()</a>, <a class="el" href="../../d4/d7/job_8c-source.html#l00206">UpdateJob()</a>, <a class="el" href="../../d8/d2/validate_8c-source.html#l00773">UserIsUserCritSecIn()</a>, <a class="el" href="../../d4/d7/job_8c-source.html#l00026">UserJobCallout()</a>, and <a class="el" href="../../d0/d6/desktop_8c-source.html#l04171">xxxUserFindHandleForObject()</a>.
<p>
<pre class="fragment"><div>02193                    :
02194 
02195     This routine determines <span class="keywordflow">if</span> a resource <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> acquired exclusive by <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
02196     calling thread.
02197 
02198 Arguments:
02199 
02200     <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a> - Supplies a pointer <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> resource to query.
02201 
02202 Return Value:
02203 
02204     If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> current thread has acquired <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> resource exclusive, a value of
02205     <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned. Otherwise, a value of <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned.
02206 
02207 --*/
02208 
02209 {
02210 
02211     <a class="code" href="../../d5/d8/ex_8h.html#a121">ERESOURCE_THREAD</a> CurrentThread;
02212     KIRQL OldIrql;
02213     BOOLEAN Result;
02214 
02215     <span class="comment">//</span>
02216     <span class="comment">// Acquire exclusive access to the specified resource.</span>
02217     <span class="comment">//</span>
02218 
02219     CurrentThread = (<a class="code" href="../../d5/d8/ex_8h.html#a121">ERESOURCE_THREAD</a>)<a class="code" href="../../d1/d9/ps_8h.html#a20">PsGetCurrentThread</a>();
02220     ExAcquireFastLock(&amp;<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o12">SpinLock</a>, &amp;OldIrql);
02221 
02222     <a class="code" href="../../d7/d4/ddkresrc_8c.html#a0">ASSERT_RESOURCE</a>(Resource);
02223 
02224     <span class="comment">//</span>
02225     <span class="comment">// If the resource is owned exclusive and the current thread is the</span>
02226     <span class="comment">// owner, then set the return value of TRUE. Otherwise, set the return</span>
02227     <span class="comment">// value to FALSE.</span>
02228     <span class="comment">//</span>
02229 
02230     Result = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
02231     <span class="keywordflow">if</span> ((<a class="code" href="../../d7/d4/ddkresrc_8c.html#a6">IsOwnedExclusive</a>(Resource)) &amp;&amp;
02232         (<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o6">OwnerThreads</a>[0].<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o0">OwnerThread</a> == CurrentThread)) {
02233         Result = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
02234     }
02235 
02236     <span class="comment">//</span>
02237     <span class="comment">// Release exclusive access to the specified resource.</span>
02238     <span class="comment">//</span>
02239 
02240     ExReleaseFastLock(&amp;<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o12">SpinLock</a>, OldIrql);
02241     <span class="keywordflow">return</span> Result;
02242 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a282" doxytag="ex.h::ExIsResourceAcquiredSharedLite" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI ULONG ExIsResourceAcquiredSharedLite           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d6/d4/struct__ERESOURCE.html">PERESOURCE</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Resource</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l02245">2245</a> of file <a class="el" href="../../d9/d7/ex_2resource_8c-source.html">ex/resource.c</a>.
<p>
References <a class="el" href="../../d8/d3/ddkresrc_8c-source.html#l00070">ASSERT_RESOURCE</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02274">ERESOURCE_THREAD</a>, <a class="el" href="../../d2/d9/cmchek_8c-source.html#l00095">Index</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02280">_OWNER_ENTRY::OwnerCount</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02288">_ERESOURCE::OwnerTable</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02278">_OWNER_ENTRY::OwnerThread</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02293">_ERESOURCE::OwnerThreads</a>, <a class="el" href="../../d2/d8/ps_8h-source.html#l00645">PsGetCurrentThread</a>, <a class="el" href="../../d5/d9/tex_8c-source.html#l01561">Resource</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02302">_ERESOURCE::SpinLock</a>, and <a class="el" href="../../d6/d7/ex_8h-source.html#l02281">_OWNER_ENTRY::TableSize</a>.
<p>
Referenced by <a class="el" href="../../d8/d2/validate_8c-source.html#l00773">UserIsUserCritSecIn()</a>, and <a class="el" href="../../d0/d6/desktop_8c-source.html#l04171">xxxUserFindHandleForObject()</a>.
<p>
<pre class="fragment"><div>02251                    :
02252 
02253     This routine determines <span class="keywordflow">if</span> a resource <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> acquired either shared or
02254     exclusive by <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> calling thread.
02255 
02256 Arguments:
02257 
02258     <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a> - Supplies a pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> resource to query.
02259 
02260 Return Value:
02261 
02262     If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> current thread has not acquired <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> resource a value of zero
02263     <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned. Otherwise, <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> thread's acquire count <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned.
02264 
02265 --*/
02266 
02267 {
02268 
02269     <a class="code" href="../../d5/d8/ex_8h.html#a121">ERESOURCE_THREAD</a> CurrentThread;
02270     ULONG <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>;
02271     ULONG Number;
02272     KIRQL OldIrql;
02273     <a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html">POWNER_ENTRY</a> OwnerEntry;
02274     ULONG Result;
02275 
02276     <span class="comment">//</span>
02277     <span class="comment">// Acquire exclusive access to the specified resource.</span>
02278     <span class="comment">//</span>
02279 
02280     CurrentThread = (<a class="code" href="../../d5/d8/ex_8h.html#a121">ERESOURCE_THREAD</a>)<a class="code" href="../../d1/d9/ps_8h.html#a20">PsGetCurrentThread</a>();
02281     ExAcquireFastLock(&amp;<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o12">SpinLock</a>, &amp;OldIrql);
02282 
02283     <a class="code" href="../../d7/d4/ddkresrc_8c.html#a0">ASSERT_RESOURCE</a>(Resource);
02284 
02285     <span class="comment">//</span>
02286     <span class="comment">// Find the current thread in the thread array and return the count.</span>
02287     <span class="comment">//</span>
02288     <span class="comment">// N.B. If the thread is not found a value of zero will be returned.</span>
02289     <span class="comment">//</span>
02290 
02291     <span class="keywordflow">if</span> (<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o6">OwnerThreads</a>[0].<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o0">OwnerThread</a> == CurrentThread) {
02292         Result = <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o6">OwnerThreads</a>[0].<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o1">OwnerCount</a>;
02293 
02294     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o6">OwnerThreads</a>[1].<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o0">OwnerThread</a> == CurrentThread) {
02295         Result = <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o6">OwnerThreads</a>[1].<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o1">OwnerCount</a>;
02296 
02297     } <span class="keywordflow">else</span> {
02298 
02299         <span class="comment">//</span>
02300         <span class="comment">// If the resource hint is not within range or the resource table</span>
02301         <span class="comment">// entry does not match the current thread, then search the owner</span>
02302         <span class="comment">// table for a match.</span>
02303         <span class="comment">//</span>
02304 
02305         OwnerEntry = <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o1">OwnerTable</a>;
02306         Result = 0;
02307         <span class="keywordflow">if</span> (OwnerEntry != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
02308             <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> = ((<a class="code" href="../../d1/d8/struct__KTHREAD.html">PKTHREAD</a>)(CurrentThread))-&gt;ResourceIndex;
02309             Number = OwnerEntry-&gt;<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o2">TableSize</a>;
02310             <span class="keywordflow">if</span> ((<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> &gt;= Number) ||
02311                 (OwnerEntry[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>].<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o0">OwnerThread</a> != CurrentThread)) {
02312                 <span class="keywordflow">for</span> (<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> = 1; <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> &lt; Number; <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> += 1) {
02313                     OwnerEntry += 1;
02314                     <span class="keywordflow">if</span> (OwnerEntry-&gt;<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o0">OwnerThread</a> == CurrentThread) {
02315                         Result = OwnerEntry-&gt;<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o1">OwnerCount</a>;
02316                         <span class="keywordflow">break</span>;
02317                     }
02318                 }
02319 
02320             } <span class="keywordflow">else</span> {
02321                 Result = OwnerEntry[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>].<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o1">OwnerCount</a>;
02322             }
02323         }
02324     }
02325 
02326     <span class="comment">//</span>
02327     <span class="comment">// Release exclusive access to the specified resource.</span>
02328     <span class="comment">//</span>
02329 
02330     ExReleaseFastLock(&amp;<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o12">SpinLock</a>, OldIrql);
02331     <span class="keywordflow">return</span> Result;
02332 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a318" doxytag="ex.h::ExLocalTimeToSystemTime" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI VOID ExLocalTimeToSystemTime           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PLARGE_INTEGER&nbsp;</td>
          <td class="mdname" nowrap> <em>LocalTime</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT PLARGE_INTEGER&nbsp;</td>
          <td class="mdname" nowrap> <em>SystemTime</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a287" doxytag="ex.h::ExLockHandleTableEntry" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI BOOLEAN ExLockHandleTableEntry           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d6/d3/struct__HANDLE__TABLE.html">PHANDLE_TABLE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>HandleTable</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d7/d3/struct__HANDLE__TABLE__ENTRY.html">PHANDLE_TABLE_ENTRY</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>HandleTableEntry</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l00240">240</a> of file <a class="el" href="../../d1/d7/ex_2handle_8c-source.html">ex/handle.c</a>.
<p>
References <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l00051">Ex10Milliseconds</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00623">Executive</a>, <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l00044">EXHANDLE_TABLE_ENTRY_LOCK_BIT</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02771">_HANDLE_TABLE::HandleContentionEvent</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00624">KernelMode</a>, <a class="el" href="../../d2/d7/hal_8h.html#a206">KeStallExecutionProcessor()</a>, <a class="el" href="../../d2/d6/wait_8c-source.html#l00810">KeWaitForSingleObject()</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02672">_HANDLE_TABLE_ENTRY::Object</a>, <a class="el" href="../../d1/d8/ntosdef_8h-source.html#l00462">PAGED_CODE</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l01315">ExChangeHandle()</a>, <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l01227">ExDestroyHandle()</a>, <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l00765">ExDupHandleTable()</a>, <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l00634">ExEnumHandleTable()</a>, <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l01403">ExMapHandleToPointer()</a>, and <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l00984">ExSnapShotHandleTables()</a>.
<p>
<pre class="fragment"><div>00247                    :
00248 
00249     This routine locks <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified handle table entry.  After <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> entry <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a>
00250     locked <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> sign bit will be set.
00251 
00252 Arguments:
00253 
00254     HandleTable - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> handle table containing <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> entry being locked.
00255 
00256     HandleTableEntry - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> handle table entry being locked.
00257 
00258 Return Value:
00259 
00260     <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> entry <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> valid and locked, and <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a> <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> entry <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a>
00261     marked free.
00262 
00263 --*/
00264 
00265 {
00266     LONG_PTR NewValue;
00267     LONG_PTR CurrentValue;
00268     ULONG LoopCount = 0;
00269 
00270     <a class="code" href="../../d0/d9/ntosdef_8h.html#a28">PAGED_CODE</a>();
00271 
00272     <span class="comment">//</span>
00273     <span class="comment">//  We'll keep on looping reading in the value, making sure it is not null,</span>
00274     <span class="comment">//  and if it is not currently locked we'll try for the lock and return</span>
00275     <span class="comment">//  true if we get it.  Otherwise we'll pause a bit and then try again.</span>
00276     <span class="comment">//</span>
00277 
00278     <span class="keywordflow">while</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>) {
00279 
00280         NewValue =
00281         CurrentValue = *((<span class="keyword">volatile</span> LONG_PTR *)&amp;HandleTableEntry-&gt;<a class="code" href="../../d7/d3/struct__HANDLE__TABLE__ENTRY.html#o0">Object</a>);
00282 
00283         <span class="comment">//</span>
00284         <span class="comment">//  Make sure the handle table entry is not freed</span>
00285         <span class="comment">//</span>
00286 
00287         <span class="keywordflow">if</span> (CurrentValue == 0) {
00288 
00289             <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00290         }
00291 
00292         <span class="comment">//</span>
00293         <span class="comment">//  If the handle value is greater than zero then it is not currently</span>
00294         <span class="comment">//  locked and we should try for the lock, but setting the lock bit and</span>
00295         <span class="comment">//  doing an interlocked exchange.</span>
00296         <span class="comment">//</span>
00297 
00298         <span class="keywordflow">if</span> (CurrentValue &gt; 0) {
00299 
00300             NewValue |= <a class="code" href="../../d0/d8/ex_2handle_8c.html#a0">EXHANDLE_TABLE_ENTRY_LOCK_BIT</a>;
00301 
00302             <span class="keywordflow">if</span> ((LONG_PTR)(InterlockedCompareExchangePointer( &amp;HandleTableEntry-&gt;<a class="code" href="../../d7/d3/struct__HANDLE__TABLE__ENTRY.html#o0">Object</a>,
00303                                                              (PVOID)NewValue,
00304                                                              (PVOID)CurrentValue )) == CurrentValue) {
00305 
00306                 <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00307             }
00308         }
00309 
00310         <span class="comment">//</span>
00311         <span class="comment">//  Either someone already has the entry locked or the value changed</span>
00312         <span class="comment">//  somehow, either way we'll wait a bit and try again.  The first</span>
00313         <span class="comment">//  time we'll wait by spinning for 10us and if that doesn't work</span>
00314         <span class="comment">//  then we'll wait for the handle contention event to go off or</span>
00315         <span class="comment">//  for 10ms, whichever comes first.</span>
00316         <span class="comment">//</span>
00317 
00318         <span class="keywordflow">if</span> (LoopCount++ &lt; 1) {
00319 
00320             <a class="code" href="../../d2/d7/hal_8h.html#a206">KeStallExecutionProcessor</a>( 10 );
00321 
00322         } <span class="keywordflow">else</span> {
00323 
00324             <a class="code" href="../../d1/d7/wait_8c.html#a4">KeWaitForSingleObject</a>( &amp;HandleTable-&gt;<a class="code" href="../../d6/d3/struct__HANDLE__TABLE.html#o9">HandleContentionEvent</a>,
00325                                    Executive,
00326                                    KernelMode,
00327                                    FALSE,
00328                                    &amp;Ex10Milliseconds );
00329         }
00330     }
00331 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a284" doxytag="ex.h::ExLockHandleTableExclusive" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI VOID ExLockHandleTableExclusive           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d6/d3/struct__HANDLE__TABLE.html">PHANDLE_TABLE</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>HandleTable</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l00146">146</a> of file <a class="el" href="../../d1/d7/ex_2handle_8c-source.html">ex/handle.c</a>.
<p>
References <a class="el" href="../../d6/d7/ex_8h-source.html#l02475">ExAcquireResourceExclusive</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02755">_HANDLE_TABLE::HandleTableLock</a>, <a class="el" href="../../d1/d8/ntosdef_8h-source.html#l00462">PAGED_CODE</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, and <a class="el" href="../../d2/d7/hal_8h.html#a212">VOID()</a>.
<p>
Referenced by <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l01144">ExCreateHandle()</a>, <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l01227">ExDestroyHandle()</a>, and <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l00984">ExSnapShotHandleTables()</a>.
<p>
<pre class="fragment"><div>00152                    :
00153 
00154     This routine locks <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified handle table <span class="keywordflow">for</span> exclusive access.  Once
00155     locked <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> onwer can add or <span class="keyword">delete</span> entries from <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> handle table.
00156 
00157 Arguments:
00158 
00159     HandleTable - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> handle table being locked.
00160 
00161 Return Value:
00162 
00163     None.
00164 
00165 --*/
00166 
00167 {
00168     <a class="code" href="../../d0/d9/ntosdef_8h.html#a28">PAGED_CODE</a>();
00169 
00170     (<a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>)<a class="code" href="../../d5/d8/ex_8h.html#a70">ExAcquireResourceExclusive</a>( &amp;HandleTable-&gt;<a class="code" href="../../d6/d3/struct__HANDLE__TABLE.html#o7">HandleTableLock</a>, TRUE );
00171 
00172     <span class="keywordflow">return</span>;
00173 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a283" doxytag="ex.h::ExLockHandleTableShared" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI VOID ExLockHandleTableShared           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d6/d3/struct__HANDLE__TABLE.html">PHANDLE_TABLE</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>HandleTable</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l00114">114</a> of file <a class="el" href="../../d1/d7/ex_2handle_8c-source.html">ex/handle.c</a>.
<p>
References <a class="el" href="../../d6/d7/ex_8h-source.html#l02474">ExAcquireResourceShared</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02755">_HANDLE_TABLE::HandleTableLock</a>, <a class="el" href="../../d1/d8/ntosdef_8h-source.html#l00462">PAGED_CODE</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, and <a class="el" href="../../d2/d7/hal_8h.html#a212">VOID()</a>.
<p>
Referenced by <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l00765">ExDupHandleTable()</a>, and <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l00634">ExEnumHandleTable()</a>.
<p>
<pre class="fragment"><div>00120                    :
00121 
00122     This routine locks <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified handle table <span class="keywordflow">for</span> shared access.  Once
00123     locked <span class="keyword">new</span> entries cannot be added to deleted from <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> handle table.
00124 
00125 Arguments:
00126 
00127     HandleTable - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> handle table being locked.
00128 
00129 Return Value:
00130 
00131     None.
00132 
00133 --*/
00134 
00135 {
00136     <a class="code" href="../../d0/d9/ntosdef_8h.html#a28">PAGED_CODE</a>();
00137 
00138     (<a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>)<a class="code" href="../../d5/d8/ex_8h.html#a69">ExAcquireResourceShared</a>( &amp;HandleTable-&gt;<a class="code" href="../../d6/d3/struct__HANDLE__TABLE.html#o7">HandleTableLock</a>, TRUE );
00139 
00140     <span class="keywordflow">return</span>;
00141 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a226" doxytag="ex.h::ExLockPool" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI KIRQL ExLockPool           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d5/d8/ex_8h.html#a96">POOL_TYPE</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>PoolType</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00506">506</a> of file <a class="el" href="../../d3/d1/ex_2pool_8c-source.html">ex/pool.c</a>.
<p>
References <a class="el" href="../../d7/d6/halmips_8h-source.html#l00086">APC_LEVEL</a>, <a class="el" href="../../d5/d1/pool_8h-source.html#l00050">BASE_POOL_TYPE_MASK</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l02007">KeAcquireSpinLock</a>, <a class="el" href="../../d9/d5/verifier_8c.html#a116">KeRaiseIrql()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00624">KernelMode</a>, <a class="el" href="../../d2/d6/wait_8c-source.html#l00810">KeWaitForSingleObject()</a>, <a class="el" href="../../d5/d1/pool_8h-source.html#l00125">_POOL_DESCRIPTOR::LockAddress</a>, <a class="el" href="../../d5/d8/ex_8h.html#a329a173">NonPagedPool</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00440">NonPagedPoolDescriptor</a>, <a class="el" href="../../d5/d8/ex_8h.html#a329a175">NonPagedPoolMustSucceed</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d5/d8/ex_8h.html#a329a174">PagedPool</a>, <a class="el" href="../../d4/d9/ke_8h.html#a407a201">PoolAllocation</a>, and <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00451">PoolVector</a>.
<p>
Referenced by <a class="el" href="../../d2/d5/allocpag_8c-source.html#l04569">MiFindContiguousMemory()</a>.
<p>
<pre class="fragment"><div>00512                    :
00513 
00514     This function locks <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a> specified by <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a> <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a>.
00515 
00516 Arguments:
00517 
00518     PoolType - Specifies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a> that should be locked.
00519 
00520 Return Value:
00521 
00522     The previous IRQL <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned as <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> function value.
00523 
00524 --*/
00525 
00526 {
00527 
00528     KIRQL OldIrql;
00529 
00530     <span class="comment">//</span>
00531     <span class="comment">// If the pool type is nonpaged, then use a spinlock to lock the</span>
00532     <span class="comment">// pool. Otherwise, use a fast mutex to lock the pool.</span>
00533     <span class="comment">//</span>
00534 
00535     <span class="keywordflow">if</span> ((PoolType &amp; <a class="code" href="../../d4/d2/pool_8h.html#a5">BASE_POOL_TYPE_MASK</a>) == <a class="code" href="../../d5/d8/ex_8h.html#a329a173">NonPagedPool</a>) {
00536         ExAcquireSpinLock(<a class="code" href="../../d2/d2/ex_2pool_8c.html#a52">NonPagedPoolDescriptor</a>.<a class="code" href="../../d4/d8/struct__POOL__DESCRIPTOR.html#o3">LockAddress</a>, &amp;OldIrql);
00537 
00538     } <span class="keywordflow">else</span> {
00539         ExAcquireFastMutex((<a class="code" href="../../d6/d9/struct__FAST__MUTEX.html">PFAST_MUTEX</a>)PoolVector[PagedPool]-&gt;LockAddress);
00540         OldIrql = (KIRQL)((<a class="code" href="../../d6/d9/struct__FAST__MUTEX.html">PFAST_MUTEX</a>)(<a class="code" href="../../d2/d2/ex_2pool_8c.html#a54">PoolVector</a>[<a class="code" href="../../d5/d8/ex_8h.html#a329a174">PagedPool</a>]-&gt;<a class="code" href="../../d4/d8/struct__POOL__DESCRIPTOR.html#o3">LockAddress</a>))-&gt;OldIrql;
00541     }
00542 
00543     <span class="keywordflow">return</span> OldIrql;
00544 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a256" doxytag="ex.h::ExLockUserBuffer" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI PVOID ExLockUserBuffer           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>Buffer</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Length</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT PVOID *&nbsp;</td>
          <td class="mdname" nowrap> <em>LockVariable</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l02995">2995</a> of file <a class="el" href="../../d7/d7/sysinfo_8c-source.html">sysinfo.c</a>.
<p>
References <a class="el" href="../../d7/d1/rtqkey_8c-source.html#l00042">Buffer</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l00265">ExAllocatePoolWithQuotaTag</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00055">EXCEPTION_EXECUTE_HANDLER</a>, <a class="el" href="../../d7/d2/cmwraper_8c-source.html#l00304">ExFreePool()</a>, <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l03048">ExUnlockUserBuffer()</a>, <a class="el" href="../../d2/d1/mm_8h.html#a344a169">IoWriteAccess</a>, <a class="el" href="../../d1/d8/ntosdef_8h-source.html#l00437">MDL_MAPPING_CAN_FAIL</a>, <a class="el" href="../../d1/d8/ntosdef_8h-source.html#l00416">_MDL::MdlFlags</a>, <a class="el" href="../../d3/d0/mm_8h-source.html#l01874">MmGetSystemAddressForMdl</a>, <a class="el" href="../../d3/d0/mm_8h-source.html#l01789">MmInitializeMdl</a>, <a class="el" href="../../d6/d5/iosup_8c-source.html#l00238">MmProbeAndLockPages()</a>, <a class="el" href="../../d6/d5/iosup_8c-source.html#l05815">MmSizeOfMdl()</a>, <a class="el" href="../../d5/d8/ex_8h.html#a329a173">NonPagedPool</a>, and <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>.
<p>
Referenced by <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l03939">ExpGetHandleInformation()</a>, <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l03579">ExpGetLockInformation()</a>, <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l03661">ExpGetLookasideInformation()</a>, <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l04019">ExpGetObjectInformation()</a>, <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l03846">ExpGetPoolInformation()</a>, and <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l03060">ExpGetProcessInformation()</a>.
<p>
<pre class="fragment"><div>03001 {
03002     <a class="code" href="../../d6/d7/struct__MDL.html">PMDL</a> Mdl;
03003     PVOID Address;
03004     SIZE_T MdlSize;
03005 
03006     <span class="comment">//</span>
03007     <span class="comment">// Allocate an MDL to map the request.</span>
03008     <span class="comment">//</span>
03009 
03010     MdlSize = <a class="code" href="../../d5/d6/iosup_8c.html#a72">MmSizeOfMdl</a>( Buffer, Length );
03011     Mdl = <a class="code" href="../../d5/d8/ex_8h.html#a5">ExAllocatePoolWithQuotaTag</a> (NonPagedPool,
03012                                       MdlSize,
03013                                       'ofnI');
03014     <span class="keywordflow">if</span> (Mdl == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
03015         <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
03016     }
03017 
03018     <span class="comment">//</span>
03019     <span class="comment">// Initialize MDL for request.</span>
03020     <span class="comment">//</span>
03021 
03022     <a class="code" href="../../d2/d1/mm_8h.html#a24">MmInitializeMdl</a>(Mdl, Buffer, Length);
03023 
03024     <span class="keywordflow">try</span> {
03025 
03026         <a class="code" href="../../d5/d6/iosup_8c.html#a41">MmProbeAndLockPages</a> (Mdl, KeGetPreviousMode(), IoWriteAccess);
03027 
03028     } except (EXCEPTION_EXECUTE_HANDLER) {
03029 
03030         <a class="code" href="../../d5/d8/ex_8h.html#a224">ExFreePool</a> (Mdl);
03031 
03032         <span class="keywordflow">return</span>( <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> );
03033     }
03034 
03035     Mdl-&gt;<a class="code" href="../../d6/d7/struct__MDL.html#o2">MdlFlags</a> |= <a class="code" href="../../d0/d9/ntosdef_8h.html#a25">MDL_MAPPING_CAN_FAIL</a>;
03036     Address =  <a class="code" href="../../d2/d1/mm_8h.html#a26">MmGetSystemAddressForMdl</a> (Mdl);
03037     *LockVariable = Mdl;
03038     <span class="keywordflow">if</span> (Address == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
03039         <a class="code" href="../../d5/d8/ex_8h.html#a257">ExUnlockUserBuffer</a> (Mdl);
03040         *LockVariable = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
03041     }
03042 
03043     <span class="keywordflow">return</span> Address;
03044 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a300" doxytag="ex.h::ExLuidInitialization" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI BOOLEAN ExLuidInitialization           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d7/luid_8c-source.html#l00037">37</a> of file <a class="el" href="../../d1/d7/luid_8c-source.html">luid.c</a>.
<p>
References <a class="el" href="../../d1/d7/luid_8c-source.html#l00027">ExpLuid</a>, <a class="el" href="../../d1/d7/luid_8c-source.html#l00028">ExpLuidIncrement</a>, <a class="el" href="../../d5/d3/alpha_2splocks_8c-source.html#l00041">ExpLuidLock</a>, <a class="el" href="../../d4/d9/ke_8h.html#a354">KeInitializeSpinLock()</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d0/d5/seinit_8c-source.html#l00078">SepInitializationPhase0()</a>.
<p>
<pre class="fragment"><div>00043                    :
00044 
00045     This function initializes <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> locally unique identifier allocation.
00046 
00047     NOTE:  THE LUID ALLOCATION SERVICES ARE NEEDED BY SECURITY IN PHASE 0
00048            SYSTEM INITIALIZATION.  FOR THIS REASON, LUID INITIALIZATION IS
00049            PERFORMED AS PART OF PHASE 0 SECURITY INITIALIZATION.
00050 
00051 Arguments:
00052 
00053     None.
00054 
00055 Return Value:
00056 
00057     <a class="code" href="../../d2/d1/bench_8h.html#a5">A</a> value of <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> initialization <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> successfully
00058     completed.  Otherwise, a value of <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned.
00059 
00060 --*/
00061 
00062 {
00063 
00064     <span class="comment">//</span>
00065     <span class="comment">// Initialize the LUID source value.</span>
00066     <span class="comment">//</span>
00067     <span class="comment">// The first 1000 values are reserved for static definition. This</span>
00068     <span class="comment">// value can be increased with later releases with no adverse impact.</span>
00069     <span class="comment">//</span>
00070     <span class="comment">// N.B. The LUID source always refers to the "next" allocatable LUID.</span>
00071     <span class="comment">//</span>
00072 
00073     <a class="code" href="../../d0/d8/luid_8c.html#a0">ExpLuid</a>.LowPart = 1001;
00074     <a class="code" href="../../d0/d8/luid_8c.html#a0">ExpLuid</a>.HighPart = 0;
00075     <a class="code" href="../../d4/d9/ke_8h.html#a354">KeInitializeSpinLock</a>(&amp;ExpLuidLock);
00076     <a class="code" href="../../d0/d8/luid_8c.html#a1">ExpLuidIncrement</a>.QuadPart = 1;
00077     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00078 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a299" doxytag="ex.h::ExMapHandleToPointer" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI <a class="el" href="../../d7/d3/struct__HANDLE__TABLE__ENTRY.html">PHANDLE_TABLE_ENTRY</a> ExMapHandleToPointer           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d6/d3/struct__HANDLE__TABLE.html">PHANDLE_TABLE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>HandleTable</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN HANDLE&nbsp;</td>
          <td class="mdname" nowrap> <em>Handle</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l01403">1403</a> of file <a class="el" href="../../d1/d7/ex_2handle_8c-source.html">ex/handle.c</a>.
<p>
References <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l00240">ExLockHandleTableEntry()</a>, <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l02195">ExpLookupHandleTableEntry()</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02630">_EXHANDLE::GenericHandleOverlay</a>, <a class="el" href="../../d8/d9/cmdat2_8c-source.html#l00091">Handle</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, and <a class="el" href="../../d1/d8/ntosdef_8h-source.html#l00462">PAGED_CODE</a>.
<p>
Referenced by <a class="el" href="../../d5/d9/tex_8c-source.html#l01160">DoHandleTest()</a>, <a class="el" href="../../d6/d9/obclose_8c-source.html#l00037">NtClose()</a>, <a class="el" href="../../d2/d1/obwait_8c-source.html#l00406">NtWaitForMultipleObjects()</a>, <a class="el" href="../../d7/d0/obquery_8c-source.html#l01319">ObQueryObjectAuditingByHandle()</a>, <a class="el" href="../../d8/d0/obref_8c-source.html#l00542">ObReferenceObjectByHandle()</a>, <a class="el" href="../../d2/d9/pscid_8c-source.html#l00094">PsLookupProcessByProcessId()</a>, <a class="el" href="../../d2/d9/pscid_8c-source.html#l00027">PsLookupProcessThreadByCid()</a>, <a class="el" href="../../d2/d9/pscid_8c-source.html#l00146">PsLookupThreadByThreadId()</a>, and <a class="el" href="../../d1/d9/rtl_2atom_8c-source.html#l00152">RtlpAtomMapAtomToHandleEntry()</a>.
<p>
<pre class="fragment"><div>01410                    :
01411 
01412     This function maps a handle to a pointer to a handle table entry. If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
01413     map operation <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> successful then <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> handle table entry <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> locked when
01414     we <span class="keywordflow">return</span>.
01415 
01416 Arguments:
01417 
01418     HandleTable - Supplies a pointer to a handle table.
01419 
01420     <a class="code" href="../../d7/d0/cmdat2_8c.html#a19">Handle</a> - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> handle to be mapped to a handle entry.
01421 
01422 Return Value:
01423 
01424     If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> handle was successfully mapped to a pointer to a handle entry,
01425     then <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> address of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> handle table entry <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned as <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> function
01426     value with <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> entry locked. Otherwise, a value of <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned.
01427 
01428 --*/
01429 
01430 {
01431     <a class="code" href="../../d7/d8/struct__EXHANDLE.html">EXHANDLE</a> LocalHandle;
01432 
01433     <a class="code" href="../../d7/d3/struct__HANDLE__TABLE__ENTRY.html">PHANDLE_TABLE_ENTRY</a> HandleTableEntry;
01434 
01435     <a class="code" href="../../d0/d9/ntosdef_8h.html#a28">PAGED_CODE</a>();
01436 
01437     LocalHandle.<a class="code" href="../../d7/d8/struct__EXHANDLE.html#o2">GenericHandleOverlay</a> = <a class="code" href="../../d7/d0/cmdat2_8c.html#a19">Handle</a>;
01438 
01439     <span class="comment">//</span>
01440     <span class="comment">//  Translate the input handle to a handle table entry and make</span>
01441     <span class="comment">//  sure it is a valid handle.</span>
01442     <span class="comment">//</span>
01443 
01444     HandleTableEntry = <a class="code" href="../../d0/d8/ex_2handle_8c.html#a8">ExpLookupHandleTableEntry</a>( HandleTable,
01445                                                   LocalHandle );
01446 
01447     <span class="keywordflow">if</span> (HandleTableEntry == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01448 
01449         <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01450     }
01451 
01452     <span class="comment">//</span>
01453     <span class="comment">//  Try and lock the handle table entry,  If this fails then that's</span>
01454     <span class="comment">//  because someone freed the handle</span>
01455     <span class="comment">//</span>
01456 
01457     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d8/ex_8h.html#a287">ExLockHandleTableEntry</a>( HandleTable, HandleTableEntry )) {
01458 
01459         <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01460     }
01461 
01462     <span class="comment">//</span>
01463     <span class="comment">//  Return the locked valid handle table entry</span>
01464     <span class="comment">//</span>
01465 
01466     <span class="keywordflow">return</span> HandleTableEntry;
01467 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a323" doxytag="ex.h::ExNotifyCallback" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI VOID ExNotifyCallback           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>CallbackObject</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>Argument1</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>Argument2</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a228" doxytag="ex.h::ExQueryPoolBlockSize" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI ULONG ExQueryPoolBlockSize           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>PoolBlock</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT PBOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>QuotaCharged</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l03328">3328</a> of file <a class="el" href="../../d3/d1/ex_2pool_8c-source.html">ex/pool.c</a>.
<p>
References <a class="el" href="../../d5/d1/pool_8h-source.html#l00171">_POOL_HEADER::BlockSize</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d2/d5/allocpag_8c-source.html#l02927">MmQuerySpecialPoolBlockSize()</a>, <a class="el" href="../../d3/d0/mm_8h-source.html#l01977">MmSpecialPoolEnd</a>, <a class="el" href="../../d3/d0/mm_8h-source.html#l01976">MmSpecialPoolStart</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d6/d1/poolhack_8c-source.html#l00071">PAGE_ALIGNED</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00599">PAGE_SIZE</a>, <a class="el" href="../../d5/d1/pool_8h-source.html#l00096">POOL_BLOCK_SHIFT</a>, <a class="el" href="../../d6/d1/poolhack_8c-source.html#l00116">POOL_OVERHEAD</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00352">PoolTrackTable</a>, and <a class="el" href="../../d6/d1/poolhack_8c-source.html#l00112">_POOL_HEADER::ProcessBilled</a>.
<p>
Referenced by <a class="el" href="../../d5/d7/handtabl_8c-source.html#l00828">HMAllocObject()</a>, and <a class="el" href="../../d5/d7/handtabl_8c-source.html#l01069">HMFreeObject()</a>.
<p>
<pre class="fragment"><div>03335                    :
03336 
03337     This function returns <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> size of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a> block.
03338 
03339 Arguments:
03340 
03341     PoolBlock - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> address of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> block of <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a>.
03342 
03343     QuotaCharged - Supplies a BOOLEAN variable to receive whether or not <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
03344         <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a> block had quota charged.
03345 
03346     NOTE: If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> entry <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> bigger than a page, <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> value <a class="code" href="../../d6/d7/halmips_8h.html#a446">PAGE_SIZE</a> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned
03347           rather than <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> correct number of bytes.
03348 
03349 Return Value:
03350 
03351     <a class="code" href="../../d8/d7/lh__open_2pi__mem_8h.html#a0">Size</a> of <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a> block.
03352 
03353 --*/
03354 
03355 {
03356     <a class="code" href="../../d5/d8/struct__POOL__HEADER.html">PPOOL_HEADER</a> Entry;
03357     ULONG size;
03358 
03359     <span class="keywordflow">if</span> ((PoolBlock &gt;= <a class="code" href="../../d2/d1/mm_8h.html#a160">MmSpecialPoolStart</a>) &amp;&amp; (PoolBlock &lt; <a class="code" href="../../d2/d1/mm_8h.html#a161">MmSpecialPoolEnd</a>)) {
03360         *QuotaCharged = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
03361         <span class="keywordflow">return</span> (ULONG)<a class="code" href="../../d1/d6/allocpag_8c.html#a57">MmQuerySpecialPoolBlockSize</a> (PoolBlock);
03362     }
03363 
03364     <span class="keywordflow">if</span> (<a class="code" href="../../d5/d2/poolhack_8c.html#a5">PAGE_ALIGNED</a>(PoolBlock)) {
03365         *QuotaCharged = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
03366         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a446">PAGE_SIZE</a>;
03367     }
03368 
03369 <span class="preprocessor">#if POOL_CACHE_SUPPORTED</span>
03370 <span class="preprocessor"></span>
03371     <span class="comment">//</span>
03372     <span class="comment">// Align entry on pool allocation boundary.</span>
03373     <span class="comment">//</span>
03374 
03375     <span class="keywordflow">if</span> (((ULONG)PoolBlock &amp; POOL_CACHE_CHECK) == 0) {
03376         Entry = (<a class="code" href="../../d5/d8/struct__POOL__HEADER.html">PPOOL_HEADER</a>)((ULONG)PoolBlock - PoolCacheSize);
03377         size = (Entry-&gt;<a class="code" href="../../d5/d8/struct__POOL__HEADER.html#o6">BlockSize</a> &lt;&lt; <a class="code" href="../../d4/d2/pool_8h.html#a14">POOL_BLOCK_SHIFT</a>) - PoolCacheSize;
03378 
03379     } <span class="keywordflow">else</span> {
03380         Entry = (<a class="code" href="../../d5/d8/struct__POOL__HEADER.html">PPOOL_HEADER</a>)((PCHAR)PoolBlock - <a class="code" href="../../d5/d2/poolhack_8c.html#a6">POOL_OVERHEAD</a>);
03381         size = (Entry-&gt;<a class="code" href="../../d5/d8/struct__POOL__HEADER.html#o6">BlockSize</a> &lt;&lt; <a class="code" href="../../d4/d2/pool_8h.html#a14">POOL_BLOCK_SHIFT</a>) - <a class="code" href="../../d5/d2/poolhack_8c.html#a6">POOL_OVERHEAD</a>;
03382     }
03383 
03384 <span class="preprocessor">#else</span>
03385 <span class="preprocessor"></span>
03386     Entry = (<a class="code" href="../../d5/d8/struct__POOL__HEADER.html">PPOOL_HEADER</a>)((PCHAR)PoolBlock - <a class="code" href="../../d5/d2/poolhack_8c.html#a6">POOL_OVERHEAD</a>);
03387     size = (ULONG)((Entry-&gt;<a class="code" href="../../d5/d8/struct__POOL__HEADER.html#o6">BlockSize</a> &lt;&lt; <a class="code" href="../../d4/d2/pool_8h.html#a14">POOL_BLOCK_SHIFT</a>) - <a class="code" href="../../d5/d2/poolhack_8c.html#a6">POOL_OVERHEAD</a>);
03388 
03389 <span class="preprocessor">#endif //POOL_CACHE_SUPPORTED</span>
03390 <span class="preprocessor"></span>
03391 <span class="preprocessor">#ifdef _WIN64</span>
03392 <span class="preprocessor"></span>    *QuotaCharged = (BOOLEAN) (Entry-&gt;<a class="code" href="../../d5/d8/struct__POOL__HEADER.html#o2">ProcessBilled</a> != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>);
03393 <span class="preprocessor">#else</span>
03394 <span class="preprocessor"></span>    <span class="keywordflow">if</span> ( <a class="code" href="../../d2/d2/ex_2pool_8c.html#a42">PoolTrackTable</a> ) {
03395         *QuotaCharged = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
03396     }
03397     <span class="keywordflow">else</span> {
03398         *QuotaCharged = (BOOLEAN) (Entry-&gt;<a class="code" href="../../d5/d8/struct__POOL__HEADER.html#o2">ProcessBilled</a> != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>);
03399     }
03400 <span class="preprocessor">#endif</span>
03401 <span class="preprocessor"></span>    <span class="keywordflow">return</span> size;
03402 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a229" doxytag="ex.h::ExQueryPoolUsage" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI VOID ExQueryPoolUsage           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">OUT PULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>PagedPoolPages</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT PULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>NonPagedPoolPages</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT PULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>PagedPoolAllocs</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT PULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>PagedPoolFrees</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT PULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>PagedPoolLookasideHits</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT PULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>NonPagedPoolAllocs</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT PULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>NonPagedPoolFrees</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT PULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>NonPagedPoolLookasideHits</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l03405">3405</a> of file <a class="el" href="../../d3/d1/ex_2pool_8c-source.html">ex/pool.c</a>.
<p>
References <a class="el" href="../../d6/d7/ex_8h-source.html#l00730">_GENERAL_LOOKASIDE::AllocateHits</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00429">ExpNumberOfPagedPools</a>, <a class="el" href="../../d5/d9/exp_8h-source.html#l00266">ExPoolLookasideListHead</a>, <a class="el" href="../../d2/d9/cmchek_8c-source.html#l00095">Index</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l00755">_NPAGED_LOOKASIDE_LIST::L</a>, <a class="el" href="../../d3/d9/aw_8h-source.html#l00031">L</a>, <a class="el" href="../../d5/d8/ex_8h.html#a329a173">NonPagedPool</a>, <a class="el" href="../../d5/d8/ex_8h.html#a329a175">NonPagedPoolMustSucceed</a>, <a class="el" href="../../d5/d8/ex_8h.html#a329a174">PagedPool</a>, <a class="el" href="../../d4/d7/aug98_2test_2main_8c-source.html#l00106">pd</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00451">PoolVector</a>, and <a class="el" href="../../d6/d7/ex_8h-source.html#l00739">_GENERAL_LOOKASIDE::Type</a>.
<p>
Referenced by <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l00941">NtQuerySystemInformation()</a>.
<p>
<pre class="fragment"><div>03416 {
03417     ULONG <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>;
03418     <a class="code" href="../../d1/d4/struct__NPAGED__LOOKASIDE__LIST.html">PNPAGED_LOOKASIDE_LIST</a> Lookaside;
03419     PLIST_ENTRY NextEntry;
03420     <a class="code" href="../../d4/d8/struct__POOL__DESCRIPTOR.html">PPOOL_DESCRIPTOR</a> <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a26">pd</a>;
03421 
03422     <span class="comment">//</span>
03423     <span class="comment">// Sum all the paged pool usage.</span>
03424     <span class="comment">//</span>
03425 
03426     <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a26">pd</a> = <a class="code" href="../../d2/d2/ex_2pool_8c.html#a54">PoolVector</a>[<a class="code" href="../../d5/d8/ex_8h.html#a329a174">PagedPool</a>];
03427     *PagedPoolPages = 0;
03428     *PagedPoolAllocs = 0;
03429     *PagedPoolFrees = 0;
03430 
03431     <span class="keywordflow">for</span> (<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> = 0; <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> &lt; <a class="code" href="../../d2/d2/ex_2pool_8c.html#a51">ExpNumberOfPagedPools</a> + 1; <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> += 1) {
03432         *PagedPoolPages += <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a26">pd</a>[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>].TotalPages + <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a26">pd</a>[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>].TotalBigPages;
03433         *PagedPoolAllocs += <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a26">pd</a>[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>].RunningAllocs;
03434         *PagedPoolFrees += <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a26">pd</a>[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>].RunningDeAllocs;
03435     }
03436 
03437     <span class="comment">//</span>
03438     <span class="comment">// Sum all the nonpaged pool usage.</span>
03439     <span class="comment">//</span>
03440 
03441     <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a26">pd</a> = <a class="code" href="../../d2/d2/ex_2pool_8c.html#a54">PoolVector</a>[<a class="code" href="../../d5/d8/ex_8h.html#a329a173">NonPagedPool</a>];
03442     *NonPagedPoolPages = <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a26">pd</a>-&gt;TotalPages + <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a26">pd</a>-&gt;TotalBigPages;
03443     *NonPagedPoolAllocs = <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a26">pd</a>-&gt;RunningAllocs;
03444     *NonPagedPoolFrees = <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a26">pd</a>-&gt;RunningDeAllocs;
03445 
03446     <span class="comment">//</span>
03447     <span class="comment">// Sum all the nonpaged must succeed usage.</span>
03448     <span class="comment">//</span>
03449 
03450     <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a26">pd</a> = <a class="code" href="../../d2/d2/ex_2pool_8c.html#a54">PoolVector</a>[<a class="code" href="../../d5/d8/ex_8h.html#a329a175">NonPagedPoolMustSucceed</a>];
03451     *NonPagedPoolPages += <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a26">pd</a>-&gt;TotalPages + <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a26">pd</a>-&gt;TotalBigPages;
03452     *NonPagedPoolAllocs += <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a26">pd</a>-&gt;RunningAllocs;
03453     *NonPagedPoolFrees += <a class="code" href="../../d3/d8/aug98_2test_2main_8c.html#a26">pd</a>-&gt;RunningDeAllocs;
03454 
03455     <span class="comment">//</span>
03456     <span class="comment">// Sum all the lookaside hits for paged and nonpaged pool.</span>
03457     <span class="comment">//</span>
03458 
03459     NextEntry = <a class="code" href="../../d4/d0/exp_8h.html#a17">ExPoolLookasideListHead</a>.Flink;
03460     <span class="keywordflow">while</span> (NextEntry != &amp;<a class="code" href="../../d4/d0/exp_8h.html#a17">ExPoolLookasideListHead</a>) {
03461         Lookaside = CONTAINING_RECORD(NextEntry,
03462                                       <a class="code" href="../../d1/d4/struct__NPAGED__LOOKASIDE__LIST.html">NPAGED_LOOKASIDE_LIST</a>,
03463                                       <a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>.ListEntry);
03464 
03465         <span class="keywordflow">if</span> (Lookaside-&gt;<a class="code" href="../../d1/d4/struct__NPAGED__LOOKASIDE__LIST.html#o0">L</a>.<a class="code" href="../../d6/d1/struct__GENERAL__LOOKASIDE.html#o9">Type</a> == <a class="code" href="../../d5/d8/ex_8h.html#a329a173">NonPagedPool</a>) {
03466             *NonPagedPoolLookasideHits += Lookaside-&gt;<a class="code" href="../../d1/d4/struct__NPAGED__LOOKASIDE__LIST.html#o0">L</a>.<a class="code" href="../../d6/d1/struct__GENERAL__LOOKASIDE.html#o5">AllocateHits</a>;
03467 
03468         } <span class="keywordflow">else</span> {
03469             *PagedPoolLookasideHits += Lookaside-&gt;<a class="code" href="../../d1/d4/struct__NPAGED__LOOKASIDE__LIST.html#o0">L</a>.<a class="code" href="../../d6/d1/struct__GENERAL__LOOKASIDE.html#o5">AllocateHits</a>;
03470         }
03471 
03472         NextEntry = NextEntry-&gt;Flink;
03473     }
03474 
03475     <span class="keywordflow">return</span>;
03476 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a261" doxytag="ex.h::ExQueueWorkItem" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI VOID ExQueueWorkItem           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d7/d9/struct__WORK__QUEUE__ITEM.html">PWORK_QUEUE_ITEM</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>WorkItem</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d5/d8/ex_8h.html#a110">WORK_QUEUE_TYPE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>QueueType</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d8/worker_8c-source.html#l00375">375</a> of file <a class="el" href="../../d2/d8/worker_8c-source.html">worker.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d2/d8/worker_8c-source.html#l00159">ExpNewThreadNecessary()</a>, <a class="el" href="../../d2/d8/worker_8c-source.html#l00102">ExThreadSetManagerEvent</a>, <a class="el" href="../../d2/d8/worker_8c-source.html#l00086">ExWorkerQueue</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d9/d2/queueobj_8c-source.html#l00124">KeInsertQueue()</a>, <a class="el" href="../../d3/d7/eventobj_8c-source.html#l00343">KeSetEvent()</a>, <a class="el" href="../../d5/d8/ex_8h.html#a332a208">MaximumWorkQueue</a>, and <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>.
<p>
Referenced by <a class="el" href="../../d6/d0/lazyrite_8c-source.html#l00662">CcPostWorkQueue()</a>, <a class="el" href="../../d6/d0/cmgquota_8c-source.html#l00204">CmpClaimGlobalQuota()</a>, <a class="el" href="../../d6/d2/cmworker_8c-source.html#l00556">CmpDiskFullWarning()</a>, <a class="el" href="../../d6/d2/cmworker_8c-source.html#l00416">CmpLazyFlushDpcRoutine()</a>, <a class="el" href="../../d1/d1/cmnotify_8c-source.html#l00487">CmpPostNotify()</a>, <a class="el" href="../../d4/d9/pnpdel_8c-source.html#l00084">IopChainDereferenceComplete()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l00657">IopCompleteUnloadOrDelete()</a>, <a class="el" href="../../d1/d0/pnpirp_8c-source.html#l00896">IopDeviceEjectComplete()</a>, <a class="el" href="../../d1/d0/pnpirp_8c-source.html#l00730">IopEjectDevice()</a>, <a class="el" href="../../d8/d6/errorlog_8c-source.html#l00660">IopErrorLogDpc()</a>, <a class="el" href="../../d7/d9/pnpenum_8c-source.html#l05034">IopProcessNewProfile()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l06327">IopQueueDeviceWorkItem()</a>, <a class="el" href="../../d7/d9/pnpenum_8c-source.html#l00207">IopRequestDeviceAction()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l06127">IopSendMessageToTrackService()</a>, <a class="el" href="../../d2/d9/io_2misc_8c-source.html#l00953">IoQueueWorkItem()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l08769">IoRaiseHardError()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l08909">IoRaiseInformationalHardError()</a>, <a class="el" href="../../d9/d9/pnpioapi_8c-source.html#l06118">IoReportTargetDeviceChangeAsynchronous()</a>, <a class="el" href="../../d9/d3/trackirp_8c-source.html#l02555">IovpInternalDeferredCompletion()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l11556">IoWriteErrorLogEntry()</a>, <a class="el" href="../../d9/d2/kdapi_8c-source.html#l00494">KdpTimeSlipDpcRoutine()</a>, <a class="el" href="../../d0/d8/mips_2kdtrap_8c-source.html#l00079">KdpTrap()</a>, <a class="el" href="../../d7/d2/modwrite_8c-source.html#l01095">MiCheckForCrashDump()</a>, <a class="el" href="../../d9/d3/loadunld_8c-source.html#l00035">NtLoadDriver()</a>, <a class="el" href="../../d9/d3/loadunld_8c-source.html#l00244">NtUnloadDriver()</a>, <a class="el" href="../../d8/d0/obref_8c-source.html#l01124">ObfDereferenceObject()</a>, <a class="el" href="../../d0/d9/rmlogon_8c-source.html#l01049">SepInformFileSystemsOfDeletedLogon()</a>, <a class="el" href="../../d1/d4/adtlog_8c-source.html#l00600">SepQueueWorkItem()</a>, <a class="el" href="../../d5/d8/smbtrsup_8c-source.html#l01794">SmbTraceDereferenceHeap()</a>, <a class="el" href="../../d3/d8/workque_8c-source.html#l00316">UdfAddToWorkque()</a>, and <a class="el" href="../../d3/d8/close_8c-source.html#l00634">UdfQueueClose()</a>.
<p>
<pre class="fragment"><div>00382                    :
00383 
00384     This function inserts a work item into a work queue that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> processed
00385     by a worker thread of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> corresponding <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a>.
00386 
00387 Arguments:
00388 
00389     WorkItem - Supplies a pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> work item to add <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> queue.
00390         This structure must be located in <a class="code" href="../../d5/d8/ex_8h.html#a329a173">NonPagedPool</a>. The work item
00391         structure contains a doubly linked list entry, <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> address of a
00392         routine to call and a parameter to pass to that routine.
00393 
00394     QueueType - Specifies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> of work queue that <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> work item
00395         should be placed in.
00396 
00397 Return Value:
00398 
00399     None
00400 
00401 --*/
00402 
00403 {
00404 
00405     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(QueueType &lt; MaximumWorkQueue);
00406     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(WorkItem-&gt;List.Flink == NULL);
00407 
00408     <span class="comment">//</span>
00409     <span class="comment">// Insert the work item in the appropriate queue object.</span>
00410     <span class="comment">//</span>
00411 
00412     <a class="code" href="../../d8/d3/queueobj_8c.html#a3">KeInsertQueue</a>(&amp;ExWorkerQueue[QueueType].WorkerQueue, &amp;WorkItem-&gt;List);
00413 
00414     <span class="comment">//</span>
00415     <span class="comment">// Determine whether another thread should be created, and signal the</span>
00416     <span class="comment">// thread set balance manager if so.</span>
00417     <span class="comment">//</span>
00418 
00419     <span class="keywordflow">if</span> (<a class="code" href="../../d1/d9/worker_8c.html#a28">ExpNewThreadNecessary</a>(QueueType) != <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
00420         
00421         <a class="code" href="../../d2/d8/eventobj_8c.html#a8">KeSetEvent</a>( &amp;ExThreadSetManagerEvent,
00422                     0,
00423                     FALSE );
00424     }
00425 
00426     <span class="keywordflow">return</span>;
00427 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a305" doxytag="ex.h::ExRaiseAccessViolation" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI VOID ExRaiseAccessViolation           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d3/raise_8c-source.html#l00044">44</a> of file <a class="el" href="../../d0/d3/raise_8c-source.html">raise.c</a>.
<p>
References <a class="el" href="../../d1/d3/ex_2alpha_2raisests_8c-source.html#l00157">ExRaiseStatus()</a>.
<p>
Referenced by <a class="el" href="../../d0/d4/probe_8c-source.html#l00148">ProbeForRead()</a>, and <a class="el" href="../../d0/d4/probe_8c-source.html#l00034">ProbeForWrite()</a>.
<p>
<pre class="fragment"><div>00050                    :
00051 
00052     This function raises an access violation exception.
00053 
00054 Arguments:
00055 
00056     None.
00057 
00058 Return Value:
00059 
00060     None.
00061 
00062 --*/
00063 
00064 {
00065 
00066     <a class="code" href="../../d5/d8/ex_8h.html#a303">ExRaiseStatus</a>(STATUS_ACCESS_VIOLATION);
00067     <span class="keywordflow">return</span>;
00068 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a304" doxytag="ex.h::ExRaiseDatatypeMisalignment" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI VOID ExRaiseDatatypeMisalignment           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d3/raise_8c-source.html#l00071">71</a> of file <a class="el" href="../../d0/d3/raise_8c-source.html">raise.c</a>.
<p>
References <a class="el" href="../../d1/d3/ex_2alpha_2raisests_8c-source.html#l00157">ExRaiseStatus()</a>.
<p>
Referenced by <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l10687">MESSAGECALL()</a>, <a class="el" href="../../d0/d4/probe_8c-source.html#l00148">ProbeForRead()</a>, <a class="el" href="../../d0/d4/probe_8c-source.html#l00034">ProbeForWrite()</a>, and <a class="el" href="../../d3/d4/se_2capture_8c-source.html#l00053">SeCaptureSecurityDescriptor()</a>.
<p>
<pre class="fragment"><div>00077                    :
00078 
00079     This function raises a datatype misalignment exception.
00080 
00081 Arguments:
00082 
00083     None.
00084 
00085 Return Value:
00086 
00087     None.
00088 
00089 --*/
00090 
00091 {
00092 
00093     <a class="code" href="../../d5/d8/ex_8h.html#a303">ExRaiseStatus</a>(STATUS_DATATYPE_MISALIGNMENT);
00094     <span class="keywordflow">return</span>;
00095 }
}
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a302" doxytag="ex.h::ExRaiseException" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI VOID NTAPI ExRaiseException           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">PEXCEPTION_RECORD&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>ExceptionRecord</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d0/d3/ke_2i386_2vdm_8c-source.html#l00307">Ki386VdmDispatchIo()</a>, <a class="el" href="../../d0/d3/ke_2i386_2vdm_8c-source.html#l00418">Ki386VdmDispatchStringIo()</a>, <a class="el" href="../../d0/d8/i386_2exceptn_8c-source.html#l00970">KiDispatchException()</a>, <a class="el" href="../../d0/d3/ke_2i386_2vdm_8c-source.html#l00882">VdmCallStringIoHandler()</a>, and <a class="el" href="../../d1/d4/vdmnpx_8c-source.html#l00054">VdmDispatchIRQ13()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a306" doxytag="ex.h::ExRaiseHardError" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI NTSTATUS ExRaiseHardError           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN NTSTATUS&nbsp;</td>
          <td class="mdname" nowrap> <em>ErrorStatus</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>NumberOfParameters</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>UnicodeStringParameterMask</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PULONG_PTR&nbsp;</td>
          <td class="mdname" nowrap> <em>Parameters</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>ValidResponseOptions</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT PULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Response</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d7/ex_2harderr_8c-source.html#l00700">700</a> of file <a class="el" href="../../d7/d7/ex_2harderr_8c-source.html">ex/harderr.c</a>.
<p>
References <a class="el" href="../../d7/d1/rtqkey_8c-source.html#l00042">Buffer</a>, <a class="el" href="../../d7/d7/ex_2harderr_8c-source.html#l00349">ExpRaiseHardError()</a>, <a class="el" href="../../d7/d7/ex_2harderr_8c-source.html#l00059">ExpTooLateForErrors</a>, <a class="el" href="../../d6/d5/stierr_8h-source.html#l00030">NT_SUCCESS</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d1/d8/ntosdef_8h-source.html#l00462">PAGED_CODE</a>, and <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00135">Status</a>.
<p>
Referenced by <a class="el" href="../../d6/d2/cmworker_8c-source.html#l00518">CmpDiskFullWarningWorker()</a>, <a class="el" href="../../d2/d2/cmsysini_8c-source.html#l00726">CmpInitializeHiveList()</a>, <a class="el" href="../../d6/d0/cmgquota_8c-source.html#l00166">CmpQuotaWarningWorker()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l02977">IopHardErrorThread()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l05617">IopRaiseHardError()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l05841">IopRaiseInformationalHardError()</a>, <a class="el" href="../../d7/d7/ex_2harderr_8c-source.html#l00532">NtRaiseHardError()</a>, and <a class="el" href="../../d7/d2/queue_8c-source.html#l01501">xxxCreateThreadInfo()</a>.
<p>
<pre class="fragment"><div>00708 {
00709     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
00710     PULONG_PTR ParameterBlock;
00711     PULONG_PTR UserModeParameterBase;
00712     PUNICODE_STRING UserModeStringsBase;
00713     PUCHAR UserModeStringDataBase;
00714     UNICODE_STRING CapturedStrings[MAXIMUM_HARDERROR_PARAMETERS];
00715     ULONG LocalResponse;
00716     ULONG Counter;
00717     SIZE_T UserModeSize;
00718 
00719     <a class="code" href="../../d0/d9/ntosdef_8h.html#a28">PAGED_CODE</a>();
00720 
00721     <span class="comment">//</span>
00722     <span class="comment">//  If we are in the process of shuting down the system, do not allow</span>
00723     <span class="comment">//  hard errors.</span>
00724     <span class="comment">//</span>
00725 
00726     <span class="keywordflow">if</span> ( <a class="code" href="../../d6/d8/ex_2harderr_8c.html#a6">ExpTooLateForErrors</a> ) {
00727 
00728         *Response = ResponseNotHandled;
00729 
00730         <span class="keywordflow">return</span> STATUS_SUCCESS;
00731     }
00732 
00733     <span class="comment">//</span>
00734     <span class="comment">// If the parameters contain strings, we need to capture</span>
00735     <span class="comment">// the strings and the string descriptors and push them into</span>
00736     <span class="comment">// user-mode.</span>
00737     <span class="comment">//</span>
00738 
00739     <span class="keywordflow">if</span> ( ARGUMENT_PRESENT(Parameters) ) {
00740         <span class="keywordflow">if</span> ( UnicodeStringParameterMask ) {
00741 
00742             <span class="comment">//</span>
00743             <span class="comment">// We have strings. The parameter block and all strings</span>
00744             <span class="comment">// must be pushed into usermode.</span>
00745             <span class="comment">//</span>
00746 
00747             UserModeSize = (<span class="keyword">sizeof</span>(ULONG_PTR)+<span class="keyword">sizeof</span>(UNICODE_STRING))*MAXIMUM_HARDERROR_PARAMETERS;
00748             UserModeSize += <span class="keyword">sizeof</span>(UNICODE_STRING);
00749 
00750             <span class="keywordflow">for</span>(Counter=0;Counter &lt; NumberOfParameters;Counter++){
00751 
00752                 <span class="comment">//</span>
00753                 <span class="comment">// if there is a string in this position,</span>
00754                 <span class="comment">// then probe and capture the string</span>
00755                 <span class="comment">//</span>
00756 
00757                 <span class="keywordflow">if</span> ( UnicodeStringParameterMask &amp; 1&lt;&lt;Counter ) {
00758 
00759                     RtlMoveMemory(
00760                         &amp;CapturedStrings[Counter],
00761                         (PVOID)Parameters[Counter],
00762                         <span class="keyword">sizeof</span>(UNICODE_STRING)
00763                         );
00764 
00765                     UserModeSize += CapturedStrings[Counter].MaximumLength;
00766 
00767                     }
00768                 }
00769 
00770             <span class="comment">//</span>
00771             <span class="comment">// Now we have the user-mode size all figured out.</span>
00772             <span class="comment">// Allocate some memory and point to it with the</span>
00773             <span class="comment">// parameter block. Then go through and copy all</span>
00774             <span class="comment">// of the parameters, string descriptors, and</span>
00775             <span class="comment">// string data into the memory</span>
00776             <span class="comment">//</span>
00777 
00778             ParameterBlock = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00779             <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = ZwAllocateVirtualMemory(
00780                         NtCurrentProcess(),
00781                         (PVOID *)&amp;ParameterBlock,
00782                         0,
00783                         &amp;UserModeSize,
00784                         MEM_COMMIT,
00785                         PAGE_READWRITE
00786                         );
00787 
00788             <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>( Status )) {
00789                 <span class="keywordflow">return</span>( <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> );
00790                 }
00791 
00792             UserModeParameterBase = ParameterBlock;
00793             UserModeStringsBase = (PUNICODE_STRING)((PUCHAR)ParameterBlock + <span class="keyword">sizeof</span>(ULONG)*MAXIMUM_HARDERROR_PARAMETERS);
00794             UserModeStringDataBase = (PUCHAR)UserModeStringsBase + <span class="keyword">sizeof</span>(UNICODE_STRING)*MAXIMUM_HARDERROR_PARAMETERS;
00795 
00796             <span class="keywordflow">for</span>(Counter=0;Counter &lt; NumberOfParameters;Counter++){
00797 
00798                 <span class="comment">//</span>
00799                 <span class="comment">// move parameters to user-mode portion of the</span>
00800                 <span class="comment">// address space.</span>
00801                 <span class="comment">//</span>
00802 
00803                 <span class="keywordflow">if</span> ( UnicodeStringParameterMask &amp; 1&lt;&lt;Counter ) {
00804 
00805                     <span class="comment">//</span>
00806                     <span class="comment">// fix the parameter to point at the string descriptor slot</span>
00807                     <span class="comment">// in the user-mode buffer.</span>
00808                     <span class="comment">//</span>
00809 
00810                     UserModeParameterBase[Counter] = (ULONG_PTR)&amp;UserModeStringsBase[Counter];
00811 
00812                     <span class="comment">//</span>
00813                     <span class="comment">// Copy the string data to user-mode</span>
00814                     <span class="comment">//</span>
00815 
00816                     RtlMoveMemory(
00817                         UserModeStringDataBase,
00818                         CapturedStrings[Counter].Buffer,
00819                         CapturedStrings[Counter].MaximumLength
00820                         );
00821 
00822                     CapturedStrings[Counter].Buffer = (PWSTR)UserModeStringDataBase;
00823 
00824                     <span class="comment">//</span>
00825                     <span class="comment">// copy the string descriptor</span>
00826                     <span class="comment">//</span>
00827 
00828                     RtlMoveMemory(
00829                         &amp;UserModeStringsBase[Counter],
00830                         &amp;CapturedStrings[Counter],
00831                         <span class="keyword">sizeof</span>(UNICODE_STRING)
00832                         );
00833 
00834                     <span class="comment">//</span>
00835                     <span class="comment">// Adjust the string data base</span>
00836                     <span class="comment">//</span>
00837 
00838                     UserModeStringDataBase += CapturedStrings[Counter].MaximumLength;
00839 
00840                     }
00841                 <span class="keywordflow">else</span> {
00842                     UserModeParameterBase[Counter] = Parameters[Counter];
00843                     }
00844                 }
00845             }
00846         <span class="keywordflow">else</span> {
00847             ParameterBlock = Parameters;
00848             }
00849         }
00850     <span class="keywordflow">else</span> {
00851         ParameterBlock = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00852         }
00853 
00854     <span class="comment">//</span>
00855     <span class="comment">// Call the hard error sender.</span>
00856     <span class="comment">//</span>
00857 
00858     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d6/d8/ex_2harderr_8c.html#a9">ExpRaiseHardError</a>(
00859                 ErrorStatus,
00860                 NumberOfParameters,
00861                 UnicodeStringParameterMask,
00862                 ParameterBlock,
00863                 ValidResponseOptions,
00864                 &amp;LocalResponse
00865                 );
00866     <span class="comment">//</span>
00867     <span class="comment">// If the parameter block was allocated, it needs to be</span>
00868     <span class="comment">// freed</span>
00869     <span class="comment">//</span>
00870 
00871     <span class="keywordflow">if</span> ( ParameterBlock &amp;&amp; ParameterBlock != Parameters ) {
00872         UserModeSize = 0;
00873         ZwFreeVirtualMemory(
00874               NtCurrentProcess(),
00875               (PVOID *)&amp;ParameterBlock,
00876               &amp;UserModeSize,
00877               MEM_RELEASE
00878               );
00879         }
00880     *Response = LocalResponse;
00881 
00882     <span class="keywordflow">return</span> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
00883 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a303" doxytag="ex.h::ExRaiseStatus" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI VOID NTAPI ExRaiseStatus           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN NTSTATUS&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Status</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d3/ex_2alpha_2raisests_8c-source.html#l00157">157</a> of file <a class="el" href="../../d1/d3/ex_2alpha_2raisests_8c-source.html">ex/alpha/raisests.c</a>.
<p>
References <a class="el" href="../../d7/d5/memprint_8h-source.html#l00079">DbgPrint</a>, and <a class="el" href="../../d3/d4/ex_2ppc_2raisests_8c.html#a1">ExpRaiseStatus()</a>.
<p>
Referenced by <a class="el" href="../../d7/d7/ex_2harderr_8c-source.html#l00926">_purecall()</a>, <a class="el" href="../../d1/d7/dir_8c-source.html#l00057">BuildQueryDirectoryIrp()</a>, <a class="el" href="../../d6/d6/copysup_8c-source.html#l00031">CcCopyRead()</a>, <a class="el" href="../../d6/d6/copysup_8c-source.html#l01075">CcCopyWrite()</a>, <a class="el" href="../../d6/d2/vacbsup_8c-source.html#l01208">CcCreateVacbArray()</a>, <a class="el" href="../../d6/d2/vacbsup_8c-source.html#l01377">CcExtendVacbArray()</a>, <a class="el" href="../../d6/d6/copysup_8c-source.html#l00588">CcFastCopyRead()</a>, <a class="el" href="../../d6/d6/copysup_8c-source.html#l01482">CcFastCopyWrite()</a>, <a class="el" href="../../d6/d2/vacbsup_8c-source.html#l00401">CcGetVacbMiss()</a>, <a class="el" href="../../d6/d7/fssup_8c-source.html#l00387">CcInitializeCacheMap()</a>, <a class="el" href="../../d7/d1/cachesub_8c-source.html#l06024">CcMapAndCopy()</a>, <a class="el" href="../../d8/d4/mdlsup_8c-source.html#l00030">CcMdlRead()</a>, <a class="el" href="../../d7/d1/cachesub_8c-source.html#l00116">CcPinFileData()</a>, <a class="el" href="../../d8/d4/mdlsup_8c-source.html#l00466">CcPrepareMdlWrite()</a>, <a class="el" href="../../d6/d2/vacbsup_8c-source.html#l00947">CcReferenceFileOffset()</a>, <a class="el" href="../../d6/d7/fssup_8c-source.html#l01821">CcSetFileSizes()</a>, <a class="el" href="../../d6/d7/fssup_8c-source.html#l02952">CcZeroData()</a>, <a class="el" href="../../d6/d1/poolhack_8c-source.html#l00694">ExAllocatePoolWithQuota()</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l02607">ExAllocatePoolWithQuotaTag()</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l01104">ExAllocatePoolWithTag()</a>, <a class="el" href="../../d1/d3/ex_2alpha_2raisests_8c-source.html#l00085">ExpRaiseException()</a>, <a class="el" href="../../d1/d3/ex_2alpha_2raisests_8c-source.html#l00196">ExpRaiseStatus()</a>, <a class="el" href="../../d0/d3/raise_8c-source.html#l00044">ExRaiseAccessViolation()</a>, <a class="el" href="../../d0/d3/raise_8c-source.html#l00071">ExRaiseDatatypeMisalignment()</a>, <a class="el" href="../../d8/d2/fsrtl_2filter_8c-source.html#l00124">FsRtlAllocatePool()</a>, <a class="el" href="../../d8/d2/fsrtl_2filter_8c-source.html#l00169">FsRtlAllocatePoolWithQuota()</a>, <a class="el" href="../../d8/d2/fsrtl_2filter_8c-source.html#l00260">FsRtlAllocatePoolWithQuotaTag()</a>, <a class="el" href="../../d8/d2/fsrtl_2filter_8c-source.html#l00214">FsRtlAllocatePoolWithTag()</a>, <a class="el" href="../../d5/d4/name_8c-source.html#l00288">FsRtlAreNamesEqual()</a>, <a class="el" href="../../d5/d4/name_8c-source.html#l00415">FsRtlIsNameInExpression()</a>, <a class="el" href="../../d6/d2/filelock_8c-source.html#l00888">FsRtlPrivateInitializeFileLock()</a>, <a class="el" href="../../d6/d2/filelock_8c-source.html#l03867">FsRtlPrivateLock()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l04502">IoCreateFile()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l05378">IoCreateStreamFileObject()</a>, <a class="el" href="../../d5/d5/iosubs_8c-source.html#l05535">IoCreateStreamFileObjectLite()</a>, <a class="el" href="../../d0/d5/ioinit_8c-source.html#l02107">IopCreateEntry()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l06326">IopSetEaOrQuotaInformationFile()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l08084">IopXxxControlFile()</a>, <a class="el" href="../../d4/d4/mutntobj_8c-source.html#l00178">KeReleaseMutant()</a>, <a class="el" href="../../d2/d5/semphobj_8c-source.html#l00118">KeReleaseSemaphore()</a>, <a class="el" href="../../d0/d1/thredobj_8c-source.html#l01912">KeSuspendThread()</a>, <a class="el" href="../../d2/d6/wait_8c-source.html#l00395">KeWaitForMultipleObjects()</a>, <a class="el" href="../../d2/d6/wait_8c-source.html#l00810">KeWaitForSingleObject()</a>, <a class="el" href="../../d9/d6/lfs_2strucsup_8c-source.html#l00315">LfsAllocateLbcb()</a>, <a class="el" href="../../d9/d6/lfs_2strucsup_8c-source.html#l00463">LfsAllocateLcb()</a>, <a class="el" href="../../d7/d4/logpgsup_8c-source.html#l00113">LfsAllocateSpanningBuffer()</a>, <a class="el" href="../../d8/d1/lfs_2cachesup_8c-source.html#l00339">LfsCopyReadLogRecord()</a>, <a class="el" href="../../d1/d6/lfs_2registry_8c-source.html#l03193">LfsFindLastLsn()</a>, <a class="el" href="../../d4/d2/querylog_8c-source.html#l00809">LfsFindLogRecord()</a>, <a class="el" href="../../d8/d1/lfs_2cachesup_8c-source.html#l00551">LfsFlushLfcb()</a>, <a class="el" href="../../d2/d9/lfs_2write_8c-source.html#l00360">LfsFlushToLsn()</a>, <a class="el" href="../../d8/d0/lbcbsup_8c-source.html#l00134">LfsFlushToLsnPriv()</a>, <a class="el" href="../../d2/d9/lfs_2write_8c-source.html#l00197">LfsForceWrite()</a>, <a class="el" href="../../d1/d6/lfs_2registry_8c-source.html#l00150">LfsInitializeLogFile()</a>, <a class="el" href="../../d1/d6/lfs_2registry_8c-source.html#l02246">LfsNormalizeBasicLogFile()</a>, <a class="el" href="../../d1/d6/lfs_2registry_8c-source.html#l00366">LfsOpenLogFile()</a>, <a class="el" href="../../d8/d1/lfs_2cachesup_8c-source.html#l00084">LfsPinOrMapData()</a>, <a class="el" href="../../d4/d2/querylog_8c-source.html#l00701">LfsQueryLastLsn()</a>, <a class="el" href="../../d4/d2/querylog_8c-source.html#l00072">LfsReadLogRecord()</a>, <a class="el" href="../../d4/d2/querylog_8c-source.html#l00299">LfsReadNextLogRecord()</a>, <a class="el" href="../../d6/d8/restart_8c-source.html#l00046">LfsReadRestartArea()</a>, <a class="el" href="../../d1/d6/lfs_2registry_8c-source.html#l01361">LfsResetUndoTotal()</a>, <a class="el" href="../../d1/d6/lfs_2registry_8c-source.html#l01534">LfsRestartLogFile()</a>, <a class="el" href="../../d6/d8/restart_8c-source.html#l00447">LfsSetBaseLsn()</a>, <a class="el" href="../../d8/d4/lfs_2verfysup_8c-source.html#l00114">LfsVerifyLogSpaceAvail()</a>, <a class="el" href="../../d2/d9/lfs_2write_8c-source.html#l00039">LfsWrite()</a>, <a class="el" href="../../d6/d8/restart_8c-source.html#l00270">LfsWriteRestartArea()</a>, <a class="el" href="../../d0/d6/desktop_8c-source.html#l02836">MapDesktop()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l11087">MESSAGECALL()</a>, <a class="el" href="../../d7/d0/mmquota_8c-source.html#l00058">MiChargePageFileQuota()</a>, <a class="el" href="../../d5/d4/procsup_8c-source.html#l04202">MiCreatePebOrTeb()</a>, <a class="el" href="../../d0/d5/readwrt_8c-source.html#l00529">MiDoMappedCopy()</a>, <a class="el" href="../../d7/d3/addrsup_8c-source.html#l01252">MiFindEmptyAddressRangeDownTree()</a>, <a class="el" href="../../d7/d3/addrsup_8c-source.html#l01127">MiFindEmptyAddressRangeInTree()</a>, <a class="el" href="../../d7/d2/vadtree_8c-source.html#l00030">MiInsertVad()</a>, <a class="el" href="../../d1/d1/mmsup_8c-source.html#l00243">MiMakeProtectionMask()</a>, <a class="el" href="../../d6/d5/iosup_8c-source.html#l02785">MiMapLockedPagesInUserSpace()</a>, <a class="el" href="../../d4/d4/mapview_8c-source.html#l02256">MiMapViewOfDataSection()</a>, <a class="el" href="../../d4/d4/mapview_8c-source.html#l01567">MiMapViewOfImageSection()</a>, <a class="el" href="../../d4/d4/mapview_8c-source.html#l01028">MiMapViewOfPhysicalSection()</a>, <a class="el" href="../../d1/d8/protect_8c-source.html#l01110">MiSetProtectionOnSection()</a>, <a class="el" href="../../d5/d4/procsup_8c-source.html#l04631">MmCreatePeb()</a>, <a class="el" href="../../d0/d5/verifier_8c-source.html#l04046">MmGetVerifierInformation()</a>, <a class="el" href="../../d6/d5/iosup_8c-source.html#l00238">MmProbeAndLockPages()</a>, <a class="el" href="../../d6/d5/iosup_8c-source.html#l00813">MmProbeAndLockProcessPages()</a>, <a class="el" href="../../d1/d4/probewrt_8c-source.html#l00036">MmProbeForWrite()</a>, <a class="el" href="../../d0/d5/verifier_8c-source.html#l04226">MmSetVerifierInformation()</a>, <a class="el" href="../../d4/d5/allocvm_8c-source.html#l00075">NtAllocateVirtualMemory()</a>, <a class="el" href="../../d1/d7/dir_8c-source.html#l00821">NtNotifyChangeDirectoryFile()</a>, <a class="el" href="../../d8/d1/qsea_8c-source.html#l00035">NtQueryEaFile()</a>, <a class="el" href="../../d8/d6/ntapi_8c-source.html#l03461">NtQueryMultipleValueKey()</a>, <a class="el" href="../../d1/d2/qsquota_8c-source.html#l00035">NtQueryQuotaInformationFile()</a>, <a class="el" href="../../d7/d4/io_2read_8c-source.html#l00036">NtReadFile()</a>, <a class="el" href="../../d7/d4/io_2read_8c-source.html#l00730">NtReadFileScatter()</a>, <a class="el" href="../../d8/d1/qsea_8c-source.html#l00652">NtSetEaFile()</a>, <a class="el" href="../../d0/d2/qsinfo_8c-source.html#l00849">NtSetInformationFile()</a>, <a class="el" href="../../d4/d2/uuid_8c-source.html#l00532">NtSetUuidSeed()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l09490">NtUserDrawCaptionTemp()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l13179">NtUserQueryUserCounters()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l01365">NtUserResolveDesktop()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l01303">NtUserResolveDesktopForWOW()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l08617">NtUserSendInput()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l06023">NtUserSetSysColors()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l02400">NtUserSystemParametersInfo()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l06953">NtUserToUnicodeEx()</a>, <a class="el" href="../../d1/d9/io_2write_8c-source.html#l00035">NtWriteFile()</a>, <a class="el" href="../../d1/d9/io_2write_8c-source.html#l00801">NtWriteFileGather()</a>, <a class="el" href="../../d6/d7/ntimm_8c-source.html#l02154">ProbeAndCaptureSoftKbdData()</a>, <a class="el" href="../../d1/d1/psquota_8c-source.html#l00246">PsChargePoolQuota()</a>, <a class="el" href="../../d0/d7/udfs_2strucsup_8c-source.html#l01301">UdfCreateIrpContext()</a>, <a class="el" href="../../d4/d7/udfprocs_8h-source.html#l00418">UdfNormalizeAndRaiseStatus()</a>, <a class="el" href="../../d4/d7/udfprocs_8h-source.html#l00406">UdfRaiseStatus()</a>, <a class="el" href="../../d5/d7/ex_8c-source.html#l00271">UserRtlRaiseStatus()</a>, <a class="el" href="../../d0/d4/vdmints_8c-source.html#l00477">VdmDispatchInterrupts()</a>, <a class="el" href="../../d4/d3/vdm_2vdm_8c-source.html#l00087">VdmQueryDirectoryFile()</a>, <a class="el" href="../../d0/d5/verifier_8c-source.html#l01812">VeAllocatePoolWithTagPriority()</a>, <a class="el" href="../../d0/d5/verifier_8c-source.html#l01003">VerifierAllocatePoolWithQuota()</a>, <a class="el" href="../../d0/d5/verifier_8c-source.html#l01059">VerifierAllocatePoolWithQuotaTag()</a>, <a class="el" href="../../d0/d5/verifier_8c-source.html#l00537">VerifierProbeAndLockPages()</a>, <a class="el" href="../../d0/d5/verifier_8c-source.html#l00563">VerifierProbeAndLockProcessPages()</a>, and <a class="el" href="../../d0/d5/verifier_8c-source.html#l00593">VerifierProbeAndLockSelectedPages()</a>.
<p>
<pre class="fragment"><div>00163                    :
00164 
00165     This function raises an exception with <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified status value by
00166     building an exception record, building a context record, and calling <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00167     exception dispatcher directly. The exception <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> marked as noncontinuable
00168     with no parameters. There <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> no <span class="keywordflow">return</span> from <span class="keyword">this</span> function.
00169 
00170     N.B. This routine <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> a shell routine that simply calls another routine
00171          to <span class="keywordflow">do</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> real work. The <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a10">reason</a> <span class="keyword">this</span> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> done <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to avoid a problem
00172          in <span class="keywordflow">try</span>/finally scopes where <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> last statement in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> scope <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> a
00173          call to raise an exception.
00174 
00175 Arguments:
00176 
00177     ExceptionCode - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> status value to be used as <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> exception
00178         code <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> exception that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to be raised.
00179 
00180 Return Value:
00181 
00182     None.
00183 
00184 --*/
00185 
00186 {
00187 
00188 <span class="preprocessor">#ifdef DBGxx</span>
00189 <span class="preprocessor"></span>    <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"ExRaiseStatus(ExceptionCode = %lx)\n"</span>, ExceptionCode);
00190 <span class="preprocessor">#endif</span>
00191 <span class="preprocessor"></span>    <a class="code" href="../../d3/d4/ex_2ppc_2raisests_8c.html#a1">ExpRaiseStatus</a>(ExceptionCode);
00192     <span class="keywordflow">return</span>;
00193 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a210" doxytag="ex.h::ExRecordCallerInHashTable" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID ExRecordCallerInHashTable           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d8/d6/struct__CALL__PERFORMANCE__DATA.html">PCALL_PERFORMANCE_DATA</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>CallData</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>CallersAddress</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>CallersCaller</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d4/callperf_8c-source.html#l00065">65</a> of file <a class="el" href="../../d0/d4/callperf_8c-source.html">callperf.c</a>.
<p>
References <a class="el" href="../../d5/d8/ex_8h.html#a90">CALL_HASH_ENTRY</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l00028">CALL_HASH_TABLE_SIZE</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l00034">_CALL_HASH_ENTRY::CallCount</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l00032">_CALL_HASH_ENTRY::CallersAddress</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l00033">_CALL_HASH_ENTRY::CallersCaller</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l00253">ExAllocatePoolWithTag</a>, <a class="el" href="../../d9/d0/init_8h-source.html#l00070">InitializationPhase</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l00031">_CALL_HASH_ENTRY::ListEntry</a>, <a class="el" href="../../d5/d8/ex_8h.html#a329a173">NonPagedPool</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, and <a class="el" href="../../d5/d8/ex_8h.html#a91">PCALL_HASH_ENTRY</a>.
<p>
<pre class="fragment"><div>00073                    :
00074 
00075     This function records call data in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified call performance
00076     data structure.
00077 
00078 Arguments:
00079 
00080     CallData - Supplies a pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> call performance data structure
00081         in which <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> call data <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> recorded.
00082 
00083     CallersAddress - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> address of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> caller of a fucntion.
00084 
00085     CallersCaller - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> address of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> caller of a caller of
00086         a function.
00087 
00088 Return Value:
00089 
00090     None.
00091 
00092 --*/
00093 
00094 {
00095 
00096     <a class="code" href="../../d7/d6/struct__CALL__HASH__ENTRY.html">PCALL_HASH_ENTRY</a> HashEntry;
00097     ULONG Hash;
00098     <a class="code" href="../../d7/d6/struct__CALL__HASH__ENTRY.html">PCALL_HASH_ENTRY</a> MatchEntry;
00099     PLIST_ENTRY NextEntry;
00100     KIRQL OldIrql;
00101 
00102     <span class="comment">//</span>
00103     <span class="comment">// If the initialization phase is not zero, then collect call performance</span>
00104     <span class="comment">// data.</span>
00105     <span class="comment">//</span>
00106 
00107     <span class="keywordflow">if</span> (<a class="code" href="../../d8/d1/init_8h.html#a21">InitializationPhase</a> != 0) {
00108 
00109         <span class="comment">//</span>
00110         <span class="comment">// Acquire the call performance data structure spinlock.</span>
00111         <span class="comment">//</span>
00112 
00113         ExAcquireSpinLock(&amp;CallData-&gt;SpinLock, &amp;OldIrql);
00114 
00115         <span class="comment">//</span>
00116         <span class="comment">// Lookup the callers address in call performance data hash table. If</span>
00117         <span class="comment">// the address does not exist in the table, then create a new entry.</span>
00118         <span class="comment">//</span>
00119 
00120         Hash = (ULONG)((ULONG_PTR)CallersAddress ^ (ULONG_PTR)CallersCaller);
00121         Hash = ((Hash &gt; 24) ^ (Hash &gt; 16) ^ (Hash &gt; 8) ^ (Hash)) &amp; (<a class="code" href="../../d5/d8/ex_8h.html#a0">CALL_HASH_TABLE_SIZE</a> - 1);
00122         MatchEntry = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00123         NextEntry = CallData-&gt;HashTable[Hash].Flink;
00124         <span class="keywordflow">while</span> (NextEntry != &amp;CallData-&gt;HashTable[Hash]) {
00125             HashEntry = CONTAINING_RECORD(NextEntry,
00126                                           <a class="code" href="../../d7/d6/struct__CALL__HASH__ENTRY.html">CALL_HASH_ENTRY</a>,
00127                                           ListEntry);
00128 
00129             <span class="keywordflow">if</span> ((HashEntry-&gt;<a class="code" href="../../d7/d6/struct__CALL__HASH__ENTRY.html#o1">CallersAddress</a> == CallersAddress) &amp;&amp;
00130                 (HashEntry-&gt;<a class="code" href="../../d7/d6/struct__CALL__HASH__ENTRY.html#o2">CallersCaller</a> == CallersCaller)) {
00131                 MatchEntry = HashEntry;
00132                 <span class="keywordflow">break</span>;
00133             }
00134 
00135             NextEntry = NextEntry-&gt;Flink;
00136         }
00137 
00138         <span class="comment">//</span>
00139         <span class="comment">// If a matching caller address was found, then update the call site</span>
00140         <span class="comment">// statistics. Otherwise, allocate a new hash entry and initialize</span>
00141         <span class="comment">// call site statistics.</span>
00142         <span class="comment">//</span>
00143 
00144         <span class="keywordflow">if</span> (MatchEntry != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00145             MatchEntry-&gt;<a class="code" href="../../d7/d6/struct__CALL__HASH__ENTRY.html#o3">CallCount</a> += 1;
00146 
00147         } <span class="keywordflow">else</span> {
00148             MatchEntry = <a class="code" href="../../d5/d8/ex_8h.html#a4">ExAllocatePoolWithTag</a>(NonPagedPool,
00149                                               <span class="keyword">sizeof</span>(<a class="code" href="../../d7/d6/struct__CALL__HASH__ENTRY.html">CALL_HASH_ENTRY</a>),
00150                                               'CdHe');
00151 
00152             <span class="keywordflow">if</span> (MatchEntry != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00153                 MatchEntry-&gt;<a class="code" href="../../d7/d6/struct__CALL__HASH__ENTRY.html#o1">CallersAddress</a> = CallersAddress;
00154                 MatchEntry-&gt;<a class="code" href="../../d7/d6/struct__CALL__HASH__ENTRY.html#o2">CallersCaller</a> = CallersCaller;
00155                 MatchEntry-&gt;<a class="code" href="../../d7/d6/struct__CALL__HASH__ENTRY.html#o3">CallCount</a> = 1;
00156                 InsertTailList(&amp;CallData-&gt;HashTable[Hash],
00157                                &amp;MatchEntry-&gt;<a class="code" href="../../d7/d6/struct__CALL__HASH__ENTRY.html#o0">ListEntry</a>);
00158             }
00159         }
00160 
00161         <span class="comment">//</span>
00162         <span class="comment">// Release the call performance data structure spinlock.</span>
00163         <span class="comment">//</span>
00164 
00165         ExReleaseSpinLock(&amp;CallData-&gt;SpinLock, OldIrql);
00166     }
00167 
00168     <span class="keywordflow">return</span>;
00169 }
}
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a321" doxytag="ex.h::ExRegisterCallback" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI PVOID ExRegisterCallback           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d9/d6/struct__CALLBACK__OBJECT.html">PCALLBACK_OBJECT</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>CallbackObject</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d5/d8/ex_8h.html#a157">PCALLBACK_FUNCTION</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>CallbackFunction</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>CallbackContext</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d3/ex_2callback_8c-source.html#l00378">378</a> of file <a class="el" href="../../d3/d3/ex_2callback_8c-source.html">ex/callback.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d3/d3/ex_2callback_8c-source.html#l00084">_CALLBACK_REGISTRATION::Busy</a>, <a class="el" href="../../d3/d3/ex_2callback_8c-source.html#l00083">_CALLBACK_REGISTRATION::CallbackContext</a>, <a class="el" href="../../d3/d3/ex_2callback_8c-source.html#l00082">_CALLBACK_REGISTRATION::CallbackFunction</a>, <a class="el" href="../../d3/d3/ex_2callback_8c-source.html#l00081">_CALLBACK_REGISTRATION::CallbackObject</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00087">DISPATCH_LEVEL</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l00253">ExAllocatePoolWithTag</a>, <a class="el" href="../../d7/d2/cmwraper_8c-source.html#l00304">ExFreePool()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l02007">KeAcquireSpinLock</a>, <a class="el" href="../../d9/d5/verifier_8c.html#a119">KeReleaseSpinLock()</a>, <a class="el" href="../../d3/d3/ex_2callback_8c-source.html#l00080">_CALLBACK_REGISTRATION::Link</a>, <a class="el" href="../../d5/d8/ex_8h.html#a329a173">NonPagedPool</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d5/d9/ob_8h-source.html#l00494">ObDereferenceObject</a>, <a class="el" href="../../d5/d9/ob_8h-source.html#l00514">ObReferenceObject</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l03264">PCALLBACK_FUNCTION</a>, <a class="el" href="../../d2/d4/ex_2callback_8c.html#a8">PCALLBACK_REGISTRATION</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00135">Status</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, and <a class="el" href="../../d3/d3/ex_2callback_8c-source.html#l00085">_CALLBACK_REGISTRATION::UnregisterWaiting</a>.
<p>
<pre class="fragment"><div>00386                    :
00387 
00388     This routine allows a caller to <span class="keyword">register</span> that <a class="code" href="../../d1/d9/icmui_8def.html#a4">it</a> would like to have its
00389     callback Function invoked when <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> callback notification call occurs.
00390 
00391 Arguments:
00392 
00393     CallbackObject - Supplies a pointer to a CallbackObject.
00394 
00395     CallbackFunction - Supplies a pointer to a function which <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to
00396         be executed when <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> Callback notification occures.
00397 
00398     CallbackContext - Supplies a pointer to an arbitrary data structure
00399         that will be passed to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> function specified by <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> CallbackFunction
00400         parameter.
00401 
00402 Return Value:
00403 
00404     Returns handle to callback registration.
00405 
00406 --*/
00407 {
00408     <a class="code" href="../../d0/d7/struct__CALLBACK__REGISTRATION.html">PCALLBACK_REGISTRATION</a>  CallbackRegistration;
00409     BOOLEAN                 Inserted;
00410     KIRQL                   OldIrql;
00411     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>                <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
00412 
00413     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a> (CallbackFunction);
00414     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a> (KeGetCurrentIrql() &lt; DISPATCH_LEVEL);
00415 
00416     <span class="comment">//</span>
00417     <span class="comment">// Add reference to object</span>
00418     <span class="comment">//</span>
00419 
00420     <a class="code" href="../../d4/d0/ob_8h.html#a15">ObReferenceObject</a> (CallbackObject);
00421 
00422     <span class="comment">//</span>
00423     <span class="comment">// Begin by attempting to allocate storage for the CallbackRegistration.</span>
00424     <span class="comment">// one cannot be allocated, return the error status.</span>
00425     <span class="comment">//</span>
00426 
00427     CallbackRegistration = <a class="code" href="../../d5/d8/ex_8h.html#a4">ExAllocatePoolWithTag</a>(
00428                                 NonPagedPool,
00429                                 <span class="keyword">sizeof</span>( <a class="code" href="../../d0/d7/struct__CALLBACK__REGISTRATION.html">CALLBACK_REGISTRATION</a> ),
00430                                 'eRBC'
00431                                 );
00432 
00433 
00434     <span class="keywordflow">if</span>( !CallbackRegistration ) {
00435        <a class="code" href="../../d4/d0/ob_8h.html#a14">ObDereferenceObject</a> (CallbackObject);
00436        <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00437     }
00438 
00439 
00440     <span class="comment">//</span>
00441     <span class="comment">// Initialize the callback packet</span>
00442     <span class="comment">//</span>
00443 
00444     CallbackRegistration-&gt;<a class="code" href="../../d0/d7/struct__CALLBACK__REGISTRATION.html#o1">CallbackObject</a>    = CallbackObject;
00445     CallbackRegistration-&gt;<a class="code" href="../../d0/d7/struct__CALLBACK__REGISTRATION.html#o2">CallbackFunction</a>  = CallbackFunction;
00446     CallbackRegistration-&gt;<a class="code" href="../../d0/d7/struct__CALLBACK__REGISTRATION.html#o3">CallbackContext</a>   = CallbackContext;
00447     CallbackRegistration-&gt;<a class="code" href="../../d0/d7/struct__CALLBACK__REGISTRATION.html#o4">Busy</a>              = 0;
00448     CallbackRegistration-&gt;<a class="code" href="../../d0/d7/struct__CALLBACK__REGISTRATION.html#o5">UnregisterWaiting</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00449 
00450 
00451     Inserted = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00452     <a class="code" href="../../d4/d9/ke_8h.html#a37">KeAcquireSpinLock</a> (&amp;CallbackObject-&gt;Lock, &amp;OldIrql);
00453 
00454     <span class="keywordflow">if</span>( CallbackObject-&gt;AllowMultipleCallbacks ||
00455         IsListEmpty( &amp;CallbackObject-&gt;RegisteredCallbacks ) ) {
00456 
00457        <span class="comment">//</span>
00458        <span class="comment">// add CallbackRegistration to tail</span>
00459        <span class="comment">//</span>
00460 
00461 
00462        Inserted = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00463        InsertTailList( &amp;CallbackObject-&gt;RegisteredCallbacks,
00464                        &amp;CallbackRegistration-&gt;<a class="code" href="../../d0/d7/struct__CALLBACK__REGISTRATION.html#o0">Link</a> )
00465     }
00466 
00467     <a class="code" href="../../d9/d5/verifier_8c.html#a119">KeReleaseSpinLock</a> (&amp;CallbackObject-&gt;Lock, OldIrql);
00468 
00469     <span class="keywordflow">if</span> (!Inserted) {
00470        <a class="code" href="../../d5/d8/ex_8h.html#a224">ExFreePool</a> (CallbackRegistration);
00471        CallbackRegistration = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00472     }
00473 
00474     <span class="keywordflow">return</span> (PVOID) CallbackRegistration;
00475 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a267" doxytag="ex.h::ExReinitializeResourceLite" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI NTSTATUS ExReinitializeResourceLite           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d6/d4/struct__ERESOURCE.html">PERESOURCE</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Resource</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l00273">273</a> of file <a class="el" href="../../d9/d7/ex_2resource_8c-source.html">ex/resource.c</a>.
<p>
References <a class="el" href="../../d6/d7/ex_8h-source.html#l02289">_ERESOURCE::ActiveCount</a>, <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02294">_ERESOURCE::ContentionCount</a>, <a class="el" href="../../d9/d8/client_2ntstubs_8c-source.html#l00086">Event()</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02292">_ERESOURCE::ExclusiveWaiters</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02290">_ERESOURCE::Flag</a>, <a class="el" href="../../d2/d9/cmchek_8c-source.html#l00095">Index</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l01066">KeInitializeEvent</a>, <a class="el" href="../../d2/d5/semphobj_8c-source.html#l00039">KeInitializeSemaphore()</a>, <a class="el" href="../../d4/d9/ke_8h.html#a354">KeInitializeSpinLock()</a>, <a class="el" href="../../d2/d5/allocpag_8c-source.html#l00437">MmDeterminePoolType()</a>, <a class="el" href="../../d5/d8/ex_8h.html#a329a173">NonPagedPool</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02296">_ERESOURCE::NumberOfExclusiveWaiters</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02295">_ERESOURCE::NumberOfSharedWaiters</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02280">_OWNER_ENTRY::OwnerCount</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02288">_ERESOURCE::OwnerTable</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02278">_OWNER_ENTRY::OwnerThread</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02293">_ERESOURCE::OwnerThreads</a>, <a class="el" href="../../d5/d9/tex_8c-source.html#l01561">Resource</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02291">_ERESOURCE::SharedWaiters</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02302">_ERESOURCE::SpinLock</a>, and <a class="el" href="../../d6/d7/ex_8h-source.html#l02281">_OWNER_ENTRY::TableSize</a>.
<p>
<pre class="fragment"><div>00279                    :
00280 
00281     This routine reinitializes <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified resource.
00282 
00283 Arguments:
00284 
00285     <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a> - Supplies a pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> resource to initialize.
00286 
00287 Return Value:
00288 
00289     STATUS_SUCCESS.
00290 
00291 --*/
00292 
00293 {
00294 
00295     <a class="code" href="../../d2/d6/struct__KEVENT.html">PKEVENT</a> <a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a5">Event</a>;
00296     ULONG <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>;
00297     <a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html">POWNER_ENTRY</a> OwnerTable;
00298     <a class="code" href="../../d8/d7/struct__KSEMAPHORE.html">PKSEMAPHORE</a> Semaphore;
00299     ULONG TableSize;
00300 
00301     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(<a class="code" href="../../d1/d6/allocpag_8c.html#a48">MmDeterminePoolType</a>(Resource) == NonPagedPool);
00302 
00303     <span class="comment">//</span>
00304     <span class="comment">// If the resource has an owner table, then zero the owner table.</span>
00305     <span class="comment">//</span>
00306 
00307     OwnerTable = <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o1">OwnerTable</a>;
00308     <span class="keywordflow">if</span> (OwnerTable != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00309         TableSize = OwnerTable-&gt;<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o2">TableSize</a>;
00310         <span class="keywordflow">for</span> (<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> = 1; <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> &lt; TableSize; <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> += 1) {
00311             OwnerTable[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>].<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o0">OwnerThread</a> = 0;
00312             OwnerTable[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>].<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o1">OwnerCount</a> = 0;
00313         }
00314     }
00315 
00316     <span class="comment">//</span>
00317     <span class="comment">// Set the active count and flags to zero.</span>
00318     <span class="comment">//</span>
00319 
00320     <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o2">ActiveCount</a> = 0;
00321     <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o3">Flag</a> = 0;
00322 
00323     <span class="comment">//</span>
00324     <span class="comment">// If the resource has a shared waiter semaphore, then reinitialize</span>
00325     <span class="comment">// it.</span>
00326     <span class="comment">//</span>
00327 
00328     Semaphore = <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o4">SharedWaiters</a>;
00329     <span class="keywordflow">if</span> (Semaphore != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00330         <a class="code" href="../../d1/d6/semphobj_8c.html#a1">KeInitializeSemaphore</a>(Semaphore, 0, MAXLONG);
00331     }
00332 
00333     <span class="comment">//</span>
00334     <span class="comment">// If the resource has a exclusive waiter event, then reinitialize</span>
00335     <span class="comment">// it.</span>
00336     <span class="comment">//</span>
00337 
00338     <a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a5">Event</a> = <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o5">ExclusiveWaiters</a>;
00339     <span class="keywordflow">if</span> (<a class="code" href="../../d8/d9/client_2ntstubs_8c.html#a5">Event</a> != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00340         <a class="code" href="../../d4/d9/ke_8h.html#a20">KeInitializeEvent</a>(Event, SynchronizationEvent, FALSE);
00341     }
00342 
00343     <span class="comment">//</span>
00344     <span class="comment">// Initialize the builtin owner table.</span>
00345     <span class="comment">//</span>
00346 
00347     <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o6">OwnerThreads</a>[0].<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o0">OwnerThread</a> = 0;
00348     <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o6">OwnerThreads</a>[0].<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o1">OwnerCount</a> = 0;
00349     <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o6">OwnerThreads</a>[1].<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o0">OwnerThread</a> = 0;
00350     <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o6">OwnerThreads</a>[1].<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o1">OwnerCount</a> = 0;
00351 
00352     <span class="comment">//</span>
00353     <span class="comment">// Set the contention count, number of shared waiters, and number</span>
00354     <span class="comment">// of exclusive waiters to zero.</span>
00355     <span class="comment">//</span>
00356 
00357     <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o7">ContentionCount</a> = 0;
00358     <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o8">NumberOfSharedWaiters</a> = 0;
00359     <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o9">NumberOfExclusiveWaiters</a> = 0;
00360 
00361     <span class="comment">//</span>
00362     <span class="comment">// Reinitialize the resource spinlock.</span>
00363     <span class="comment">//</span>
00364 
00365     <a class="code" href="../../d4/d9/ke_8h.html#a354">KeInitializeSpinLock</a>(&amp;<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o12">SpinLock</a>);
00366     <span class="keywordflow">return</span> STATUS_SUCCESS;
00367 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a232" doxytag="ex.h::ExReleaseFastMutexUnsafe" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI VOID FASTCALL ExReleaseFastMutexUnsafe           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d6/d9/struct__FAST__MUTEX.html">PFAST_MUTEX</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>FastMutex</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d4/d2/uuid_8c-source.html#l00841">ExUuidCreate()</a>, <a class="el" href="../../d6/d1/oplock_8c-source.html#l01678">FsRtlAcknowledgeOplockBreak()</a>, <a class="el" href="../../d6/d1/oplock_8c-source.html#l01937">FsRtlOpBatchBreakClosePending()</a>, <a class="el" href="../../d6/d1/oplock_8c-source.html#l02111">FsRtlOplockBreakNotify()</a>, <a class="el" href="../../d6/d1/oplock_8c-source.html#l02454">FsRtlOplockBreakToII()</a>, <a class="el" href="../../d6/d1/oplock_8c-source.html#l02690">FsRtlOplockBreakToNone()</a>, <a class="el" href="../../d6/d1/oplock_8c-source.html#l02249">FsRtlOplockCleanup()</a>, <a class="el" href="../../d6/d1/oplock_8c-source.html#l01299">FsRtlRequestExclusiveOplock()</a>, <a class="el" href="../../d6/d1/oplock_8c-source.html#l01514">FsRtlRequestOplockII()</a>, <a class="el" href="../../d6/d1/oplock_8c-source.html#l00413">FsRtlUninitializeOplock()</a>, <a class="el" href="../../d6/d1/oplock_8c-source.html#l03025">FsRtlWaitOnIrp()</a>, <a class="el" href="../../d6/d8/w32_2ntuser_2kernel_2pnp_8c-source.html#l00147">LeaveMediaCrit()</a>, <a class="el" href="../../d8/d1/power_8c-source.html#l00043">LeavePowerCrit()</a>, <a class="el" href="../../d4/d4/mapview_8c-source.html#l02256">MiMapViewOfDataSection()</a>, <a class="el" href="../../d1/d8/protect_8c-source.html#l00344">MiProtectVirtualMemory()</a>, <a class="el" href="../../d5/d8/umapview_8c-source.html#l00265">MiRemoveMappedView()</a>, <a class="el" href="../../d4/d2/uuid_8c-source.html#l00617">NtAllocateUuids()</a>, <a class="el" href="../../d4/d5/allocvm_8c-source.html#l00075">NtAllocateVirtualMemory()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l00814">NtQueryInformationJobObject()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l01323">NtSetInformationJobObject()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l02823">PsChangeJobMemoryUsage()</a>, <a class="el" href="../../d3/d7/ps_2create_8c-source.html#l01966">PsLockProcess()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l00439">PspAddProcessToJob()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l02262">PspApplyJobLimitsToProcess()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l00709">PspJobClose()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l02901">PsReportProcessMemoryLimitViolation()</a>, <a class="el" href="../../d3/d7/ps_2create_8c-source.html#l02250">PsUnlockProcess()</a>, and <a class="el" href="../../d0/d5/verifier_8c-source.html#l02899">VerifierExReleaseFastMutexUnsafe()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a274" doxytag="ex.h::ExReleaseResourceForThreadLite" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI VOID ExReleaseResourceForThreadLite           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d6/d4/struct__ERESOURCE.html">PERESOURCE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Resource</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d5/d8/ex_8h.html#a121">ERESOURCE_THREAD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>ResourceThreadId</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l01607">1607</a> of file <a class="el" href="../../d9/d7/ex_2resource_8c-source.html">ex/resource.c</a>.
<p>
References <a class="el" href="../../d6/d7/ex_8h-source.html#l02289">_ERESOURCE::ActiveCount</a>, <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d8/d3/ddkresrc_8c-source.html#l00070">ASSERT_RESOURCE</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02292">_ERESOURCE::ExclusiveWaiters</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02290">_ERESOURCE::Flag</a>, <a class="el" href="../../d2/d9/cmchek_8c-source.html#l00095">Index</a>, <a class="el" href="../../d8/d3/ddkresrc_8c-source.html#l00089">IsExclusiveWaiting</a>, <a class="el" href="../../d8/d3/ddkresrc_8c-source.html#l00091">IsOwnedExclusive</a>, <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l00049">IsSharedWaiting</a>, <a class="el" href="../../d2/d5/semphobj_8c-source.html#l00118">KeReleaseSemaphore()</a>, <a class="el" href="../../d3/d7/eventobj_8c-source.html#l00458">KeSetEventBoostPriority()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02296">_ERESOURCE::NumberOfExclusiveWaiters</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02295">_ERESOURCE::NumberOfSharedWaiters</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02280">_OWNER_ENTRY::OwnerCount</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02288">_ERESOURCE::OwnerTable</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02278">_OWNER_ENTRY::OwnerThread</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02293">_ERESOURCE::OwnerThreads</a>, <a class="el" href="../../d5/d9/tex_8c-source.html#l01561">Resource</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02311">ResourceOwnedExclusive</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02291">_ERESOURCE::SharedWaiters</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00062">SHORT</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02302">_ERESOURCE::SpinLock</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02281">_OWNER_ENTRY::TableSize</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
<pre class="fragment"><div>01614                    :
01615 
01616     This routine release <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified resource <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified thread
01617     and decrements <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> recursion count. If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> count reaches zero, then
01618     <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> resource may also be released.
01619 
01620     N.B. This routine uses fast locking.
01621 
01622 Arguments:
01623 
01624     <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a> - Supplies a pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> resource to release.
01625 
01626     Thread - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> thread that originally acquired <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> resource.
01627 
01628 Return Value:
01629 
01630     None.
01631 
01632 --*/
01633 
01634 {
01635 
01636     ULONG <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>;
01637     ULONG Number;
01638     KIRQL OldIrql;
01639     <a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html">POWNER_ENTRY</a> OwnerEntry;
01640 
01641     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(CurrentThread != 0);
01642 
01643     <span class="comment">//</span>
01644     <span class="comment">// Acquire exclusive access to the specified resource.</span>
01645     <span class="comment">//</span>
01646 
01647     ExAcquireFastLock(&amp;<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o12">SpinLock</a>, &amp;OldIrql);
01648 
01649     <a class="code" href="../../d7/d4/ddkresrc_8c.html#a0">ASSERT_RESOURCE</a>(Resource);
01650 
01651     <span class="comment">//</span>
01652     <span class="comment">// If the resource is exclusively owned, then release exclusive</span>
01653     <span class="comment">// ownership. Otherwise, release shared ownership.</span>
01654     <span class="comment">//</span>
01655     <span class="comment">// N.B. The two release paths are split since this is such a high</span>
01656     <span class="comment">//      frequency function.</span>
01657     <span class="comment">//</span>
01658 
01659     <span class="keywordflow">if</span> (<a class="code" href="../../d7/d4/ddkresrc_8c.html#a6">IsOwnedExclusive</a>(Resource)) {
01660 
01661         <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o6">OwnerThreads</a>[0].<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o0">OwnerThread</a> == CurrentThread);
01662 
01663         <span class="comment">//</span>
01664         <span class="comment">// Decrement the recursion count and check if ownership can be</span>
01665         <span class="comment">// released.</span>
01666         <span class="comment">//</span>
01667 
01668         <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o6">OwnerThreads</a>[0].<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o1">OwnerCount</a> &gt; 0);
01669 
01670         <span class="keywordflow">if</span> (--<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o6">OwnerThreads</a>[0].<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o1">OwnerCount</a> != 0) {
01671             ExReleaseFastLock(&amp;<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o12">SpinLock</a>, OldIrql);
01672             <span class="keywordflow">return</span>;
01673         }
01674 
01675         <span class="comment">//</span>
01676         <span class="comment">// Clear the owner thread.</span>
01677         <span class="comment">//</span>
01678 
01679         <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o6">OwnerThreads</a>[0].<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o0">OwnerThread</a> = 0;
01680 
01681         <span class="comment">//</span>
01682         <span class="comment">// The thread recursion count reached zero so decrement the resource</span>
01683         <span class="comment">// active count. If the active count reaches zero, then the resource</span>
01684         <span class="comment">// is no longer owned and an attempt should be made to grant access to</span>
01685         <span class="comment">// another thread.</span>
01686         <span class="comment">//</span>
01687 
01688         <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o2">ActiveCount</a> &gt; 0);
01689 
01690         <span class="keywordflow">if</span> (--<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o2">ActiveCount</a> == 0) {
01691 
01692             <span class="comment">//</span>
01693             <span class="comment">// If there are shared waiters, then grant shared access to the</span>
01694             <span class="comment">// resource. Otherwise, grant exclusive ownership if there are</span>
01695             <span class="comment">// exclusive waiters.</span>
01696             <span class="comment">//</span>
01697 
01698             <span class="keywordflow">if</span> (<a class="code" href="../../d8/d8/ex_2resource_8c.html#a1">IsSharedWaiting</a>(Resource)) {
01699                 <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o3">Flag</a> &amp;= ~<a class="code" href="../../d5/d8/ex_8h.html#a64">ResourceOwnedExclusive</a>;
01700                 Number = <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o8">NumberOfSharedWaiters</a>;
01701                 <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o2">ActiveCount</a> =  (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a>)Number;
01702                 <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o8">NumberOfSharedWaiters</a> = 0;
01703                 ExReleaseFastLock(&amp;<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o12">SpinLock</a>, OldIrql);
01704                 <a class="code" href="../../d1/d6/semphobj_8c.html#a3">KeReleaseSemaphore</a>(<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o4">SharedWaiters</a>, 0, Number, FALSE);
01705                 <span class="keywordflow">return</span>;
01706 
01707             } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d7/d4/ddkresrc_8c.html#a5">IsExclusiveWaiting</a>(Resource)) {
01708                 <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o6">OwnerThreads</a>[0].<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o0">OwnerThread</a> = 1;
01709                 <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o6">OwnerThreads</a>[0].<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o1">OwnerCount</a> = 1;
01710                 <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o2">ActiveCount</a> = 1;
01711                 <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o9">NumberOfExclusiveWaiters</a> -= 1;
01712                 ExReleaseFastLock(&amp;<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o12">SpinLock</a>, OldIrql);
01713                 <a class="code" href="../../d2/d8/eventobj_8c.html#a9">KeSetEventBoostPriority</a>(<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o5">ExclusiveWaiters</a>,
01714                                         (<a class="code" href="../../d1/d8/struct__KTHREAD.html">PRKTHREAD</a> *)&amp;<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o6">OwnerThreads</a>[0].<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o0">OwnerThread</a>);
01715                 <span class="keywordflow">return</span>;
01716             }
01717 
01718             <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o3">Flag</a> &amp;= ~<a class="code" href="../../d5/d8/ex_8h.html#a64">ResourceOwnedExclusive</a>;
01719         }
01720 
01721     } <span class="keywordflow">else</span> {
01722         <span class="keywordflow">if</span> (<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o6">OwnerThreads</a>[1].<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o0">OwnerThread</a> == CurrentThread) {
01723             OwnerEntry = &amp;<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o6">OwnerThreads</a>[1];
01724 
01725         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o6">OwnerThreads</a>[0].<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o0">OwnerThread</a> == CurrentThread) {
01726             OwnerEntry = &amp;<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o6">OwnerThreads</a>[0];
01727 
01728         } <span class="keywordflow">else</span> {
01729 
01730             <span class="comment">//</span>
01731             <span class="comment">// If the specified current thread is an owner address (low</span>
01732             <span class="comment">// bits are nonzero), then set the hint index to the first</span>
01733             <span class="comment">// entry. Otherwise, set the hint index from the owner thread.</span>
01734             <span class="comment">//</span>
01735 
01736             <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> = 1;
01737             <span class="keywordflow">if</span> (((ULONG)CurrentThread &amp; 3) == 0) {
01738                 <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> = ((<a class="code" href="../../d1/d8/struct__KTHREAD.html">PKTHREAD</a>)(CurrentThread))-&gt;ResourceIndex;
01739             }
01740 
01741             OwnerEntry = <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o1">OwnerTable</a>;
01742 
01743             <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(OwnerEntry != NULL);
01744 
01745             <span class="comment">//</span>
01746             <span class="comment">// If the resource hint is not within range or the resource</span>
01747             <span class="comment">// table entry does match the current thread, then search</span>
01748             <span class="comment">// the owner table for a match.</span>
01749             <span class="comment">//</span>
01750 
01751             <span class="keywordflow">if</span> ((<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> &gt;= OwnerEntry-&gt;<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o2">TableSize</a>) ||
01752                 (OwnerEntry[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>].<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o0">OwnerThread</a> != CurrentThread)) {
01753                 <span class="keywordflow">do</span> {
01754                     OwnerEntry += 1;
01755                     <span class="keywordflow">if</span> (OwnerEntry-&gt;<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o0">OwnerThread</a> == CurrentThread) {
01756                         <span class="keywordflow">break</span>;
01757                     }
01758 
01759                 } <span class="keywordflow">while</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
01760 
01761             } <span class="keywordflow">else</span> {
01762                 OwnerEntry = &amp;OwnerEntry[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>];
01763             }
01764         }
01765 
01766         <span class="comment">//</span>
01767         <span class="comment">// Decrement the recursion count and check if ownership can be</span>
01768         <span class="comment">// released.</span>
01769         <span class="comment">//</span>
01770 
01771         <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(OwnerEntry-&gt;<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o0">OwnerThread</a> == CurrentThread);
01772         <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(OwnerEntry-&gt;<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o1">OwnerCount</a> &gt; 0);
01773 
01774         <span class="keywordflow">if</span> (--OwnerEntry-&gt;<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o1">OwnerCount</a> != 0) {
01775             ExReleaseFastLock(&amp;<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o12">SpinLock</a>, OldIrql);
01776             <span class="keywordflow">return</span>;
01777         }
01778 
01779         <span class="comment">//</span>
01780         <span class="comment">// Clear the owner thread.</span>
01781         <span class="comment">//</span>
01782 
01783         OwnerEntry-&gt;<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o0">OwnerThread</a> = 0;
01784 
01785         <span class="comment">//</span>
01786         <span class="comment">// The thread recursion count reached zero so decrement the resource</span>
01787         <span class="comment">// active count. If the active count reaches zero, then the resource</span>
01788         <span class="comment">// is no longer owned and an attempt should be made to grant access to</span>
01789         <span class="comment">// another thread.</span>
01790         <span class="comment">//</span>
01791 
01792         <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o2">ActiveCount</a> &gt; 0);
01793 
01794         <span class="keywordflow">if</span> (--<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o2">ActiveCount</a> == 0) {
01795 
01796             <span class="comment">//</span>
01797             <span class="comment">// If there are exclusive waiters, then grant exclusive access</span>
01798             <span class="comment">// to the resource.</span>
01799             <span class="comment">//</span>
01800 
01801             <span class="keywordflow">if</span> (<a class="code" href="../../d7/d4/ddkresrc_8c.html#a5">IsExclusiveWaiting</a>(Resource)) {
01802                 <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o3">Flag</a> |= <a class="code" href="../../d5/d8/ex_8h.html#a64">ResourceOwnedExclusive</a>;
01803                 <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o6">OwnerThreads</a>[0].<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o0">OwnerThread</a> = 1;
01804                 <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o6">OwnerThreads</a>[0].<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o1">OwnerCount</a> = 1;
01805                 <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o2">ActiveCount</a> = 1;
01806                 <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o9">NumberOfExclusiveWaiters</a> -= 1;
01807                 ExReleaseFastLock(&amp;<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o12">SpinLock</a>, OldIrql);
01808                 <a class="code" href="../../d2/d8/eventobj_8c.html#a9">KeSetEventBoostPriority</a>(<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o5">ExclusiveWaiters</a>,
01809                                         (<a class="code" href="../../d1/d8/struct__KTHREAD.html">PRKTHREAD</a> *)&amp;<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o6">OwnerThreads</a>[0].<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o0">OwnerThread</a>);
01810                 <span class="keywordflow">return</span>;
01811             }
01812         }
01813     }
01814 
01815     ExReleaseFastLock(&amp;<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o12">SpinLock</a>, OldIrql);
01816     <span class="keywordflow">return</span>;
01817 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a273" doxytag="ex.h::ExReleaseResourceLite" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI VOID FASTCALL ExReleaseResourceLite           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d6/d4/struct__ERESOURCE.html">PERESOURCE</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Resource</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l01389">1389</a> of file <a class="el" href="../../d9/d7/ex_2resource_8c-source.html">ex/resource.c</a>.
<p>
References <a class="el" href="../../d6/d7/ex_8h-source.html#l02289">_ERESOURCE::ActiveCount</a>, <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d8/d3/ddkresrc_8c-source.html#l00070">ASSERT_RESOURCE</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02274">ERESOURCE_THREAD</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02292">_ERESOURCE::ExclusiveWaiters</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02290">_ERESOURCE::Flag</a>, <a class="el" href="../../d2/d9/cmchek_8c-source.html#l00095">Index</a>, <a class="el" href="../../d8/d3/ddkresrc_8c-source.html#l00089">IsExclusiveWaiting</a>, <a class="el" href="../../d8/d3/ddkresrc_8c-source.html#l00091">IsOwnedExclusive</a>, <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l00049">IsSharedWaiting</a>, <a class="el" href="../../d0/d1/bugcheck_8c-source.html#l00428">KeBugCheckEx()</a>, <a class="el" href="../../d2/d5/semphobj_8c-source.html#l00118">KeReleaseSemaphore()</a>, <a class="el" href="../../d3/d7/eventobj_8c-source.html#l00458">KeSetEventBoostPriority()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02296">_ERESOURCE::NumberOfExclusiveWaiters</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02295">_ERESOURCE::NumberOfSharedWaiters</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02280">_OWNER_ENTRY::OwnerCount</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02288">_ERESOURCE::OwnerTable</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02278">_OWNER_ENTRY::OwnerThread</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02293">_ERESOURCE::OwnerThreads</a>, <a class="el" href="../../d2/d8/ps_8h-source.html#l00645">PsGetCurrentThread</a>, <a class="el" href="../../d5/d9/tex_8c-source.html#l01561">Resource</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02311">ResourceOwnedExclusive</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02291">_ERESOURCE::SharedWaiters</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00062">SHORT</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02302">_ERESOURCE::SpinLock</a>, and <a class="el" href="../../d6/d7/ex_8h-source.html#l02281">_OWNER_ENTRY::TableSize</a>.
<p>
Referenced by <a class="el" href="../../d6/d9/wsmanage_8c-source.html#l02986">MmTrimAllSystemPagableMemory()</a>, and <a class="el" href="../../d0/d5/verifier_8c-source.html#l02208">VerifierExReleaseResource()</a>.
<p>
<pre class="fragment"><div>01395                    :
01396 
01397     This routine releases <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified resource <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> current thread
01398     and decrements <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> recursion count. If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> count reaches zero, then
01399     <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> resource may also be released.
01400 
01401     N.B. This routine uses fast locking.
01402 
01403 Arguments:
01404 
01405     <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a> - Supplies a pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> resource to release.
01406 
01407 Return Value:
01408 
01409     None.
01410 
01411 --*/
01412 
01413 {
01414 
01415     <a class="code" href="../../d5/d8/ex_8h.html#a121">ERESOURCE_THREAD</a> CurrentThread;
01416     ULONG <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>;
01417     ULONG Number;
01418     KIRQL OldIrql;
01419     <a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html">POWNER_ENTRY</a> OwnerEntry, OwnerEnd;
01420 
01421     CurrentThread = (<a class="code" href="../../d5/d8/ex_8h.html#a121">ERESOURCE_THREAD</a>)<a class="code" href="../../d1/d9/ps_8h.html#a20">PsGetCurrentThread</a>();
01422 
01423     <span class="comment">//</span>
01424     <span class="comment">// Acquire exclusive access to the specified resource.</span>
01425     <span class="comment">//</span>
01426 
01427     ExAcquireFastLock(&amp;<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o12">SpinLock</a>, &amp;OldIrql);
01428 
01429     <a class="code" href="../../d7/d4/ddkresrc_8c.html#a0">ASSERT_RESOURCE</a>(Resource);
01430 
01431     <span class="comment">//</span>
01432     <span class="comment">// If the resource is exclusively owned, then release exclusive</span>
01433     <span class="comment">// ownership. Otherwise, release shared ownership.</span>
01434     <span class="comment">//</span>
01435     <span class="comment">// N.B. The two release paths are split since this is such a high</span>
01436     <span class="comment">//      frequency function.</span>
01437     <span class="comment">//</span>
01438 
01439     <span class="keywordflow">if</span> (<a class="code" href="../../d7/d4/ddkresrc_8c.html#a6">IsOwnedExclusive</a>(Resource)) {
01440 
01441 <span class="comment">//        if (Resource-&gt;OwnerThreads[0].OwnerThread != CurrentThread) {</span>
01442 <span class="comment">//            KeBugCheckEx(RESOURCE_NOT_OWNED,</span>
01443 <span class="comment">//                         (ULONG_PTR)Resource,</span>
01444 <span class="comment">//                         (ULONG_PTR)CurrentThread,</span>
01445 <span class="comment">//                         (ULONG_PTR)Resource-&gt;OwnerTable,</span>
01446 <span class="comment">//                         0x1);</span>
01447 <span class="comment">//        }</span>
01448 
01449         <span class="comment">//</span>
01450         <span class="comment">// Decrement the recursion count and check if ownership can be</span>
01451         <span class="comment">// released.</span>
01452         <span class="comment">//</span>
01453 
01454         <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o6">OwnerThreads</a>[0].<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o1">OwnerCount</a> &gt; 0);
01455 
01456         <span class="keywordflow">if</span> (--<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o6">OwnerThreads</a>[0].<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o1">OwnerCount</a> != 0) {
01457             ExReleaseFastLock(&amp;<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o12">SpinLock</a>, OldIrql);
01458             <span class="keywordflow">return</span>;
01459         }
01460 
01461         <span class="comment">//</span>
01462         <span class="comment">// Clear the owner thread.</span>
01463         <span class="comment">//</span>
01464 
01465         <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o6">OwnerThreads</a>[0].<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o0">OwnerThread</a> = 0;
01466 
01467         <span class="comment">//</span>
01468         <span class="comment">// The thread recursion count reached zero so decrement the resource</span>
01469         <span class="comment">// active count. If the active count reaches zero, then the resource</span>
01470         <span class="comment">// is no longer owned and an attempt should be made to grant access to</span>
01471         <span class="comment">// another thread.</span>
01472         <span class="comment">//</span>
01473 
01474         <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o2">ActiveCount</a> &gt; 0);
01475 
01476         <span class="keywordflow">if</span> (--<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o2">ActiveCount</a> == 0) {
01477 
01478             <span class="comment">//</span>
01479             <span class="comment">// If there are shared waiters, then grant shared access to the</span>
01480             <span class="comment">// resource. Otherwise, grant exclusive ownership if there are</span>
01481             <span class="comment">// exclusive waiters.</span>
01482             <span class="comment">//</span>
01483 
01484             <span class="keywordflow">if</span> (<a class="code" href="../../d8/d8/ex_2resource_8c.html#a1">IsSharedWaiting</a>(Resource)) {
01485                 <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o3">Flag</a> &amp;= ~<a class="code" href="../../d5/d8/ex_8h.html#a64">ResourceOwnedExclusive</a>;
01486                 Number = <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o8">NumberOfSharedWaiters</a>;
01487                 <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o2">ActiveCount</a> =  (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a13">SHORT</a>)Number;
01488                 <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o8">NumberOfSharedWaiters</a> = 0;
01489                 ExReleaseFastLock(&amp;<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o12">SpinLock</a>, OldIrql);
01490                 <a class="code" href="../../d1/d6/semphobj_8c.html#a3">KeReleaseSemaphore</a>(<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o4">SharedWaiters</a>, 0, Number, FALSE);
01491                 <span class="keywordflow">return</span>;
01492 
01493             } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d7/d4/ddkresrc_8c.html#a5">IsExclusiveWaiting</a>(Resource)) {
01494                 <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o6">OwnerThreads</a>[0].<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o0">OwnerThread</a> = 1;
01495                 <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o6">OwnerThreads</a>[0].<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o1">OwnerCount</a> = 1;
01496                 <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o2">ActiveCount</a> = 1;
01497                 <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o9">NumberOfExclusiveWaiters</a> -= 1;
01498                 ExReleaseFastLock(&amp;<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o12">SpinLock</a>, OldIrql);
01499                 <a class="code" href="../../d2/d8/eventobj_8c.html#a9">KeSetEventBoostPriority</a>(<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o5">ExclusiveWaiters</a>,
01500                                         (<a class="code" href="../../d1/d8/struct__KTHREAD.html">PRKTHREAD</a> *)&amp;<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o6">OwnerThreads</a>[0].<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o0">OwnerThread</a>);
01501                 <span class="keywordflow">return</span>;
01502             }
01503 
01504             <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o3">Flag</a> &amp;= ~<a class="code" href="../../d5/d8/ex_8h.html#a64">ResourceOwnedExclusive</a>;
01505         }
01506 
01507     } <span class="keywordflow">else</span> {
01508         <span class="keywordflow">if</span> (<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o6">OwnerThreads</a>[1].<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o0">OwnerThread</a> == CurrentThread) {
01509             OwnerEntry = &amp;<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o6">OwnerThreads</a>[1];
01510 
01511         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o6">OwnerThreads</a>[0].<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o0">OwnerThread</a> == CurrentThread) {
01512             OwnerEntry = &amp;<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o6">OwnerThreads</a>[0];
01513 
01514         } <span class="keywordflow">else</span> {
01515             <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> = ((<a class="code" href="../../d1/d8/struct__KTHREAD.html">PKTHREAD</a>)(CurrentThread))-&gt;ResourceIndex;
01516             OwnerEntry = <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o1">OwnerTable</a>;
01517 
01518             <span class="keywordflow">if</span> (OwnerEntry == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01519                 <a class="code" href="../../d9/d1/bugcheck_8c.html#a19">KeBugCheckEx</a>(RESOURCE_NOT_OWNED,
01520                              (ULONG_PTR)Resource,
01521                              (ULONG_PTR)CurrentThread,
01522                              (ULONG_PTR)<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o1">OwnerTable</a>,
01523                              0x2);
01524             }
01525 
01526             <span class="comment">//</span>
01527             <span class="comment">// If the resource hint is not within range or the resource</span>
01528             <span class="comment">// table entry does match the current thread, then search</span>
01529             <span class="comment">// the owner table for a match.</span>
01530             <span class="comment">//</span>
01531 
01532             <span class="keywordflow">if</span> ((<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> &gt;= OwnerEntry-&gt;<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o2">TableSize</a>) ||
01533                 (OwnerEntry[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>].<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o0">OwnerThread</a> != CurrentThread)) {
01534                 OwnerEnd = &amp;OwnerEntry[OwnerEntry-&gt;TableSize];
01535                 <span class="keywordflow">while</span> (1) {
01536                     OwnerEntry += 1;
01537                     <span class="keywordflow">if</span> (OwnerEntry &gt;= OwnerEnd) {
01538                        <a class="code" href="../../d9/d1/bugcheck_8c.html#a19">KeBugCheckEx</a>(RESOURCE_NOT_OWNED,
01539                              (ULONG_PTR)Resource,
01540                              (ULONG_PTR)CurrentThread,
01541                              (ULONG_PTR)<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o1">OwnerTable</a>,
01542                              0x3);
01543                     }
01544                     <span class="keywordflow">if</span> (OwnerEntry-&gt;OwnerThread == CurrentThread) {
01545                         <span class="keywordflow">break</span>;
01546                     }
01547                 };
01548             } <span class="keywordflow">else</span> {
01549                 OwnerEntry = &amp;OwnerEntry[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>];
01550             }
01551         }
01552 
01553         <span class="comment">//</span>
01554         <span class="comment">// Decrement the recursion count and check if ownership can be</span>
01555         <span class="comment">// released.</span>
01556         <span class="comment">//</span>
01557 
01558         <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(OwnerEntry-&gt;OwnerThread == CurrentThread);
01559         <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(OwnerEntry-&gt;OwnerCount &gt; 0);
01560 
01561         <span class="keywordflow">if</span> (--OwnerEntry-&gt;OwnerCount != 0) {
01562             ExReleaseFastLock(&amp;<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o12">SpinLock</a>, OldIrql);
01563             <span class="keywordflow">return</span>;
01564         }
01565 
01566         <span class="comment">//</span>
01567         <span class="comment">// Clear the owner thread.</span>
01568         <span class="comment">//</span>
01569 
01570         OwnerEntry-&gt;OwnerThread = 0;
01571 
01572         <span class="comment">//</span>
01573         <span class="comment">// The thread recursion count reached zero so decrement the resource</span>
01574         <span class="comment">// active count. If the active count reaches zero, then the resource</span>
01575         <span class="comment">// is no longer owned and an attempt should be made to grant access to</span>
01576         <span class="comment">// another thread.</span>
01577         <span class="comment">//</span>
01578 
01579         <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o2">ActiveCount</a> &gt; 0);
01580 
01581         <span class="keywordflow">if</span> (--<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o2">ActiveCount</a> == 0) {
01582 
01583             <span class="comment">//</span>
01584             <span class="comment">// If there are exclusive waiters, then grant exclusive access</span>
01585             <span class="comment">// to the resource.</span>
01586             <span class="comment">//</span>
01587 
01588             <span class="keywordflow">if</span> (<a class="code" href="../../d7/d4/ddkresrc_8c.html#a5">IsExclusiveWaiting</a>(Resource)) {
01589                 <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o3">Flag</a> |= <a class="code" href="../../d5/d8/ex_8h.html#a64">ResourceOwnedExclusive</a>;
01590                 <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o6">OwnerThreads</a>[0].<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o0">OwnerThread</a> = 1;
01591                 <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o6">OwnerThreads</a>[0].<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o1">OwnerCount</a> = 1;
01592                 <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o2">ActiveCount</a> = 1;
01593                 <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o9">NumberOfExclusiveWaiters</a> -= 1;
01594                 ExReleaseFastLock(&amp;<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o12">SpinLock</a>, OldIrql);
01595                 <a class="code" href="../../d2/d8/eventobj_8c.html#a9">KeSetEventBoostPriority</a>(<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o5">ExclusiveWaiters</a>,
01596                                         (<a class="code" href="../../d1/d8/struct__KTHREAD.html">PRKTHREAD</a> *)&amp;<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o6">OwnerThreads</a>[0].<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o0">OwnerThread</a>);
01597                 <span class="keywordflow">return</span>;
01598             }
01599         }
01600     }
01601 
01602     ExReleaseFastLock(&amp;<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o12">SpinLock</a>, OldIrql);
01603     <span class="keywordflow">return</span>;
01604 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a313" doxytag="ex.h::ExReleaseTimeRefreshLock" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID ExReleaseTimeRefreshLock           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d9/d2/kdapi_8c-source.html#l00528">KdpTimeSlipWork()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a291" doxytag="ex.h::ExRemoveHandleTable" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI VOID ExRemoveHandleTable           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d6/d3/struct__HANDLE__TABLE.html">PHANDLE_TABLE</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>HandleTable</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l00501">501</a> of file <a class="el" href="../../d1/d7/ex_2handle_8c-source.html">ex/handle.c</a>.
<p>
References <a class="el" href="../../d6/d7/ex_8h-source.html#l02475">ExAcquireResourceExclusive</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02393">ExReleaseResource</a>, <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l00036">HandleTableListLock</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l01598">KeEnterCriticalRegion</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l01628">KeLeaveCriticalRegion</a>, <a class="el" href="../../d1/d8/ntosdef_8h-source.html#l00462">PAGED_CODE</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l00560">ExDestroyHandleTable()</a>, <a class="el" href="../../d1/d0/psinit_8c-source.html#l00181">PspInitPhase0()</a>, and <a class="el" href="../../d1/d9/rtl_2atom_8c-source.html#l00112">RtlpInitializeHandleTableForAtomTable()</a>.
<p>
<pre class="fragment"><div>00507                    :
00508 
00509     This function removes <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified exhandle table from <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> list of
00510     exhandle tables.  Used by PS and ATOM packages to make sure their handle
00511     tables are not in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> list enumerated by <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d0/d8/ex_2handle_8c.html#a21">ExSnapShotHandleTables</a>
00512     routine and <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> !handle debugger <a class="code" href="../../d7/d1/genuedef_8c.html#a6">extension</a>.
00513 
00514 Arguments:
00515 
00516     HandleTable - Supplies a pointer to a handle table
00517 
00518 Return Value:
00519 
00520     None.
00521 
00522 --*/
00523 
00524 {
00525     <a class="code" href="../../d0/d9/ntosdef_8h.html#a28">PAGED_CODE</a>();
00526 
00527     <span class="comment">//</span>
00528     <span class="comment">//  First, acquire the global handle table lock</span>
00529     <span class="comment">//</span>
00530 
00531     <a class="code" href="../../d4/d9/ke_8h.html#a28">KeEnterCriticalRegion</a>();
00532     <a class="code" href="../../d5/d8/ex_8h.html#a70">ExAcquireResourceExclusive</a>( &amp;HandleTableListLock, TRUE );
00533 
00534     <span class="comment">//</span>
00535     <span class="comment">//  Remove the handle table from the handle table list.  This routine is</span>
00536     <span class="comment">//  written so that multiple calls to remove a handle table will not</span>
00537     <span class="comment">//  corrupt the system.</span>
00538     <span class="comment">//</span>
00539 
00540     <span class="keywordflow">if</span> (!IsListEmpty( &amp;HandleTable-&gt;HandleTableList )) {
00541 
00542         RemoveEntryList( &amp;HandleTable-&gt;HandleTableList );
00543 
00544         InitializeListHead( &amp;HandleTable-&gt;HandleTableList );
00545     }
00546 
00547     <span class="comment">//</span>
00548     <span class="comment">//  Now release the global lock and return to our caller</span>
00549     <span class="comment">//</span>
00550 
00551     <a class="code" href="../../d5/d8/ex_8h.html#a66">ExReleaseResource</a>( &amp;HandleTableListLock );
00552     <a class="code" href="../../d4/d9/ke_8h.html#a29">KeLeaveCriticalRegion</a>();
00553 
00554     <span class="keywordflow">return</span>;
00555 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a230" doxytag="ex.h::ExReturnPoolQuota" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID ExReturnPoolQuota           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PVOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>P</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l03480">3480</a> of file <a class="el" href="../../d3/d1/ex_2pool_8c-source.html">ex/pool.c</a>.
<p>
References <a class="el" href="../../d5/d1/pool_8h-source.html#l00050">BASE_POOL_TYPE_MASK</a>, <a class="el" href="../../d5/d1/pool_8h-source.html#l00171">_POOL_HEADER::BlockSize</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00418">DECODE_POOL_INDEX</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00098">LOCK_POOL_GRANULAR</a>, <a class="el" href="../../d3/d0/mm_8h-source.html#l01977">MmSpecialPoolEnd</a>, <a class="el" href="../../d3/d0/mm_8h-source.html#l01976">MmSpecialPoolStart</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d5/d9/ob_8h-source.html#l00494">ObDereferenceObject</a>, <a class="el" href="../../d5/d8/ex_8h.html#a329a174">PagedPool</a>, <a class="el" href="../../d5/d1/pool_8h-source.html#l00096">POOL_BLOCK_SHIFT</a>, <a class="el" href="../../d6/d1/poolhack_8c-source.html#l00116">POOL_OVERHEAD</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00041">POOL_QUOTA_ENABLED</a>, <a class="el" href="../../d5/d1/pool_8h-source.html#l00073">POOL_QUOTA_MASK</a>, <a class="el" href="../../d5/d8/ex_8h.html#a96">POOL_TYPE</a>, <a class="el" href="../../d5/d1/pool_8h-source.html#l00075">POOL_TYPE_MASK</a>, <a class="el" href="../../d5/d1/pool_8h-source.html#l00181">_POOL_HEADER::PoolTag</a>, <a class="el" href="../../d6/d1/poolhack_8c-source.html#l00106">_POOL_HEADER::PoolType</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00451">PoolVector</a>, <a class="el" href="../../d6/d1/poolhack_8c-source.html#l00112">_POOL_HEADER::ProcessBilled</a>, <a class="el" href="../../d1/d1/psquota_8c-source.html#l00356">PsReturnPoolQuota()</a>, and <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00099">UNLOCK_POOL_GRANULAR</a>.
<p>
Referenced by <a class="el" href="../../d5/d5/iosubs_8c-source.html#l06641">IopFreeIrp()</a>, and <a class="el" href="../../d6/d3/complete_8c-source.html#l00797">IopFreeMiniPacket()</a>.
<p>
<pre class="fragment"><div>03486                    :
03487 
03488     This function returns quota charged to a subject process when <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
03489     specified <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a> block was allocated.
03490 
03491 Arguments:
03492 
03493     P - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> address of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> block of <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a> being deallocated.
03494 
03495 Return Value:
03496 
03497     None.
03498 
03499 --*/
03500 
03501 {
03502 
03503     <a class="code" href="../../d5/d8/struct__POOL__HEADER.html">PPOOL_HEADER</a> Entry;
03504     <a class="code" href="../../d5/d8/ex_8h.html#a96">POOL_TYPE</a> PoolType;
03505     <a class="code" href="../../d0/d4/struct__EPROCESS.html">PEPROCESS</a> Process;
03506 <span class="preprocessor">#if defined(_ALPHA_) &amp;&amp; !defined(_AXP64_)</span>
03507 <span class="preprocessor"></span>    <a class="code" href="../../d4/d8/struct__POOL__DESCRIPTOR.html">PPOOL_DESCRIPTOR</a> PoolDesc;
03508     KIRQL LockHandle;
03509 <span class="preprocessor">#endif</span>
03510 <span class="preprocessor"></span>
03511     <span class="comment">//</span>
03512     <span class="comment">//  Do nothing for special pool. No quota was charged.</span>
03513     <span class="comment">//</span>
03514     
03515     <span class="keywordflow">if</span> ((P &gt;= <a class="code" href="../../d2/d1/mm_8h.html#a160">MmSpecialPoolStart</a>) &amp;&amp; (P &lt; <a class="code" href="../../d2/d1/mm_8h.html#a161">MmSpecialPoolEnd</a>)) {
03516         
03517         <span class="keywordflow">return</span>;
03518     }
03519 
03520     <span class="comment">//</span>
03521     <span class="comment">// Align the entry address to a pool allocation boundary.</span>
03522     <span class="comment">//</span>
03523 
03524 <span class="preprocessor">#if POOL_CACHE_SUPPORTED</span>
03525 <span class="preprocessor"></span>
03526     <span class="keywordflow">if</span> (((ULONG)P &amp; POOL_CACHE_CHECK) == 0) {
03527         Entry = (<a class="code" href="../../d5/d8/struct__POOL__HEADER.html">PPOOL_HEADER</a>)((ULONG)P - PoolCacheSize);
03528 
03529     } <span class="keywordflow">else</span> {
03530         Entry = (<a class="code" href="../../d5/d8/struct__POOL__HEADER.html">PPOOL_HEADER</a>)((PCHAR)P - <a class="code" href="../../d5/d2/poolhack_8c.html#a6">POOL_OVERHEAD</a>);
03531     }
03532 
03533 <span class="preprocessor">#else</span>
03534 <span class="preprocessor"></span>
03535     Entry = (<a class="code" href="../../d5/d8/struct__POOL__HEADER.html">PPOOL_HEADER</a>)((PCHAR)P - <a class="code" href="../../d5/d2/poolhack_8c.html#a6">POOL_OVERHEAD</a>);
03536 
03537 <span class="preprocessor">#endif //POOL_CACHE_SUPPORTED</span>
03538 <span class="preprocessor"></span>
03539     <span class="comment">//</span>
03540     <span class="comment">// If quota was charged, then return the appropriate quota to the</span>
03541     <span class="comment">// subject process.</span>
03542     <span class="comment">//</span>
03543 
03544     <span class="keywordflow">if</span> ((Entry-&gt;<a class="code" href="../../d5/d8/struct__POOL__HEADER.html#o1">PoolType</a> &amp; <a class="code" href="../../d4/d2/pool_8h.html#a11">POOL_QUOTA_MASK</a>) &amp;&amp; <a class="code" href="../../d2/d2/ex_2pool_8c.html#a0">POOL_QUOTA_ENABLED</a>) {
03545 
03546         PoolType = (Entry-&gt;<a class="code" href="../../d5/d8/struct__POOL__HEADER.html#o1">PoolType</a> &amp; <a class="code" href="../../d4/d2/pool_8h.html#a12">POOL_TYPE_MASK</a>) - 1;
03547 
03548 <span class="preprocessor">#if _POOL_LOCK_GRANULAR_</span>
03549 <span class="preprocessor"></span>        PoolDesc = <a class="code" href="../../d2/d2/ex_2pool_8c.html#a54">PoolVector</a>[PoolType];
03550         <span class="keywordflow">if</span> (PoolType == <a class="code" href="../../d5/d8/ex_8h.html#a329a174">PagedPool</a>) {
03551             PoolDesc = &amp;PoolDesc[<a class="code" href="../../d2/d2/ex_2pool_8c.html#a27">DECODE_POOL_INDEX</a>(Entry)];
03552         }
03553 <span class="preprocessor">#endif</span>
03554 <span class="preprocessor"></span>
03555         <a class="code" href="../../d2/d2/ex_2pool_8c.html#a6">LOCK_POOL_GRANULAR</a>(PoolDesc, LockHandle);
03556 
03557         Entry-&gt;<a class="code" href="../../d5/d8/struct__POOL__HEADER.html#o1">PoolType</a> &amp;= ~<a class="code" href="../../d4/d2/pool_8h.html#a11">POOL_QUOTA_MASK</a>;
03558 
03559         <a class="code" href="../../d2/d2/ex_2pool_8c.html#a7">UNLOCK_POOL_GRANULAR</a>(PoolDesc, LockHandle);
03560 
03561         Process = Entry-&gt;<a class="code" href="../../d5/d8/struct__POOL__HEADER.html#o2">ProcessBilled</a>;
03562 
03563 <span class="preprocessor">#if !defined (_WIN64)</span>
03564 <span class="preprocessor"></span>        Entry-&gt;<a class="code" href="../../d5/d8/struct__POOL__HEADER.html#o9">PoolTag</a> = 'atoQ';
03565 <span class="preprocessor">#endif</span>
03566 <span class="preprocessor"></span>
03567         <span class="keywordflow">if</span> (Process != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
03568             <a class="code" href="../../d0/d2/psquota_8c.html#a3">PsReturnPoolQuota</a>(Process,
03569                               PoolType &amp; BASE_POOL_TYPE_MASK,
03570                               (ULONG)Entry-&gt;<a class="code" href="../../d5/d8/struct__POOL__HEADER.html#o6">BlockSize</a> &lt;&lt; POOL_BLOCK_SHIFT);
03571 
03572             <a class="code" href="../../d4/d0/ob_8h.html#a14">ObDereferenceObject</a>(Process);
03573         }
03574 
03575     }
03576 
03577     <span class="keywordflow">return</span>;
03578 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a275" doxytag="ex.h::ExSetResourceOwnerPointer" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI VOID ExSetResourceOwnerPointer           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d6/d4/struct__ERESOURCE.html">PERESOURCE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Resource</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>OwnerPointer</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l01820">1820</a> of file <a class="el" href="../../d9/d7/ex_2resource_8c-source.html">ex/resource.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d8/d3/ddkresrc_8c-source.html#l00070">ASSERT_RESOURCE</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02274">ERESOURCE_THREAD</a>, <a class="el" href="../../d2/d9/cmchek_8c-source.html#l00095">Index</a>, <a class="el" href="../../d8/d3/ddkresrc_8c-source.html#l00091">IsOwnedExclusive</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02280">_OWNER_ENTRY::OwnerCount</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02288">_ERESOURCE::OwnerTable</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02278">_OWNER_ENTRY::OwnerThread</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02293">_ERESOURCE::OwnerThreads</a>, <a class="el" href="../../d2/d8/ps_8h-source.html#l00645">PsGetCurrentThread</a>, <a class="el" href="../../d5/d9/tex_8c-source.html#l01561">Resource</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02302">_ERESOURCE::SpinLock</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02281">_OWNER_ENTRY::TableSize</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d3/d8/pinsup_8c-source.html#l01078">CcSetBcbOwnerPointer()</a>.
<p>
<pre class="fragment"><div>01827                    :
01828 
01829     This routine locates <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> owner entry <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> current thread and stores
01830     <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified owner address as <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> owner thread. Subsequent to calling
01831     <span class="keyword">this</span> routine, <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d3/d0/imm32_8def.html#a1">only</a> routine which may be called <span class="keywordflow">for</span> <span class="keyword">this</span> resource <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a>
01832     <a class="code" href="../../d5/d8/ex_8h.html#a71">ExReleaseResourceForThread</a>, supplying <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> owner address as <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <span class="stringliteral">"thread"</span>.
01833 
01834     <a class="code" href="../../d6/d0/ctaccess_8c.html#a53">Owner</a> addresses must obey <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> following rules:
01835 
01836         They must be a unique pointer to a structure allocated in system space,
01837         and they must point to a structure which remains allocated until after
01838         <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> call to <a class="code" href="../../d5/d8/ex_8h.html#a71">ExReleaseResourceForThread</a>. This <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to eliminate aliasing
01839         with a thread or other owner address.
01840 
01841         The <a class="code" href="../../d2/d3/fetypes_8h.html#a457a418">low</a> order two bits of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> owner address must be set by <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> caller,
01842         so that other <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a24">routines</a> in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> resource <span class="keyword">package </span>can distinguish owner
01843         address from thread addresses.
01844 
01845     N.B. This routine uses fast locking.
01846 
01847 Arguments:
01848 
01849     Resource - Supplies a pointer to the resource to release.
01850 
01851     OwnerPointer - Supplies a pointer to an allocated structure with the low
01852         order two bits set.
01853 
01854 Return Value:
01855 
01856     None.
01857 
01858 --*/
01859 
01860 {
01861 
01862     ERESOURCE_THREAD CurrentThread;
01863     ULONG <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>;
01864     KIRQL OldIrql;
01865     <a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html">POWNER_ENTRY</a> OwnerEntry;
01866 
01867     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>((OwnerPointer != 0) &amp;&amp; (((ULONG_PTR)OwnerPointer &amp; 3) == 3));
01868 
01869     CurrentThread = (<a class="code" href="../../d5/d8/ex_8h.html#a121">ERESOURCE_THREAD</a>)<a class="code" href="../../d1/d9/ps_8h.html#a20">PsGetCurrentThread</a>();
01870 
01871     <span class="comment">//</span>
01872     <span class="comment">// Acquire exclusive access to the specified resource.</span>
01873     <span class="comment">//</span>
01874 
01875     ExAcquireFastLock(&amp;<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o12">SpinLock</a>, &amp;OldIrql);
01876 
01877     <a class="code" href="../../d7/d4/ddkresrc_8c.html#a0">ASSERT_RESOURCE</a>(Resource);
01878 
01879     <span class="comment">//</span>
01880     <span class="comment">// If the resource is exclusively owned, then it is the first owner entry.</span>
01881     <span class="comment">//</span>
01882 
01883     <span class="keywordflow">if</span> (<a class="code" href="../../d7/d4/ddkresrc_8c.html#a6">IsOwnedExclusive</a>(Resource)) {
01884 
01885         <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o6">OwnerThreads</a>[0].<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o0">OwnerThread</a> == CurrentThread);
01886 
01887         <span class="comment">//</span>
01888         <span class="comment">// Set the owner address.</span>
01889         <span class="comment">//</span>
01890 
01891         <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o6">OwnerThreads</a>[0].<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o1">OwnerCount</a> &gt; 0);
01892 
01893         <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o6">OwnerThreads</a>[0].<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o0">OwnerThread</a> = (ULONG_PTR)OwnerPointer;
01894 
01895     <span class="comment">//</span>
01896     <span class="comment">//  For shared access we have to search for the current thread to set</span>
01897     <span class="comment">//  the owner address.</span>
01898     <span class="comment">//</span>
01899 
01900     } <span class="keywordflow">else</span> {
01901         <span class="keywordflow">if</span> (<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o6">OwnerThreads</a>[1].<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o0">OwnerThread</a> == CurrentThread) {
01902             <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o6">OwnerThreads</a>[1].<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o0">OwnerThread</a> = (ULONG_PTR)OwnerPointer;
01903 
01904         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o6">OwnerThreads</a>[0].<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o0">OwnerThread</a> == CurrentThread) {
01905             <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o6">OwnerThreads</a>[0].<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o0">OwnerThread</a> = (ULONG_PTR)OwnerPointer;
01906 
01907         } <span class="keywordflow">else</span> {
01908             <a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> = ((<a class="code" href="../../d1/d8/struct__KTHREAD.html">PKTHREAD</a>)(CurrentThread))-&gt;ResourceIndex;
01909             OwnerEntry = <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o1">OwnerTable</a>;
01910 
01911             <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(OwnerEntry != NULL);
01912 
01913             <span class="comment">//</span>
01914             <span class="comment">// If the resource hint is not within range or the resource</span>
01915             <span class="comment">// table entry does match the current thread, then search</span>
01916             <span class="comment">// the owner table for a match.</span>
01917             <span class="comment">//</span>
01918 
01919             <span class="keywordflow">if</span> ((<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a> &gt;= OwnerEntry-&gt;TableSize) ||
01920                 (OwnerEntry[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>].OwnerThread != CurrentThread)) {
01921                 <span class="keywordflow">do</span> {
01922                     OwnerEntry += 1;
01923                     <span class="keywordflow">if</span> (OwnerEntry-&gt;OwnerThread == CurrentThread) {
01924                         <span class="keywordflow">break</span>;
01925                     }
01926 
01927                 } <span class="keywordflow">while</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
01928 
01929             } <span class="keywordflow">else</span> {
01930                 OwnerEntry = &amp;OwnerEntry[<a class="code" href="../../d1/d0/cmchek_8c.html#a10">Index</a>];
01931             }
01932 
01933             OwnerEntry-&gt;OwnerThread = (ULONG_PTR)OwnerPointer;
01934         }
01935     }
01936 
01937     ExReleaseFastLock(&amp;<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o12">SpinLock</a>, OldIrql);
01938     <span class="keywordflow">return</span>;
01939 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a316" doxytag="ex.h::ExSetTimerResolution" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI ULONG ExSetTimerResolution           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>DesiredTime</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>SetResolution</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a311" doxytag="ex.h::ExShutdownSystem" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID ExShutdownSystem           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a295" doxytag="ex.h::ExSnapShotHandleTables" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI NTSTATUS ExSnapShotHandleTables           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d5/d8/ex_8h.html#a142">PEX_SNAPSHOT_HANDLE_ENTRY</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>SnapShotHandleEntry</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN OUT PSYSTEM_HANDLE_INFORMATION&nbsp;</td>
          <td class="mdname" nowrap> <em>HandleInformation</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Length</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN OUT PULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>RequiredLength</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l00984">984</a> of file <a class="el" href="../../d1/d7/ex_2handle_8c-source.html">ex/handle.c</a>.
<p>
References <a class="el" href="../../d6/d7/ex_8h-source.html#l02475">ExAcquireResourceExclusive</a>, <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l00240">ExLockHandleTableEntry()</a>, <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l00146">ExLockHandleTableExclusive()</a>, <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l02195">ExpLookupHandleTableEntry()</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02393">ExReleaseResource</a>, <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l00336">ExUnlockHandleTableEntry()</a>, <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l00209">ExUnlockHandleTableExclusive()</a>, <a class="el" href="../../d8/d9/cmdat2_8c-source.html#l00091">Handle</a>, <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l00037">HandleTableListHead</a>, <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l00036">HandleTableListLock</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l01598">KeEnterCriticalRegion</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l01628">KeLeaveCriticalRegion</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02672">_HANDLE_TABLE_ENTRY::Object</a>, <a class="el" href="../../d1/d8/ntosdef_8h-source.html#l00462">PAGED_CODE</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00135">Status</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, and <a class="el" href="../../d6/d7/ex_8h-source.html#l02737">_HANDLE_TABLE::UniqueProcessId</a>.
<p>
Referenced by <a class="el" href="../../d0/d0/obhandle_8c-source.html#l00745">ObGetHandleInformation()</a>.
<p>
<pre class="fragment"><div>00993                    :
00994 
00995     This function visits and invokes <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified callback <span class="keywordflow">for</span> every valid
00996     handle that <a class="code" href="../../d1/d9/icmui_8def.html#a4">it</a> can find off of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> handle table.
00997 
00998 Arguments:
00999 
01000     SnapShotHandleEntry - Supplies a pointer to a function to call <span class="keywordflow">for</span>
01001         each valid handle we encounter.
01002 
01003     HandleInformation - Supplies a handle information structure to
01004         be filled in <span class="keywordflow">for</span> each handle table we encounter.  This routine
01005         fills in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> handle count, but relies on a callback to fill in
01006         entry info fields.
01007 
01008     Length - Supplies a parameter <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> callback.  In reality <span class="keyword">this</span> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a>
01009         <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> total size, in bytes, of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d7/d0/cmdat2_8c.html#a19">Handle</a> Information buffer.
01010 
01011     RequiredLength - Supplies a parameter <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> callback.  In reality
01012         <span class="keyword">this</span> <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> a <span class="keyword">final</span> size in bytes used to store <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> requested
01013         information.
01014 
01015 Return Value:
01016 
01017     The last <span class="keywordflow">return</span> status of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> callback
01018 
01019 --*/
01020 
01021 {
01022     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
01023     PSYSTEM_HANDLE_TABLE_ENTRY_INFO HandleEntryInfo;
01024     PLIST_ENTRY NextEntry;
01025     <a class="code" href="../../d6/d3/struct__HANDLE__TABLE.html">PHANDLE_TABLE</a> HandleTable;
01026     <a class="code" href="../../d7/d8/struct__EXHANDLE.html">EXHANDLE</a> <a class="code" href="../../d7/d0/cmdat2_8c.html#a19">Handle</a>;
01027     <a class="code" href="../../d7/d3/struct__HANDLE__TABLE__ENTRY.html">PHANDLE_TABLE_ENTRY</a> HandleTableEntry;
01028 
01029     <a class="code" href="../../d0/d9/ntosdef_8h.html#a28">PAGED_CODE</a>();
01030 
01031     <span class="comment">//</span>
01032     <span class="comment">//  Lock the handle table list exclusive and traverse the list of handle</span>
01033     <span class="comment">//  tables.</span>
01034     <span class="comment">//</span>
01035 
01036     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = STATUS_SUCCESS;
01037 
01038     <a class="code" href="../../d4/d9/ke_8h.html#a28">KeEnterCriticalRegion</a>();
01039     <a class="code" href="../../d5/d8/ex_8h.html#a70">ExAcquireResourceExclusive</a>( &amp;HandleTableListLock, TRUE );
01040 
01041     <span class="keywordflow">try</span> {
01042 
01043         <span class="comment">//</span>
01044         <span class="comment">//  Setup the output buffer pointer that the callback will maintain</span>
01045         <span class="comment">//</span>
01046 
01047         HandleEntryInfo = &amp;HandleInformation-&gt;Handles[0];
01048 
01049         <span class="comment">//</span>
01050         <span class="comment">//  Zero out the handle count</span>
01051         <span class="comment">//</span>
01052 
01053         HandleInformation-&gt;NumberOfHandles = 0;
01054 
01055         <span class="comment">//</span>
01056         <span class="comment">//  Iterate through all the handle tables in the system.</span>
01057         <span class="comment">//</span>
01058 
01059         <span class="keywordflow">for</span> (NextEntry = <a class="code" href="../../d0/d8/ex_2handle_8c.html#a2">HandleTableListHead</a>.Flink;
01060              NextEntry != &amp;<a class="code" href="../../d0/d8/ex_2handle_8c.html#a2">HandleTableListHead</a>;
01061              NextEntry = NextEntry-&gt;Flink) {
01062 
01063             <span class="comment">//</span>
01064             <span class="comment">//  Get the address of the next handle table, lock the handle</span>
01065             <span class="comment">//  table exclusive, and scan the list of handle entries.</span>
01066             <span class="comment">//</span>
01067 
01068             HandleTable = CONTAINING_RECORD( NextEntry,
01069                                              <a class="code" href="../../d6/d3/struct__HANDLE__TABLE.html">HANDLE_TABLE</a>,
01070                                              HandleTableList );
01071 
01072             <a class="code" href="../../d5/d8/ex_8h.html#a284">ExLockHandleTableExclusive</a>( HandleTable );
01073 
01074             <span class="keywordflow">try</span> {
01075 
01076                 <span class="comment">//  Iterate through the handle table and for each handle that</span>
01077                 <span class="comment">//  is allocated we'll invoke the call back.  Note that this</span>
01078                 <span class="comment">//  loop exits when we get a null handle table entry.  We know</span>
01079                 <span class="comment">//  there will be no more possible entries after the first null</span>
01080                 <span class="comment">//  one is encountered because we allocate memory of the</span>
01081                 <span class="comment">//  handles in a dense fashion</span>
01082                 <span class="comment">//</span>
01083 
01084                 <span class="keywordflow">for</span> (<a class="code" href="../../d7/d0/cmdat2_8c.html#a19">Handle</a>.Index = 0, <a class="code" href="../../d7/d0/cmdat2_8c.html#a19">Handle</a>.TagBits = 0;
01085                      (HandleTableEntry = <a class="code" href="../../d0/d8/ex_2handle_8c.html#a8">ExpLookupHandleTableEntry</a>( HandleTable, Handle )) != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01086                      <a class="code" href="../../d7/d0/cmdat2_8c.html#a19">Handle</a>.Index += 1) {
01087 
01088                     <span class="comment">//</span>
01089                     <span class="comment">//  Only do the callback if the entry is not free</span>
01090                     <span class="comment">//</span>
01091 
01092                     <span class="keywordflow">if</span> (HandleTableEntry-&gt;<a class="code" href="../../d7/d3/struct__HANDLE__TABLE__ENTRY.html#o0">Object</a> != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01093 
01094                         <span class="comment">//</span>
01095                         <span class="comment">//  Increment the handle count information in the</span>
01096                         <span class="comment">//  information buffer</span>
01097                         <span class="comment">//</span>
01098 
01099                         HandleInformation-&gt;NumberOfHandles += 1;
01100 
01101                         <span class="comment">//</span>
01102                         <span class="comment">//  Lock the handle table entry because we're about to</span>
01103                         <span class="comment">//  give it to the callback function, then release the</span>
01104                         <span class="comment">//  entry right after the call back.</span>
01105                         <span class="comment">//</span>
01106 
01107                         <span class="keywordflow">if</span> (<a class="code" href="../../d5/d8/ex_8h.html#a287">ExLockHandleTableEntry</a>( HandleTable, HandleTableEntry )) {
01108 
01109                             <span class="keywordflow">try</span> {
01110 
01111                                 <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = (*SnapShotHandleEntry)( &amp;HandleEntryInfo,
01112                                                                  HandleTable-&gt;<a class="code" href="../../d6/d3/struct__HANDLE__TABLE.html#o4">UniqueProcessId</a>,
01113                                                                  HandleTableEntry,
01114                                                                  <a class="code" href="../../d7/d0/cmdat2_8c.html#a19">Handle</a>.GenericHandleOverlay,
01115                                                                  Length,
01116                                                                  RequiredLength );
01117 
01118                             } finally {
01119 
01120                                 <a class="code" href="../../d5/d8/ex_8h.html#a288">ExUnlockHandleTableEntry</a>( HandleTable, HandleTableEntry );
01121                             }
01122                         }
01123                     }
01124                 }
01125 
01126             } finally {
01127 
01128                 <a class="code" href="../../d5/d8/ex_8h.html#a286">ExUnlockHandleTableExclusive</a>( HandleTable );
01129             }
01130         }
01131 
01132     } finally {
01133 
01134         <a class="code" href="../../d5/d8/ex_8h.html#a66">ExReleaseResource</a>( &amp;HandleTableListLock );
01135         <a class="code" href="../../d4/d9/ke_8h.html#a29">KeLeaveCriticalRegion</a>();
01136     }
01137 
01138     <span class="keywordflow">return</span> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
01139 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a307" doxytag="ex.h::ExSystemExceptionFilter" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int ExSystemExceptionFilter           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d1/d7/luid_8c-source.html#l00081">NtAllocateLocallyUniqueId()</a>, <a class="el" href="../../d9/d4/physical_8c-source.html#l00970">NtAllocateUserPhysicalPages()</a>, <a class="el" href="../../d4/d2/uuid_8c-source.html#l00617">NtAllocateUuids()</a>, <a class="el" href="../../d4/d5/allocvm_8c-source.html#l00075">NtAllocateVirtualMemory()</a>, <a class="el" href="../../d3/d1/timer_8c-source.html#l00679">NtCancelTimer()</a>, <a class="el" href="../../d5/d5/channel_8c-source.html#l00101">NtCreateChannel()</a>, <a class="el" href="../../d1/d7/ex_2event_8c-source.html#l00180">NtCreateEvent()</a>, <a class="el" href="../../d4/d7/eventpr_8c-source.html#l00131">NtCreateEventPair()</a>, <a class="el" href="../../d6/d3/complete_8c-source.html#l00051">NtCreateIoCompletion()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l00048">NtCreateJobObject()</a>, <a class="el" href="../../d3/d4/mutant_8c-source.html#l00156">NtCreateMutant()</a>, <a class="el" href="../../d7/d2/modwrite_8c-source.html#l00297">NtCreatePagingFile()</a>, <a class="el" href="../../d3/d5/semphore_8c-source.html#l00123">NtCreateSemaphore()</a>, <a class="el" href="../../d2/d7/super_8c-source.html#l00056">NtCreateSuperSection()</a>, <a class="el" href="../../d3/d1/timer_8c-source.html#l00444">NtCreateTimer()</a>, <a class="el" href="../../d6/d4/rdwr_8c-source.html#l00050">NTFastDOSIO()</a>, <a class="el" href="../../d9/d4/physical_8c-source.html#l01624">NtFreeUserPhysicalPages()</a>, <a class="el" href="../../d4/d6/freevm_8c-source.html#l00066">NtFreeVirtualMemory()</a>, <a class="el" href="../../d5/d5/channel_8c-source.html#l00236">NtListenChannel()</a>, <a class="el" href="../../d4/d4/lockvm_8c-source.html#l00033">NtLockVirtualMemory()</a>, <a class="el" href="../../d4/d4/mapview_8c-source.html#l00199">NtMapViewOfSection()</a>, <a class="el" href="../../d2/d7/super_8c-source.html#l00311">NtMapViewOfSuperSection()</a>, <a class="el" href="../../d5/d5/channel_8c-source.html#l00348">NtOpenChannel()</a>, <a class="el" href="../../d1/d7/ex_2event_8c-source.html#l00313">NtOpenEvent()</a>, <a class="el" href="../../d4/d7/eventpr_8c-source.html#l00251">NtOpenEventPair()</a>, <a class="el" href="../../d6/d3/complete_8c-source.html#l00178">NtOpenIoCompletion()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l00188">NtOpenJobObject()</a>, <a class="el" href="../../d3/d4/mutant_8c-source.html#l00280">NtOpenMutant()</a>, <a class="el" href="../../d3/d5/semphore_8c-source.html#l00260">NtOpenSemaphore()</a>, <a class="el" href="../../d3/d1/timer_8c-source.html#l00581">NtOpenTimer()</a>, <a class="el" href="../../d1/d7/ex_2event_8c-source.html#l00412">NtPulseEvent()</a>, <a class="el" href="../../d1/d7/ex_2event_8c-source.html#l00514">NtQueryEvent()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l00814">NtQueryInformationJobObject()</a>, <a class="el" href="../../d6/d3/complete_8c-source.html#l00282">NtQueryIoCompletion()</a>, <a class="el" href="../../d3/d4/mutant_8c-source.html#l00380">NtQueryMutant()</a>, <a class="el" href="../../d3/d5/semphore_8c-source.html#l00360">NtQuerySemaphore()</a>, <a class="el" href="../../d3/d1/timer_8c-source.html#l00822">NtQueryTimer()</a>, <a class="el" href="../../d3/d4/mutant_8c-source.html#l00521">NtReleaseMutant()</a>, <a class="el" href="../../d3/d5/semphore_8c-source.html#l00494">NtReleaseSemaphore()</a>, <a class="el" href="../../d6/d3/complete_8c-source.html#l00485">NtRemoveIoCompletion()</a>, <a class="el" href="../../d5/d5/channel_8c-source.html#l00525">NtReplyWaitSendChannel()</a>, <a class="el" href="../../d1/d7/ex_2event_8c-source.html#l00648">NtResetEvent()</a>, <a class="el" href="../../d5/d5/channel_8c-source.html#l00807">NtSendWaitReplyChannel()</a>, <a class="el" href="../../d1/d7/ex_2event_8c-source.html#l00748">NtSetEvent()</a>, <a class="el" href="../../d7/d0/obquery_8c-source.html#l00545">NtSetInformationObject()</a>, <a class="el" href="../../d3/d1/timer_8c-source.html#l00960">NtSetTimer()</a>, <a class="el" href="../../d4/d4/lockvm_8c-source.html#l00605">NtUnlockVirtualMemory()</a>, <a class="el" href="../../d7/d9/obcreate_8c-source.html#l00248">ObpCaptureObjectCreateInformation()</a>, <a class="el" href="../../d7/d9/obcreate_8c-source.html#l00438">ObpCaptureObjectName()</a>, <a class="el" href="../../d4/d4/seaudit_8c-source.html#l00259">SepProbeAndCaptureString_U()</a>, <a class="el" href="../../d8/d3/vdminit_8c-source.html#l00019">VdmpInitialize()</a>, and <a class="el" href="../../d5/d4/vdmprint_8c-source.html#l00388">VdmpPrinterDirectIoClose()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a317" doxytag="ex.h::ExSystemTimeToLocalTime" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI VOID ExSystemTimeToLocalTime           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PLARGE_INTEGER&nbsp;</td>
          <td class="mdname" nowrap> <em>SystemTime</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT PLARGE_INTEGER&nbsp;</td>
          <td class="mdname" nowrap> <em>LocalTime</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d3/d1/timer_8c-source.html#l01212">ExGetNextWakeTime()</a>, and <a class="el" href="../../d3/d3/internal_8c-source.html#l09157">IopCopyBootLogRegistryToFile()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a260" doxytag="ex.h::ExTimerRundown" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI VOID ExTimerRundown           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a272" doxytag="ex.h::ExTryToAcquireResourceExclusiveLite" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI BOOLEAN ExTryToAcquireResourceExclusiveLite           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d6/d4/struct__ERESOURCE.html">PERESOURCE</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Resource</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l00598">598</a> of file <a class="el" href="../../d9/d7/ex_2resource_8c-source.html">ex/resource.c</a>.
<p>
References <a class="el" href="../../d6/d7/ex_8h-source.html#l02289">_ERESOURCE::ActiveCount</a>, <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d8/d3/ddkresrc_8c-source.html#l00070">ASSERT_RESOURCE</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02274">ERESOURCE_THREAD</a>, <a class="el" href="../../d9/d7/ex_2resource_8c-source.html#l00134">ExpIncrementCounter</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02290">_ERESOURCE::Flag</a>, <a class="el" href="../../d8/d3/ddkresrc_8c-source.html#l00091">IsOwnedExclusive</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02280">_OWNER_ENTRY::OwnerCount</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02278">_OWNER_ENTRY::OwnerThread</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02293">_ERESOURCE::OwnerThreads</a>, <a class="el" href="../../d2/d8/ps_8h-source.html#l00645">PsGetCurrentThread</a>, <a class="el" href="../../d5/d9/tex_8c-source.html#l01561">Resource</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02309">ResourceNeverExclusive</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02311">ResourceOwnedExclusive</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02302">_ERESOURCE::SpinLock</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d5/d9/wslist_8c-source.html#l04726">MiEmptyWorkingSet()</a>, <a class="el" href="../../d6/d9/wsmanage_8c-source.html#l02986">MmTrimAllSystemPagableMemory()</a>, and <a class="el" href="../../d6/d9/wsmanage_8c-source.html#l00397">MmWorkingSetManager()</a>.
<p>
<pre class="fragment"><div>00604                    :
00605 
00606     The routine attempts to acquire <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified resource <span class="keywordflow">for</span> exclusive
00607     access.
00608 
00609     N.B. This routine uses fast locking.
00610 
00611 Arguments:
00612 
00613     <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a> - Supplies a pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> resource that <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> acquired
00614         <span class="keywordflow">for</span> exclusive access.
00615 
00616 Return Value:
00617 
00618     BOOLEAN - <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> resource <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> acquired and <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a> otherwise.
00619 
00620 --*/
00621 
00622 {
00623 
00624     <a class="code" href="../../d5/d8/ex_8h.html#a121">ERESOURCE_THREAD</a> CurrentThread;
00625     KIRQL OldIrql;
00626     BOOLEAN Result;
00627 
00628     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>((<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o3">Flag</a> &amp; ResourceNeverExclusive) == 0);
00629 
00630     <span class="comment">//</span>
00631     <span class="comment">// Attempt to acquire exclusive access to the specified resource.</span>
00632     <span class="comment">//</span>
00633 
00634     CurrentThread = (<a class="code" href="../../d5/d8/ex_8h.html#a121">ERESOURCE_THREAD</a>)<a class="code" href="../../d1/d9/ps_8h.html#a20">PsGetCurrentThread</a>();
00635     ExAcquireFastLock(&amp;<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o12">SpinLock</a>, &amp;OldIrql);
00636 
00637     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(KeIsExecutingDpc() == FALSE);
00638     <a class="code" href="../../d7/d4/ddkresrc_8c.html#a0">ASSERT_RESOURCE</a>(Resource);
00639 
00640     <span class="comment">//</span>
00641     <span class="comment">// If the active count of the resource is zero, then there is neither</span>
00642     <span class="comment">// an exclusive owner nor a shared owner and access to the resource can</span>
00643     <span class="comment">// be immediately granted. Otherwise, if the resource is owned exclusive</span>
00644     <span class="comment">// and the current thread is the owner, then access to the resource can</span>
00645     <span class="comment">// be immediately granted. Otherwise, access cannot be granted.</span>
00646     <span class="comment">//</span>
00647 
00648     Result = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00649     <span class="keywordflow">if</span> (<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o2">ActiveCount</a> == 0) {
00650         <a class="code" href="../../d8/d8/ex_2resource_8c.html#a6">ExpIncrementCounter</a>(ExclusiveAcquire);
00651         <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o3">Flag</a> |= <a class="code" href="../../d5/d8/ex_8h.html#a64">ResourceOwnedExclusive</a>;
00652         <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o6">OwnerThreads</a>[0].<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o0">OwnerThread</a> = CurrentThread;
00653         <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o6">OwnerThreads</a>[0].<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o1">OwnerCount</a> = 1;
00654         <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o2">ActiveCount</a> = 1;
00655         Result = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00656 
00657     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="../../d7/d4/ddkresrc_8c.html#a6">IsOwnedExclusive</a>(Resource) &amp;&amp;
00658         (<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o6">OwnerThreads</a>[0].<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o0">OwnerThread</a> == CurrentThread)) {
00659         <a class="code" href="../../d8/d8/ex_2resource_8c.html#a6">ExpIncrementCounter</a>(ExclusiveAcquire);
00660         <a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o6">OwnerThreads</a>[0].<a class="code" href="../../d6/d7/struct__OWNER__ENTRY.html#o1">OwnerCount</a> += 1;
00661         Result = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00662     }
00663 
00664     ExReleaseFastLock(&amp;<a class="code" href="../../d4/d0/tex_8c.html#a21">Resource</a>-&gt;<a class="code" href="../../d6/d4/struct__ERESOURCE.html#o12">SpinLock</a>, OldIrql);
00665     <span class="keywordflow">return</span> Result;
00666 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a288" doxytag="ex.h::ExUnlockHandleTableEntry" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI VOID ExUnlockHandleTableEntry           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d6/d3/struct__HANDLE__TABLE.html">PHANDLE_TABLE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>HandleTable</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d7/d3/struct__HANDLE__TABLE__ENTRY.html">PHANDLE_TABLE_ENTRY</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>HandleTableEntry</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l00336">336</a> of file <a class="el" href="../../d1/d7/ex_2handle_8c-source.html">ex/handle.c</a>.
<p>
References <a class="el" href="../../d8/d7/exboosts_8h-source.html#l00034">EVENT_INCREMENT</a>, <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l00044">EXHANDLE_TABLE_ENTRY_LOCK_BIT</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02771">_HANDLE_TABLE::HandleContentionEvent</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00413">_KEVENT::Header</a>, <a class="el" href="../../d0/d1/bugcheck_8c-source.html#l00428">KeBugCheckEx()</a>, <a class="el" href="../../d3/d7/eventobj_8c-source.html#l00167">KePulseEvent()</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02672">_HANDLE_TABLE_ENTRY::Object</a>, <a class="el" href="../../d1/d8/ntosdef_8h-source.html#l00462">PAGED_CODE</a>, and <a class="el" href="../../d5/d8/ke_8h-source.html#l00263">_DISPATCHER_HEADER::WaitListHead</a>.
<p>
Referenced by <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l01315">ExChangeHandle()</a>, <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l01144">ExCreateHandle()</a>, <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l00765">ExDupHandleTable()</a>, <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l00634">ExEnumHandleTable()</a>, <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l00984">ExSnapShotHandleTables()</a>, <a class="el" href="../../d6/d9/obclose_8c-source.html#l00037">NtClose()</a>, <a class="el" href="../../d2/d1/obwait_8c-source.html#l00406">NtWaitForMultipleObjects()</a>, <a class="el" href="../../d7/d0/obquery_8c-source.html#l01319">ObQueryObjectAuditingByHandle()</a>, <a class="el" href="../../d8/d0/obref_8c-source.html#l00542">ObReferenceObjectByHandle()</a>, <a class="el" href="../../d2/d9/pscid_8c-source.html#l00094">PsLookupProcessByProcessId()</a>, <a class="el" href="../../d2/d9/pscid_8c-source.html#l00027">PsLookupProcessThreadByCid()</a>, <a class="el" href="../../d2/d9/pscid_8c-source.html#l00146">PsLookupThreadByThreadId()</a>, and <a class="el" href="../../d1/d9/rtl_2atom_8c-source.html#l00152">RtlpAtomMapAtomToHandleEntry()</a>.
<p>
<pre class="fragment"><div>00343                    :
00344 
00345     This routine unlocks <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified handle table entry.  After <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> entry <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a>
00346     unlocked <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> sign bit will be clear.
00347 
00348 Arguments:
00349 
00350     HandleTable - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> handle table containing <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> entry being unlocked.
00351 
00352     HandleTableEntry - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> handle table entry being unlocked.
00353 
00354 Return Value:
00355 
00356     None.
00357 
00358 --*/
00359 
00360 {
00361     LONG_PTR NewValue;
00362     LONG_PTR CurrentValue;
00363 
00364     <a class="code" href="../../d0/d9/ntosdef_8h.html#a28">PAGED_CODE</a>();
00365 
00366     <span class="comment">//</span>
00367     <span class="comment">//  This routine does not need to loop and attempt the unlock opeation more</span>
00368     <span class="comment">//  than once because by defintion the caller has the entry already locked</span>
00369     <span class="comment">//  and no one can be changing the value without the lock.</span>
00370     <span class="comment">//</span>
00371     <span class="comment">//  So we'll read in the current value, check that the entry is really</span>
00372     <span class="comment">//  locked, clear the lock bit and make sure the compare exchange worked.</span>
00373     <span class="comment">//</span>
00374 
00375     NewValue = CurrentValue = *((<span class="keyword">volatile</span> LONG_PTR *)&amp;HandleTableEntry-&gt;<a class="code" href="../../d7/d3/struct__HANDLE__TABLE__ENTRY.html#o0">Object</a>);
00376 
00377     <span class="keywordflow">if</span> (CurrentValue &gt;= 0) {
00378 
00379         <a class="code" href="../../d9/d1/bugcheck_8c.html#a19">KeBugCheckEx</a>( BAD_EXHANDLE, __LINE__, (LONG_PTR)HandleTableEntry, NewValue, CurrentValue );
00380     }
00381 
00382     NewValue &amp;= ~<a class="code" href="../../d0/d8/ex_2handle_8c.html#a0">EXHANDLE_TABLE_ENTRY_LOCK_BIT</a>;
00383 
00384     <span class="keywordflow">if</span> ((LONG_PTR)(InterlockedCompareExchangePointer( &amp;HandleTableEntry-&gt;<a class="code" href="../../d7/d3/struct__HANDLE__TABLE__ENTRY.html#o0">Object</a>,
00385                                                      (PVOID)NewValue,
00386                                                      (PVOID)CurrentValue )) != CurrentValue) {
00387 
00388         <a class="code" href="../../d9/d1/bugcheck_8c.html#a19">KeBugCheckEx</a>( BAD_EXHANDLE, __LINE__, (LONG_PTR)HandleTableEntry, NewValue, CurrentValue );
00389     }
00390 
00391     <span class="comment">//</span>
00392     <span class="comment">//  Now that we've unlocked the event we'll see if there are any waiters</span>
00393     <span class="comment">//  for handle table entries in this table.  If there are any waiters</span>
00394     <span class="comment">//  we'll wake them up and let them try for their lock again.</span>
00395     <span class="comment">//</span>
00396     <span class="comment">//  Note that this will wake up all the waiters for all locks in a given</span>
00397     <span class="comment">//  handle table.   Each waiter also has a short time out so the worse</span>
00398     <span class="comment">//  that can happen is that we might wake someone too early.  It can also</span>
00399     <span class="comment">//  be that no one is waiting for this exact lock, or the one waiting for</span>
00400     <span class="comment">//  it has already gone off, but these are all benign.</span>
00401     <span class="comment">//</span>
00402     <span class="comment">//  **** Note that we're testing for a non empty event header wait list</span>
00403     <span class="comment">//       head.  This is sort of behind the back and a better design</span>
00404     <span class="comment">//       would get a macro from ke.h to do the test, but this will</span>
00405     <span class="comment">//       suffice for now.  This is actually an unsafe test in that it</span>
00406     <span class="comment">//       might return the wrong answer, but even then we are willing to</span>
00407     <span class="comment">//       live with it because any waiters will wake up in 10ms anyway and</span>
00408     <span class="comment">//       any extra call to pulse the event without waiters is benign.</span>
00409     <span class="comment">//</span>
00410 
00411     <span class="keywordflow">if</span> (!IsListEmpty( &amp;HandleTable-&gt;<a class="code" href="../../d6/d3/struct__HANDLE__TABLE.html#o9">HandleContentionEvent</a>.<a class="code" href="../../d2/d6/struct__KEVENT.html#o0">Header</a>.<a class="code" href="../../d1/d6/struct__DISPATCHER__HEADER.html#o5">WaitListHead</a> )) {
00412 
00413         <a class="code" href="../../d2/d8/eventobj_8c.html#a5">KePulseEvent</a>( &amp;HandleTable-&gt;<a class="code" href="../../d6/d3/struct__HANDLE__TABLE.html#o9">HandleContentionEvent</a>, EVENT_INCREMENT, FALSE );
00414     }
00415 
00416     <span class="keywordflow">return</span>;
00417 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a286" doxytag="ex.h::ExUnlockHandleTableExclusive" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI VOID ExUnlockHandleTableExclusive           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d6/d3/struct__HANDLE__TABLE.html">PHANDLE_TABLE</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>HandleTable</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l00209">209</a> of file <a class="el" href="../../d1/d7/ex_2handle_8c-source.html">ex/handle.c</a>.
<p>
References <a class="el" href="../../d6/d7/ex_8h-source.html#l02393">ExReleaseResource</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02755">_HANDLE_TABLE::HandleTableLock</a>, <a class="el" href="../../d1/d8/ntosdef_8h-source.html#l00462">PAGED_CODE</a>, and <a class="el" href="../../d2/d7/hal_8h.html#a212">VOID()</a>.
<p>
Referenced by <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l01144">ExCreateHandle()</a>, <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l01227">ExDestroyHandle()</a>, and <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l00984">ExSnapShotHandleTables()</a>.
<p>
<pre class="fragment"><div>00215                    :
00216 
00217     This routine unlocks <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified handle table from exclusive access.
00218 
00219 Arguments:
00220 
00221     HandleTable - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> handle table being unlocked.
00222 
00223 Return Value:
00224 
00225     None.
00226 
00227 --*/
00228 
00229 {
00230     <a class="code" href="../../d0/d9/ntosdef_8h.html#a28">PAGED_CODE</a>();
00231 
00232     (<a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>)<a class="code" href="../../d5/d8/ex_8h.html#a66">ExReleaseResource</a>( &amp;HandleTable-&gt;<a class="code" href="../../d6/d3/struct__HANDLE__TABLE.html#o7">HandleTableLock</a> );
00233 
00234     <span class="keywordflow">return</span>;
00235 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a285" doxytag="ex.h::ExUnlockHandleTableShared" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI VOID ExUnlockHandleTableShared           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d6/d3/struct__HANDLE__TABLE.html">PHANDLE_TABLE</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>HandleTable</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l00178">178</a> of file <a class="el" href="../../d1/d7/ex_2handle_8c-source.html">ex/handle.c</a>.
<p>
References <a class="el" href="../../d6/d7/ex_8h-source.html#l02393">ExReleaseResource</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l02755">_HANDLE_TABLE::HandleTableLock</a>, <a class="el" href="../../d1/d8/ntosdef_8h-source.html#l00462">PAGED_CODE</a>, and <a class="el" href="../../d2/d7/hal_8h.html#a212">VOID()</a>.
<p>
Referenced by <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l00765">ExDupHandleTable()</a>, and <a class="el" href="../../d1/d7/ex_2handle_8c-source.html#l00634">ExEnumHandleTable()</a>.
<p>
<pre class="fragment"><div>00184                    :
00185 
00186     This routine unlocks <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified handle table from shared access.
00187 
00188 Arguments:
00189 
00190     HandleTable - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> handle table being unlocked.
00191 
00192 Return Value:
00193 
00194     None.
00195 
00196 --*/
00197 
00198 {
00199     <a class="code" href="../../d0/d9/ntosdef_8h.html#a28">PAGED_CODE</a>();
00200 
00201     (<a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>)<a class="code" href="../../d5/d8/ex_8h.html#a66">ExReleaseResource</a>( &amp;HandleTable-&gt;<a class="code" href="../../d6/d3/struct__HANDLE__TABLE.html#o7">HandleTableLock</a> );
00202 
00203     <span class="keywordflow">return</span>;
00204 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a227" doxytag="ex.h::ExUnlockPool" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI VOID ExUnlockPool           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d5/d8/ex_8h.html#a96">POOL_TYPE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>PoolType</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN KIRQL&nbsp;</td>
          <td class="mdname" nowrap> <em>LockHandle</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00565">565</a> of file <a class="el" href="../../d3/d1/ex_2pool_8c-source.html">ex/pool.c</a>.
<p>
References <a class="el" href="../../d5/d1/pool_8h-source.html#l00050">BASE_POOL_TYPE_MASK</a>, <a class="el" href="../../d5/d8/ex_8h.html#a329a173">NonPagedPool</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00454">NonPagedPoolLock</a>, <a class="el" href="../../d5/d8/ex_8h.html#a329a174">PagedPool</a>, and <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00451">PoolVector</a>.
<p>
Referenced by <a class="el" href="../../d2/d5/allocpag_8c-source.html#l04569">MiFindContiguousMemory()</a>.
<p>
<pre class="fragment"><div>00572                    :
00573 
00574     This function unlocks <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a> specified by <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a> <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a>.
00575 
00576 
00577 Arguments:
00578 
00579     PoolType - Specifies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a> that should be unlocked.
00580 
00581     LockHandle - Specifies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> lock handle from a previous call to
00582                  <a class="code" href="../../d2/d2/ex_2pool_8c.html#a71">ExLockPool</a>.
00583 
00584 Return Value:
00585 
00586     None.
00587 
00588 --*/
00589 
00590 {
00591 
00592     <span class="comment">//</span>
00593     <span class="comment">// If the pool type is nonpaged, then use a spinlock to unlock the</span>
00594     <span class="comment">// pool. Otherwise, use a fast mutex to unlock the pool.</span>
00595     <span class="comment">//</span>
00596 
00597     <span class="keywordflow">if</span> ((PoolType &amp; <a class="code" href="../../d4/d2/pool_8h.html#a5">BASE_POOL_TYPE_MASK</a>) == <a class="code" href="../../d5/d8/ex_8h.html#a329a173">NonPagedPool</a>) {
00598         ExReleaseSpinLock(&amp;NonPagedPoolLock, LockHandle);
00599 
00600     } <span class="keywordflow">else</span> {
00601         ExReleaseFastMutex((<a class="code" href="../../d6/d9/struct__FAST__MUTEX.html">PFAST_MUTEX</a>)PoolVector[PagedPool]-&gt;LockAddress);
00602     }
00603 
00604     <span class="keywordflow">return</span>;
00605 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a257" doxytag="ex.h::ExUnlockUserBuffer" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI VOID ExUnlockUserBuffer           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PVOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>LockVariable</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l03048">3048</a> of file <a class="el" href="../../d7/d7/sysinfo_8c-source.html">sysinfo.c</a>.
<p>
References <a class="el" href="../../d7/d2/cmwraper_8c-source.html#l00304">ExFreePool()</a>, and <a class="el" href="../../d6/d5/iosup_8c-source.html#l01347">MmUnlockPages()</a>.
<p>
Referenced by <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l02995">ExLockUserBuffer()</a>, <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l03939">ExpGetHandleInformation()</a>, <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l03579">ExpGetLockInformation()</a>, <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l03661">ExpGetLookasideInformation()</a>, <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l04019">ExpGetObjectInformation()</a>, <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l03846">ExpGetPoolInformation()</a>, and <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l03060">ExpGetProcessInformation()</a>.
<p>
<pre class="fragment"><div>03052 {
03053     <a class="code" href="../../d5/d6/iosup_8c.html#a45">MmUnlockPages</a> ((<a class="code" href="../../d6/d7/struct__MDL.html">PMDL</a>)LockVariable);
03054     <a class="code" href="../../d5/d8/ex_8h.html#a224">ExFreePool</a> ((<a class="code" href="../../d6/d7/struct__MDL.html">PMDL</a>)LockVariable);
03055     <span class="keywordflow">return</span>;
03056 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a322" doxytag="ex.h::ExUnregisterCallback" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI VOID ExUnregisterCallback           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PVOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>CallbackRegistration</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d3/d3/ex_2callback_8c-source.html#l00479">479</a> of file <a class="el" href="../../d3/d3/ex_2callback_8c-source.html">ex/callback.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d3/d3/ex_2callback_8c-source.html#l00084">_CALLBACK_REGISTRATION::Busy</a>, <a class="el" href="../../d3/d3/ex_2callback_8c-source.html#l00081">_CALLBACK_REGISTRATION::CallbackObject</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00087">DISPATCH_LEVEL</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00623">Executive</a>, <a class="el" href="../../d7/d2/cmwraper_8c-source.html#l00304">ExFreePool()</a>, <a class="el" href="../../d3/d3/ex_2callback_8c-source.html#l00049">ExpCallbackEvent</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l02007">KeAcquireSpinLock</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l01072">KeClearEvent</a>, <a class="el" href="../../d9/d5/verifier_8c.html#a119">KeReleaseSpinLock()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00624">KernelMode</a>, <a class="el" href="../../d2/d6/wait_8c-source.html#l00810">KeWaitForSingleObject()</a>, <a class="el" href="../../d3/d3/ex_2callback_8c-source.html#l00080">_CALLBACK_REGISTRATION::Link</a>, <a class="el" href="../../d3/d3/ex_2callback_8c-source.html#l00069">_CALLBACK_OBJECT::Lock</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d5/d9/ob_8h-source.html#l00494">ObDereferenceObject</a>, <a class="el" href="../../d2/d4/ex_2callback_8c.html#a6">PCALLBACK_OBJECT</a>, <a class="el" href="../../d2/d4/ex_2callback_8c.html#a8">PCALLBACK_REGISTRATION</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, and <a class="el" href="../../d3/d3/ex_2callback_8c-source.html#l00085">_CALLBACK_REGISTRATION::UnregisterWaiting</a>.
<p>
<pre class="fragment"><div>00485                    :
00486 
00487     This function removes <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> callback registration <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> callbacks
00488     from <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> list of callback object .
00489 
00490 Arguments:
00491 
00492     CallbackRegistration - Pointer to device object <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a9">file</a> system.
00493 
00494 Return Value:
00495 
00496     None.
00497 
00498 --*/
00499 
00500 {
00501     <a class="code" href="../../d0/d7/struct__CALLBACK__REGISTRATION.html">PCALLBACK_REGISTRATION</a>  CallbackRegistration;
00502     <a class="code" href="../../d9/d6/struct__CALLBACK__OBJECT.html">PCALLBACK_OBJECT</a>        CallbackObject;
00503     KIRQL                   OldIrql;
00504 
00505     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a> (KeGetCurrentIrql() &lt; DISPATCH_LEVEL);
00506 
00507     CallbackRegistration = (<a class="code" href="../../d0/d7/struct__CALLBACK__REGISTRATION.html">PCALLBACK_REGISTRATION</a>) CbRegistration;
00508     CallbackObject = CallbackRegistration-&gt;<a class="code" href="../../d0/d7/struct__CALLBACK__REGISTRATION.html#o1">CallbackObject</a>;
00509 
00510     <a class="code" href="../../d4/d9/ke_8h.html#a37">KeAcquireSpinLock</a> (&amp;CallbackObject-&gt;<a class="code" href="../../d9/d6/struct__CALLBACK__OBJECT.html#o1">Lock</a>, &amp;OldIrql);
00511 
00512     <span class="comment">//</span>
00513     <span class="comment">// Wait for registration</span>
00514     <span class="comment">//</span>
00515 
00516     <span class="keywordflow">while</span> (CallbackRegistration-&gt;<a class="code" href="../../d0/d7/struct__CALLBACK__REGISTRATION.html#o4">Busy</a>) {
00517 
00518         <span class="comment">//</span>
00519         <span class="comment">// Set waiting flag, then wait.  (not performance critical - use</span>
00520         <span class="comment">// single global event to wait for any and all unregister waits)</span>
00521         <span class="comment">//</span>
00522 
00523         CallbackRegistration-&gt;<a class="code" href="../../d0/d7/struct__CALLBACK__REGISTRATION.html#o5">UnregisterWaiting</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00524         <a class="code" href="../../d4/d9/ke_8h.html#a21">KeClearEvent</a> (&amp;ExpCallbackEvent);
00525         <a class="code" href="../../d9/d5/verifier_8c.html#a119">KeReleaseSpinLock</a> (&amp;CallbackObject-&gt;<a class="code" href="../../d9/d6/struct__CALLBACK__OBJECT.html#o1">Lock</a>, OldIrql);
00526 
00527         <a class="code" href="../../d1/d7/wait_8c.html#a4">KeWaitForSingleObject</a> (
00528             &amp;ExpCallbackEvent,
00529             Executive,
00530             KernelMode,
00531             FALSE,
00532             NULL
00533         );
00534 
00535         <span class="comment">//</span>
00536         <span class="comment">// Synchronize with callback object and recheck registration busy</span>
00537         <span class="comment">//</span>
00538 
00539         <a class="code" href="../../d4/d9/ke_8h.html#a37">KeAcquireSpinLock</a> (&amp;CallbackObject-&gt;<a class="code" href="../../d9/d6/struct__CALLBACK__OBJECT.html#o1">Lock</a>, &amp;OldIrql);
00540     }
00541 
00542     <span class="comment">//</span>
00543     <span class="comment">// Registration not busy, remove it from the callback object</span>
00544     <span class="comment">//</span>
00545 
00546     RemoveEntryList (&amp;CallbackRegistration-&gt;<a class="code" href="../../d0/d7/struct__CALLBACK__REGISTRATION.html#o0">Link</a>);
00547     <a class="code" href="../../d9/d5/verifier_8c.html#a119">KeReleaseSpinLock</a> (&amp;CallbackObject-&gt;<a class="code" href="../../d9/d6/struct__CALLBACK__OBJECT.html#o1">Lock</a>, OldIrql);
00548 
00549     <span class="comment">//</span>
00550     <span class="comment">// Free memory used for CallbackRegistration</span>
00551     <span class="comment">//</span>
00552 
00553     <a class="code" href="../../d5/d8/ex_8h.html#a224">ExFreePool</a> (CallbackRegistration);
00554 
00555     <span class="comment">//</span>
00556     <span class="comment">// Remove reference count on CallbackObject</span>
00557     <span class="comment">//</span>
00558 
00559     <a class="code" href="../../d4/d0/ob_8h.html#a14">ObDereferenceObject</a> (CallbackObject);
00560 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a314" doxytag="ex.h::ExUpdateSystemTimeFromCmos" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID ExUpdateSystemTimeFromCmos           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>UpdateInterruptTime</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>MaxSepInSeconds</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d9/d2/kdapi_8c-source.html#l00528">KdpTimeSlipWork()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a324" doxytag="ex.h::ExUuidCreate" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI NTSTATUS ExUuidCreate           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">OUT <a class="el" href="../../d5/d8/ex_8h.html#a172">UUID</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Uuid</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d2/uuid_8c-source.html#l00841">841</a> of file <a class="el" href="../../d4/d2/uuid_8c-source.html">uuid.c</a>.
<p>
References <a class="el" href="../../d4/d2/uuid_8c-source.html#l00078">_UUID_CACHED_VALUES_STRUCT::AllocatedCount</a>, <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d4/d2/uuid_8c-source.html#l00058">CACHE_LOCAL_ONLY</a>, <a class="el" href="../../d4/d2/uuid_8c-source.html#l00079">_UUID_CACHED_VALUES_STRUCT::ClockSeqHiAndReserved</a>, <a class="el" href="../../d4/d2/uuid_8c-source.html#l00070">_UUID_GENERATE::ClockSeqHiAndReserved</a>, <a class="el" href="../../d5/d8/ex_8h.html#a231">ExAcquireFastMutexUnsafe()</a>, <a class="el" href="../../d4/d2/uuid_8c-source.html#l00095">ExpUuidCachedValues</a>, <a class="el" href="../../d4/d2/uuid_8c-source.html#l00091">ExpUuidCacheValid</a>, <a class="el" href="../../d4/d2/uuid_8c-source.html#l00751">ExpUuidGetValues()</a>, <a class="el" href="../../d4/d2/uuid_8c-source.html#l00103">ExpUuidLock</a>, <a class="el" href="../../d4/d2/uuid_8c-source.html#l00287">ExpUuidSaveSequenceNumberIf()</a>, <a class="el" href="../../d5/d8/ex_8h.html#a232">ExReleaseFastMutexUnsafe()</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l01598">KeEnterCriticalRegion</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l01628">KeLeaveCriticalRegion</a>, <a class="el" href="../../d4/d2/uuid_8c-source.html#l00081">_UUID_CACHED_VALUES_STRUCT::NodeId</a>, <a class="el" href="../../d4/d2/uuid_8c-source.html#l00072">_UUID_GENERATE::NodeId</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d1/d8/ntosdef_8h-source.html#l00462">PAGED_CODE</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00135">Status</a>, <a class="el" href="../../d4/d2/uuid_8c-source.html#l00077">_UUID_CACHED_VALUES_STRUCT::Time</a>, <a class="el" href="../../d7/d5/ttime_8c-source.html#l00047">Time</a>, <a class="el" href="../../d4/d2/uuid_8c-source.html#l00069">_UUID_GENERATE::TimeHiAndVersion</a>, <a class="el" href="../../d4/d2/uuid_8c-source.html#l00067">_UUID_GENERATE::TimeLow</a>, <a class="el" href="../../d4/d2/uuid_8c-source.html#l00068">_UUID_GENERATE::TimeMid</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00064">USHORT</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l03344">UUID</a>, <a class="el" href="../../d4/d2/uuid_8c-source.html#l00052">UUID_TIME_HIGH_MASK</a>, and <a class="el" href="../../d4/d2/uuid_8c-source.html#l00053">UUID_VERSION</a>.
<p>
Referenced by <a class="el" href="../../d7/d1/hwprofil_8c-source.html#l01869">CmpCloneHwProfile()</a>.
<p>
<pre class="fragment"><div>00847                    :
00848 
00849     This routine creates a <a class="code" href="../../d3/d2/structtagDCE.html">DCE</a> <a class="code" href="../../d5/d8/ex_8h.html#a172">UUID</a> and returns <a class="code" href="../../d1/d9/icmui_8def.html#a4">it</a> in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> caller's
00850     buffer.
00851 
00852 Arguments:
00853 
00854     Uuid - will receive <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d5/d8/ex_8h.html#a172">UUID</a>.
00855 
00856 Return Value:
00857 
00858     STATUS_SUCCESS <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> service <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> successfully executed.
00859 
00860     STATUS_RETRY <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> returned <span class="keywordflow">if</span> we're unable to reserve a range of
00861         UUIDs.  This will occur <span class="keywordflow">if</span> system clock hasn'<a class="code" href="../../d4/d1/genmips_8c.html#a17">t</a> advanced
00862         and <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> allocator <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <a class="code" href="../../d6/d0/wsprintf_8c.html#a0">out</a> of cached values.
00863 
00864 --*/
00865 
00866 {
00867     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = STATUS_SUCCESS;
00868 
00869     <a class="code" href="../../d9/d4/struct__UUID__GENERATE.html">UUID_GENERATE</a>  *UuidGen = (<a class="code" href="../../d9/d4/struct__UUID__GENERATE.html">UUID_GENERATE</a> *) Uuid;
00870     ULONGLONG       <a class="code" href="../../d6/d6/ttime_8c.html#a14">Time</a>;
00871     LONG            Delta;
00872 
00873     <a class="code" href="../../d0/d9/ntosdef_8h.html#a28">PAGED_CODE</a>();
00874 
00875     <span class="comment">//</span>
00876     <span class="comment">// Get a value from the cache.  If the cache is empty, we'll fill</span>
00877     <span class="comment">// it and retry.  The first time cache will be empty.</span>
00878     <span class="comment">//</span>
00879 
00880     <span class="keywordflow">for</span>(;;) {
00881 
00882         <span class="comment">// Get the highest value in the cache (though it may not</span>
00883         <span class="comment">// be available).</span>
00884         <a class="code" href="../../d6/d6/ttime_8c.html#a14">Time</a> = <a class="code" href="../../d3/d3/uuid_8c.html#a13">ExpUuidCachedValues</a>.<a class="code" href="../../d8/d4/struct__UUID__CACHED__VALUES__STRUCT.html#o0">Time</a>;
00885 
00886         <span class="comment">// Copy the static info into the UUID.  We can't do this later</span>
00887         <span class="comment">// because the clock sequence could be updated by another thread.</span>
00888 
00889         *(PULONG)&amp;UuidGen-&gt;<a class="code" href="../../d9/d4/struct__UUID__GENERATE.html#o3">ClockSeqHiAndReserved</a> =
00890             *(PULONG)&amp;<a class="code" href="../../d3/d3/uuid_8c.html#a13">ExpUuidCachedValues</a>.<a class="code" href="../../d8/d4/struct__UUID__CACHED__VALUES__STRUCT.html#o2">ClockSeqHiAndReserved</a>;
00891         *(PULONG)&amp;UuidGen-&gt;<a class="code" href="../../d9/d4/struct__UUID__GENERATE.html#o5">NodeId</a>[2] =
00892             *(PULONG)&amp;<a class="code" href="../../d3/d3/uuid_8c.html#a13">ExpUuidCachedValues</a>.<a class="code" href="../../d8/d4/struct__UUID__CACHED__VALUES__STRUCT.html#o4">NodeId</a>[2];
00893 
00894         <span class="comment">// See what we need to subtract from Time to get a valid GUID.</span>
00895         Delta = InterlockedDecrement(&amp;<a class="code" href="../../d3/d3/uuid_8c.html#a13">ExpUuidCachedValues</a>.<a class="code" href="../../d8/d4/struct__UUID__CACHED__VALUES__STRUCT.html#o1">AllocatedCount</a>);
00896 
00897         <span class="keywordflow">if</span> (<a class="code" href="../../d6/d6/ttime_8c.html#a14">Time</a> != <a class="code" href="../../d3/d3/uuid_8c.html#a13">ExpUuidCachedValues</a>.<a class="code" href="../../d8/d4/struct__UUID__CACHED__VALUES__STRUCT.html#o0">Time</a>) {
00898 
00899             <span class="comment">// If our captured time doesn't match the cache then another</span>
00900             <span class="comment">// thread already took the lock and updated the cache. We'll</span>
00901             <span class="comment">// just loop and try again.</span>
00902             <span class="keywordflow">continue</span>;
00903             }
00904 
00905         <span class="comment">// If the cache hadn't already run dry, we can break out of this retry</span>
00906         <span class="comment">// loop.</span>
00907         <span class="keywordflow">if</span> (Delta &gt;= 0) {
00908             <span class="keywordflow">break</span>;
00909             }
00910 
00911         <span class="comment">//</span>
00912         <span class="comment">// Allocate a new block of Uuids.</span>
00913         <span class="comment">//</span>
00914 
00915         <span class="comment">// Take the cache lock</span>
00916         <a class="code" href="../../d4/d9/ke_8h.html#a28">KeEnterCriticalRegion</a>();
00917         <a class="code" href="../../d5/d8/ex_8h.html#a231">ExAcquireFastMutexUnsafe</a>(&amp;ExpUuidLock);
00918 
00919         <span class="comment">// If the cache has already been updated, try again.</span>
00920         <span class="keywordflow">if</span> (<a class="code" href="../../d6/d6/ttime_8c.html#a14">Time</a> != <a class="code" href="../../d3/d3/uuid_8c.html#a13">ExpUuidCachedValues</a>.<a class="code" href="../../d8/d4/struct__UUID__CACHED__VALUES__STRUCT.html#o0">Time</a>) {
00921             <span class="comment">// Release the lock</span>
00922             <a class="code" href="../../d5/d8/ex_8h.html#a232">ExReleaseFastMutexUnsafe</a>(&amp;ExpUuidLock);
00923             <a class="code" href="../../d4/d9/ke_8h.html#a29">KeLeaveCriticalRegion</a>();
00924             <span class="keywordflow">continue</span>;
00925             }
00926 
00927         <span class="comment">// Update the cache.</span>
00928         <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d3/d3/uuid_8c.html#a21">ExpUuidGetValues</a>( &amp;ExpUuidCachedValues );
00929 
00930         <span class="keywordflow">if</span> (<a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> != STATUS_SUCCESS) {
00931             <span class="comment">// Release the lock</span>
00932             <a class="code" href="../../d5/d8/ex_8h.html#a232">ExReleaseFastMutexUnsafe</a>(&amp;ExpUuidLock);
00933             <a class="code" href="../../d4/d9/ke_8h.html#a29">KeLeaveCriticalRegion</a>();
00934             <span class="keywordflow">return</span>(<a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>);
00935             }
00936 
00937         <span class="comment">// The sequence number may have been dirtied, see if it needs</span>
00938         <span class="comment">// to be saved.  If there's an error, we'll ignore it and</span>
00939         <span class="comment">// retry on a future call.</span>
00940 
00941         <a class="code" href="../../d3/d3/uuid_8c.html#a20">ExpUuidSaveSequenceNumberIf</a>();
00942 
00943         <span class="comment">// Release the lock</span>
00944         <a class="code" href="../../d5/d8/ex_8h.html#a232">ExReleaseFastMutexUnsafe</a>(&amp;ExpUuidLock);
00945         <a class="code" href="../../d4/d9/ke_8h.html#a29">KeLeaveCriticalRegion</a>();
00946 
00947         <span class="comment">// Loop</span>
00948         }
00949 
00950     <span class="comment">// Adjust the time to that of the next available UUID.</span>
00951     <a class="code" href="../../d6/d6/ttime_8c.html#a14">Time</a> -= Delta;
00952 
00953     <span class="comment">// Finish filling in the UUID.</span>
00954 
00955     UuidGen-&gt;<a class="code" href="../../d9/d4/struct__UUID__GENERATE.html#o0">TimeLow</a> = (ULONG) <a class="code" href="../../d6/d6/ttime_8c.html#a14">Time</a>;
00956     UuidGen-&gt;<a class="code" href="../../d9/d4/struct__UUID__GENERATE.html#o1">TimeMid</a> = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>) (<a class="code" href="../../d6/d6/ttime_8c.html#a14">Time</a> &gt;&gt; 32);
00957     UuidGen-&gt;<a class="code" href="../../d9/d4/struct__UUID__GENERATE.html#o2">TimeHiAndVersion</a> = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)
00958         (( (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)(<a class="code" href="../../d6/d6/ttime_8c.html#a14">Time</a> &gt;&gt; (32+16))
00959         &amp; <a class="code" href="../../d3/d3/uuid_8c.html#a2">UUID_TIME_HIGH_MASK</a>) | <a class="code" href="../../d3/d3/uuid_8c.html#a3">UUID_VERSION</a>);
00960 
00961     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(Status == STATUS_SUCCESS);
00962 
00963     <span class="keywordflow">if</span> (<a class="code" href="../../d3/d3/uuid_8c.html#a12">ExpUuidCacheValid</a> == <a class="code" href="../../d3/d3/uuid_8c.html#a6">CACHE_LOCAL_ONLY</a>) {
00964         <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = RPC_NT_UUID_LOCAL_ONLY;
00965         }
00966 
00967     <span class="keywordflow">return</span>(<a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>);
00968 }
}
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a325" doxytag="ex.h::ExVerifySuite" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI BOOLEAN ExVerifySuite           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">SUITE_TYPE&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>SuiteType</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d5/d5/iosubs_8c-source.html#l06227">IoDeleteSymbolicLink()</a>, <a class="el" href="../../d2/d1/mm_2i386_2init386_8c-source.html#l00058">MiInitMachineDependent()</a>, <a class="el" href="../../d5/d4/procsup_8c-source.html#l00911">MmInitializeProcessAddressSpace()</a>, and <a class="el" href="../../d6/d0/mminit_8c-source.html#l00184">MmInitSystem()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a215" doxytag="ex.h::InitializePool" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID InitializePool           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d5/d8/ex_8h.html#a96">POOL_TYPE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>PoolType</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Threshold</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
DBG<p>
DBG 
<p>
Definition at line <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00677">677</a> of file <a class="el" href="../../d3/d1/ex_2pool_8c-source.html">ex/pool.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d6/d1/poolhack_8c-source.html#l00089">_POOL_LIST_HEAD::CurrentFreeLength</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l00253">ExAllocatePoolWithTag</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l00367">ExInitializeFastMutex</a>, <a class="el" href="../../d4/d2/pool_8h.html#a35">ExpInitializePoolDescriptor()</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l02000">ExpInsertPoolTracker()</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00429">ExpNumberOfPagedPools</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00452">ExpPagedPoolDescriptor</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00463">ExpTaggedPoolLock</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d2/d9/cmchek_8c-source.html#l00095">Index</a>, <a class="el" href="../../d0/d1/bugcheck_8c-source.html#l00070">KeBugCheck()</a>, <a class="el" href="../../d0/d1/bugcheck_8c-source.html#l00428">KeBugCheckEx()</a>, <a class="el" href="../../d4/d4/mutntobj_8c-source.html#l00099">KeInitializeMutex()</a>, <a class="el" href="../../d2/d5/semphobj_8c-source.html#l00039">KeInitializeSemaphore()</a>, <a class="el" href="../../d4/d9/ke_8h.html#a354">KeInitializeSpinLock()</a>, <a class="el" href="../../d3/d9/aw_8h-source.html#l00031">L</a>, <a class="el" href="../../d6/d1/poolhack_8c-source.html#l00100">_POOL_DESCRIPTOR::ListHeads</a>, <a class="el" href="../../d5/d1/pool_8h-source.html#l00125">_POOL_DESCRIPTOR::LockAddress</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00345">MAX_BIGPAGE_TABLE</a>, <a class="el" href="../../d2/d5/allocpag_8c-source.html#l00807">MiAllocatePoolPages()</a>, <a class="el" href="../../d5/d1/pool_8h-source.html#l00052">MUST_SUCCEED_POOL_TYPE_MASK</a>, <a class="el" href="../../d6/d1/poolhack_8c-source.html#l00140">MustSucceedPoolTable</a>, <a class="el" href="../../d5/d8/ex_8h.html#a329a173">NonPagedPool</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00440">NonPagedPoolDescriptor</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00441">NonPagedPoolDescriptorMS</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00454">NonPagedPoolLock</a>, <a class="el" href="../../d5/d8/ex_8h.html#a329a175">NonPagedPoolMustSucceed</a>, <a class="el" href="../../d0/d2/ldrp_8h-source.html#l00370">NtGlobalFlag</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d5/d8/ex_8h.html#a329a174">PagedPool</a>, <a class="el" href="../../d6/d1/poolhack_8c-source.html#l00119">PagedPoolDescriptor</a>, <a class="el" href="../../d6/d1/poolhack_8c-source.html#l00120">PagedPoolDescriptorMS</a>, <a class="el" href="../../d6/d1/poolhack_8c-source.html#l00123">PagedPoolLock</a>, <a class="el" href="../../d5/d2/poolhack_8c.html#a15">POOL_HEADER</a>, <a class="el" href="../../d6/d1/poolhack_8c-source.html#l00068">POOL_LIST_HEADS</a>, <a class="el" href="../../d6/d1/poolhack_8c-source.html#l00116">POOL_OVERHEAD</a>, <a class="el" href="../../d6/d1/poolhack_8c-source.html#l00066">POOL_PAGE_SIZE</a>, <a class="el" href="../../d5/d1/pool_8h-source.html#l00214">POOL_SMALLEST_BLOCK</a>, <a class="el" href="../../d4/d2/pool_8h.html#a33">POOL_TRACKER_BIG_PAGES</a>, <a class="el" href="../../d4/d2/pool_8h.html#a30">POOL_TRACKER_TABLE</a>, <a class="el" href="../../d5/d8/ex_8h.html#a96">POOL_TYPE</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00356">PoolBigPageTable</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00358">PoolBigPageTableHash</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00357">PoolBigPageTableSize</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00352">PoolTrackTable</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00354">PoolTrackTableMask</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00353">PoolTrackTableSize</a>, <a class="el" href="../../d5/d1/pool_8h-source.html#l00118">_POOL_DESCRIPTOR::PoolType</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l00451">PoolVector</a>, <a class="el" href="../../d2/d8/ps_8h-source.html#l00643">PsGetCurrentProcess</a>, <a class="el" href="../../d3/d0/mm_8h-source.html#l00117">ROUND_TO_PAGES</a>, <a class="el" href="../../d9/d6/lh__open_2pi__mem_8h-source.html#l00017">Size</a>, <a class="el" href="../../d5/d1/pool_8h-source.html#l00124">_POOL_DESCRIPTOR::Threshold</a>, and <a class="el" href="../../d5/d1/pool_8h-source.html#l00122">_POOL_DESCRIPTOR::TotalPages</a>.
<p>
Referenced by <a class="el" href="../../d6/d0/mminit_8c-source.html#l02184">MiBuildPagedPool()</a>, and <a class="el" href="../../d3/d0/inialpha_8c-source.html#l00041">MiInitMachineDependent()</a>.
<p>
<pre class="fragment"><div>00684                    :
00685 
00686     This <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a69">procedure</a> initializes a <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a> descriptor <span class="keywordflow">for</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a>
00687     <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a>.  Once initialized, <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a> may be used <span class="keywordflow">for</span> allocation and
00688     deallocation.
00689 
00690     This function should be called once <span class="keywordflow">for</span> each base <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a> <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> during
00691     system initialization.
00692 
00693     Each <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a> descriptor contains an array of list heads <span class="keywordflow">for</span> free
00694     blocks.  Each list head holds blocks which are a multiple of
00695     <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> POOL_BLOCK_SIZE.  The first element on <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> list [0] links
00696     together free entries of size POOL_BLOCK_SIZE, <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> second element
00697     [1] links together entries of POOL_BLOCK_SIZE * 2, <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> third
00698     POOL_BLOCK_SIZE * 3, etc, up to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> number of blocks which fit
00699     into a page.
00700 
00701 Arguments:
00702 
00703     PoolType - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> of <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a> being initialized (e.g.
00704                nonpaged pool, paged <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a>...).
00705 
00706     Threshold - Supplies the threshold value <span class="keywordflow">for</span> the specified <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a>.
00707 
00708 Return Value:
00709 
00710     None.
00711 
00712 --*/
00713 
00714 {
00715 
00716     <a class="code" href="../../d4/d8/struct__POOL__DESCRIPTOR.html">PPOOL_DESCRIPTOR</a> Descriptor;
00717     ULONG Index;
00718     <a class="code" href="../../d6/d9/struct__FAST__MUTEX.html">PFAST_MUTEX</a> FastMutex;
00719     SIZE_T Size;
00720 
00721     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>((PoolType &amp; MUST_SUCCEED_POOL_TYPE_MASK) == 0);
00722 
00723     <span class="keywordflow">if</span> (PoolType == NonPagedPool) {
00724 
00725         <span class="comment">//</span>
00726         <span class="comment">// Initialize nonpaged pools.</span>
00727         <span class="comment">//</span>
00728 
00729 #<span class="keywordflow">if</span> !DBG
00730         <span class="keywordflow">if</span> (NtGlobalFlag &amp; FLG_POOL_ENABLE_TAGGING) {
00731 #endif  
00732             PoolTrackTableSize = MAX_TRACKER_TABLE;
00733             PoolTrackTableMask = PoolTrackTableSize - 2;
00734             PoolTrackTable = <a class="code" href="../../d1/d6/allocpag_8c.html#a54">MiAllocatePoolPages</a>(NonPagedPool,
00735                                                  PoolTrackTableSize *
00736                                                    <span class="keyword">sizeof</span>(<a class="code" href="../../d2/d9/struct__POOL__TRACKER__TABLE.html">POOL_TRACKER_TABLE</a>),
00737                                                  FALSE);
00738 
00739             RtlZeroMemory(PoolTrackTable, PoolTrackTableSize * <span class="keyword">sizeof</span>(POOL_TRACKER_TABLE));
00740 
00741             PoolBigPageTableSize = MAX_BIGPAGE_TABLE;
00742             PoolBigPageTableHash = PoolBigPageTableSize - 1;
00743             PoolBigPageTable = <a class="code" href="../../d1/d6/allocpag_8c.html#a54">MiAllocatePoolPages</a>(NonPagedPool,
00744                                                    PoolBigPageTableSize *
00745                                                      <span class="keyword">sizeof</span>(<a class="code" href="../../d1/d9/struct__POOL__TRACKER__BIG__PAGES.html">POOL_TRACKER_BIG_PAGES</a>),
00746                                                    FALSE);
00747 
00748             RtlZeroMemory(PoolBigPageTable, PoolBigPageTableSize * <span class="keyword">sizeof</span>(POOL_TRACKER_BIG_PAGES));
00749 #<span class="keywordflow">if</span> !DBG
00750         }
00751 #endif  
00752 
00753         <span class="comment">//</span>
00754         <span class="comment">// Initialize the spinlocks for nonpaged pool.</span>
00755         <span class="comment">//</span>
00756 
00757         KeInitializeSpinLock (&amp;ExpTaggedPoolLock);
00758         <a class="code" href="../../d4/d9/ke_8h.html#a354">KeInitializeSpinLock</a>(&amp;NonPagedPoolLock);
00759 
00760         <span class="comment">//</span>
00761         <span class="comment">// Initialize the nonpaged pool descriptor.</span>
00762         <span class="comment">//</span>
00763 
00764         PoolVector[NonPagedPool] = &amp;NonPagedPoolDescriptor;
00765         <a class="code" href="../../d4/d2/pool_8h.html#a35">ExpInitializePoolDescriptor</a>(&amp;NonPagedPoolDescriptor,
00766                                     NonPagedPool,
00767                                     0,
00768                                     Threshold,
00769                                     (PVOID)&amp;NonPagedPoolLock);
00770 
00771         <span class="comment">//</span>
00772         <span class="comment">// Initialize the nonpaged must succeed pool descriptor.</span>
00773         <span class="comment">//</span>
00774 
00775         PoolVector[NonPagedPoolMustSucceed] = &amp;NonPagedPoolDescriptorMS;
00776         <a class="code" href="../../d4/d2/pool_8h.html#a35">ExpInitializePoolDescriptor</a>(&amp;NonPagedPoolDescriptorMS,
00777                                     NonPagedPoolMustSucceed,
00778                                     0,
00779                                     0,
00780                                     (PVOID)&amp;NonPagedPoolLock);
00781 
00782     } <span class="keywordflow">else</span> {
00783 
00784         <span class="comment">//</span>
00785         <span class="comment">// Allocate memory for the paged pool descriptors and fast mutexes.</span>
00786         <span class="comment">//</span>
00787 
00788         Size = (ExpNumberOfPagedPools + 1) * (<span class="keyword">sizeof</span>(<a class="code" href="../../d6/d9/struct__FAST__MUTEX.html">FAST_MUTEX</a>) + <span class="keyword">sizeof</span>(<a class="code" href="../../d4/d8/struct__POOL__DESCRIPTOR.html">POOL_DESCRIPTOR</a>));
00789         Descriptor = (<a class="code" href="../../d4/d8/struct__POOL__DESCRIPTOR.html">PPOOL_DESCRIPTOR</a>)ExAllocatePoolWithTag (NonPagedPool,
00790                                                               Size,
00791                                                               'looP');
00792         <span class="keywordflow">if</span> (Descriptor == NULL) {
00793             KeBugCheckEx (MUST_SUCCEED_POOL_EMPTY,
00794                           Size,
00795                           (ULONG_PTR)-1,
00796                           (ULONG_PTR)-1,
00797                           (ULONG_PTR)-1);
00798         }
00799 
00800         <span class="keywordflow">if</span> (PoolTrackTable) {
00801             <a class="code" href="../../d2/d2/ex_2pool_8c.html#a65">ExpInsertPoolTracker</a>('looP',
00802                                   (ULONG) <a class="code" href="../../d2/d1/mm_8h.html#a4">ROUND_TO_PAGES</a>(PoolTrackTableSize * <span class="keyword">sizeof</span>(POOL_TRACKER_TABLE)),
00803                                  NonPagedPool);
00804 
00805             <a class="code" href="../../d2/d2/ex_2pool_8c.html#a65">ExpInsertPoolTracker</a>('looP',
00806                                   (ULONG) <a class="code" href="../../d2/d1/mm_8h.html#a4">ROUND_TO_PAGES</a>(PoolBigPageTableSize * <span class="keyword">sizeof</span>(POOL_TRACKER_BIG_PAGES)),
00807                                  NonPagedPool);
00808         }
00809 
00810         FastMutex = (<a class="code" href="../../d6/d9/struct__FAST__MUTEX.html">PFAST_MUTEX</a>)(Descriptor + ExpNumberOfPagedPools + 1);
00811         PoolVector[PagedPool] = Descriptor;
00812         ExpPagedPoolDescriptor = Descriptor;
00813         <span class="keywordflow">for</span> (Index = 0; Index &lt; (ExpNumberOfPagedPools + 1); Index += 1) {
00814             <a class="code" href="../../d5/d8/ex_8h.html#a8">ExInitializeFastMutex</a>(FastMutex);
00815             <a class="code" href="../../d4/d2/pool_8h.html#a35">ExpInitializePoolDescriptor</a>(Descriptor,
00816                                         PagedPool,
00817                                         Index,
00818                                         Threshold,
00819                                         (PVOID)FastMutex);
00820 
00821             Descriptor += 1;
00822             FastMutex += 1;
00823         }
00824     }
00825 
00826     <span class="comment">//</span>
00827     <span class="comment">// The maximum cache alignment must be less than the size of the</span>
00828     <span class="comment">// smallest pool block because the lower bits are being cleared</span>
00829     <span class="comment">// in ExFreePool to find the entry's address.</span>
00830     <span class="comment">//</span>
00831 
00832 #<span class="keywordflow">if</span> POOL_CACHE_SUPPORTED
00833 
00834     <span class="comment">//</span>
00835     <span class="comment">// Compute pool cache information.</span>
00836     <span class="comment">//</span>
00837 
00838     PoolCacheSize = HalGetDmaAlignmentRequirement();
00839 
00840     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(PoolCacheSize &gt;= POOL_OVERHEAD);
00841 
00842     PoolCacheOverhead = PoolCacheSize + PoolCacheSize - (<span class="keyword">sizeof</span>(<a class="code" href="../../d5/d8/struct__POOL__HEADER.html">POOL_HEADER</a>) + 1);
00843 
00844     PoolBuddyMax =
00845        (POOL_PAGE_SIZE - (POOL_OVERHEAD + (3*POOL_SMALLEST_BLOCK) + 2*PoolCacheSize));
00846 
00847 #endif <span class="comment">//POOL_CACHE_SUPPORTED</span>
00848 
00849 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a258" doxytag="ex.h::ProbeForRead" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI VOID NTAPI ProbeForRead           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN CONST VOID *&nbsp;</td>
          <td class="mdname" nowrap> <em>Address</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Length</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Alignment</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d4/probe_8c-source.html#l00148">148</a> of file <a class="el" href="../../d0/d4/probe_8c-source.html">probe.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d0/d3/raise_8c-source.html#l00044">ExRaiseAccessViolation()</a>, <a class="el" href="../../d0/d3/raise_8c-source.html#l00071">ExRaiseDatatypeMisalignment()</a>, and <a class="el" href="../../d1/d8/ntosdef_8h-source.html#l00462">PAGED_CODE</a>.
<p>
<pre class="fragment"><div>00156                    :
00157 
00158     This function probes a structure <span class="keywordflow">for</span> read accessibility and ensures
00159     correct alignment of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> structure. If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> structure <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> not accessible
00160     or has incorrect alignment, then an exception <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> raised.
00161 
00162 Arguments:
00163 
00164     Address - Supplies a pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> structure to be probed.
00165 
00166     Length - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> length of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> structure.
00167 
00168     Alignment - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> required alignment of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> structure expressed
00169         as <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> number of bytes in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> primitive datatype (e.g., 1 <span class="keywordflow">for</span> <span class="keywordtype">char</span>,
00170         2 <span class="keywordflow">for</span> <span class="keywordtype">short</span>, 4 <span class="keywordflow">for</span> <span class="keywordtype">long</span>, and 8 <span class="keywordflow">for</span> quad).
00171 
00172 Return Value:
00173 
00174     None.
00175 
00176 --*/
00177 {
00178     <a class="code" href="../../d0/d9/ntosdef_8h.html#a28">PAGED_CODE</a>();
00179 
00180     <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(((Alignment) == 1) || ((Alignment) == 2) ||
00181            ((Alignment) == 4) || ((Alignment) == 8) ||
00182            ((Alignment) == 16));
00183 
00184     <span class="keywordflow">if</span> ((Length) != 0) {
00185         <span class="keywordflow">if</span> (((ULONG_PTR)(Address) &amp; ((Alignment) - 1)) != 0) {
00186             <a class="code" href="../../d5/d8/ex_8h.html#a304">ExRaiseDatatypeMisalignment</a>();
00187 
00188         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((((ULONG_PTR)(Address) + (Length)) &lt; (ULONG_PTR)(Address)) ||
00189                    (((ULONG_PTR)(Address) + (Length)) &gt; (ULONG_PTR)MM_USER_PROBE_ADDRESS)) {
00190             <a class="code" href="../../d5/d8/ex_8h.html#a305">ExRaiseAccessViolation</a>();
00191         }
00192     }
00193 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a259" doxytag="ex.h::ProbeForWrite" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTKERNELAPI VOID NTAPI ProbeForWrite           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>Address</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Length</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Alignment</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d4/probe_8c-source.html#l00034">34</a> of file <a class="el" href="../../d0/d4/probe_8c-source.html">probe.c</a>.
<p>
References <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d2/d0/bench_8c-source.html#l00050">CHAR</a>, <a class="el" href="../../d0/d3/raise_8c-source.html#l00044">ExRaiseAccessViolation()</a>, <a class="el" href="../../d0/d3/raise_8c-source.html#l00071">ExRaiseDatatypeMisalignment()</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00599">PAGE_SIZE</a>.
<p>
Referenced by <a class="el" href="../../d7/d9/w32_2ntuser_2kernel_2misc_8c-source.html#l00872">_GetWinStationInfo()</a>, <a class="el" href="../../d1/d7/dir_8c-source.html#l00057">BuildQueryDirectoryIrp()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l13465">GetHDevName()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l08084">IopXxxControlFile()</a>, <a class="el" href="../../d9/d7/i386_2kdtrap_8c-source.html#l00038">KdpTrap()</a>, <a class="el" href="../../d1/d8/ia64_2exceptn_8c-source.html#l00760">KeRaiseUserException()</a>, <a class="el" href="../../d4/d3/ke_2alpha_2callback_8c-source.html#l00028">KeUserModeCallback()</a>, <a class="el" href="../../d9/d7/alpha_2exceptn_8c-source.html#l00412">KiDispatchException()</a>, <a class="el" href="../../d3/d1/byteem_8c-source.html#l00049">KiEmulateByteWord()</a>, <a class="el" href="../../d5/d4/alpha_2alignem_8c-source.html#l00160">KiEmulateReference()</a>, <a class="el" href="../../d8/d6/alpha_2apcuser_8c-source.html#l00033">KiInitializeUserApc()</a>, <a class="el" href="../../d6/d6/lpcreply_8c-source.html#l00915">LpcpCopyRequestData()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l11253">MESSAGECALL()</a>, <a class="el" href="../../d0/d5/readwrt_8c-source.html#l00529">MiDoMappedCopy()</a>, <a class="el" href="../../d0/d5/readwrt_8c-source.html#l00758">MiDoPoolCopy()</a>, <a class="el" href="../../d4/d4/mapview_8c-source.html#l04177">MmSecureVirtualMemory()</a>, <a class="el" href="../../d5/d5/lpccompl_8c-source.html#l00040">NtAcceptConnectPort()</a>, <a class="el" href="../../d6/d2/tokenadj_8c-source.html#l00432">NtAdjustGroupsToken()</a>, <a class="el" href="../../d6/d2/tokenadj_8c-source.html#l00046">NtAdjustPrivilegesToken()</a>, <a class="el" href="../../d1/d7/luid_8c-source.html#l00081">NtAllocateLocallyUniqueId()</a>, <a class="el" href="../../d9/d4/physical_8c-source.html#l00970">NtAllocateUserPhysicalPages()</a>, <a class="el" href="../../d4/d2/uuid_8c-source.html#l00617">NtAllocateUuids()</a>, <a class="el" href="../../d0/d6/ex_2profile_8c-source.html#l00199">NtCreateProfile()</a>, <a class="el" href="../../d3/d7/ps_2create_8c-source.html#l00067">NtCreateThread()</a>, <a class="el" href="../../d8/d6/ntapi_8c-source.html#l00610">NtEnumerateKey()</a>, <a class="el" href="../../d8/d6/ntapi_8c-source.html#l00756">NtEnumerateValueKey()</a>, <a class="el" href="../../d9/d9/extsect_8c-source.html#l00085">NtExtendSection()</a>, <a class="el" href="../../d3/d9/psctx_8c-source.html#l00151">NtGetContextThread()</a>, <a class="el" href="../../d4/d4/mapview_8c-source.html#l00199">NtMapViewOfSection()</a>, <a class="el" href="../../d2/d7/super_8c-source.html#l00311">NtMapViewOfSuperSection()</a>, <a class="el" href="../../d1/d7/dir_8c-source.html#l00821">NtNotifyChangeDirectoryFile()</a>, <a class="el" href="../../d8/d6/ntapi_8c-source.html#l01319">NtNotifyChangeMultipleKeys()</a>, <a class="el" href="../../d9/d3/privileg_8c-source.html#l00231">NtPrivilegeCheck()</a>, <a class="el" href="../../d2/d9/io_2misc_8c-source.html#l00629">NtQueryAttributesFile()</a>, <a class="el" href="../../d9/d9/obdir_8c-source.html#l00229">NtQueryDirectoryObject()</a>, <a class="el" href="../../d8/d1/qsea_8c-source.html#l00035">NtQueryEaFile()</a>, <a class="el" href="../../d1/d7/ex_2event_8c-source.html#l00514">NtQueryEvent()</a>, <a class="el" href="../../d2/d9/io_2misc_8c-source.html#l00745">NtQueryFullAttributesFile()</a>, <a class="el" href="../../d7/d7/exatom_8c-source.html#l00294">NtQueryInformationAtom()</a>, <a class="el" href="../../d0/d2/qsinfo_8c-source.html#l00101">NtQueryInformationFile()</a>, <a class="el" href="../../d2/d0/psjob_8c-source.html#l00814">NtQueryInformationJobObject()</a>, <a class="el" href="../../d3/d6/lpcquery_8c-source.html#l00030">NtQueryInformationPort()</a>, <a class="el" href="../../d0/d1/psquery_8c-source.html#l00531">NtQueryInformationProcess()</a>, <a class="el" href="../../d0/d1/psquery_8c-source.html#l02706">NtQueryInformationThread()</a>, <a class="el" href="../../d0/d3/tokenqry_8c-source.html#l00034">NtQueryInformationToken()</a>, <a class="el" href="../../d6/d3/complete_8c-source.html#l00282">NtQueryIoCompletion()</a>, <a class="el" href="../../d8/d6/ntapi_8c-source.html#l02018">NtQueryKey()</a>, <a class="el" href="../../d8/d6/ntapi_8c-source.html#l03461">NtQueryMultipleValueKey()</a>, <a class="el" href="../../d3/d4/mutant_8c-source.html#l00380">NtQueryMutant()</a>, <a class="el" href="../../d7/d0/obquery_8c-source.html#l00058">NtQueryObject()</a>, <a class="el" href="../../d0/d6/ex_2profile_8c-source.html#l00851">NtQueryPerformanceCounter()</a>, <a class="el" href="../../d1/d2/qsquota_8c-source.html#l00035">NtQueryQuotaInformationFile()</a>, <a class="el" href="../../d5/d2/querysec_8c-source.html#l00031">NtQuerySection()</a>, <a class="el" href="../../d0/d1/obse_8c-source.html#l00255">NtQuerySecurityObject()</a>, <a class="el" href="../../d3/d5/semphore_8c-source.html#l00360">NtQuerySemaphore()</a>, <a class="el" href="../../d5/d0/oblink_8c-source.html#l00333">NtQuerySymbolicLinkObject()</a>, <a class="el" href="../../d6/d7/sysenv_8c-source.html#l00045">NtQuerySystemEnvironmentValue()</a>, <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l00941">NtQuerySystemInformation()</a>, <a class="el" href="../../d3/d1/timer_8c-source.html#l00822">NtQueryTimer()</a>, <a class="el" href="../../d6/d2/queryvm_8c-source.html#l00061">NtQueryVirtualMemory()</a>, <a class="el" href="../../d9/d1/qsfs_8c-source.html#l00037">NtQueryVolumeInformationFile()</a>, <a class="el" href="../../d7/d4/io_2read_8c-source.html#l00036">NtReadFile()</a>, <a class="el" href="../../d5/d6/lpcrecv_8c-source.html#l00029">NtReplyWaitReceivePort()</a>, <a class="el" href="../../d5/d6/lpcrecv_8c-source.html#l00635">NtReplyWaitReceivePortEx()</a>, <a class="el" href="../../d6/d6/lpcreply_8c-source.html#l00375">NtReplyWaitReplyPort()</a>, <a class="el" href="../../d7/d6/lpcsend_8c-source.html#l00395">NtRequestWaitReplyPort()</a>, <a class="el" href="../../d6/d5/lpcconn_8c-source.html#l00084">NtSecureConnectPort()</a>, <a class="el" href="../../d3/d2/dbgctrl_8c-source.html#l00036">NtSystemDebugControl()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l08365">NtUserBuildNameList()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l00870">NtUserConsoleControl()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l03336">NtUserCreateLocalMemHandle()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l04415">NtUserDdeGetQualityOfService()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l04369">NtUserDdeSetQualityOfService()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l01710">NtUserDrawIconEx()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l03726">NtUserGetAltTabInfo()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l08817">NtUserGetClassInfo()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l08904">NtUserGetClassName()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l03564">NtUserGetComboBoxInfo()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l03622">NtUserGetCursorInfo()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l03479">NtUserGetGUIThreadInfo()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l01593">NtUserGetIconInfo()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l12769">NtUserGetImeInfoEx()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l09022">NtUserGetKeyboardLayoutName()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l09565">NtUserGetKeyboardState()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l03785">NtUserGetMenuBarInfo()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l00662">NtUserGetObjectInformation()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l03666">NtUserGetScrollBarInfo()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l03527">NtUserGetTitleBarInfo()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l00643">NtUserHardErrorControl()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l01028">NtUserOpenWindowStation()</a>, <a class="el" href="../../d0/d6/kernel_2server_8c-source.html#l02788">NtUserProcessConnect()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l07532">NtUserQueryInformationThread()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l13179">NtUserQueryUserCounters()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l07575">NtUserSetInformationThread()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l02400">NtUserSystemParametersInfo()</a>, <a class="el" href="../../d0/d9/kernel_2ntstubs_8c-source.html#l00724">NtUserWin32PoolAllocationStats()</a>, <a class="el" href="../../d1/d3/accessck_8c-source.html#l02704">SeAccessCheckByType()</a>, <a class="el" href="../../d4/d4/seaudit_8c-source.html#l01050">SepAccessCheckAndAuditAlarm()</a>, <a class="el" href="../../d0/d4/vdmints_8c-source.html#l00477">VdmDispatchInterrupts()</a>, <a class="el" href="../../d8/d3/vdminit_8c-source.html#l00019">VdmpInitialize()</a>, <a class="el" href="../../d5/d4/vdmprint_8c-source.html#l00388">VdmpPrinterDirectIoClose()</a>, <a class="el" href="../../d5/d4/vdmprint_8c-source.html#l00295">VdmpPrinterInitialize()</a>, <a class="el" href="../../d4/d3/vdm_2vdm_8c-source.html#l00087">VdmQueryDirectoryFile()</a>, <a class="el" href="../../d6/d7/ntimm_8c-source.html#l00531">xxxCreateDefaultImeWindow()</a>, and <a class="el" href="../../d4/d5/kernel_2sendmsg_8c-source.html#l00609">xxxSendMessageEx()</a>.
<p>
<pre class="fragment"><div>00042                    :
00043 
00044     This function probes a structure <span class="keywordflow">for</span> write accessibility and ensures
00045     correct alignment of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> structure. If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> structure <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> not accessible
00046     or has incorrect alignment, then an exception <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> raised.
00047 
00048 Arguments:
00049 
00050     Address - Supplies a pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> structure to be probed.
00051 
00052     Length - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> length of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> structure.
00053 
00054     Alignment - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> required alignment of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> structure expressed
00055         as <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> number of bytes in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> primitive datatype (e.g., 1 <span class="keywordflow">for</span> <span class="keywordtype">char</span>,
00056         2 <span class="keywordflow">for</span> <span class="keywordtype">short</span>, 4 <span class="keywordflow">for</span> <span class="keywordtype">long</span>, and 8 <span class="keywordflow">for</span> quad).
00057 
00058 Return Value:
00059 
00060     None.
00061 
00062 --*/
00063 
00064 {
00065 
00066     ULONG_PTR EndAddress;
00067     ULONG_PTR StartAddress;
00068 
00069     <span class="comment">//</span>
00070     <span class="comment">// If the structure has zero length, then do not probe the structure for</span>
00071     <span class="comment">// write accessibility or alignment.</span>
00072     <span class="comment">//</span>
00073 
00074     <span class="keywordflow">if</span> (Length != 0) {
00075 
00076         <span class="comment">//</span>
00077         <span class="comment">// If the structure is not properly aligned, then raise a data</span>
00078         <span class="comment">// misalignment exception.</span>
00079         <span class="comment">//</span>
00080 
00081         <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>((Alignment == 1) || (Alignment == 2) ||
00082                (Alignment == 4) || (Alignment == 8) ||
00083                (Alignment == 16));
00084 
00085         StartAddress = (ULONG_PTR)Address;
00086         <span class="keywordflow">if</span> ((StartAddress &amp; (Alignment - 1)) == 0) {
00087 
00088             <span class="comment">//</span>
00089             <span class="comment">// Compute the ending address of the structure and probe for</span>
00090             <span class="comment">// write accessibility.</span>
00091             <span class="comment">//</span>
00092 
00093             EndAddress = StartAddress + Length - 1;
00094             <span class="keywordflow">if</span> ((StartAddress &lt;= EndAddress) &amp;&amp;
00095                 (EndAddress &lt; MM_USER_PROBE_ADDRESS)) {
00096 
00097                 <span class="comment">//</span>
00098                 <span class="comment">// N.B. Only the contents of the buffer may be probed.</span>
00099                 <span class="comment">//      Therefore the starting byte is probed for the</span>
00100                 <span class="comment">//      first page, and then the first byte in the page</span>
00101                 <span class="comment">//      for each succeeding page.</span>
00102                 <span class="comment">//</span>
00103 
00104                 EndAddress = (EndAddress &amp; ~(<a class="code" href="../../d6/d7/halmips_8h.html#a446">PAGE_SIZE</a> - 1)) + <a class="code" href="../../d6/d7/halmips_8h.html#a446">PAGE_SIZE</a>;
00105 
00106 <span class="preprocessor">#if defined(_ALPHA_)</span>
00107 <span class="preprocessor"></span>
00108                 <span class="comment">//</span>
00109                 <span class="comment">// N.B. The address is truncated to a longword aligned</span>
00110                 <span class="comment">//      address since Alpha has no load or store byte</span>
00111                 <span class="comment">//      instructions.</span>
00112                 <span class="comment">//</span>
00113 
00114                 StartAddress &amp;= ~((ULONG_PTR)<span class="keyword">sizeof</span>(LONG) - 1);
00115 
00116                 <span class="keywordflow">do</span> {
00117                     *(<span class="keyword">volatile</span> LONG *)StartAddress = *(<span class="keyword">volatile</span> LONG *)StartAddress;
00118                     StartAddress = (StartAddress &amp; ~(<a class="code" href="../../d6/d7/halmips_8h.html#a446">PAGE_SIZE</a> - 1)) + <a class="code" href="../../d6/d7/halmips_8h.html#a446">PAGE_SIZE</a>;
00119                 } <span class="keywordflow">while</span> (StartAddress != EndAddress);
00120 
00121 <span class="preprocessor">#else</span>
00122 <span class="preprocessor"></span>
00123                 <span class="keywordflow">do</span> {
00124                     *(<span class="keyword">volatile</span> <a class="code" href="../../d1/d1/bench_8c.html#a16">CHAR</a> *)StartAddress = *(<span class="keyword">volatile</span> <a class="code" href="../../d1/d1/bench_8c.html#a16">CHAR</a> *)StartAddress;
00125 
00126                     StartAddress = (StartAddress &amp; ~(<a class="code" href="../../d6/d7/halmips_8h.html#a446">PAGE_SIZE</a> - 1)) + <a class="code" href="../../d6/d7/halmips_8h.html#a446">PAGE_SIZE</a>;
00127                 } <span class="keywordflow">while</span> (StartAddress != EndAddress);
00128 <span class="preprocessor">#endif</span>
00129 <span class="preprocessor"></span>
00130                 <span class="keywordflow">return</span>;
00131 
00132             } <span class="keywordflow">else</span> {
00133                 <a class="code" href="../../d5/d8/ex_8h.html#a305">ExRaiseAccessViolation</a>();
00134             }
00135 
00136         } <span class="keywordflow">else</span> {
00137             <a class="code" href="../../d5/d8/ex_8h.html#a304">ExRaiseDatatypeMisalignment</a>();
00138         }
00139     }
00140 
00141     <span class="keywordflow">return</span>;
00142 }

</div></pre>    </td>
  </tr>
</table>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="a148" doxytag="ex.h::EvPrSetHigh" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG <a class="el" href="../../d5/d8/ex_8h.html#a148">EvPrSetHigh</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l03110">3110</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.
<p>
Referenced by <a class="el" href="../../d4/d7/eventpr_8c-source.html#l00651">NtSetHighEventPair()</a>, and <a class="el" href="../../d4/d7/eventpr_8c-source.html#l00532">NtSetHighWaitLowEventPair()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a149" doxytag="ex.h::EvPrSetLow" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG <a class="el" href="../../d5/d8/ex_8h.html#a149">EvPrSetLow</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l03111">3111</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.
<p>
Referenced by <a class="el" href="../../d4/d7/eventpr_8c-source.html#l00592">NtSetLowEventPair()</a>, and <a class="el" href="../../d4/d7/eventpr_8c-source.html#l00472">NtSetLowWaitHighEventPair()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a169" doxytag="ex.h::ExCbPowerState" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d9/d6/struct__CALLBACK__OBJECT.html">PCALLBACK_OBJECT</a> <a class="el" href="../../d5/d8/ex_8h.html#a169">ExCbPowerState</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l03329">3329</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a168" doxytag="ex.h::ExCbSetSystemState" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d9/d6/struct__CALLBACK__OBJECT.html">PCALLBACK_OBJECT</a> <a class="el" href="../../d5/d8/ex_8h.html#a168">ExCbSetSystemState</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l03328">3328</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a167" doxytag="ex.h::ExCbSetSystemTime" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d9/d6/struct__CALLBACK__OBJECT.html">PCALLBACK_OBJECT</a> <a class="el" href="../../d5/d8/ex_8h.html#a167">ExCbSetSystemTime</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l03327">3327</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a163" doxytag="ex.h::ExCriticalWorkerThreads" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG <a class="el" href="../../d5/d8/ex_8h.html#a163">ExCriticalWorkerThreads</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l03313">3313</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.
<p>
Referenced by <a class="el" href="../../d6/d7/fssup_8c-source.html#l00069">CcInitializeCacheManager()</a>, and <a class="el" href="../../d2/d8/worker_8c-source.html#l00220">ExpWorkerInitialization()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a164" doxytag="ex.h::ExDelayedWorkerThreads" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG <a class="el" href="../../d5/d8/ex_8h.html#a164">ExDelayedWorkerThreads</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l03314">3314</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.
<p>
Referenced by <a class="el" href="../../d2/d8/worker_8c-source.html#l00220">ExpWorkerInitialization()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a171" doxytag="ex.h::ExGlobalAtomTableCallout" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d5/d8/ex_8h.html#a170">PKWIN32_GLOBALATOMTABLE_CALLOUT</a> <a class="el" href="../../d5/d8/ex_8h.html#a171">ExGlobalAtomTableCallout</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l03336">3336</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.
<p>
Referenced by <a class="el" href="../../d7/d7/exatom_8c-source.html#l00442">ExpGetGlobalAtomTable()</a>, and <a class="el" href="../../d0/d1/psquery_8c-source.html#l03855">PsEstablishWin32Callouts()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a166" doxytag="ex.h::ExPageLockHandle" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> PVOID <a class="el" href="../../d5/d8/ex_8h.html#a166">ExPageLockHandle</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l03321">3321</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.
<p>
Referenced by <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l03579">ExpGetLockInformation()</a>, <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l03661">ExpGetLookasideInformation()</a>, <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l03846">ExpGetPoolInformation()</a>, <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l03060">ExpGetProcessInformation()</a>, <a class="el" href="../../d9/d3/mtrr_8c-source.html#l00576">KeSetPhysicalCacheTypeRange()</a>, <a class="el" href="../../d1/d4/mtrramd_8c-source.html#l00294">KiAmdK6MtrrSetMemoryType()</a>, <a class="el" href="../../d6/d9/wsmanage_8c-source.html#l02715">MiEmptyAllWorkingSets()</a>, <a class="el" href="../../d2/d5/allocpag_8c-source.html#l04569">MiFindContiguousMemory()</a>, <a class="el" href="../../d9/d7/sysload_8c-source.html#l00443">MiLoadSystemImage()</a>, <a class="el" href="../../d4/d4/mapview_8c-source.html#l03268">MiMapViewInSystemSpace()</a>, <a class="el" href="../../d9/d7/sysload_8c-source.html#l02309">MiSetPagingOfDriver()</a>, <a class="el" href="../../d5/d6/sessload_8c-source.html#l00119">MiShareSessionImage()</a>, <a class="el" href="../../d6/d5/iosup_8c-source.html#l03253">MiUnmapLockedPagesInUserSpace()</a>, <a class="el" href="../../d4/d4/mapview_8c-source.html#l03683">MiUnmapViewInSystemSpace()</a>, <a class="el" href="../../d5/d9/wslist_8c-source.html#l02450">MmAdjustWorkingSetSize()</a>, <a class="el" href="../../d6/d5/iosup_8c-source.html#l05581">MmAllocateNonCachedMemory()</a>, <a class="el" href="../../d6/d5/iosup_8c-source.html#l04270">MmAllocatePagesForMdl()</a>, <a class="el" href="../../d9/d7/sysload_8c-source.html#l02106">MmFreeDriverInitialization()</a>, <a class="el" href="../../d6/d5/iosup_8c-source.html#l05721">MmFreeNonCachedMemory()</a>, <a class="el" href="../../d6/d5/iosup_8c-source.html#l05051">MmFreePagesFromMdl()</a>, <a class="el" href="../../d6/d5/iosup_8c-source.html#l07821">MmLockPagedPool()</a>, <a class="el" href="../../d4/d4/mapview_8c-source.html#l00753">MmMapViewOfSection()</a>, <a class="el" href="../../d9/d7/sysload_8c-source.html#l02560">MmResetDriverPaging()</a>, <a class="el" href="../../d2/d8/shutdown_8c-source.html#l00041">MmShutdownSystem()</a>, <a class="el" href="../../d9/d7/sysload_8c-source.html#l02896">MmUnloadSystemImage()</a>, <a class="el" href="../../d6/d5/iosup_8c-source.html#l07869">MmUnlockPagedPool()</a>, <a class="el" href="../../d6/d2/queryvm_8c-source.html#l00061">NtQueryVirtualMemory()</a>, <a class="el" href="../../d0/d1/psquery_8c-source.html#l00291">PspQueryPooledQuotaLimits()</a>, <a class="el" href="../../d0/d1/psquery_8c-source.html#l00209">PspQueryQuotaLimits()</a>, <a class="el" href="../../d0/d1/psquery_8c-source.html#l00113">PspQueryWorkingSetWatch()</a>, and <a class="el" href="../../d0/d1/psquery_8c-source.html#l01211">PspSetQuotaLimits()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a160" doxytag="ex.h::ExpAltTimeZoneBias" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> LONG <a class="el" href="../../d5/d8/ex_8h.html#a160">ExpAltTimeZoneBias</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l03310">3310</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a161" doxytag="ex.h::ExpCurrentTimeZoneId" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG <a class="el" href="../../d5/d8/ex_8h.html#a161">ExpCurrentTimeZoneId</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l03311">3311</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.
<p>
Referenced by <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l00941">NtQuerySystemInformation()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a159" doxytag="ex.h::ExpLastTimeZoneBias" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> LONG <a class="el" href="../../d5/d8/ex_8h.html#a159">ExpLastTimeZoneBias</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l03309">3309</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a144" doxytag="ex.h::ExpLuid" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> LARGE_INTEGER <a class="el" href="../../d5/d8/ex_8h.html#a144">ExpLuid</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l03019">3019</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.
<p>
Referenced by <a class="el" href="../../d1/d7/luid_8c-source.html#l00037">ExLuidInitialization()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a145" doxytag="ex.h::ExpLuidIncrement" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> LARGE_INTEGER <a class="el" href="../../d5/d8/ex_8h.html#a145">ExpLuidIncrement</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l03020">3020</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.
<p>
Referenced by <a class="el" href="../../d1/d7/luid_8c-source.html#l00037">ExLuidInitialization()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a146" doxytag="ex.h::ExpLuidLock" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> KSPIN_LOCK <a class="el" href="../../d5/d8/ex_8h.html#a146">ExpLuidLock</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l03021">3021</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a162" doxytag="ex.h::ExpRealTimeIsUniversal" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG <a class="el" href="../../d5/d8/ex_8h.html#a162">ExpRealTimeIsUniversal</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l03312">3312</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a165" doxytag="ex.h::ExpTickCountMultiplier" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG <a class="el" href="../../d5/d8/ex_8h.html#a165">ExpTickCountMultiplier</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l03315">3315</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.
<p>
Referenced by <a class="el" href="../../d0/d5/gettickc_8c-source.html#l00026">NtGetTickCount()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a158" doxytag="ex.h::ExpTimeZoneBias" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> LARGE_INTEGER <a class="el" href="../../d5/d8/ex_8h.html#a158">ExpTimeZoneBias</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l03308">3308</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.
<p>
Referenced by <a class="el" href="../../d7/d7/sysinfo_8c-source.html#l00941">NtQuerySystemInformation()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a147" doxytag="ex.h::ExReadyForErrors" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN <a class="el" href="../../d5/d8/ex_8h.html#a147">ExReadyForErrors</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l03087">3087</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.
<p>
Referenced by <a class="el" href="../../d6/d0/cmgquota_8c-source.html#l00204">CmpClaimGlobalQuota()</a>, <a class="el" href="../../d6/d2/cmworker_8c-source.html#l00556">CmpDiskFullWarning()</a>, <a class="el" href="../../d7/d7/ex_2harderr_8c-source.html#l00349">ExpRaiseHardError()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l02977">IopHardErrorThread()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l05617">IopRaiseHardError()</a>, <a class="el" href="../../d3/d3/internal_8c-source.html#l05841">IopRaiseInformationalHardError()</a>, and <a class="el" href="../../d7/d7/ex_2harderr_8c-source.html#l00886">NtSetDefaultHardErrorPort()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a116" doxytag="ex.h::ExWorkerQueue" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d8/d7/struct__EX__WORK__QUEUE.html">EX_WORK_QUEUE</a> <a class="el" href="../../d5/d8/ex_8h.html#a116">ExWorkerQueue</a>[]          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d7/ex_8h-source.html#l02031">2031</a> of file <a class="el" href="../../d6/d7/ex_8h-source.html">ex.h</a>.
<p>
Referenced by <a class="el" href="../../d2/d8/worker_8c-source.html#l01097">ExpCheckForWorker()</a>, <a class="el" href="../../d2/d8/worker_8c-source.html#l00971">ExpCreateWorkerThread()</a>, <a class="el" href="../../d2/d8/worker_8c-source.html#l00853">ExpDetectWorkerThreadDeadlock()</a>, <a class="el" href="../../d2/d8/worker_8c-source.html#l00159">ExpNewThreadNecessary()</a>, <a class="el" href="../../d2/d8/worker_8c-source.html#l00220">ExpWorkerInitialization()</a>, <a class="el" href="../../d2/d8/worker_8c-source.html#l00538">ExpWorkerThread()</a>, <a class="el" href="../../d2/d8/worker_8c-source.html#l00375">ExQueueWorkItem()</a>, <a class="el" href="../../d9/d2/queueobj_8c-source.html#l00238">KeRemoveQueue()</a>, and <a class="el" href="../../d0/d1/thredobj_8c-source.html#l01996">KeTerminateThread()</a>.    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:43:34 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
