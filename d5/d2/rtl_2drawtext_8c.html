<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: rtl/drawtext.c File Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>drawtext.c File Reference</h1>
<p>
<a href="../../d6/d1/rtl_2drawtext_8c-source.html">Go to the source code of this file.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Classes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>struct &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d4/d1/struct__FULLWIDTH__UNICODE.html">_FULLWIDTH_UNICODE</a></td></tr>

<tr><td colspan=2><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d2/rtl_2drawtext_8c.html#a0">CALCRECT</a>(wFormat)&nbsp;&nbsp;&nbsp;(wFormat &amp; DT_CALCRECT)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d2/rtl_2drawtext_8c.html#a1">EDITCONTROL</a>(wFormat)&nbsp;&nbsp;&nbsp;(wFormat &amp; DT_EDITCONTROL)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d2/rtl_2drawtext_8c.html#a2">EXPANDTABS</a>(wFormat)&nbsp;&nbsp;&nbsp;(wFormat &amp; DT_EXPANDTABS)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d2/rtl_2drawtext_8c.html#a3">EXTERNALLEADING</a>(wFormat)&nbsp;&nbsp;&nbsp;(wFormat &amp; DT_EXTERNALLEADING)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d2/rtl_2drawtext_8c.html#a4">MODIFYSTRING</a>(wFormat)&nbsp;&nbsp;&nbsp;(wFormat &amp; DT_MODIFYSTRING)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d2/rtl_2drawtext_8c.html#a5">NOPREFIX</a>(wFormat)&nbsp;&nbsp;&nbsp;(wFormat &amp; DT_NOPREFIX)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d2/rtl_2drawtext_8c.html#a6">PATHELLIPSIS</a>(wFormat)&nbsp;&nbsp;&nbsp;(wFormat &amp; DT_PATH_ELLIPSIS)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d2/rtl_2drawtext_8c.html#a7">SINGLELINE</a>(wFormat)&nbsp;&nbsp;&nbsp;(wFormat &amp; DT_SINGLELINE)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d2/rtl_2drawtext_8c.html#a8">TABSTOP</a>(wFormat)&nbsp;&nbsp;&nbsp;(wFormat &amp; DT_TABSTOP)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d2/rtl_2drawtext_8c.html#a9">WORDBREAK</a>(wFormat)&nbsp;&nbsp;&nbsp;(wFormat &amp; DT_WORDBREAK)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d2/rtl_2drawtext_8c.html#a10">WORDELLIPSIS</a>(wFormat)&nbsp;&nbsp;&nbsp;(wFormat &amp; DT_WORD_ELLIPSIS)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d2/rtl_2drawtext_8c.html#a11">NOFULLWIDTHCHARBREAK</a>(dwFormat)&nbsp;&nbsp;&nbsp;(dwFormat &amp; DT_NOFULLWIDTHCHARBREAK)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d2/rtl_2drawtext_8c.html#a12">ENDELLIPSIS</a>(wFormat)&nbsp;&nbsp;&nbsp;(wFormat &amp; DT_END_ELLIPSIS)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d2/rtl_2drawtext_8c.html#a13">NOCLIP</a>(wFormat)&nbsp;&nbsp;&nbsp;(wFormat &amp; DT_NOCLIP)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d2/rtl_2drawtext_8c.html#a14">RTLREADING</a>(wFormat)&nbsp;&nbsp;&nbsp;(wFormat &amp; DT_RTLREADING)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d2/rtl_2drawtext_8c.html#a15">HIDEPREFIX</a>(wFormat)&nbsp;&nbsp;&nbsp;(wFormat &amp; DT_HIDEPREFIX)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d2/rtl_2drawtext_8c.html#a16">CR</a>&nbsp;&nbsp;&nbsp;13</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d2/rtl_2drawtext_8c.html#a17">LF</a>&nbsp;&nbsp;&nbsp;10</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d2/rtl_2drawtext_8c.html#a18">DT_HFMTMASK</a>&nbsp;&nbsp;&nbsp;0x03</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d2/rtl_2drawtext_8c.html#a19">DT_VFMTMASK</a>&nbsp;&nbsp;&nbsp;0x0C</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d2/rtl_2drawtext_8c.html#a20">ETO_OPAQUEFGND</a>&nbsp;&nbsp;&nbsp;0x0A</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d2/rtl_2drawtext_8c.html#a21">MAXBUFFSIZE</a>&nbsp;&nbsp;&nbsp;128</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d2/rtl_2drawtext_8c.html#a22">UserIsFELineBreak</a>(wChar)&nbsp;&nbsp;&nbsp;UserIsFELineBreakEnd(wChar)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d2/rtl_2drawtext_8c.html#a23">NUM_FULLWIDTH_UNICODES</a>&nbsp;&nbsp;&nbsp;4</td></tr>

<tr><td colspan=2><br><h2>Typedefs</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d4/d1/struct__FULLWIDTH__UNICODE.html">_FULLWIDTH_UNICODE</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d2/rtl_2drawtext_8c.html#a31">FULLWIDTH_UNICODE</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="../../d4/d1/struct__FULLWIDTH__UNICODE.html">_FULLWIDTH_UNICODE</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d2/rtl_2drawtext_8c.html#a32">PFULLWIDTH_UNICODE</a></td></tr>

<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d2/rtl_2drawtext_8c.html#a34">UserIsFELineBreakEnd</a> (WCHAR wch)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d2/rtl_2drawtext_8c.html#a35">UserIsFullWidth</a> (<a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> dwCodePage, WCHAR wChar)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d2/rtl_2drawtext_8c.html#a36">UserTextOutWInternal</a> (HDC hdc, int x, int y, LPCWSTR lp, UINT cc, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> <a class="el" href="../../d3/d8/propapi_8h.html#a34">dwFlags</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>int&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d2/rtl_2drawtext_8c.html#a37">KKGetPrefixWidth</a> (HDC hdc, LPCWSTR lpStr, int cch)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>LPCWSTR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d2/rtl_2drawtext_8c.html#a38">GetNextWordbreak</a> (<a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> dwCodePage, LPCWSTR lpch, LPCWSTR lpchEnd, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> dwFormat, <a class="el" href="../../d1/d0/inc_2user_8h.html#a1083">LPDRAWTEXTDATA</a> lpDrawInfo)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>LONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d2/rtl_2drawtext_8c.html#a39">GetPrefixCount</a> (LPCWSTR lpstr, int cch, LPWSTR lpstrCopy, int charcopycount)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>int&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d2/rtl_2drawtext_8c.html#a40">DT_GetExtentMinusPrefixes</a> (HDC hdc, LPCWSTR lpchStr, int cchCount, UINT wFormat, int iOverhang, <a class="el" href="../../d1/d0/inc_2user_8h.html#a1083">LPDRAWTEXTDATA</a> lpDrawInfo, int iCharSet)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>int&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d2/rtl_2drawtext_8c.html#a41">DT_DrawStr</a> (HDC hdc, int xLeft, int yTop, LPCWSTR lpchStr, int cchCount, BOOL fDraw, UINT wFormat, <a class="el" href="../../d1/d0/inc_2user_8h.html#a1083">LPDRAWTEXTDATA</a> lpDrawInfo, int iCharSet)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d2/rtl_2drawtext_8c.html#a42">DT_DrawJustifiedLine</a> (HDC hdc, int yTop, LPCWSTR lpchLineSt, int cchCount, UINT wFormat, <a class="el" href="../../d1/d0/inc_2user_8h.html#a1083">LPDRAWTEXTDATA</a> lpDrawInfo, int iCharSet)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d2/rtl_2drawtext_8c.html#a43">DT_InitDrawTextInfo</a> (HDC hdc, LPRECT lprc, UINT wFormat, <a class="el" href="../../d1/d0/inc_2user_8h.html#a1083">LPDRAWTEXTDATA</a> lpDrawInfo, LPDRAWTEXTPARAMS lpDTparams)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>LPCWSTR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d2/rtl_2drawtext_8c.html#a44">DT_AdjustWhiteSpaces</a> (LPCWSTR lpStNext, LPINT lpiCount, UINT wFormat)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>LPCWSTR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d2/rtl_2drawtext_8c.html#a45">DT_BreakAWord</a> (HDC hdc, LPCWSTR lpchText, int iLength, int iWidth, UINT wFormat, int iOverhang, <a class="el" href="../../d1/d0/inc_2user_8h.html#a1083">LPDRAWTEXTDATA</a> lpDrawInfo, int iCharSet)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>LPWSTR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d2/rtl_2drawtext_8c.html#a46">DT_GetLineBreak</a> (HDC hdc, LPCWSTR lpchLineStart, int cchCount, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> dwFormat, LPINT lpiLineLength, <a class="el" href="../../d1/d0/inc_2user_8h.html#a1083">LPDRAWTEXTDATA</a> lpDrawInfo, int iCharSet)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d2/rtl_2drawtext_8c.html#a47">NeedsEndEllipsis</a> (HDC hdc, LPCWSTR lpchText, LPINT lpCount, <a class="el" href="../../d1/d0/inc_2user_8h.html#a1083">LPDRAWTEXTDATA</a> lpDTdata, UINT wFormat, <a class="el" href="../../d1/d0/inc_2user_8h.html#a1083">LPDRAWTEXTDATA</a> lpDrawInfo, int iCharSet)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>LPWSTR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d2/rtl_2drawtext_8c.html#a48">PathFindFileName</a> (LPCWSTR pPath, int cchText)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>int&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d2/rtl_2drawtext_8c.html#a49">AddPathEllipsis</a> (HDC hDC, LPWSTR lpszPath, int cchText, UINT wFormat, int cxMaxWidth, int iOverhang, <a class="el" href="../../d1/d0/inc_2user_8h.html#a1083">LPDRAWTEXTDATA</a> lpDrawInfo, int iCharSet)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>int&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d2/rtl_2drawtext_8c.html#a50">AddEllipsisAndDrawLine</a> (HDC hdc, int yLine, LPCWSTR lpchText, int cchText, <a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> dwDTformat, <a class="el" href="../../d1/d0/inc_2user_8h.html#a1083">LPDRAWTEXTDATA</a> lpDrawInfo, int iCharSet)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>int&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d2/rtl_2drawtext_8c.html#a51">DrawTextExW</a> (HDC hdc, LPWSTR lpchText, int cchText, LPRECT lprc, UINT dwDTformat, LPDRAWTEXTPARAMS lpDTparams)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>int&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d2/rtl_2drawtext_8c.html#a52">DrawTextExWorker</a> (HDC hdc, LPWSTR lpchText, int cchText, LPRECT lprc, UINT dwDTformat, LPDRAWTEXTPARAMS lpDTparams, int iCharset)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d2/rtl_2drawtext_8c.html#a53">IsSysFontAndDefaultMode</a> (HDC hdc)</td></tr>

<tr><td colspan=2><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>CONST WCHAR&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d2/rtl_2drawtext_8c.html#a24">szEllipsis</a> [CCHELLIPSIS+1] = TEXT("...")</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>HDC&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d2/rtl_2drawtext_8c.html#a25">ghdcBits2</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>CONST <a class="el" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d2/rtl_2drawtext_8c.html#a26">aASCII_Latin1_EndBreak</a> []</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>CONST <a class="el" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d2/rtl_2drawtext_8c.html#a27">aGeneralPunctuation_EndBreak</a> []</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>CONST <a class="el" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d2/rtl_2drawtext_8c.html#a28">aCJKSymbol_EndBreak</a> []</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>CONST <a class="el" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d2/rtl_2drawtext_8c.html#a29">aCNS11643_SmallVariants_EndBreak</a> []</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>CONST <a class="el" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d2/rtl_2drawtext_8c.html#a30">aFullWidthHalfWidthVariants_EndBreak</a> []</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>CONST <a class="el" href="../../d4/d1/struct__FULLWIDTH__UNICODE.html">FULLWIDTH_UNICODE</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d2/rtl_2drawtext_8c.html#a33">FullWidthUnicodes</a> []</td></tr>

</table>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="a0" doxytag="rtl/drawtext.c::CALCRECT" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define CALCRECT          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">wFormat&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;(wFormat &amp; DT_CALCRECT)</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00031">31</a> of file <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html">rtl/drawtext.c</a>.
<p>
Referenced by <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l01708">DrawTextExWorker()</a>, and <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00965">DT_DrawStr()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a16" doxytag="rtl/drawtext.c::CR" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define CR&nbsp;&nbsp;&nbsp;13          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00055">55</a> of file <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html">rtl/drawtext.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a18" doxytag="rtl/drawtext.c::DT_HFMTMASK" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define DT_HFMTMASK&nbsp;&nbsp;&nbsp;0x03          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00057">57</a> of file <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html">rtl/drawtext.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a19" doxytag="rtl/drawtext.c::DT_VFMTMASK" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define DT_VFMTMASK&nbsp;&nbsp;&nbsp;0x0C          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00058">58</a> of file <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html">rtl/drawtext.c</a>.
<p>
Referenced by <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l01708">DrawTextExWorker()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="rtl/drawtext.c::EDITCONTROL" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define EDITCONTROL          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">wFormat&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;(wFormat &amp; DT_EDITCONTROL)</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00032">32</a> of file <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html">rtl/drawtext.c</a>.
<p>
Referenced by <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l01708">DrawTextExWorker()</a>, <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l01319">DT_GetLineBreak()</a>, and <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l01090">DT_InitDrawTextInfo()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a12" doxytag="rtl/drawtext.c::ENDELLIPSIS" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ENDELLIPSIS          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">wFormat&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;(wFormat &amp; DT_END_ELLIPSIS)</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00046">46</a> of file <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html">rtl/drawtext.c</a>.
<p>
Referenced by <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l01604">AddEllipsisAndDrawLine()</a>, and <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l01708">DrawTextExWorker()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a20" doxytag="rtl/drawtext.c::ETO_OPAQUEFGND" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define ETO_OPAQUEFGND&nbsp;&nbsp;&nbsp;0x0A          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00059">59</a> of file <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html">rtl/drawtext.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a2" doxytag="rtl/drawtext.c::EXPANDTABS" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define EXPANDTABS          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">wFormat&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;(wFormat &amp; DT_EXPANDTABS)</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00033">33</a> of file <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html">rtl/drawtext.c</a>.
<p>
Referenced by <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00965">DT_DrawStr()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="rtl/drawtext.c::EXTERNALLEADING" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define EXTERNALLEADING          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">wFormat&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;(wFormat &amp; DT_EXTERNALLEADING)</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00034">34</a> of file <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html">rtl/drawtext.c</a>.
<p>
Referenced by <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l01090">DT_InitDrawTextInfo()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a15" doxytag="rtl/drawtext.c::HIDEPREFIX" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define HIDEPREFIX          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">wFormat&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;(wFormat &amp; DT_HIDEPREFIX)</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00049">49</a> of file <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html">rtl/drawtext.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a17" doxytag="rtl/drawtext.c::LF" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define LF&nbsp;&nbsp;&nbsp;10          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00056">56</a> of file <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html">rtl/drawtext.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a21" doxytag="rtl/drawtext.c::MAXBUFFSIZE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define MAXBUFFSIZE&nbsp;&nbsp;&nbsp;128          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00071">71</a> of file <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html">rtl/drawtext.c</a>.
<p>
Referenced by <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l01604">AddEllipsisAndDrawLine()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a4" doxytag="rtl/drawtext.c::MODIFYSTRING" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define MODIFYSTRING          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">wFormat&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;(wFormat &amp; DT_MODIFYSTRING)</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00035">35</a> of file <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html">rtl/drawtext.c</a>.
<p>
Referenced by <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l01604">AddEllipsisAndDrawLine()</a>, and <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l01708">DrawTextExWorker()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a13" doxytag="rtl/drawtext.c::NOCLIP" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define NOCLIP          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">wFormat&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;(wFormat &amp; DT_NOCLIP)</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00047">47</a> of file <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html">rtl/drawtext.c</a>.
<p>
Referenced by <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l01708">DrawTextExWorker()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a11" doxytag="rtl/drawtext.c::NOFULLWIDTHCHARBREAK" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define NOFULLWIDTHCHARBREAK          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">dwFormat&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;(dwFormat &amp; DT_NOFULLWIDTHCHARBREAK)</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00044">44</a> of file <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html">rtl/drawtext.c</a>.
<p>
Referenced by <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00662">GetNextWordbreak()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a5" doxytag="rtl/drawtext.c::NOPREFIX" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define NOPREFIX          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">wFormat&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;(wFormat &amp; DT_NOPREFIX)</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00036">36</a> of file <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html">rtl/drawtext.c</a>.
<p>
Referenced by <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00907">DT_GetExtentMinusPrefixes()</a>, and <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l01090">DT_InitDrawTextInfo()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a23" doxytag="rtl/drawtext.c::NUM_FULLWIDTH_UNICODES" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define NUM_FULLWIDTH_UNICODES&nbsp;&nbsp;&nbsp;4          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00526">526</a> of file <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html">rtl/drawtext.c</a>.
<p>
Referenced by <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00535">UserIsFullWidth()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a6" doxytag="rtl/drawtext.c::PATHELLIPSIS" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define PATHELLIPSIS          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">wFormat&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;(wFormat &amp; DT_PATH_ELLIPSIS)</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00037">37</a> of file <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html">rtl/drawtext.c</a>.
<p>
Referenced by <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l01604">AddEllipsisAndDrawLine()</a>, and <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l01708">DrawTextExWorker()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a14" doxytag="rtl/drawtext.c::RTLREADING" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define RTLREADING          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">wFormat&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;(wFormat &amp; DT_RTLREADING)</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00048">48</a> of file <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html">rtl/drawtext.c</a>.
<p>
Referenced by <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l01708">DrawTextExWorker()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a7" doxytag="rtl/drawtext.c::SINGLELINE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define SINGLELINE          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">wFormat&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;(wFormat &amp; DT_SINGLELINE)</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00038">38</a> of file <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html">rtl/drawtext.c</a>.
<p>
Referenced by <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l01708">DrawTextExWorker()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a8" doxytag="rtl/drawtext.c::TABSTOP" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define TABSTOP          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">wFormat&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;(wFormat &amp; DT_TABSTOP)</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00039">39</a> of file <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html">rtl/drawtext.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a22" doxytag="rtl/drawtext.c::UserIsFELineBreak" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define UserIsFELineBreak          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">wChar&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;UserIsFELineBreakEnd(wChar)</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00512">512</a> of file <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html">rtl/drawtext.c</a>.
<p>
Referenced by <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00662">GetNextWordbreak()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a9" doxytag="rtl/drawtext.c::WORDBREAK" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define WORDBREAK          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">wFormat&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;(wFormat &amp; DT_WORDBREAK)</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00040">40</a> of file <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html">rtl/drawtext.c</a>.
<p>
Referenced by <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l01708">DrawTextExWorker()</a>, <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l01319">DT_GetLineBreak()</a>, and <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00662">GetNextWordbreak()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a10" doxytag="rtl/drawtext.c::WORDELLIPSIS" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define WORDELLIPSIS          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">wFormat&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;(wFormat &amp; DT_WORD_ELLIPSIS)</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00041">41</a> of file <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html">rtl/drawtext.c</a>.
<p>
Referenced by <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l01604">AddEllipsisAndDrawLine()</a>, <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l01708">DrawTextExWorker()</a>, and <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l01319">DT_GetLineBreak()</a>.    </td>
  </tr>
</table>
<hr><h2>Typedef Documentation</h2>
<a class="anchor" name="a31" doxytag="rtl/drawtext.c::FULLWIDTH_UNICODE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d4/d1/struct__FULLWIDTH__UNICODE.html">_FULLWIDTH_UNICODE</a>  <a class="el" href="../../d4/d1/struct__FULLWIDTH__UNICODE.html">FULLWIDTH_UNICODE</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a32" doxytag="rtl/drawtext.c::PFULLWIDTH_UNICODE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef struct <a class="el" href="../../d4/d1/struct__FULLWIDTH__UNICODE.html">_FULLWIDTH_UNICODE</a> * <a class="el" href="../../d4/d1/struct__FULLWIDTH__UNICODE.html">PFULLWIDTH_UNICODE</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a50" doxytag="rtl/drawtext.c::AddEllipsisAndDrawLine" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int AddEllipsisAndDrawLine           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HDC&nbsp;</td>
          <td class="mdname" nowrap> <em>hdc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>yLine</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPCWSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>lpchText</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>cchText</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>dwDTformat</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d1/d0/inc_2user_8h.html#a1083">LPDRAWTEXTDATA</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>lpDrawInfo</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>iCharSet</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l01604">1604</a> of file <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html">rtl/drawtext.c</a>.
<p>
References <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l01533">AddPathEllipsis()</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l03236">CCHELLIPSIS</a>, <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l01053">DT_DrawJustifiedLine()</a>, <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00907">DT_GetExtentMinusPrefixes()</a>, <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00046">ENDELLIPSIS</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d7/d2/kcodecnv_8c-source.html#l00021">lpDest</a>, <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00071">MAXBUFFSIZE</a>, <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00035">MODIFYSTRING</a>, <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l01424">NeedsEndEllipsis()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00037">PATHELLIPSIS</a>, <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00061">szEllipsis</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d7/d7/clinit_8c-source.html#l01614">UserRtlAllocMem()</a>, <a class="el" href="../../d7/d7/clinit_8c-source.html#l01620">UserRtlFreeMem()</a>, and <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00041">WORDELLIPSIS</a>.
<p>
Referenced by <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l01708">DrawTextExWorker()</a>.
<p>
<pre class="fragment"><div>01612 {
01613     LPWSTR pEllipsis = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01614     WCHAR  szTempBuff[<a class="code" href="../../d5/d2/rtl_2drawtext_8c.html#a21">MAXBUFFSIZE</a>];
01615     LPWSTR <a class="code" href="../../d6/d3/kcodecnv_8c.html#a4">lpDest</a>;
01616     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>   fAlreadyCopied = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01617 
01618     <span class="comment">// Check if this is a filename with a path AND</span>
01619     <span class="comment">// Check if the width is too narrow to hold all the text.</span>
01620     <span class="keywordflow">if</span>(<a class="code" href="../../d5/d2/rtl_2drawtext_8c.html#a6">PATHELLIPSIS</a>(dwDTformat) &amp;&amp;
01621         ((<a class="code" href="../../d5/d2/rtl_2drawtext_8c.html#a40">DT_GetExtentMinusPrefixes</a>(hdc, lpchText, cchText,
01622                    dwDTformat, lpDrawInfo-&gt;cxOverhang, lpDrawInfo, iCharSet)) &gt; lpDrawInfo-&gt;cxMaxWidth)) {
01623         <span class="comment">// We need to add Path-Ellipsis. See if we can do it in-place.</span>
01624         <span class="keywordflow">if</span>(!<a class="code" href="../../d5/d2/rtl_2drawtext_8c.html#a4">MODIFYSTRING</a>(dwDTformat)) {
01625             <span class="comment">// NOTE: When you add Path-Ellipsis, the string could grow by</span>
01626             <span class="comment">// CCHELLIPSIS bytes.</span>
01627             <span class="keywordflow">if</span>((cchText + <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a901">CCHELLIPSIS</a> + 1) &lt;= <a class="code" href="../../d5/d2/rtl_2drawtext_8c.html#a21">MAXBUFFSIZE</a>)
01628                 <a class="code" href="../../d6/d3/kcodecnv_8c.html#a4">lpDest</a> = szTempBuff;
01629             <span class="keywordflow">else</span> {   <span class="comment">// Alloc from local heap.</span>
01630                 <span class="comment">// Alloc the buffer from local heap.</span>
01631                 <span class="keywordflow">if</span>(!(pEllipsis = (LPWSTR)<a class="code" href="../../d6/d1/userrtl_8h.html#a31">UserRtlAllocMem</a>(
01632                         (cchText+CCHELLIPSIS+1)*<span class="keyword">sizeof</span>(WCHAR))))
01633                     <span class="keywordflow">return</span> 0;
01634                 <a class="code" href="../../d6/d3/kcodecnv_8c.html#a4">lpDest</a> = (LPWSTR)pEllipsis;
01635             }
01636             <span class="comment">// Source String may not be NULL terminated. So, copy just</span>
01637             <span class="comment">// the given number of characters.</span>
01638             RtlCopyMemory(lpDest, lpchText, cchText*<span class="keyword">sizeof</span>(WCHAR));
01639             lpchText = <a class="code" href="../../d6/d3/kcodecnv_8c.html#a4">lpDest</a>;        <span class="comment">// lpchText points to the copied buff.</span>
01640             fAlreadyCopied = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;    <span class="comment">// Local copy has been made.</span>
01641         }
01642         <span class="comment">// Add the path ellipsis now!</span>
01643         cchText = <a class="code" href="../../d5/d2/rtl_2drawtext_8c.html#a49">AddPathEllipsis</a>(hdc, (LPWSTR)lpchText, cchText, dwDTformat,
01644             lpDrawInfo-&gt;cxMaxWidth, lpDrawInfo-&gt;cxOverhang, lpDrawInfo, iCharSet);
01645     }
01646 
01647     <span class="comment">// Check if end-ellipsis are to be added.</span>
01648     <span class="keywordflow">if</span>((<a class="code" href="../../d5/d2/rtl_2drawtext_8c.html#a12">ENDELLIPSIS</a>(dwDTformat) || <a class="code" href="../../d5/d2/rtl_2drawtext_8c.html#a10">WORDELLIPSIS</a>(dwDTformat)) &amp;&amp;
01649         <a class="code" href="../../d5/d2/rtl_2drawtext_8c.html#a47">NeedsEndEllipsis</a>(hdc, lpchText, &amp;cchText, lpDrawInfo, dwDTformat, lpDrawInfo, iCharSet)) {
01650         <span class="comment">// We need to add end-ellipsis; See if we can do it in-place.</span>
01651         <span class="keywordflow">if</span>(!<a class="code" href="../../d5/d2/rtl_2drawtext_8c.html#a4">MODIFYSTRING</a>(dwDTformat) &amp;&amp; !fAlreadyCopied) {
01652             <span class="comment">// See if the string is small enough for the buff on stack.</span>
01653             <span class="keywordflow">if</span>((cchText+<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a901">CCHELLIPSIS</a>+1) &lt;= <a class="code" href="../../d5/d2/rtl_2drawtext_8c.html#a21">MAXBUFFSIZE</a>)
01654                 <a class="code" href="../../d6/d3/kcodecnv_8c.html#a4">lpDest</a> = szTempBuff;  <span class="comment">// If so, use it.</span>
01655             <span class="keywordflow">else</span> {
01656                 <span class="comment">// Alloc the buffer from local heap.</span>
01657                 <span class="keywordflow">if</span>(!(pEllipsis = (LPWSTR)<a class="code" href="../../d6/d1/userrtl_8h.html#a31">UserRtlAllocMem</a>(
01658                         (cchText+CCHELLIPSIS+1)*<span class="keyword">sizeof</span>(WCHAR))))
01659                     <span class="keywordflow">return</span> 0;
01660                 <a class="code" href="../../d6/d3/kcodecnv_8c.html#a4">lpDest</a> = pEllipsis;
01661             }
01662             <span class="comment">// Make a copy of the string in the local buff.</span>
01663             RtlCopyMemory(lpDest, lpchText, cchText*<span class="keyword">sizeof</span>(WCHAR));
01664             lpchText = <a class="code" href="../../d6/d3/kcodecnv_8c.html#a4">lpDest</a>;
01665         }
01666         <span class="comment">// Add an end-ellipsis at the proper place.</span>
01667         RtlCopyMemory((LPWSTR)(lpchText+cchText), szEllipsis, (CCHELLIPSIS+1)*<span class="keyword">sizeof</span>(WCHAR));
01668         cchText += <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a901">CCHELLIPSIS</a>;
01669     }
01670 
01671     <span class="comment">// Draw the line that we just formed.</span>
01672     <a class="code" href="../../d5/d2/rtl_2drawtext_8c.html#a42">DT_DrawJustifiedLine</a>(hdc, yLine, lpchText, cchText, dwDTformat, lpDrawInfo, iCharSet);
01673 
01674     <span class="comment">// Free the block allocated for End-Ellipsis.</span>
01675     <span class="keywordflow">if</span>(pEllipsis)
01676         <a class="code" href="../../d6/d1/userrtl_8h.html#a32">UserRtlFreeMem</a>(pEllipsis);
01677 
01678     <span class="keywordflow">return</span> cchText;
01679 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a49" doxytag="rtl/drawtext.c::AddPathEllipsis" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int AddPathEllipsis           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HDC&nbsp;</td>
          <td class="mdname" nowrap> <em>hDC</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPWSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>lpszPath</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>cchText</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>wFormat</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>cxMaxWidth</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>iOverhang</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d1/d0/inc_2user_8h.html#a1083">LPDRAWTEXTDATA</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>lpDrawInfo</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>iCharSet</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l01533">1533</a> of file <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html">rtl/drawtext.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l03236">CCHELLIPSIS</a>, <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00907">DT_GetExtentMinusPrefixes()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l01515">PathFindFileName()</a>, <a class="el" href="../../d0/d7/halvprnt_8c-source.html#l00031">PBYTE</a>, <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00061">szEllipsis</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d0/d5/ndismain_8h-source.html#l00026">UINT</a>, and <a class="el" href="../../d7/d0/userrtl_8h-source.html#l00146">UserGetTextExtentPointW</a>.
<p>
Referenced by <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l01604">AddEllipsisAndDrawLine()</a>.
<p>
<pre class="fragment"><div>01540 {
01541   <span class="keywordtype">int</span>    iLen;
01542   <a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a>   dxFixed, dxEllipsis;
01543   LPWSTR lpEnd;          <span class="comment">/* end of the unfixed string */</span>
01544   LPWSTR lpFixed;        <span class="comment">/* start of text that we always display */</span>
01545   <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>   bEllipsisIn;
01546   <span class="keywordtype">int</span>    iLenFixed;
01547   SIZE   size;
01548 
01549   lpFixed = <a class="code" href="../../d5/d2/rtl_2drawtext_8c.html#a48">PathFindFileName</a>(lpszPath, cchText);
01550   <span class="keywordflow">if</span> (lpFixed != lpszPath)
01551       lpFixed--;  <span class="comment">// point at the slash</span>
01552   <span class="keywordflow">else</span>
01553       <span class="keywordflow">return</span> cchText;
01554 
01555   lpEnd = lpFixed;
01556   bEllipsisIn = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01557   iLenFixed = cchText - (<span class="keywordtype">int</span>)(lpFixed - lpszPath);
01558   dxFixed = <a class="code" href="../../d5/d2/rtl_2drawtext_8c.html#a40">DT_GetExtentMinusPrefixes</a>(hDC, lpFixed, iLenFixed, wFormat, iOverhang, lpDrawInfo, iCharSet);
01559 
01560   <span class="comment">// It is assumed that the "..." string does not have any prefixes ('&amp;').</span>
01561   <a class="code" href="../../d6/d1/userrtl_8h.html#a11">UserGetTextExtentPointW</a>(hDC, szEllipsis, CCHELLIPSIS, &amp;size);
01562   dxEllipsis = size.cx - iOverhang;
01563 
01564   <span class="keywordflow">while</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>) {
01565       iLen = dxFixed + <a class="code" href="../../d5/d2/rtl_2drawtext_8c.html#a40">DT_GetExtentMinusPrefixes</a>(hDC, lpszPath, (<span class="keywordtype">int</span>)((PBYTE)lpEnd - (PBYTE)lpszPath)/<span class="keyword">sizeof</span>(WCHAR),
01566                                        wFormat, iOverhang, lpDrawInfo, iCharSet) - iOverhang;
01567 
01568       <span class="keywordflow">if</span> (bEllipsisIn)
01569           iLen += dxEllipsis;
01570 
01571       <span class="keywordflow">if</span> (iLen &lt;= cxMaxWidth)
01572           <span class="keywordflow">break</span>;
01573 
01574       bEllipsisIn = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01575 
01576       <span class="keywordflow">if</span> (lpEnd &lt;= lpszPath) {
01577           <span class="comment">/* Things didn't fit. */</span>
01578           lpEnd = lpszPath;
01579           <span class="keywordflow">break</span>;
01580       }
01581 
01582       <span class="comment">/* Step back a character. */</span>
01583       lpEnd--;
01584   }
01585 
01586   <span class="keywordflow">if</span> (bEllipsisIn &amp;&amp; (lpEnd + <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a901">CCHELLIPSIS</a> &lt; lpFixed)) {
01587       <span class="comment">// NOTE: the strings could over lap here. So, we use LCopyStruct.</span>
01588 
01589       RtlMoveMemory((lpEnd + CCHELLIPSIS), lpFixed, iLenFixed * <span class="keyword">sizeof</span>(WCHAR));
01590       RtlCopyMemory(lpEnd, szEllipsis, CCHELLIPSIS * <span class="keyword">sizeof</span>(WCHAR));
01591 
01592       cchText = (<span class="keywordtype">int</span>)(lpEnd - lpszPath) + <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a901">CCHELLIPSIS</a> + iLenFixed;
01593 
01594       <span class="comment">// now we can NULL terminate the string</span>
01595       *(lpszPath + cchText) = TEXT(<span class="charliteral">'\0'</span>);
01596   }
01597 
01598   <span class="keywordflow">return</span> cchText;
01599 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a51" doxytag="rtl/drawtext.c::DrawTextExW" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int DrawTextExW           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HDC&nbsp;</td>
          <td class="mdname" nowrap> <em>hdc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPWSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>lpchText</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>cchText</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPRECT&nbsp;</td>
          <td class="mdname" nowrap> <em>lprc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>dwDTformat</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPDRAWTEXTPARAMS&nbsp;</td>
          <td class="mdname" nowrap> <em>lpDTparams</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l01692">1692</a> of file <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html">rtl/drawtext.c</a>.
<p>
References <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l01708">DrawTextExWorker()</a>.
<p>
Referenced by <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00534">BNMultiDraw()</a>, <a class="el" href="../../d9/d0/btnctl_8c-source.html#l00491">BNMultiExtent()</a>, <a class="el" href="../../d4/d1/client_2drawtext_8c-source.html#l00131">DrawTextW()</a>, <a class="el" href="../../d7/d3/msgbox_8c-source.html#l00730">SoftModalMessageBox()</a>, and <a class="el" href="../../d6/d4/statctl_8c-source.html#l00344">StaticCallback()</a>.
<p>
<pre class="fragment"><div>01699 {
01700    <span class="comment">/*</span>
01701 <span class="comment">    * The LPK requires a charset.  The Unicode entry point always passes a -1,</span>
01702 <span class="comment">    * but the ANSI entry point passes a more interesting value.  Both the</span>
01703 <span class="comment">    * 'W' version and 'A' version of DrawTextEx call this common worker routine.</span>
01704 <span class="comment">    */</span>
01705    <span class="keywordflow">return</span> <a class="code" href="../../d5/d2/rtl_2drawtext_8c.html#a52">DrawTextExWorker</a>(hdc, lpchText, cchText, lprc, dwDTformat, lpDTparams, -1);
01706 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a52" doxytag="rtl/drawtext.c::DrawTextExWorker" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int DrawTextExWorker           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HDC&nbsp;</td>
          <td class="mdname" nowrap> <em>hdc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPWSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>lpchText</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>cchText</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPRECT&nbsp;</td>
          <td class="mdname" nowrap> <em>lprc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>dwDTformat</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPDRAWTEXTPARAMS&nbsp;</td>
          <td class="mdname" nowrap> <em>lpDTparams</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>iCharset</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l01708">1708</a> of file <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html">rtl/drawtext.c</a>.
<p>
References <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l01604">AddEllipsisAndDrawLine()</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00031">CALCRECT</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l03529">CALL_LPK</a>, <a class="el" href="../../d4/d1/client_2drawtext_8c-source.html#l00015">CR</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l03200">DT_CHARSETDONE</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l03199">DT_CHARSETINIT</a>, <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l01053">DT_DrawJustifiedLine()</a>, <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l01319">DT_GetLineBreak()</a>, <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l01090">DT_InitDrawTextInfo()</a>, <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00058">DT_VFMTMASK</a>, <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00032">EDITCONTROL</a>, <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00046">ENDELLIPSIS</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d7/d9/usercli_8h-source.html#l01123">GETAPPVER</a>, <a class="el" href="../../d4/d1/client_2drawtext_8c-source.html#l00016">LF</a>, <a class="el" href="../../d0/d0/client_2nt6_2user_8h.html#a1109">LPDRAWTEXTDATA</a>, <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00035">MODIFYSTRING</a>, <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00047">NOCLIP</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00037">PATHELLIPSIS</a>, <a class="el" href="../../d0/d7/halvprnt_8c-source.html#l00031">PBYTE</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l00059">PtiCurrentShared</a>, <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00048">RTLREADING</a>, <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00038">SINGLELINE</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d0/d5/ndismain_8h-source.html#l00026">UINT</a>, <a class="el" href="../../d7/d0/userrtl_8h-source.html#l00137">UserCreateRectRgn</a>, <a class="el" href="../../d7/d0/userrtl_8h-source.html#l00138">UserDeleteObject</a>, <a class="el" href="../../d7/d0/userrtl_8h-source.html#l00139">UserExtSelectClipRgn</a>, <a class="el" href="../../d7/d0/userrtl_8h-source.html#l00142">UserGetClipRgn</a>, <a class="el" href="../../d7/d0/userrtl_8h-source.html#l00160">UserGetTextAlign</a>, <a class="el" href="../../d7/d0/userrtl_8h-source.html#l00150">UserIntersectClipRect</a>, <a class="el" href="../../d7/d0/userrtl_8h-source.html#l00161">UserSetTextAlign</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00475">VER40</a>, <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00040">WORDBREAK</a>, and <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00041">WORDELLIPSIS</a>.
<p>
Referenced by <a class="el" href="../../d4/d1/client_2drawtext_8c-source.html#l00047">DrawTextExA()</a>, and <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l01692">DrawTextExW()</a>.
<p>
<pre class="fragment"><div>01716 {
01717     <a class="code" href="../../d2/d8/structDRAWTEXTDATA.html">DRAWTEXTDATA</a> DrawInfo;
01718     WORD         wFormat = LOWORD(dwDTformat);
01719     LPWSTR       lpchTextBegin;
01720     LPWSTR       lpchEnd;
01721     LPWSTR       lpchNextLineSt;
01722     <span class="keywordtype">int</span>          iLineLength;
01723     <span class="keywordtype">int</span>          iySign;
01724     <span class="keywordtype">int</span>          yLine;
01725     <span class="keywordtype">int</span>          yLastLineHeight;
01726     HRGN         hrgnClip;
01727     <span class="keywordtype">int</span>          iLineCount;
01728     RECT         rc;
01729     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>         fLastLine;
01730     WCHAR        ch;
01731     <a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a>         oldAlign;
01732 
01733 <span class="preprocessor">#if DBG</span>
01734 <span class="preprocessor"></span>    <span class="keywordflow">if</span> (dwDTformat &amp; ~DT_VALID)
01735         RIPMSG0 (RIP_WARNING, <span class="stringliteral">"DrawTextExW: Invalid dwDTformat flags"</span>);
01736 <span class="preprocessor">#endif</span>
01737 <span class="preprocessor"></span>
01738     <span class="keywordflow">if</span> (lpchText == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01739         <span class="keywordflow">return</span> 1;
01740     }
01741 
01742     <span class="keywordflow">if</span> (cchText == 0 &amp;&amp; *lpchText) {
01743         <span class="comment">/*</span>
01744 <span class="comment">         * infoview.exe passes lpchText that points to '\0'</span>
01745 <span class="comment">         *</span>
01746 <span class="comment">         * "Microsoft Expedia Streets and Trips 2000" and "MS MapPoint 2000"</span>
01747 <span class="comment">         * tries cchText == 0 to detect if DrawTextW is supported.</span>
01748 <span class="comment">         */</span>
01749 
01750         <span class="comment">/* Added by Chicago:</span>
01751 <span class="comment">         * Lotus Notes doesn't like getting a zero return here</span>
01752 <span class="comment">         */</span>
01753         <span class="keywordflow">return</span> 1;
01754     }
01755 
01756     <span class="keywordflow">if</span> (cchText == -1)
01757         cchText = wcslen(lpchText);
01758 
01759 
01760 
01761     <span class="keywordflow">if</span> ((lpDTparams) &amp;&amp; (lpDTparams-&gt;cbSize != <span class="keyword">sizeof</span>(DRAWTEXTPARAMS))) {
01762         RIPERR1(ERROR_INVALID_PARAMETER, RIP_WARNING, <span class="stringliteral">"DrawTextEx: cbSize %ld is invalid"</span>,
01763                 lpDTparams-&gt;cbSize);
01764         <span class="keywordflow">return</span> 0;
01765     }
01766 
01767 
01768 <span class="preprocessor">#ifdef LATER</span>
01769 <span class="preprocessor"></span>    <span class="comment">/*</span>
01770 <span class="comment">     * If DT_MODIFYSTRING is specified, then check for read-write pointer.</span>
01771 <span class="comment">     */</span>
01772     <span class="keywordflow">if</span> (<a class="code" href="../../d5/d2/rtl_2drawtext_8c.html#a4">MODIFYSTRING</a>(dwDTformat) &amp;&amp;
01773             (<a class="code" href="../../d5/d2/rtl_2drawtext_8c.html#a12">ENDELLIPSIS</a>(dwDTformat) || <a class="code" href="../../d5/d2/rtl_2drawtext_8c.html#a6">PATHELLIPSIS</a>(dwDTformat))) {
01774         <span class="keywordflow">if</span>(IsBadWritePtr(lpchText, cchText)) {
01775             RIPERR0(ERROR_INVALID_PARAMETER, RIP_WARNING, <span class="stringliteral">"DrawTextEx: For DT_MODIFYSTRING, lpchText must be read-write"</span>);
01776             <span class="keywordflow">return</span>(0);
01777         }
01778     }
01779 <span class="preprocessor">#endif</span>
01780 <span class="preprocessor"></span>
01781     <span class="comment">/*</span>
01782 <span class="comment">     * Initialize the DrawInfo structure.</span>
01783 <span class="comment">     */</span>
01784     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d2/rtl_2drawtext_8c.html#a43">DT_InitDrawTextInfo</a>(hdc, lprc, dwDTformat, (LPDRAWTEXTDATA)&amp;DrawInfo, lpDTparams))
01785         <span class="keywordflow">return</span> 0;
01786 
01787     DrawInfo.<a class="code" href="../../d2/d8/structDRAWTEXTDATA.html#o11">iCharset</a> = iCharset;
01788     <span class="comment">/*</span>
01789 <span class="comment">     * If the rect is too narrow or the margins are too wide.....Just forget it!</span>
01790 <span class="comment">     *</span>
01791 <span class="comment">     * If wordbreak is specified, the MaxWidth must be a reasonable value.</span>
01792 <span class="comment">     * This check is sufficient because this will allow CALCRECT and NOCLIP</span>
01793 <span class="comment">     * cases.  --SANKAR.</span>
01794 <span class="comment">     *</span>
01795 <span class="comment">     * This also fixed all of our known problems with AppStudio.</span>
01796 <span class="comment">     */</span>
01797     <span class="keywordflow">if</span> (DrawInfo.<a class="code" href="../../d2/d8/structDRAWTEXTDATA.html#o5">cxMaxWidth</a> &lt;= 0) {
01798 
01799         <span class="comment">/*</span>
01800 <span class="comment">         * We used to return a non-zero value in win31.</span>
01801 <span class="comment">         * If the kernel calls this we are always Ver 4.0 or above</span>
01802 <span class="comment">         */</span>
01803 <span class="preprocessor">#ifdef _USERK_</span>
01804 <span class="preprocessor"></span>        <span class="keywordflow">if</span> (0) {
01805 <span class="preprocessor">#else</span>
01806 <span class="preprocessor"></span>        <span class="keywordflow">if</span> (<a class="code" href="../../d6/d0/usercli_8h.html#a150">GETAPPVER</a>() &lt; <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a101">VER40</a>) {
01807 <span class="preprocessor">#endif</span>
01808 <span class="preprocessor"></span>            <span class="keywordflow">if</span>((DrawInfo.<a class="code" href="../../d2/d8/structDRAWTEXTDATA.html#o5">cxMaxWidth</a> == 0) &amp;&amp; !<a class="code" href="../../d5/d2/rtl_2drawtext_8c.html#a0">CALCRECT</a>(wFormat)) {
01809                 <span class="keywordflow">return</span>(1);
01810             }
01811         } <span class="keywordflow">else</span> {
01812             <span class="keywordflow">if</span> (<a class="code" href="../../d5/d2/rtl_2drawtext_8c.html#a9">WORDBREAK</a>(wFormat)) {
01813                 RIPMSG0 (RIP_WARNING, <span class="stringliteral">"DrawTextExW: FAILURE DrawInfo.cxMaxWidth &lt;=0"</span>);
01814                 <span class="keywordflow">return</span> (1);
01815             }
01816         }
01817     }
01818 
01819     <span class="comment">/*</span>
01820 <span class="comment">     * if we're not doing the drawing, initialise the lpk-dll</span>
01821 <span class="comment">     */</span>
01822     <span class="keywordflow">if</span> (<a class="code" href="../../d5/d2/rtl_2drawtext_8c.html#a14">RTLREADING</a>(dwDTformat)) {
01823         oldAlign = <a class="code" href="../../d6/d1/userrtl_8h.html#a26">UserSetTextAlign</a>(hdc, TA_RTLREADING | <a class="code" href="../../d6/d1/userrtl_8h.html#a25">UserGetTextAlign</a>(hdc));
01824     }
01825 
01826     <span class="keywordflow">if</span> (DrawInfo.<a class="code" href="../../d2/d8/structDRAWTEXTDATA.html#o10">bCharsetDll</a>) {
01827 <span class="preprocessor">#ifdef _USERK_</span>
01828 <span class="preprocessor"></span>        <a class="code" href="../../d2/d8/structtagTHREADINFO.html">PTHREADINFO</a> ptiCurrent = <a class="code" href="../../d4/d1/userk_8h.html#a10">PtiCurrentShared</a>();
01829 
01830         <span class="keywordflow">if</span>(<a class="code" href="../../d4/d1/userk_8h.html#a393">CALL_LPK</a>(ptiCurrent))
01831 <span class="preprocessor">#endif // _USERK_</span>
01832 <span class="preprocessor"></span>            (*UserLpkDrawTextEx)(hdc, 0, 0, lpchText, cchText, <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>, dwDTformat,
01833                                  (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a1109">LPDRAWTEXTDATA</a>)&amp;DrawInfo, <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a898">DT_CHARSETINIT</a>, iCharset);
01834     }
01835 
01836     <span class="comment">/*</span>
01837 <span class="comment">     * If we need to clip, let us do that.</span>
01838 <span class="comment">     */</span>
01839     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d2/rtl_2drawtext_8c.html#a13">NOCLIP</a>(wFormat)) {
01840         <span class="comment">//</span>
01841         <span class="comment">// Save clipping region so we can restore it later.</span>
01842         <span class="comment">//</span>
01843         <span class="comment">// hrgnSave = SaveClipRgn(hdc);</span>
01844         <span class="comment">// IntersectClipRect(hdc, lprc-&gt;left, lprc-&gt;top, lprc-&gt;right, lprc-&gt;bottom);</span>
01845 
01846         hrgnClip = <a class="code" href="../../d6/d1/userrtl_8h.html#a2">UserCreateRectRgn</a>(0,0,0,0);
01847         <span class="keywordflow">if</span> (hrgnClip != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01848             <span class="keywordflow">if</span> (<a class="code" href="../../d6/d1/userrtl_8h.html#a7">UserGetClipRgn</a>(hdc, hrgnClip) != 1) {
01849                 <a class="code" href="../../d6/d1/userrtl_8h.html#a3">UserDeleteObject</a>(hrgnClip);
01850                 hrgnClip = (HRGN)-1;
01851             }
01852             rc = *lprc;
01853             <a class="code" href="../../d6/d1/userrtl_8h.html#a15">UserIntersectClipRect</a>(hdc, rc.left, rc.top, rc.right, rc.bottom);
01854         }
01855     } <span class="keywordflow">else</span> {
01856         hrgnClip = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01857     }
01858 
01859     lpchTextBegin = lpchText;
01860     lpchEnd = lpchText + cchText;
01861 
01862 ProcessDrawText:
01863 
01864     iLineCount = 0;  <span class="comment">// Reset number of lines to 1.</span>
01865     yLine = lprc-&gt;top;
01866 
01867     <span class="keywordflow">if</span> (<a class="code" href="../../d5/d2/rtl_2drawtext_8c.html#a7">SINGLELINE</a>(wFormat)) {
01868         iLineCount = 1;  <span class="comment">// It is a single line.</span>
01869 
01870 
01871         <span class="comment">/*</span>
01872 <span class="comment">         * Process single line DrawText.</span>
01873 <span class="comment">         */</span>
01874         <span class="keywordflow">switch</span> (wFormat &amp; <a class="code" href="../../d5/d2/rtl_2drawtext_8c.html#a19">DT_VFMTMASK</a>) {
01875             <span class="keywordflow">case</span> DT_BOTTOM:
01876                 yLine = lprc-&gt;bottom - DrawInfo.<a class="code" href="../../d2/d8/structDRAWTEXTDATA.html#o4">cyLineHeight</a>;
01877                 <span class="keywordflow">break</span>;
01878 
01879             <span class="keywordflow">case</span> DT_VCENTER:
01880                 yLine = lprc-&gt;top + ((lprc-&gt;bottom - lprc-&gt;top - DrawInfo.<a class="code" href="../../d2/d8/structDRAWTEXTDATA.html#o4">cyLineHeight</a>) / 2);
01881                 <span class="keywordflow">break</span>;
01882         }
01883 
01884         cchText = <a class="code" href="../../d5/d2/rtl_2drawtext_8c.html#a50">AddEllipsisAndDrawLine</a>(hdc, yLine, lpchText, cchText, dwDTformat, &amp;DrawInfo, iCharset);
01885         yLine += DrawInfo.<a class="code" href="../../d2/d8/structDRAWTEXTDATA.html#o4">cyLineHeight</a>;
01886         lpchText += cchText;
01887     } <span class="keywordflow">else</span>  {
01888 
01889         <span class="comment">/*</span>
01890 <span class="comment">         * Multiline</span>
01891 <span class="comment">         * If the height of the rectangle is not an integral multiple of the</span>
01892 <span class="comment">         * average char height, then it is possible that the last line drawn</span>
01893 <span class="comment">         * is only partially visible. However, if DT_EDITCONTROL style is</span>
01894 <span class="comment">         * specified, then we must make sure that the last line is not drawn if</span>
01895 <span class="comment">         * it is going to be partially visible. This will help imitate the</span>
01896 <span class="comment">         * appearance of an edit control.</span>
01897 <span class="comment">         */</span>
01898         <span class="keywordflow">if</span> (<a class="code" href="../../d5/d2/rtl_2drawtext_8c.html#a1">EDITCONTROL</a>(wFormat))
01899             yLastLineHeight = DrawInfo.<a class="code" href="../../d2/d8/structDRAWTEXTDATA.html#o4">cyLineHeight</a>;
01900         <span class="keywordflow">else</span>
01901             yLastLineHeight = 0;
01902 
01903         iySign = DrawInfo.<a class="code" href="../../d2/d8/structDRAWTEXTDATA.html#o3">iYSign</a>;
01904         fLastLine = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01905         <span class="comment">// Process multiline DrawText.</span>
01906         <span class="keywordflow">while</span> ((lpchText &lt; lpchEnd) &amp;&amp; (!fLastLine)) {
01907           <span class="comment">// Check if the line we are about to draw is the last line that needs</span>
01908           <span class="comment">// to be drawn.</span>
01909           <span class="comment">// Let us check if the display goes out of the clip rect and if so</span>
01910           <span class="comment">// let us stop here, as an optimisation;</span>
01911           <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d2/rtl_2drawtext_8c.html#a0">CALCRECT</a>(wFormat) &amp;&amp;         <span class="comment">// We don't need to calc rect?</span>
01912                   (!<a class="code" href="../../d5/d2/rtl_2drawtext_8c.html#a13">NOCLIP</a>(wFormat)) &amp;&amp;     <span class="comment">// Must we clip the display ?</span>
01913                                             <span class="comment">// Are we outside the rect?</span>
01914                   ((yLine + DrawInfo.<a class="code" href="../../d2/d8/structDRAWTEXTDATA.html#o4">cyLineHeight</a> + yLastLineHeight)*iySign &gt; (lprc-&gt;bottom*iySign))) {
01915               fLastLine = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;    <span class="comment">// Let us quit this loop</span>
01916           }
01917 
01918 
01919           <span class="comment">/*</span>
01920 <span class="comment">           * We do the Ellipsis processing only for the last line.</span>
01921 <span class="comment">           */</span>
01922           <span class="keywordflow">if</span> (fLastLine &amp;&amp; (<a class="code" href="../../d5/d2/rtl_2drawtext_8c.html#a12">ENDELLIPSIS</a>(dwDTformat) || <a class="code" href="../../d5/d2/rtl_2drawtext_8c.html#a6">PATHELLIPSIS</a>(dwDTformat))) {
01923               lpchText += <a class="code" href="../../d5/d2/rtl_2drawtext_8c.html#a50">AddEllipsisAndDrawLine</a>(hdc, yLine, lpchText, cchText, dwDTformat, &amp;DrawInfo, iCharset);
01924           } <span class="keywordflow">else</span> {
01925               lpchNextLineSt = (LPWSTR)<a class="code" href="../../d5/d2/rtl_2drawtext_8c.html#a46">DT_GetLineBreak</a>(hdc, lpchText, cchText, dwDTformat, &amp;iLineLength, &amp;DrawInfo, iCharset);
01926 
01927               <span class="comment">/*</span>
01928 <span class="comment">               * Check if we need to put ellipsis at the end of this line.</span>
01929 <span class="comment">               * Also check if this is the last line.</span>
01930 <span class="comment">               */</span>
01931               <span class="keywordflow">if</span> (<a class="code" href="../../d5/d2/rtl_2drawtext_8c.html#a10">WORDELLIPSIS</a>(dwDTformat) ||
01932                        ((lpchNextLineSt &gt;= lpchEnd) &amp;&amp; (<a class="code" href="../../d5/d2/rtl_2drawtext_8c.html#a12">ENDELLIPSIS</a>(dwDTformat) || <a class="code" href="../../d5/d2/rtl_2drawtext_8c.html#a6">PATHELLIPSIS</a>(dwDTformat))))
01933                   <a class="code" href="../../d5/d2/rtl_2drawtext_8c.html#a50">AddEllipsisAndDrawLine</a>(hdc, yLine, lpchText, iLineLength, dwDTformat, &amp;DrawInfo, iCharset);
01934               <span class="keywordflow">else</span>
01935                   <a class="code" href="../../d5/d2/rtl_2drawtext_8c.html#a42">DT_DrawJustifiedLine</a>(hdc, yLine, lpchText, iLineLength, dwDTformat, &amp;DrawInfo, iCharset);
01936               cchText -= (<span class="keywordtype">int</span>)((<a class="code" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a>)lpchNextLineSt - (<a class="code" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a>)lpchText) / <span class="keyword">sizeof</span>(WCHAR);
01937               lpchText = lpchNextLineSt;
01938           }
01939             iLineCount++; <span class="comment">// We draw one more line.</span>
01940             yLine += DrawInfo.<a class="code" href="../../d2/d8/structDRAWTEXTDATA.html#o4">cyLineHeight</a>;
01941         }
01942 
01943 
01944         <span class="comment">/*</span>
01945 <span class="comment">         * For Win3.1 and NT compatibility, if the last char is a CR or a LF</span>
01946 <span class="comment">         * then the height returned includes one more line.</span>
01947 <span class="comment">         */</span>
01948         <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d2/rtl_2drawtext_8c.html#a1">EDITCONTROL</a>(dwDTformat) &amp;&amp;
01949                 (lpchEnd &gt; lpchTextBegin)    &amp;&amp;   <span class="comment">// If zero length it will fault.</span>
01950                 (((ch = (*(lpchEnd-1))) == <a class="code" href="../../d3/d2/client_2drawtext_8c.html#a0">CR</a>) || (ch == <a class="code" href="../../d3/d2/client_2drawtext_8c.html#a1">LF</a>)))
01951             yLine += DrawInfo.<a class="code" href="../../d2/d8/structDRAWTEXTDATA.html#o4">cyLineHeight</a>;
01952     }
01953 
01954 
01955     <span class="comment">/*</span>
01956 <span class="comment">     * If DT_CALCRECT, modify width and height of rectangle to include</span>
01957 <span class="comment">     * all of the text drawn.</span>
01958 <span class="comment">     */</span>
01959     <span class="keywordflow">if</span> (<a class="code" href="../../d5/d2/rtl_2drawtext_8c.html#a0">CALCRECT</a>(wFormat)) {
01960         DrawInfo.<a class="code" href="../../d2/d8/structDRAWTEXTDATA.html#o0">rcFormat</a>.right = DrawInfo.<a class="code" href="../../d2/d8/structDRAWTEXTDATA.html#o0">rcFormat</a>.left + DrawInfo.<a class="code" href="../../d2/d8/structDRAWTEXTDATA.html#o6">cxMaxExtent</a> * DrawInfo.<a class="code" href="../../d2/d8/structDRAWTEXTDATA.html#o2">iXSign</a>;
01961         lprc-&gt;right = DrawInfo.<a class="code" href="../../d2/d8/structDRAWTEXTDATA.html#o0">rcFormat</a>.right + DrawInfo.<a class="code" href="../../d2/d8/structDRAWTEXTDATA.html#o7">cxRightMargin</a>;
01962 
01963         <span class="comment">// If the Width is more than what was provided, we have to redo all</span>
01964         <span class="comment">// the calculations, because, the number of lines can be less now.</span>
01965         <span class="comment">// (We need to do this only if we have more than one line).</span>
01966         <span class="keywordflow">if</span>((iLineCount &gt; 1) &amp;&amp; (DrawInfo.<a class="code" href="../../d2/d8/structDRAWTEXTDATA.html#o6">cxMaxExtent</a> &gt; DrawInfo.<a class="code" href="../../d2/d8/structDRAWTEXTDATA.html#o5">cxMaxWidth</a>)) {
01967             DrawInfo.<a class="code" href="../../d2/d8/structDRAWTEXTDATA.html#o5">cxMaxWidth</a> = DrawInfo.<a class="code" href="../../d2/d8/structDRAWTEXTDATA.html#o6">cxMaxExtent</a>;
01968             lpchText = lpchTextBegin;
01969             cchText = (<span class="keywordtype">int</span>)((<a class="code" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a>)lpchEnd - (<a class="code" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a>)lpchTextBegin)/<span class="keyword">sizeof</span>(WCHAR);
01970             <span class="keywordflow">goto</span>  ProcessDrawText;  <span class="comment">// Start all over again!</span>
01971         }
01972         lprc-&gt;bottom = yLine;
01973     }
01974 
01975 <span class="comment">// if (!NOCLIP(wFormat))</span>
01976 <span class="comment">// {</span>
01977 <span class="comment">//     RestoreClipRgn(hdc, hrgnClip);</span>
01978 <span class="comment">// }</span>
01979 
01980     <span class="keywordflow">if</span> (hrgnClip != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
01981         <span class="keywordflow">if</span> (hrgnClip == (HRGN)-1) {
01982             <a class="code" href="../../d6/d1/userrtl_8h.html#a4">UserExtSelectClipRgn</a>(hdc, NULL, RGN_COPY);
01983         } <span class="keywordflow">else</span> {
01984             <a class="code" href="../../d6/d1/userrtl_8h.html#a4">UserExtSelectClipRgn</a>(hdc, hrgnClip, RGN_COPY);
01985             <a class="code" href="../../d6/d1/userrtl_8h.html#a3">UserDeleteObject</a>(hrgnClip);
01986         }
01987     }
01988 
01989     <span class="keywordflow">if</span>(DrawInfo.<a class="code" href="../../d2/d8/structDRAWTEXTDATA.html#o10">bCharsetDll</a>) {
01990 <span class="preprocessor">#ifdef _USERK_</span>
01991 <span class="preprocessor"></span>        <a class="code" href="../../d2/d8/structtagTHREADINFO.html">PTHREADINFO</a> ptiCurrent = <a class="code" href="../../d4/d1/userk_8h.html#a10">PtiCurrentShared</a>();
01992 
01993         <span class="keywordflow">if</span>(<a class="code" href="../../d4/d1/userk_8h.html#a393">CALL_LPK</a>(ptiCurrent))
01994 <span class="preprocessor">#endif // _USERK_</span>
01995 <span class="preprocessor"></span>            (*UserLpkDrawTextEx)(hdc, 0, 0, lpchText, cchText, <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>, dwDTformat,
01996                                  (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a1109">LPDRAWTEXTDATA</a>)&amp;DrawInfo, <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a899">DT_CHARSETDONE</a>, iCharset);
01997     }
01998 
01999     <span class="keywordflow">if</span> (<a class="code" href="../../d5/d2/rtl_2drawtext_8c.html#a14">RTLREADING</a>(dwDTformat))
02000         <a class="code" href="../../d6/d1/userrtl_8h.html#a26">UserSetTextAlign</a>(hdc, oldAlign);
02001 
02002     <span class="comment">/*</span>
02003 <span class="comment">     * Copy the number of characters actually drawn</span>
02004 <span class="comment">     */</span>
02005     <span class="keywordflow">if</span>(lpDTparams != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
02006         lpDTparams-&gt;uiLengthDrawn = (<a class="code" href="../../d9/d5/ndismain_8h.html#a265">UINT</a>)((<a class="code" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a>)lpchText - (<a class="code" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a>)lpchTextBegin)/<span class="keyword">sizeof</span>(WCHAR);
02007 
02008     <span class="keywordflow">if</span> (yLine == lprc-&gt;top)
02009         <span class="keywordflow">return</span> 1;
02010 
02011     <span class="keywordflow">return</span> (yLine - lprc-&gt;top);
02012 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a44" doxytag="rtl/drawtext.c::DT_AdjustWhiteSpaces" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> LPCWSTR DT_AdjustWhiteSpaces           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">LPCWSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>lpStNext</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPINT&nbsp;</td>
          <td class="mdname" nowrap> <em>lpiCount</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>wFormat</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l01249">1249</a> of file <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html">rtl/drawtext.c</a>.
<p>
References <a class="el" href="../../d4/d1/client_2drawtext_8c-source.html#l00018">DT_HFMTMASK</a>.
<p>
Referenced by <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l01319">DT_GetLineBreak()</a>.
<p>
<pre class="fragment"><div>01250 {
01251   <span class="keywordflow">switch</span>(wFormat &amp; <a class="code" href="../../d3/d2/client_2drawtext_8c.html#a2">DT_HFMTMASK</a>) {
01252       <span class="keywordflow">case</span> DT_LEFT:
01253         <span class="comment">// Prevent a white space at the begining of a left justfied text.</span>
01254         <span class="comment">// Is there a white space at the begining of next line......</span>
01255         <span class="keywordflow">if</span>((*lpStNext == TEXT(<span class="charliteral">' '</span>)) || (*lpStNext == TEXT(<span class="charliteral">'\t'</span>))) {
01256             <span class="comment">// ...then, exclude it from next line.</span>
01257             lpStNext++;
01258           }
01259         <span class="keywordflow">break</span>;
01260 
01261       <span class="keywordflow">case</span> DT_RIGHT:
01262         <span class="comment">// Prevent a white space at the end of a RIGHT justified text.</span>
01263         <span class="comment">// Is there a white space at the end of current line,.......</span>
01264         <span class="keywordflow">if</span>((*(lpStNext-1) == TEXT(<span class="charliteral">' '</span>)) || (*(lpStNext - 1) == TEXT(<span class="charliteral">'\t'</span>))) {
01265             <span class="comment">// .....then, Skip the white space from the current line.</span>
01266             (*lpiCount)--;
01267           }
01268         <span class="keywordflow">break</span>;
01269 
01270       <span class="keywordflow">case</span> DT_CENTER:
01271         <span class="comment">// Exclude white spaces from the begining and end of CENTERed lines.</span>
01272         <span class="comment">// If there is a white space at the end of current line.......</span>
01273         <span class="keywordflow">if</span>((*(lpStNext-1) == TEXT(<span class="charliteral">' '</span>)) || (*(lpStNext - 1) == TEXT(<span class="charliteral">'\t'</span>)))
01274             (*lpiCount)--;    <span class="comment">//...., don't count it for justification.</span>
01275         <span class="comment">// If there is a white space at the begining of next line.......</span>
01276         <span class="keywordflow">if</span>((*lpStNext == TEXT(<span class="charliteral">' '</span>)) || (*lpStNext == TEXT(<span class="charliteral">'\t'</span>)))
01277             lpStNext++;       <span class="comment">//...., exclude it from next line.</span>
01278         <span class="keywordflow">break</span>;
01279     }
01280   <span class="keywordflow">return</span> lpStNext;
01281 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a45" doxytag="rtl/drawtext.c::DT_BreakAWord" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> LPCWSTR DT_BreakAWord           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HDC&nbsp;</td>
          <td class="mdname" nowrap> <em>hdc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPCWSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>lpchText</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>iLength</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>iWidth</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>wFormat</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>iOverhang</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d1/d0/inc_2user_8h.html#a1083">LPDRAWTEXTDATA</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>lpDrawInfo</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>iCharSet</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l01288">1288</a> of file <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html">rtl/drawtext.c</a>.
<p>
References <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00907">DT_GetExtentMinusPrefixes()</a>.
<p>
Referenced by <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l01319">DT_GetLineBreak()</a>.
<p>
<pre class="fragment"><div>01290 {
01291   <span class="keywordtype">int</span>  iLow = 0, iHigh = iLength;
01292   <span class="keywordtype">int</span>  iNew;
01293 
01294 
01295   <span class="keywordflow">while</span>((iHigh - iLow) &gt; 1) {
01296       iNew = iLow + (iHigh - iLow)/2;
01297       <span class="keywordflow">if</span>(<a class="code" href="../../d5/d2/rtl_2drawtext_8c.html#a40">DT_GetExtentMinusPrefixes</a>(hdc, lpchText, iNew, wFormat, iOverhang, lpDrawInfo, iCharSet) &gt; iWidth)
01298           iHigh = iNew;
01299       <span class="keywordflow">else</span>
01300           iLow = iNew;
01301     }
01302   <span class="comment">// If the width is too low, we must print atleast one char per line.</span>
01303   <span class="comment">// Else, we will be in an infinite loop.</span>
01304   <span class="keywordflow">if</span>(!iLow &amp;&amp; iLength)
01305       iLow = 1;
01306   <span class="keywordflow">return</span> (lpchText+iLow);
01307 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a42" doxytag="rtl/drawtext.c::DT_DrawJustifiedLine" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void DT_DrawJustifiedLine           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HDC&nbsp;</td>
          <td class="mdname" nowrap> <em>hdc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>yTop</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPCWSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>lpchLineSt</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>cchCount</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>wFormat</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d1/d0/inc_2user_8h.html#a1083">LPDRAWTEXTDATA</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>lpDrawInfo</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>iCharSet</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l01053">1053</a> of file <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html">rtl/drawtext.c</a>.
<p>
References <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00965">DT_DrawStr()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l01604">AddEllipsisAndDrawLine()</a>, and <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l01708">DrawTextExWorker()</a>.
<p>
<pre class="fragment"><div>01056 {
01057   LPRECT lprc;
01058   <span class="keywordtype">int</span>   cxExtent;
01059   <span class="keywordtype">int</span>   xLeft;
01060 
01061   lprc = &amp;(lpDrawInfo-&gt;rcFormat);
01062   xLeft = lprc-&gt;left;
01063 
01064   <span class="comment">// Handle the special justifications (right or centered) properly.</span>
01065   <span class="keywordflow">if</span>(wFormat &amp; (DT_CENTER | DT_RIGHT)) {
01066       cxExtent = <a class="code" href="../../d5/d2/rtl_2drawtext_8c.html#a41">DT_DrawStr</a>(hdc, xLeft, yTop, lpchLineSt, cchCount, FALSE,
01067                      wFormat, lpDrawInfo, iCharSet) + lpDrawInfo-&gt;cxOverhang;
01068       <span class="keywordflow">if</span>(wFormat &amp; DT_CENTER)
01069           xLeft = lprc-&gt;left + (((lprc-&gt;right - lprc-&gt;left) - cxExtent) &gt;&gt; 1);
01070       <span class="keywordflow">else</span>
01071           xLeft = lprc-&gt;right - cxExtent;
01072     } <span class="keywordflow">else</span>
01073       xLeft = lprc-&gt;left;
01074 
01075   <span class="comment">// Draw the whole line.</span>
01076   cxExtent = <a class="code" href="../../d5/d2/rtl_2drawtext_8c.html#a41">DT_DrawStr</a>(hdc, xLeft, yTop, lpchLineSt, cchCount, TRUE, wFormat,
01077                         lpDrawInfo, iCharSet) +lpDrawInfo-&gt;cxOverhang;
01078   <span class="keywordflow">if</span>(cxExtent &gt; lpDrawInfo-&gt;cxMaxExtent)
01079       lpDrawInfo-&gt;cxMaxExtent = cxExtent;
01080 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a41" doxytag="rtl/drawtext.c::DT_DrawStr" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int DT_DrawStr           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HDC&nbsp;</td>
          <td class="mdname" nowrap> <em>hdc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>xLeft</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>yTop</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPCWSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>lpchStr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>cchCount</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>BOOL&nbsp;</td>
          <td class="mdname" nowrap> <em>fDraw</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>wFormat</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d1/d0/inc_2user_8h.html#a1083">LPDRAWTEXTDATA</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>lpDrawInfo</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>iCharSet</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00965">965</a> of file <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html">rtl/drawtext.c</a>.
<p>
References <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00031">CALCRECT</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l03529">CALL_LPK</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l03198">DT_CHARSETDRAW</a>, <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00907">DT_GetExtentMinusPrefixes()</a>, <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00033">EXPANDTABS</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l00059">PtiCurrentShared</a>, and <a class="el" href="../../d7/d0/userrtl_8h-source.html#l00163">UserGetLayout</a>.
<p>
Referenced by <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l01053">DT_DrawJustifiedLine()</a>, and <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l01319">DT_GetLineBreak()</a>.
<p>
<pre class="fragment"><div>00968 {
00969     LPCWSTR        lpch;
00970     <span class="keywordtype">int</span>   iLen;
00971     <span class="keywordtype">int</span>   cxExtent;
00972     <span class="keywordtype">int</span>   xOldLeft = xLeft;  <span class="comment">// Save the xLeft given to compute the extent later</span>
00973     <span class="keywordtype">int</span>   xTabLength = lpDrawInfo-&gt;cxTabLength;
00974     <span class="keywordtype">int</span>   iTabOrigin = lpDrawInfo-&gt;rcFormat.left;
00975 
00976 <span class="preprocessor">#ifdef USE_MIRRORING</span>
00977 <span class="preprocessor"></span>    <span class="comment">//</span>
00978     <span class="comment">// Because xLeft and yTop is a point in a rect, and we shift the rect in a mirrored hdc to include</span>
00979     <span class="comment">// its most right pixel, then shift this point as well.</span>
00980     <span class="comment">//</span>
00981     <span class="keywordflow">if</span> (<a class="code" href="../../d6/d1/userrtl_8h.html#a28">UserGetLayout</a>(hdc) &amp; LAYOUT_RTL) {
00982         --xOldLeft;
00983         --xLeft;
00984     }
00985 <span class="preprocessor">#endif</span>
00986 <span class="preprocessor"></span>
00987     <span class="comment">//</span>
00988     <span class="comment">// if there is a charset dll, let it draw the text.</span>
00989     <span class="comment">//</span>
00990     <span class="keywordflow">if</span>(lpDrawInfo-&gt;bCharsetDll) {
00991 <span class="preprocessor">#ifdef _USERK_</span>
00992 <span class="preprocessor"></span>        <a class="code" href="../../d2/d8/structtagTHREADINFO.html">PTHREADINFO</a> ptiCurrent = <a class="code" href="../../d4/d1/userk_8h.html#a10">PtiCurrentShared</a>();
00993 
00994         <span class="comment">//</span>
00995         <span class="comment">// Don't perform a callback if in thread cleanup mode.</span>
00996         <span class="comment">//</span>
00997         <span class="keywordflow">if</span>(!<a class="code" href="../../d4/d1/userk_8h.html#a393">CALL_LPK</a>(ptiCurrent))
00998             <span class="keywordflow">return</span> 0 ;
00999 <span class="preprocessor">#endif // _USERK_</span>
01000 <span class="preprocessor"></span>        <span class="keywordflow">return</span> (*UserLpkDrawTextEx)(hdc, xLeft, yTop, lpchStr, cchCount, fDraw,
01001                    wFormat, lpDrawInfo, <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a897">DT_CHARSETDRAW</a>, iCharSet);
01002     }
01003 
01004     <span class="comment">// Check if the tabs need to be expanded</span>
01005     <span class="keywordflow">if</span>(<a class="code" href="../../d5/d2/rtl_2drawtext_8c.html#a2">EXPANDTABS</a>(wFormat)) {
01006         <span class="keywordflow">while</span>(cchCount) {
01007             <span class="comment">// Look for a tab</span>
01008             <span class="keywordflow">for</span>(iLen = 0, lpch = lpchStr; iLen &lt; cchCount; iLen++)
01009                   <span class="keywordflow">if</span>(*lpch++ == TEXT(<span class="charliteral">'\t'</span>))
01010                     <span class="keywordflow">break</span>;
01011 
01012                 <span class="comment">// Draw text, if any, upto the tab</span>
01013             <span class="keywordflow">if</span> (iLen) {
01014                 <span class="comment">// Draw the substring taking care of the prefixes.</span>
01015                 <span class="keywordflow">if</span> (fDraw &amp;&amp; !<a class="code" href="../../d5/d2/rtl_2drawtext_8c.html#a0">CALCRECT</a>(wFormat)) { <span class="comment">// Only if we need to draw text</span>
01016                     (*(lpDrawInfo-&gt;lpfnTextDraw))(hdc, xLeft, yTop, (LPWSTR)lpchStr, iLen, wFormat);
01017                 }
01018                 <span class="comment">// Get the extent of this sub string and add it to xLeft.</span>
01019                 xLeft += <a class="code" href="../../d5/d2/rtl_2drawtext_8c.html#a40">DT_GetExtentMinusPrefixes</a>(hdc, lpchStr, iLen, wFormat, lpDrawInfo-&gt;cxOverhang, lpDrawInfo, iCharSet) - lpDrawInfo-&gt;cxOverhang;
01020             }
01021 
01022             <span class="comment">//if a TAB was found earlier, calculate the start of next sub-string.</span>
01023             <span class="keywordflow">if</span> (iLen &lt; cchCount) {
01024                 iLen++;  <span class="comment">// Skip the tab</span>
01025                 <span class="keywordflow">if</span> (xTabLength) <span class="comment">// Tab length could be zero</span>
01026                     xLeft = (((xLeft - iTabOrigin)/xTabLength) + 1)*xTabLength + iTabOrigin;
01027             }
01028 
01029             <span class="comment">// Calculate the details of the string that remains to be drawn.</span>
01030             cchCount -= iLen;
01031             lpchStr = lpch;
01032         }
01033         cxExtent = xLeft - xOldLeft;
01034     } <span class="keywordflow">else</span> {
01035         <span class="comment">// If required, draw the text (with either PSMTextOut or PSTextOut)</span>
01036         <span class="keywordflow">if</span> (fDraw &amp;&amp; !<a class="code" href="../../d5/d2/rtl_2drawtext_8c.html#a0">CALCRECT</a>(wFormat)) {
01037             (*(lpDrawInfo-&gt;lpfnTextDraw))(hdc, xLeft, yTop, (LPWSTR)lpchStr, cchCount, wFormat);
01038         }
01039         <span class="comment">// Compute the extent of the text.</span>
01040         cxExtent = <a class="code" href="../../d5/d2/rtl_2drawtext_8c.html#a40">DT_GetExtentMinusPrefixes</a>(hdc, lpchStr, cchCount, wFormat,
01041                                              lpDrawInfo-&gt;cxOverhang, lpDrawInfo, iCharSet) - lpDrawInfo-&gt;cxOverhang;
01042     }
01043     <span class="keywordflow">return</span> cxExtent;
01044 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a40" doxytag="rtl/drawtext.c::DT_GetExtentMinusPrefixes" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int DT_GetExtentMinusPrefixes           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HDC&nbsp;</td>
          <td class="mdname" nowrap> <em>hdc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPCWSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>lpchStr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>cchCount</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>wFormat</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>iOverhang</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d1/d0/inc_2user_8h.html#a1083">LPDRAWTEXTDATA</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>lpDrawInfo</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>iCharSet</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00907">907</a> of file <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html">rtl/drawtext.c</a>.
<p>
References <a class="el" href="../../d5/d0/userk_8h-source.html#l03529">CALL_LPK</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l03172">CH_PREFIX</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l03198">DT_CHARSETDRAW</a>, <a class="el" href="../../d2/d9/inc_2user_8h-source.html#l00529">_CLIENTINFO::dwTIFlags</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00192">GetClientInfo</a>, <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00806">GetPrefixCount()</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l00590">IS_DBCS_ENABLED</a>, <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00604">KKGetPrefixWidth()</a>, <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00036">NOPREFIX</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l00059">PtiCurrentShared</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02827">TIF_16BIT</a>, <a class="el" href="../../d7/d0/userrtl_8h-source.html#l00146">UserGetTextExtentPointW</a>, and <a class="el" href="../../d4/d1/userk_8h.html#a1412">xxxClientGetTextExtentPointW()</a>.
<p>
Referenced by <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l01604">AddEllipsisAndDrawLine()</a>, <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l01533">AddPathEllipsis()</a>, <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l01288">DT_BreakAWord()</a>, <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00965">DT_DrawStr()</a>, and <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l01424">NeedsEndEllipsis()</a>.
<p>
<pre class="fragment"><div>00909 {
00910   <span class="keywordtype">int</span>  iPrefixCount;
00911   <span class="keywordtype">int</span>  cxPrefixes = 0;
00912   WCHAR PrefixChar = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a894">CH_PREFIX</a>;
00913   SIZE size;
00914   <a class="code" href="../../d2/d2/struct__CLIENTINFO.html">PCLIENTINFO</a> pci = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a16">GetClientInfo</a>();
00915 <span class="preprocessor">#ifdef _USERK_</span>
00916 <span class="preprocessor"></span>  <a class="code" href="../../d2/d8/structtagTHREADINFO.html">PTHREADINFO</a> ptiCurrent = <a class="code" href="../../d4/d1/userk_8h.html#a10">PtiCurrentShared</a>();
00917 <span class="preprocessor">#endif</span>
00918 <span class="preprocessor"></span>  UNREFERENCED_PARAMETER(wFormat);
00919 
00920   <span class="keywordflow">if</span>(!<a class="code" href="../../d5/d2/rtl_2drawtext_8c.html#a5">NOPREFIX</a>(wFormat) &amp;&amp;
00921       (iPrefixCount = HIWORD(<a class="code" href="../../d5/d2/rtl_2drawtext_8c.html#a39">GetPrefixCount</a>(lpchStr, cchCount, NULL, 0)))) {
00922       <span class="comment">//</span>
00923       <span class="comment">// Kanji Windows has three shortcut prefixes...</span>
00924       <span class="comment">//  (ported from Win95 ctlmgr.c)</span>
00925       <span class="comment">//</span>
00926       <span class="keywordflow">if</span> (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a125">IS_DBCS_ENABLED</a>() &amp;&amp; (pci-&gt;<a class="code" href="../../d2/d2/struct__CLIENTINFO.html#o4">dwTIFlags</a> &amp; <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a796">TIF_16BIT</a>)) {
00927           <span class="comment">// 16bit apps compatibility</span>
00928           cxPrefixes = <a class="code" href="../../d5/d2/rtl_2drawtext_8c.html#a37">KKGetPrefixWidth</a>(hdc, lpchStr, cchCount) - (iPrefixCount * iOverhang);
00929       }
00930       <span class="keywordflow">else</span> {
00931           <span class="keywordflow">if</span>(lpDrawInfo-&gt;bCharsetDll) {
00932 <span class="preprocessor">#ifdef _USERK_</span>
00933 <span class="preprocessor"></span>              <span class="keywordflow">if</span>(<a class="code" href="../../d4/d1/userk_8h.html#a393">CALL_LPK</a>(ptiCurrent))
00934 <span class="preprocessor">#endif // _USERK_</span>
00935 <span class="preprocessor"></span>              {
00936                   <span class="comment">// Call LPKDrawTextEx with fDraw = FALSE just to get the text extent.</span>
00937                   <span class="keywordflow">return</span> (*UserLpkDrawTextEx)(hdc, 0, 0, lpchStr, cchCount, <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>,
00938                          wFormat, lpDrawInfo, <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a897">DT_CHARSETDRAW</a>, iCharSet);
00939               }
00940           } <span class="keywordflow">else</span> {
00941               cxPrefixes = <a class="code" href="../../d6/d1/userrtl_8h.html#a11">UserGetTextExtentPointW</a>(hdc, &amp;PrefixChar, 1, &amp;size);
00942               cxPrefixes = size.cx - iOverhang;
00943               cxPrefixes *=  iPrefixCount;
00944           }
00945       }
00946   }
00947 <span class="preprocessor">#ifdef _USERK_</span>
00948 <span class="preprocessor"></span>  <span class="keywordflow">if</span>(<a class="code" href="../../d4/d1/userk_8h.html#a393">CALL_LPK</a>(ptiCurrent))
00949     <a class="code" href="../../d4/d1/userk_8h.html#a1412">xxxClientGetTextExtentPointW</a>(hdc, lpchStr, cchCount, &amp;size);
00950   <span class="keywordflow">else</span>
00951 <span class="preprocessor">#endif // _USERK_</span>
00952 <span class="preprocessor"></span>    <a class="code" href="../../d6/d1/userrtl_8h.html#a11">UserGetTextExtentPointW</a>(hdc, lpchStr, cchCount, &amp;size);
00953   <span class="keywordflow">return</span> (size.cx - cxPrefixes);
00954 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a46" doxytag="rtl/drawtext.c::DT_GetLineBreak" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> LPWSTR DT_GetLineBreak           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HDC&nbsp;</td>
          <td class="mdname" nowrap> <em>hdc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPCWSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>lpchLineStart</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>cchCount</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>dwFormat</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPINT&nbsp;</td>
          <td class="mdname" nowrap> <em>lpiLineLength</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d1/d0/inc_2user_8h.html#a1083">LPDRAWTEXTDATA</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>lpDrawInfo</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>iCharSet</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l01319">1319</a> of file <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html">rtl/drawtext.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d4/d1/client_2drawtext_8c-source.html#l00015">CR</a>, <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l01249">DT_AdjustWhiteSpaces()</a>, <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l01288">DT_BreakAWord()</a>, <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00965">DT_DrawStr()</a>, <a class="el" href="../../d1/d4/perfuser_8c-source.html#l00052">DWORD</a>, <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00032">EDITCONTROL</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00662">GetNextWordbreak()</a>, <a class="el" href="../../d0/d5/ndismain_8h-source.html#l00025">INT</a>, <a class="el" href="../../d4/d1/client_2drawtext_8c-source.html#l00016">LF</a>, <a class="el" href="../../d0/d7/halvprnt_8c-source.html#l00031">PBYTE</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00040">WORDBREAK</a>, and <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00041">WORDELLIPSIS</a>.
<p>
Referenced by <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l01708">DrawTextExWorker()</a>.
<p>
<pre class="fragment"><div>01327 {
01328   LPCWSTR lpchText, lpchEnd, lpch, lpchLineEnd;
01329   <span class="keywordtype">int</span>   cxStart, cxExtent, cxNewExtent;
01330   <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>  fAdjustWhiteSpaces = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01331   WCHAR  ch;
01332   <a class="code" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a> dwCodePage = USERGETCODEPAGE(hdc);
01333 
01334   cxStart = lpDrawInfo-&gt;rcFormat.left;
01335   cxExtent = cxNewExtent = 0;
01336   lpchText = lpchLineStart;
01337   lpchEnd = lpchLineStart + cchCount;
01338 
01339 
01340   <span class="keywordflow">while</span>(lpchText &lt; lpchEnd) {
01341       lpchLineEnd = lpch = <a class="code" href="../../d5/d2/rtl_2drawtext_8c.html#a38">GetNextWordbreak</a>(dwCodePage,lpchText, lpchEnd, dwFormat, lpDrawInfo);
01342       <span class="comment">// DT_DrawStr does not return the overhang; Otherwise we will end up</span>
01343       <span class="comment">// adding one overhang for every word in the string.</span>
01344 
01345       <span class="comment">// For simulated Bold fonts, the summation of extents of individual</span>
01346       <span class="comment">// words in a line is greater than the extent of the whole line. So,</span>
01347       <span class="comment">// always calculate extent from the LineStart.</span>
01348       <span class="comment">// BUGTAG: #6054 -- Win95B -- SANKAR -- 3/9/95 --</span>
01349       cxNewExtent = <a class="code" href="../../d5/d2/rtl_2drawtext_8c.html#a41">DT_DrawStr</a>(hdc, cxStart, 0, lpchLineStart, (<span class="keywordtype">int</span>)(((PBYTE)lpch - (PBYTE)lpchLineStart)/<span class="keyword">sizeof</span>(WCHAR)), FALSE,
01350                  dwFormat, lpDrawInfo, iCharSet);
01351 
01352       <span class="keywordflow">if</span> (<a class="code" href="../../d5/d2/rtl_2drawtext_8c.html#a9">WORDBREAK</a>(dwFormat) &amp;&amp; ((cxNewExtent + lpDrawInfo-&gt;cxOverhang) &gt; lpDrawInfo-&gt;cxMaxWidth)) {
01353           <span class="comment">// Are there more than one word in this line?</span>
01354           <span class="keywordflow">if</span> (lpchText != lpchLineStart)  {
01355               lpchLineEnd = lpch = lpchText;
01356               fAdjustWhiteSpaces = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01357           } <span class="keywordflow">else</span> {
01358               <span class="comment">//One word is longer than the maximum width permissible.</span>
01359               <span class="comment">//See if we are allowed to break that single word.</span>
01360               <span class="keywordflow">if</span>(<a class="code" href="../../d5/d2/rtl_2drawtext_8c.html#a1">EDITCONTROL</a>(dwFormat) &amp;&amp; !<a class="code" href="../../d5/d2/rtl_2drawtext_8c.html#a10">WORDELLIPSIS</a>(dwFormat)) {
01361                   lpchLineEnd = lpch = <a class="code" href="../../d5/d2/rtl_2drawtext_8c.html#a45">DT_BreakAWord</a>(hdc, lpchText, (<span class="keywordtype">int</span>)(((PBYTE)lpch - (PBYTE)lpchText)/<span class="keyword">sizeof</span>(WCHAR)),
01362                         lpDrawInfo-&gt;cxMaxWidth - cxExtent,
01363                         dwFormat,
01364                         lpDrawInfo-&gt;cxOverhang, lpDrawInfo, iCharSet); <span class="comment">//Break that word</span>
01365                   <span class="comment">//Note: Since we broke in the middle of a word, no need to</span>
01366                   <span class="comment">// adjust for white spaces.</span>
01367               } <span class="keywordflow">else</span> {
01368                   fAdjustWhiteSpaces = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01369                   <span class="comment">// Check if we need to end this line with ellipsis</span>
01370                   <span class="keywordflow">if</span>(<a class="code" href="../../d5/d2/rtl_2drawtext_8c.html#a10">WORDELLIPSIS</a>(dwFormat))
01371                     {
01372                       <span class="comment">// Don't do this if already at the end of the string.</span>
01373                       <span class="keywordflow">if</span> (lpch &lt; lpchEnd)
01374                         {
01375                           <span class="comment">// If there are CR/LF at the end, skip them.</span>
01376                           <span class="keywordflow">if</span> ((ch = *lpch) == <a class="code" href="../../d3/d2/client_2drawtext_8c.html#a0">CR</a> || ch == <a class="code" href="../../d3/d2/client_2drawtext_8c.html#a1">LF</a>)
01377                             {
01378                               <span class="keywordflow">if</span> ((++lpch &lt; lpchEnd) &amp;&amp; (*lpch == (WCHAR)(ch ^ (<a class="code" href="../../d3/d2/client_2drawtext_8c.html#a1">LF</a> ^ <a class="code" href="../../d3/d2/client_2drawtext_8c.html#a0">CR</a>))))
01379                                   lpch++;
01380                               fAdjustWhiteSpaces = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01381                             }
01382                         }
01383                     }
01384               }
01385           }
01386           <span class="comment">// Well! We found a place to break the line. Let us break from this</span>
01387           <span class="comment">// loop;</span>
01388           <span class="keywordflow">break</span>;
01389       } <span class="keywordflow">else</span> {
01390           <span class="comment">// Don't do this if already at the end of the string.</span>
01391           <span class="keywordflow">if</span> (lpch &lt; lpchEnd) {
01392               <span class="keywordflow">if</span> ((ch = *lpch) == <a class="code" href="../../d3/d2/client_2drawtext_8c.html#a0">CR</a> || ch == <a class="code" href="../../d3/d2/client_2drawtext_8c.html#a1">LF</a>) {
01393                   <span class="keywordflow">if</span> ((++lpch &lt; lpchEnd) &amp;&amp; (*lpch == (WCHAR)(ch ^ (<a class="code" href="../../d3/d2/client_2drawtext_8c.html#a1">LF</a> ^ <a class="code" href="../../d3/d2/client_2drawtext_8c.html#a0">CR</a>))))
01394                       lpch++;
01395                   fAdjustWhiteSpaces = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01396                   <span class="keywordflow">break</span>;
01397               }
01398           }
01399       }
01400 
01401       <span class="comment">// Point at the beginning of the next word.</span>
01402       lpchText = lpch;
01403       cxExtent = cxNewExtent;
01404   }
01405 
01406   <span class="comment">// Calculate the length of current line.</span>
01407   *lpiLineLength = (<a class="code" href="../../d9/d5/ndismain_8h.html#a263">INT</a>)((<a class="code" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a>)lpchLineEnd - (<a class="code" href="../../d9/d7/halvprnt_8c.html#a1">PBYTE</a>)lpchLineStart)/<span class="keyword">sizeof</span>(WCHAR);
01408 
01409   <span class="comment">// Adjust the line length and lpch to take care of spaces.</span>
01410   <span class="keywordflow">if</span>(fAdjustWhiteSpaces &amp;&amp; (lpch &lt; lpchEnd))
01411       lpch = <a class="code" href="../../d5/d2/rtl_2drawtext_8c.html#a44">DT_AdjustWhiteSpaces</a>(lpch, lpiLineLength, dwFormat);
01412 
01413   <span class="comment">// return the begining of next line;</span>
01414   <span class="keywordflow">return</span> (LPWSTR)lpch;
01415 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a43" doxytag="rtl/drawtext.c::DT_InitDrawTextInfo" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL DT_InitDrawTextInfo           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HDC&nbsp;</td>
          <td class="mdname" nowrap> <em>hdc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPRECT&nbsp;</td>
          <td class="mdname" nowrap> <em>lprc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>wFormat</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d1/d0/inc_2user_8h.html#a1083">LPDRAWTEXTDATA</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>lpDrawInfo</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPDRAWTEXTPARAMS&nbsp;</td>
          <td class="mdname" nowrap> <em>lpDTparams</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l01090">1090</a> of file <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html">rtl/drawtext.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d0/d7/halvprnt_8c-source.html#l00031">BYTE</a>, <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00032">EDITCONTROL</a>, <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00034">EXTERNALLEADING</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l03228">FPLPKDRAWTEXTEX</a>, <a class="el" href="../../d2/d7/clglobal_8c-source.html#l00110">fpLpkDrawTextEx</a>, <a class="el" href="../../d2/d7/clglobal_8c-source.html#l00101">ghdcBits2</a>, <a class="el" href="../../d4/d5/ntuser_2kernel_2globals_8c-source.html#l00464">gpDispInfo</a>, <a class="el" href="../../d2/d7/clglobal_8c-source.html#l00051">gpsi</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l02099">tagDISPLAYINFO::hdcScreen</a>, <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l02027">IsSysFontAndDefaultMode()</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l03203">LPFNTEXTDRAW</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l03525">LPK_DRAWTEXTEX</a>, <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00036">NOPREFIX</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l00084">PpiCurrent</a>, <a class="el" href="../../d4/d1/client_2drawtext_8c-source.html#l00555">PSMTextOut()</a>, <a class="el" href="../../d5/d4/conimep_8h-source.html#l00060">TABSTOP</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d7/d0/userrtl_8h-source.html#l00141">UserGetCharDimensionsW</a>, <a class="el" href="../../d7/d0/userrtl_8h-source.html#l00159">UserGetTextCharsetInfo</a>, <a class="el" href="../../d7/d0/userrtl_8h-source.html#l00147">UserGetTextMetricsW</a>, <a class="el" href="../../d7/d0/userrtl_8h-source.html#l00148">UserGetViewportExtEx</a>, <a class="el" href="../../d7/d0/userrtl_8h-source.html#l00149">UserGetWindowExtEx</a>, <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00580">UserTextOutWInternal()</a>, and <a class="el" href="../../d6/d9/kernel_2text_8c-source.html#l00041">xxxPSMTextOut()</a>.
<p>
Referenced by <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l01708">DrawTextExWorker()</a>.
<p>
<pre class="fragment"><div>01096 {
01097   SIZE   sizeViewPortExt = {0, 0},sizeWindowExt = {0, 0};
01098   TEXTMETRICW tm;
01099   LPRECT      lprcDest;
01100   <span class="keywordtype">int</span>         iTabLength = 8;   <span class="comment">// Default Tab length is 8 characters.</span>
01101   <span class="keywordtype">int</span>         iLeftMargin;
01102   <span class="keywordtype">int</span>         iRightMargin;
01103   <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>        fUseSystemFont;
01104 
01105   <span class="keywordflow">if</span> (lpDTparams) {
01106       <span class="comment">/*</span>
01107 <span class="comment">       *  Only if DT_TABSTOP flag is mentioned, we must use the iTabLength field.</span>
01108 <span class="comment">       */</span>
01109       <span class="keywordflow">if</span> (<a class="code" href="../../d4/d5/conimep_8h.html#a25">TABSTOP</a>(wFormat))
01110           iTabLength = lpDTparams-&gt;iTabLength;
01111       iLeftMargin = lpDTparams-&gt;iLeftMargin;
01112       iRightMargin = lpDTparams-&gt;iRightMargin;
01113   } <span class="keywordflow">else</span> {
01114       iLeftMargin = iRightMargin = 0;
01115   }
01116 
01117   <span class="comment">/*</span>
01118 <span class="comment">   *  Get the View port and Window extents for the given DC</span>
01119 <span class="comment">   *  If this call fails, hdc must be invalid</span>
01120 <span class="comment">   */</span>
01121   <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d1/userrtl_8h.html#a13">UserGetViewportExtEx</a>(hdc,&amp;sizeViewPortExt)) {
01122 <span class="preprocessor">#ifndef _USERK_</span>
01123 <span class="preprocessor"></span>      <span class="comment">/*</span>
01124 <span class="comment">       * This call fails on  standard Metafiles. So check</span>
01125 <span class="comment">       * if the DC is really invalid to be compatible with</span>
01126 <span class="comment">       * Win9x</span>
01127 <span class="comment">       */</span>
01128       <span class="keywordflow">if</span> ((hdc == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) || !GdiValidateHandle(hdc))
01129 <span class="preprocessor">#endif</span>
01130 <span class="preprocessor"></span>          <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01131   }
01132   <a class="code" href="../../d6/d1/userrtl_8h.html#a14">UserGetWindowExtEx</a>(hdc, &amp;sizeWindowExt);
01133 
01134   <span class="comment">/*</span>
01135 <span class="comment">   *  For the current mapping mode,  find out the sign of x from left to right.</span>
01136 <span class="comment">   */</span>
01137   lpDrawInfo-&gt;iXSign =
01138       (((sizeViewPortExt.cx ^ sizeWindowExt.cx) &amp; 0x80000000) ? -1 : 1);
01139 
01140   <span class="comment">/*</span>
01141 <span class="comment">   *  For the current mapping mode,  find out the sign of y from top to bottom.</span>
01142 <span class="comment">   */</span>
01143   lpDrawInfo-&gt;iYSign =
01144       (((sizeViewPortExt.cy ^ sizeWindowExt.cy) &amp; 0x80000000) ? -1 : 1);
01145 
01146   <span class="comment">/*</span>
01147 <span class="comment">   *  Calculate the dimensions of the current font in this DC.</span>
01148 <span class="comment">   * (If it is SysFont AND the mapping mode is MM_TEXT, use system font's data)</span>
01149 <span class="comment">   */</span>
01150   fUseSystemFont = ((wFormat &amp; DT_INTERNAL) || <a class="code" href="../../d5/d2/rtl_2drawtext_8c.html#a53">IsSysFontAndDefaultMode</a>(hdc));
01151   <span class="keywordflow">if</span> (!fUseSystemFont) {
01152       <span class="comment">/*</span>
01153 <span class="comment">       *  Edit controls have their own way of calculating the aveCharWidth.</span>
01154 <span class="comment">       */</span>
01155       <span class="keywordflow">if</span> (<a class="code" href="../../d5/d2/rtl_2drawtext_8c.html#a1">EDITCONTROL</a>(wFormat)) {
01156           tm.tmAveCharWidth = <a class="code" href="../../d6/d1/userrtl_8h.html#a6">UserGetCharDimensionsW</a>(hdc, &amp;tm, NULL);
01157           tm.tmCharSet = (<a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a>)<a class="code" href="../../d6/d1/userrtl_8h.html#a24">UserGetTextCharsetInfo</a>(hdc, NULL, 0);
01158           <span class="keywordflow">if</span> (tm.tmAveCharWidth == 0) {
01159               fUseSystemFont = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01160           }
01161       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code" href="../../d6/d1/userrtl_8h.html#a12">UserGetTextMetricsW</a>(hdc, &amp;tm)) {
01162           <span class="comment">/*</span>
01163 <span class="comment">           * This can fail in a hard error popup during logon or logoff</span>
01164 <span class="comment">           * because UpdatePerUserSystemParameters destroys the server-side</span>
01165 <span class="comment">           * font handle for the DC, and a repaint occurs before we switch</span>
01166 <span class="comment">           * desktops (the switch recreates the popup from scratch with the</span>
01167 <span class="comment">           * new font OK). ChrisWil's changes to move system-wide attributes</span>
01168 <span class="comment">           * into desktops should take care of this in Kernel-mode.  This is</span>
01169 <span class="comment">           * just a horrible, horrible hack for now.</span>
01170 <span class="comment">           */</span>
01171           RIPMSG0(RIP_WARNING, <span class="stringliteral">"UserGetTextMetricsW failed: only in logon/off?\n"</span>);
01172           tm.tmOverhang = 0;
01173 
01174           <span class="comment">/*</span>
01175 <span class="comment">           * We should probably set fUseSystemFont to TRUE here. But I</span>
01176 <span class="comment">           *  assume that this "horrible hack" works fine plus it has been</span>
01177 <span class="comment">           *  here for good. So I'll leave it alone. 6/3/96</span>
01178 <span class="comment">           */</span>
01179       }
01180   }
01181 
01182   <span class="keywordflow">if</span> (fUseSystemFont) {
01183       <span class="comment">/*</span>
01184 <span class="comment">       *  Avoid GetTextMetrics for internal calls since they use sys font.</span>
01185 <span class="comment">       */</span>
01186       tm.tmHeight = <a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;cySysFontChar;
01187       tm.tmExternalLeading = <a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;tmSysFont.tmExternalLeading;
01188       tm.tmAveCharWidth = <a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;tmSysFont.tmAveCharWidth;
01189       tm.tmOverhang = <a class="code" href="../../d1/d8/clglobal_8c.html#a4">gpsi</a>-&gt;tmSysFont.tmOverhang;
01190 <span class="preprocessor">#ifdef _USERK_</span>
01191 <span class="preprocessor"></span>      tm.tmCharSet = (<a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a>)<a class="code" href="../../d6/d1/userrtl_8h.html#a24">UserGetTextCharsetInfo</a>(<a class="code" href="../../d3/d6/ntuser_2kernel_2globals_8c.html#a179">gpDispInfo</a>-&gt;<a class="code" href="../../d9/d3/structtagDISPLAYINFO.html#o3">hdcScreen</a>, NULL, 0);
01192 <span class="preprocessor">#else</span>
01193 <span class="preprocessor"></span>      tm.tmCharSet = (<a class="code" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a>)<a class="code" href="../../d6/d1/userrtl_8h.html#a24">UserGetTextCharsetInfo</a>(ghdcBits2, NULL, 0);
01194 <span class="preprocessor">#endif // _USERK_</span>
01195 <span class="preprocessor"></span>  }
01196 
01197 
01198   <span class="comment">// cyLineHeight is in pixels (This will be signed).</span>
01199   lpDrawInfo-&gt;cyLineHeight = (tm.tmHeight +
01200             (<a class="code" href="../../d5/d2/rtl_2drawtext_8c.html#a3">EXTERNALLEADING</a>(wFormat) ? tm.tmExternalLeading : 0)) *
01201             lpDrawInfo-&gt;iYSign;
01202 
01203   <span class="comment">// cxTabLength is the tab length in pixels (This will not be signed)</span>
01204   lpDrawInfo-&gt;cxTabLength = tm.tmAveCharWidth * iTabLength;
01205 
01206   <span class="comment">// Set the cxOverhang</span>
01207   lpDrawInfo-&gt;cxOverhang = tm.tmOverhang;
01208 
01209   <span class="comment">// Pick up the proper TextOut function based on the prefix processing reqd.</span>
01210 <span class="preprocessor">#ifdef _USERK_</span>
01211 <span class="preprocessor"></span>  lpDrawInfo-&gt;bCharsetDll = <a class="code" href="../../d4/d1/userk_8h.html#a16">PpiCurrent</a>()-&gt;dwLpkEntryPoints &amp; <a class="code" href="../../d4/d1/userk_8h.html#a390">LPK_DRAWTEXTEX</a>;
01212   <span class="keywordflow">if</span> (lpDrawInfo-&gt;bCharsetDll == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
01213       lpDrawInfo-&gt;lpfnTextDraw = (<a class="code" href="../../d5/d2/rtl_2drawtext_8c.html#a5">NOPREFIX</a>(wFormat) ? (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a1108">LPFNTEXTDRAW</a>)<a class="code" href="../../d5/d2/rtl_2drawtext_8c.html#a36">UserTextOutWInternal</a> : <a class="code" href="../../d5/d0/kernel_2text_8c.html#a1">xxxPSMTextOut</a>);
01214   }
01215 <span class="preprocessor">#else</span>
01216 <span class="preprocessor"></span>  lpDrawInfo-&gt;bCharsetDll = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>)(<a class="code" href="../../d1/d8/clglobal_8c.html#a34">fpLpkDrawTextEx</a> != (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a1112">FPLPKDRAWTEXTEX</a>)<a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>);
01217   <span class="keywordflow">if</span> (lpDrawInfo-&gt;bCharsetDll == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
01218       lpDrawInfo-&gt;lpfnTextDraw = (<a class="code" href="../../d5/d2/rtl_2drawtext_8c.html#a5">NOPREFIX</a>(wFormat) ? (<a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a1108">LPFNTEXTDRAW</a>)<a class="code" href="../../d5/d2/rtl_2drawtext_8c.html#a36">UserTextOutWInternal</a> : <a class="code" href="../../d3/d2/client_2drawtext_8c.html#a14">PSMTextOut</a>);
01219   }
01220 <span class="preprocessor">#endif // _USERK_</span>
01221 <span class="preprocessor"></span>
01222   <span class="comment">// Set up the format rectangle based on the margins.</span>
01223 <span class="comment">//  LCopyStruct(lprc, lprcDest = (LPRECT)&amp;(lpDrawInfo-&gt;rcFormat), sizeof(RECT));</span>
01224   lprcDest = &amp;(lpDrawInfo-&gt;rcFormat);
01225   *lprcDest = *lprc;
01226 
01227   <span class="comment">// We need to do the following only if the margins are given</span>
01228   <span class="keywordflow">if</span>(iLeftMargin | iRightMargin) {
01229       lprcDest-&gt;left += iLeftMargin * lpDrawInfo-&gt;iXSign;
01230       lprcDest-&gt;right -= (lpDrawInfo-&gt;cxRightMargin = iRightMargin * lpDrawInfo-&gt;iXSign);
01231     } <span class="keywordflow">else</span>
01232       lpDrawInfo-&gt;cxRightMargin = 0;  <span class="comment">// Initialize to zero.</span>
01233 
01234   <span class="comment">// cxMaxWidth is unsigned.</span>
01235   lpDrawInfo-&gt;cxMaxWidth = (lprcDest-&gt;right - lprcDest-&gt;left) * lpDrawInfo-&gt;iXSign;
01236   lpDrawInfo-&gt;cxMaxExtent = 0;  <span class="comment">// Initialize this to zero.</span>
01237 
01238   <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01239 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a38" doxytag="rtl/drawtext.c::GetNextWordbreak" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> LPCWSTR GetNextWordbreak           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>dwCodePage</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPCWSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>lpch</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPCWSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>lpchEnd</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>dwFormat</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d1/d0/inc_2user_8h.html#a1083">LPDRAWTEXTDATA</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>lpDrawInfo</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00662">662</a> of file <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html">rtl/drawtext.c</a>.
<p>
References <a class="el" href="../../d5/d0/userk_8h-source.html#l03529">CALL_LPK</a>, <a class="el" href="../../d4/d1/client_2drawtext_8c-source.html#l00015">CR</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l03201">DT_GETNEXTWORD</a>, <a class="el" href="../../d4/d1/client_2drawtext_8c-source.html#l00016">LF</a>, <a class="el" href="../../d0/d0/client_2nt6_2user_8h.html#a1109">LPDRAWTEXTDATA</a>, <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00044">NOFULLWIDTHCHARBREAK</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d5/d0/userk_8h-source.html#l00059">PtiCurrentShared</a>, <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00512">UserIsFELineBreak</a>, <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00535">UserIsFullWidth()</a>, and <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00040">WORDBREAK</a>.
<p>
Referenced by <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l01319">DT_GetLineBreak()</a>.
<p>
<pre class="fragment"><div>00668 {
00669     <span class="comment">/* ichNonWhite is used to make sure we always make progress. */</span>
00670     <span class="keywordtype">int</span> ichNonWhite = 1;
00671     <span class="keywordtype">int</span> ichComplexBreak = 0;        <span class="comment">// Breaking opportunity for complex scripts</span>
00672 <span class="preprocessor">#if ((DT_WORDBREAK &amp; ~0xff) != 0)</span>
00673 <span class="preprocessor"></span><span class="preprocessor">#error cannot use BOOLEAN for DT_WORDBREAK, or you should use "!!" before assigning it</span>
00674 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00675 <span class="preprocessor"></span>    BOOLEAN fBreakSpace = (BOOLEAN)<a class="code" href="../../d5/d2/rtl_2drawtext_8c.html#a9">WORDBREAK</a>(dwFormat);
00676     <span class="comment">/*</span>
00677 <span class="comment">     * If DT_WORDBREAK and DT_NOFULLWIDTHCHARBREAK are both set, we must</span>
00678 <span class="comment">     * stop assuming FullWidth characters as word as we're doing in</span>
00679 <span class="comment">     * NT4 and Win95. Instead, CR/LF and/or white space will only be</span>
00680 <span class="comment">     * a line-break characters.</span>
00681 <span class="comment">     */</span>
00682     BOOLEAN fDbcsCharBreak = (fBreakSpace &amp;&amp; !<a class="code" href="../../d5/d2/rtl_2drawtext_8c.html#a11">NOFULLWIDTHCHARBREAK</a>(dwFormat));
00683 
00684 <span class="preprocessor">#ifdef _USERK_</span>
00685 <span class="preprocessor"></span>    <span class="comment">/*</span>
00686 <span class="comment">     * Well, we actually should not and do not call GetNextWordBreak() in</span>
00687 <span class="comment">     * kernel, since only Menu stuff (no word break!) calls DrawText from kernel.</span>
00688 <span class="comment">     * In reality, thanks to a smart linker, word-break helper</span>
00689 <span class="comment">     * functions even does not exist in win32k.sys.</span>
00690 <span class="comment">     * Later, we should explicitly omit to compile those routines when we</span>
00691 <span class="comment">     * build kernel.</span>
00692 <span class="comment">     */</span>
00693     UNREFERENCED_PARAMETER(dwFormat);
00694 <span class="preprocessor">#endif</span>
00695 <span class="preprocessor"></span>
00696     <span class="comment">// We must terminate this loop before lpch == lpchEnd, otherwise, we</span>
00697     <span class="comment">// may gp fault during *lpch.</span>
00698     <span class="keywordflow">while</span> (lpch &lt; lpchEnd) {
00699         <span class="keywordflow">switch</span> (*lpch) {
00700         <span class="keywordflow">case</span> <a class="code" href="../../d3/d2/client_2drawtext_8c.html#a0">CR</a>:
00701         <span class="keywordflow">case</span> <a class="code" href="../../d3/d2/client_2drawtext_8c.html#a1">LF</a>:
00702             <span class="keywordflow">return</span> lpch;
00703 
00704         <span class="keywordflow">case</span> <span class="charliteral">'\t'</span>:
00705         <span class="keywordflow">case</span> <span class="charliteral">' '</span>:
00706             <span class="keywordflow">if</span> (fBreakSpace)
00707                 <span class="keywordflow">return</span> (lpch + ichNonWhite);
00708 
00709             <span class="comment">/*** FALL THRU ***/</span>
00710 
00711         <span class="keywordflow">default</span>:
00712             <span class="comment">/*</span>
00713 <span class="comment">             * Since most Japanese writing don't use space character</span>
00714 <span class="comment">             * to separate each word, we define each Kanji character</span>
00715 <span class="comment">             * as a word.</span>
00716 <span class="comment">             */</span>
00717             <span class="keywordflow">if</span> (fDbcsCharBreak &amp;&amp; <a class="code" href="../../d5/d2/rtl_2drawtext_8c.html#a35">UserIsFullWidth</a>(dwCodePage, *lpch)) {
00718                 <span class="keywordflow">if</span> (!ichNonWhite)
00719                     <span class="keywordflow">return</span> lpch;
00720                 <span class="comment">/*</span>
00721 <span class="comment">                 * if the next character is the last character of this string,</span>
00722 <span class="comment">                 * We return the character, even this is a "KINSOKU" charcter...</span>
00723 <span class="comment">                 */</span>
00724                 <span class="keywordflow">if</span> ((lpch+1) != lpchEnd) {
00725                     <span class="comment">/*</span>
00726 <span class="comment">                     * Check next character of FullWidth character.</span>
00727 <span class="comment">                     * if the next character is "KINSOKU" character, the character</span>
00728 <span class="comment">                     * should be handled as a part of previous FullWidth character.</span>
00729 <span class="comment">                     * Never handle is as A character, and should not be a Word also.</span>
00730 <span class="comment">                     */</span>
00731                     <span class="keywordflow">if</span> (<a class="code" href="../../d5/d2/rtl_2drawtext_8c.html#a22">UserIsFELineBreak</a>(*(lpch+1))) {
00732                         <span class="comment">/*</span>
00733 <span class="comment">                         * Then if the character is "KINSOKU" character, we return</span>
00734 <span class="comment">                         * the next of this character,...</span>
00735 <span class="comment">                         */</span>
00736                         <span class="keywordflow">return</span> (lpch + 1 + 1);
00737                     }
00738                 }
00739                 <span class="comment">/*</span>
00740 <span class="comment">                 * Otherwise, we just return the chracter that is next of FullWidth</span>
00741 <span class="comment">                 * Character. Because we treat A FullWidth chacter as A Word.</span>
00742 <span class="comment">                 */</span>
00743                 <span class="keywordflow">return</span> (lpch + 1);
00744             }
00745             <span class="comment">/*</span>
00746 <span class="comment">             * If the character is not a FullWidth character and the complex script</span>
00747 <span class="comment">             * LPK is present. Call it to determine the breaking opportunity for</span>
00748 <span class="comment">             * script that requires word break such as Thai. Note that if *lpch is</span>
00749 <span class="comment">             * NOT a complex script character. The LPK will fail the call and return 0</span>
00750 <span class="comment">             * since currently Uniscribe does not know how to handle FE break.</span>
00751 <span class="comment">             */</span>
00752             <span class="keywordflow">else</span> <span class="keywordflow">if</span>(fBreakSpace &amp;&amp; lpDrawInfo-&gt;bCharsetDll) {
00753 <span class="preprocessor">#ifdef _USERK_</span>
00754 <span class="preprocessor"></span>                <a class="code" href="../../d2/d8/structtagTHREADINFO.html">PTHREADINFO</a> ptiCurrent = <a class="code" href="../../d4/d1/userk_8h.html#a10">PtiCurrentShared</a>();
00755                 <span class="keywordflow">if</span>(<a class="code" href="../../d4/d1/userk_8h.html#a393">CALL_LPK</a>(ptiCurrent))
00756 <span class="preprocessor">#endif</span>
00757 <span class="preprocessor"></span>                    ichComplexBreak = (*UserLpkDrawTextEx)(0, 0, 0, lpch, (<span class="keywordtype">int</span>)(lpchEnd - lpch), 0,
00758                                         0, <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>, <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a900">DT_GETNEXTWORD</a>, -1);
00759                 <span class="keywordflow">if</span> (ichComplexBreak &gt; 0)
00760                     <span class="keywordflow">return</span> (lpch + ichComplexBreak);
00761             }
00762             lpch++;
00763             ichNonWhite = 0;
00764         }
00765     }
00766 
00767     <span class="keywordflow">return</span> lpch;
00768 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a39" doxytag="rtl/drawtext.c::GetPrefixCount" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> LONG GetPrefixCount           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">LPCWSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>lpstr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>cch</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPWSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>lpstrCopy</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>charcopycount</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00806">806</a> of file <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html">rtl/drawtext.c</a>.
<p>
References <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l03178">CH_ENGLISHPREFIX</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l03179">CH_KANJIPREFIX</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l03172">CH_PREFIX</a>, and <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>.
<p>
Referenced by <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00907">DT_GetExtentMinusPrefixes()</a>, <a class="el" href="../../d9/d9/rtl_2text_8c-source.html#l00072">PSMGetTextExtent()</a>, <a class="el" href="../../d4/d1/client_2drawtext_8c-source.html#l00580">UserLpkPSMTextOut()</a>, <a class="el" href="../../d7/d1/mndraw_8c-source.html#l02082">xxxDrawMenuBarUnderlines()</a>, <a class="el" href="../../d7/d1/mndraw_8c-source.html#l00565">xxxDrawMenuItemText()</a>, and <a class="el" href="../../d6/d9/kernel_2text_8c-source.html#l00041">xxxPSMTextOut()</a>.
<p>
<pre class="fragment"><div>00811 {
00812     <span class="keywordtype">int</span> chprintpos = 0;         <span class="comment">/* Num of chars that will be printed */</span>
00813     <span class="keywordtype">int</span> chcount = 0;            <span class="comment">/* Num of prefix chars that will be removed */</span>
00814     <span class="keywordtype">int</span> chprefixloc = -1;       <span class="comment">/* Pos (in printed chars) of the prefix */</span>
00815     WCHAR ch;
00816 
00817     <span class="comment">/*</span>
00818 <span class="comment">     * If not copying, use a large bogus count...</span>
00819 <span class="comment">     */</span>
00820     <span class="keywordflow">if</span> (lpstrCopy == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00821         charcopycount = 32767;
00822 
00823     <span class="keywordflow">while</span> ((cch-- &gt; 0) &amp;&amp; *lpstr &amp;&amp; charcopycount-- != 0) {
00824 
00825         <span class="comment">/*</span>
00826 <span class="comment">         * Is this guy a prefix character ?</span>
00827 <span class="comment">         */</span>
00828         <span class="keywordflow">if</span> ((ch = *lpstr++) == <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a894">CH_PREFIX</a>) {
00829 
00830             <span class="comment">/*</span>
00831 <span class="comment">             * Yup - increment the count of characters removed during print.</span>
00832 <span class="comment">             */</span>
00833             chcount++;
00834 
00835             <span class="comment">/*</span>
00836 <span class="comment">             * Is the next also a prefix char?</span>
00837 <span class="comment">             */</span>
00838             <span class="keywordflow">if</span> (*lpstr != <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a894">CH_PREFIX</a>) {
00839 
00840                 <span class="comment">/*</span>
00841 <span class="comment">                 * Nope - this is a real one, mark its location.</span>
00842 <span class="comment">                 */</span>
00843                 chprefixloc = chprintpos;
00844 
00845             } <span class="keywordflow">else</span> {
00846 
00847                 <span class="comment">/*</span>
00848 <span class="comment">                 * yup - simply copy it if copying.</span>
00849 <span class="comment">                 */</span>
00850                 <span class="keywordflow">if</span> (lpstrCopy != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00851                     *(lpstrCopy++) = <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a894">CH_PREFIX</a>;
00852                 cch--;
00853                 lpstr++;
00854                 chprintpos++;
00855             }
00856         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ch == <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a895">CH_ENGLISHPREFIX</a>) {    <span class="comment">// Still needs to be parsed</span>
00857             <span class="comment">/*</span>
00858 <span class="comment">             * Yup - increment the count of characters removed during print.</span>
00859 <span class="comment">             */</span>
00860             chcount++;
00861 
00862             <span class="comment">/*</span>
00863 <span class="comment">             * Next character is a real one, mark its location.</span>
00864 <span class="comment">             */</span>
00865             chprefixloc = chprintpos;
00866 
00867         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ch == <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a896">CH_KANJIPREFIX</a>) {      <span class="comment">// Still needs to be parsed</span>
00868             <span class="comment">/*</span>
00869 <span class="comment">             * We only support Alpha Numeric(CH_ENGLISHPREFIX).</span>
00870 <span class="comment">             * no support for Kana(CH_KANJIPREFIX).</span>
00871 <span class="comment">             */</span>
00872             <span class="comment">/*</span>
00873 <span class="comment">             * Yup - increment the count of characters removed during print.</span>
00874 <span class="comment">             */</span>
00875             chcount++;
00876 
00877             <span class="keywordflow">if</span>(cch) {
00878                 <span class="comment">/* don't copy the character */</span>
00879                 chcount++;
00880                 lpstr++;
00881                 cch--;
00882             }
00883         } <span class="keywordflow">else</span> {
00884 
00885             <span class="comment">/*</span>
00886 <span class="comment">             * Nope - just inc count of char.  that will be printed</span>
00887 <span class="comment">             */</span>
00888             chprintpos++;
00889             <span class="keywordflow">if</span> (lpstrCopy != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00890                 *(lpstrCopy++) = ch;
00891         }
00892     }
00893 
00894     <span class="keywordflow">if</span> (lpstrCopy != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)
00895         *lpstrCopy = 0;
00896 
00897     <span class="comment">/*</span>
00898 <span class="comment">     * Return the character counts</span>
00899 <span class="comment">     */</span>
00900     <span class="keywordflow">return</span> MAKELONG(chprefixloc, chcount);
00901 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a53" doxytag="rtl/drawtext.c::IsSysFontAndDefaultMode" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL IsSysFontAndDefaultMode           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HDC&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>hdc</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l02027">2027</a> of file <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html">rtl/drawtext.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d2/d7/clglobal_8c-source.html#l00103">ghFontSys</a>, <a class="el" href="../../d7/d0/userrtl_8h-source.html#l00143">UserGetHFONT</a>, and <a class="el" href="../../d7/d0/userrtl_8h-source.html#l00144">UserGetMapMode</a>.
<p>
Referenced by <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l01090">DT_InitDrawTextInfo()</a>, and <a class="el" href="../../d4/d1/client_2drawtext_8c-source.html#l00212">TabTextOut()</a>.
<p>
<pre class="fragment"><div>02028 {
02029     <span class="keywordflow">return</span>((<a class="code" href="../../d6/d1/userrtl_8h.html#a8">UserGetHFONT</a>(hdc) == <a class="code" href="../../d1/d8/clglobal_8c.html#a28">ghFontSys</a>) &amp;&amp; (<a class="code" href="../../d6/d1/userrtl_8h.html#a9">UserGetMapMode</a>(hdc) == MM_TEXT));
02030 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a37" doxytag="rtl/drawtext.c::KKGetPrefixWidth" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int KKGetPrefixWidth           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HDC&nbsp;</td>
          <td class="mdname" nowrap> <em>hdc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPCWSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>lpStr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>cch</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00604">604</a> of file <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html">rtl/drawtext.c</a>.
<p>
References <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l03178">CH_ENGLISHPREFIX</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l03179">CH_KANJIPREFIX</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l03172">CH_PREFIX</a>, <a class="el" href="../../d3/d9/aw_8h-source.html#l00031">L</a>, and <a class="el" href="../../d7/d0/userrtl_8h-source.html#l00146">UserGetTextExtentPointW</a>.
<p>
Referenced by <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00907">DT_GetExtentMinusPrefixes()</a>.
<p>
<pre class="fragment"><div>00605 {
00606     SIZE size;
00607     SIZE iPrefix1 = {-1<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>,-1<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>};
00608     SIZE iPrefix2 = {-1<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>,-1<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>};
00609     SIZE iPrefix3 = {-1<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>,-1<a class="code" href="../../d2/d0/aw_8h.html#a3">L</a>};
00610     <span class="keywordtype">int</span>  iTotal   = 0;
00611 
00612     <span class="keywordflow">while</span> (cch-- &gt; 0 &amp;&amp; *lpStr) {
00613         <span class="keywordflow">switch</span>(*lpStr) {
00614         <span class="keywordflow">case</span> <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a894">CH_PREFIX</a>:
00615             <span class="keywordflow">if</span> (lpStr[1] != <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a894">CH_PREFIX</a>) {
00616                 <span class="keywordflow">if</span> (iPrefix1.cx == -1) {
00617                     <a class="code" href="../../d6/d1/userrtl_8h.html#a11">UserGetTextExtentPointW</a>(hdc, lpStr, 1, &amp;iPrefix1);
00618                 }
00619                 iTotal += iPrefix1.cx;
00620             } <span class="keywordflow">else</span> {
00621                 lpStr++;
00622                 cch--;
00623             }
00624             <span class="keywordflow">break</span>;
00625         <span class="keywordflow">case</span> <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a895">CH_ENGLISHPREFIX</a>:
00626             <span class="keywordflow">if</span> (iPrefix2.cx == -1) {
00627                  <a class="code" href="../../d6/d1/userrtl_8h.html#a11">UserGetTextExtentPointW</a>(hdc, lpStr, 1, &amp;iPrefix2);
00628             }
00629             iTotal += iPrefix2.cx;
00630             <span class="keywordflow">break</span>;
00631         <span class="keywordflow">case</span> <a class="code" href="../../d0/d0/client_2nt6_2user_8h.html#a896">CH_KANJIPREFIX</a>:
00632             <span class="keywordflow">if</span> (iPrefix3.cx == -1) {
00633                  <a class="code" href="../../d6/d1/userrtl_8h.html#a11">UserGetTextExtentPointW</a>(hdc, lpStr, 1, &amp;iPrefix3);
00634             }
00635             iTotal += iPrefix3.cx;
00636             <span class="comment">//</span>
00637             <span class="comment">// In NT, always alpha numeric mode, Then we have to sum</span>
00638             <span class="comment">// KANA accel key prefix non visible char width.</span>
00639             <span class="comment">// so always add the extent for next char.</span>
00640             <span class="comment">//</span>
00641             <a class="code" href="../../d6/d1/userrtl_8h.html#a11">UserGetTextExtentPointW</a>(hdc, lpStr, 1, &amp;size);
00642             iTotal += size.cx;
00643             <span class="keywordflow">break</span>;
00644         <span class="keywordflow">default</span>:
00645             <span class="comment">// No need to taking care of Double byte since 2nd byte of</span>
00646             <span class="comment">// DBC is grater than 0x2f but all shortcut keys are less</span>
00647             <span class="comment">// than 0x30.</span>
00648             <span class="keywordflow">break</span>;
00649         }
00650         lpStr++;
00651     }
00652     <span class="keywordflow">return</span> iTotal;
00653 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a47" doxytag="rtl/drawtext.c::NeedsEndEllipsis" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL NeedsEndEllipsis           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HDC&nbsp;</td>
          <td class="mdname" nowrap> <em>hdc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPCWSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>lpchText</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPINT&nbsp;</td>
          <td class="mdname" nowrap> <em>lpCount</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d1/d0/inc_2user_8h.html#a1083">LPDRAWTEXTDATA</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>lpDTdata</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>wFormat</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d1/d0/inc_2user_8h.html#a1083">LPDRAWTEXTDATA</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>lpDrawInfo</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>iCharSet</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l01424">1424</a> of file <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html">rtl/drawtext.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d1/d9/client_2nt6_2user_8h-source.html#l03236">CCHELLIPSIS</a>, <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00907">DT_GetExtentMinusPrefixes()</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00061">szEllipsis</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, and <a class="el" href="../../d7/d0/userrtl_8h-source.html#l00146">UserGetTextExtentPointW</a>.
<p>
Referenced by <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l01604">AddEllipsisAndDrawLine()</a>.
<p>
<pre class="fragment"><div>01429 {
01430     <span class="keywordtype">int</span>   cchText;
01431     <span class="keywordtype">int</span>   ichMin, ichMax, ichMid;
01432     <span class="keywordtype">int</span>   cxMaxWidth;
01433     <span class="keywordtype">int</span>   iOverhang;
01434     <span class="keywordtype">int</span>   cxExtent;
01435     SIZE size;
01436     cchText = *lpCount;  <span class="comment">// Get the current count.</span>
01437 
01438     <span class="keywordflow">if</span> (cchText == 0)
01439         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01440 
01441     cxMaxWidth  = lpDTdata-&gt;cxMaxWidth;
01442     iOverhang   = lpDTdata-&gt;cxOverhang;
01443 
01444     cxExtent = <a class="code" href="../../d5/d2/rtl_2drawtext_8c.html#a40">DT_GetExtentMinusPrefixes</a>(hdc, lpchText, cchText, wFormat, iOverhang, lpDrawInfo, iCharSet);
01445 
01446     <span class="keywordflow">if</span> (cxExtent &lt;= cxMaxWidth)
01447         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
01448     <span class="comment">// Reserve room for the "..." ellipses;</span>
01449     <span class="comment">// (Assumption: The ellipses don't have any prefixes!)</span>
01450     <a class="code" href="../../d6/d1/userrtl_8h.html#a11">UserGetTextExtentPointW</a>(hdc, szEllipsis, CCHELLIPSIS, &amp;size);
01451     cxMaxWidth -= size.cx - iOverhang;
01452 
01453     <span class="comment">// If no room for ellipses, always show first character.</span>
01454     <span class="comment">//</span>
01455     ichMax = 1;
01456     <span class="keywordflow">if</span> (cxMaxWidth &gt; 0) {
01457         <span class="comment">// Binary search to find characters that will fit.</span>
01458         ichMin = 0;
01459         ichMax = cchText;
01460         <span class="keywordflow">while</span> (ichMin &lt; ichMax) {
01461             <span class="comment">// Be sure to round up, to make sure we make progress in</span>
01462             <span class="comment">// the loop if ichMax == ichMin + 1.</span>
01463             <span class="comment">//</span>
01464             ichMid = (ichMin + ichMax + 1) / 2;
01465 
01466             cxExtent = <a class="code" href="../../d5/d2/rtl_2drawtext_8c.html#a40">DT_GetExtentMinusPrefixes</a>(hdc, lpchText, ichMid, wFormat, iOverhang, lpDrawInfo, iCharSet);
01467 
01468             <span class="keywordflow">if</span> (cxExtent &lt; cxMaxWidth)
01469                 ichMin = ichMid;
01470             <span class="keywordflow">else</span> {
01471                 <span class="keywordflow">if</span> (cxExtent &gt; cxMaxWidth)
01472                     ichMax = ichMid - 1;
01473                 <span class="keywordflow">else</span> {
01474                     <span class="comment">// Exact match up up to ichMid: just exit.</span>
01475                     <span class="comment">//</span>
01476                     ichMax = ichMid;
01477                     <span class="keywordflow">break</span>;
01478                   }
01479               }
01480           }
01481 
01482         <span class="comment">// Make sure we always show at least the first character...</span>
01483         <span class="comment">//</span>
01484         <span class="keywordflow">if</span> (ichMax &lt; 1)
01485             ichMax = 1;
01486       }
01487 
01488     *lpCount = ichMax;
01489     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01490 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a48" doxytag="rtl/drawtext.c::PathFindFileName" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> LPWSTR PathFindFileName           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">LPCWSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>pPath</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>cchText</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l01515">1515</a> of file <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html">rtl/drawtext.c</a>.
<p>
Referenced by <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l01533">AddPathEllipsis()</a>.
<p>
<pre class="fragment"><div>01516 {
01517     LPCWSTR pT;
01518 
01519     <span class="keywordflow">for</span> (pT = pPath; cchText &gt; 0 &amp;&amp; *pPath; pPath++, cchText--) {
01520         <span class="keywordflow">if</span> ((pPath[0] == TEXT(<span class="charliteral">'\\'</span>) || pPath[0] == TEXT(<span class="charliteral">':'</span>)) &amp;&amp; pPath[1])
01521             pT = pPath + 1;
01522     }
01523 
01524     <span class="keywordflow">return</span> (LPWSTR)pT;   <span class="comment">// REVIEW, should this be const?</span>
01525 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a34" doxytag="rtl/drawtext.c::UserIsFELineBreakEnd" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL UserIsFELineBreakEnd           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">WCHAR&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>wch</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00416">416</a> of file <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html">rtl/drawtext.c</a>.
<p>
References <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00311">aASCII_Latin1_EndBreak</a>, <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00332">aCJKSymbol_EndBreak</a>, <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00338">aCNS11643_SmallVariants_EndBreak</a>, <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00345">aFullWidthHalfWidthVariants_EndBreak</a>, <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00325">aGeneralPunctuation_EndBreak</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
<pre class="fragment"><div>00417 {
00418     <span class="keywordflow">switch</span> (wch&gt;&gt;8) {
00419         <span class="keywordflow">case</span> 0x00:
00420             <span class="comment">//</span>
00421             <span class="comment">// Check if word breaking chars in ASCII or Latin1.</span>
00422             <span class="comment">//</span>
00423             <span class="keywordflow">if</span> ((wch &gt;= 0x0021) &amp;&amp; (wch &lt;= 0x00B7))
00424                 <span class="keywordflow">return</span>((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>)(<a class="code" href="../../d5/d2/rtl_2drawtext_8c.html#a26">aASCII_Latin1_EndBreak</a>[wch - 0x0021]));
00425             <span class="keywordflow">else</span>
00426                 <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00427 
00428         <span class="keywordflow">case</span> 0x02:
00429             <span class="comment">//</span>
00430             <span class="comment">// Check if work breaking chars in "Modifier letters"</span>
00431             <span class="comment">//</span>
00432             <span class="keywordflow">if</span> ((wch == 0x02C7) || (wch == 0x02C9))
00433                 <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00434             <span class="keywordflow">else</span>
00435                 <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00436 
00437         <span class="keywordflow">case</span> 0x20:
00438             <span class="comment">//</span>
00439             <span class="comment">// Check if work breaking chars in "General punctuation"</span>
00440             <span class="comment">//</span>
00441             <span class="keywordflow">if</span> ((wch &gt;= 0x2013) &amp;&amp; (wch &lt;= 0x2033))
00442                 <span class="keywordflow">return</span>((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>)(<a class="code" href="../../d5/d2/rtl_2drawtext_8c.html#a27">aGeneralPunctuation_EndBreak</a>[wch - 0x2013]));
00443             <span class="keywordflow">else</span>
00444                 <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00445 
00446         <span class="keywordflow">case</span> 0x21:
00447             <span class="comment">//</span>
00448             <span class="comment">// Check if work breaking chars in "Letterlike symbols"</span>
00449             <span class="comment">//</span>
00450             <span class="keywordflow">if</span> (wch == 0x2103)
00451                 <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00452             <span class="keywordflow">else</span>
00453                 <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00454 
00455         <span class="keywordflow">case</span> 0x22:
00456             <span class="comment">//</span>
00457             <span class="comment">// Check if work breaking chars in "Mathemetical opetartors"</span>
00458             <span class="comment">//</span>
00459             <span class="keywordflow">if</span> (wch == 0x2236)
00460                 <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00461             <span class="keywordflow">else</span>
00462                 <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00463 
00464         <span class="keywordflow">case</span> 0x25:
00465             <span class="comment">//</span>
00466             <span class="comment">// Check if work breaking chars in "Form and Chart components"</span>
00467             <span class="comment">//</span>
00468             <span class="keywordflow">if</span> (wch == 0x2574)
00469                 <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00470             <span class="keywordflow">else</span>
00471                 <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00472 
00473         <span class="keywordflow">case</span> 0x30:
00474             <span class="comment">//</span>
00475             <span class="comment">// Check if word breaking chars in "CJK symbols and punctuation"</span>
00476             <span class="comment">// and Hiragana.</span>
00477             <span class="comment">//</span>
00478             <span class="keywordflow">if</span> ((wch &gt;= 0x3001) &amp;&amp; (wch &lt;= 0x301E))
00479                 <span class="keywordflow">return</span>((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>)(<a class="code" href="../../d5/d2/rtl_2drawtext_8c.html#a28">aCJKSymbol_EndBreak</a>[wch - 0x3001]));
00480             <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((wch == 0x309B) || (wch == 0x309C))
00481                 <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00482             <span class="keywordflow">else</span>
00483                 <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00484 
00485         <span class="keywordflow">case</span> 0xFE:
00486             <span class="comment">//</span>
00487             <span class="comment">// Check if word breaking chars in "CNS 11643 compatibility"</span>
00488             <span class="comment">// or "Small variants".</span>
00489             <span class="comment">//</span>
00490             <span class="keywordflow">if</span> ((wch &gt;= 0xFE30) &amp;&amp; (wch &lt;= 0xFE5E))
00491                 <span class="keywordflow">return</span>((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>)(<a class="code" href="../../d5/d2/rtl_2drawtext_8c.html#a29">aCNS11643_SmallVariants_EndBreak</a>[wch - 0xFE30]));
00492             <span class="keywordflow">else</span>
00493                 <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00494 
00495         <span class="keywordflow">case</span> 0xFF:
00496             <span class="comment">//</span>
00497             <span class="comment">// Check if word breaking chars in "Fullwidth ASCII variants",</span>
00498             <span class="comment">// "Halfwidth Katakana variants" or "Fullwidth symbol variants".</span>
00499             <span class="comment">//</span>
00500             <span class="keywordflow">if</span> ((wch &gt;= 0xFF01) &amp;&amp; (wch &lt;= 0xFF9F))
00501                 <span class="keywordflow">return</span>((<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a11">BOOL</a>)(<a class="code" href="../../d5/d2/rtl_2drawtext_8c.html#a30">aFullWidthHalfWidthVariants_EndBreak</a>[wch - 0xFF01]));
00502             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (wch &gt;= 0xFFE0)
00503                 <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00504             <span class="keywordflow">else</span>
00505                 <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00506 
00507         <span class="keywordflow">default</span>:
00508             <span class="keywordflow">return</span>(<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00509     }
00510 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a35" doxytag="rtl/drawtext.c::UserIsFullWidth" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL UserIsFullWidth           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>dwCodePage</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>WCHAR&nbsp;</td>
          <td class="mdname" nowrap> <em>wChar</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00535">535</a> of file <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html">rtl/drawtext.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d2/d0/bench_8c-source.html#l00050">CHAR</a>, <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00523">_FULLWIDTH_UNICODE::End</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00528">FullWidthUnicodes</a>, <a class="el" href="../../d0/d5/ndismain_8h-source.html#l00025">INT</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00526">NUM_FULLWIDTH_UNICODES</a>, <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00522">_FULLWIDTH_UNICODE::Start</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, and <a class="el" href="../../d0/d5/ndismain_8h-source.html#l00026">UINT</a>.
<p>
Referenced by <a class="el" href="../../d9/d3/editec_8c-source.html#l01552">ECWord()</a>, <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00662">GetNextWordbreak()</a>, and <a class="el" href="../../d2/d4/editml_8c-source.html#l01562">MLBuildchLines()</a>.
<p>
<pre class="fragment"><div>00536 {
00537     <a class="code" href="../../d9/d5/ndismain_8h.html#a263">INT</a>  index;
00538     <a class="code" href="../../d9/d5/ndismain_8h.html#a263">INT</a>  cChars;
00539 <span class="preprocessor">#ifdef _USERK_</span>
00540 <span class="preprocessor"></span>    <a class="code" href="../../d1/d1/bench_8c.html#a16">CHAR</a> aChars[2];
00541 <span class="preprocessor">#endif // _USERK_</span>
00542 <span class="preprocessor"></span>
00543     <span class="comment">//</span>
00544     <span class="comment">// Early out for ASCII.</span>
00545     <span class="comment">//</span>
00546     <span class="keywordflow">if</span> (wChar &lt; 0x0080) {
00547         <span class="comment">//</span>
00548         <span class="comment">// if the character &lt; 0x0080, it should be a halfwidth character.</span>
00549         <span class="comment">//</span>
00550         <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00551     }
00552     <span class="comment">//</span>
00553     <span class="comment">// Scan FullWdith definition table... most of FullWidth character is</span>
00554     <span class="comment">// defined here... this is more faster than call NLS API.</span>
00555     <span class="comment">//</span>
00556     <span class="keywordflow">for</span> (index = 0; index &lt; <a class="code" href="../../d5/d2/rtl_2drawtext_8c.html#a23">NUM_FULLWIDTH_UNICODES</a>; index++) {
00557         <span class="keywordflow">if</span> ((wChar &gt;= <a class="code" href="../../d5/d2/rtl_2drawtext_8c.html#a33">FullWidthUnicodes</a>[index].<a class="code" href="../../d4/d1/struct__FULLWIDTH__UNICODE.html#o0">Start</a>) &amp;&amp;
00558             (wChar &lt;= <a class="code" href="../../d5/d2/rtl_2drawtext_8c.html#a33">FullWidthUnicodes</a>[index].<a class="code" href="../../d4/d1/struct__FULLWIDTH__UNICODE.html#o1">End</a>)      ) {
00559             <span class="keywordflow">return</span> (<a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00560         }
00561     }
00562     <span class="comment">//</span>
00563     <span class="comment">// if this Unicode character is mapped to Double-Byte character,</span>
00564     <span class="comment">// this is also FullWidth character..</span>
00565     <span class="comment">//</span>
00566 <span class="preprocessor">#ifdef _USERK_</span>
00567 <span class="preprocessor"></span>    cChars = EngWideCharToMultiByte((UINT)dwCodePage,&amp;wChar,<span class="keyword">sizeof</span>(WCHAR),aChars,<span class="keyword">sizeof</span>(aChars));
00568 <span class="preprocessor">#else</span>
00569 <span class="preprocessor"></span>    cChars = WideCharToMultiByte((UINT)dwCodePage,0,&amp;wChar,1,NULL,0,NULL,NULL);
00570 <span class="preprocessor">#endif // _USERK_</span>
00571 <span class="preprocessor"></span>
00572     <span class="keywordflow">return</span>(cChars &gt; 1 ? <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> : <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>);
00573 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a36" doxytag="rtl/drawtext.c::UserTextOutWInternal" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOL UserTextOutWInternal           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">HDC&nbsp;</td>
          <td class="mdname" nowrap> <em>hdc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>x</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>int&nbsp;</td>
          <td class="mdname" nowrap> <em>y</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LPCWSTR&nbsp;</td>
          <td class="mdname" nowrap> <em>lp</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>UINT&nbsp;</td>
          <td class="mdname" nowrap> <em>cc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="../../d0/d5/perfuser_8c.html#a6">DWORD</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>dwFlags</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00580">580</a> of file <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html">rtl/drawtext.c</a>.
<p>
References <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00057">BOOL</a>, <a class="el" href="../../d4/d7/propapi_8h-source.html#l00043">dwFlags</a>, and <a class="el" href="../../d7/d0/userrtl_8h-source.html#l00158">UserTextOutW</a>.
<p>
Referenced by <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l01090">DT_InitDrawTextInfo()</a>.
<p>
<pre class="fragment"><div>00587 {
00588     UNREFERENCED_PARAMETER(dwFlags);
00589     <span class="keywordflow">return</span> <a class="code" href="../../d6/d1/userrtl_8h.html#a23">UserTextOutW</a>(hdc, x, y, lp, cc);
00590 }
</div></pre>    </td>
  </tr>
</table>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="a26" doxytag="rtl/drawtext.c::aASCII_Latin1_EndBreak" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> CONST <a class="el" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a> <a class="el" href="../../d5/d2/rtl_2drawtext_8c.html#a26">aASCII_Latin1_EndBreak</a>[]          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Initial value:</b><pre class="fragment"><div> {

       1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 1, 0, 1, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 1, 1,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0,
    1, 0, 0, 0, 0, 0, 0, 1
}
</div></pre>
<p>
Definition at line <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00311">311</a> of file <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html">rtl/drawtext.c</a>.
<p>
Referenced by <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00416">UserIsFELineBreakEnd()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a28" doxytag="rtl/drawtext.c::aCJKSymbol_EndBreak" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> CONST <a class="el" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a> <a class="el" href="../../d5/d2/rtl_2drawtext_8c.html#a28">aCJKSymbol_EndBreak</a>[]          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Initial value:</b><pre class="fragment"><div> {

       1, 1, 1, 0, 1, 0, 0, 0, 1, 0, 1, 0, 1, 0, 1,
    0, 1, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 1
}
</div></pre>
<p>
Definition at line <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00332">332</a> of file <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html">rtl/drawtext.c</a>.
<p>
Referenced by <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00416">UserIsFELineBreakEnd()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a29" doxytag="rtl/drawtext.c::aCNS11643_SmallVariants_EndBreak" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> CONST <a class="el" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a> <a class="el" href="../../d5/d2/rtl_2drawtext_8c.html#a29">aCNS11643_SmallVariants_EndBreak</a>[]          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Initial value:</b><pre class="fragment"><div> {

    1, 1, 0, 1, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0,
    1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1,
    1, 1, 1, 0, 1, 1, 1, 1, 0, 0, 1, 0, 1, 0, 1
}
</div></pre>
<p>
Definition at line <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00338">338</a> of file <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html">rtl/drawtext.c</a>.
<p>
Referenced by <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00416">UserIsFELineBreakEnd()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a30" doxytag="rtl/drawtext.c::aFullWidthHalfWidthVariants_EndBreak" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> CONST <a class="el" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a> <a class="el" href="../../d5/d2/rtl_2drawtext_8c.html#a30">aFullWidthHalfWidthVariants_EndBreak</a>[]          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Initial value:</b><pre class="fragment"><div> {

       1, 1, 0, 0, 1, 0, 1, 0, 1, 0, 0, 1, 1, 1, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 1, 1,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0,
    0, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1
}
</div></pre>
<p>
Definition at line <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00345">345</a> of file <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html">rtl/drawtext.c</a>.
<p>
Referenced by <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00416">UserIsFELineBreakEnd()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a27" doxytag="rtl/drawtext.c::aGeneralPunctuation_EndBreak" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> CONST <a class="el" href="../../d9/d7/halvprnt_8c.html#a0">BYTE</a> <a class="el" href="../../d5/d2/rtl_2drawtext_8c.html#a27">aGeneralPunctuation_EndBreak</a>[]          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Initial value:</b><pre class="fragment"><div> {

             1, 1, 1, 1, 0, 1, 1, 0, 0, 0, 1, 0, 0,
    0, 0, 1, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 1, 1
}
</div></pre>
<p>
Definition at line <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00325">325</a> of file <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html">rtl/drawtext.c</a>.
<p>
Referenced by <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00416">UserIsFELineBreakEnd()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a33" doxytag="rtl/drawtext.c::FullWidthUnicodes" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> CONST <a class="el" href="../../d4/d1/struct__FULLWIDTH__UNICODE.html">FULLWIDTH_UNICODE</a> <a class="el" href="../../d5/d2/rtl_2drawtext_8c.html#a33">FullWidthUnicodes</a>[]          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<b>Initial value:</b><pre class="fragment"><div> {
   { 0x4E00, 0x9FFF }, 
   { 0x3040, 0x309F }, 
   { 0x30A0, 0x30FF }, 
   { 0xAC00, 0xD7A3 }  
}
</div></pre>
<p>
Definition at line <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00528">528</a> of file <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html">rtl/drawtext.c</a>.
<p>
Referenced by <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00535">UserIsFullWidth()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a25" doxytag="rtl/drawtext.c::ghdcBits2" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HDC <a class="el" href="../../d5/d2/rtl_2drawtext_8c.html#a25">ghdcBits2</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00063">63</a> of file <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html">rtl/drawtext.c</a>.
<p>
Referenced by <a class="el" href="../../d5/d8/clres_8c-source.html#l02950">BitmapFromDIB()</a>, <a class="el" href="../../d7/d7/clinit_8c-source.html#l01219">ClientThreadSetup()</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l04377">CopyBmp()</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l01307">CreateIconIndirect()</a>, <a class="el" href="../../d7/d7/clinit_8c-source.html#l01729">CtxInitUser32()</a>, <a class="el" href="../../d4/d7/client_8c-source.html#l01210">DrawIconEx()</a>, <a class="el" href="../../d0/d2/mngrayc_8c-source.html#l00075">DrawStateW()</a>, <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l01090">DT_InitDrawTextInfo()</a>, <a class="el" href="../../d5/d8/clres_8c-source.html#l01899">LoadBmp()</a>, and <a class="el" href="../../d6/d4/statctl_8c-source.html#l00419">xxxStaticPaint()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a24" doxytag="rtl/drawtext.c::szEllipsis" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> CONST WCHAR <a class="el" href="../../d5/d2/rtl_2drawtext_8c.html#a24">szEllipsis</a>[CCHELLIPSIS+1] = TEXT("...")<code> [static]</code>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l00061">61</a> of file <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html">rtl/drawtext.c</a>.
<p>
Referenced by <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l01604">AddEllipsisAndDrawLine()</a>, <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l01533">AddPathEllipsis()</a>, and <a class="el" href="../../d6/d1/rtl_2drawtext_8c-source.html#l01424">NeedsEndEllipsis()</a>.    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:43:29 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
