<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: i386.h File Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>i386.h File Reference</h1>
<p>
<a href="../../d6/d2/i386_8h-source.html">Go to the source code of this file.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d3/i386_8h.html#a0">KF_V86_VIS</a>&nbsp;&nbsp;&nbsp;0x00000001</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d3/i386_8h.html#a1">KF_RDTSC</a>&nbsp;&nbsp;&nbsp;0x00000002</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d3/i386_8h.html#a2">KF_CR4</a>&nbsp;&nbsp;&nbsp;0x00000004</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d3/i386_8h.html#a3">KF_CMOV</a>&nbsp;&nbsp;&nbsp;0x00000008</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d3/i386_8h.html#a4">KF_GLOBAL_PAGE</a>&nbsp;&nbsp;&nbsp;0x00000010</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d3/i386_8h.html#a5">KF_LARGE_PAGE</a>&nbsp;&nbsp;&nbsp;0x00000020</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d3/i386_8h.html#a6">KF_MTRR</a>&nbsp;&nbsp;&nbsp;0x00000040</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d3/i386_8h.html#a7">KF_CMPXCHG8B</a>&nbsp;&nbsp;&nbsp;0x00000080</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d3/i386_8h.html#a8">KF_MMX</a>&nbsp;&nbsp;&nbsp;0x00000100</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d3/i386_8h.html#a9">KF_WORKING_PTE</a>&nbsp;&nbsp;&nbsp;0x00000200</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d3/i386_8h.html#a10">KF_PAT</a>&nbsp;&nbsp;&nbsp;0x00000400</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d3/i386_8h.html#a11">KF_FXSR</a>&nbsp;&nbsp;&nbsp;0x00000800</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d3/i386_8h.html#a12">KF_FAST_SYSCALL</a>&nbsp;&nbsp;&nbsp;0x00001000</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d3/i386_8h.html#a13">KF_XMMI</a>&nbsp;&nbsp;&nbsp;0x00002000</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d3/i386_8h.html#a14">KF_3DNOW</a>&nbsp;&nbsp;&nbsp;0x00004000</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d3/i386_8h.html#a15">KF_AMDK6MTRR</a>&nbsp;&nbsp;&nbsp;0x00008000</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d3/i386_8h.html#a16">Isx86FeaturePresent</a>(_f_)&nbsp;&nbsp;&nbsp;((<a class="el" href="../../d7/d3/i386init_8c.html#a8">KiBootFeatureBits</a> &amp; (_f_)) != 0)</td></tr>

<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d3/i386_8h.html#a26">Ke386SetLdtProcess</a> (struct <a class="el" href="../../d5/d7/struct__KPROCESS.html">_KPROCESS</a> *Process, PLDT_ENTRY Ldt, ULONG Limit)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d3/i386_8h.html#a27">Ke386SetDescriptorProcess</a> (struct <a class="el" href="../../d5/d7/struct__KPROCESS.html">_KPROCESS</a> *Process, ULONG <a class="el" href="../../d4/d9/heapdbg_8c.html#a3">Offset</a>, LDT_ENTRY LdtEntry)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d3/i386_8h.html#a28">Ke386GetGdtEntryThread</a> (struct <a class="el" href="../../d1/d8/struct__KTHREAD.html">_KTHREAD</a> *Thread, ULONG <a class="el" href="../../d4/d9/heapdbg_8c.html#a3">Offset</a>, PKGDTENTRY Descriptor)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d3/i386_8h.html#a29">Ke386SetIoAccessMap</a> (ULONG MapNumber, PKIO_ACCESS_MAP IoAccessMap)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d3/i386_8h.html#a30">Ke386QueryIoAccessMap</a> (ULONG MapNumber, PKIO_ACCESS_MAP IoAccessMap)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d3/i386_8h.html#a31">Ke386IoSetAccessProcess</a> (struct <a class="el" href="../../d5/d7/struct__KPROCESS.html">_KPROCESS</a> *Process, ULONG MapNumber)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d3/i386_8h.html#a32">Ke386SetIOPL</a> (struct <a class="el" href="../../d5/d7/struct__KPROCESS.html">_KPROCESS</a> *Process)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d3/i386_8h.html#a33">Ke386CallBios</a> (IN ULONG BiosCommand, IN OUT PCONTEXT BiosArguments)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d3/i386_8h.html#a34">KiEditIopmDpc</a> (IN struct <a class="el" href="../../d1/d6/struct__KDPC.html">_KDPC</a> *Dpc, IN PVOID DeferredContext, IN PVOID SystemArgument1, IN PVOID SystemArgument2)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d3/i386_8h.html#a35">Ki386GetSelectorParameters</a> (IN <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a14">USHORT</a> Selector, OUT PULONG Flags, OUT PULONG Base, OUT PULONG Limit)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d3/i386_8h.html#a36">Ke386SetVdmInterruptHandler</a> (IN struct <a class="el" href="../../d5/d7/struct__KPROCESS.html">_KPROCESS</a> *Process, IN ULONG Interrupt, IN <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a14">USHORT</a> Selector, IN ULONG <a class="el" href="../../d4/d9/heapdbg_8c.html#a3">Offset</a>, IN BOOLEAN Gate32)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d3/i386_8h.html#a37">KeI386GetLid</a> (IN <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a14">USHORT</a> DeviceId, IN <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a14">USHORT</a> RelativeLid, IN BOOLEAN SharedLid, IN struct <a class="el" href="../../d4/d9/struct__DRIVER__OBJECT.html">_DRIVER_OBJECT</a> *DeviceObject, OUT <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a22">PUSHORT</a> LogicalId)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d3/i386_8h.html#a38">KeI386ReleaseLid</a> (IN <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a14">USHORT</a> LogicalId, IN struct <a class="el" href="../../d4/d9/struct__DRIVER__OBJECT.html">_DRIVER_OBJECT</a> *DeviceObject)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d3/i386_8h.html#a39">KeI386AbiosCall</a> (IN <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a14">USHORT</a> LogicalId, IN struct <a class="el" href="../../d4/d9/struct__DRIVER__OBJECT.html">_DRIVER_OBJECT</a> *DriverObject, IN PUCHAR RequestBlock, IN <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a14">USHORT</a> EntryPoint)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d3/i386_8h.html#a40">KeI386AllocateGdtSelectors</a> (OUT <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a22">PUSHORT</a> SelectorArray, IN <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a14">USHORT</a> NumberOfSelectors)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d3/i386_8h.html#a41">KeI386Call16BitFunction</a> (IN OUT PCONTEXT Regs)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a14">USHORT</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d3/i386_8h.html#a42">KeI386Call16BitCStyleFunction</a> (IN ULONG EntryOffset, IN ULONG EntrySelector, IN PUCHAR Parameters, IN ULONG <a class="el" href="../../d9/d7/w98_2lh__open_2pi__mem_8h.html#a0">Size</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d3/i386_8h.html#a43">KeI386FlatToGdtSelector</a> (IN ULONG SelectorBase, IN <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a14">USHORT</a> Length, IN <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a14">USHORT</a> Selector)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d3/i386_8h.html#a44">KeI386ReleaseGdtSelectors</a> (OUT <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a22">PUSHORT</a> SelectorArray, IN <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a14">USHORT</a> NumberOfSelectors)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>NTSTATUS&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d3/i386_8h.html#a45">KeI386SetGdtSelector</a> (ULONG Selector, PKGDTENTRY GdtValue)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d3/i386_8h.html#a46">KeOptimizeProcessorControlState</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d3/i386_8h.html#a47">Ke386VdmInsertQueueApc</a> (IN <a class="el" href="../../d1/d5/struct__KAPC.html">PKAPC</a> Apc, IN struct <a class="el" href="../../d1/d8/struct__KTHREAD.html">_KTHREAD</a> *Thread, IN <a class="el" href="../../d0/d9/ntosdef_8h.html#a39">KPROCESSOR_MODE</a> ApcMode, IN <a class="el" href="../../d0/d9/ntosdef_8h.html#a42">PKKERNEL_ROUTINE</a> KernelRoutine, IN <a class="el" href="../../d0/d9/ntosdef_8h.html#a43">PKRUNDOWN_ROUTINE</a> RundownRoutine OPTIONAL, IN <a class="el" href="../../d0/d9/ntosdef_8h.html#a41">PKNORMAL_ROUTINE</a> NormalRoutine OPTIONAL, IN PVOID NormalContext OPTIONAL, IN KPRIORITY Increment)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d3/i386_8h.html#a48">Ke386VdmClearApcObject</a> (IN <a class="el" href="../../d1/d5/struct__KAPC.html">PKAPC</a> Apc)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d3/i386_8h.html#a49">KeI386VdmInitialize</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d3/i386_8h.html#a50">CPUID</a> (ULONG InEax, PULONG OutEax, PULONG OutEbx, PULONG OutEcx, PULONG OutEdx)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>LONGLONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d3/i386_8h.html#a51">RDTSC</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONGLONG FASTCALL&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d3/i386_8h.html#a52">RDMSR</a> (IN ULONG MsrRegister)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d3/i386_8h.html#a53">WRMSR</a> (IN ULONG MsrRegister, IN ULONGLONG MsrValue)</td></tr>

<tr><td colspan=2><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d3/i386_8h.html#a17">KeI386EFlagsAndMaskV86</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d3/i386_8h.html#a18">KeI386EFlagsOrMaskV86</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d3/i386_8h.html#a19">KeI386VdmIoplAllowed</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d3/i386_8h.html#a20">KeI386VirtualIntExtensions</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d3/i386_8h.html#a21">KeI386CpuType</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d3/i386_8h.html#a22">KeI386CpuStep</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d3/i386_8h.html#a23">KeI386NpxPresent</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d3/i386_8h.html#a24">KeI386FxsrPresent</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>ULONG&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d3/i386_8h.html#a25">KiBootFeatureBits</a></td></tr>

</table>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="a16" doxytag="i386.h::Isx86FeaturePresent" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define Isx86FeaturePresent          </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">_f_&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>&nbsp;&nbsp;&nbsp;((<a class="el" href="../../d7/d3/i386init_8c.html#a8">KiBootFeatureBits</a> &amp; (_f_)) != 0)</td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d2/i386_8h-source.html#l02725">2725</a> of file <a class="el" href="../../d6/d2/i386_8h-source.html">i386.h</a>.
<p>
Referenced by <a class="el" href="../../d0/d5/ex_2lookasid_8c-source.html#l00681">ExAllocateFromPagedLookasideList()</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l01104">ExAllocatePoolWithTag()</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l02760">ExFreePoolWithTag()</a>, and <a class="el" href="../../d0/d5/ex_2lookasid_8c-source.html#l00741">ExFreeToPagedLookasideList()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a14" doxytag="i386.h::KF_3DNOW" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define KF_3DNOW&nbsp;&nbsp;&nbsp;0x00004000          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d2/i386_8h-source.html#l02716">2716</a> of file <a class="el" href="../../d6/d2/i386_8h-source.html">i386.h</a>.
<p>
Referenced by <a class="el" href="../../d7/d8/kernlini_8c-source.html#l00246">KiInitializeKernel()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a15" doxytag="i386.h::KF_AMDK6MTRR" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define KF_AMDK6MTRR&nbsp;&nbsp;&nbsp;0x00008000          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d2/i386_8h-source.html#l02717">2717</a> of file <a class="el" href="../../d6/d2/i386_8h-source.html">i386.h</a>.
<p>
Referenced by <a class="el" href="../../d9/d3/mtrr_8c-source.html#l00526">KeRestoreMtrr()</a>, <a class="el" href="../../d9/d3/mtrr_8c-source.html#l00576">KeSetPhysicalCacheTypeRange()</a>, <a class="el" href="../../d7/d8/kernlini_8c-source.html#l01691">KiInitMachineDependent()</a>, and <a class="el" href="../../d9/d3/mtrr_8c-source.html#l01796">KiLoadMTRR()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="i386.h::KF_CMOV" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define KF_CMOV&nbsp;&nbsp;&nbsp;0x00000008          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d2/i386_8h-source.html#l02705">2705</a> of file <a class="el" href="../../d6/d2/i386_8h-source.html">i386.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a7" doxytag="i386.h::KF_CMPXCHG8B" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define KF_CMPXCHG8B&nbsp;&nbsp;&nbsp;0x00000080          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d2/i386_8h-source.html#l02709">2709</a> of file <a class="el" href="../../d6/d2/i386_8h-source.html">i386.h</a>.
<p>
Referenced by <a class="el" href="../../d0/d5/ex_2lookasid_8c-source.html#l00681">ExAllocateFromPagedLookasideList()</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l01104">ExAllocatePoolWithTag()</a>, <a class="el" href="../../d3/d1/ex_2pool_8c-source.html#l02760">ExFreePoolWithTag()</a>, <a class="el" href="../../d0/d5/ex_2lookasid_8c-source.html#l00741">ExFreeToPagedLookasideList()</a>, and <a class="el" href="../../d7/d8/kernlini_8c-source.html#l00246">KiInitializeKernel()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a2" doxytag="i386.h::KF_CR4" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define KF_CR4&nbsp;&nbsp;&nbsp;0x00000004          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d2/i386_8h-source.html#l02704">2704</a> of file <a class="el" href="../../d6/d2/i386_8h-source.html">i386.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a12" doxytag="i386.h::KF_FAST_SYSCALL" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define KF_FAST_SYSCALL&nbsp;&nbsp;&nbsp;0x00001000          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d2/i386_8h-source.html#l02714">2714</a> of file <a class="el" href="../../d6/d2/i386_8h-source.html">i386.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a11" doxytag="i386.h::KF_FXSR" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define KF_FXSR&nbsp;&nbsp;&nbsp;0x00000800          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d2/i386_8h-source.html#l02713">2713</a> of file <a class="el" href="../../d6/d2/i386_8h-source.html">i386.h</a>.
<p>
Referenced by <a class="el" href="../../d7/d8/kernlini_8c-source.html#l02008">KeSetup80387OrEmulate()</a>, <a class="el" href="../../d7/d8/kernlini_8c-source.html#l00246">KiInitializeKernel()</a>, and <a class="el" href="../../d7/d8/kernlini_8c-source.html#l01691">KiInitMachineDependent()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a4" doxytag="i386.h::KF_GLOBAL_PAGE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define KF_GLOBAL_PAGE&nbsp;&nbsp;&nbsp;0x00000010          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d2/i386_8h-source.html#l02706">2706</a> of file <a class="el" href="../../d6/d2/i386_8h-source.html">i386.h</a>.
<p>
Referenced by <a class="el" href="../../d7/d8/kernlini_8c-source.html#l00246">KiInitializeKernel()</a>, <a class="el" href="../../d7/d8/kernlini_8c-source.html#l01691">KiInitMachineDependent()</a>, and <a class="el" href="../../d2/d1/mm_2i386_2init386_8c-source.html#l00058">MiInitMachineDependent()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a5" doxytag="i386.h::KF_LARGE_PAGE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define KF_LARGE_PAGE&nbsp;&nbsp;&nbsp;0x00000020          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d2/i386_8h-source.html#l02707">2707</a> of file <a class="el" href="../../d6/d2/i386_8h-source.html">i386.h</a>.
<p>
Referenced by <a class="el" href="../../d7/d8/kernlini_8c-source.html#l01691">KiInitMachineDependent()</a>, and <a class="el" href="../../d2/d1/mm_2i386_2init386_8c-source.html#l00058">MiInitMachineDependent()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a8" doxytag="i386.h::KF_MMX" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define KF_MMX&nbsp;&nbsp;&nbsp;0x00000100          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d2/i386_8h-source.html#l02710">2710</a> of file <a class="el" href="../../d6/d2/i386_8h-source.html">i386.h</a>.
<p>
Referenced by <a class="el" href="../../d7/d8/kernlini_8c-source.html#l02008">KeSetup80387OrEmulate()</a>, and <a class="el" href="../../d7/d8/kernlini_8c-source.html#l00246">KiInitializeKernel()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a6" doxytag="i386.h::KF_MTRR" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define KF_MTRR&nbsp;&nbsp;&nbsp;0x00000040          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d2/i386_8h-source.html#l02708">2708</a> of file <a class="el" href="../../d6/d2/i386_8h-source.html">i386.h</a>.
<p>
Referenced by <a class="el" href="../../d7/d8/kernlini_8c-source.html#l00246">KiInitializeKernel()</a>, <a class="el" href="../../d9/d3/mtrr_8c-source.html#l00275">KiInitializeMTRR()</a>, and <a class="el" href="../../d7/d8/kernlini_8c-source.html#l01691">KiInitMachineDependent()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a10" doxytag="i386.h::KF_PAT" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define KF_PAT&nbsp;&nbsp;&nbsp;0x00000400          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d2/i386_8h-source.html#l02712">2712</a> of file <a class="el" href="../../d6/d2/i386_8h-source.html">i386.h</a>.
<p>
Referenced by <a class="el" href="../../d0/d3/pat_8c-source.html#l00094">KeRestorePAT()</a>, <a class="el" href="../../d7/d8/kernlini_8c-source.html#l00246">KiInitializeKernel()</a>, <a class="el" href="../../d0/d3/pat_8c-source.html#l00119">KiInitializePAT()</a>, <a class="el" href="../../d7/d8/kernlini_8c-source.html#l01691">KiInitMachineDependent()</a>, and <a class="el" href="../../d6/d5/iosup_8c-source.html#l03415">MmMapIoSpace()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="i386.h::KF_RDTSC" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define KF_RDTSC&nbsp;&nbsp;&nbsp;0x00000002          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d2/i386_8h-source.html#l02703">2703</a> of file <a class="el" href="../../d6/d2/i386_8h-source.html">i386.h</a>.
<p>
Referenced by <a class="el" href="../../d7/d8/kernlini_8c-source.html#l00246">KiInitializeKernel()</a>, and <a class="el" href="../../d7/d8/kernlini_8c-source.html#l01691">KiInitMachineDependent()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a0" doxytag="i386.h::KF_V86_VIS" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define KF_V86_VIS&nbsp;&nbsp;&nbsp;0x00000001          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d2/i386_8h-source.html#l02702">2702</a> of file <a class="el" href="../../d6/d2/i386_8h-source.html">i386.h</a>.
<p>
Referenced by <a class="el" href="../../d0/d3/ke_2i386_2vdm_8c-source.html#l01088">KeI386VdmInitialize()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a9" doxytag="i386.h::KF_WORKING_PTE" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define KF_WORKING_PTE&nbsp;&nbsp;&nbsp;0x00000200          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d2/i386_8h-source.html#l02711">2711</a> of file <a class="el" href="../../d6/d2/i386_8h-source.html">i386.h</a>.
<p>
Referenced by <a class="el" href="../../d7/d8/kernlini_8c-source.html#l01691">KiInitMachineDependent()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a13" doxytag="i386.h::KF_XMMI" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define KF_XMMI&nbsp;&nbsp;&nbsp;0x00002000          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d2/i386_8h-source.html#l02715">2715</a> of file <a class="el" href="../../d6/d2/i386_8h-source.html">i386.h</a>.
<p>
Referenced by <a class="el" href="../../d7/d8/kernlini_8c-source.html#l02008">KeSetup80387OrEmulate()</a>, <a class="el" href="../../d7/d8/kernlini_8c-source.html#l00246">KiInitializeKernel()</a>, and <a class="el" href="../../d7/d8/kernlini_8c-source.html#l01691">KiInitMachineDependent()</a>.    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a50" doxytag="i386.h::CPUID" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID CPUID           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>InEax</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>PULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>OutEax</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>PULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>OutEbx</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>PULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>OutEcx</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>PULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>OutEdx</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d0/d1/config_2i386_2init386_8c-source.html#l00465">CmpInitializeMachineDependentConfiguration()</a>, <a class="el" href="../../d7/d8/kernlini_8c-source.html#l01509">KiGetCacheInformation()</a>, <a class="el" href="../../d7/d8/kernlini_8c-source.html#l01110">KiGetCpuVendor()</a>, and <a class="el" href="../../d7/d8/kernlini_8c-source.html#l01691">KiInitMachineDependent()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a33" doxytag="i386.h::Ke386CallBios" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS Ke386CallBios           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>BiosCommand</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN OUT PCONTEXT&nbsp;</td>
          <td class="mdname" nowrap> <em>BiosArguments</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d0/biosc_8c-source.html#l00060">60</a> of file <a class="el" href="../../d4/d0/biosc_8c-source.html">biosc.c</a>.
<p>
References <a class="el" href="../../d5/d8/ke_8h-source.html#l00575">_KTHREAD::ApcState</a>, <a class="el" href="../../d7/d4/ntgdi_2icm_2inc_2debug_8h-source.html#l00146">ASSERT</a>, <a class="el" href="../../d4/d0/biosc_8c-source.html#l00052">BiosInitialized</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00239">CONTEXT_FULL</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l00253">ExAllocatePoolWithTag</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00055">EXCEPTION_EXECUTE_HANDLER</a>, <a class="el" href="../../d7/d2/cmwraper_8c-source.html#l00304">ExFreePool()</a>, <a class="el" href="../../d4/d0/biosc_8c-source.html#l00045">INT_10_TEB</a>, <a class="el" href="../../d4/d0/biosc_8c-source.html#l00040">INT_OPCODE</a>, <a class="el" href="../../d4/d0/biosc_8c-source.html#l00043">IOPM_OFFSET</a>, <a class="el" href="../../d3/d6/alpha_2kdpcpu_8h-source.html#l00070">KeGetCurrentThread</a>, <a class="el" href="../../d3/d6/alpha_2kdpcpu_8h-source.html#l00068">KeGetPcr</a>, <a class="el" href="../../d0/d1/thredobj_8c-source.html#l01153">KeRevertToUserAffinityThread()</a>, <a class="el" href="../../d0/d1/thredobj_8c-source.html#l01467">KeSetSystemAffinityThread()</a>, <a class="el" href="../../d4/d0/biosc_8c-source.html#l00051">Ki386IopmSaveArea</a>, <a class="el" href="../../d3/d1/biosc_8c.html#a9">Ki386SetupAndExitToV86Code()</a>, <a class="el" href="../../d5/d8/ex_8h.html#a329a173">NonPagedPool</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00599">PAGE_SIZE</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l00244">_KAPC_STATE::Process</a>, <a class="el" href="../../d2/d8/ps_8h-source.html#l00643">PsGetCurrentProcess</a>, <a class="el" href="../../d2/d5/ke_2i386_2vdmp_8h.html#a24">PVDM_TIB</a>, <a class="el" href="../../d3/d4/ke_2i386_2vdmp_8h-source.html#l00054">_Vdm_Tib::Size</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00135">Status</a>, <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00064">USHORT</a>, <a class="el" href="../../d4/d0/biosc_8c-source.html#l00041">V86_BOP_OPCODE</a>, <a class="el" href="../../d4/d0/biosc_8c-source.html#l00039">V86_CODE_ADDRESS</a>, <a class="el" href="../../d2/d5/ke_2i386_2vdmp_8h.html#a23">VDM_TIB</a>, <a class="el" href="../../d4/d0/biosc_8c-source.html#l00044">VDM_TIB_ADDRESS</a>, and <a class="el" href="../../d3/d4/ke_2i386_2vdmp_8h-source.html#l00058">_Vdm_Tib::VdmContext</a>.
<p>
<pre class="fragment"><div>00067                    :
00068 
00069     This function invokes specified ROM BIOS code by executing
00070     <span class="stringliteral">"INT BiosCommand."</span>  Before executing <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> BIOS code, <span class="keyword">this</span> function
00071     will setup VDM context, change stack pointer ...etc.  If <span class="keywordflow">for</span> some <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a10">reason</a>
00072     <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> operation fails, a status code will be returned.  Otherwise, <span class="keyword">this</span>
00073     function always returns success reguardless of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> result of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> BIOS
00074     call.
00075 
00076     N.B. This implementation relies on <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> fact that <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> direct
00077          I/O access operations between apps are serialized by win user.
00078 
00079 Arguments:
00080 
00081     BiosCommand - specifies which ROM BIOS function to invoke.
00082 
00083     BiosArguments - specifies a pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> context which will be used
00084                   to invoke ROM BIOS.
00085 
00086 Return Value:
00087 
00088     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> code to specify <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d8/d0/rtbatcr_8c.html#a1">failure</a>.
00089 
00090 --*/
00091 
00092 {
00093 
00094     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = STATUS_SUCCESS;
00095     <a class="code" href="../../d0/d6/struct__Vdm__Tib.html">PVDM_TIB</a> VdmTib;
00096     PUCHAR BaseAddress = (PUCHAR)<a class="code" href="../../d3/d1/biosc_8c.html#a0">V86_CODE_ADDRESS</a>;
00097     PTEB UserInt10Teb = (PTEB)<a class="code" href="../../d3/d1/biosc_8c.html#a6">INT_10_TEB</a>;
00098     PKTSS Tss;
00099     <a class="code" href="../../d5/d7/struct__KPROCESS.html">PKPROCESS</a> Process;
00100     <a class="code" href="../../d1/d8/struct__KTHREAD.html">PKTHREAD</a> Thread;
00101     <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a> OldIopmOffset, OldIoMapBase;
00102     PVDM_PROCESS_OBJECTS VdmObjects;
00103     ULONG   ContextLength;
00104 
00105 <span class="comment">//  KIRQL OldIrql;</span>
00106 <span class="comment">//#if DBG</span>
00107 <span class="comment">//    PULONG IdtAddress;</span>
00108 <span class="comment">//    ULONG RegionSize;</span>
00109 <span class="comment">//    ULONG OldProtect;</span>
00110 <span class="comment">//#endif</span>
00111 
00112     <span class="comment">//</span>
00113     <span class="comment">// Map in ROM BIOS area to perform the int 10 code</span>
00114     <span class="comment">//</span>
00115 
00116     <span class="keywordflow">if</span> (!<a class="code" href="../../d3/d1/biosc_8c.html#a8">BiosInitialized</a>) {
00117         RtlZeroMemory(UserInt10Teb, <span class="keyword">sizeof</span>(TEB));
00118     }
00119 
00120 <span class="comment">//#if DBG</span>
00121 <span class="comment">//    IdtAddress = 0;</span>
00122 <span class="comment">//    RegionSize = 0x1000;</span>
00123 <span class="comment">//    ZwProtectVirtualMemory ( NtCurrentProcess(),</span>
00124 <span class="comment">//                             &amp;IdtAddress,</span>
00125 <span class="comment">//                             &amp;RegionSize,</span>
00126 <span class="comment">//                             PAGE_READWRITE,</span>
00127 <span class="comment">//                             &amp;OldProtect</span>
00128 <span class="comment">//                             );</span>
00129 <span class="comment">//#endif</span>
00130 
00131     <span class="keywordflow">try</span> {
00132 
00133         <span class="comment">//</span>
00134         <span class="comment">// Write "Int BiosCommand; bop" to reserved user space (0x1000).</span>
00135         <span class="comment">// Later control will transfer to the user space to execute</span>
00136         <span class="comment">// these two instructions.</span>
00137         <span class="comment">//</span>
00138 
00139         *BaseAddress++ = <a class="code" href="../../d3/d1/biosc_8c.html#a1">INT_OPCODE</a>;
00140         *BaseAddress++ = (UCHAR)BiosCommand;
00141         *(PULONG)BaseAddress = <a class="code" href="../../d3/d1/biosc_8c.html#a2">V86_BOP_OPCODE</a>;
00142 
00143         <span class="comment">//</span>
00144         <span class="comment">// Set up Vdm(v86) context to execute the int BiosCommand</span>
00145         <span class="comment">// instruction by copying user supplied context to VdmContext</span>
00146         <span class="comment">// and updating the control registers to predefined values.</span>
00147         <span class="comment">//</span>
00148 
00149         <span class="comment">//</span>
00150         <span class="comment">// We want to use a constant number for the int10.</span>
00151         <span class="comment">//</span>
00152         <span class="comment">//</span>
00153         <span class="comment">// Create a fake TEB so we can switch the thread to it while we</span>
00154         <span class="comment">// do an int10</span>
00155         <span class="comment">//</span>
00156 
00157         UserInt10Teb-&gt;Vdm = (PVOID)<a class="code" href="../../d3/d1/biosc_8c.html#a5">VDM_TIB_ADDRESS</a>;
00158         VdmTib = (<a class="code" href="../../d0/d6/struct__Vdm__Tib.html">PVDM_TIB</a>)<a class="code" href="../../d3/d1/biosc_8c.html#a5">VDM_TIB_ADDRESS</a>;
00159         RtlZeroMemory(VdmTib, <span class="keyword">sizeof</span>(<a class="code" href="../../d0/d6/struct__Vdm__Tib.html">VDM_TIB</a>));
00160         VdmTib-&gt;<a class="code" href="../../d0/d6/struct__Vdm__Tib.html#o0">Size</a> = <span class="keyword">sizeof</span>(<a class="code" href="../../d0/d6/struct__Vdm__Tib.html">VDM_TIB</a>);
00161         *pNtVDMState = 0;
00162 
00163         <span class="comment">//</span>
00164         <span class="comment">// extended registers are never going to matter to</span>
00165         <span class="comment">//  an Int10 call, so only copy the old part of the</span>
00166         <span class="comment">//  context record.</span>
00167         <span class="comment">//</span>
00168         ContextLength = FIELD_OFFSET(CONTEXT, ExtendedRegisters);
00169         RtlMoveMemory(&amp;(VdmTib-&gt;<a class="code" href="../../d0/d6/struct__Vdm__Tib.html#o4">VdmContext</a>), BiosArguments,  ContextLength);
00170         VdmTib-&gt;<a class="code" href="../../d0/d6/struct__Vdm__Tib.html#o4">VdmContext</a>.SegCs = (ULONG)BaseAddress &gt;&gt; 4;
00171         VdmTib-&gt;<a class="code" href="../../d0/d6/struct__Vdm__Tib.html#o4">VdmContext</a>.SegSs = (ULONG)BaseAddress &gt;&gt; 4;
00172         VdmTib-&gt;<a class="code" href="../../d0/d6/struct__Vdm__Tib.html#o4">VdmContext</a>.Eip = 0;
00173         VdmTib-&gt;<a class="code" href="../../d0/d6/struct__Vdm__Tib.html#o4">VdmContext</a>.Esp = 2 * <a class="code" href="../../d6/d7/halmips_8h.html#a446">PAGE_SIZE</a> - <span class="keyword">sizeof</span>(ULONG);
00174         VdmTib-&gt;<a class="code" href="../../d0/d6/struct__Vdm__Tib.html#o4">VdmContext</a>.EFlags |= EFLAGS_V86_MASK | EFLAGS_INTERRUPT_MASK;
00175         VdmTib-&gt;<a class="code" href="../../d0/d6/struct__Vdm__Tib.html#o4">VdmContext</a>.ContextFlags = <a class="code" href="../../d6/d7/halmips_8h.html#a152">CONTEXT_FULL</a>;
00176 
00177     } except (EXCEPTION_EXECUTE_HANDLER) {
00178 
00179         <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = GetExceptionCode();
00180     }
00181 
00182     <span class="comment">//</span>
00183     <span class="comment">// The vdm kernel code finds the Tib by looking at a pointer cached in</span>
00184     <span class="comment">// kernel memory, which was probed at Vdm creation time.  Since the</span>
00185     <span class="comment">// creation semantics for this vdm are peculiar, we do something similar</span>
00186     <span class="comment">// here.</span>
00187     <span class="comment">//</span>
00188 
00189     <span class="keywordflow">try</span> {
00190 
00191         <span class="comment">//</span>
00192         <span class="comment">// We never get here on a process that is a real vdm.  If we do,</span>
00193         <span class="comment">// bad things will happen  (pool leak, failure to execute dos and windows apps)</span>
00194         <span class="comment">//</span>
00195         <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(<a class="code" href="../../d1/d9/ps_8h.html#a19">PsGetCurrentProcess</a>()-&gt;VdmObjects == NULL);
00196         VdmObjects = <a class="code" href="../../d5/d8/ex_8h.html#a4">ExAllocatePoolWithTag</a>(
00197             NonPagedPool,
00198             <span class="keyword">sizeof</span>(VDM_PROCESS_OBJECTS),
00199             '  eK'
00200             );
00201 
00202 
00203         <span class="comment">//</span>
00204         <span class="comment">// Since we are doing this on behalf of CSR not a user process, we aren't</span>
00205         <span class="comment">// charging quota.</span>
00206         <span class="comment">//</span>
00207         <span class="keywordflow">if</span> (VdmObjects == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00208             <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = STATUS_NO_MEMORY;
00209         } <span class="keywordflow">else</span> {
00210 
00211             <span class="comment">//</span>
00212             <span class="comment">// We are only initializing the VdmTib pointer, because that's the only</span>
00213             <span class="comment">// part of the VdmObjects we use for ROM calls.  We aren't set up</span>
00214             <span class="comment">// to simulate interrupts, or any of the other stuff that would be done</span>
00215             <span class="comment">// in a conventional vdm</span>
00216             <span class="comment">//</span>
00217             RtlZeroMemory( VdmObjects, <span class="keyword">sizeof</span>(VDM_PROCESS_OBJECTS));
00218 
00219             VdmObjects-&gt;VdmTib = VdmTib;
00220 
00221             <a class="code" href="../../d1/d9/ps_8h.html#a19">PsGetCurrentProcess</a>()-&gt;VdmObjects = VdmObjects;
00222         }
00223     }  except (EXCEPTION_EXECUTE_HANDLER) {
00224 
00225         <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = GetExceptionCode();
00226     }
00227 
00228     <span class="keywordflow">if</span> (<a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> == STATUS_SUCCESS) {
00229 
00230         <span class="comment">//</span>
00231         <span class="comment">// Since we are going to v86 mode and accessing some I/O ports, we</span>
00232         <span class="comment">// need to make sure the IopmOffset is set correctly across context</span>
00233         <span class="comment">// swap and the I/O bit map has all the bits cleared.</span>
00234         <span class="comment">// N.B.  This implementation assumes that there is only one full</span>
00235         <span class="comment">//       screen DOS app and the io access between full screen DOS</span>
00236         <span class="comment">//       app and the server code is serialized by win user.  That</span>
00237         <span class="comment">//       means even we change the IOPM, the full screen dos app won't</span>
00238         <span class="comment">//       be able to run on this IOPM.</span>
00239         <span class="comment">//     * In another words, IF THERE IS</span>
00240         <span class="comment">//     * MORE THAN ONE FULL SCREEN DOS APPS, THIS CODE IS BROKEN.*</span>
00241         <span class="comment">//</span>
00242         <span class="comment">// NOTE This code works on the assumption that winuser serializes</span>
00243         <span class="comment">//      direct I/O access operations.</span>
00244         <span class="comment">//</span>
00245 
00246         <span class="comment">//</span>
00247         <span class="comment">// Call the bios from the processor which booted the machine.</span>
00248         <span class="comment">//</span>
00249 
00250         Thread = <a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a3">KeGetCurrentThread</a>();
00251         <a class="code" href="../../d9/d1/thredobj_8c.html#a19">KeSetSystemAffinityThread</a>(1);
00252         Tss = <a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a1">KeGetPcr</a>()-&gt;TSS;
00253 
00254         <span class="comment">//</span>
00255         <span class="comment">// Save away the original IOPM bit map and clear all the IOPM bits</span>
00256         <span class="comment">// to allow v86 int 10 code to access ALL the io ports.</span>
00257         <span class="comment">//</span>
00258 
00259         <span class="comment">//</span>
00260         <span class="comment">// Make sure there are at least 2 IOPM maps.</span>
00261         <span class="comment">//</span>
00262 
00263         <a class="code" href="../../d6/d5/ntgdi_2icm_2inc_2debug_8h.html#a7">ASSERT</a>(<a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a1">KeGetPcr</a>()-&gt;GDT[KGDT_TSS / 8].LimitLow &gt;= (0x2000 + IOPM_OFFSET - 1));
00264         RtlMoveMemory (Ki386IopmSaveArea,
00265                        (PVOID)&amp;Tss-&gt;IoMaps[0].IoMap,
00266                        PAGE_SIZE * 2
00267                        );
00268         RtlZeroMemory ((PVOID)&amp;Tss-&gt;IoMaps[0].IoMap, PAGE_SIZE * 2);
00269 
00270         Process = Thread-&gt;<a class="code" href="../../d1/d8/struct__KTHREAD.html#o14">ApcState</a>.<a class="code" href="../../d3/d5/struct__KAPC__STATE.html#o1">Process</a>;
00271         OldIopmOffset = Process-&gt;IopmOffset;
00272         OldIoMapBase = Tss-&gt;IoMapBase;
00273         Process-&gt;IopmOffset = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)(<a class="code" href="../../d3/d1/biosc_8c.html#a4">IOPM_OFFSET</a>);      <span class="comment">// Set Process IoPmOffset before</span>
00274         Tss-&gt;IoMapBase = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)(<a class="code" href="../../d3/d1/biosc_8c.html#a4">IOPM_OFFSET</a>);           <span class="comment">//     updating Tss IoMapBase</span>
00275 
00276         <span class="comment">//</span>
00277         <span class="comment">// Call ASM routine to switch stack to exit to v86 mode to</span>
00278         <span class="comment">// run Int BiosCommand.</span>
00279         <span class="comment">//</span>
00280 
00281         <a class="code" href="../../d3/d1/biosc_8c.html#a9">Ki386SetupAndExitToV86Code</a>(UserInt10Teb);
00282 
00283         <span class="comment">//</span>
00284         <span class="comment">// After we return from v86 mode, the control comes here.</span>
00285         <span class="comment">//</span>
00286         <span class="comment">// Restore old IOPM</span>
00287         <span class="comment">//</span>
00288 
00289         RtlMoveMemory ((PVOID)&amp;Tss-&gt;IoMaps[0].IoMap,
00290                        Ki386IopmSaveArea,
00291                        PAGE_SIZE * 2
00292                        );
00293 
00294         Process-&gt;IopmOffset = OldIopmOffset;
00295         Tss-&gt;IoMapBase = OldIoMapBase;
00296 
00297         <span class="comment">//</span>
00298         <span class="comment">// Restore old affinity for current thread.</span>
00299         <span class="comment">//</span>
00300 
00301         <a class="code" href="../../d9/d1/thredobj_8c.html#a16">KeRevertToUserAffinityThread</a>();
00302 
00303         <span class="comment">//</span>
00304         <span class="comment">// Copy 16 bit vdm context back to caller.</span>
00305         <span class="comment">//</span>
00306         <span class="comment">// Extended register state is not going to matter,</span>
00307         <span class="comment">// so copy only the old part of the context record.</span>
00308         <span class="comment">//</span>
00309         ContextLength = FIELD_OFFSET(CONTEXT, ExtendedRegisters);
00310         RtlMoveMemory(BiosArguments, &amp;(VdmTib-&gt;<a class="code" href="../../d0/d6/struct__Vdm__Tib.html#o4">VdmContext</a>), ContextLength);
00311         BiosArguments-&gt;ContextFlags = <a class="code" href="../../d6/d7/halmips_8h.html#a152">CONTEXT_FULL</a>;
00312 
00313         <span class="comment">//</span>
00314         <span class="comment">// Free the pool used for the VdmTib pointer</span>
00315         <span class="comment">//</span>
00316         <a class="code" href="../../d5/d8/ex_8h.html#a224">ExFreePool</a>(<a class="code" href="../../d1/d9/ps_8h.html#a19">PsGetCurrentProcess</a>()-&gt;VdmObjects);
00317         <a class="code" href="../../d1/d9/ps_8h.html#a19">PsGetCurrentProcess</a>()-&gt;VdmObjects = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00318 
00319     }
00320 
00321 <span class="comment">//#if DBG</span>
00322 <span class="comment">//    IdtAddress = 0;</span>
00323 <span class="comment">//    RegionSize = 0x1000;</span>
00324 <span class="comment">//    ZwProtectVirtualMemory ( NtCurrentProcess(),</span>
00325 <span class="comment">//                             &amp;IdtAddress,</span>
00326 <span class="comment">//                             &amp;RegionSize,</span>
00327 <span class="comment">//                             PAGE_NOACCESS,</span>
00328 <span class="comment">//                             &amp;OldProtect</span>
00329 <span class="comment">//                             );</span>
00330 <span class="comment">//#endif</span>
00331 
00332     <span class="keywordflow">return</span>(<a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>);
00333 }
}
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a28" doxytag="i386.h::Ke386GetGdtEntryThread" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID Ke386GetGdtEntryThread           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="../../d1/d8/struct__KTHREAD.html">_KTHREAD</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>Thread</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Offset</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>PKGDTENTRY&nbsp;</td>
          <td class="mdname" nowrap> <em>Descriptor</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a31" doxytag="i386.h::Ke386IoSetAccessProcess" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN Ke386IoSetAccessProcess           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="../../d5/d7/struct__KPROCESS.html">_KPROCESS</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>Process</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>MapNumber</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a30" doxytag="i386.h::Ke386QueryIoAccessMap" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN Ke386QueryIoAccessMap           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>MapNumber</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>PKIO_ACCESS_MAP&nbsp;</td>
          <td class="mdname" nowrap> <em>IoAccessMap</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d5/i386_2iopm_8c-source.html#l00235">235</a> of file <a class="el" href="../../d2/d5/i386_2iopm_8c-source.html">i386/iopm.c</a>.
<p>
References <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d1/d9/ki_8h-source.html#l00128">KiLockContextSwap</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00628">KiPcr</a>, <a class="el" href="../../d1/d9/ki_8h-source.html#l00131">KiUnlockContextSwap</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
<pre class="fragment"><div>00242                    :
00243 
00244     The specified i/o access map will be dumped into <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> buffer.
00245     map 0 <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> a constant, but will be dumped anyway.
00246 
00247 Arguments:
00248 
00249     MapNumber - Number of access map to set.  map 0 <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> fixed.
00250 
00251     IoAccessMap - Pointer to buffer (64K bits, 8K bytes) which
00252            <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> to receive <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> definition of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> access map.
00253            Must be in non-paged <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a>.
00254 
00255 Return Value:
00256 
00257     <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> <span class="keywordflow">if</span> successful.  <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a> <span class="keywordflow">if</span> <a class="code" href="../../d8/d3/rtvbatcr_8c.html#a1">failure</a> (attempt to query a map
00258     which does not exist)
00259 
00260 --*/
00261 
00262 {
00263 
00264     ULONG i;
00265     PVOID Map;
00266     KIRQL OldIrql;
00267     PUCHAR p;
00268 
00269     <span class="comment">//</span>
00270     <span class="comment">// Reject illegal requests</span>
00271     <span class="comment">//</span>
00272 
00273     <span class="keywordflow">if</span> (MapNumber &gt; IOPM_COUNT) {
00274         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00275     }
00276 
00277     <span class="comment">//</span>
00278     <span class="comment">// Acquire the context swap lock so a context switch will not occur.</span>
00279     <span class="comment">//</span>
00280 
00281     <a class="code" href="../../d0/d0/ki_8h.html#a11">KiLockContextSwap</a>(&amp;OldIrql);
00282 
00283     <span class="comment">//</span>
00284     <span class="comment">// Copy out the map</span>
00285     <span class="comment">//</span>
00286 
00287     <span class="keywordflow">if</span> (MapNumber == IO_ACCESS_MAP_NONE) {
00288 
00289         <span class="comment">//</span>
00290         <span class="comment">// no access case, simply return a map of all 1s</span>
00291         <span class="comment">//</span>
00292 
00293         p = (PUCHAR)IoAccessMap;
00294         <span class="keywordflow">for</span> (i = 0; i &lt; IOPM_SIZE; i++) {
00295             p[i] = (UCHAR)-1;
00296         }
00297 
00298     } <span class="keywordflow">else</span> {
00299 
00300         <span class="comment">//</span>
00301         <span class="comment">// normal case, just copy the bits</span>
00302         <span class="comment">//</span>
00303 
00304         Map = (PVOID)&amp;(<a class="code" href="../../d6/d7/halmips_8h.html#a460">KiPcr</a>()-&gt;TSS-&gt;IoMaps[MapNumber-1].IoMap);
00305         RtlMoveMemory((PVOID)IoAccessMap, Map, IOPM_SIZE);
00306     }
00307 
00308     <span class="comment">//</span>
00309     <span class="comment">// Restore IRQL and unlock the context swap lock.</span>
00310     <span class="comment">//</span>
00311 
00312     <a class="code" href="../../d0/d0/ki_8h.html#a12">KiUnlockContextSwap</a>(OldIrql);
00313     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00314 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a27" doxytag="i386.h::Ke386SetDescriptorProcess" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID Ke386SetDescriptorProcess           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="../../d5/d7/struct__KPROCESS.html">_KPROCESS</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>Process</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Offset</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>LDT_ENTRY&nbsp;</td>
          <td class="mdname" nowrap> <em>LdtEntry</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a29" doxytag="i386.h::Ke386SetIoAccessMap" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN Ke386SetIoAccessMap           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>MapNumber</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>PKIO_ACCESS_MAP&nbsp;</td>
          <td class="mdname" nowrap> <em>IoAccessMap</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d2/d5/i386_2iopm_8c-source.html#l00080">80</a> of file <a class="el" href="../../d2/d5/i386_2iopm_8c-source.html">i386/iopm.c</a>.
<p>
References <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l02766">KeActiveProcessors</a>, <a class="el" href="../../d3/d6/alpha_2kdpcpu_8h-source.html#l00069">KeGetCurrentPrcb</a>, <a class="el" href="../../d0/d3/mpipi_8c-source.html#l00319">KiIpiSendPacket()</a>, <a class="el" href="../../d3/d0/xipi_8c-source.html#l00182">KiIpiStallOnPacketTargets()</a>, <a class="el" href="../../d1/d9/ki_8h-source.html#l00128">KiLockContextSwap</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00628">KiPcr</a>, <a class="el" href="../../d2/d5/i386_2iopm_8c-source.html#l00188">KiSetIoMap()</a>, <a class="el" href="../../d1/d9/ki_8h-source.html#l00131">KiUnlockContextSwap</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
<pre class="fragment"><div>00087                    :
00088 
00089     The specified i/o access map will be set to match <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
00090     definition specified by IoAccessMap (i.e. enable/disable
00091     those ports) before <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> call returns.  The change will take
00092     effect on all processors.
00093 
00094     <a class="code" href="../../d5/d3/i386_8h.html#a29">Ke386SetIoAccessMap</a> does not give any process enhanced I/O
00095     access, <a class="code" href="../../d1/d9/icmui_8def.html#a4">it</a> merely defines a particular access map.
00096 
00097 Arguments:
00098 
00099     MapNumber - Number of access map to set.  Map 0 <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> fixed.
00100 
00101     IoAccessMap - Pointer to bitvector (64K bits, 8K bytes) which
00102            defines <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> specified access map.  Must be in
00103            non-paged <a class="code" href="../../d4/d6/regext_8c.html#a17">pool</a>.
00104 
00105 Return Value:
00106 
00107     <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> <span class="keywordflow">if</span> successful.  <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a> <span class="keywordflow">if</span> <a class="code" href="../../d8/d3/rtvbatcr_8c.html#a1">failure</a> (attempt to set a map
00108     which does not exist, attempt to set map 0)
00109 
00110 --*/
00111 
00112 {
00113 
00114     <a class="code" href="../../d5/d7/struct__KPROCESS.html">PKPROCESS</a> CurrentProcess;
00115     KIRQL OldIrql;
00116     PKPRCB Prcb;
00117     PVOID pt;
00118     KAFFINITY TargetProcessors;
00119 
00120     <span class="comment">//</span>
00121     <span class="comment">// Reject illegal requests</span>
00122     <span class="comment">//</span>
00123 
00124     <span class="keywordflow">if</span> ((MapNumber &gt; IOPM_COUNT) || (MapNumber == IO_ACCESS_MAP_NONE)) {
00125         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00126     }
00127 
00128     <span class="comment">//</span>
00129     <span class="comment">// Acquire the context swap lock so a context switch will not occur.</span>
00130     <span class="comment">//</span>
00131 
00132     <a class="code" href="../../d0/d0/ki_8h.html#a11">KiLockContextSwap</a>(&amp;OldIrql);
00133 
00134     <span class="comment">//</span>
00135     <span class="comment">// Compute set of active processors other than this one, if non-empty</span>
00136     <span class="comment">// IPI them to set their maps.</span>
00137     <span class="comment">//</span>
00138 
00139     Prcb = <a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a2">KeGetCurrentPrcb</a>();
00140 
00141 <span class="preprocessor">#if !defined(NT_UP)</span>
00142 <span class="preprocessor"></span>
00143     TargetProcessors = <a class="code" href="../../d4/d9/ke_8h.html#a123">KeActiveProcessors</a> &amp; ~Prcb-&gt;SetMember;
00144     <span class="keywordflow">if</span> (TargetProcessors != 0) {
00145         <a class="code" href="../../d0/d0/ki_8h.html#a91">KiIpiSendPacket</a>(TargetProcessors,
00146                         KiSetIoMap,
00147                         IoAccessMap,
00148                         (PVOID)MapNumber,
00149                         NULL);
00150     }
00151 
00152 <span class="preprocessor">#endif</span>
00153 <span class="preprocessor"></span>
00154     <span class="comment">//</span>
00155     <span class="comment">// Copy the IOPM map and load the map for the current process.</span>
00156     <span class="comment">//</span>
00157 
00158     pt = &amp;(<a class="code" href="../../d6/d7/halmips_8h.html#a460">KiPcr</a>()-&gt;TSS-&gt;IoMaps[MapNumber-1].IoMap);
00159     RtlMoveMemory(pt, (PVOID)IoAccessMap, IOPM_SIZE);
00160     CurrentProcess = Prcb-&gt;CurrentThread-&gt;ApcState.Process;
00161     <a class="code" href="../../d6/d7/halmips_8h.html#a460">KiPcr</a>()-&gt;TSS-&gt;IoMapBase = CurrentProcess-&gt;IopmOffset;
00162 
00163     <span class="comment">//</span>
00164     <span class="comment">// Wait until all of the target processors have finished copying the</span>
00165     <span class="comment">// new map.</span>
00166     <span class="comment">//</span>
00167 
00168 <span class="preprocessor">#if !defined(NT_UP)</span>
00169 <span class="preprocessor"></span>
00170     <span class="keywordflow">if</span> (TargetProcessors != 0) {
00171         <a class="code" href="../../d2/d1/xipi_8c.html#a2">KiIpiStallOnPacketTargets</a>(TargetProcessors);
00172     }
00173 
00174 <span class="preprocessor">#endif</span>
00175 <span class="preprocessor"></span>
00176     <span class="comment">//</span>
00177     <span class="comment">// Restore IRQL and unlock the context swap lock.</span>
00178     <span class="comment">//</span>
00179 
00180     <a class="code" href="../../d0/d0/ki_8h.html#a12">KiUnlockContextSwap</a>(OldIrql);
00181     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00182 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a32" doxytag="i386.h::Ke386SetIOPL" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID Ke386SetIOPL           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="../../d5/d7/struct__KPROCESS.html">_KPROCESS</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Process</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a26" doxytag="i386.h::Ke386SetLdtProcess" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID Ke386SetLdtProcess           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">struct <a class="el" href="../../d5/d7/struct__KPROCESS.html">_KPROCESS</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>Process</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>PLDT_ENTRY&nbsp;</td>
          <td class="mdname" nowrap> <em>Ldt</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Limit</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a36" doxytag="i386.h::Ke386SetVdmInterruptHandler" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS Ke386SetVdmInterruptHandler           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN struct <a class="el" href="../../d5/d7/struct__KPROCESS.html">_KPROCESS</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>Process</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Interrupt</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a14">USHORT</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Selector</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Offset</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>Gate32</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a48" doxytag="i386.h::Ke386VdmClearApcObject" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID Ke386VdmClearApcObject           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d1/d5/struct__KAPC.html">PKAPC</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Apc</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d3/ke_2i386_2vdm_8c-source.html#l01437">1437</a> of file <a class="el" href="../../d0/d3/ke_2i386_2vdm_8c-source.html">ke/i386/vdm.c</a>.
<p>
References <a class="el" href="../../d5/d8/ke_8h-source.html#l01907">KiLockDispatcherDatabase</a>, <a class="el" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase()</a>, and <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>.
<p>
Referenced by <a class="el" href="../../d0/d4/vdmints_8c-source.html#l01709">VdmpDelayIntApcRoutine()</a>, and <a class="el" href="../../d0/d4/vdmints_8c-source.html#l00232">VdmpQueueIntApcRoutine()</a>.
<p>
<pre class="fragment"><div>01442                    :
01443 
01444     Clears a VDM APC object, synchronously with <a class="code" href="../../d5/d3/i386_8h.html#a47">Ke386VdmInsertQueueApc</a>, and
01445     <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> expected to be called by one of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> vdm kernel apc routine or <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a>
01446     rundown routine.
01447 
01448 
01449 Arguments:
01450 
01451     Apc - Supplies a pointer to a <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a58">control</a> object of <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> APC.
01452 
01453 
01454 Return Value:
01455 
01456     <span class="keywordtype">void</span>
01457 
01458 --*/
01459 {
01460 
01461     KIRQL   OldIrql;
01462 
01463     <span class="comment">//</span>
01464     <span class="comment">// Take Dispatcher database lock, to sync with Ke386VDMInsertQueueApc</span>
01465     <span class="comment">//</span>
01466 
01467     <a class="code" href="../../d4/d9/ke_8h.html#a36">KiLockDispatcherDatabase</a>(&amp;OldIrql);
01468     Apc-&gt;Thread  = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01469     <a class="code" href="../../d0/d0/ki_8h.html#a84">KiUnlockDispatcherDatabase</a>(OldIrql);
01470 
01471 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a47" doxytag="i386.h::Ke386VdmInsertQueueApc" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN Ke386VdmInsertQueueApc           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d1/d5/struct__KAPC.html">PKAPC</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Apc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN struct <a class="el" href="../../d1/d8/struct__KTHREAD.html">_KTHREAD</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>Thread</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d0/d9/ntosdef_8h.html#a39">KPROCESSOR_MODE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>ApcMode</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d0/d9/ntosdef_8h.html#a42">PKKERNEL_ROUTINE</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>KernelRoutine</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d0/d9/ntosdef_8h.html#a43">PKRUNDOWN_ROUTINE</a> RundownRoutine&nbsp;</td>
          <td class="mdname" nowrap> <em>OPTIONAL</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d0/d9/ntosdef_8h.html#a41">PKNORMAL_ROUTINE</a> NormalRoutine&nbsp;</td>
          <td class="mdname" nowrap> <em>OPTIONAL</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PVOID NormalContext&nbsp;</td>
          <td class="mdname" nowrap> <em>OPTIONAL</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN KPRIORITY&nbsp;</td>
          <td class="mdname" nowrap> <em>Increment</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a39" doxytag="i386.h::KeI386AbiosCall" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS KeI386AbiosCall           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a14">USHORT</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>LogicalId</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN struct <a class="el" href="../../d4/d9/struct__DRIVER__OBJECT.html">_DRIVER_OBJECT</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>DriverObject</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PUCHAR&nbsp;</td>
          <td class="mdname" nowrap> <em>RequestBlock</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a14">USHORT</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>EntryPoint</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a40" doxytag="i386.h::KeI386AllocateGdtSelectors" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS KeI386AllocateGdtSelectors           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">OUT <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a22">PUSHORT</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>SelectorArray</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a14">USHORT</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>NumberOfSelectors</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00449">449</a> of file <a class="el" href="../../d4/d2/abiosc_8c-source.html">abiosc.c</a>.
<p>
References <a class="el" href="../../d3/d2/abios_8h-source.html#l00078">_KFREE_GDT_ENTRY::Flink</a>, <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00062">KiAbiosGdt</a>, <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00068">KiAbiosGdtLock</a>, <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00050">KiFreeGdtListHead</a>, <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00044">KiNumberFreeSelectors</a>, and <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00064">USHORT</a>.
<p>
<pre class="fragment"><div>00456                    :
00457 
00458     This function allocates a set of GDT selectors <span class="keywordflow">for</span> a device driver to use.
00459     Usually <span class="keyword">this</span> allocation <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> performed at device driver initialization time
00460     to reserve <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> selectors <span class="keywordflow">for</span> later use.
00461 
00462 Arguments:
00463 
00464     SelectorArray - Supplies a pointer to an array of <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a> to be filled
00465                     in with <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> GDT selectors allocated.
00466 
00467     NumberOfSelectors - Specifies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> number of selectors to be allocated.
00468 
00469 Return Value:
00470 
00471     STATUS_SUCCESS - If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> requested selectors are allocated.
00472 
00473     STATUS_ABIOS_SELECTOR_NOT_AVAILABLE - <span class="keywordflow">if</span> systen can not allocate <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> number
00474                                of selectors requested.
00475 
00476 --*/
00477 
00478 {
00479     <a class="code" href="../../d8/d6/struct__KFREE__GDT__ENTRY.html">PKFREE_GDT_ENTRY</a> GdtEntry;
00480     KIRQL OldIrql;
00481 
00482     <span class="keywordflow">if</span> (<a class="code" href="../../d3/d3/abiosc_8c.html#a2">KiNumberFreeSelectors</a> &gt;= NumberOfSelectors) {
00483         ExAcquireSpinLock(&amp;KiAbiosGdtLock, &amp;OldIrql);
00484 
00485         <span class="comment">//</span>
00486         <span class="comment">// The Free Gdt link list is maintained on Processor 0's GDT ONLY.</span>
00487         <span class="comment">// Because the 'selector' is an offset to the beginning of GDT and</span>
00488         <span class="comment">// it should be the same accross all the processors.</span>
00489         <span class="comment">//</span>
00490 
00491         <a class="code" href="../../d3/d3/abiosc_8c.html#a2">KiNumberFreeSelectors</a> -= NumberOfSelectors;
00492         GdtEntry = <a class="code" href="../../d3/d3/abiosc_8c.html#a3">KiFreeGdtListHead</a>;
00493         <span class="keywordflow">while</span> (NumberOfSelectors != 0) {
00494             *SelectorArray++ = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)((ULONG)GdtEntry - <a class="code" href="../../d3/d3/abiosc_8c.html#a5">KiAbiosGdt</a>[0]);
00495             GdtEntry = GdtEntry-&gt;<a class="code" href="../../d8/d6/struct__KFREE__GDT__ENTRY.html#o0">Flink</a>;
00496             NumberOfSelectors--;
00497         }
00498         <a class="code" href="../../d3/d3/abiosc_8c.html#a3">KiFreeGdtListHead</a> = GdtEntry;
00499         ExReleaseSpinLock(&amp;KiAbiosGdtLock, OldIrql);
00500         <span class="keywordflow">return</span> STATUS_SUCCESS;
00501     } <span class="keywordflow">else</span> {
00502         <span class="keywordflow">return</span> STATUS_ABIOS_SELECTOR_NOT_AVAILABLE;
00503     }
00504 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a42" doxytag="i386.h::KeI386Call16BitCStyleFunction" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a14">USHORT</a> KeI386Call16BitCStyleFunction           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>EntryOffset</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>EntrySelector</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PUCHAR&nbsp;</td>
          <td class="mdname" nowrap> <em>Parameters</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Size</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a41" doxytag="i386.h::KeI386Call16BitFunction" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID KeI386Call16BitFunction           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN OUT PCONTEXT&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Regs</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a43" doxytag="i386.h::KeI386FlatToGdtSelector" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS KeI386FlatToGdtSelector           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>SelectorBase</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a14">USHORT</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Length</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a14">USHORT</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Selector</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00558">558</a> of file <a class="el" href="../../d4/d2/abiosc_8c-source.html">abiosc.c</a>.
<p>
References <a class="el" href="../../d3/d2/abios_8h-source.html#l00107">HIGHBYTE</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l02776">KeNumberProcessors</a>, <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00062">KiAbiosGdt</a>, <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00068">KiAbiosGdtLock</a>, <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00031">KiAbiosPresent</a>, <a class="el" href="../../d3/d2/abios_8h-source.html#l00113">LOWBYTE</a>, <a class="el" href="../../d3/d2/abios_8h-source.html#l00129">RESERVED_GDT_ENTRIES</a>, and <a class="el" href="../../d5/d4/aug98_2dll32_2icc__i386_8h-source.html#l00064">USHORT</a>.
<p>
<pre class="fragment"><div>00566                    :
00567 
00568     This function converts a 32-bit flat address to a GDT selector-offset
00569     pair.  The segment set up <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> always 16-bit ring 0 data segment.
00570 
00571 Arguments:
00572 
00573     SelectorBase - Supplies 32 bit flat address to be set as <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> base address
00574                    of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> desired selector.
00575 
00576     Length - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> Length of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> segment.  The Length <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> a 16 bit value
00577              and zero means 64KB.
00578 
00579     Selector - Supplies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> selector to be set up.
00580 
00581 Return Value:
00582 
00583     STATUS_SUCCESS - If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> requested LID <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> released.
00584 
00585     STATUS_ABIOS_NOT_PRESENT - If there <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> no ABIOS support in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> system.
00586 
00587     STATUS_ABIOS_INVALID_SELECTOR - If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> selector supplied <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> invalid.
00588 
00589 
00590 --*/
00591 
00592 {
00593     PKGDTENTRY GdtEntry, GdtEntry1;
00594     KIRQL OldIrql;
00595     ULONG i;
00596 
00597     <span class="keywordflow">if</span> (!<a class="code" href="../../d3/d3/abiosc_8c.html#a1">KiAbiosPresent</a>) {
00598         <span class="keywordflow">return</span> STATUS_ABIOS_NOT_PRESENT;
00599     }
00600     <span class="keywordflow">if</span> (Selector &lt; <a class="code" href="../../d2/d3/abios_8h.html#a8">RESERVED_GDT_ENTRIES</a> * <span class="keyword">sizeof</span>(KGDTENTRY)) {
00601         <span class="keywordflow">return</span> STATUS_ABIOS_INVALID_SELECTOR;
00602     } <span class="keywordflow">else</span> {
00603         ExAcquireSpinLock(&amp;KiAbiosGdtLock, &amp;OldIrql);
00604         GdtEntry = (PKGDTENTRY)(<a class="code" href="../../d3/d3/abiosc_8c.html#a5">KiAbiosGdt</a>[0] + Selector);
00605         GdtEntry-&gt;LimitLow = (<a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a>)(Length - 1);
00606         GdtEntry-&gt;BaseLow = LOWWORD(SelectorBase);
00607         GdtEntry-&gt;HighWord.Bytes.BaseMid = <a class="code" href="../../d2/d3/abios_8h.html#a3">LOWBYTE</a>(HIGHWORD(SelectorBase));
00608         GdtEntry-&gt;HighWord.Bytes.BaseHi = <a class="code" href="../../d2/d3/abios_8h.html#a2">HIGHBYTE</a>(HIGHWORD(SelectorBase));
00609         GdtEntry-&gt;HighWord.Bits.Pres = 1;
00610         GdtEntry-&gt;HighWord.Bits.Type = TYPE_DATA;
00611         GdtEntry-&gt;HighWord.Bits.Dpl = DPL_SYSTEM;
00612         <span class="keywordflow">for</span> (i = 1; i &lt; (ULONG)<a class="code" href="../../d4/d9/ke_8h.html#a133">KeNumberProcessors</a>; i++) {
00613             GdtEntry1 = (PKGDTENTRY)(<a class="code" href="../../d3/d3/abiosc_8c.html#a5">KiAbiosGdt</a>[i] + Selector);
00614             *GdtEntry1 = *GdtEntry;
00615         }
00616         ExReleaseSpinLock(&amp;KiAbiosGdtLock, OldIrql);
00617         <span class="keywordflow">return</span> STATUS_SUCCESS;
00618     }
00619 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a37" doxytag="i386.h::KeI386GetLid" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS KeI386GetLid           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a14">USHORT</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>DeviceId</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a14">USHORT</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>RelativeLid</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN BOOLEAN&nbsp;</td>
          <td class="mdname" nowrap> <em>SharedLid</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN struct <a class="el" href="../../d4/d9/struct__DRIVER__OBJECT.html">_DRIVER_OBJECT</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>DeviceObject</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a22">PUSHORT</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>LogicalId</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a44" doxytag="i386.h::KeI386ReleaseGdtSelectors" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS KeI386ReleaseGdtSelectors           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">OUT <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a22">PUSHORT</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>SelectorArray</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a14">USHORT</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>NumberOfSelectors</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00507">507</a> of file <a class="el" href="../../d4/d2/abiosc_8c-source.html">abiosc.c</a>.
<p>
References <a class="el" href="../../d3/d2/abios_8h-source.html#l00078">_KFREE_GDT_ENTRY::Flink</a>, <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00062">KiAbiosGdt</a>, <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00068">KiAbiosGdtLock</a>, <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00050">KiFreeGdtListHead</a>, and <a class="el" href="../../d4/d2/abiosc_8c-source.html#l00044">KiNumberFreeSelectors</a>.
<p>
<pre class="fragment"><div>00514                    :
00515 
00516     This function releases a set of GDT selectors <span class="keywordflow">for</span> a device driver.
00517     Usually <span class="keyword">this</span> function <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> called at device driver termination or
00518     deinstallation time.
00519 
00520 Arguments:
00521 
00522     SelectorArray - Supplies a pointer to an array of <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a> selectors
00523                     to be freed.
00524 
00525     NumberOfSelectors - Specifies <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> number of selectors to be released.
00526 
00527 Return Value:
00528 
00529     STATUS_SUCCESS - If <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> requested LID <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> released.
00530 
00531 --*/
00532 {
00533     <a class="code" href="../../d8/d6/struct__KFREE__GDT__ENTRY.html">PKFREE_GDT_ENTRY</a> GdtEntry;
00534     KIRQL OldIrql;
00535     ULONG Gdt;
00536 
00537     ExAcquireSpinLock(&amp;KiAbiosGdtLock, &amp;OldIrql);
00538 
00539     <span class="comment">//</span>
00540     <span class="comment">// The Free Gdt link list is maintained on Processor 0's GDT ONLY.</span>
00541     <span class="comment">// Because the 'selector' is an offset to the beginning of GDT and</span>
00542     <span class="comment">// it should be the same accross all the processors.</span>
00543     <span class="comment">//</span>
00544 
00545     <a class="code" href="../../d3/d3/abiosc_8c.html#a2">KiNumberFreeSelectors</a> += NumberOfSelectors;
00546     Gdt = <a class="code" href="../../d3/d3/abiosc_8c.html#a5">KiAbiosGdt</a>[0];
00547     <span class="keywordflow">while</span> (NumberOfSelectors != 0) {
00548         GdtEntry = (<a class="code" href="../../d8/d6/struct__KFREE__GDT__ENTRY.html">PKFREE_GDT_ENTRY</a>)(Gdt + *SelectorArray++);
00549         GdtEntry-&gt;<a class="code" href="../../d8/d6/struct__KFREE__GDT__ENTRY.html#o0">Flink</a> = <a class="code" href="../../d3/d3/abiosc_8c.html#a3">KiFreeGdtListHead</a>;
00550         <a class="code" href="../../d3/d3/abiosc_8c.html#a3">KiFreeGdtListHead</a> = GdtEntry;
00551         NumberOfSelectors--;
00552     }
00553     ExReleaseSpinLock(&amp;KiAbiosGdtLock, OldIrql);
00554     <span class="keywordflow">return</span> STATUS_SUCCESS;
00555 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a38" doxytag="i386.h::KeI386ReleaseLid" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS KeI386ReleaseLid           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a14">USHORT</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>LogicalId</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN struct <a class="el" href="../../d4/d9/struct__DRIVER__OBJECT.html">_DRIVER_OBJECT</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>DeviceObject</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a45" doxytag="i386.h::KeI386SetGdtSelector" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> NTSTATUS KeI386SetGdtSelector           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Selector</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>PKGDTENTRY&nbsp;</td>
          <td class="mdname" nowrap> <em>GdtValue</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d8/i386_2gdtsup_8c-source.html#l00117">117</a> of file <a class="el" href="../../d0/d8/i386_2gdtsup_8c-source.html">i386/gdtsup.c</a>.
<p>
References <a class="el" href="../../d1/d9/ki_8h-source.html#l00058">ClearMember</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l02766">KeActiveProcessors</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l02293">KeFindFirstSetRightMember</a>, <a class="el" href="../../d5/d8/ke_8h-source.html#l02782">KiProcessorBlock</a>, and <a class="el" href="../../d1/d8/ntosdef_8h-source.html#l00462">PAGED_CODE</a>.
<p>
<pre class="fragment"><div>00123                    :
00124 
00125     Sets a GDTs returned via <a class="code" href="../../d5/d3/i386_8h.html#a40">KeI386AllocateGdtSelectors</a> to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> supplied
00126     GdtValue.
00127 
00128 Arguments:
00129 
00130     Selector - Which GDT to set
00131     GdtValue - GDT value to set into GDT
00132 
00133 Return Value:
00134 
00135     status code
00136 
00137 --*/
00138 {
00139     KAFFINITY       TargetSet;
00140     PKPRCB          Prcb;
00141     PKPCR           Pcr;
00142     PKGDTENTRY      GdtEntry;
00143     ULONG           GdtIndex, BitNumber;
00144 
00145     <a class="code" href="../../d0/d9/ntosdef_8h.html#a28">PAGED_CODE</a> ();
00146 
00147     <span class="comment">//</span>
00148     <span class="comment">// Verify GDT entry passed, and it's above the kernel GDT values</span>
00149     <span class="comment">//</span>
00150 
00151     GdtIndex = Selector &gt;&gt; 3;
00152     <span class="keywordflow">if</span> ((Selector &amp; 0x7) != 0  || GdtIndex &lt; KGDT_NUMBER) {
00153         <span class="keywordflow">return</span> STATUS_UNSUCCESSFUL;
00154     }
00155 
00156     <span class="comment">//</span>
00157     <span class="comment">// Set gdt entry in each processors GDT</span>
00158     <span class="comment">//</span>
00159 
00160     TargetSet = <a class="code" href="../../d4/d9/ke_8h.html#a123">KeActiveProcessors</a>;
00161     <span class="keywordflow">while</span> (TargetSet != 0) {
00162         BitNumber = <a class="code" href="../../d4/d9/ke_8h.html#a39">KeFindFirstSetRightMember</a>(TargetSet);
00163         <a class="code" href="../../d0/d0/ki_8h.html#a6">ClearMember</a>(BitNumber, TargetSet);
00164 
00165         Prcb = <a class="code" href="../../d4/d9/ke_8h.html#a139">KiProcessorBlock</a>[BitNumber];
00166         Pcr  = CONTAINING_RECORD (Prcb, KPCR, PrcbData);
00167         GdtEntry = Pcr-&gt;GDT + GdtIndex;
00168 
00169         <span class="comment">// set it</span>
00170         *GdtEntry = *GdtValue;
00171     }
00172 
00173     <span class="keywordflow">return</span> STATUS_SUCCESS;
00174 }
}
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a49" doxytag="i386.h::KeI386VdmInitialize" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID KeI386VdmInitialize           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d3/ke_2i386_2vdm_8c-source.html#l01088">1088</a> of file <a class="el" href="../../d0/d3/ke_2i386_2vdm_8c-source.html">ke/i386/vdm.c</a>.
<p>
References <a class="el" href="../../d5/d8/ke_8h-source.html#l02780">KeFeatureBits</a>, <a class="el" href="../../d6/d2/i386_8h-source.html#l02686">KeI386EFlagsAndMaskV86</a>, <a class="el" href="../../d6/d2/i386_8h-source.html#l02687">KeI386EFlagsOrMaskV86</a>, <a class="el" href="../../d8/d2/i386init_8c-source.html#l00038">KeI386MachineType</a>, <a class="el" href="../../d6/d2/i386_8h-source.html#l02688">KeI386VdmIoplAllowed</a>, <a class="el" href="../../d6/d2/i386_8h-source.html#l02689">KeI386VirtualIntExtensions</a>, <a class="el" href="../../d4/d4/mutntobj_8c-source.html#l00099">KeInitializeMutex()</a>, <a class="el" href="../../d6/d2/i386_8h-source.html#l02702">KF_V86_VIS</a>, <a class="el" href="../../d9/d3/ke_2i386_2vdm_8c.html#a18">Ki386VdmEnablePentiumExtentions()</a>, <a class="el" href="../../d3/d0/xipi_8c-source.html#l00040">KiIpiGenericCall()</a>, <a class="el" href="../../d3/d9/aw_8h-source.html#l00031">L</a>, <a class="el" href="../../d4/d9/exlevels_8h-source.html#l00011">MUTEX_LEVEL_VDM_IO</a>, <a class="el" href="../../d6/d5/stierr_8h-source.html#l00030">NT_SUCCESS</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d8/d9/ctlnpqos_8c-source.html#l00027">ObjectAttributes</a>, <a class="el" href="../../d3/d6/string_8c-source.html#l00148">RtlInitUnicodeString()</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00135">Status</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>, <a class="el" href="../../d0/d3/ke_2i386_2vdm_8c-source.html#l00151">VdmFixedStateLinear</a>, and <a class="el" href="../../d0/d3/ke_2i386_2vdm_8c-source.html#l00150">VdmStringIoMutex</a>.
<p>
<pre class="fragment"><div>01093                    :
01094 
01095     This routine initializes <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> vdm stuff
01096 
01097 Arguments:
01098 
01099     None
01100 
01101 Return Value:
01102 
01103     None
01104 --*/
01105 {
01106     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
01107     OBJECT_ATTRIBUTES <a class="code" href="../../d7/d0/ctlnpqos_8c.html#a4">ObjectAttributes</a>;
01108     HANDLE RegistryHandle = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
01109     UNICODE_STRING WorkString;
01110     UCHAR KeyInformation[<span class="keyword">sizeof</span>(KEY_VALUE_BASIC_INFORMATION) + 30];
01111     ULONG ResultLength;
01112 
01113     <a class="code" href="../../d3/d5/mutntobj_8c.html#a2">KeInitializeMutex</a>( &amp;VdmStringIoMutex, MUTEX_LEVEL_VDM_IO );
01114 
01115     <span class="comment">//</span>
01116     <span class="comment">// Set up and open KeyPath to wow key</span>
01117     <span class="comment">//</span>
01118 
01119     <a class="code" href="../../d2/d7/string_8c.html#a7">RtlInitUnicodeString</a>(
01120         &amp;WorkString,
01121         L<span class="stringliteral">"\\REGISTRY\\MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Wow"</span>
01122         );
01123 
01124     InitializeObjectAttributes(
01125         &amp;ObjectAttributes,
01126         &amp;WorkString,
01127         OBJ_CASE_INSENSITIVE,
01128         (HANDLE)NULL,
01129         NULL
01130         );
01131 
01132     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = ZwOpenKey(
01133         &amp;RegistryHandle,
01134         KEY_READ,
01135         &amp;ObjectAttributes
01136         );
01137 
01138     <span class="comment">//</span>
01139     <span class="comment">// If there is no Wow key, don't allow Vdms to run</span>
01140     <span class="comment">//</span>
01141     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status)) {
01142         <span class="keywordflow">return</span>;
01143     }
01144 
01145     <span class="comment">//</span>
01146     <span class="comment">// Set up for using virtual interrupt extensions if they are available</span>
01147     <span class="comment">//</span>
01148 
01149     <span class="comment">//</span>
01150     <span class="comment">// Get the Pentium Feature disable value.</span>
01151     <span class="comment">// If this value is present, don't enable vme stuff.</span>
01152     <span class="comment">//</span>
01153     <a class="code" href="../../d2/d7/string_8c.html#a7">RtlInitUnicodeString</a>(
01154         &amp;WorkString,
01155         L<span class="stringliteral">"DisableVme"</span>
01156         );
01157 
01158     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = ZwQueryValueKey(
01159         RegistryHandle,
01160         &amp;WorkString,
01161         KeyValueBasicInformation,
01162         &amp;KeyInformation,
01163         <span class="keyword">sizeof</span>(KEY_VALUE_BASIC_INFORMATION) + 30,
01164         &amp;ResultLength
01165         );
01166 
01167     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status)) {
01168 
01169         <span class="comment">//</span>
01170         <span class="comment">// If we have the extensions, set the appropriate bits</span>
01171         <span class="comment">// in cr4</span>
01172         <span class="comment">//</span>
01173         <span class="keywordflow">if</span> (<a class="code" href="../../d4/d9/ke_8h.html#a137">KeFeatureBits</a> &amp; <a class="code" href="../../d5/d3/i386_8h.html#a0">KF_V86_VIS</a>) {
01174             <a class="code" href="../../d2/d1/xipi_8c.html#a1">KiIpiGenericCall</a>(
01175                 Ki386VdmEnablePentiumExtentions,
01176                 TRUE
01177                 );
01178             <a class="code" href="../../d5/d3/i386_8h.html#a20">KeI386VirtualIntExtensions</a> = V86_VIRTUAL_INT_EXTENSIONS;
01179         }
01180     }
01181 
01182     <span class="comment">//</span>
01183     <span class="comment">// If we have V86 mode int extensions, we don't want to run with</span>
01184     <span class="comment">// IOPL in v86 mode</span>
01185     <span class="comment">//</span>
01186     <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d3/i386_8h.html#a20">KeI386VirtualIntExtensions</a> &amp; V86_VIRTUAL_INT_EXTENSIONS) {
01187         <span class="comment">//</span>
01188         <span class="comment">// Read registry to determine if Vdms will run with IOPL in v86 mode</span>
01189         <span class="comment">//</span>
01190 
01191         <span class="comment">//</span>
01192         <span class="comment">// Get the VdmIOPL value.</span>
01193         <span class="comment">//</span>
01194         <a class="code" href="../../d2/d7/string_8c.html#a7">RtlInitUnicodeString</a>(
01195             &amp;WorkString,
01196             L<span class="stringliteral">"VdmIOPL"</span>
01197             );
01198 
01199         <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = ZwQueryValueKey(
01200             RegistryHandle,
01201             &amp;WorkString,
01202             KeyValueBasicInformation,
01203             &amp;KeyInformation,
01204             <span class="keyword">sizeof</span>(KEY_VALUE_BASIC_INFORMATION) + 30,
01205             &amp;ResultLength
01206             );
01207 
01208         <span class="comment">//</span>
01209         <span class="comment">// If the value exists, let Vdms run with IOPL in V86 mode</span>
01210         <span class="comment">//</span>
01211         <span class="keywordflow">if</span> (<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status)) {
01212             <span class="comment">//</span>
01213             <span class="comment">// KeEflagsAndMaskV86 and KeEflagsOrMaskV86 are used</span>
01214             <span class="comment">// in SANITIZE_FLAGS, and the Vdm code to make sure the</span>
01215             <span class="comment">// values in EFlags for v86 mode trap frames are acceptable</span>
01216             <span class="comment">//</span>
01217             <a class="code" href="../../d5/d3/i386_8h.html#a17">KeI386EFlagsAndMaskV86</a> = EFLAGS_USER_SANITIZE | EFLAGS_INTERRUPT_MASK;
01218             <a class="code" href="../../d5/d3/i386_8h.html#a18">KeI386EFlagsOrMaskV86</a> = EFLAGS_IOPL_MASK;
01219 
01220             <span class="comment">//</span>
01221             <span class="comment">// KeVdmIoplAllowed is used by the Vdm code to determine if</span>
01222             <span class="comment">// the virtual interrupt flag is in EFlags, or 40:xx</span>
01223             <span class="comment">//</span>
01224             <a class="code" href="../../d5/d3/i386_8h.html#a19">KeI386VdmIoplAllowed</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
01225 
01226         }
01227     }
01228 
01229     ZwClose(RegistryHandle);
01230 
01231     <span class="comment">//</span>
01232     <span class="comment">//  Initialize the address of the Vdm communications area based on</span>
01233     <span class="comment">//  machine type because of non-AT Japanese PCs.  Note that we only</span>
01234     <span class="comment">//  have to change the op-code for PC-98 machines as the default is</span>
01235     <span class="comment">//  the PC/AT value.</span>
01236     <span class="comment">//</span>
01237 
01238     <span class="keywordflow">if</span> (<a class="code" href="../../d7/d3/i386init_8c.html#a1">KeI386MachineType</a> &amp; MACHINE_TYPE_PC_9800_COMPATIBLE) {
01239 
01240         <span class="comment">//</span>
01241         <span class="comment">//  Set NTVDM state liner for PC-9800 Series</span>
01242         <span class="comment">//</span>
01243 
01244         <a class="code" href="../../d9/d3/ke_2i386_2vdm_8c.html#a3">VdmFixedStateLinear</a> = FIXED_NTVDMSTATE_LINEAR_PC_98;
01245     } <span class="keywordflow">else</span> {
01246 
01247         <span class="comment">//</span>
01248         <span class="comment">//  We are running on an normal PC/AT or a Fujitsu FMR comaptible.</span>
01249         <span class="comment">//</span>
01250 
01251         <a class="code" href="../../d9/d3/ke_2i386_2vdm_8c.html#a3">VdmFixedStateLinear</a> = FIXED_NTVDMSTATE_LINEAR_PC_AT;
01252     }
01253 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a46" doxytag="i386.h::KeOptimizeProcessorControlState" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID KeOptimizeProcessorControlState           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d7/d8/kernlini_8c-source.html#l01998">1998</a> of file <a class="el" href="../../d7/d8/kernlini_8c-source.html">kernlini.c</a>.
<p>
References <a class="el" href="../../d0/d1/cyrix_8c-source.html#l00270">Ke386ConfigureCyrixProcessor()</a>.
<p>
Referenced by <a class="el" href="../../d2/d2/cmsysini_8c-source.html#l01986">CmpConfigureProcessors()</a>.
<p>
<pre class="fragment"><div>02001 {
02002     <a class="code" href="../../d9/d1/cyrix_8c.html#a27">Ke386ConfigureCyrixProcessor</a> ();
02003 }
</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a35" doxytag="i386.h::Ki386GetSelectorParameters" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN Ki386GetSelectorParameters           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d0/d6/jul98_2test_2icc__i386_8h.html#a14">USHORT</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Selector</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT PULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Flags</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT PULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Base</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>OUT PULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>Limit</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d0/d3/ke_2i386_2vdm_8c-source.html#l00160">160</a> of file <a class="el" href="../../d0/d3/ke_2i386_2vdm_8c-source.html">ke/i386/vdm.c</a>.
<p>
References <a class="el" href="../../d7/d6/halmips_8h-source.html#l00055">EXCEPTION_EXECUTE_HANDLER</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d3/d6/alpha_2kdpcpu_8h-source.html#l00070">KeGetCurrentThread</a>, <a class="el" href="../../d3/d4/ke_2i386_2vdmp_8h-source.html#l00073">SEL_TYPE_2GIG</a>, <a class="el" href="../../d3/d4/ke_2i386_2vdmp_8h-source.html#l00071">SEL_TYPE_BIG</a>, <a class="el" href="../../d3/d4/ke_2i386_2vdmp_8h-source.html#l00072">SEL_TYPE_ED</a>, <a class="el" href="../../d3/d4/ke_2i386_2vdmp_8h-source.html#l00070">SEL_TYPE_EXECUTE</a>, <a class="el" href="../../d3/d4/ke_2i386_2vdmp_8h-source.html#l00068">SEL_TYPE_READ</a>, <a class="el" href="../../d3/d4/ke_2i386_2vdmp_8h-source.html#l00069">SEL_TYPE_WRITE</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
<pre class="fragment"><div>00169                    :
00170 
00171     This routine gets information about a selector in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> ldt, and
00172     returns <a class="code" href="../../d1/d9/icmui_8def.html#a4">it</a> to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> caller.
00173 
00174 Arguments:
00175 
00176     IN <a class="code" href="../../d4/d5/aug98_2dll32_2icc__i386_8h.html#a14">USHORT</a> Selector -- selector number <span class="keywordflow">for</span> selector to <span class="keywordflow">return</span> info <span class="keywordflow">for</span>
00177     OUT PULONG Flags -- flags indicating <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d3/d5/i386_2trapc_8c.html#a9">type</a> of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> selector.
00178     OUT PULONG Base -- base linear address of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> selector
00179     OUT PULONG Limit -- limit of <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> selector.
00180 
00181 Return Value:
00182 
00183     <span class="keywordflow">return</span>-value - True <span class="keywordflow">if</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> selector <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> LDT, and present.
00184                     False otherwise.
00185 Note:
00186 
00187     This routine should probably be somewhere <span class="keywordflow">else</span>.  There are a number
00188     of issues to clear up with respect to selectors and <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> kernel, and
00189     after they have been cleared up, <span class="keyword">this</span> code will be <a class="code" href="../../d2/d0/nt6_2user32_8def.html#a100">moved</a> to its
00190     correct place
00191 
00192 --*/
00193 
00194 {
00195 
00196     PLDT_ENTRY Ldt,OldLdt;
00197     ULONG LdtLimit,OldLdtLimit,RetryCount = 0;
00198     <a class="code" href="../../d5/d7/struct__KPROCESS.html">PKPROCESS</a> Process;
00199     BOOLEAN ReturnValue;
00200 
00201     *Flags = 0;
00202 
00203     <span class="keywordflow">if</span> ((Selector &amp; (SELECTOR_TABLE_INDEX | DPL_USER))
00204         != (SELECTOR_TABLE_INDEX | DPL_USER)) {
00205         <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00206     }
00207 
00208 
00209     Process = <a class="code" href="../../d2/d7/alpha_2kdpcpu_8h.html#a3">KeGetCurrentThread</a>()-&gt;ApcState.Process;
00210     Ldt = (PLDT_ENTRY)((Process-&gt;LdtDescriptor.BaseLow) |
00211         (Process-&gt;LdtDescriptor.HighWord.Bytes.BaseMid &lt;&lt; 16) |
00212         (Process-&gt;LdtDescriptor.HighWord.Bytes.BaseHi &lt;&lt; 24));
00213 
00214     LdtLimit = ((Process-&gt;LdtDescriptor.LimitLow) |
00215         (Process-&gt;LdtDescriptor.HighWord.Bits.LimitHi &lt;&lt; 16));
00216 
00217     Selector &amp;= ~(SELECTOR_TABLE_INDEX | DPL_USER);
00218 
00219     <span class="comment">//</span>
00220     <span class="comment">// Under normal circumstances, we will only execute the following loop</span>
00221     <span class="comment">// once.  If there is a bug in the user mode wow code however, the LDT</span>
00222     <span class="comment">// may change while we execute the following code.  We don't want to take</span>
00223     <span class="comment">// the Ldt mutex, because that is expensive.</span>
00224     <span class="comment">//</span>
00225 
00226     <span class="keywordflow">do</span> {
00227 
00228         RetryCount++;
00229 
00230         <span class="keywordflow">if</span> (((ULONG)Selector &gt;= LdtLimit) || (!Ldt)) {
00231             <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00232         }
00233 
00234         <span class="keywordflow">try</span> {
00235 
00236             <span class="keywordflow">if</span> (!Ldt[Selector/<span class="keyword">sizeof</span>(LDT_ENTRY)].HighWord.Bits.Pres) {
00237                 *Flags = SEL_TYPE_NP;
00238                 ReturnValue = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00239             } <span class="keywordflow">else</span> {
00240 
00241                 *Base = (Ldt[Selector/<span class="keyword">sizeof</span>(LDT_ENTRY)].BaseLow |
00242                     (Ldt[Selector/<span class="keyword">sizeof</span>(LDT_ENTRY)].HighWord.Bytes.BaseMid &lt;&lt; 16) |
00243                     (Ldt[Selector/<span class="keyword">sizeof</span>(LDT_ENTRY)].HighWord.Bytes.BaseHi &lt;&lt; 24));
00244 
00245                 *Limit = (Ldt[Selector/<span class="keyword">sizeof</span>(LDT_ENTRY)].LimitLow |
00246                     (Ldt[Selector/<span class="keyword">sizeof</span>(LDT_ENTRY)].HighWord.Bits.LimitHi &lt;&lt; 16));
00247 
00248                 *Flags = 0;
00249 
00250                 <span class="keywordflow">if</span> ((Ldt[Selector/<span class="keyword">sizeof</span>(LDT_ENTRY)].HighWord.Bits.Type &amp; 0x18) == 0x18) {
00251                     *Flags |= <a class="code" href="../../d2/d5/ke_2i386_2vdmp_8h.html#a7">SEL_TYPE_EXECUTE</a>;
00252 
00253                     <span class="keywordflow">if</span> (Ldt[Selector/<span class="keyword">sizeof</span>(LDT_ENTRY)].HighWord.Bits.Type &amp; 0x02) {
00254                         *Flags |= <a class="code" href="../../d2/d5/ke_2i386_2vdmp_8h.html#a5">SEL_TYPE_READ</a>;
00255                     }
00256                 } <span class="keywordflow">else</span> {
00257                     *Flags |= <a class="code" href="../../d2/d5/ke_2i386_2vdmp_8h.html#a5">SEL_TYPE_READ</a>;
00258                     <span class="keywordflow">if</span> (Ldt[Selector/<span class="keyword">sizeof</span>(LDT_ENTRY)].HighWord.Bits.Type &amp; 0x02) {
00259                         *Flags |= <a class="code" href="../../d2/d5/ke_2i386_2vdmp_8h.html#a6">SEL_TYPE_WRITE</a>;
00260                     }
00261                     <span class="keywordflow">if</span> (Ldt[Selector/<span class="keyword">sizeof</span>(LDT_ENTRY)].HighWord.Bits.Type &amp; 0x04) {
00262                         *Flags |= <a class="code" href="../../d2/d5/ke_2i386_2vdmp_8h.html#a9">SEL_TYPE_ED</a>;
00263                     }
00264                 }
00265 
00266                 <span class="keywordflow">if</span> (Ldt[Selector/<span class="keyword">sizeof</span>(LDT_ENTRY)].HighWord.Bits.Default_Big) {
00267                     *Flags |= <a class="code" href="../../d2/d5/ke_2i386_2vdmp_8h.html#a8">SEL_TYPE_BIG</a>;
00268                 }
00269 
00270                 <span class="keywordflow">if</span> (Ldt[Selector/<span class="keyword">sizeof</span>(LDT_ENTRY)].HighWord.Bits.Granularity) {
00271                     *Flags |= <a class="code" href="../../d2/d5/ke_2i386_2vdmp_8h.html#a10">SEL_TYPE_2GIG</a>;
00272                 }
00273             }
00274             ReturnValue = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00275         } except(EXCEPTION_EXECUTE_HANDLER) {
00276             <span class="comment">// Don't do anything here.  We took the fault because the</span>
00277             <span class="comment">// Ldt moved.  We will get an answer the next time around</span>
00278         }
00279 
00280         <span class="comment">//</span>
00281         <span class="comment">// If we can't get an answer in 10 tries, we never will</span>
00282         <span class="comment">//</span>
00283         <span class="keywordflow">if</span> ((RetryCount &gt; 10)) {
00284             ReturnValue = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00285         }
00286 
00287         <span class="keywordflow">if</span> (ReturnValue == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
00288             <span class="keywordflow">break</span>;
00289         }
00290 
00291         OldLdt = Ldt;
00292         OldLdtLimit = LdtLimit;
00293 
00294         Ldt = (PLDT_ENTRY)((Process-&gt;LdtDescriptor.BaseLow) |
00295             (Process-&gt;LdtDescriptor.HighWord.Bytes.BaseMid &lt;&lt; 16) |
00296             (Process-&gt;LdtDescriptor.HighWord.Bytes.BaseHi &lt;&lt; 24));
00297 
00298         LdtLimit = ((Process-&gt;LdtDescriptor.LimitLow) |
00299             (Process-&gt;LdtDescriptor.HighWord.Bits.LimitHi &lt;&lt; 16));
00300 
00301     } <span class="keywordflow">while</span> ((Ldt != OldLdt) || (LdtLimit != OldLdtLimit));
00302 
00303     <span class="keywordflow">return</span> ReturnValue;
00304 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a34" doxytag="i386.h::KiEditIopmDpc" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID KiEditIopmDpc           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN struct <a class="el" href="../../d1/d6/struct__KDPC.html">_KDPC</a> *&nbsp;</td>
          <td class="mdname" nowrap> <em>Dpc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>DeferredContext</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>SystemArgument1</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>SystemArgument2</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a class="anchor" name="a52" doxytag="i386.h::RDMSR" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONGLONG FASTCALL RDMSR           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN ULONG&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>MsrRegister</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d3/d4/i386_2kdcpuapi_8c-source.html#l01095">KdpReadMachineSpecificRegister()</a>, <a class="el" href="../../d1/d4/mtrramd_8c-source.html#l00168">KiAmdK6InitializeMTRR()</a>, <a class="el" href="../../d9/d3/mtrr_8c-source.html#l00275">KiInitializeMTRR()</a>, and <a class="el" href="../../d9/d3/mtrr_8c-source.html#l01796">KiLoadMTRR()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a51" doxytag="i386.h::RDTSC" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> LONGLONG RDTSC           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d7/d8/kernlini_8c-source.html#l01691">KiInitMachineDependent()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a53" doxytag="i386.h::WRMSR" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID WRMSR           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN ULONG&nbsp;</td>
          <td class="mdname" nowrap> <em>MsrRegister</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN ULONGLONG&nbsp;</td>
          <td class="mdname" nowrap> <em>MsrValue</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d3/d4/i386_2kdcpuapi_8c-source.html#l01153">KdpWriteMachineSpecificRegister()</a>, <a class="el" href="../../d1/d4/mtrramd_8c-source.html#l00754">KiAmdK6MtrrWRMSR()</a>, <a class="el" href="../../d9/d3/mtrr_8c-source.html#l01796">KiLoadMTRR()</a>, and <a class="el" href="../../d0/d3/pat_8c-source.html#l00289">KiLoadPAT()</a>.    </td>
  </tr>
</table>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="a22" doxytag="i386.h::KeI386CpuStep" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG <a class="el" href="../../d7/d3/i386init_8c.html#a6">KeI386CpuStep</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d2/i386_8h-source.html#l02693">2693</a> of file <a class="el" href="../../d6/d2/i386_8h-source.html">i386.h</a>.
<p>
Referenced by <a class="el" href="../../d7/d8/kernlini_8c-source.html#l00246">KiInitializeKernel()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a21" doxytag="i386.h::KeI386CpuType" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG <a class="el" href="../../d7/d3/i386init_8c.html#a5">KeI386CpuType</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d2/i386_8h-source.html#l02692">2692</a> of file <a class="el" href="../../d6/d2/i386_8h-source.html">i386.h</a>.
<p>
Referenced by <a class="el" href="../../d1/d4/i386_2flush_8c-source.html#l00187">KeInvalidateAllCaches()</a>, and <a class="el" href="../../d7/d8/kernlini_8c-source.html#l00246">KiInitializeKernel()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a17" doxytag="i386.h::KeI386EFlagsAndMaskV86" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG <a class="el" href="../../d9/d3/ke_2i386_2vdm_8c.html#a4">KeI386EFlagsAndMaskV86</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d2/i386_8h-source.html#l02686">2686</a> of file <a class="el" href="../../d6/d2/i386_8h-source.html">i386.h</a>.
<p>
Referenced by <a class="el" href="../../d0/d3/ke_2i386_2vdm_8c-source.html#l01088">KeI386VdmInitialize()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a18" doxytag="i386.h::KeI386EFlagsOrMaskV86" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG <a class="el" href="../../d9/d3/ke_2i386_2vdm_8c.html#a5">KeI386EFlagsOrMaskV86</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d2/i386_8h-source.html#l02687">2687</a> of file <a class="el" href="../../d6/d2/i386_8h-source.html">i386.h</a>.
<p>
Referenced by <a class="el" href="../../d0/d3/ke_2i386_2vdm_8c-source.html#l01088">KeI386VdmInitialize()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a24" doxytag="i386.h::KeI386FxsrPresent" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN <a class="el" href="../../d2/d0/ke_2i386_2misc_8c.html#a4">KeI386FxsrPresent</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d2/i386_8h-source.html#l02695">2695</a> of file <a class="el" href="../../d6/d2/i386_8h-source.html">i386.h</a>.
<p>
Referenced by <a class="el" href="../../d0/d8/i386_2exceptn_8c-source.html#l00278">KeContextFromKframes()</a>, <a class="el" href="../../d0/d8/i386_2exceptn_8c-source.html#l00544">KeContextToKframes()</a>, <a class="el" href="../../d3/d9/ke_2i386_2misc_8c-source.html#l00366">KeRestoreFloatingPointState()</a>, <a class="el" href="../../d3/d9/ke_2i386_2misc_8c-source.html#l00133">KeSaveFloatingPointState()</a>, <a class="el" href="../../d6/d0/i386_2thredini_8c-source.html#l00071">KiInitializeContextThread()</a>, and <a class="el" href="../../d7/d8/kernlini_8c-source.html#l00246">KiInitializeKernel()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a23" doxytag="i386.h::KeI386NpxPresent" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN <a class="el" href="../../d7/d3/i386init_8c.html#a2">KeI386NpxPresent</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d2/i386_8h-source.html#l02694">2694</a> of file <a class="el" href="../../d6/d2/i386_8h-source.html">i386.h</a>.
<p>
Referenced by <a class="el" href="../../d0/d1/config_2i386_2init386_8c-source.html#l00465">CmpInitializeMachineDependentConfiguration()</a>, <a class="el" href="../../d0/d8/i386_2exceptn_8c-source.html#l00278">KeContextFromKframes()</a>, <a class="el" href="../../d0/d8/i386_2exceptn_8c-source.html#l00544">KeContextToKframes()</a>, <a class="el" href="../../d3/d9/ke_2i386_2misc_8c-source.html#l00366">KeRestoreFloatingPointState()</a>, <a class="el" href="../../d3/d9/ke_2i386_2misc_8c-source.html#l00133">KeSaveFloatingPointState()</a>, <a class="el" href="../../d7/d8/kernlini_8c-source.html#l02008">KeSetup80387OrEmulate()</a>, <a class="el" href="../../d6/d0/i386_2thredini_8c-source.html#l00071">KiInitializeContextThread()</a>, <a class="el" href="../../d7/d8/kernlini_8c-source.html#l00246">KiInitializeKernel()</a>, and <a class="el" href="../../d1/d4/vdmnpx_8c-source.html#l00110">VdmSkipNpxInstruction()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a19" doxytag="i386.h::KeI386VdmIoplAllowed" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN <a class="el" href="../../d9/d3/ke_2i386_2vdm_8c.html#a6">KeI386VdmIoplAllowed</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d2/i386_8h-source.html#l02688">2688</a> of file <a class="el" href="../../d6/d2/i386_8h-source.html">i386.h</a>.
<p>
Referenced by <a class="el" href="../../d0/d3/ke_2i386_2vdm_8c-source.html#l01088">KeI386VdmInitialize()</a>, <a class="el" href="../../d6/d3/vdmentry_8c-source.html#l00051">NtVdmControl()</a>, <a class="el" href="../../d0/d4/vdmints_8c-source.html#l00477">VdmDispatchInterrupts()</a>, <a class="el" href="../../d8/d6/strtexec_8c-source.html#l00224">VdmEndExecution()</a>, <a class="el" href="../../d0/d4/vdmints_8c-source.html#l01870">VdmpDispatchableIntPending()</a>, and <a class="el" href="../../d8/d6/strtexec_8c-source.html#l00040">VdmpStartExecution()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a20" doxytag="i386.h::KeI386VirtualIntExtensions" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG <a class="el" href="../../d9/d3/ke_2i386_2vdm_8c.html#a7">KeI386VirtualIntExtensions</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d2/i386_8h-source.html#l02689">2689</a> of file <a class="el" href="../../d6/d2/i386_8h-source.html">i386.h</a>.
<p>
Referenced by <a class="el" href="../../d0/d3/ke_2i386_2vdm_8c-source.html#l01088">KeI386VdmInitialize()</a>, <a class="el" href="../../d6/d3/vdmentry_8c-source.html#l00051">NtVdmControl()</a>, <a class="el" href="../../d0/d4/vdmints_8c-source.html#l00477">VdmDispatchInterrupts()</a>, <a class="el" href="../../d8/d6/strtexec_8c-source.html#l00224">VdmEndExecution()</a>, <a class="el" href="../../d0/d4/vdmints_8c-source.html#l01870">VdmpDispatchableIntPending()</a>, <a class="el" href="../../d0/d4/vdmints_8c-source.html#l00232">VdmpQueueIntApcRoutine()</a>, and <a class="el" href="../../d8/d6/strtexec_8c-source.html#l00040">VdmpStartExecution()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a25" doxytag="i386.h::KiBootFeatureBits" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ULONG <a class="el" href="../../d7/d3/i386init_8c.html#a8">KiBootFeatureBits</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d2/i386_8h-source.html#l02723">2723</a> of file <a class="el" href="../../d6/d2/i386_8h-source.html">i386.h</a>.
<p>
Referenced by <a class="el" href="../../d7/d8/kernlini_8c-source.html#l00246">KiInitializeKernel()</a>.    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:44:06 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
