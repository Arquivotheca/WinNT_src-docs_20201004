<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: cmworker.c File Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>cmworker.c File Reference</h1><code>#include "<a class="el" href="../../d2/d1/cmp_8h-source.html">cmp.h</a>"</code><br>

<p>
<a href="../../d6/d2/cmworker_8c-source.html">Go to the source code of this file.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d3/cmworker_8c.html#a0">LAZY_FLUSH_INTERVAL_IN_SECONDS</a>&nbsp;&nbsp;&nbsp;5</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d3/cmworker_8c.html#a1">LAZY_FLUSH_TIMEOUT_IN_SECONDS</a>&nbsp;&nbsp;&nbsp;1</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>#define&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d3/cmworker_8c.html#a2">SECOND_MULT</a>&nbsp;&nbsp;&nbsp;10*1000*1000</td></tr>

<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d3/cmworker_8c.html#a15">CmpInitializeHiveList</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d3/cmworker_8c.html#a16">CmpLazyFlushWorker</a> (IN PVOID Parameter)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d3/cmworker_8c.html#a17">CmpLazyFlushDpcRoutine</a> (IN <a class="el" href="../../d1/d6/struct__KDPC.html">PKDPC</a> Dpc, IN PVOID DeferredContext, IN PVOID SystemArgument1, IN PVOID SystemArgument2)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d3/cmworker_8c.html#a18">CmpDiskFullWarningWorker</a> (IN PVOID WorkItem)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d3/cmworker_8c.html#a19">CmpDiskFullWarning</a> (VOID)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d3/cmworker_8c.html#a20">CmpWorker</a> (IN <a class="el" href="../../d4/d3/struct__REGISTRY__COMMAND.html">PREGISTRY_COMMAND</a> <a class="el" href="../../d8/d3/cmwrapr2_8c.html#a0">CommandArea</a>)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>VOID&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d3/cmworker_8c.html#a21">CmpLazyFlush</a> (VOID)</td></tr>

<tr><td colspan=2><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>LIST_ENTRY&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d3/cmworker_8c.html#a3">CmpHiveListHead</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d5/d7/struct__KPROCESS.html">PKPROCESS</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d3/cmworker_8c.html#a4">CmpSystemProcess</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d3/d8/struct__KTIMER.html">KTIMER</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d3/cmworker_8c.html#a5">CmpLazyFlushTimer</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d1/d6/struct__KDPC.html">KDPC</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d3/cmworker_8c.html#a6">CmpLazyFlushDpc</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="../../d7/d9/struct__WORK__QUEUE__ITEM.html">WORK_QUEUE_ITEM</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d3/cmworker_8c.html#a7">CmpLazyWorkItem</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d3/cmworker_8c.html#a8">CmpLazyFlushPending</a> = FALSE</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d3/cmworker_8c.html#a9">CmpNoWrite</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d3/cmworker_8c.html#a10">CmpWasSetupBoot</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d3/cmworker_8c.html#a11">HvShutdownComplete</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d3/cmworker_8c.html#a12">CmpProfileLoaded</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d3/cmworker_8c.html#a13">CmpDiskFullWorkerPopupDisplayed</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>BOOLEAN&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="../../d5/d3/cmworker_8c.html#a14">CmpCannotWriteConfiguration</a></td></tr>

</table>
<hr><h2>Define Documentation</h2>
<a class="anchor" name="a0" doxytag="cmworker.c::LAZY_FLUSH_INTERVAL_IN_SECONDS" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define LAZY_FLUSH_INTERVAL_IN_SECONDS&nbsp;&nbsp;&nbsp;5          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d2/cmworker_8c-source.html#l00040">40</a> of file <a class="el" href="../../d6/d2/cmworker_8c-source.html">cmworker.c</a>.
<p>
Referenced by <a class="el" href="../../d6/d2/cmworker_8c-source.html#l00368">CmpLazyFlush()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a1" doxytag="cmworker.c::LAZY_FLUSH_TIMEOUT_IN_SECONDS" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define LAZY_FLUSH_TIMEOUT_IN_SECONDS&nbsp;&nbsp;&nbsp;1          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d2/cmworker_8c-source.html#l00047">47</a> of file <a class="el" href="../../d6/d2/cmworker_8c-source.html">cmworker.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a2" doxytag="cmworker.c::SECOND_MULT" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> #define SECOND_MULT&nbsp;&nbsp;&nbsp;10*1000*1000          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d2/cmworker_8c-source.html#l00049">49</a> of file <a class="el" href="../../d6/d2/cmworker_8c-source.html">cmworker.c</a>.
<p>
Referenced by <a class="el" href="../../d6/d2/cmworker_8c-source.html#l00368">CmpLazyFlush()</a>.    </td>
  </tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="a19" doxytag="cmworker.c::CmpDiskFullWarning" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID CmpDiskFullWarning           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d2/d2/cmsysini_8c-source.html#l00726">CmpInitializeHiveList()</a>, and <a class="el" href="../../d6/d2/cmworker_8c-source.html#l00461">CmpLazyFlushWorker()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a18" doxytag="cmworker.c::CmpDiskFullWarningWorker" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID CmpDiskFullWarningWorker           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PVOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>WorkItem</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d2/cmworker_8c-source.html#l00518">518</a> of file <a class="el" href="../../d6/d2/cmworker_8c-source.html">cmworker.c</a>.
<p>
References <a class="el" href="../../d7/d2/cmwraper_8c-source.html#l00304">ExFreePool()</a>, <a class="el" href="../../d7/d7/ex_2harderr_8c-source.html#l00700">ExRaiseHardError()</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, and <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00135">Status</a>.
<p>
Referenced by <a class="el" href="../../d6/d2/cmworker_8c-source.html#l00556">CmpDiskFullWarning()</a>.
<p>
<pre class="fragment"><div>00524                    :
00525 
00526     Displays hard error popup that indicates <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> disk <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> full.
00527 
00528 Arguments:
00529 
00530     WorkItem - Supplies pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> work item. This routine will
00531                free <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> work item.
00532 
00533 Return Value:
00534 
00535     None.
00536 
00537 --*/
00538 
00539 {
00540     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
00541     ULONG Response;
00542 
00543     <a class="code" href="../../d5/d8/ex_8h.html#a224">ExFreePool</a>(WorkItem);
00544 
00545     <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d5/d8/ex_8h.html#a306">ExRaiseHardError</a>(STATUS_DISK_FULL,
00546                               0,
00547                               0,
00548                               NULL,
00549                               OptionOk,
00550                               &amp;Response);
00551 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a15" doxytag="cmworker.c::CmpInitializeHiveList" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID CmpInitializeHiveList           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Referenced by <a class="el" href="../../d6/d2/cmworker_8c-source.html#l00115">CmpWorker()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a21" doxytag="cmworker.c::CmpLazyFlush" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID CmpLazyFlush           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">VOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d2/cmworker_8c-source.html#l00368">368</a> of file <a class="el" href="../../d6/d2/cmworker_8c-source.html">cmworker.c</a>.
<p>
References <a class="el" href="../../d2/d1/cmp_8h-source.html#l00248">CML_FLOW</a>, <a class="el" href="../../d2/d1/cmp_8h-source.html#l00293">CMLOG</a>, <a class="el" href="../../d6/d2/cmworker_8c-source.html#l00053">CmpLazyFlushDpc</a>, <a class="el" href="../../d6/d2/cmworker_8c-source.html#l00052">CmpLazyFlushTimer</a>, <a class="el" href="../../d9/d8/cmapi_8c-source.html#l00025">CmpNoWrite</a>, <a class="el" href="../../d2/d1/cmp_8h-source.html#l00259">CMS_IO</a>, <a class="el" href="../../d4/d1/timerobj_8c-source.html#l00243">KeSetTimer()</a>, <a class="el" href="../../d6/d2/cmworker_8c-source.html#l00040">LAZY_FLUSH_INTERVAL_IN_SECONDS</a>, <a class="el" href="../../d1/d8/ntosdef_8h-source.html#l00462">PAGED_CODE</a>, and <a class="el" href="../../d6/d2/cmworker_8c-source.html#l00049">SECOND_MULT</a>.
<p>
<pre class="fragment"><div>00374                    :
00375 
00376     This routine resets <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> registry timer to go off at a specified interval
00377     in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> future (LAZY_FLUSH_INTERVAL_IN_SECONDS).
00378 
00379 Arguments:
00380 
00381     None
00382 
00383 Return Value:
00384 
00385     None.
00386 
00387 --*/
00388 
00389 {
00390     LARGE_INTEGER DueTime;
00391 
00392     <a class="code" href="../../d0/d9/ntosdef_8h.html#a28">PAGED_CODE</a>();
00393     <a class="code" href="../../d1/d2/cmp_8h.html#a55">CMLOG</a>(CML_FLOW, CMS_IO) {
00394         KdPrint((<span class="stringliteral">"CmpLazyFlush: setting lazy flush timer\n"</span>));
00395     }
00396     <span class="keywordflow">if</span> (!<a class="code" href="../../d8/d9/cmapi_8c.html#a0">CmpNoWrite</a>) {
00397 
00398         DueTime.QuadPart = Int32x32To64(LAZY_FLUSH_INTERVAL_IN_SECONDS,
00399                                         - SECOND_MULT);
00400 
00401         <span class="comment">//</span>
00402         <span class="comment">// Indicate relative time</span>
00403         <span class="comment">//</span>
00404 
00405         <a class="code" href="../../d3/d2/timerobj_8c.html#a6">KeSetTimer</a>(&amp;CmpLazyFlushTimer,
00406                    DueTime,
00407                    &amp;CmpLazyFlushDpc);
00408 
00409     }
00410 
00411 
00412 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a17" doxytag="cmworker.c::CmpLazyFlushDpcRoutine" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID CmpLazyFlushDpcRoutine           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d1/d6/struct__KDPC.html">PKDPC</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Dpc</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>DeferredContext</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>SystemArgument1</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td></td>
          <td class="md" nowrap>IN PVOID&nbsp;</td>
          <td class="mdname" nowrap> <em>SystemArgument2</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d2/cmworker_8c-source.html#l00416">416</a> of file <a class="el" href="../../d6/d2/cmworker_8c-source.html">cmworker.c</a>.
<p>
References <a class="el" href="../../d2/d1/cmp_8h-source.html#l00248">CML_FLOW</a>, <a class="el" href="../../d2/d1/cmp_8h-source.html#l00293">CMLOG</a>, <a class="el" href="../../d2/d1/cmp_8h-source.html#l01098">CmpLazyFlushPending</a>, <a class="el" href="../../d6/d2/cmworker_8c-source.html#l00054">CmpLazyWorkItem</a>, <a class="el" href="../../d2/d1/cmp_8h-source.html#l00259">CMS_IO</a>, <a class="el" href="../../d5/d8/ex_8h.html#a332a206">DelayedWorkQueue</a>, <a class="el" href="../../d2/d8/worker_8c-source.html#l00375">ExQueueWorkItem()</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d6/d2/cmworker_8c-source.html#l00115">CmpWorker()</a>.
<p>
<pre class="fragment"><div>00425                    :
00426 
00427     This <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> DPC routine triggered by <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> lazy flush timer.  All <a class="code" href="../../d1/d9/icmui_8def.html#a4">it</a> does
00428     <a class="code" href="../../d3/d0/user32_8def.html#a108">is</a> queue a work item to an executive worker thread.  The work item will
00429     <span class="keywordflow">do</span> <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> actual lazy flush to disk.
00430 
00431 Arguments:
00432 
00433     Dpc - Supplies a pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> DPC object.
00434 
00435     DeferredContext - not used
00436 
00437     SystemArgument1 - not used
00438 
00439     SystemArgument2 - not used
00440 
00441 Return Value:
00442 
00443     None.
00444 
00445 --*/
00446 
00447 {
00448     <a class="code" href="../../d1/d2/cmp_8h.html#a55">CMLOG</a>(CML_FLOW, CMS_IO) {
00449         KdPrint((<span class="stringliteral">"CmpLazyFlushDpc: queuing lazy flush work item\n"</span>));
00450     }
00451 
00452     <span class="keywordflow">if</span> (!<a class="code" href="../../d1/d2/cmp_8h.html#a185">CmpLazyFlushPending</a>) {
00453         <a class="code" href="../../d1/d2/cmp_8h.html#a185">CmpLazyFlushPending</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00454         <a class="code" href="../../d5/d8/ex_8h.html#a261">ExQueueWorkItem</a>(&amp;CmpLazyWorkItem, DelayedWorkQueue);
00455     }
00456 
00457 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a16" doxytag="cmworker.c::CmpLazyFlushWorker" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID CmpLazyFlushWorker           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN PVOID&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>Parameter</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d2/cmworker_8c-source.html#l00461">461</a> of file <a class="el" href="../../d6/d2/cmworker_8c-source.html">cmworker.c</a>.
<p>
References <a class="el" href="../../d2/d1/cmp_8h-source.html#l00248">CML_FLOW</a>, <a class="el" href="../../d2/d1/cmp_8h-source.html#l00293">CMLOG</a>, <a class="el" href="../../d8/d9/cmdat2_8c-source.html#l00059">CmpCannotWriteConfiguration</a>, <a class="el" href="../../d5/d3/cmworker_8c.html#a19">CmpDiskFullWarning()</a>, <a class="el" href="../../d9/d8/cmapi_8c-source.html#l02195">CmpDoFlushAll()</a>, <a class="el" href="../../d7/d2/cmwraper_8c-source.html#l00097">CmpLazyFlush()</a>, <a class="el" href="../../d2/d1/cmp_8h-source.html#l01098">CmpLazyFlushPending</a>, <a class="el" href="../../d7/d2/cmwraper_8c-source.html#l00124">CmpLockRegistry()</a>, <a class="el" href="../../d1/d2/cmsubs3_8c-source.html#l00116">CmpUnlockRegistry()</a>, <a class="el" href="../../d2/d1/cmp_8h-source.html#l00259">CMS_IO</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d8/d9/cmdat2_8c-source.html#l00076">HvShutdownComplete</a>, <a class="el" href="../../d1/d8/ntosdef_8h-source.html#l00462">PAGED_CODE</a>, and <a class="el" href="../../d7/d6/halmips_8h-source.html#l00626">TRUE</a>.
<p>
Referenced by <a class="el" href="../../d6/d2/cmworker_8c-source.html#l00115">CmpWorker()</a>.
<p>
<pre class="fragment"><div>00467                    :
00468 
00469     Worker routine called to <span class="keywordflow">do</span> a lazy flush.  Called by an executive worker
00470     thread in <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> system process.  
00471 
00472 Arguments:
00473 
00474     Parameter - not used.
00475 
00476 Return Value:
00477 
00478     None.
00479 
00480 --*/
00481 
00482 {
00483     BOOLEAN Result = <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00484 
00485     <a class="code" href="../../d0/d9/ntosdef_8h.html#a28">PAGED_CODE</a>();
00486 
00487     <a class="code" href="../../d1/d2/cmp_8h.html#a55">CMLOG</a>(CML_FLOW, CMS_IO) {
00488         KdPrint((<span class="stringliteral">"CmpLazyFlushWorker: flushing hives\n"</span>));
00489     }
00490 
00491     <a class="code" href="../../d6/d3/cmwraper_8c.html#a14">CmpLockRegistry</a>();
00492     <span class="keywordflow">if</span> (!<a class="code" href="../../d7/d0/cmdat2_8c.html#a13">HvShutdownComplete</a>) {
00493         Result = <a class="code" href="../../d1/d2/cmp_8h.html#a243">CmpDoFlushAll</a>();
00494     }
00495     <a class="code" href="../../d1/d2/cmp_8h.html#a185">CmpLazyFlushPending</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00496     <a class="code" href="../../d1/d2/cmp_8h.html#a258">CmpUnlockRegistry</a>();
00497 
00498     <span class="keywordflow">if</span>( <a class="code" href="../../d7/d0/cmdat2_8c.html#a8">CmpCannotWriteConfiguration</a> ) {
00499         <span class="comment">//</span>
00500         <span class="comment">// Disk full; system hive haven't been save at initialization</span>
00501         <span class="comment">//</span>
00502         <span class="keywordflow">if</span>(Result) {
00503             <span class="comment">//</span>
00504             <span class="comment">// All hives were saved; No need for disk full warning anymore</span>
00505             <span class="comment">//</span>
00506             <a class="code" href="../../d7/d0/cmdat2_8c.html#a8">CmpCannotWriteConfiguration</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00507         } <span class="keywordflow">else</span> {
00508             <span class="comment">//</span>
00509             <span class="comment">// Issue another hard error (if not already displayed) and postpone a lazy flush operation</span>
00510             <span class="comment">//</span>
00511             <a class="code" href="../../d5/d3/cmworker_8c.html#a19">CmpDiskFullWarning</a>();
00512             <a class="code" href="../../d6/d3/cmwraper_8c.html#a11">CmpLazyFlush</a>();
00513         }
00514     }
00515 }

</div></pre>    </td>
  </tr>
</table>
<a class="anchor" name="a20" doxytag="cmworker.c::CmpWorker" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> VOID CmpWorker           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">IN <a class="el" href="../../d4/d3/struct__REGISTRY__COMMAND.html">PREGISTRY_COMMAND</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>CommandArea</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d2/cmworker_8c-source.html#l00115">115</a> of file <a class="el" href="../../d6/d2/cmworker_8c-source.html">cmworker.c</a>.
<p>
References <a class="el" href="../../d2/d1/cmp_8h-source.html#l00748">_REGISTRY_COMMAND::Allocate</a>, <a class="el" href="../../d2/d1/cmp_8h-source.html#l00360">ASSERT_PASSIVE_LEVEL</a>, <a class="el" href="../../d2/d1/cmp_8h-source.html#l00746">_REGISTRY_COMMAND::Buffer</a>, <a class="el" href="../../d2/d1/cmp_8h-source.html#l00740">_REGISTRY_COMMAND::Cell</a>, <a class="el" href="../../d9/d8/cmapi_8c-source.html#l00564">CmFlushKey()</a>, <a class="el" href="../../d2/d1/cmp_8h-source.html#l00745">_REGISTRY_COMMAND::CmHive</a>, <a class="el" href="../../d7/d0/cmhvlist_8c-source.html#l00042">CmpAddToHiveFileList()</a>, <a class="el" href="../../d8/d2/cmwrapr_8c-source.html#l00227">CmpDoFileSetSize()</a>, <a class="el" href="../../d9/d8/cmapi_8c-source.html#l02195">CmpDoFlushAll()</a>, <a class="el" href="../../d8/d2/cmwrapr_8c-source.html#l00351">CmpFileRead()</a>, <a class="el" href="../../d9/d8/cmapi_8c-source.html#l00027">CmpHiveListHead</a>, <a class="el" href="../../d2/d2/cmsysini_8c-source.html#l02422">CmpInitHiveFromFile()</a>, <a class="el" href="../../d5/d3/cmworker_8c.html#a15">CmpInitializeHiveList()</a>, <a class="el" href="../../d6/d2/cmworker_8c-source.html#l00053">CmpLazyFlushDpc</a>, <a class="el" href="../../d6/d2/cmworker_8c-source.html#l00416">CmpLazyFlushDpcRoutine()</a>, <a class="el" href="../../d6/d2/cmworker_8c-source.html#l00052">CmpLazyFlushTimer</a>, <a class="el" href="../../d6/d2/cmworker_8c-source.html#l00461">CmpLazyFlushWorker()</a>, <a class="el" href="../../d6/d2/cmworker_8c-source.html#l00054">CmpLazyWorkItem</a>, <a class="el" href="../../d9/d8/cmapi_8c-source.html#l00025">CmpNoWrite</a>, <a class="el" href="../../d1/d2/cmp_8h.html#a310">CmpRemoveFromHiveFileList()</a>, <a class="el" href="../../d9/d8/cmapi_8c-source.html#l00030">CmpWasSetupBoot</a>, <a class="el" href="../../d2/d1/cmp_8h-source.html#l00738">_REGISTRY_COMMAND::Command</a>, <a class="el" href="../../d9/d2/cmwrapr2_8c-source.html#l00029">CommandArea</a>, <a class="el" href="../../d6/d4/cc_8h-source.html#l00126">ExAllocatePool</a>, <a class="el" href="../../d7/d2/cmwraper_8c-source.html#l00304">ExFreePool()</a>, <a class="el" href="../../d6/d7/ex_8h-source.html#l01961">ExInitializeWorkItem</a>, <a class="el" href="../../d7/d6/halmips_8h-source.html#l00625">FALSE</a>, <a class="el" href="../../d2/d1/cmp_8h-source.html#l00744">_REGISTRY_COMMAND::FileAttributes</a>, <a class="el" href="../../d2/d1/cmp_8h-source.html#l00650">_CMHIVE::FileHandles</a>, <a class="el" href="../../d3/d1/rtload_8c-source.html#l00047">FileName</a>, <a class="el" href="../../d2/d1/cmp_8h-source.html#l00742">_REGISTRY_COMMAND::FileSize</a>, <a class="el" href="../../d2/d1/cmp_8h-source.html#l00741">_REGISTRY_COMMAND::FileType</a>, <a class="el" href="../../d8/d9/cmdat2_8c-source.html#l00091">Handle</a>, <a class="el" href="../../d1/d0/hivedata_8h-source.html#l00572">HFILE_TYPE_MAX</a>, <a class="el" href="../../d1/d0/hivedata_8h-source.html#l00568">HFILE_TYPE_PRIMARY</a>, <a class="el" href="../../d2/d1/cmp_8h-source.html#l00739">_REGISTRY_COMMAND::Hive</a>, <a class="el" href="../../d5/d5/regext_8c-source.html#l00033">HiveList</a>, <a class="el" href="../../d0/d2/hivesync_8c.html#a6">HvRefreshHive()</a>, <a class="el" href="../../d2/d1/cmp_8h-source.html#l00754">_REGISTRY_COMMAND::ImpersonationContext</a>, <a class="el" href="../../d0/d1/bugcheck_8c-source.html#l00428">KeBugCheckEx()</a>, <a class="el" href="../../d5/d0/dpcobj_8c-source.html#l00039">KeInitializeDpc()</a>, <a class="el" href="../../d4/d1/timerobj_8c-source.html#l00043">KeInitializeTimer()</a>, <a class="el" href="../../d2/d1/cmp_8h-source.html#l00753">_REGISTRY_COMMAND::NameInfoLength</a>, <a class="el" href="../../d2/d1/cmp_8h-source.html#l00751">_REGISTRY_COMMAND::NewName</a>, <a class="el" href="../../d6/d5/stierr_8h-source.html#l00030">NT_SUCCESS</a>, <a class="el" href="../../d0/d6/iop_8h.html#a144">NTSTATUS()</a>, <a class="el" href="../../d5/d5/lh__open_2pi__basic_8h-source.html#l00023">NULL</a>, <a class="el" href="../../d2/d1/cmp_8h-source.html#l00747">_REGISTRY_COMMAND::Offset</a>, <a class="el" href="../../d2/d1/cmp_8h-source.html#l00752">_REGISTRY_COMMAND::OldName</a>, <a class="el" href="../../d1/d8/ntosdef_8h-source.html#l00462">PAGED_CODE</a>, <a class="el" href="../../d5/d8/ex_8h.html#a329a174">PagedPool</a>, <a class="el" href="../../d7/d4/ps_2security_8c-source.html#l01051">PsRevertToSelf()</a>, <a class="el" href="../../d2/d1/cmp_8h-source.html#l00726">REG_CMD_ADD_HIVE_LIST</a>, <a class="el" href="../../d2/d1/cmp_8h-source.html#l00721">REG_CMD_FILE_SET_SIZE</a>, <a class="el" href="../../d2/d1/cmp_8h-source.html#l00720">REG_CMD_FLUSH_KEY</a>, <a class="el" href="../../d2/d1/cmp_8h-source.html#l00723">REG_CMD_HIVE_CLOSE</a>, <a class="el" href="../../d2/d1/cmp_8h-source.html#l00722">REG_CMD_HIVE_OPEN</a>, <a class="el" href="../../d2/d1/cmp_8h-source.html#l00729">REG_CMD_HIVE_READ</a>, <a class="el" href="../../d2/d1/cmp_8h-source.html#l00719">REG_CMD_INIT</a>, <a class="el" href="../../d2/d1/cmp_8h-source.html#l00728">REG_CMD_REFRESH_HIVE</a>, <a class="el" href="../../d2/d1/cmp_8h-source.html#l00727">REG_CMD_REMOVE_HIVE_LIST</a>, <a class="el" href="../../d2/d1/cmp_8h-source.html#l00725">REG_CMD_RENAME_HIVE</a>, <a class="el" href="../../d2/d1/cmp_8h-source.html#l00724">REG_CMD_SHUTDOWN</a>, <a class="el" href="../../d2/d1/cmp_8h-source.html#l00750">_REGISTRY_COMMAND::RegistryLockAquired</a>, <a class="el" href="../../d5/d4/seclient_8c-source.html#l00636">SeImpersonateClientEx()</a>, <a class="el" href="../../d2/d1/cmp_8h-source.html#l00749">_REGISTRY_COMMAND::SetupBoot</a>, <a class="el" href="../../d2/d1/cmp_8h-source.html#l00743">_REGISTRY_COMMAND::Status</a>, <a class="el" href="../../d3/d0/cttoken_8c-source.html#l00135">Status</a>, and <a class="el" href="../../d7/d8/restrfil_8c-source.html#l00861">ZwSetInformationFile()</a>.
<p>
Referenced by <a class="el" href="../../d9/d8/cmapi_8c-source.html#l01901">CmLoadKey()</a>, <a class="el" href="../../d9/d2/cmwrapr2_8c-source.html#l00045">CmpFileSetSize()</a>, <a class="el" href="../../d7/d1/cmsavres_8c-source.html#l00484">CmpLoadHiveVolatile()</a>, <a class="el" href="../../d7/d1/cmsavres_8c-source.html#l00731">CmpRefreshHive()</a>, <a class="el" href="../../d7/d1/cmsavres_8c-source.html#l01261">CmpSaveKeyByFileCopy()</a>, <a class="el" href="../../d9/d8/cmapi_8c-source.html#l02293">CmReplaceKey()</a>, <a class="el" href="../../d2/d2/cmsysini_8c-source.html#l03944">CmShutdownSystem()</a>, <a class="el" href="../../d9/d8/cmapi_8c-source.html#l02079">CmUnloadKey()</a>, <a class="el" href="../../d8/d6/ntapi_8c-source.html#l00904">NtFlushKey()</a>, and <a class="el" href="../../d8/d6/ntapi_8c-source.html#l00997">NtInitializeRegistry()</a>.
<p>
<pre class="fragment"><div>00120                    :
00121 
00122     Actually execute <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> command specified in <a class="code" href="../../d8/d3/cmwrapr2_8c.html#a0">CommandArea</a>, and
00123     report its completion.
00124 
00125 Arguments:
00126 
00127     Parameter - supplies a pointer to <a class="code" href="../../d7/d1/genuedef_8c.html#a2">the</a> <a class="code" href="../../d4/d3/struct__REGISTRY__COMMAND.html">REGISTRY_COMMAND</a> structure to
00128                 be executed.
00129 
00130 Return Value:
00131 
00132 --*/
00133 {
00134     <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a> <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
00135     <a class="code" href="../../d9/d6/struct__CMHIVE.html">PCMHIVE</a> CmHive;
00136     IO_STATUS_BLOCK IoStatusBlock;
00137     PUNICODE_STRING <a class="code" href="../../d2/d2/rtload_8c.html#a3">FileName</a>;
00138     ULONG i;
00139     HANDLE <a class="code" href="../../d7/d0/cmdat2_8c.html#a19">Handle</a>;
00140     PFILE_RENAME_INFORMATION RenameInfo;
00141     PLIST_ENTRY p;
00142     BOOLEAN result;
00143     HANDLE NullHandle;
00144 
00145     <a class="code" href="../../d0/d9/ntosdef_8h.html#a28">PAGED_CODE</a>();
00146 
00147     <span class="keywordflow">switch</span> (<a class="code" href="../../d8/d3/cmwrapr2_8c.html#a0">CommandArea</a>-&gt;<a class="code" href="../../d4/d3/struct__REGISTRY__COMMAND.html#o0">Command</a>) {
00148 
00149         <span class="keywordflow">case</span> <a class="code" href="../../d1/d2/cmp_8h.html#a101">REG_CMD_INIT</a>:
00150             <span class="comment">//</span>
00151             <span class="comment">// Initialize lazy flush timer and DPC</span>
00152             <span class="comment">//</span>
00153             <a class="code" href="../../d4/d1/dpcobj_8c.html#a1">KeInitializeDpc</a>(&amp;CmpLazyFlushDpc,
00154                             CmpLazyFlushDpcRoutine,
00155                             NULL);
00156 
00157             <a class="code" href="../../d3/d2/timerobj_8c.html#a1">KeInitializeTimer</a>(&amp;CmpLazyFlushTimer);
00158 
00159             <a class="code" href="../../d5/d8/ex_8h.html#a55">ExInitializeWorkItem</a>(&amp;CmpLazyWorkItem, CmpLazyFlushWorker, NULL);
00160 
00161             <a class="code" href="../../d8/d9/cmapi_8c.html#a0">CmpNoWrite</a> = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00162 
00163             <a class="code" href="../../d8/d9/cmapi_8c.html#a3">CmpWasSetupBoot</a> = <a class="code" href="../../d8/d3/cmwrapr2_8c.html#a0">CommandArea</a>-&gt;<a class="code" href="../../d4/d3/struct__REGISTRY__COMMAND.html#o11">SetupBoot</a>;
00164             <span class="keywordflow">if</span> (<a class="code" href="../../d8/d3/cmwrapr2_8c.html#a0">CommandArea</a>-&gt;<a class="code" href="../../d4/d3/struct__REGISTRY__COMMAND.html#o11">SetupBoot</a> == <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>) {
00165                 <a class="code" href="../../d5/d3/cmworker_8c.html#a15">CmpInitializeHiveList</a>();
00166             }
00167 
00168             <span class="comment">//</span>
00169             <span class="comment">// flush dirty data to disk</span>
00170             <span class="comment">//</span>
00171             <a class="code" href="../../d1/d2/cmp_8h.html#a243">CmpDoFlushAll</a>();
00172             <span class="keywordflow">break</span>;
00173 
00174         <span class="keywordflow">case</span> <a class="code" href="../../d1/d2/cmp_8h.html#a102">REG_CMD_FLUSH_KEY</a>:
00175             <a class="code" href="../../d8/d3/cmwrapr2_8c.html#a0">CommandArea</a>-&gt;<a class="code" href="../../d4/d3/struct__REGISTRY__COMMAND.html#o5">Status</a> =
00176                 <a class="code" href="../../d1/d2/cmp_8h.html#a228">CmFlushKey</a>(<a class="code" href="../../d8/d3/cmwrapr2_8c.html#a0">CommandArea</a>-&gt;<a class="code" href="../../d4/d3/struct__REGISTRY__COMMAND.html#o1">Hive</a>, <a class="code" href="../../d8/d3/cmwrapr2_8c.html#a0">CommandArea</a>-&gt;<a class="code" href="../../d4/d3/struct__REGISTRY__COMMAND.html#o2">Cell</a>);
00177             <span class="keywordflow">break</span>;
00178 
00179         <span class="keywordflow">case</span> <a class="code" href="../../d1/d2/cmp_8h.html#a110">REG_CMD_REFRESH_HIVE</a>:
00180             <span class="comment">//</span>
00181             <span class="comment">// Refresh hive to match last flushed version</span>
00182             <span class="comment">//</span>
00183             <a class="code" href="../../d0/d2/hivesync_8c.html#a6">HvRefreshHive</a>(<a class="code" href="../../d8/d3/cmwrapr2_8c.html#a0">CommandArea</a>-&gt;<a class="code" href="../../d4/d3/struct__REGISTRY__COMMAND.html#o1">Hive</a>);
00184             <span class="keywordflow">break</span>;
00185 
00186         <span class="keywordflow">case</span> <a class="code" href="../../d1/d2/cmp_8h.html#a103">REG_CMD_FILE_SET_SIZE</a>:
00187             <a class="code" href="../../d8/d3/cmwrapr2_8c.html#a0">CommandArea</a>-&gt;<a class="code" href="../../d4/d3/struct__REGISTRY__COMMAND.html#o5">Status</a> = <a class="code" href="../../d7/d3/cmwrapr_8c.html#a13">CmpDoFileSetSize</a>(
00188                                     <a class="code" href="../../d8/d3/cmwrapr2_8c.html#a0">CommandArea</a>-&gt;<a class="code" href="../../d4/d3/struct__REGISTRY__COMMAND.html#o1">Hive</a>,
00189                                     <a class="code" href="../../d8/d3/cmwrapr2_8c.html#a0">CommandArea</a>-&gt;<a class="code" href="../../d4/d3/struct__REGISTRY__COMMAND.html#o3">FileType</a>,
00190                                     <a class="code" href="../../d8/d3/cmwrapr2_8c.html#a0">CommandArea</a>-&gt;<a class="code" href="../../d4/d3/struct__REGISTRY__COMMAND.html#o4">FileSize</a>
00191                                     );
00192             <span class="keywordflow">break</span>;
00193 
00194         <span class="keywordflow">case</span> <a class="code" href="../../d1/d2/cmp_8h.html#a104">REG_CMD_HIVE_OPEN</a>:
00195 
00196             <span class="comment">//</span>
00197             <span class="comment">// Open the file.</span>
00198             <span class="comment">//</span>
00199             <a class="code" href="../../d2/d2/rtload_8c.html#a3">FileName</a> = <a class="code" href="../../d8/d3/cmwrapr2_8c.html#a0">CommandArea</a>-&gt;<a class="code" href="../../d4/d3/struct__REGISTRY__COMMAND.html#o6">FileAttributes</a>-&gt;ObjectName;
00200 
00201             <a class="code" href="../../d8/d3/cmwrapr2_8c.html#a0">CommandArea</a>-&gt;<a class="code" href="../../d4/d3/struct__REGISTRY__COMMAND.html#o5">Status</a> = <a class="code" href="../../d1/d3/cmsysini_8c.html#a52">CmpInitHiveFromFile</a>(FileName,
00202                                                      0,
00203                                                      &amp;<a class="code" href="../../d8/d3/cmwrapr2_8c.html#a0">CommandArea</a>-&gt;<a class="code" href="../../d4/d3/struct__REGISTRY__COMMAND.html#o7">CmHive</a>,
00204                                                      &amp;<a class="code" href="../../d8/d3/cmwrapr2_8c.html#a0">CommandArea</a>-&gt;<a class="code" href="../../d4/d3/struct__REGISTRY__COMMAND.html#o10">Allocate</a>,
00205                                                      &amp;<a class="code" href="../../d8/d3/cmwrapr2_8c.html#a0">CommandArea</a>-&gt;<a class="code" href="../../d4/d3/struct__REGISTRY__COMMAND.html#o12">RegistryLockAquired</a>);
00206             <span class="comment">//</span>
00207             <span class="comment">// NT Servers will return STATUS_ACCESS_DENIED. Netware 3.1x</span>
00208             <span class="comment">// servers could return any of the other error codes if the GUEST</span>
00209             <span class="comment">// account is disabled.</span>
00210             <span class="comment">//</span>
00211             <span class="keywordflow">if</span> (((<a class="code" href="../../d8/d3/cmwrapr2_8c.html#a0">CommandArea</a>-&gt;<a class="code" href="../../d4/d3/struct__REGISTRY__COMMAND.html#o5">Status</a> == STATUS_ACCESS_DENIED) ||
00212                  (<a class="code" href="../../d8/d3/cmwrapr2_8c.html#a0">CommandArea</a>-&gt;<a class="code" href="../../d4/d3/struct__REGISTRY__COMMAND.html#o5">Status</a> == STATUS_NO_SUCH_USER) ||
00213                  (<a class="code" href="../../d8/d3/cmwrapr2_8c.html#a0">CommandArea</a>-&gt;<a class="code" href="../../d4/d3/struct__REGISTRY__COMMAND.html#o5">Status</a> == STATUS_WRONG_PASSWORD) ||
00214                  (<a class="code" href="../../d8/d3/cmwrapr2_8c.html#a0">CommandArea</a>-&gt;<a class="code" href="../../d4/d3/struct__REGISTRY__COMMAND.html#o5">Status</a> == STATUS_ACCOUNT_EXPIRED) ||
00215                  (<a class="code" href="../../d8/d3/cmwrapr2_8c.html#a0">CommandArea</a>-&gt;<a class="code" href="../../d4/d3/struct__REGISTRY__COMMAND.html#o5">Status</a> == STATUS_ACCOUNT_DISABLED) ||
00216                  (<a class="code" href="../../d8/d3/cmwrapr2_8c.html#a0">CommandArea</a>-&gt;<a class="code" href="../../d4/d3/struct__REGISTRY__COMMAND.html#o5">Status</a> == STATUS_ACCOUNT_RESTRICTION)) &amp;&amp;
00217                 (<a class="code" href="../../d8/d3/cmwrapr2_8c.html#a0">CommandArea</a>-&gt;<a class="code" href="../../d4/d3/struct__REGISTRY__COMMAND.html#o16">ImpersonationContext</a> != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>)) {
00218                 <span class="comment">//</span>
00219                 <span class="comment">// Impersonate the caller and try it again.  This</span>
00220                 <span class="comment">// lets us open hives on a remote machine.</span>
00221                 <span class="comment">//</span>
00222                 <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d4/d5/seclient_8c.html#a3">SeImpersonateClientEx</a>(
00223                                 <a class="code" href="../../d8/d3/cmwrapr2_8c.html#a0">CommandArea</a>-&gt;<a class="code" href="../../d4/d3/struct__REGISTRY__COMMAND.html#o16">ImpersonationContext</a>,
00224                                 NULL);
00225 
00226                 <span class="keywordflow">if</span> ( <a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>( Status ) ) {
00227 
00228                     <a class="code" href="../../d8/d3/cmwrapr2_8c.html#a0">CommandArea</a>-&gt;<a class="code" href="../../d4/d3/struct__REGISTRY__COMMAND.html#o5">Status</a> = <a class="code" href="../../d1/d3/cmsysini_8c.html#a52">CmpInitHiveFromFile</a>(FileName,
00229                                                              0,
00230                                                              &amp;<a class="code" href="../../d8/d3/cmwrapr2_8c.html#a0">CommandArea</a>-&gt;<a class="code" href="../../d4/d3/struct__REGISTRY__COMMAND.html#o7">CmHive</a>,
00231                                                              &amp;<a class="code" href="../../d8/d3/cmwrapr2_8c.html#a0">CommandArea</a>-&gt;<a class="code" href="../../d4/d3/struct__REGISTRY__COMMAND.html#o10">Allocate</a>,
00232                                                              &amp;<a class="code" href="../../d8/d3/cmwrapr2_8c.html#a0">CommandArea</a>-&gt;<a class="code" href="../../d4/d3/struct__REGISTRY__COMMAND.html#o12">RegistryLockAquired</a>);
00233                     NullHandle = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00234 
00235                     <a class="code" href="../../d6/d5/ps_2security_8c.html#a9">PsRevertToSelf</a>();
00236                 }
00237             }
00238 
00239             <span class="keywordflow">break</span>;
00240 
00241         <span class="keywordflow">case</span> <a class="code" href="../../d1/d2/cmp_8h.html#a105">REG_CMD_HIVE_CLOSE</a>:
00242 
00243             <span class="comment">//</span>
00244             <span class="comment">// Close the files associated with this hive.</span>
00245             <span class="comment">//</span>
00246             CmHive = <a class="code" href="../../d8/d3/cmwrapr2_8c.html#a0">CommandArea</a>-&gt;<a class="code" href="../../d4/d3/struct__REGISTRY__COMMAND.html#o7">CmHive</a>;
00247 
00248             <span class="keywordflow">for</span> (i=0; i&lt;<a class="code" href="../../d0/d1/hivedata_8h.html#a42">HFILE_TYPE_MAX</a>; i++) {
00249                 <span class="keywordflow">if</span> (CmHive-&gt;<a class="code" href="../../d9/d6/struct__CMHIVE.html#o1">FileHandles</a>[i] != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00250                     ZwClose(CmHive-&gt;<a class="code" href="../../d9/d6/struct__CMHIVE.html#o1">FileHandles</a>[i]);
00251                     CmHive-&gt;<a class="code" href="../../d9/d6/struct__CMHIVE.html#o1">FileHandles</a>[i] = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00252                 }
00253             }
00254             <a class="code" href="../../d8/d3/cmwrapr2_8c.html#a0">CommandArea</a>-&gt;<a class="code" href="../../d4/d3/struct__REGISTRY__COMMAND.html#o5">Status</a> = STATUS_SUCCESS;
00255             <span class="keywordflow">break</span>;
00256 
00257         <span class="keywordflow">case</span> <a class="code" href="../../d1/d2/cmp_8h.html#a111">REG_CMD_HIVE_READ</a>:
00258 
00259             <span class="comment">//</span>
00260             <span class="comment">// Used by special case of savekey, just do a read</span>
00261             <span class="comment">//</span>
00262             result = <a class="code" href="../../d7/d3/cmwrapr_8c.html#a15">CmpFileRead</a>(
00263                         (<a class="code" href="../../d7/d7/struct__HHIVE.html">PHHIVE</a>)<a class="code" href="../../d8/d3/cmwrapr2_8c.html#a0">CommandArea</a>-&gt;<a class="code" href="../../d4/d3/struct__REGISTRY__COMMAND.html#o7">CmHive</a>,
00264                         <a class="code" href="../../d8/d3/cmwrapr2_8c.html#a0">CommandArea</a>-&gt;<a class="code" href="../../d4/d3/struct__REGISTRY__COMMAND.html#o3">FileType</a>,
00265                         <a class="code" href="../../d8/d3/cmwrapr2_8c.html#a0">CommandArea</a>-&gt;<a class="code" href="../../d4/d3/struct__REGISTRY__COMMAND.html#o9">Offset</a>,
00266                         <a class="code" href="../../d8/d3/cmwrapr2_8c.html#a0">CommandArea</a>-&gt;<a class="code" href="../../d4/d3/struct__REGISTRY__COMMAND.html#o8">Buffer</a>,
00267                         <a class="code" href="../../d8/d3/cmwrapr2_8c.html#a0">CommandArea</a>-&gt;<a class="code" href="../../d4/d3/struct__REGISTRY__COMMAND.html#o4">FileSize</a>           <span class="comment">// read length</span>
00268                         );
00269             <span class="keywordflow">if</span> (result) {
00270                 <a class="code" href="../../d8/d3/cmwrapr2_8c.html#a0">CommandArea</a>-&gt;<a class="code" href="../../d4/d3/struct__REGISTRY__COMMAND.html#o5">Status</a> = STATUS_SUCCESS;
00271             } <span class="keywordflow">else</span> {
00272                 <a class="code" href="../../d8/d3/cmwrapr2_8c.html#a0">CommandArea</a>-&gt;<a class="code" href="../../d4/d3/struct__REGISTRY__COMMAND.html#o5">Status</a> = STATUS_REGISTRY_IO_FAILED;
00273             }
00274             <span class="keywordflow">break</span>;
00275 
00276         <span class="keywordflow">case</span> <a class="code" href="../../d1/d2/cmp_8h.html#a106">REG_CMD_SHUTDOWN</a>:
00277 
00278             <span class="comment">//</span>
00279             <span class="comment">// shut down the registry</span>
00280             <span class="comment">//</span>
00281             <a class="code" href="../../d1/d2/cmp_8h.html#a243">CmpDoFlushAll</a>();
00282 
00283             <span class="comment">//</span>
00284             <span class="comment">// close all the hive files</span>
00285             <span class="comment">//</span>
00286             p=<a class="code" href="../../d8/d9/cmapi_8c.html#a1">CmpHiveListHead</a>.Flink;
00287             <span class="keywordflow">while</span> (p!=&amp;<a class="code" href="../../d8/d9/cmapi_8c.html#a1">CmpHiveListHead</a>) {
00288                 CmHive = CONTAINING_RECORD(p, <a class="code" href="../../d9/d6/struct__CMHIVE.html">CMHIVE</a>, HiveList);
00289                 <span class="keywordflow">for</span> (i=0; i&lt;<a class="code" href="../../d0/d1/hivedata_8h.html#a42">HFILE_TYPE_MAX</a>; i++) {
00290                     <span class="keywordflow">if</span> (CmHive-&gt;<a class="code" href="../../d9/d6/struct__CMHIVE.html#o1">FileHandles</a>[i] != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00291                         ZwClose(CmHive-&gt;<a class="code" href="../../d9/d6/struct__CMHIVE.html#o1">FileHandles</a>[i]);
00292                         CmHive-&gt;<a class="code" href="../../d9/d6/struct__CMHIVE.html#o1">FileHandles</a>[i] = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00293                     }
00294                 }
00295                 p=p-&gt;Flink;
00296             }
00297 
00298             <span class="keywordflow">break</span>;
00299 
00300         <span class="keywordflow">case</span> <a class="code" href="../../d1/d2/cmp_8h.html#a107">REG_CMD_RENAME_HIVE</a>:
00301             <span class="comment">//</span>
00302             <span class="comment">// Rename a CmHive's primary handle</span>
00303             <span class="comment">//</span>
00304             <a class="code" href="../../d7/d0/cmdat2_8c.html#a19">Handle</a> = <a class="code" href="../../d8/d3/cmwrapr2_8c.html#a0">CommandArea</a>-&gt;<a class="code" href="../../d4/d3/struct__REGISTRY__COMMAND.html#o7">CmHive</a>-&gt;<a class="code" href="../../d9/d6/struct__CMHIVE.html#o1">FileHandles</a>[<a class="code" href="../../d0/d1/hivedata_8h.html#a38">HFILE_TYPE_PRIMARY</a>];
00305             <span class="keywordflow">if</span> (<a class="code" href="../../d8/d3/cmwrapr2_8c.html#a0">CommandArea</a>-&gt;<a class="code" href="../../d4/d3/struct__REGISTRY__COMMAND.html#o14">OldName</a> != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00306                 <a class="code" href="../../d1/d2/cmp_8h.html#a63">ASSERT_PASSIVE_LEVEL</a>();
00307                 <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = ZwQueryObject(Handle,
00308                                        ObjectNameInformation,
00309                                        <a class="code" href="../../d8/d3/cmwrapr2_8c.html#a0">CommandArea</a>-&gt;<a class="code" href="../../d4/d3/struct__REGISTRY__COMMAND.html#o14">OldName</a>,
00310                                        <a class="code" href="../../d8/d3/cmwrapr2_8c.html#a0">CommandArea</a>-&gt;<a class="code" href="../../d4/d3/struct__REGISTRY__COMMAND.html#o15">NameInfoLength</a>,
00311                                        &amp;<a class="code" href="../../d8/d3/cmwrapr2_8c.html#a0">CommandArea</a>-&gt;<a class="code" href="../../d4/d3/struct__REGISTRY__COMMAND.html#o15">NameInfoLength</a>);
00312                 <span class="keywordflow">if</span> (!<a class="code" href="../../d5/d6/stierr_8h.html#a0">NT_SUCCESS</a>(Status)) {
00313                     <a class="code" href="../../d8/d3/cmwrapr2_8c.html#a0">CommandArea</a>-&gt;<a class="code" href="../../d4/d3/struct__REGISTRY__COMMAND.html#o5">Status</a> = <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
00314                     <span class="keywordflow">break</span>;
00315                 }
00316             }
00317 
00318             RenameInfo = <a class="code" href="../../d5/d5/cc_8h.html#a10">ExAllocatePool</a>(PagedPool,
00319                                         <span class="keyword">sizeof</span>(FILE_RENAME_INFORMATION) +
00320                                         <a class="code" href="../../d8/d3/cmwrapr2_8c.html#a0">CommandArea</a>-&gt;<a class="code" href="../../d4/d3/struct__REGISTRY__COMMAND.html#o13">NewName</a>-&gt;Length);
00321             <span class="keywordflow">if</span> (RenameInfo == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00322                 <a class="code" href="../../d8/d3/cmwrapr2_8c.html#a0">CommandArea</a>-&gt;<a class="code" href="../../d4/d3/struct__REGISTRY__COMMAND.html#o5">Status</a> = STATUS_INSUFFICIENT_RESOURCES;
00323                 <span class="keywordflow">break</span>;
00324             }
00325             RenameInfo-&gt;ReplaceIfExists = <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>;
00326             RenameInfo-&gt;RootDirectory = <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00327             RenameInfo-&gt;FileNameLength = <a class="code" href="../../d8/d3/cmwrapr2_8c.html#a0">CommandArea</a>-&gt;<a class="code" href="../../d4/d3/struct__REGISTRY__COMMAND.html#o13">NewName</a>-&gt;Length;
00328             RtlMoveMemory(RenameInfo-&gt;FileName,
00329                           <a class="code" href="../../d8/d3/cmwrapr2_8c.html#a0">CommandArea</a>-&gt;<a class="code" href="../../d4/d3/struct__REGISTRY__COMMAND.html#o13">NewName</a>-&gt;Buffer,
00330                           <a class="code" href="../../d8/d3/cmwrapr2_8c.html#a0">CommandArea</a>-&gt;<a class="code" href="../../d4/d3/struct__REGISTRY__COMMAND.html#o13">NewName</a>-&gt;Length);
00331 
00332             <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d6/d9/restrfil_8c.html#a39">ZwSetInformationFile</a>(Handle,
00333                                           &amp;IoStatusBlock,
00334                                           (PVOID)RenameInfo,
00335                                           <span class="keyword">sizeof</span>(FILE_RENAME_INFORMATION) +
00336                                           <a class="code" href="../../d8/d3/cmwrapr2_8c.html#a0">CommandArea</a>-&gt;<a class="code" href="../../d4/d3/struct__REGISTRY__COMMAND.html#o13">NewName</a>-&gt;Length,
00337                                           FileRenameInformation);
00338             <a class="code" href="../../d5/d8/ex_8h.html#a224">ExFreePool</a>(RenameInfo);
00339             <a class="code" href="../../d8/d3/cmwrapr2_8c.html#a0">CommandArea</a>-&gt;<a class="code" href="../../d4/d3/struct__REGISTRY__COMMAND.html#o5">Status</a> = <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
00340             <span class="keywordflow">break</span>;
00341 
00342         <span class="keywordflow">case</span> <a class="code" href="../../d1/d2/cmp_8h.html#a108">REG_CMD_ADD_HIVE_LIST</a>:
00343             <span class="comment">//</span>
00344             <span class="comment">// Add a hive to the hive file list</span>
00345             <span class="comment">//</span>
00346             <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a> = <a class="code" href="../../d1/d2/cmp_8h.html#a309">CmpAddToHiveFileList</a>(<a class="code" href="../../d8/d3/cmwrapr2_8c.html#a0">CommandArea</a>-&gt;<a class="code" href="../../d4/d3/struct__REGISTRY__COMMAND.html#o7">CmHive</a>);
00347             <a class="code" href="../../d8/d3/cmwrapr2_8c.html#a0">CommandArea</a>-&gt;<a class="code" href="../../d4/d3/struct__REGISTRY__COMMAND.html#o5">Status</a> = <a class="code" href="../../d1/d0/cmchek_8c.html#a4">Status</a>;
00348             <span class="keywordflow">break</span>;
00349 
00350         <span class="keywordflow">case</span> <a class="code" href="../../d1/d2/cmp_8h.html#a109">REG_CMD_REMOVE_HIVE_LIST</a>:
00351             <span class="comment">//</span>
00352             <span class="comment">// Remove a hive from the hive file list</span>
00353             <span class="comment">//</span>
00354             <a class="code" href="../../d1/d2/cmp_8h.html#a310">CmpRemoveFromHiveFileList</a>(<a class="code" href="../../d8/d3/cmwrapr2_8c.html#a0">CommandArea</a>-&gt;<a class="code" href="../../d4/d3/struct__REGISTRY__COMMAND.html#o7">CmHive</a>);
00355             <a class="code" href="../../d8/d3/cmwrapr2_8c.html#a0">CommandArea</a>-&gt;<a class="code" href="../../d4/d3/struct__REGISTRY__COMMAND.html#o5">Status</a> = STATUS_SUCCESS;
00356             <span class="keywordflow">break</span>;
00357 
00358         <span class="keywordflow">default</span>:
00359             <a class="code" href="../../d9/d1/bugcheck_8c.html#a19">KeBugCheckEx</a>(REGISTRY_ERROR,6,1,0,0);
00360 
00361     } <span class="comment">// switch</span>
00362 
00363     <span class="keywordflow">return</span>;
00364 }

</div></pre>    </td>
  </tr>
</table>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="a14" doxytag="cmworker.c::CmpCannotWriteConfiguration" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN <a class="el" href="../../d5/d3/cmworker_8c.html#a14">CmpCannotWriteConfiguration</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d2/cmworker_8c-source.html#l00071">71</a> of file <a class="el" href="../../d6/d2/cmworker_8c-source.html">cmworker.c</a>.
<p>
Referenced by <a class="el" href="../../d6/d2/cmworker_8c-source.html#l00556">CmpDiskFullWarning()</a>, <a class="el" href="../../d2/d2/cmsysini_8c-source.html#l00726">CmpInitializeHiveList()</a>, and <a class="el" href="../../d6/d2/cmworker_8c-source.html#l00461">CmpLazyFlushWorker()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a13" doxytag="cmworker.c::CmpDiskFullWorkerPopupDisplayed" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN <a class="el" href="../../d5/d3/cmworker_8c.html#a13">CmpDiskFullWorkerPopupDisplayed</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d2/cmworker_8c-source.html#l00066">66</a> of file <a class="el" href="../../d6/d2/cmworker_8c-source.html">cmworker.c</a>.
<p>
Referenced by <a class="el" href="../../d6/d2/cmworker_8c-source.html#l00556">CmpDiskFullWarning()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a3" doxytag="cmworker.c::CmpHiveListHead" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> LIST_ENTRY <a class="el" href="../../d9/d4/edithive_8c.html#a2">CmpHiveListHead</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d2/cmworker_8c-source.html#l00026">26</a> of file <a class="el" href="../../d6/d2/cmworker_8c-source.html">cmworker.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a6" doxytag="cmworker.c::CmpLazyFlushDpc" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d1/d6/struct__KDPC.html">KDPC</a> <a class="el" href="../../d5/d3/cmworker_8c.html#a6">CmpLazyFlushDpc</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d2/cmworker_8c-source.html#l00053">53</a> of file <a class="el" href="../../d6/d2/cmworker_8c-source.html">cmworker.c</a>.
<p>
Referenced by <a class="el" href="../../d6/d2/cmworker_8c-source.html#l00368">CmpLazyFlush()</a>, and <a class="el" href="../../d6/d2/cmworker_8c-source.html#l00115">CmpWorker()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a8" doxytag="cmworker.c::CmpLazyFlushPending" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN <a class="el" href="../../d5/d3/cmworker_8c.html#a8">CmpLazyFlushPending</a> = FALSE          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d2/cmworker_8c-source.html#l00056">56</a> of file <a class="el" href="../../d6/d2/cmworker_8c-source.html">cmworker.c</a>.
<p>
Referenced by <a class="el" href="../../d6/d2/cmworker_8c-source.html#l00416">CmpLazyFlushDpcRoutine()</a>, and <a class="el" href="../../d6/d2/cmworker_8c-source.html#l00461">CmpLazyFlushWorker()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a5" doxytag="cmworker.c::CmpLazyFlushTimer" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d3/d8/struct__KTIMER.html">KTIMER</a> <a class="el" href="../../d5/d3/cmworker_8c.html#a5">CmpLazyFlushTimer</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d2/cmworker_8c-source.html#l00052">52</a> of file <a class="el" href="../../d6/d2/cmworker_8c-source.html">cmworker.c</a>.
<p>
Referenced by <a class="el" href="../../d6/d2/cmworker_8c-source.html#l00368">CmpLazyFlush()</a>, and <a class="el" href="../../d6/d2/cmworker_8c-source.html#l00115">CmpWorker()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a7" doxytag="cmworker.c::CmpLazyWorkItem" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d7/d9/struct__WORK__QUEUE__ITEM.html">WORK_QUEUE_ITEM</a> <a class="el" href="../../d5/d3/cmworker_8c.html#a7">CmpLazyWorkItem</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d2/cmworker_8c-source.html#l00054">54</a> of file <a class="el" href="../../d6/d2/cmworker_8c-source.html">cmworker.c</a>.
<p>
Referenced by <a class="el" href="../../d6/d2/cmworker_8c-source.html#l00416">CmpLazyFlushDpcRoutine()</a>, and <a class="el" href="../../d6/d2/cmworker_8c-source.html#l00115">CmpWorker()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a9" doxytag="cmworker.c::CmpNoWrite" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN <a class="el" href="../../d6/d3/cmwraper_8c.html#a4">CmpNoWrite</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d2/cmworker_8c-source.html#l00058">58</a> of file <a class="el" href="../../d6/d2/cmworker_8c-source.html">cmworker.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a12" doxytag="cmworker.c::CmpProfileLoaded" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN <a class="el" href="../../d5/d3/cmworker_8c.html#a12">CmpProfileLoaded</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d2/cmworker_8c-source.html#l00061">61</a> of file <a class="el" href="../../d6/d2/cmworker_8c-source.html">cmworker.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a4" doxytag="cmworker.c::CmpSystemProcess" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="../../d5/d7/struct__KPROCESS.html">PKPROCESS</a> <a class="el" href="../../d5/d3/cmworker_8c.html#a4">CmpSystemProcess</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d2/cmworker_8c-source.html#l00051">51</a> of file <a class="el" href="../../d6/d2/cmworker_8c-source.html">cmworker.c</a>.
<p>
Referenced by <a class="el" href="../../d2/d2/cmsysini_8c-source.html#l00293">CmInitSystem1()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a10" doxytag="cmworker.c::CmpWasSetupBoot" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN <a class="el" href="../../d5/d3/cmworker_8c.html#a10">CmpWasSetupBoot</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d2/cmworker_8c-source.html#l00059">59</a> of file <a class="el" href="../../d6/d2/cmworker_8c-source.html">cmworker.c</a>.    </td>
  </tr>
</table>
<a class="anchor" name="a11" doxytag="cmworker.c::HvShutdownComplete" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> BOOLEAN <a class="el" href="../../d0/d2/hivesync_8c.html#a1">HvShutdownComplete</a>          </td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="../../d6/d2/cmworker_8c-source.html#l00060">60</a> of file <a class="el" href="../../d6/d2/cmworker_8c-source.html">cmworker.c</a>.    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:43:12 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
