<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: tprefix.c Source File</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>tprefix.c</h1><a href="../../d4/d4/tprefix_8c.html">Go to the documentation of this file.</a><pre class="fragment"><div>00001 <span class="comment">/*++</span>
00002 <span class="comment"></span>
00003 <span class="comment">Copyright (c) 1989  Microsoft Corporation</span>
00004 <span class="comment"></span>
00005 <span class="comment">Module Name:</span>
00006 <span class="comment"></span>
00007 <span class="comment">    tprefix.c</span>
00008 <span class="comment"></span>
00009 <span class="comment">Abstract:</span>
00010 <span class="comment"></span>
00011 <span class="comment">    Test program for the Prefix table package</span>
00012 <span class="comment"></span>
00013 <span class="comment">Author:</span>
00014 <span class="comment"></span>
00015 <span class="comment">    Gary Kimura     [GaryKi]    03-Aug-1989</span>
00016 <span class="comment"></span>
00017 <span class="comment">Revision History:</span>
00018 <span class="comment"></span>
00019 <span class="comment">--*/</span>
00020 
00021 <span class="preprocessor">#include &lt;stdio.h&gt;</span>
00022 <span class="preprocessor">#include &lt;string.h&gt;</span>
00023 
00024 <span class="preprocessor">#include "nt.h"</span>
00025 <span class="preprocessor">#include "ntrtl.h"</span>
00026 
00027 <span class="comment">//</span>
00028 <span class="comment">//  Routines and types for generating random prefixes</span>
00029 <span class="comment">//</span>
00030 
00031 ULONG <a class="code" href="../../d8/d6/ttri_8c.html#a4">RtlRandom</a> ( IN OUT PULONG Seed );
<a name="l00032"></a><a class="code" href="../../d4/d4/tprefix_8c.html#a2">00032</a> ULONG <a class="code" href="../../d4/d4/tprefix_8c.html#a2">Seed</a>;
00033 
00034 PSZ <a class="code" href="../../d4/d4/tprefix_8c.html#a12">AnotherPrefix</a>(IN ULONG MaxNameLength);
<a name="l00035"></a><a class="code" href="../../d4/d4/tprefix_8c.html#a3">00035</a> ULONG <a class="code" href="../../d4/d4/tprefix_8c.html#a3">AlphabetLength</a>;
00036 
00037 <span class="comment">//PSZ Alphabet = "AlphaBravoCharlieDeltaEchoFoxtrotGolfHotelIndiaJuliettKiloLimaMikeNovemberOscarPapaQuebecRomeoSierraTangoUniformVictorWhiskeyXrayYankeeZulu";</span>
00038 
<a name="l00039"></a><a class="code" href="../../d4/d4/tprefix_8c.html#a4">00039</a> PSZ <a class="code" href="../../d4/d4/tprefix_8c.html#a4">Alphabet</a> = <span class="stringliteral">"\</span>
00040 <span class="stringliteral">Aa\</span>
00041 <span class="stringliteral">BBbb\</span>
00042 <span class="stringliteral">CCCccc\</span>
00043 <span class="stringliteral">DDDDdddd\</span>
00044 <span class="stringliteral">EEEEEeeeee\</span>
00045 <span class="stringliteral">FFFFFFffffff\</span>
00046 <span class="stringliteral">GGGGGGGggggggg\</span>
00047 <span class="stringliteral">HHHHHHHHhhhhhhhh\</span>
00048 <span class="stringliteral">IIIIIIIIIiiiiiiiii\</span>
00049 <span class="stringliteral">JJJJJJJJJJjjjjjjjjjj\</span>
00050 <span class="stringliteral">KKKKKKKKKKKkkkkkkkkkkk\</span>
00051 <span class="stringliteral">LLLLLLLLLLLLllllllllllll\</span>
00052 <span class="stringliteral">MMMMMMMMMMMMMmmmmmmmmmmmmm\</span>
00053 <span class="stringliteral">NNNNNNNNNNNNNNnnnnnnnnnnnnnn\</span>
00054 <span class="stringliteral">OOOOOOOOOOOOOOOooooooooooooooo\</span>
00055 <span class="stringliteral">PPPPPPPPPPPPPPPPpppppppppppppppp\</span>
00056 <span class="stringliteral">QQQQQQQQQQQQQQQQQqqqqqqqqqqqqqqqqq\</span>
00057 <span class="stringliteral">RRRRRRRRRRRRRRRRRRrrrrrrrrrrrrrrrrrr\</span>
00058 <span class="stringliteral">SSSSSSSSSSSSSSSSSSSsssssssssssssssssss\</span>
00059 <span class="stringliteral">TTTTTTTTTTTTTTTTTTTTtttttttttttttttttttt\</span>
00060 <span class="stringliteral">UUUUUUUUUUUUUUUUUUUUUuuuuuuuuuuuuuuuuuuuuu\</span>
00061 <span class="stringliteral">VVVVVVVVVVVVVVVVVVVVVVvvvvvvvvvvvvvvvvvvvvvv\</span>
00062 <span class="stringliteral">WWWWWWWWWWWWWWWWWWWWWWWwwwwwwwwwwwwwwwwwwwwwww\</span>
00063 <span class="stringliteral">XXXXXXXXXXXXXXXXXXXXXXXXxxxxxxxxxxxxxxxxxxxxxxxx\</span>
00064 <span class="stringliteral">YYYYYYYYYYYYYYYYYYYYYYYYYyyyyyyyyyyyyyyyyyyyyyyyyy\</span>
00065 <span class="stringliteral">ZZZZZZZZZZZZZZZZZZZZZZZZZZzzzzzzzzzzzzzzzzzzzzzzzzzz"</span>;
00066 
<a name="l00067"></a><a class="code" href="../../d4/d4/tprefix_8c.html#a0">00067</a> <span class="preprocessor">#define BUFFER_LENGTH 8192</span>
00068 <span class="preprocessor"></span>
<a name="l00069"></a><a class="code" href="../../d4/d4/tprefix_8c.html#a5">00069</a> <a class="code" href="../../d1/d1/bench_8c.html#a16">CHAR</a> <a class="code" href="../../d6/d2/rtqkey_8c.html#a3">Buffer</a>[<a class="code" href="../../d5/d0/pnpeisa_8c.html#a1">BUFFER_LENGTH</a>];
<a name="l00070"></a><a class="code" href="../../d4/d4/tprefix_8c.html#a6">00070</a> ULONG <a class="code" href="../../d4/d4/tprefix_8c.html#a6">NextBufferChar</a> = 0;
00071 
00072 <span class="comment">//</span>
00073 <span class="comment">//  record structure and variables for the prefix table and it</span>
00074 <span class="comment">//  elements</span>
00075 <span class="comment">//</span>
00076 
<a name="l00077"></a><a class="code" href="../../d6/d9/struct__PREFIX__NODE.html">00077</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d6/d9/struct__PREFIX__NODE.html">_PREFIX_NODE</a> {
<a name="l00078"></a><a class="code" href="../../d6/d9/struct__PREFIX__NODE.html#o0">00078</a>     PREFIX_TABLE_ENTRY <a class="code" href="../../d6/d9/struct__PREFIX__NODE.html#o0">PfxEntry</a>;
<a name="l00079"></a><a class="code" href="../../d6/d9/struct__PREFIX__NODE.html#o1">00079</a>     STRING <a class="code" href="../../d6/d9/struct__PREFIX__NODE.html#o1">String</a>;
00080 } <a class="code" href="../../d6/d9/struct__PREFIX__NODE.html">PREFIX_NODE</a>;
<a name="l00081"></a><a class="code" href="../../d4/d4/tprefix_8c.html#a8">00081</a> <span class="keyword">typedef</span> <a class="code" href="../../d6/d9/struct__PREFIX__NODE.html">PREFIX_NODE</a> *<a class="code" href="../../d6/d9/struct__PREFIX__NODE.html">PPREFIX_NODE</a>;
00082 
<a name="l00083"></a><a class="code" href="../../d4/d4/tprefix_8c.html#a1">00083</a> <span class="preprocessor">#define PREFIXES 512</span>
00084 <span class="preprocessor"></span>
<a name="l00085"></a><a class="code" href="../../d4/d4/tprefix_8c.html#a9">00085</a> <a class="code" href="../../d6/d9/struct__PREFIX__NODE.html">PREFIX_NODE</a> <a class="code" href="../../d4/d4/tprefix_8c.html#a9">Prefixes</a>[<a class="code" href="../../d4/d4/tprefix_8c.html#a1">PREFIXES</a>];
00086 
<a name="l00087"></a><a class="code" href="../../d4/d4/tprefix_8c.html#a10">00087</a> PREFIX_TABLE <a class="code" href="../../d4/d4/tprefix_8c.html#a10">PrefixTable</a>;
00088 
00089 <span class="keywordtype">int</span>
<a name="l00090"></a><a class="code" href="../../d4/d4/tprefix_8c.html#a13">00090</a> <a class="code" href="../../d2/d5/editreg_8c.html#a87">main</a>(
00091     <span class="keywordtype">int</span> argc,
00092     <span class="keywordtype">char</span> *argv[]
00093     )
00094 {
00095     ULONG i;
00096     PSZ Psz;
00097 
00098     PPREFIX_TABLE_ENTRY PfxEntry;
00099     <a class="code" href="../../d4/d4/tprefix_8c.html#a8">PPREFIX_NODE</a> PfxNode;
00100 
00101     STRING <a class="code" href="../../d4/d9/talloc_8c.html#a0">String</a>;
00102 
00103     <span class="comment">//</span>
00104     <span class="comment">//  We're starting the test</span>
00105     <span class="comment">//</span>
00106 
00107     <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"Start Prefix Test\n"</span>);
00108 
00109     <span class="comment">//</span>
00110     <span class="comment">//  Calculate the alphabet size for use by AnotherPrefix</span>
00111     <span class="comment">//</span>
00112 
00113     <a class="code" href="../../d4/d4/tprefix_8c.html#a3">AlphabetLength</a> = <a class="code" href="../../d2/d7/regtest_8c.html#a2">strlen</a>(<a class="code" href="../../d4/d4/tprefix_8c.html#a4">Alphabet</a>);
00114 
00115     <span class="comment">//</span>
00116     <span class="comment">//  Initialize the prefix table</span>
00117     <span class="comment">//</span>
00118 
00119     <a class="code" href="../../d4/d4/prefix_8c.html#a16">PfxInitialize</a>(&amp;<a class="code" href="../../d4/d4/tprefix_8c.html#a10">PrefixTable</a>);
00120 
00121     <span class="comment">//</span>
00122     <span class="comment">//  Insert the root prefix</span>
00123     <span class="comment">//</span>
00124 
00125     <a class="code" href="../../d2/d7/string_8c.html#a5">RtlInitString</a>( &amp;<a class="code" href="../../d4/d4/tprefix_8c.html#a9">Prefixes</a>[i].<a class="code" href="../../d4/d9/talloc_8c.html#a0">String</a>, <span class="stringliteral">"\\"</span> );
00126     <span class="keywordflow">if</span> (<a class="code" href="../../d4/d4/prefix_8c.html#a17">PfxInsertPrefix</a>( &amp;<a class="code" href="../../d4/d4/tprefix_8c.html#a10">PrefixTable</a>,
00127                          &amp;<a class="code" href="../../d4/d4/tprefix_8c.html#a9">Prefixes</a>[0].<a class="code" href="../../d4/d9/talloc_8c.html#a0">String</a>,
00128                          &amp;<a class="code" href="../../d4/d4/tprefix_8c.html#a9">Prefixes</a>[0].PfxEntry )) {
00129         <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"Insert root prefix\n"</span>);
00130     } <span class="keywordflow">else</span> {
00131         <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"error inserting root prefix\n"</span>);
00132     }
00133 
00134     <span class="comment">//</span>
00135     <span class="comment">//  Insert prefixes</span>
00136     <span class="comment">//</span>
00137 
00138     <a class="code" href="../../d4/d4/tprefix_8c.html#a2">Seed</a> = 0;
00139 
00140     <span class="keywordflow">for</span> (i = 1, Psz = <a class="code" href="../../d4/d4/tprefix_8c.html#a12">AnotherPrefix</a>(3);
00141          (i &lt; <a class="code" href="../../d4/d4/tprefix_8c.html#a1">PREFIXES</a>) &amp;&amp; (Psz != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>);
00142          i += 1, Psz = <a class="code" href="../../d4/d4/tprefix_8c.html#a12">AnotherPrefix</a>(3)) {
00143 
00144         <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"[0x%x] = "</span>, i);
00145         <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"\"%s\""</span>, Psz);
00146 
00147         <a class="code" href="../../d2/d7/string_8c.html#a5">RtlInitString</a>(&amp;<a class="code" href="../../d4/d4/tprefix_8c.html#a9">Prefixes</a>[i].<a class="code" href="../../d4/d9/talloc_8c.html#a0">String</a>, Psz);
00148 
00149         <span class="keywordflow">if</span> (<a class="code" href="../../d4/d4/prefix_8c.html#a17">PfxInsertPrefix</a>( &amp;<a class="code" href="../../d4/d4/tprefix_8c.html#a10">PrefixTable</a>,
00150                              &amp;<a class="code" href="../../d4/d4/tprefix_8c.html#a9">Prefixes</a>[i].<a class="code" href="../../d4/d9/talloc_8c.html#a0">String</a>,
00151                              &amp;<a class="code" href="../../d4/d4/tprefix_8c.html#a9">Prefixes</a>[i].PfxEntry )) {
00152 
00153             <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">" inserted in table\n"</span>);
00154 
00155         } <span class="keywordflow">else</span> {
00156 
00157             <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">" already in table\n"</span>);
00158 
00159         }
00160 
00161     }
00162 
00163     <span class="comment">//</span>
00164     <span class="comment">//  Enumerate the prefix table</span>
00165     <span class="comment">//</span>
00166 
00167     <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"Enumerate Prefix Table the first time\n"</span>);
00168 
00169     <span class="keywordflow">for</span> (PfxEntry = PfxNextPrefix(&amp;<a class="code" href="../../d4/d4/tprefix_8c.html#a10">PrefixTable</a>, <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00170          PfxEntry != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00171          PfxEntry = PfxNextPrefix(&amp;<a class="code" href="../../d4/d4/tprefix_8c.html#a10">PrefixTable</a>, <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>)) {
00172 
00173         PfxNode = CONTAINING_RECORD(PfxEntry, <a class="code" href="../../d6/d9/struct__PREFIX__NODE.html">PREFIX_NODE</a>, PfxEntry);
00174 
00175         <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"%s\n"</span>, PfxNode-&gt;<a class="code" href="../../d6/d9/struct__PREFIX__NODE.html#o1">String</a>.Buffer);
00176 
00177     }
00178 
00179     <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"Start Prefix search 0x%x\n"</span>, <a class="code" href="../../d4/d4/tprefix_8c.html#a6">NextBufferChar</a>);
00180 
00181     <span class="comment">//</span>
00182     <span class="comment">//  Search for prefixes</span>
00183     <span class="comment">//</span>
00184 
00185     <span class="keywordflow">for</span> (Psz = <a class="code" href="../../d4/d4/tprefix_8c.html#a12">AnotherPrefix</a>(4); Psz != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>; Psz = <a class="code" href="../../d4/d4/tprefix_8c.html#a12">AnotherPrefix</a>(4)) {
00186 
00187         <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"0x%x "</span>, <a class="code" href="../../d4/d4/tprefix_8c.html#a6">NextBufferChar</a>);
00188 
00189         <a class="code" href="../../d2/d7/string_8c.html#a5">RtlInitString</a>(&amp;<a class="code" href="../../d4/d9/talloc_8c.html#a0">String</a>, Psz);
00190 
00191         PfxEntry = <a class="code" href="../../d4/d4/prefix_8c.html#a19">PfxFindPrefix</a>( &amp;<a class="code" href="../../d4/d4/tprefix_8c.html#a10">PrefixTable</a>, &amp;<a class="code" href="../../d4/d9/talloc_8c.html#a0">String</a>, <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a> );
00192 
00193         <span class="keywordflow">if</span> (PfxEntry == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00194 
00195             PfxEntry = <a class="code" href="../../d4/d4/prefix_8c.html#a19">PfxFindPrefix</a>( &amp;<a class="code" href="../../d4/d4/tprefix_8c.html#a10">PrefixTable</a>, &amp;<a class="code" href="../../d4/d9/talloc_8c.html#a0">String</a>, <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a> );
00196 
00197             <span class="keywordflow">if</span> (PfxEntry == <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>) {
00198 
00199                 <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"Not found      \"%s\"\n"</span>, Psz);
00200 
00201                 NOTHING;
00202 
00203             } <span class="keywordflow">else</span> {
00204 
00205                 PfxNode = CONTAINING_RECORD(PfxEntry, <a class="code" href="../../d6/d9/struct__PREFIX__NODE.html">PREFIX_NODE</a>, PfxEntry);
00206 
00207                 <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"Case blind     \"%s\" is \"%s\"\n"</span>, Psz, PfxNode-&gt;<a class="code" href="../../d6/d9/struct__PREFIX__NODE.html#o1">String</a>.Buffer);
00208 
00209                 <a class="code" href="../../d4/d4/prefix_8c.html#a18">PfxRemovePrefix</a>( &amp;<a class="code" href="../../d4/d4/tprefix_8c.html#a10">PrefixTable</a>, PfxEntry );
00210 
00211             }
00212 
00213         } <span class="keywordflow">else</span> {
00214 
00215             PfxNode = CONTAINING_RECORD(PfxEntry, <a class="code" href="../../d6/d9/struct__PREFIX__NODE.html">PREFIX_NODE</a>, PfxEntry);
00216 
00217             <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(    <span class="stringliteral">"Case sensitive \"%s\" is \"%s\"\n"</span>, Psz, PfxNode-&gt;<a class="code" href="../../d6/d9/struct__PREFIX__NODE.html#o1">String</a>.Buffer);
00218 
00219             <span class="keywordflow">if</span> (PfxNode != &amp;<a class="code" href="../../d4/d4/tprefix_8c.html#a9">Prefixes</a>[0]) {
00220 
00221                 <a class="code" href="../../d4/d4/prefix_8c.html#a18">PfxRemovePrefix</a>( &amp;<a class="code" href="../../d4/d4/tprefix_8c.html#a10">PrefixTable</a>, PfxEntry );
00222 
00223             }
00224 
00225         }
00226 
00227     }
00228 
00229     <span class="comment">//</span>
00230     <span class="comment">//  Enumerate the prefix table</span>
00231     <span class="comment">//</span>
00232 
00233     <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"Enumerate Prefix Table a second time\n"</span>);
00234 
00235     <span class="keywordflow">for</span> (PfxEntry = PfxNextPrefix(&amp;<a class="code" href="../../d4/d4/tprefix_8c.html#a10">PrefixTable</a>, <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00236          PfxEntry != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00237          PfxEntry = PfxNextPrefix(&amp;<a class="code" href="../../d4/d4/tprefix_8c.html#a10">PrefixTable</a>, <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>)) {
00238 
00239         PfxNode = CONTAINING_RECORD(PfxEntry, <a class="code" href="../../d6/d9/struct__PREFIX__NODE.html">PREFIX_NODE</a>, PfxEntry);
00240 
00241         <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"%s\n"</span>, PfxNode-&gt;<a class="code" href="../../d6/d9/struct__PREFIX__NODE.html#o1">String</a>.Buffer);
00242 
00243     }
00244 
00245     <span class="comment">//</span>
00246     <span class="comment">//  Now enumerate and zero out the table</span>
00247     <span class="comment">//</span>
00248 
00249     <span class="keywordflow">for</span> (PfxEntry = PfxNextPrefix(&amp;<a class="code" href="../../d4/d4/tprefix_8c.html#a10">PrefixTable</a>, <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00250          PfxEntry != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00251          PfxEntry = PfxNextPrefix(&amp;<a class="code" href="../../d4/d4/tprefix_8c.html#a10">PrefixTable</a>, <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>)) {
00252 
00253         PfxNode = CONTAINING_RECORD(PfxEntry, <a class="code" href="../../d6/d9/struct__PREFIX__NODE.html">PREFIX_NODE</a>, PfxEntry);
00254 
00255         <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"Delete %s\n"</span>, PfxNode-&gt;<a class="code" href="../../d6/d9/struct__PREFIX__NODE.html#o1">String</a>.Buffer);
00256 
00257         <a class="code" href="../../d4/d4/prefix_8c.html#a18">PfxRemovePrefix</a>( &amp;<a class="code" href="../../d4/d4/tprefix_8c.html#a10">PrefixTable</a>, PfxEntry );
00258 
00259     }
00260 
00261     <span class="comment">//</span>
00262     <span class="comment">//  Enumerate again but this time the table should be empty</span>
00263     <span class="comment">//</span>
00264 
00265     <span class="keywordflow">for</span> (PfxEntry = PfxNextPrefix(&amp;<a class="code" href="../../d4/d4/tprefix_8c.html#a10">PrefixTable</a>, <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>);
00266          PfxEntry != <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00267          PfxEntry = PfxNextPrefix(&amp;<a class="code" href="../../d4/d4/tprefix_8c.html#a10">PrefixTable</a>, <a class="code" href="../../d6/d7/halmips_8h.html#a457">FALSE</a>)) {
00268 
00269         PfxNode = CONTAINING_RECORD(PfxEntry, <a class="code" href="../../d6/d9/struct__PREFIX__NODE.html">PREFIX_NODE</a>, PfxEntry);
00270 
00271         <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"This Node should be gone \"%s\"\n"</span>, PfxNode-&gt;<a class="code" href="../../d6/d9/struct__PREFIX__NODE.html#o1">String</a>.Buffer);
00272 
00273     }
00274 
00275     <a class="code" href="../../d6/d6/memprint_8h.html#a7">DbgPrint</a>(<span class="stringliteral">"End PrefixTest()\n"</span>);
00276 
00277     <span class="keywordflow">return</span> <a class="code" href="../../d6/d7/halmips_8h.html#a458">TRUE</a>;
00278 }
00279 
00280 
00281 PSZ
<a name="l00282"></a><a class="code" href="../../d4/d4/tprefix_8c.html#a12">00282</a> <a class="code" href="../../d4/d4/tprefix_8c.html#a12">AnotherPrefix</a>(IN ULONG MaxNameLength)
00283 {
00284     ULONG AlphabetPosition;
00285 
00286     ULONG NameLength;
00287     ULONG IndividualNameLength;
00288 
00289     ULONG StartBufferPosition;
00290     ULONG i;
00291     ULONG j;
00292 
00293     <span class="comment">//</span>
00294     <span class="comment">//  Check if there is enough room for another name</span>
00295     <span class="comment">//</span>
00296 
00297     <span class="keywordflow">if</span> (<a class="code" href="../../d4/d4/tprefix_8c.html#a6">NextBufferChar</a> &gt; (<a class="code" href="../../d5/d0/pnpeisa_8c.html#a1">BUFFER_LENGTH</a> - (MaxNameLength * 4))) {
00298         <span class="keywordflow">return</span> <a class="code" href="../../d4/d6/lh__open_2pi__basic_8h.html#a3">NULL</a>;
00299     }
00300 
00301     <span class="comment">//</span>
00302     <span class="comment">//  Where in the alphabet soup we start</span>
00303     <span class="comment">//</span>
00304 
00305     AlphabetPosition = <a class="code" href="../../d8/d6/ttri_8c.html#a4">RtlRandom</a>(&amp;<a class="code" href="../../d4/d4/tprefix_8c.html#a2">Seed</a>) % <a class="code" href="../../d4/d4/tprefix_8c.html#a3">AlphabetLength</a>;
00306 
00307     <span class="comment">//</span>
00308     <span class="comment">//  How many names we want in our prefix</span>
00309     <span class="comment">//</span>
00310 
00311     NameLength = (<a class="code" href="../../d8/d6/ttri_8c.html#a4">RtlRandom</a>(&amp;<a class="code" href="../../d4/d4/tprefix_8c.html#a2">Seed</a>) % MaxNameLength) + 1;
00312 
00313     <span class="comment">//</span>
00314     <span class="comment">//  Compute each name</span>
00315     <span class="comment">//</span>
00316 
00317     StartBufferPosition = <a class="code" href="../../d4/d4/tprefix_8c.html#a6">NextBufferChar</a>;
00318 
00319     <span class="keywordflow">for</span> (i = 0; i &lt; NameLength; i += 1) {
00320 
00321         <a class="code" href="../../d6/d2/rtqkey_8c.html#a3">Buffer</a>[<a class="code" href="../../d4/d4/tprefix_8c.html#a6">NextBufferChar</a>++] = <span class="charliteral">'\\'</span>;
00322 
00323         IndividualNameLength = (<a class="code" href="../../d8/d6/ttri_8c.html#a4">RtlRandom</a>(&amp;<a class="code" href="../../d4/d4/tprefix_8c.html#a2">Seed</a>) % 3) + 1;
00324 
00325         <span class="keywordflow">for</span> (j = 0; j &lt; IndividualNameLength; j += 1) {
00326 
00327             <a class="code" href="../../d6/d2/rtqkey_8c.html#a3">Buffer</a>[<a class="code" href="../../d4/d4/tprefix_8c.html#a6">NextBufferChar</a>++] = <a class="code" href="../../d4/d4/tprefix_8c.html#a4">Alphabet</a>[AlphabetPosition];
00328             AlphabetPosition = (AlphabetPosition + 1) % <a class="code" href="../../d4/d4/tprefix_8c.html#a3">AlphabetLength</a>;
00329 
00330         }
00331 
00332     }
00333 
00334     <a class="code" href="../../d6/d2/rtqkey_8c.html#a3">Buffer</a>[<a class="code" href="../../d4/d4/tprefix_8c.html#a6">NextBufferChar</a>++] = <span class="charliteral">'\0'</span>;
00335 
00336     <span class="keywordflow">return</span> &amp;<a class="code" href="../../d6/d2/rtqkey_8c.html#a3">Buffer</a>[StartBufferPosition];
00337 
00338 }
00339 
</div></pre><hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:42:02 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
