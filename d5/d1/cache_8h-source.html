<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>test: cache.h Source File</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="../../main.html">Main&nbsp;Page</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a> | <a class="qindex" href="../../globals.html">File&nbsp;Members</a></div>
<h1>cache.h</h1><a href="../../d4/d2/cache_8h.html">Go to the documentation of this file.</a><pre class="fragment"><div>00001 <span class="comment">/*++ BUILD Version: 0003    // Increment this if a change has global effects</span>
00002 <span class="comment"></span>
00003 <span class="comment">Copyright (c) 1989  Microsoft Corporation</span>
00004 <span class="comment"></span>
00005 <span class="comment">Module Name:</span>
00006 <span class="comment"></span>
00007 <span class="comment">    Cache.h</span>
00008 <span class="comment"></span>
00009 <span class="comment">Abstract:</span>
00010 <span class="comment"></span>
00011 <span class="comment">    This module contains the public data structures and procedure</span>
00012 <span class="comment">    prototypes for the cache management system.</span>
00013 <span class="comment"></span>
00014 <span class="comment">Author:</span>
00015 <span class="comment"></span>
00016 <span class="comment"></span>
00017 <span class="comment">Revision History:</span>
00018 <span class="comment"></span>
00019 <span class="comment">--*/</span>
00020 
00021 <span class="preprocessor">#ifndef _CACHE_</span>
00022 <span class="preprocessor"></span><span class="preprocessor">#define _CACHE_</span>
00023 <span class="preprocessor"></span>
00024 <span class="comment">//  begin_ntifs</span>
00025 <span class="comment">//</span>
00026 <span class="comment">//  Define two constants describing the view size (and alignment)</span>
00027 <span class="comment">//  that the Cache Manager uses to map files.</span>
00028 <span class="comment">//</span>
00029 
<a name="l00030"></a><a class="code" href="../../d4/d2/cache_8h.html#a0">00030</a> <span class="preprocessor">#define VACB_MAPPING_GRANULARITY         (0x40000)</span>
<a name="l00031"></a><a class="code" href="../../d4/d2/cache_8h.html#a1">00031</a> <span class="preprocessor"></span><span class="preprocessor">#define VACB_OFFSET_SHIFT                (18)</span>
00032 <span class="preprocessor"></span>
00033 <span class="comment">//</span>
00034 <span class="comment">// Public portion of BCB</span>
00035 <span class="comment">//</span>
00036 
<a name="l00037"></a><a class="code" href="../../d8/d1/struct__PUBLIC__BCB.html">00037</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d8/d1/struct__PUBLIC__BCB.html">_PUBLIC_BCB</a> {
00038 
00039     <span class="comment">//</span>
00040     <span class="comment">// Type and size of this record</span>
00041     <span class="comment">//</span>
00042     <span class="comment">// NOTE: The first four fields must be the same as the BCB in cc.h.</span>
00043     <span class="comment">//</span>
00044 
<a name="l00045"></a><a class="code" href="../../d8/d1/struct__PUBLIC__BCB.html#o0">00045</a>     CSHORT <a class="code" href="../../d8/d1/struct__PUBLIC__BCB.html#o0">NodeTypeCode</a>;
<a name="l00046"></a><a class="code" href="../../d8/d1/struct__PUBLIC__BCB.html#o1">00046</a>     CSHORT <a class="code" href="../../d8/d1/struct__PUBLIC__BCB.html#o1">NodeByteSize</a>;
00047 
00048     <span class="comment">//</span>
00049     <span class="comment">// Description of range of file which is currently mapped.</span>
00050     <span class="comment">//</span>
00051 
<a name="l00052"></a><a class="code" href="../../d8/d1/struct__PUBLIC__BCB.html#o2">00052</a>     ULONG <a class="code" href="../../d8/d1/struct__PUBLIC__BCB.html#o2">MappedLength</a>;
<a name="l00053"></a><a class="code" href="../../d8/d1/struct__PUBLIC__BCB.html#o3">00053</a>     LARGE_INTEGER <a class="code" href="../../d8/d1/struct__PUBLIC__BCB.html#o3">MappedFileOffset</a>;
00054 } <a class="code" href="../../d8/d1/struct__PUBLIC__BCB.html">PUBLIC_BCB</a>, *<a class="code" href="../../d8/d1/struct__PUBLIC__BCB.html">PPUBLIC_BCB</a>;
00055 
00056 <span class="comment">//</span>
00057 <span class="comment">//  File Sizes structure.</span>
00058 <span class="comment">//</span>
00059 
<a name="l00060"></a><a class="code" href="../../d1/d9/struct__CC__FILE__SIZES.html">00060</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d1/d9/struct__CC__FILE__SIZES.html">_CC_FILE_SIZES</a> {
00061 
<a name="l00062"></a><a class="code" href="../../d1/d9/struct__CC__FILE__SIZES.html#o0">00062</a>     LARGE_INTEGER <a class="code" href="../../d1/d9/struct__CC__FILE__SIZES.html#o0">AllocationSize</a>;
<a name="l00063"></a><a class="code" href="../../d1/d9/struct__CC__FILE__SIZES.html#o1">00063</a>     LARGE_INTEGER <a class="code" href="../../d1/d9/struct__CC__FILE__SIZES.html#o1">FileSize</a>;
<a name="l00064"></a><a class="code" href="../../d1/d9/struct__CC__FILE__SIZES.html#o2">00064</a>     LARGE_INTEGER <a class="code" href="../../d1/d9/struct__CC__FILE__SIZES.html#o2">ValidDataLength</a>;
00065 
00066 } <a class="code" href="../../d1/d9/struct__CC__FILE__SIZES.html">CC_FILE_SIZES</a>, *<a class="code" href="../../d1/d9/struct__CC__FILE__SIZES.html">PCC_FILE_SIZES</a>;
00067 
00068 <span class="comment">//</span>
00069 <span class="comment">// Define a Cache Manager callback structure.  These routines are required</span>
00070 <span class="comment">// by the Lazy Writer, so that it can acquire resources in the right order</span>
00071 <span class="comment">// to avoid deadlocks.  Note that otherwise you would have most FS requests</span>
00072 <span class="comment">// acquiring FS resources first and caching structures second, while the</span>
00073 <span class="comment">// Lazy Writer needs to acquire its own resources first, and then FS</span>
00074 <span class="comment">// structures later as it calls the file system.</span>
00075 <span class="comment">//</span>
00076 
00077 <span class="comment">//</span>
00078 <span class="comment">// First define the procedure pointer typedefs</span>
00079 <span class="comment">//</span>
00080 
00081 <span class="comment">//</span>
00082 <span class="comment">// This routine is called by the Lazy Writer prior to doing a write,</span>
00083 <span class="comment">// since this will require some file system resources associated with</span>
00084 <span class="comment">// this cached file. The context parameter supplied is whatever the FS</span>
00085 <span class="comment">// passed as the LazyWriteContext parameter when is called</span>
00086 <span class="comment">// CcInitializeCacheMap.</span>
00087 <span class="comment">//</span>
00088 
00089 <span class="keyword">typedef</span>
<a name="l00090"></a><a class="code" href="../../d4/d2/cache_8h.html#a14">00090</a> BOOLEAN (*<a class="code" href="../../d4/d2/cache_8h.html#a14">PACQUIRE_FOR_LAZY_WRITE</a>) (
00091              IN PVOID Context,
00092              IN BOOLEAN Wait
00093              );
00094 
00095 <span class="comment">//</span>
00096 <span class="comment">// This routine releases the Context acquired above.</span>
00097 <span class="comment">//</span>
00098 
00099 <span class="keyword">typedef</span>
<a name="l00100"></a><a class="code" href="../../d4/d2/cache_8h.html#a15">00100</a> <a class="code" href="../../d0/d6/iop_8h.html#a145">VOID</a> (*<a class="code" href="../../d4/d2/cache_8h.html#a15">PRELEASE_FROM_LAZY_WRITE</a>) (
00101              IN PVOID Context
00102              );
00103 
00104 <span class="comment">//</span>
00105 <span class="comment">// This routine is called by the Lazy Writer prior to doing a readahead.</span>
00106 <span class="comment">//</span>
00107 
00108 <span class="keyword">typedef</span>
<a name="l00109"></a><a class="code" href="../../d4/d2/cache_8h.html#a16">00109</a> BOOLEAN (*<a class="code" href="../../d4/d2/cache_8h.html#a16">PACQUIRE_FOR_READ_AHEAD</a>) (
00110              IN PVOID Context,
00111              IN BOOLEAN Wait
00112              );
00113 
00114 <span class="comment">//</span>
00115 <span class="comment">// This routine releases the Context acquired above.</span>
00116 <span class="comment">//</span>
00117 
00118 <span class="keyword">typedef</span>
<a name="l00119"></a><a class="code" href="../../d4/d2/cache_8h.html#a17">00119</a> <a class="code" href="../../d0/d6/iop_8h.html#a145">VOID</a> (*<a class="code" href="../../d4/d2/cache_8h.html#a17">PRELEASE_FROM_READ_AHEAD</a>) (
00120              IN PVOID Context
00121              );
00122 
<a name="l00123"></a><a class="code" href="../../d3/d6/struct__CACHE__MANAGER__CALLBACKS.html">00123</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d3/d6/struct__CACHE__MANAGER__CALLBACKS.html">_CACHE_MANAGER_CALLBACKS</a> {
00124 
<a name="l00125"></a><a class="code" href="../../d3/d6/struct__CACHE__MANAGER__CALLBACKS.html#o0">00125</a>     <a class="code" href="../../d4/d2/cache_8h.html#a14">PACQUIRE_FOR_LAZY_WRITE</a> <a class="code" href="../../d3/d6/struct__CACHE__MANAGER__CALLBACKS.html#o0">AcquireForLazyWrite</a>;
<a name="l00126"></a><a class="code" href="../../d3/d6/struct__CACHE__MANAGER__CALLBACKS.html#o1">00126</a>     <a class="code" href="../../d4/d2/cache_8h.html#a15">PRELEASE_FROM_LAZY_WRITE</a> <a class="code" href="../../d3/d6/struct__CACHE__MANAGER__CALLBACKS.html#o1">ReleaseFromLazyWrite</a>;
<a name="l00127"></a><a class="code" href="../../d3/d6/struct__CACHE__MANAGER__CALLBACKS.html#o2">00127</a>     <a class="code" href="../../d4/d2/cache_8h.html#a16">PACQUIRE_FOR_READ_AHEAD</a> <a class="code" href="../../d3/d6/struct__CACHE__MANAGER__CALLBACKS.html#o2">AcquireForReadAhead</a>;
<a name="l00128"></a><a class="code" href="../../d3/d6/struct__CACHE__MANAGER__CALLBACKS.html#o3">00128</a>     <a class="code" href="../../d4/d2/cache_8h.html#a17">PRELEASE_FROM_READ_AHEAD</a> <a class="code" href="../../d3/d6/struct__CACHE__MANAGER__CALLBACKS.html#o3">ReleaseFromReadAhead</a>;
00129 
00130 } <a class="code" href="../../d3/d6/struct__CACHE__MANAGER__CALLBACKS.html">CACHE_MANAGER_CALLBACKS</a>, *<a class="code" href="../../d3/d6/struct__CACHE__MANAGER__CALLBACKS.html">PCACHE_MANAGER_CALLBACKS</a>;
00131 
00132 <span class="comment">//</span>
00133 <span class="comment">//  This structure is passed into CcUninitializeCacheMap</span>
00134 <span class="comment">//  if the caller wants to know when the cache map is deleted.</span>
00135 <span class="comment">//</span>
00136 
<a name="l00137"></a><a class="code" href="../../d4/d6/struct__CACHE__UNINITIALIZE__EVENT.html">00137</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="../../d4/d6/struct__CACHE__UNINITIALIZE__EVENT.html">_CACHE_UNINITIALIZE_EVENT</a> {
<a name="l00138"></a><a class="code" href="../../d4/d6/struct__CACHE__UNINITIALIZE__EVENT.html#o0">00138</a>     <span class="keyword">struct </span><a class="code" href="../../d4/d6/struct__CACHE__UNINITIALIZE__EVENT.html">_CACHE_UNINITIALIZE_EVENT</a> *<a class="code" href="../../d4/d6/struct__CACHE__UNINITIALIZE__EVENT.html#o0">Next</a>;
<a name="l00139"></a><a class="code" href="../../d4/d6/struct__CACHE__UNINITIALIZE__EVENT.html#o1">00139</a>     <a class="code" href="../../d2/d6/struct__KEVENT.html">KEVENT</a> <a class="code" href="../../d4/d6/struct__CACHE__UNINITIALIZE__EVENT.html#o1">Event</a>;
00140 } <a class="code" href="../../d4/d6/struct__CACHE__UNINITIALIZE__EVENT.html">CACHE_UNINITIALIZE_EVENT</a>, *<a class="code" href="../../d4/d6/struct__CACHE__UNINITIALIZE__EVENT.html">PCACHE_UNINITIALIZE_EVENT</a>;
00141 
00142 <span class="comment">// end_ntifs</span>
00143 <span class="comment">//</span>
00144 <span class="comment">// Callback routine for retrieving dirty pages from Cache Manager.</span>
00145 <span class="comment">//</span>
00146 
00147 <span class="keyword">typedef</span>
<a name="l00148"></a><a class="code" href="../../d4/d2/cache_8h.html#a22">00148</a> <a class="code" href="../../d0/d6/iop_8h.html#a145">VOID</a> (*<a class="code" href="../../d4/d2/cache_8h.html#a22">PDIRTY_PAGE_ROUTINE</a>) (
00149             IN <a class="code" href="../../d9/d1/struct__FILE__OBJECT.html">PFILE_OBJECT</a> FileObject,
00150             IN PLARGE_INTEGER FileOffset,
00151             IN ULONG Length,
00152             IN PLARGE_INTEGER OldestLsn,
00153             IN PLARGE_INTEGER NewestLsn,
00154             IN PVOID <a class="code" href="../../d3/d1/threads_8h.html#a107">Context1</a>,
00155             IN PVOID <a class="code" href="../../d3/d1/threads_8h.html#a108">Context2</a>
00156             );
00157 
00158 <span class="comment">//</span>
00159 <span class="comment">// Callback routine for doing log file flushes to Lsn.</span>
00160 <span class="comment">//</span>
00161 
00162 <span class="keyword">typedef</span>
<a name="l00163"></a><a class="code" href="../../d4/d2/cache_8h.html#a23">00163</a> <a class="code" href="../../d0/d6/iop_8h.html#a145">VOID</a> (*<a class="code" href="../../d4/d2/cache_8h.html#a23">PFLUSH_TO_LSN</a>) (
00164             IN PVOID LogHandle,
00165             IN LARGE_INTEGER Lsn
00166             );
00167 
00168 <span class="comment">// begin_ntifs</span>
00169 <span class="comment">//</span>
00170 <span class="comment">// Macro to test whether a file is cached or not.</span>
00171 <span class="comment">//</span>
00172 
<a name="l00173"></a><a class="code" href="../../d4/d2/cache_8h.html#a2">00173</a> <span class="preprocessor">#define CcIsFileCached(FO) (                                                         \</span>
00174 <span class="preprocessor">    ((FO)-&gt;SectionObjectPointer != NULL) &amp;&amp;                                          \</span>
00175 <span class="preprocessor">    (((PSECTION_OBJECT_POINTERS)(FO)-&gt;SectionObjectPointer)-&gt;SharedCacheMap != NULL) \</span>
00176 <span class="preprocessor">)</span>
00177 <span class="preprocessor"></span>
00178 <span class="comment">// end_ntifs</span>
00179 <span class="comment">//</span>
00180 <span class="comment">// Throw away miss counter</span>
00181 <span class="comment">//</span>
00182 
<a name="l00183"></a><a class="code" href="../../d4/d2/cache_8h.html#a24">00183</a> <span class="keyword">extern</span> ULONG <a class="code" href="../../d5/d2/cachedat_8c.html#a43">CcThrowAway</a>;
00184 
00185 <span class="comment">//</span>
00186 <span class="comment">// Performance Counters</span>
00187 <span class="comment">//</span>
00188 
<a name="l00189"></a><a class="code" href="../../d4/d2/cache_8h.html#a25">00189</a> <span class="keyword">extern</span> ULONG <a class="code" href="../../d5/d2/cachedat_8c.html#a44">CcFastReadNoWait</a>;
<a name="l00190"></a><a class="code" href="../../d4/d2/cache_8h.html#a26">00190</a> <span class="keyword">extern</span> ULONG <a class="code" href="../../d5/d2/cachedat_8c.html#a45">CcFastReadWait</a>;
<a name="l00191"></a><a class="code" href="../../d4/d2/cache_8h.html#a27">00191</a> <span class="keyword">extern</span> ULONG <a class="code" href="../../d5/d2/cachedat_8c.html#a46">CcFastReadResourceMiss</a>;
<a name="l00192"></a><a class="code" href="../../d4/d2/cache_8h.html#a28">00192</a> <span class="keyword">extern</span> ULONG <a class="code" href="../../d5/d2/cachedat_8c.html#a47">CcFastReadNotPossible</a>;
00193 
<a name="l00194"></a><a class="code" href="../../d4/d2/cache_8h.html#a29">00194</a> <span class="keyword">extern</span> ULONG <a class="code" href="../../d5/d2/cachedat_8c.html#a48">CcFastMdlReadNoWait</a>;
<a name="l00195"></a><a class="code" href="../../d4/d2/cache_8h.html#a30">00195</a> <span class="keyword">extern</span> ULONG <a class="code" href="../../d5/d2/cachedat_8c.html#a49">CcFastMdlReadWait</a>;
<a name="l00196"></a><a class="code" href="../../d4/d2/cache_8h.html#a31">00196</a> <span class="keyword">extern</span> ULONG <a class="code" href="../../d5/d2/cachedat_8c.html#a50">CcFastMdlReadResourceMiss</a>;
<a name="l00197"></a><a class="code" href="../../d4/d2/cache_8h.html#a32">00197</a> <span class="keyword">extern</span> ULONG <a class="code" href="../../d5/d2/cachedat_8c.html#a51">CcFastMdlReadNotPossible</a>;
00198 
<a name="l00199"></a><a class="code" href="../../d4/d2/cache_8h.html#a33">00199</a> <span class="keyword">extern</span> ULONG <a class="code" href="../../d5/d2/cachedat_8c.html#a52">CcMapDataNoWait</a>;
<a name="l00200"></a><a class="code" href="../../d4/d2/cache_8h.html#a34">00200</a> <span class="keyword">extern</span> ULONG <a class="code" href="../../d5/d2/cachedat_8c.html#a53">CcMapDataWait</a>;
<a name="l00201"></a><a class="code" href="../../d4/d2/cache_8h.html#a35">00201</a> <span class="keyword">extern</span> ULONG <a class="code" href="../../d5/d2/cachedat_8c.html#a54">CcMapDataNoWaitMiss</a>;
<a name="l00202"></a><a class="code" href="../../d4/d2/cache_8h.html#a36">00202</a> <span class="keyword">extern</span> ULONG <a class="code" href="../../d5/d2/cachedat_8c.html#a55">CcMapDataWaitMiss</a>;
00203 
<a name="l00204"></a><a class="code" href="../../d4/d2/cache_8h.html#a37">00204</a> <span class="keyword">extern</span> ULONG <a class="code" href="../../d5/d2/cachedat_8c.html#a56">CcPinMappedDataCount</a>;
00205 
<a name="l00206"></a><a class="code" href="../../d4/d2/cache_8h.html#a38">00206</a> <span class="keyword">extern</span> ULONG <a class="code" href="../../d5/d2/cachedat_8c.html#a57">CcPinReadNoWait</a>;
<a name="l00207"></a><a class="code" href="../../d4/d2/cache_8h.html#a39">00207</a> <span class="keyword">extern</span> ULONG <a class="code" href="../../d5/d2/cachedat_8c.html#a58">CcPinReadWait</a>;
<a name="l00208"></a><a class="code" href="../../d4/d2/cache_8h.html#a40">00208</a> <span class="keyword">extern</span> ULONG <a class="code" href="../../d5/d2/cachedat_8c.html#a59">CcPinReadNoWaitMiss</a>;
<a name="l00209"></a><a class="code" href="../../d4/d2/cache_8h.html#a41">00209</a> <span class="keyword">extern</span> ULONG <a class="code" href="../../d5/d2/cachedat_8c.html#a60">CcPinReadWaitMiss</a>;
00210 
<a name="l00211"></a><a class="code" href="../../d4/d2/cache_8h.html#a42">00211</a> <span class="keyword">extern</span> ULONG <a class="code" href="../../d5/d2/cachedat_8c.html#a61">CcCopyReadNoWait</a>;
<a name="l00212"></a><a class="code" href="../../d4/d2/cache_8h.html#a43">00212</a> <span class="keyword">extern</span> ULONG <a class="code" href="../../d5/d2/cachedat_8c.html#a62">CcCopyReadWait</a>;
<a name="l00213"></a><a class="code" href="../../d4/d2/cache_8h.html#a44">00213</a> <span class="keyword">extern</span> ULONG <a class="code" href="../../d5/d2/cachedat_8c.html#a63">CcCopyReadNoWaitMiss</a>;
<a name="l00214"></a><a class="code" href="../../d4/d2/cache_8h.html#a45">00214</a> <span class="keyword">extern</span> ULONG <a class="code" href="../../d5/d2/cachedat_8c.html#a64">CcCopyReadWaitMiss</a>;
00215 
<a name="l00216"></a><a class="code" href="../../d4/d2/cache_8h.html#a46">00216</a> <span class="keyword">extern</span> ULONG <a class="code" href="../../d5/d2/cachedat_8c.html#a65">CcMdlReadNoWait</a>;
<a name="l00217"></a><a class="code" href="../../d4/d2/cache_8h.html#a47">00217</a> <span class="keyword">extern</span> ULONG <a class="code" href="../../d5/d2/cachedat_8c.html#a66">CcMdlReadWait</a>;
<a name="l00218"></a><a class="code" href="../../d4/d2/cache_8h.html#a48">00218</a> <span class="keyword">extern</span> ULONG <a class="code" href="../../d5/d2/cachedat_8c.html#a67">CcMdlReadNoWaitMiss</a>;
<a name="l00219"></a><a class="code" href="../../d4/d2/cache_8h.html#a49">00219</a> <span class="keyword">extern</span> ULONG <a class="code" href="../../d5/d2/cachedat_8c.html#a68">CcMdlReadWaitMiss</a>;
00220 
<a name="l00221"></a><a class="code" href="../../d4/d2/cache_8h.html#a50">00221</a> <span class="keyword">extern</span> ULONG <a class="code" href="../../d5/d2/cachedat_8c.html#a69">CcReadAheadIos</a>;
00222 
<a name="l00223"></a><a class="code" href="../../d4/d2/cache_8h.html#a51">00223</a> <span class="keyword">extern</span> ULONG <a class="code" href="../../d5/d2/cachedat_8c.html#a71">CcLazyWriteIos</a>;
<a name="l00224"></a><a class="code" href="../../d4/d2/cache_8h.html#a52">00224</a> <span class="keyword">extern</span> ULONG <a class="code" href="../../d5/d2/cachedat_8c.html#a72">CcLazyWritePages</a>;
<a name="l00225"></a><a class="code" href="../../d4/d2/cache_8h.html#a53">00225</a> <span class="keyword">extern</span> ULONG <a class="code" href="../../d5/d2/cachedat_8c.html#a73">CcDataFlushes</a>;
<a name="l00226"></a><a class="code" href="../../d4/d2/cache_8h.html#a54">00226</a> <span class="keyword">extern</span> ULONG <a class="code" href="../../d5/d2/cachedat_8c.html#a74">CcDataPages</a>;
00227 
<a name="l00228"></a><a class="code" href="../../d4/d2/cache_8h.html#a55">00228</a> <span class="keyword">extern</span> PULONG <a class="code" href="../../d5/d2/cachedat_8c.html#a75">CcMissCounter</a>;
00229 
00230 <span class="comment">//</span>
00231 <span class="comment">// Global Maintenance routines</span>
00232 <span class="comment">//</span>
00233 
00234 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
00235 BOOLEAN
00236 <a class="code" href="../../d5/d8/fssup_8c.html#a8">CcInitializeCacheManager</a> (
00237     );
00238 
00239 <span class="comment">// begin_ntifs</span>
00240 <span class="comment">//</span>
00241 <span class="comment">// The following routines are intended for use by File Systems Only.</span>
00242 <span class="comment">//</span>
00243 
00244 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
00245 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00246 <a class="code" href="../../d4/d2/cache_8h.html#a58">CcInitializeCacheMap</a> (
00247     IN <a class="code" href="../../d9/d1/struct__FILE__OBJECT.html">PFILE_OBJECT</a> FileObject,
00248     IN PCC_FILE_SIZES FileSizes,
00249     IN BOOLEAN PinAccess,
00250     IN PCACHE_MANAGER_CALLBACKS Callbacks,
00251     IN PVOID LazyWriteContext
00252     );
00253 
00254 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
00255 BOOLEAN
00256 <a class="code" href="../../d4/d2/cache_8h.html#a59">CcUninitializeCacheMap</a> (
00257     IN <a class="code" href="../../d9/d1/struct__FILE__OBJECT.html">PFILE_OBJECT</a> FileObject,
00258     IN PLARGE_INTEGER TruncateSize OPTIONAL,
00259     IN PCACHE_UNINITIALIZE_EVENT UninitializeCompleteEvent OPTIONAL
00260     );
00261 
00262 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
00263 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00264 <a class="code" href="../../d4/d2/cache_8h.html#a60">CcSetFileSizes</a> (
00265     IN <a class="code" href="../../d9/d1/struct__FILE__OBJECT.html">PFILE_OBJECT</a> FileObject,
00266     IN PCC_FILE_SIZES FileSizes
00267     );
00268 
00269 <span class="comment">//</span>
00270 <span class="comment">//  VOID</span>
00271 <span class="comment">//  CcFastIoSetFileSizes (</span>
00272 <span class="comment">//      IN PFILE_OBJECT FileObject,</span>
00273 <span class="comment">//      IN PCC_FILE_SIZES FileSizes</span>
00274 <span class="comment">//      );</span>
00275 <span class="comment">//</span>
00276 
<a name="l00277"></a><a class="code" href="../../d4/d2/cache_8h.html#a3">00277</a> <span class="preprocessor">#define CcGetFileSizePointer(FO) (                                     \</span>
00278 <span class="preprocessor">    ((PLARGE_INTEGER)((FO)-&gt;SectionObjectPointer-&gt;SharedCacheMap) + 1) \</span>
00279 <span class="preprocessor">)</span>
00280 <span class="preprocessor"></span>
00281 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
00282 BOOLEAN
00283 <a class="code" href="../../d4/d2/cache_8h.html#a61">CcPurgeCacheSection</a> (
00284     IN <a class="code" href="../../d7/d0/struct__SECTION__OBJECT__POINTERS.html">PSECTION_OBJECT_POINTERS</a> SectionObjectPointer,
00285     IN PLARGE_INTEGER FileOffset OPTIONAL,
00286     IN ULONG Length,
00287     IN BOOLEAN UninitializeCacheMaps
00288     );
00289 
00290 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
00291 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00292 <a class="code" href="../../d4/d2/cache_8h.html#a62">CcSetDirtyPageThreshold</a> (
00293     IN <a class="code" href="../../d9/d1/struct__FILE__OBJECT.html">PFILE_OBJECT</a> FileObject,
00294     IN ULONG DirtyPageThreshold
00295     );
00296 
00297 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
00298 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00299 <a class="code" href="../../d4/d2/cache_8h.html#a63">CcFlushCache</a> (
00300     IN <a class="code" href="../../d7/d0/struct__SECTION__OBJECT__POINTERS.html">PSECTION_OBJECT_POINTERS</a> SectionObjectPointer,
00301     IN PLARGE_INTEGER FileOffset OPTIONAL,
00302     IN ULONG Length,
00303     OUT PIO_STATUS_BLOCK IoStatus OPTIONAL
00304     );
00305 
00306 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
00307 LARGE_INTEGER
00308 <a class="code" href="../../d4/d2/cache_8h.html#a64">CcGetFlushedValidData</a> (
00309     IN <a class="code" href="../../d7/d0/struct__SECTION__OBJECT__POINTERS.html">PSECTION_OBJECT_POINTERS</a> SectionObjectPointer,
00310     IN BOOLEAN BcbListHeld
00311     );
00312 
00313 <span class="comment">// end_ntifs</span>
00314 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
00315 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00316 <a class="code" href="../../d4/d2/cache_8h.html#a65">CcZeroEndOfLastPage</a> (
00317     IN <a class="code" href="../../d9/d1/struct__FILE__OBJECT.html">PFILE_OBJECT</a> FileObject
00318     );
00319 
00320 <span class="comment">// begin_ntifs</span>
00321 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
00322 BOOLEAN
00323 <a class="code" href="../../d4/d2/cache_8h.html#a66">CcZeroData</a> (
00324     IN <a class="code" href="../../d9/d1/struct__FILE__OBJECT.html">PFILE_OBJECT</a> FileObject,
00325     IN PLARGE_INTEGER StartOffset,
00326     IN PLARGE_INTEGER EndOffset,
00327     IN BOOLEAN Wait
00328     );
00329 
00330 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
00331 PVOID
00332 <a class="code" href="../../d4/d2/cache_8h.html#a67">CcRemapBcb</a> (
00333     IN PVOID Bcb
00334     );
00335 
00336 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
00337 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00338 <a class="code" href="../../d4/d2/cache_8h.html#a68">CcRepinBcb</a> (
00339     IN PVOID Bcb
00340     );
00341 
00342 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
00343 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00344 <a class="code" href="../../d4/d2/cache_8h.html#a69">CcUnpinRepinnedBcb</a> (
00345     IN PVOID Bcb,
00346     IN BOOLEAN WriteThrough,
00347     OUT PIO_STATUS_BLOCK IoStatus
00348     );
00349 
00350 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
00351 <a class="code" href="../../d9/d1/struct__FILE__OBJECT.html">PFILE_OBJECT</a>
00352 <a class="code" href="../../d4/d2/cache_8h.html#a70">CcGetFileObjectFromSectionPtrs</a> (
00353     IN <a class="code" href="../../d7/d0/struct__SECTION__OBJECT__POINTERS.html">PSECTION_OBJECT_POINTERS</a> SectionObjectPointer
00354     );
00355 
00356 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
00357 <a class="code" href="../../d9/d1/struct__FILE__OBJECT.html">PFILE_OBJECT</a>
00358 <a class="code" href="../../d4/d2/cache_8h.html#a71">CcGetFileObjectFromBcb</a> (
00359     IN PVOID Bcb
00360     );
00361 
00362 <span class="comment">//</span>
00363 <span class="comment">// These routines are implemented to support write throttling.</span>
00364 <span class="comment">//</span>
00365 
00366 <span class="comment">//</span>
00367 <span class="comment">//  BOOLEAN</span>
00368 <span class="comment">//  CcCopyWriteWontFlush (</span>
00369 <span class="comment">//      IN PFILE_OBJECT FileObject,</span>
00370 <span class="comment">//      IN PLARGE_INTEGER FileOffset,</span>
00371 <span class="comment">//      IN ULONG Length</span>
00372 <span class="comment">//      );</span>
00373 <span class="comment">//</span>
00374 
<a name="l00375"></a><a class="code" href="../../d4/d2/cache_8h.html#a4">00375</a> <span class="preprocessor">#define CcCopyWriteWontFlush(FO,FOFF,LEN) ((LEN) &lt;= 0X10000)</span>
00376 <span class="preprocessor"></span>
00377 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
00378 BOOLEAN
00379 <a class="code" href="../../d4/d2/cache_8h.html#a72">CcCanIWrite</a> (
00380     IN <a class="code" href="../../d9/d1/struct__FILE__OBJECT.html">PFILE_OBJECT</a> FileObject,
00381     IN ULONG BytesToWrite,
00382     IN BOOLEAN Wait,
00383     IN BOOLEAN Retrying
00384     );
00385 
00386 <span class="keyword">typedef</span>
<a name="l00387"></a><a class="code" href="../../d4/d2/cache_8h.html#a56">00387</a> <a class="code" href="../../d0/d6/iop_8h.html#a145">VOID</a> (*<a class="code" href="../../d4/d2/cache_8h.html#a56">PCC_POST_DEFERRED_WRITE</a>) (
00388     IN PVOID <a class="code" href="../../d3/d1/threads_8h.html#a107">Context1</a>,
00389     IN PVOID <a class="code" href="../../d3/d1/threads_8h.html#a108">Context2</a>
00390     );
00391 
00392 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
00393 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00394 <a class="code" href="../../d4/d2/cache_8h.html#a73">CcDeferWrite</a> (
00395     IN <a class="code" href="../../d9/d1/struct__FILE__OBJECT.html">PFILE_OBJECT</a> FileObject,
00396     IN PCC_POST_DEFERRED_WRITE PostRoutine,
00397     IN PVOID Context1,
00398     IN PVOID Context2,
00399     IN ULONG BytesToWrite,
00400     IN BOOLEAN Retrying
00401     );
00402 
00403 <span class="comment">//</span>
00404 <span class="comment">// The following routines provide a data copy interface to the cache, and</span>
00405 <span class="comment">// are intended for use by File Servers and File Systems.</span>
00406 <span class="comment">//</span>
00407 
00408 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
00409 BOOLEAN
00410 <a class="code" href="../../d4/d2/cache_8h.html#a74">CcCopyRead</a> (
00411     IN <a class="code" href="../../d9/d1/struct__FILE__OBJECT.html">PFILE_OBJECT</a> FileObject,
00412     IN PLARGE_INTEGER FileOffset,
00413     IN ULONG Length,
00414     IN BOOLEAN Wait,
00415     OUT PVOID Buffer,
00416     OUT PIO_STATUS_BLOCK IoStatus
00417     );
00418 
00419 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
00420 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00421 <a class="code" href="../../d4/d2/cache_8h.html#a75">CcFastCopyRead</a> (
00422     IN <a class="code" href="../../d9/d1/struct__FILE__OBJECT.html">PFILE_OBJECT</a> FileObject,
00423     IN ULONG FileOffset,
00424     IN ULONG Length,
00425     IN ULONG PageCount,
00426     OUT PVOID Buffer,
00427     OUT PIO_STATUS_BLOCK IoStatus
00428     );
00429 
00430 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
00431 BOOLEAN
00432 <a class="code" href="../../d4/d2/cache_8h.html#a76">CcCopyWrite</a> (
00433     IN <a class="code" href="../../d9/d1/struct__FILE__OBJECT.html">PFILE_OBJECT</a> FileObject,
00434     IN PLARGE_INTEGER FileOffset,
00435     IN ULONG Length,
00436     IN BOOLEAN Wait,
00437     IN PVOID Buffer
00438     );
00439 
00440 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
00441 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00442 <a class="code" href="../../d4/d2/cache_8h.html#a77">CcFastCopyWrite</a> (
00443     IN <a class="code" href="../../d9/d1/struct__FILE__OBJECT.html">PFILE_OBJECT</a> FileObject,
00444     IN ULONG FileOffset,
00445     IN ULONG Length,
00446     IN PVOID Buffer
00447     );
00448 
00449 <span class="comment">//</span>
00450 <span class="comment">//  The following routines provide an Mdl interface for transfers to and</span>
00451 <span class="comment">//  from the cache, and are primarily intended for File Servers.</span>
00452 <span class="comment">//</span>
00453 <span class="comment">//  NOBODY SHOULD BE CALLING THESE MDL ROUTINES DIRECTLY, USE FSRTL AND</span>
00454 <span class="comment">//  FASTIO INTERFACES.</span>
00455 <span class="comment">//</span>
00456 
00457 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
00458 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00459 <a class="code" href="../../d4/d2/cache_8h.html#a78">CcMdlRead</a> (
00460     IN <a class="code" href="../../d9/d1/struct__FILE__OBJECT.html">PFILE_OBJECT</a> FileObject,
00461     IN PLARGE_INTEGER FileOffset,
00462     IN ULONG Length,
00463     OUT <a class="code" href="../../d6/d7/struct__MDL.html">PMDL</a> *MdlChain,
00464     OUT PIO_STATUS_BLOCK IoStatus
00465     );
00466 
00467 <span class="comment">//</span>
00468 <span class="comment">//  This routine is now a wrapper for FastIo if present or CcMdlReadComplete2</span>
00469 <span class="comment">//</span>
00470 
00471 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
00472 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00473 <a class="code" href="../../d4/d2/cache_8h.html#a79">CcMdlReadComplete</a> (
00474     IN <a class="code" href="../../d9/d1/struct__FILE__OBJECT.html">PFILE_OBJECT</a> FileObject,
00475     IN <a class="code" href="../../d6/d7/struct__MDL.html">PMDL</a> MdlChain
00476     );
00477 
00478 <span class="comment">// end_ntifs</span>
00479 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
00480 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00481 <a class="code" href="../../d4/d2/cache_8h.html#a80">CcMdlReadComplete2</a> (
00482     IN <a class="code" href="../../d9/d1/struct__FILE__OBJECT.html">PFILE_OBJECT</a> FileObject,
00483     IN <a class="code" href="../../d6/d7/struct__MDL.html">PMDL</a> MdlChain
00484     );
00485 
00486 <span class="comment">// begin_ntifs</span>
00487 
00488 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
00489 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00490 <a class="code" href="../../d4/d2/cache_8h.html#a81">CcPrepareMdlWrite</a> (
00491     IN <a class="code" href="../../d9/d1/struct__FILE__OBJECT.html">PFILE_OBJECT</a> FileObject,
00492     IN PLARGE_INTEGER FileOffset,
00493     IN ULONG Length,
00494     OUT <a class="code" href="../../d6/d7/struct__MDL.html">PMDL</a> *MdlChain,
00495     OUT PIO_STATUS_BLOCK IoStatus
00496     );
00497 
00498 <span class="comment">//</span>
00499 <span class="comment">//  This routine is now a wrapper for FastIo if present or CcMdlWriteComplete2</span>
00500 <span class="comment">//</span>
00501 
00502 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
00503 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00504 <a class="code" href="../../d4/d2/cache_8h.html#a82">CcMdlWriteComplete</a> (
00505     IN <a class="code" href="../../d9/d1/struct__FILE__OBJECT.html">PFILE_OBJECT</a> FileObject,
00506     IN PLARGE_INTEGER FileOffset,
00507     IN <a class="code" href="../../d6/d7/struct__MDL.html">PMDL</a> MdlChain
00508     );
00509 
00510 <span class="comment">// end_ntifs</span>
00511 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
00512 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00513 <a class="code" href="../../d4/d2/cache_8h.html#a83">CcMdlWriteComplete2</a> (
00514     IN <a class="code" href="../../d9/d1/struct__FILE__OBJECT.html">PFILE_OBJECT</a> FileObject,
00515     IN PLARGE_INTEGER FileOffset,
00516     IN <a class="code" href="../../d6/d7/struct__MDL.html">PMDL</a> MdlChain
00517     );
00518 
00519 <span class="comment">// begin_ntifs</span>
00520 <span class="comment">//</span>
00521 <span class="comment">// Common ReadAhead call for Copy Read and Mdl Read.</span>
00522 <span class="comment">//</span>
00523 <span class="comment">// ReadAhead should always be invoked by calling the CcReadAhead macro,</span>
00524 <span class="comment">// which tests first to see if the read is large enough to warrant read</span>
00525 <span class="comment">// ahead.  Measurements have shown that, calling the read ahead routine</span>
00526 <span class="comment">// actually decreases performance for small reads, such as issued by</span>
00527 <span class="comment">// many compilers and linkers.  Compilers simply want all of the include</span>
00528 <span class="comment">// files to stay in memory after being read the first time.</span>
00529 <span class="comment">//</span>
00530 
<a name="l00531"></a><a class="code" href="../../d4/d2/cache_8h.html#a5">00531</a> <span class="preprocessor">#define CcReadAhead(FO,FOFF,LEN) {                       \</span>
00532 <span class="preprocessor">    if ((LEN) &gt;= 256) {                                  \</span>
00533 <span class="preprocessor">        CcScheduleReadAhead((FO),(FOFF),(LEN));          \</span>
00534 <span class="preprocessor">    }                                                    \</span>
00535 <span class="preprocessor">}</span>
00536 <span class="preprocessor"></span>
00537 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
00538 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00539 <a class="code" href="../../d4/d2/cache_8h.html#a84">CcScheduleReadAhead</a> (
00540     IN <a class="code" href="../../d9/d1/struct__FILE__OBJECT.html">PFILE_OBJECT</a> FileObject,
00541     IN PLARGE_INTEGER FileOffset,
00542     IN ULONG Length
00543     );
00544 
00545 <span class="comment">//</span>
00546 <span class="comment">//  The following routine allows a caller to wait for the next batch</span>
00547 <span class="comment">//  of lazy writer work to complete.  In particular, this provides a</span>
00548 <span class="comment">//  mechanism for a caller to be sure that all avaliable lazy closes</span>
00549 <span class="comment">//  at the time of this call have issued.</span>
00550 <span class="comment">//</span>
00551 
00552 <a class="code" href="../../d0/d6/iop_8h.html#a144">NTSTATUS</a>
00553 <a class="code" href="../../d5/d1/lazyrite_8c.html#a6">CcWaitForCurrentLazyWriterActivity</a> (
00554     );
00555 
00556 <span class="comment">//</span>
00557 <span class="comment">// This routine changes the read ahead granularity for a file, which is</span>
00558 <span class="comment">// PAGE_SIZE by default.</span>
00559 <span class="comment">//</span>
00560 
00561 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
00562 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00563 <a class="code" href="../../d4/d2/cache_8h.html#a86">CcSetReadAheadGranularity</a> (
00564     IN <a class="code" href="../../d9/d1/struct__FILE__OBJECT.html">PFILE_OBJECT</a> FileObject,
00565     IN ULONG Granularity
00566     );
00567 
00568 <span class="comment">//</span>
00569 <span class="comment">// The following routines provide direct access data which is pinned in the</span>
00570 <span class="comment">// cache, and is primarily intended for use by File Systems.  In particular,</span>
00571 <span class="comment">// this mode of access is ideal for dealing with volume structures.</span>
00572 <span class="comment">//</span>
00573 
00574 <span class="comment">//</span>
00575 <span class="comment">//  Flags for pinning</span>
00576 <span class="comment">//</span>
00577 
00578 <span class="comment">//</span>
00579 <span class="comment">//  Synchronous Wait - normally specified.  This pattern may be specified as TRUE.</span>
00580 <span class="comment">//</span>
00581 
<a name="l00582"></a><a class="code" href="../../d4/d2/cache_8h.html#a6">00582</a> <span class="preprocessor">#define PIN_WAIT                         (1)</span>
00583 <span class="preprocessor"></span>
00584 <span class="comment">//</span>
00585 <span class="comment">//  Acquire metadata Bcb exclusive (default is shared, Lazy Writer uses exclusive).</span>
00586 <span class="comment">//</span>
00587 <span class="comment">//  Must be set with PIN_WAIT.</span>
00588 <span class="comment">//</span>
00589 
<a name="l00590"></a><a class="code" href="../../d4/d2/cache_8h.html#a7">00590</a> <span class="preprocessor">#define PIN_EXCLUSIVE                    (2)</span>
00591 <span class="preprocessor"></span>
00592 <span class="comment">//</span>
00593 <span class="comment">//  Acquire metadata Bcb but do not fault data in.  Default is to fault the data in.</span>
00594 <span class="comment">//  This unusual flag is only used by Ntfs for cache coherency synchronization between</span>
00595 <span class="comment">//  compressed and uncompressed streams for the same compressed file.</span>
00596 <span class="comment">//</span>
00597 <span class="comment">//  Must be set with PIN_WAIT.</span>
00598 <span class="comment">//</span>
00599 
<a name="l00600"></a><a class="code" href="../../d4/d2/cache_8h.html#a8">00600</a> <span class="preprocessor">#define PIN_NO_READ                      (4)</span>
00601 <span class="preprocessor"></span>
00602 <span class="comment">//</span>
00603 <span class="comment">//  This option may be used to pin data only if the Bcb already exists.  If the Bcb</span>
00604 <span class="comment">//  does not already exist - the pin is unsuccessful and no Bcb is returned.  This routine</span>
00605 <span class="comment">//  provides a way to see if data is already pinned (and possibly dirty) in the cache,</span>
00606 <span class="comment">//  without forcing a fault if the data is not there.</span>
00607 <span class="comment">//</span>
00608 
<a name="l00609"></a><a class="code" href="../../d4/d2/cache_8h.html#a9">00609</a> <span class="preprocessor">#define PIN_IF_BCB                       (8)</span>
00610 <span class="preprocessor"></span>
00611 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
00612 BOOLEAN
00613 <a class="code" href="../../d4/d2/cache_8h.html#a87">CcPinRead</a> (
00614     IN <a class="code" href="../../d9/d1/struct__FILE__OBJECT.html">PFILE_OBJECT</a> FileObject,
00615     IN PLARGE_INTEGER FileOffset,
00616     IN ULONG Length,
00617     IN ULONG Flags,
00618     OUT PVOID *Bcb,
00619     OUT PVOID *Buffer
00620     );
00621 
00622 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
00623 BOOLEAN
00624 <a class="code" href="../../d4/d2/cache_8h.html#a88">CcMapData</a> (
00625     IN <a class="code" href="../../d9/d1/struct__FILE__OBJECT.html">PFILE_OBJECT</a> FileObject,
00626     IN PLARGE_INTEGER FileOffset,
00627     IN ULONG Length,
00628     IN BOOLEAN Wait,
00629     OUT PVOID *Bcb,
00630     OUT PVOID *Buffer
00631     );
00632 
00633 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
00634 BOOLEAN
00635 <a class="code" href="../../d4/d2/cache_8h.html#a89">CcPinMappedData</a> (
00636     IN <a class="code" href="../../d9/d1/struct__FILE__OBJECT.html">PFILE_OBJECT</a> FileObject,
00637     IN PLARGE_INTEGER FileOffset,
00638     IN ULONG Length,
00639     IN ULONG Flags,
00640     IN OUT PVOID *Bcb
00641     );
00642 
00643 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
00644 BOOLEAN
00645 <a class="code" href="../../d4/d2/cache_8h.html#a90">CcPreparePinWrite</a> (
00646     IN <a class="code" href="../../d9/d1/struct__FILE__OBJECT.html">PFILE_OBJECT</a> FileObject,
00647     IN PLARGE_INTEGER FileOffset,
00648     IN ULONG Length,
00649     IN BOOLEAN Zero,
00650     IN ULONG Flags,
00651     OUT PVOID *Bcb,
00652     OUT PVOID *Buffer
00653     );
00654 
00655 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
00656 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00657 <a class="code" href="../../d4/d2/cache_8h.html#a91">CcSetDirtyPinnedData</a> (
00658     IN PVOID BcbVoid,
00659     IN PLARGE_INTEGER Lsn OPTIONAL
00660     );
00661 
00662 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
00663 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00664 <a class="code" href="../../d4/d2/cache_8h.html#a92">CcUnpinData</a> (
00665     IN PVOID Bcb
00666     );
00667 
00668 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
00669 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00670 <a class="code" href="../../d4/d2/cache_8h.html#a93">CcSetBcbOwnerPointer</a> (
00671     IN PVOID Bcb,
00672     IN PVOID OwnerPointer
00673     );
00674 
00675 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
00676 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00677 <a class="code" href="../../d4/d2/cache_8h.html#a94">CcUnpinDataForThread</a> (
00678     IN PVOID Bcb,
00679     IN ERESOURCE_THREAD ResourceThreadId
00680     );
00681 
00682 <span class="comment">// end_ntifs</span>
00683 <span class="comment">//</span>
00684 <span class="comment">// The following routines are in logsup.c, and provide special Cache Manager</span>
00685 <span class="comment">// support for storting Lsns with dirty file pages, and peforming subsequent</span>
00686 <span class="comment">// operations based on them.</span>
00687 <span class="comment">//</span>
00688 
00689 <span class="comment">// begin_ntifs</span>
00690 
00691 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
00692 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00693 <a class="code" href="../../d4/d2/cache_8h.html#a95">CcSetAdditionalCacheAttributes</a> (
00694     IN <a class="code" href="../../d9/d1/struct__FILE__OBJECT.html">PFILE_OBJECT</a> FileObject,
00695     IN BOOLEAN DisableReadAhead,
00696     IN BOOLEAN DisableWriteBehind
00697     );
00698 
00699 <span class="comment">// end_ntifs</span>
00700 
00701 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
00702 <a class="code" href="../../d2/d7/hal_8h.html#a212">VOID</a>
00703 <a class="code" href="../../d4/d2/cache_8h.html#a96">CcSetLogHandleForFile</a> (
00704     IN <a class="code" href="../../d9/d1/struct__FILE__OBJECT.html">PFILE_OBJECT</a> FileObject,
00705     IN PVOID LogHandle,
00706     IN PFLUSH_TO_LSN FlushToLsnRoutine
00707     );
00708 
00709 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
00710 LARGE_INTEGER
00711 <a class="code" href="../../d4/d2/cache_8h.html#a97">CcGetDirtyPages</a> (
00712     IN PVOID LogHandle,
00713     IN PDIRTY_PAGE_ROUTINE DirtyPageRoutine,
00714     IN PVOID Context1,
00715     IN PVOID Context2
00716     );
00717 
00718 <span class="comment">// begin_ntifs</span>
00719 
00720 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
00721 BOOLEAN
00722 <a class="code" href="../../d4/d2/cache_8h.html#a98">CcIsThereDirtyData</a> (
00723     IN <a class="code" href="../../d7/d7/struct__VPB.html">PVPB</a> Vpb
00724     );
00725 
00726 <span class="comment">// end_ntifs</span>
00727 
00728 <a class="code" href="../../d0/d9/ntosdef_8h.html#a29">NTKERNELAPI</a>
00729 LARGE_INTEGER
00730 <a class="code" href="../../d4/d2/cache_8h.html#a99">CcGetLsnForFileObject</a>(
00731     IN <a class="code" href="../../d9/d1/struct__FILE__OBJECT.html">PFILE_OBJECT</a> FileObject,
00732     OUT PLARGE_INTEGER OldestLsn OPTIONAL
00733     );
00734 
00735 <span class="preprocessor">#endif  // CACHE</span>
</div></pre><hr size="1"><address style="align: right;"><small>Generated on Sat May 15 19:39:19 2004 for test by
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
